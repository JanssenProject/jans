Flow io.jans.casa.cert.promptAndValidate
    Basepath ""
    Configs conf
    
cah = Call io.jans.casa.certauthn.CertAuthnHelper#new conf.certPickupUrl conf.roundTripMaxTime
url = Call cah buildRedirectUrl
//See template index.zul and class io.jans.casa.plugins.certauthn.vm.CertAuthnVM in casa plugin
RFAC url

validationResult = Call io.jans.casa.certauthn.CertUtil#validate cah.certPEM conf.certChainPEM
status = Call validationResult.first toString

When status is "VALID"
    x509Cert = validationResult.second
    fp = Call io.jans.casa.certauthn.CertUtil#getFingerPrint x509Cert
    obj = { success: true, data: { cert: { x509: x509Cert, fingerPrint: fp } } }
    Finish obj

obj = { error: status }
RRF "validation-error.ftlh" obj
Finish false
