Flow io.jans.casa.authn.cert
    Basepath ""
    Inputs userData withEscape

obj = Trigger io.jans.casa.cert.promptAndValidate
When obj.success is true
    uid = Call io.jans.casa.certauthn.CertUtil#findOwner obj.data.cert.fingerPrint
    
    When uid is userData.uid
        Finish uid

    When uid is null
        Log "@w Certificate presented is not recognized"
    Otherwise
        Log "@w Certificate presented belongs to a different user" 

Log "Cert Authentication failed"    
Finish false
