# FIDO2 Metrics Configuration Properties
# This file contains configurable constants for FIDO2 metrics system

# Base DN for FIDO2 metrics entries
fido2.metrics.base.dn=ou=fido2-metrics,o=jans

# Base DN for FIDO2 user metrics
fido2.user.metrics.base.dn=ou=fido2-user-metrics,o=jans

# Base DN for FIDO2 metrics aggregation
fido2.aggregation.base.dn=ou=fido2-aggregation,o=jans

# Thresholds for user behavior analysis
fido2.user.high.fallback.rate.threshold=0.5
fido2.user.medium.fallback.rate.threshold=0.3
fido2.user.low.fallback.rate.threshold=0.1

# Engagement level thresholds
fido2.user.high.engagement.min.operations=50
fido2.user.medium.engagement.min.operations=20
fido2.user.low.engagement.min.operations=5

# Adoption stage thresholds
fido2.user.early.adoption.max.days=30
fido2.user.growth.adoption.max.days=90
fido2.user.mature.adoption.min.days=90

# Performance thresholds
fido2.performance.slow.operation.threshold.ms=5000
fido2.performance.very.slow.operation.threshold.ms=10000

# Risk score thresholds
fido2.user.risk.high.threshold=0.8
fido2.user.risk.medium.threshold=0.5
fido2.user.risk.low.threshold=0.2

# Risk calculation factors
fido2.user.risk.high.fallback.factor=0.3
fido2.user.risk.medium.fallback.factor=0.2
fido2.user.risk.low.success.factor=0.1
fido2.user.risk.medium.success.factor=0.05
fido2.user.risk.new.user.factor=0.15
fido2.user.risk.inactive.user.factor=0.1
fido2.user.risk.max.score=1.0

# Success rate thresholds
fido2.user.success.rate.low.threshold=0.8
fido2.user.success.rate.medium.threshold=0.9

# Aggregation intervals
fido2.aggregation.hourly.interval.minutes=60
fido2.aggregation.daily.interval.hours=24
fido2.aggregation.weekly.interval.days=7
fido2.aggregation.monthly.interval.days=30

# Data retention
fido2.data.retention.days=30
fido2.aggregation.retention.days=365

# ========== ENHANCED AGGREGATION CONFIGURATION (GitHub Issue #4) ==========

# Aggregation Type Enablement
fido2.metrics.aggregation.hourly.enabled=true
fido2.metrics.aggregation.daily.enabled=true
fido2.metrics.aggregation.weekly.enabled=true
fido2.metrics.aggregation.monthly.enabled=true

# Aggregation Scheduling (Cron expressions)
fido2.metrics.aggregation.hourly.cron=0 5 * * * *
fido2.metrics.aggregation.daily.cron=0 10 1 * * *
fido2.metrics.aggregation.weekly.cron=0 15 1 * * MON
fido2.metrics.aggregation.monthly.cron=0 20 1 1 * *

# Retention Configuration (in days)
fido2.metrics.aggregation.retention.hourly.days=7
fido2.metrics.aggregation.retention.daily.days=90
fido2.metrics.aggregation.retention.weekly.days=365
fido2.metrics.aggregation.retention.monthly.days=1095

# Performance Configuration
fido2.metrics.aggregation.batch.size=1000
fido2.metrics.aggregation.parallel.processing=true
fido2.metrics.aggregation.max.concurrent.threads=4
fido2.metrics.aggregation.timeout.minutes=30

# Trend Analysis Configuration
fido2.metrics.trend.analysis.enabled=true
fido2.metrics.trend.growth.threshold.percent=5.0
fido2.metrics.trend.stable.threshold.percent=5.0
fido2.metrics.trend.analysis.window.days=30

# Period Comparison Configuration
fido2.metrics.period.comparison.enabled=true
fido2.metrics.period.comparison.default.periods=7
fido2.metrics.period.comparison.max.periods=90

# Batch processing
fido2.batch.size=1000
fido2.batch.timeout.seconds=300

# Error categorization
fido2.error.timeout.keywords=timeout,expired,time.out
fido2.error.invalid.keywords=invalid,malformed,bad.format
fido2.error.notfound.keywords=not.found,missing,not.exist
fido2.error.auth.keywords=unauthorized,forbidden,access.denied
fido2.error.server.keywords=server,internal,service.unavailable
fido2.error.network.keywords=network,connection,unreachable
