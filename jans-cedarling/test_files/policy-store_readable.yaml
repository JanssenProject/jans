cedar_version: v2.4.7
cedar_policies:
  840da5d85403f35ea76519ed1a18a33989f855bf1cf8:
    description: simple policy example for pricipal workload
    creation_date: '2024-09-20T17:22:39.996050'
    policy_content:
      encoding: none
      content_type: cedar
      body: |-
        permit(
            principal is Jans::Workload,
            action in [Jans::Action::"Update"],
            resource is Jans::Issue
        )when{
            principal.org_id == resource.org_id
        };
  444da5d85403f35ea76519ed1a18a33989f855bf1cf8:
    description: simple policy example for pricipal user
    creation_date: '2024-09-20T17:22:39.996050'
    policy_content:
      encoding: none
      content_type: cedar
      body: |-
        permit(
            principal is Jans::User,
            action in [Jans::Action::"Update"],
            resource is Jans::Issue
        )when{
            principal.country == resource.country
        };
cedar_schema:
  encoding: none
  content_type: cedar
  body: |
    namespace Jans {
    type Url = {"host": String, "path": String, "protocol": String};
    entity Access_token = {"aud": String, "exp": Long, "iat": Long, "iss": TrustedIssuer, "jti": String};
    entity Issue = {"country": String, "org_id": String};
    entity TrustedIssuer = {"issuer_entity_id": Url};
    entity User = {"country": String, "email": String, "sub": String, "username": String};
    entity Workload = {"client_id": String, "iss": TrustedIssuer, "name": String, "org_id": String};
    entity id_token = {"acr": String, "amr": String, "aud": String, "exp": Long, "iat": Long, "iss": TrustedIssuer, "jti": String, "sub": String};
    action "Update" appliesTo {
      principal: [Workload, User],
      resource: [Issue],
      context: {}
    };
    }
