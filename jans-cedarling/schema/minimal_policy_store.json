{
    "cedar_version": "v4.4.0",
    "policies": {
        "policy_1": {
            "description": "Allow admins to read",
            "creation_date": "2025-01-15T10:00:00Z",
            "policy_content": {
                "encoding": "none",
                "content_type": "cedar",
                "body": "permit(principal, action == Jans::Read, resource) when { principal is Jans::User && principal.role.contains(\"admin\") };"
            }
        },
        "policy_2": {
            "description": "Allow access with valid scope from token",
            "creation_date": "2025-01-15T10:00:00Z",
            "policy_content": {
                "encoding": "none",
                "content_type": "cedar",
                "body": "permit(principal, action == Jans::Read, resource) when { context.tokens.main_idp_access_token.hasTag(\"scope\") && context.tokens.main_idp_access_token.getTag(\"scope\").contains(\"read:profile\") };"
            }
        }
    },
    "trusted_issuers": {
        "main_idp": {
            "name": "Main IDP",
            "openid_configuration_endpoint": "https://idp.example.com/.well-known/openid-configuration",
            "token_metadata": {
                "access_token": {
                    "entity_type_name": "Jans::Access_token",
                    "principal_mapping": ["Jans::Workload"]
                }
            }
        }
    },
    "schema": {
        "encoding": "none",
        "content_type": "cedar",
        "body": "namespace Jans { type Url = { host: String, path: String, protocol: String }; type Context = { network?: String, tokens?: TokensContext, }  type TokensContext = { total_token_count: Long, main_idp_access_token?: Access_token }; entity User = { role: Set<String> }; entity Application; entity Workload; entity Access_token = { token_type?: String, jti?: String, iss?: TrustedIssuer, exp?: Long, validated_at?: Long, scope?: Set<String> } tags Set<String>; entity TrustedIssuer { issuer_entity_id: Url }; action Read appliesTo { principal: [User, Workload], resource: [Application], context: Context }; }"
    }
}
