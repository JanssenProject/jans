namespace Jans {
    // ******  TYPES  ******
    type Url = {
        host: String,
        path: String,
        protocol: String
    };
    type email_address = {
        domain: String,
        uid: String
    };
    type Context = {
        network?: String,
        network_type?: String,
        user_agent?: String,
        operating_system?: String,
        device_health?: Set<String>,
        current_time?: Long,
        geolocation?: Set<String>,
        fraud_indicators?: Set<String>,
    };

    // ******  Entities  ******
    entity Role;
    entity User in [Role] = {
        sub?: String,
        email?: email_address,
        phone_number?: String,
        role?: Set<String>,
        username?: String,
        id_token?: Id_token,
        userinfo_token?: Userinfo_token,
    };
    entity Workload = {
        iss: TrustedIssuer,
        client_id?: String,
        aud?: String,
        name?: String,
        rp_id?: String,
        spiffe_id?: String,
        access_token?: Access_token,
    };
    entity Access_token = {
        iss: TrustedIssuer,
        sub?: String,
        aud?: String,
        exp?: Long,
        nbf?: Long,
        iat?: Long,
        jti?: String,
        scope?: Set<String>
    };
    entity Id_token = {
        iss: TrustedIssuer,
        sub?: String,
        aud?: String,
        exp?: Long,
        nbf?: Long,
        iat?: Long,
        jti?: String,
        acr?: String,
        amr?: Set<String>,
        azp?: String,
        birthdate?: String,
        email?: email_address,
        name?: String,
        phone_number?: String,
        role?: Set<String>,
    };
    entity Userinfo_token = {
        iss: TrustedIssuer,
        sub?: String,
        aud?: String,
        exp?: Long,
        nbf?: Long,
        iat?: Long,
        jti?: String,
        birthdate?: String,
        email?: email_address,
        name?: String,
        phone_number?: String,
        role?: Set<String>,
    };
    entity HTTP_Request = {
        "header": { "Accept"?: String },
        "url": Url
    };
    entity TrustedIssuer = {
        issuer_entity_id: Url
    };
    entity Application = {
        app_id: String,
        name: String,
        url: Url
    };

    // ******  Actions  ******
    action Compare appliesTo {
      principal: [User, Workload],
      resource: [Application],
      context: Context
    };
    action Execute appliesTo {
      principal: [User, Workload],
      resource: [Application],
      context: Context
    };
    action Monitor appliesTo {
      principal: [User, Workload],
      resource: [Application],
      context: Context
    };
    action Read appliesTo {
      principal: [User, Workload],
      resource: [Application],
      context: Context
    };
    action Search appliesTo {
      principal: [User, Workload],
      resource: [Application],
      context: Context
    };
    action Share appliesTo {
      principal: [User, Workload],
      resource: [Application],
      context: Context
    };
    action Tag appliesTo {
      principal: [User, Workload],
      resource: [Application],
      context: Context
    };
    action Write appliesTo {
      principal: [User, Workload],
      resource: [Application],
      context: Context
    };
    action GET appliesTo {
      principal: [Workload],
      resource: [HTTP_Request],
      context: Context
    };
    action PUT appliesTo {
      principal: [Workload],
      resource: [HTTP_Request],
      context: Context
    };
    action DELETE appliesTo {
      principal: [Workload],
      resource: [HTTP_Request],
      context: Context
    };
    action HEAD appliesTo {
      principal: [Workload],
      resource: [HTTP_Request],
      context: Context
    };
    action PATCH appliesTo {
      principal: [Workload],
      resource: [HTTP_Request],
      context: Context
    };
}
