{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Janssen Project","text":"Build secure digital identity solutions with Janssen <p> Enterprise-grade authentication and authorization platform \u2013 Create robust identity management systems with OAuth 2.0, OpenID Connect, FIDO2, and modern security standards. Janssen provides everything you need to secure your applications and APIs.     </p> Get Started View on GitHub"},{"location":"#why-choose-janssen","title":"Why Choose Janssen?","text":"Enterprise Security <p>Built with security at its core, featuring comprehensive audit logging, threat detection, and compliance controls. Advanced security features include brute force protection, account lockout policies, and detailed security event monitoring.</p> Standards Compliant <p>Complete implementation of OAuth 2.0, OpenID Connect, SAML 2.0, FIDO2, SCIM, and UMA 2.0. Certified compatibility ensures seamless integration with existing systems and future-proof deployments.</p> Cloud Ready <p>Native Kubernetes support with auto-scaling, service mesh compatibility, and cloud-agnostic deployment options. Designed for modern containerized environments with full observability.</p> Highly Extensible <p>Powerful interception scripts, custom plugins, and comprehensive REST APIs. Build tailored authentication flows, integrate third-party services, and customize every aspect of the platform.</p> User Experience <p>Casa self-service portal empowers users to manage their credentials, enroll devices, and handle account recovery. Intuitive interfaces reduce support burden while improving security.</p> Visual Orchestration <p>Agama's drag-and-drop designer enables complex authentication workflows without coding. Create sophisticated multi-factor flows, integrate external services, and test in real-time.</p>"},{"location":"#core-components","title":"Core Components","text":"Janssen ServerCasaAgamaCedarling <p>Enterprise Identity Platform</p> <p></p> <p>The core authentication and authorization server supporting multiple protocols and advanced security features.</p> <ul> <li>OAuth 2.0 &amp; OpenID Connect implementation</li> <li>Multi-factor authentication support</li> <li>Advanced session management</li> <li>Enterprise directory integration</li> <li>Comprehensive audit logging</li> </ul> <p>Learn more</p> <p>Self-Service Portal</p> <p></p> <p>User-friendly portal for credential management and self-service operations.</p> <ul> <li>2FA device enrollment and management</li> <li>Password reset and account recovery</li> <li>Consent management</li> <li>Custom branding and localization</li> <li>Plugin ecosystem</li> </ul> <p>Explore Casa</p> <p>Authentication Orchestration</p> <p></p> <p>Visual platform for designing and implementing complex authentication flows.</p> <ul> <li>Drag-and-drop flow designer</li> <li>Custom authentication logic</li> <li>Third-party integrations</li> <li>Real-time testing and deployment</li> <li>Version control support</li> </ul> <p>Start with Agama</p> <p>Policy Engine</p> <p></p> <p>Cedar-based authorization engine for fine-grained access control decisions.</p> <ul> <li>Policy-as-code approach</li> <li>Real-time authorization decisions</li> <li>Audit trail and compliance</li> <li>API-first architecture</li> <li>Cloud-native deployment</li> </ul> <p>Discover Cedarling</p>"},{"location":"#quick-start-guide","title":"Quick Start Guide","text":""},{"location":"#1-choose-your-deployment","title":"1. Choose Your Deployment","text":"<p>Select the deployment method that best fits your environment and requirements.</p> KubernetesDockerVM Installation <pre><code>wget https://raw.githubusercontent.com/JanssenProject/jans/nightly/automation/startjanssendemo.sh &amp;&amp; chmod u+x startjanssendemo.sh &amp;&amp; ./startjanssendemo.sh\n</code></pre> <p>Complete Kubernetes Setup Guide</p> <p>For Testing and Development Only</p> <pre><code>wget https://raw.githubusercontent.com/JanssenProject/jans/nightly/automation/startjanssenmonolithdemo.sh &amp;&amp; chmod u+x startjanssenmonolithdemo.sh &amp;&amp; sudo bash startjanssenmonolithdemo.sh demoexample.jans.io MYSQL \"\" main\n</code></pre> <p>Complete Docker Setup Guide</p> <p>For Testing and Development Only</p> <pre><code>curl https://raw.githubusercontent.com/JanssenProject/jans/nightly/jans-linux-setup/jans_setup/install.py &gt; install.py\nsudo python3 install.py\n</code></pre> <p>Complete VM Setup Guide</p>"},{"location":"#2-initial-configuration","title":"2. Initial Configuration","text":"<p>Set up your identity platform with the configuration tools.</p> TUI (Terminal User Interface)Command LineTerraform <pre><code>sudo /opt/jans/bin/jans-tui.py\n</code></pre> <pre><code>sudo /opt/jans/bin/jans-cli.py\n</code></pre> <pre><code>resource \"jans_client\" \"example\" {\n  client_name     = \"My Application\"\n  grant_types     = [\"authorization_code\"]\n  redirect_uris   = [\"https://myapp.com/callback\"]\n  response_types  = [\"code\"]\n  scope           = \"openid profile email\"\n}\n</code></pre>"},{"location":"#3-create-your-first-client","title":"3. Create Your First Client","text":"<p>Register an application using Terraform for infrastructure as code.</p> <pre><code>terraform {\n  required_providers {\n    jans = {\n      source = \"JanssenProject/jans\"\n    }\n  }\n}\n\nprovider \"jans\" {\n  url = \"https://your-domain\"\n}\n\nresource \"jans_client\" \"webapp\" {\n  client_name    = \"Web Application\"\n  grant_types    = [\"authorization_code\", \"refresh_token\"]\n  redirect_uris  = [\"https://myapp.com/callback\"]\n  response_types = [\"code\"]\n  scope         = \"openid profile email\"\n}\n</code></pre>"},{"location":"#4-test-authentication","title":"4. Test Authentication","text":"<p>Verify your setup with a simple authentication flow.</p> <pre><code>https://your-domain/jans-auth/restv1/authorize?\n  response_type=code&amp;\n  client_id=YOUR_CLIENT_ID&amp;\n  redirect_uri=YOUR_REDIRECT_URI&amp;\n  scope=openid profile\n</code></pre> <p>Janssen is a Linux Foundation project that provides next-generation identity and access management, building upon years of experience in enterprise security.</p> A Linux Foundation Project"},{"location":"CHANGELOG/","title":"Changelog","text":""},{"location":"CHANGELOG/#1160-2026-01-22","title":"1.16.0 (2026-01-22)","text":""},{"location":"CHANGELOG/#features","title":"Features","text":"<ul> <li>charts: make Gateway ports configurable and support Gateway in janssen helm chart (#12995) (583b64c)</li> <li>charts: support gateway api in janssen-aio (#12907) (f5077ae)</li> <li>client certificate authentication casa plugin (#12927) (6d80354)</li> <li>cloud-native: add feature to update config-api scopes sync from template (#12909) (17d0462)</li> <li>cloud-native: support for additional schema files (#13011) (ac78d8b)</li> <li>config-api: feature wise admin scope for endpoints (#12736) (a02118e)</li> <li>core: fix deps2 (#12965) (19ad682)</li> <li>core: merge logging changes from gluu4 (#12871) (1fabadb)</li> <li>correct the jans_assets scopes names (#13025) (02409e4)</li> <li>introduce roundTripMaxTime config property (#13009) (e5ab6dc)</li> <li>jans-auth-server: Added configurable rate limiting for authentication endpoints to prevent brute-force attacks #12664 (#12868) (7a5f846)</li> <li>jans-auth-server: sanitized log in AuthenticationService #12958 (#12959) (ba21b2f)</li> <li>jans-auth: remove old jackson2 dependency (#12886) (31e31cf)</li> <li>jans-cli-tui: additional config-api parameters (#12914) (819a206)</li> <li>jans-cli-tui: remove Admin-UI plugin (#12893) (28a40a0)</li> <li>jans-config-api: change in process of accessing config-api endpoints in Admin UI (#12983) (7b984ee)</li> <li>jans-core: remove tika-core from jackrabbit-core deps (#12960) (75fa989)</li> <li>jans-core: removed FILE script type (48b8080)</li> <li>jans-core: removed FILE script type #12997 (#12998) (48b8080)</li> <li>jans-linux-setup: flex update requirements (#12985) (a9eb502)</li> <li>jans-linux-setup: introduce Mako templating engine (#13054) (1b904a9)</li> <li>jans-linux-setup: update the renamed scopes in role-to-scope mapping (#12899) (ec72a0f)</li> <li>jans-pycloudlib: add support for user session-level postgres schema selection (#12889) (b8cc3ab)</li> <li>jans-tarp: implement Cedar-Policy-Aware AI Agent Scaffolding in jans-tarp (#12806) (6e1646a)</li> <li>orm: add method to check data after entry update (#12873) (03a48e7)</li> <li>send 403 - Forbidden error code in response if Admin UI requests Config API with expired session. This will indicate to Admin UI to logout. (#13022) (a2701ae)</li> <li>update the renamed scopes in role-to-scope mapping (ec72a0f)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes","title":"Bug Fixes","text":"<ul> <li>admin-ui: failed logout on tarp (#12882) (6e4be8a)</li> <li>AdminUICookieFilter should not be called in Jans installation (#13041) (2f2675f)</li> <li>cloud-native: set restrictive file permissions on SQL property files containing credentials (#12901) (280b2f7)</li> <li>config-api: client secret getting encrypted (#12930) (7b73e80)</li> <li>docker-jans-cloudtools: add type validation for --limit parameter (#12946) (4fdd2dd)</li> <li>docs: add PostgreSQL-related commands to Docker install quick start (#13032) (ad0147d)</li> <li>docs: broken links in Authorization Endpoint (#12243) (#12745) (42225c6)</li> <li>docs: fix linting issues - trailing spaces and EOF newline  (#12879) (734f644)</li> <li>docs: fix linting issues - trailing spaces and EOF newline (#12859) (05683c2)</li> <li>docs: Set CEDARLING_JWT_SIG_VALIDATION to \"disabled\" (#12917) (c4665b4)</li> <li>docs: update contribution guide, jans README, and Docker Compose\u2026 (#12990) (4887ac7)</li> <li>fix build error (#13040) (97d5cf0)</li> <li>fix error in signing firefox extension for self distribution (#13053) (22ec96f)</li> <li>jans-auth-server: fix build after dependencies upgrade (tika) #12971 (#12972) (43acf6a)</li> <li>jans-cedarling: fix benchmarks to actually work (#12923) (4518da7)</li> <li>jans-cedarling: Fix cedarling to handle domains in different cases (upper and lower) (3e61fb1)</li> <li>jans-cedarling: Fix cedarling to handle iss in different cases (#12982) (3e61fb1)</li> <li>jans-cedarling: fix entities mapping for not required entities (#13024) (f9caf73)</li> <li>jans-cedarling: remove nested field parsing in trusted_issuer parser (#13005) (bedac4d)</li> <li>jans-cli-tui: check if log exists before iteration (#13003) (293b13e)</li> <li>jans-cli-tui: display confirmation message after saving jans-lock server config (#12911) (3884dcd)</li> <li>jans-cli-tui: scim configuration param disableExternalLoggerConfiguration (#12918) (84ac4fa)</li> <li>jans-cli-tui: support only db location for custom scripts (#12987) (6d88aa1)</li> <li>jans-config-api: move AdminUICookieFilter to Admin UI plugin (#13050) (40f41f5)</li> <li>jans-config-api: the session check should be excluded for certai\u2026 (#13031) (c7f6cda)</li> <li>jans-keycloak-integration: bump libraries with cve vulns #12992 (#12993) (4317fdf)</li> <li>jans-linux-setup: typo (#13047) (03d4655)</li> <li>refactor DN parsing (#12935) (67adb65)</li> <li>terraform-jans-provider: missing grant types in terraform oidc client resource (#12999) (610ab26)</li> <li>update override_sql_ssl_property in sql.py to prevent SSL proper\u2026 (#12878) (ab84ff7)</li> <li>vulns and docs bullet points (#12940) (c807bdb)</li> </ul>"},{"location":"CHANGELOG/#1150-2025-12-19","title":"1.15.0 (2025-12-19)","text":""},{"location":"CHANGELOG/#features_1","title":"Features","text":"<ul> <li>cloud-native: add ability to run persistence to update entries (#12760) (4fab8b1)</li> <li>cloud-native: add support for enabling/disabling Casa admin console (#12771) (376237b)</li> <li>config-api: User search by mobile number not functioning and Swagger API schema changes (#12704) (63c9c98)</li> <li>demo: mcp server for Janssen config api (#12778) (dd1930b)</li> <li>jans-auth-server: allow to run update token scripts universally (even if it's not assigned to client) #12837 (#12844) (1946606)</li> <li>jans-auth-server: introduced interception script for tx_tokens #8376 (#12724) (a1d9d23)</li> <li>jans-auth-server: introducing interception script for tx_tokens (a1d9d23)</li> <li>jans-auth-server: make sessions time check configurable for high latency environments when defaultPromptLogin=true #12802 (#12821) (ebea173)</li> <li>jans-auth-server: upgraded status list implementation to latest draft 13 (from 02) #10097 (#12783) (f045fba)</li> <li>jans-cedarling: Multi-issuer authorization feature for Cedarling (#12503) (334a235)</li> <li>jans-config-api: configuration changes to handle clientSecret in response (#12847) (2738d91)</li> <li>jans-fido2: added the final fixes and calls to the metrics-func\u2026 (#12800) (aca7ea9)</li> <li>jans-fido2: added the metrics aggregations and analytics (#12405) (9d80cda)</li> <li>jans-pycloudlib: add support for connecting to cloudsql via cloud auth proxy (#12788) (192c071)</li> <li>orm: add mysql-socket dependecy (#12824) (30ece77)</li> <li>orm: add postgres-socket-factory (#12827) (f99adc1)</li> <li>terraform-provider: add agama and config data sources (#12855) (e9fea40)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_1","title":"Bug Fixes","text":"<ul> <li>config-api: error message not indicating exact cause that SP name already exists (#12830) (2189ef4)</li> <li>config-api: user birthday not displayed when fetched #12799 (#12803) (a1e3b6d)</li> <li>docker-jans-persistence-loader: preserve the order of columns when creating the table (#12818) (a8790f4)</li> <li>docs: align Cedarling docs file naming and structure with navigation (#12710) (3e76bab)</li> <li>docs: fix linting issues - trailing spaces and EOF newline  (#12731) (6f84f97)</li> <li>docs: fix linting issues - trailing spaces and EOF newline  (#12849) (6f1837d)</li> <li>docs: fix linting issues - trailing spaces and EOF newline (#12758) (b7b0d02)</li> <li>docs: fix linting issues - trailing spaces and EOF newline (#12766) (89bc4dc)</li> <li>docs: fix linting issues - trailing spaces and EOF newline (#12835) (37c20f9)</li> <li>docs: fix linting issues - trailing spaces and EOF newline (#12840) (917e56f)</li> <li>docs: fix linting issues - trailing spaces and EOF newline (#12843) (2377415)</li> <li>docs: Set CEDARLING_JWT_SIG_VALIDATION to \"disabled\" (#12854) (7873d25)</li> <li>docs: update PostgreSQL installation command (#12709) (502d0db)</li> <li>docs: updated Cedarling Intro Diagram (#12738) (d6b9f40)</li> <li>failed authentication is not handled in jans-tarp (#12721) (4bdfb0e)</li> <li>git package is not installed during execution of startjanssenmonolithdemo script (#12725) (c29cbab)</li> <li>jans-auth-server: ExternalTokenExchangeService.externalValidate returns null instead of result  (#12809) (470badd)</li> <li>jans-auth-server: ExternalTokenExchangeService.externalValidate() returns null instead of result #12804 (470badd)</li> <li>jans-auth-server: put in access_token and id_token jwt only explicitly requested and allowed claims (#12848) (a19d82d)</li> <li>jans-cedarling: Add LSP support for Cedarling python errors bindings (#12807) (033e792)</li> <li>jans-cedarling: Improve caching JWT tokens to make it more deterministic (#12797) (c9dc41a)</li> <li>jans-cedarling: Update cedarling initialization to run with no trusted issuer  (#12455) (4cf1bf2)</li> <li>jans-cli-tui: hide passwords in log files (#12795) (a881a6f)</li> <li>jans-cli-tui: sort user claims (#12755) (ac255bd)</li> <li>jans-cli-tui: update claims after making attribute active/inactive (#12757) (abb7d97)</li> <li>jans-cli-tui: we should not allow editing acrMappings in properties screen (#12815) (e9e5450)</li> <li>jans-cli-tui: window too small error for multivalued user claim (#12752) (796c2fe)</li> <li>jans-fido2: remove unused conflicting reference to jans-auth (#12779) (7400575)</li> <li>need to map missing permissions to the admin role (#12773) (20dda1e)</li> <li>orm: force to use latest java-protobug to conform mysql 9.5 version (#12828) (09506a1)</li> <li>remove wrong nginx.org annotation (#12846) (611af91)</li> <li>replace bitnami's commercial images and helm chart with kubernetes manifests using free official mysql and pgsql images (#12737) (cb42d71)</li> </ul>"},{"location":"CHANGELOG/#1140-2025-11-18","title":"1.14.0 (2025-11-18)","text":""},{"location":"CHANGELOG/#features_2","title":"Features","text":"<ul> <li>changes in endpoints used in Admin UI for cedarling integration (#12652) (458abbb)</li> <li>cloud-native: add policy store file for admin-ui and cedarling integration (#12659) (621e303)</li> <li>core: allow to reuse cluster node services (#12506) (a1f56c9)</li> <li>core: update jython to v2.7.4 (#12394) (2776762)</li> <li>implement token cache (#12687) (88d8e89)</li> <li>jans-auth-server: adding interception script for PAR #10556 (#12334) (7027c1c)</li> <li>jans-config-api: rest endpoint specifications for Cedarling integration in Admin UI  (#12388) (7d4f3f2)</li> <li>jans-linux-setup: Admin UI and Cedarling integration (#12572) (a3f75eb)</li> <li>jans-linux-setup: jans-lock-cedarling custom lib (#12590) (4ffb47a)</li> <li>jans-lock: audit server actions (#12588) (dcb2fbd)</li> <li>jans-lock: log audit status (#12600) (e726a9e)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_2","title":"Bug Fixes","text":"<ul> <li>cloud-native: add missing jans-lock policy (#12402) (7c3f0b6)</li> <li>cloud-native: escape special characters used in database credentials (#12565) (1501723)</li> <li>cloud-native: unable to decode cedar policy schema base64 (#12631) (2fb4c26)</li> <li>config-api: agama deployment metadata type fix for deployment (#12374) (6dd0db3)</li> <li>docs: add contact email address for CLA contributions (#12684) (108356e)</li> <li>docs: autogenerate docs (#12656) (ada29b2)</li> <li>docs: broken link in the Run integration tests #12233 (#12274) (8076bf1)</li> <li>docs: correct broken link in prompt create page (#12399) (b485d89)</li> <li>docs: correct broken links in External Libraries documentation (#12540) (a812b53)</li> <li>docs: fix broken link in client-registration.md (#12545) (e67dcae)</li> <li>docs: fix broken link with revision and testing (#12539) (257597d)</li> <li>docs: fix link of cedarling in a javascript app (#12593) (d72c853)</li> <li>docs: fix link of Cedarling Rust Developer Guide (#12592) (2250afb)</li> <li>docs: fix link of Client Registration scripts link (#12591) (dae2ca5)</li> <li>docs: fix link of Token Endpoint (#12685) (cdd657a)</li> <li>docs: fix link to Cedarling TBAC quickstart in Python docs (#12558) (cad0a0e)</li> <li>docs: fix link to ConfigApiInterception script (#12528) (adb84ae)</li> <li>docs: Fix link to dynamic scope script in userinfo.md (#12519) (fd54f1e)</li> <li>docs: fix link to end session interception script (#12520) (79f2174)</li> <li>docs: fix link to Persistence Extension documentation (#12452) (7cab7b0)</li> <li>docs: fix typo in trusted issuers section of documentation (#12569) (1462da7)</li> <li>docs: update broken link in Access Evaluation Endpoint (#12527) (f789e0a)</li> <li>docs: update jans <code>Ubuntu</code> and <code>Using CLI/TUI</code> docs (#12466) (38983c3)</li> <li>jans-auth-server: swagger yaml has bad identation #12422 (#12423) (45815a0)</li> <li>jans-casa: resolve multiple device registration and passkey imag\u2026 (#12501) (e2782c2)</li> <li>jans-casa: resolve multiple device registration and passkey image styling issues (e2782c2)</li> <li>jans-cedarling: Add namesapce support for default entities and parse Cedar JSON format (#12462) (92a0034)</li> <li>jans-cedarling: disable hash checking in sidecar (#12481) (81b0ea0)</li> <li>jans-cedarling: FIx boostrap properties documentation (#12420) (00dddae)</li> <li>jans-cedarling: Fix retrieving resource entity from default entities (#12544) (b9379e0)</li> <li>jans-cedarling: Update rust toolchain because dependency lib was updated (#12457) (a8a6d3c)</li> <li>jans-cli-tui: role is admin not api-admin (#12688) (f5fa229)</li> <li>jans-config-api: inum of duplicate scopes (#12411) (25b3b6a)</li> <li>jans-linux-setup: path of cedarling_core.json (#12477) (02f2269)</li> <li>jans-linux-setup: remove argument --enable-scim-test-mode (#12479) (074ae1d)</li> <li>jans-pycloudlib: column type mismatch on DATETIME (#12653) (04d297c)</li> <li>jans-pycloudlib: upgrade urllib3 version to v2.5.0 (#12425) (a871019)</li> <li>setup: fix jython repository (#12410) (02f1860)</li> </ul>"},{"location":"CHANGELOG/#miscellaneous-chores","title":"Miscellaneous Chores","text":"<ul> <li>prep release 1.14.0 (#12703) (65d3f7f)</li> </ul>"},{"location":"CHANGELOG/#1120-2025-09-22","title":"1.12.0 (2025-09-22)","text":""},{"location":"CHANGELOG/#features_3","title":"Features","text":"<ul> <li>cloud-native: add support for SSL connection to persistence (#12198) (65819db)</li> <li>config-api: scope update for ssa endpoint (#12191) (8969c61)</li> <li>expose API to manage user tokens (#12144) (f01c35b)</li> <li>jans-linux-setup: add add password grant type to scim client for testing (#12142) (2353341)</li> <li>jans-linux-setup: PostgreSQL SSL support (#12195) (5d9ff98)</li> <li>jans-pycloudlib: add low-level support for SSL persistence connection (#12194) (a9bbd27)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_3","title":"Bug Fixes","text":"<ul> <li>config-api: ssa delete endpoint and fix to admin-ui-permission delete endpoint fix (#12174) (d354881)</li> <li>jans-cli-tui: Admin UI Roles (#12162) (324c07f)</li> <li>jans-cli-tui: error saving auth logging (#12172) (fd7e117)</li> </ul>"},{"location":"CHANGELOG/#miscellaneous-chores_1","title":"Miscellaneous Chores","text":"<ul> <li>release 1.12.0 (#12205) (91da377)</li> </ul>"},{"location":"CHANGELOG/#1110-2025-09-11","title":"1.11.0 (2025-09-11)","text":""},{"location":"CHANGELOG/#features_4","title":"Features","text":"<ul> <li>config-api: audit for config-api endpoint (#11895) (5088857)</li> <li>config-api: endpoint to return table info (#11866) (bd94675)</li> <li>config-api: lock and fido2 config and scim audit changes (#12107) (cb004f8)</li> <li>increase the validity period of tokens in tarp to one day (#11900) (8b0195e)</li> <li>jans-auth-server: added cookie interception script #366 (#11975) (aa47c7f)</li> <li>jans-auth-server: created interception script for Logout Status JWT #11250 (#11930) (19728e0)</li> <li>jans-auth-server: provided configuration for changing case-sensitivity of FAPI response #11394 (#12018) (e388493)</li> <li>jans-auth-server: updates to Audience Values for OAuth 2.0 Authorization Servers #11842 (#11851) (e71c35b)</li> <li>jans-auth: add type prefixes to each keys which application stores in cache #11565 (#11871) (0a4fe05)</li> <li>jans-auth: handle gzip compressed token responses  (#12052) (cbde4d6)</li> <li>jans-cedarling: Support <code>default_entities</code> in <code>policy_stores</code> (#11936) (0ea7511)</li> <li>jans-cedarling: use hashes for ID in fields (#10853) (5c9423a)</li> <li>jans-cli-tui: audit log tab for Config Api (#11931) (992a9cc)</li> <li>jans-config-api: restore jans-config-api plugins jans-link-plugin (#11912) (2941a9f)</li> <li>jans-config-api: ssa revoke endpoint should be created in config-api  (#12134) (e0cbefc)</li> <li>jans-core: update jetty to 12.0.25 (#12075) (9781cdb)</li> <li>jans-linux-setup: add scim user tokens scope (#12136) (e6c0dc9)</li> <li>jans-linux-setup: redirecting errors on stderr for the scheduler (#12013) (b00469b)</li> <li>offer a way to easily copy the tokens to clipboard (#11949) (053d95e)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_4","title":"Bug Fixes","text":"<ul> <li>add no gorn mode (#12011) (46fc7c4)</li> <li>cloud-native: error running kc-jans-scheduler (#12053) (86c2fed)</li> <li>cloud-native: invalid pathType when nginx ingress controller uses strict-validate-path-type config (#11911) (ba6f74b)</li> <li>config-api: asset endpoint fix for uplaod and fetch (27f800a)</li> <li>config-api: asset endpoint fix for upload and fetch (#12039) (27f800a)</li> <li>css style for paragraph rendering (#12014) (e3fd6ee)</li> <li>docs: fix broken links issue (#11902) (7b94ab4)</li> <li>docs: fix formatting in Jans README (#11938) (4766343)</li> <li>docs: fix person authentication docs url issue (#12103) (600bbce)</li> <li>docs: fix person authentication url issue (600bbce)</li> <li>docs: Fix script link issue (7b94ab4)</li> <li>docs: include benchmark doc link (#11987) (2b3663a)</li> <li>docs: Lock Server Docs Update (#12032) (c666eb9)</li> <li>docs: merge the Cedarling quick start guides (#11872) (1686099)</li> <li>docs: remove doc readme (df7184e)</li> <li>docs: remove duplicate <code>interception-scripts</code> file (83ac957)</li> <li>docs: remove duplicate <code>interception-scripts</code> readme file (#11963) (83ac957)</li> <li>docs: remove unused README (#12104) (df7184e)</li> <li>docs: update `application-session (79e71b5)</li> <li>docs: update `readmeformat (4766343)</li> <li>docs: update doc <code>SMTP configuration</code> in TUI section (#12105) (0229a6d)</li> <li>docs: update endpoint file title (#11962) (34356f4)</li> <li>docs: update java Cedarling docs (#12102) (66c9d3e)</li> <li>docs: update java doc (66c9d3e)</li> <li>docs: update link to the script location (#11940) (79e71b5)</li> <li>docs: update TARP installation instructions (#11856) (41d08d9)</li> <li>ignore trailing slash of issuer (5fc0ed5)</li> <li>jans-auth-server: acr mappings (alias) does not work if acr comes from request object's \"claims/id_token\" (#12060) (93df359)</li> <li>jans-auth-server: client registration script jwks is not used during validation #12036 (#12037) (8522af5)</li> <li>jans-casa: resolve session validator exception (#12061) (9dfba6b)</li> <li>jans-cedarling: Cedarling JWT validation with array aud claim handling (#11993) (990c0c4)</li> <li>jans-cedarling: Fix auth0 trailing slash issue in issuer validation (#11998) (5fc0ed5)</li> <li>jans-cedarling: fix krakend plugin to reflect resource changes (#11898) (5c2fdb9)</li> <li>jans-cli-tui: avoid logging plain texts (#11903) (3592837)</li> <li>jans-cli-tui: hide logging plain text password when changing user password (#12129) (1d5594f)</li> <li>jans-cli-tui: move fido2 hints to dynamic conf (#11861) (1e02fcc)</li> <li>jans-cli-tui: pagination AIP change for repositories endpoints (#11906) (cb25fa7)</li> <li>jans-keycloak-integration: added exclusions for dependencies already provided by quarkus #12001 (#12003) (a2434a0)</li> <li>jans-keycloak-integration: keycloak versioning issues #12019 (#12021) (dada481)</li> <li>jans-linux-setup: anssen and Gluu SQL field size snyc (8895a92)</li> <li>jans-linux-setup: chown jetty:jetty /opt/idp (#12108) (7d40caf)</li> <li>jans-linux-setup: fido2 test setup fixes (#11929) (d99a5f2)</li> <li>jans-linux-setup: github API endpoint changes for agama projects (#11908) (22a7b1f)</li> <li>jans-linux-setup: jans-scim-model.jar is not a provider for KC (#11969) (1f579ef)</li> <li>jans-linux-setup: Janssen and Gluu SQL field size sync (#11989) (8895a92)</li> <li>jans-linux-setup: KC version 26.3.2 (#11892) (b13de19)</li> <li>jans-linux-setup: missing py libs for suse (#12109) (38b61ad)</li> <li>jans-linux-setup: missing python libs for rhel-8 (#12056) (76724f3)</li> <li>jans-linux-setup: redirect kc start error to logs (1f579ef)</li> <li>jans-linux-setup: remove redirecting of SE to file for KC (#12065) (516cce0)</li> <li>jans-linux-setup: session argument for get_sqlalchObj_for_dn (#11935) (61cde98)</li> <li>jans-linux-setup: typo in Line 551 of scritps.ldif cookie -&gt; logout_status_jwt #12077 (#12078) (07e8efd)</li> <li>jans-lock: fix config endpoint URL (#11915) (604f7d2)</li> <li>README: Add information about project stages (#11854) (cd2f1ec)</li> </ul>"},{"location":"CHANGELOG/#190-2025-07-24","title":"1.9.0 (2025-07-24)","text":""},{"location":"CHANGELOG/#features_5","title":"Features","text":"<ul> <li>add check to prevent unsigned user-info jwt in the role_based_scopes_update_token script (Admin UI) (#11724) (52c4682)</li> <li>add the mandatory permissions for default roles in Admin UI (#11711) (9a56669)</li> <li>added essentialPermissionInAdminUI attribute to AdminPermission object (#11714) (d945703)</li> <li>cloud-native: add the mandatory permissions for default roles in Admin UI (#11739) (7831887)</li> <li>config-api: audit for config-api endpoints (#11760) (be52530)</li> <li>config-api: logs to indicate password related activity (#11791) (838686b)</li> <li>jans-auth-server: deprecated /revoke_session endpoint (it duplicates Global Token Revocation functionality) #11470 (#11801) (d7178aa)</li> <li>jans-auth-server: improved SessionIdService - added option to load session without local copy #11366 (#11761) (4510bd2)</li> <li>jans-auth-server: small improvement of ssa doc #11736 (#11737) (7a6af91)</li> <li>jans-auth: exclude htmlunit-* dependencies from final artifacts (#11830) (1c17b6d)</li> <li>jans-auth: fix client_registration script imports (#11705) (8b75934)</li> <li>jans-cedarling: add maven javadocs plugin in java binding (#11745) (f68e936)</li> <li>jans-cedarling: add support for the optional SSA JWT (#11653) (902f9d0)</li> <li>jans-cedarling: implement JWT status list validation (#11520) (f2e7f29)</li> <li>jans-cedarling: output cedar annotations when there are any policy failures (#11588) (0714a17)</li> <li>jans-config-api: add cedarlingLogType attribute in Admin UI configuration (#11755) (d4da957)</li> <li>jans-config-api: add endpoint to reset license details in Admin UI configuration (#11786) (56df1e6)</li> <li>jans-config-api: update OpenApi specs for Admin UI plugin (#11729) (4dc0c9a)</li> <li>jans-fido2: Add unit tests for attestation controller for handling missing username, invalid origin, and challenge, with successful register and verify scenarios. (ca68fd0)</li> <li>jans-linux-setup: add Debian 13 MySQL support (#11759) (7fbcd10)</li> <li>jans-linux-setup: create clients takes all possible arguments (#11770) (eca4b0c)</li> <li>jans-linux-setup: debian 13 support for internal use (#11685) (7b6e25b)</li> <li>jans-orm: add method to return internal information about tables (#11695) (7039b74)</li> <li>update OpenApi specs for Admin UI plugin (4dc0c9a)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_5","title":"Bug Fixes","text":"<ul> <li>add defeat the gorn (5ed2dcd)</li> <li>config-api: user name validation modification (#11776) (45386c1)</li> <li>doc: added default values for sessionId related properties to avoid confusion (#11781) (0894860)</li> <li>docs: add documentation for configuration and session management (#11091) (0184771)</li> <li>docs: add note on config refresh behavior in TUI (#11789) (b237d19)</li> <li>docs: add upgrade note about manual custom script updates (#11719) (8a6e3db)</li> <li>docs: docs fix cedarling propertie link issue (aaa4eb9)</li> <li>docs: docs fix Sample Scripts link issue (bf617a3)</li> <li>docs: docs fix sample scripts link issue (#11779) (bf617a3)</li> <li>docs: docs update jans readme (#11687) (bf42440)</li> <li>docs: fix Cedarling property link issue (#11780) (aaa4eb9)</li> <li>docs: fix incorrect link in Jans Casa docs (#11798) (ec9a3a9)</li> <li>docs: remove attribute page (00e0b2d)</li> <li>docs: remove config-api attribute page (#11722) (00e0b2d)</li> <li>docs: remove converting data (e729c89)</li> <li>docs: remove the link to the converting data document from left nav (#11720) (e729c89)</li> <li>docs: reorganise supported OS versions for VM installation (#11679) (329a113)</li> <li>docs: update supported OS versions (329a113)</li> <li>docs: update testing document with Poetry installation instructions (#11681) (e609156)</li> <li>jans-auth-server: set sub claim to client identifier for \"client credentials grant\" for AT as JWT #11413 (#11778) (60373a7)</li> <li>jans-auth: duplicate entry exception in start login flow #9322 (#11808) (ee4d38c)</li> <li>jans-cli-tui: add defeat the gorn (#11825) (5ed2dcd)</li> <li>jans-cli-tui: adjust entries per page dynamiccally (#11807) (03dca24)</li> <li>jans-cli-tui: disable expiration verification for user data jwt (#11669) (a9f59f4)</li> <li>jans-cli-tui: dynamic script is list for dynamic scope (#11734) (fea842c)</li> <li>jans-config-api: changing the /admin-ui/license/resetConfig to DELETE Http method (#11793) (39c48cc)</li> <li>jans-fido2: resolve registration issue (#11827) (b8b9927)</li> <li>jans-kc-scheduler: typo prevented proper loading of authorization scopes for jans-config-api client (22718c5)</li> <li>jans-kc-scheduler: typo prevented proper loading of authz scopes #11802 (#11813) (22718c5)</li> <li>jans-linux-setup: data type of jansScr is LONGTEXT (#11763) (0025728)</li> <li>jans-linux-setup: openbanking installation setup (#11703) (4905ed7)</li> <li>jans-linux-setup: re-order app installations (#11731) (c569fbf)</li> <li>jans-linux-setup: scopes in /opt/kc-scheduler/conf/config.properties (#11819) (ee93677)</li> </ul>"},{"location":"CHANGELOG/#180-2025-06-24","title":"1.8.0 (2025-06-24)","text":""},{"location":"CHANGELOG/#features_6","title":"Features","text":"<ul> <li>charts: add nodeSelector spec (#11495) (90409f8)</li> <li>cloud-native: introduce Logout Status JWT (#11626) (6f5fe8f)</li> <li>cloud-native: introduce session_jwt=true at Authorization Endpoint and Session JWT Status List Endpoint (#11477) (5ae709f)</li> <li>config-api: scope search to include scopeType (#11607) (b77b72d)</li> <li>config-api: use orm method to provide persistence metadata  (#11509) (dbdc1bd)</li> <li>config-api: use orm method to provide persistence metadata #11459 (#11473) (736d7f6)</li> <li>improve the display of cedarling result (#11552) (5ec5268)</li> <li>jans-auth-server: introduce session_jwt=true at Authorization Endpoint and Session JWT Status List Endpoint #11229 (#11251) (6b45f51)</li> <li>jans-auth-server: introduced Logout Status JWT #11468 (#11505) (92796fb)</li> <li>jans-auth: allow to override HttpService2 connection manager setting (54c547a)</li> <li>jans-auth: allow to override HttpService2 connection manager settings (#11586) (54c547a)</li> <li>jans-auth: update owasp (#11610) (bda24dc)</li> <li>jans-cedarling: implement sending logs to the lock server (#11161) (9330821)</li> <li>jans-cedarling: improve error message if json parsing of policy store failed (#11508) (4904d90)</li> <li>jans-cedarling: jans cedarling java binding (#11441) (da5423f)</li> <li>jans-cedarling: upgrade jna in cedarling-java binding (#11614) (aa45972)</li> <li>jans-cli-tui: display build date and build versions (#11539) (59415c8)</li> <li>jans-cli-tui: load agama community projects in 20 mins interval (#11627) (44873e0)</li> <li>jans-cli-tui: required property for attribute (#11593) (6b8c7a9)</li> <li>jans-config-api: update the license API url called from config-api (Admin UI Plugin) (#11559) (c8b7437)</li> <li>jans-core: added diagnostic to java compiler (#11562) (99bd129)</li> <li>jans-linux-setup: optional rdbm db schema (#11503) (f516bbc)</li> <li>jans-orm: add method to provide persistence metadata (#11450) (a066fcf)</li> <li>jans-orm: implement solution to import hashed passwords (7518dca)</li> <li>jans-orm: implement solution to import hashed passwords (#11601) (d8f5faa)</li> <li>jans-script: add sample Argon2 Persistence Ezxtension script (#11521) (3e2593f)</li> <li>jans-tui: added Jans-Client header (#11594) (13bd6c1)</li> <li>jans=-script: add sample Argon2 Persistence Ezxtension script (3e2593f)</li> <li>orm: fetch databaseName for PersistenceMetadata (#11485) (f9ffcac)</li> <li>orm: fix doc file (#11494) (0e71ad6)</li> <li>orm: fix doc file (#11497) (76d8f1d)</li> <li>orm: support password hashing using Argon2 (#11465) (5d48b27)</li> <li>orm: support password hashing using Argon2 (#11481) (47549af)</li> <li>update tf build docs (#11632) (c9f37dd)</li> <li>update the license API url called from config-api (Admin UI Plugin) (c8b7437)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_6","title":"Bug Fixes","text":"<ul> <li>build_cedarling_uniffi job in github workflow is failing (355cb2a)</li> <li>charts: invalid template function calls when using AWS secrets manager (#11467) (6a114a6)</li> <li>config-api: Scope filter based on fieldValuePair  (#11528) (560f7a3)</li> <li>config-api: Scope filter based on fieldValuePair #11524 (560f7a3)</li> <li>docs: Add <code>Cedarling Technical Overview</code> doc (d04336d)</li> <li>docs: add appropriate title to the document (#11579) (2907197)</li> <li>docs: add Cedarling technical overview doc (#11581) (d04336d)</li> <li>docs: correct jans api swagger reference (#11474) (7072a83)</li> <li>docs: remove <code>overview</code> title (2907197)</li> <li>docs: update release urls to point to latest Janssen release (#11557) (d13b291)</li> <li>docs: update standard claims list (#11567) (99227b1)</li> <li>docs: update the instructions for certificates (#10933) (dbdfbee)</li> <li>jans-auth-server: external libraries unavaiable from Java Interception Script #11377 (#11568) (aa3ffb5)</li> <li>jans-auth-server: improve logging - do not print that user is logged in in logs if it failed to login #11475 (#11480) (faae9d4)</li> <li>jans-cedarling: build_cedarling_uniffi job in github workflow is failing (#11542) (355cb2a)</li> <li>jans-cli-tui: display warnings for scriptType in edit clients (#11499) (68f2b57)</li> <li>jans-cli-tui: edit script config proprty (#11463) (bdc3bd7)</li> <li>jans-cli-tui: enforce setting SSA life time at least 5 minutes (#11628) (d4f9f2f)</li> <li>jans-cli-tui: persistence type (#11510) (d8c0cab)</li> <li>jans-cli-tui: user jansStatus is in body not custom attrbiute (#11615) (d809779)</li> <li>jans-linux-setup: re compatibility (#11483) (3bc9193)</li> <li>jans-orm: use password.method prefix for all hash algs (#11502) (62b322f)</li> <li>jans-scipt: correct script imports (#11516) (385219e)</li> <li>jans-scipt: correct script imports (#11517) (2b74d24)</li> <li>prepare release 1.8.0 (#11647) (f29d9a3)</li> </ul>"},{"location":"CHANGELOG/#170-2025-05-20","title":"1.7.0 (2025-05-20)","text":""},{"location":"CHANGELOG/#features_7","title":"Features","text":"<ul> <li>jans-auth-server: added refresh token lifetime to Token Endpoint response #11400 (#11414) (00d7c88)</li> <li>jans-cedarling: update plugin to use binding (#11356) (c61ef53)</li> <li>jans-cli-tui: ssa templates (#11368) (ed18096)</li> <li>jans-core: add jakarta.mail for TLS support (#11428) (8cf6b68)</li> <li>jans-lock: try to reload /.well-known/openid-configuration on f\u2026 (#11392) (00e2257)</li> <li>jans-lock: try to reload /.well-known/openid-configuration on failure (00e2257)</li> <li>use cedarling uniffi kotlin binding in java project (#11336) (067b3c1)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_7","title":"Bug Fixes","text":"<ul> <li>docs: add Config API OpenAPI Spec generation at build time (#11407) (70277c5)</li> <li>docs: add sections to place ADRs and design decisions (#11380) (4c0db93)</li> <li>docs: refactor development docs to add content from Wiki (#11409) (71d133f)</li> <li>docs: update curl instructions for jans config api (#11415) (39b6b82)</li> <li>jans-cedarling: fix logs in jwt module not getting displayed correctly (#11369) (e856545)</li> <li>jans-cli-tui: array type in auth properties (#11399) (6e4d7e4)</li> <li>jans-cli-tui: object type configuration properties (#11391) (7cf13a1)</li> <li>mail dependencies (#11426) (58c02b0)</li> <li>remove version_name attribute from manifest.json (#11387) (0febbd9)</li> </ul>"},{"location":"CHANGELOG/#miscellaneous-chores_2","title":"Miscellaneous Chores","text":"<ul> <li>prepare release 1.7.0 (#11432) (13e4c41)</li> </ul>"},{"location":"CHANGELOG/#160-2025-05-08","title":"1.6.0 (2025-05-08)","text":""},{"location":"CHANGELOG/#bug-fixes_8","title":"Bug Fixes","text":"<ul> <li>fix(jans-linux-setup): pass -n to setup.py when invoked by -yes by @devrimyatar in https://github.com/JanssenProject/jans/pull/11180</li> <li>fix(docs): fix image paths in SAML SSO document by @ossdhaval in https://github.com/JanssenProject/jans/pull/11183</li> <li>fix(docs): add missing script to index by @yurem in https://github.com/JanssenProject/jans/pull/11186</li> <li>fix(jans-auth-server): Access Token from and OIDC flow should not contain the code #11181 by @yuriyz in https://github.com/JanssenProject/jans/pull/11197</li> <li>docs(jans-cedarling): improve cedarling docs by @rmarinn in https://github.com/JanssenProject/jans/pull/11193</li> <li>docs(jans-cedarling): new quickstart using tarp by @SafinWasi in https://github.com/JanssenProject/jans/pull/11004</li> <li>chore: release nightly by @moabu in https://github.com/JanssenProject/jans/pull/11213</li> <li>feat(jans-auth-server): add none client authentication support to PAR endpoint #10573 by @yuriyz in https://github.com/JanssenProject/jans/pull/11201</li> <li>feat: add ability to use cedarling authz before and after authentication by @duttarnab in https://github.com/JanssenProject/jans/pull/11203</li> <li>fix(jans-cedarling)!: role entity not being created in the unsigned interface by @rmarinn in https://github.com/JanssenProject/jans/pull/11176</li> <li>fix(docs): proofread and update the Cedarling quick start guide by @ossdhaval in https://github.com/JanssenProject/jans/pull/11210</li> <li>fix(docs): proofread and update the TBAC Cedarling quick start guide by @ossdhaval in https://github.com/JanssenProject/jans/pull/11214</li> <li>fix(docs): update titles for the Cedarling quick start guides by @ossdhaval in https://github.com/JanssenProject/jans/pull/11220</li> <li>Update rhel.md for sha command update by @manojs1978 in https://github.com/JanssenProject/jans/pull/11189</li> <li>feat: refactor tarp to adjust with security changes in chrome browser by @duttarnab in https://github.com/JanssenProject/jans/pull/11232</li> <li>feat(jans-linux-setup): support for cleanUpInactiveClientAfterHoursOfInactivity for clients by @devrimyatar in https://github.com/JanssenProject/jans/pull/11231</li> <li>chore(deps): bump blazemeter/taurus from 1.16.38@sha256:5bb39436180f7c769e00140b781bb1054a1eb4592dd9b82f76dcde470811bf39 to sha256:aa22ab6b42d24ec87ea9f68e4d6db9118619eecf69db76c1c0711f3515897780 in /demos/benchmarking/docker-jans-loadtesting-jmeter by @dependabot in https://github.com/JanssenProject/jans/pull/11238</li> <li>fix(jans-cedarling): entity builder not finding the 'iss' entity by @rmarinn in https://github.com/JanssenProject/jans/pull/11235</li> <li>bug(jans-cedarling)!: Fix all tokens_metadata to token_metadata by @olehbozhok in https://github.com/JanssenProject/jans/pull/11215</li> <li>feat(jans-auth-server): add configurable way to put user claims to session attributes #9625 by @yuriyz in https://github.com/JanssenProject/jans/pull/11219</li> <li>fix: validate license configuration in the database when fetching license details from Agama Lab server upon expiry (Admin UI) by @duttarnab in https://github.com/JanssenProject/jans/pull/11245</li> <li>fix(jans-pycloudlib): resolve schema error caused by marshmallow upgrades by @iromli in https://github.com/JanssenProject/jans/pull/11247</li> <li>fix: remove ID from profile instead of nullify it by @jgomer2001 in https://github.com/JanssenProject/jans/pull/11253</li> <li>chore(cloud-native): sync jans-pycloudlib to handle marshmallow library API changes by @iromli in https://github.com/JanssenProject/jans/pull/11255</li> <li>feat: rename jans-tarp project to janssen-tarp by @duttarnab in https://github.com/JanssenProject/jans/pull/11249</li> <li>chore: updgrade nimbus so json-smart is bumped to 2.5.2 by @jgomer2001 in https://github.com/JanssenProject/jans/pull/11264</li> <li>chore(jans-cedarling): add post to cedar schema by @SafinWasi in https://github.com/JanssenProject/jans/pull/11227</li> <li>[Snyk] Security upgrade io.swagger.core.v3:swagger-core-jakarta from 2.2.7 to 2.2.11 by @mo-auto in https://github.com/JanssenProject/jans/pull/11166</li> <li>build(config-api): lib version to resolve vulnerabilities  by @pujavs in https://github.com/JanssenProject/jans/pull/11262</li> <li>feat(core): update resteasy to new version by @yurem in https://github.com/JanssenProject/jans/pull/11269</li> <li>Update resteasy by @yurem in https://github.com/JanssenProject/jans/pull/11273</li> <li>fix(jans-cedarling): fix usage outdated field resource_type by @olehbozhok in https://github.com/JanssenProject/jans/pull/11266</li> <li>fix(bom): use right jakarta.ws.rs-api version by @yurem in https://github.com/JanssenProject/jans/pull/11278</li> <li>feat(jans-cedarling): Optimize Cedar libraries size by @olehbozhok in https://github.com/JanssenProject/jans/pull/11281</li> <li>fix(jans-cedarling): fix docs bootstrap properties, remove redundant property by @olehbozhok in https://github.com/JanssenProject/jans/pull/11275</li> <li>fix(bom): deprecate jackson-module-jaxb-annotations by @yurem in https://github.com/JanssenProject/jans/pull/11286</li> <li>fix(bom): deprecate jackson-module-jaxb-annotations by @yurem in https://github.com/JanssenProject/jans/pull/11287</li> <li>fix(core): fix ClassNotFoundException XmlElement exception by @yurem in https://github.com/JanssenProject/jans/pull/11293</li> <li>fix(cloud-native): demo scripts fail to deploy cluster due to python externally-managed-environment error by @iromli in https://github.com/JanssenProject/jans/pull/11290</li> <li>feat(jans-cedarling): add some logging msgs for jwt service startup by @rmarinn in https://github.com/JanssenProject/jans/pull/11178</li> <li>feat: add field reset button in cedarling authz form by @duttarnab in https://github.com/JanssenProject/jans/pull/11260</li> <li>fix: update terraform provider docs and API calls by @moabu in https://github.com/JanssenProject/jans/pull/11301</li> <li>feat(jans-cli-tui): splash screen by @devrimyatar in https://github.com/JanssenProject/jans/pull/11298</li> <li>feat: allow linking to occur in a popup by @jgomer2001 in https://github.com/JanssenProject/jans/pull/11305</li> <li>fix(config-api): custom script creation failing #11307 by @pujavs in https://github.com/JanssenProject/jans/pull/11308</li> <li>Jans linux setup jetty 12 11276 by @devrimyatar in https://github.com/JanssenProject/jans/pull/11295</li> <li>fix(jans-cli-tui): add pylib to path before importing promptoolkit by @devrimyatar in https://github.com/JanssenProject/jans/pull/11313</li> <li>feat(jans-cedarling): go binding for cedarling by @olehbozhok in https://github.com/JanssenProject/jans/pull/11239</li> <li>fix(jans-linux-setup): jetty.sh script waits service started by @devrimyatar in https://github.com/JanssenProject/jans/pull/11319</li> <li>feat(jans-auth): add missing erver side tests dependecy by @yurem in https://github.com/JanssenProject/jans/pull/11315</li> <li>Lock api by @yurem in https://github.com/JanssenProject/jans/pull/11317</li> <li>Auth deps by @yuremm in https://github.com/JanssenProject/jans/pull/11321</li> <li>feat(jans-config-api): disable jetty ee9-jsp module in jans-config-api by @yurem in https://github.com/JanssenProject/jans/pull/11324</li> <li>chore(deps): bump setuptools from 70.0.0 to 80.1.0 in /docs by @dependabot in https://github.com/JanssenProject/jans/pull/11327</li> <li>chore(deps): bump blazemeter/taurus from 1.16.40 to 1.16.41 in /demos/benchmarking/docker-jans-loadtesting-jmeter by @dependabot in https://github.com/JanssenProject/jans/pull/11302</li> <li>chore(deps): bump docker/setup-qemu-action from 5306bad0baa6b616b9934712d4eba8da2112606d to 737ba1e397ec2caff0d098f75e1136f9a926dc0a by @dependabot in https://github.com/JanssenProject/jans/pull/11283</li> <li>chore(deps): bump actions/setup-python from 5.0.0 to 5.6.0 by @dependabot in https://github.com/JanssenProject/jans/pull/11282</li> <li>chore(deps): bump sigstore/cosign-installer from 3.5.0 to 3.8.2 by @dependabot in https://github.com/JanssenProject/jans/pull/11270</li> <li>fix(jans-fido2): #11331 minor edits by @maduvena in https://github.com/JanssenProject/jans/pull/11332</li> <li>chore: misc casa image updates by @jgomer2001 in https://github.com/JanssenProject/jans/pull/11334</li> <li>docs: add cedarling rust docs by @moabu in https://github.com/JanssenProject/jans/pull/11311</li> <li>chore(deps): bump org.quartz-scheduler:quartz from 2.3.2 to 2.5.0 in /jans-casa by @dependabot in https://github.com/JanssenProject/jans/pull/10206</li> <li>chore(deps): bump commons-io:commons-io from 2.17.0 to 2.19.0 in /jans-casa by @dependabot in https://github.com/JanssenProject/jans/pull/11217</li> <li>fix: fix the android and iOS sample app based on changes in cedarling uniffi binding by @duttarnab in https://github.com/JanssenProject/jans/pull/11294</li> <li>chore(deps): bump org.apache.maven.plugins:maven-clean-plugin from 2.5 to 3.4.1 in /jans-casa by @dependabot in https://github.com/JanssenProject/jans/pull/10903</li> <li>chore(deps): bump org.apache.maven.plugins:maven-war-plugin from 2.3 to 3.4.0 in /jans-casa by @dependabot in https://github.com/JanssenProject/jans/pull/9985</li> <li>chore(deps): bump org.apache.maven.plugins:maven-resources-plugin from 2.6 to 3.3.1 in /jans-casa by @dependabot in https://github.com/JanssenProject/jans/pull/9996</li> <li>chore(deps): bump org.apache.maven.plugins:maven-site-plugin from 2.1.1 to 3.21.0 in /jans-casa by @dependabot in https://github.com/JanssenProject/jans/pull/10064</li> <li>chore(ci): SBOM enrichment and upload as a release asset by @ossdhaval in https://github.com/JanssenProject/jans/pull/11267</li> <li>feat(cloud-native): upgrade to Jetty 12 by @iromli in https://github.com/JanssenProject/jans/pull/11297</li> <li>fix(jans-cedarling): switch cedarling instance to pointer by @SafinWasi in https://github.com/JanssenProject/jans/pull/11338</li> <li>fix(core): fix unable to decorate com.sun.faces.config.ConfigureListener by @yurem in https://github.com/JanssenProject/jans/pull/11345</li> <li>feat(jans-link): turn off Weld dev mode in production by @yuremm in https://github.com/JanssenProject/jans/pull/11347</li> <li>fix(charts): missing feature of jans-keycloak-link by @iromli in https://github.com/JanssenProject/jans/pull/11257</li> <li>fix(jans-cli-tui): include jans-logo.txt in package by @devrimyatar in https://github.com/JanssenProject/jans/pull/11359</li> <li>fix(jans-cli-tui): smtp test failing #11330 by @pujavs in https://github.com/JanssenProject/jans/pull/11358</li> <li>feat(jans-auth): restore Nashorn engine by @yurem in https://github.com/JanssenProject/jans/pull/11363</li> <li>fix: update javadocs plugin to allow generation of javadocs by @moabu in https://github.com/JanssenProject/jans/pull/11364</li> <li>chore: prepare release of 1.6.0 by @moabu in https://github.com/JanssenProject/jans/pull/11376</li> <li>fix: tf license by @moabu in https://github.com/JanssenProject/jans/pull/11382</li> </ul>"},{"location":"CHANGELOG/#150-2025-04-04","title":"1.5.0 (2025-04-04)","text":""},{"location":"CHANGELOG/#breaking-changes","title":"\u26a0 BREAKING CHANGES","text":"<ul> <li>jans-cedarling: move TOKEN_CONFIGS into the token_metadata schema (#10972)</li> </ul>"},{"location":"CHANGELOG/#features_8","title":"Features","text":"<ul> <li>add ability to decode token jwt so that users can check claims in payload (#10930) (a88aab3)</li> <li>add ability to show decision, system and metric logs in tarp based on user selection (#10917) (4df25f0)</li> <li>add ability to to use cedarling authorize_unsigned in tarp (#11147) (3185a89)</li> <li>add tolerations (03ae383)</li> <li>add tolerations to helm charts (#11100) (03ae383)</li> <li>admin-ui should only make monthly request agama-lab to validate license (#10966) (3647fe8)</li> <li>apply password policy to set/reset password  (#11149) (52f0f47)</li> <li>charts: cloudtools integration with Helm charts (#11102) (5739aa3)</li> <li>cloud-native: create utility image to run commands for cluster (#10987) (51e175c)</li> <li>code refactoring for UI improvement in tarp (#11151) (123e62f)</li> <li>docs: session management (#11098) (d3fcf8b)</li> <li>jans-auth-server: do not return claim in introspection response if it's null.  #10865 (#10877) (eb3de16)</li> <li>jans-auth-server: introduce rate limit support for DCR (#10991) (6a1ccce)</li> <li>jans-auth-server: make all ssa attributes optional during creation #10858 (#10896) (a01b1ca)</li> <li>jans-auth-server: rate limit - use guava cache to auto-expire buckets during high load #11054 (#11059) (01a0a9f)</li> <li>jans-auth-server: removed CleanerTimer from AS (replaced by independent clean service)  (#11096) (bb51848)</li> <li>jans-auth-server: requirePkce configuration property on client level (#10962) (4cda61c)</li> <li>jans-auth-server: set expiration to the past (to clean up) on SSA revoke #10916 (#10939) (8c460ca)</li> <li>jans-cedarling: add alias to load key policy_store_version` (#10893) (21e4acc)</li> <li>jans-cedarling: add an example that runs profiling (#10979) (dc38e10)</li> <li>jans-cedarling: Add bootstrap properties of memory logger max_items and max_item_size (#10924) (2189094)</li> <li>jans-cedarling: create uniffi binding for cedarling with sample ios app using it (#10816) (026ed0b)</li> <li>jans-cedarling: implement loading types from other namespace (#10807) (da05595)</li> <li>jans-cedarling: include a sample android app in cedarling uniffi binding (#10994) (5b74f9d)</li> <li>jans-cedarling: New interface: authorizeUnverified - send Principal as Object v. JWT (#11035) (37b72ad)</li> <li>jans-cedarling: Support JSON logic for principal boolean operations (#10956) (cbe4dbc)</li> <li>jans-cli-tui: add hints to fido configuration screen (#10864) (39ffa8a)</li> <li>jans-cli-tui: SSA custom attributes 10855 (#10870) (6f2cb6b)</li> <li>jans-linux-setup: data cleaning cron job task (#10946) (33d5eb2)</li> <li>jans-linux-setup: LDAP Link installation is optional (#10964) (673d7fb)</li> <li>jans-linux-setup: link jans script to /usr/local/bin (#11125) (d8c7a17)</li> <li>jans-linux-setup: link jans script to /usr/localbin (d8c7a17)</li> <li>jans-linux-setup: ubuntu24 support (#10949) (481fdca)</li> <li>jans-lock: configure maven to update OpenAPI lock-server.yaml (#10952) (11c2249)</li> <li>jans-lock: configure maven to update OpenAPI lock-server.yaml (#10953) (a8f09f2)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_9","title":"Bug Fixes","text":"<ul> <li>admin UI unable to fetch MAU _threshold on restart of config-api (b4cfaa2)</li> <li>charts: broken istio integration (#11041) (8b536ab)</li> <li>core: remove jansAlias from jansDocument (#11085) (a3a9bb2)</li> <li>docs: add Cedarling quick start guide and binding type documents (#10906) (bc0686f)</li> <li>docs: Cedarling docs updates (#10998) (903e29f)</li> <li>docs: Cedarling documentation reorganisation (#10900) (33920c2)</li> <li>docs: incorrect package name in rhel document (#10890) (1d98a9c)</li> <li>docs: moving contributor license agreement to GitHub (#11034) (6ce100a)</li> <li>docs: remove agama lab quick start guide (7a7ae38)</li> <li>docs: remove agama lab quick start guide from Jans docs (#11132) (7a7ae38)</li> <li>docs: review and update Cedarling WASM document (#10988) (2136bdf)</li> <li>docs: update cedarling docs navigation (#11001) (4da085f)</li> <li>docs: update document titles for better search results (#11105) (6b6815d)</li> <li>docs: update titles for better docs search results (#11131) (b9cb65e)</li> <li>error when deselect one of the tokens in the cedarling authz form (#10986) (8444271)</li> <li>fox docs formatting (3da3644)</li> <li>ignore null authz input tokens (56af565)</li> <li>jans-auth-server: correction after removing CleanerTimer from AS (replaced by independent clean service) #10935 (#11108) (13b5ea6)</li> <li>jans-cedarling: fix <code>CEDARLING_TOKEN_CONFIGS</code> to have namespace (66dd8a7)</li> <li>jans-cedarling: fix documentation CEDARLING_POLICY_STORE_LOCAL can hold only string (#11015) (2c6a112)</li> <li>jans-cedarling: fix log workload authz info (87672d8)</li> <li>jans-cedarling: ignore null authz input tokens and improve error message (#11063) (56af565)</li> <li>jans-cedarling: reason missing from decision log (#10895) (87672d8)</li> <li>jans-cli-tui: Catch errors when changing user password (#11154) (9fc36c3)</li> <li>jans-cli-tui: multivalued claims for users (#11011) (159b512)</li> <li>jans-cli-tui: null value in client grantTypes (#10872) (a609f8c)</li> <li>jans-cli-tui: properties acrMappings (#11048) (f025083)</li> <li>jans-cli-tui: typo in editing attribute (#11152) (f42dd4a)</li> <li>jans-config-api: admin UI unable to fetch MAU _threshold on restart of config-api (#10969) (b4cfaa2)</li> <li>jans-core: reverted back CleanerEvent (used by fido2) #11113 (#11115) (266583f)</li> <li>jans-fido2: #10244 + docs (#11057) (3912551)</li> <li>jans-fido2: #10947 syncing configuration parameters in docs and \u2026 (#10948) (b635cbc)</li> <li>jans-fido2: #10947 syncing configuration parameters in docs and templates (b635cbc)</li> <li>jans-fido2: fixes to downloading mds3 blob #11126 (#11127) (3776c0c)</li> <li>jans-fido2: U2F attestation and corrected auth_cert link #10911 (#10912) (b47ca75)</li> <li>jans-linux-setup: lock client creation with setup.properties (#10929) (f374ed2)</li> <li>jans-linux-setup: owner of service status script (#11122) (aad24a3)</li> <li>jans-linux-setup: rename permission to role in attribute inum=6049 (#10915) (359dc75)</li> <li>jans-tarp: unsigned authorization form not working (#11159) (cc9c7fd)</li> <li>logging: improve detail formatting (#10955) (9334d61)</li> <li>return 500 instead of 404 on lookup error (#11156) (ecc1eac)</li> <li>scope not getting added if dropdown is not used (#10908) (63bc735)</li> <li>show proper error message for when MAU threshold absent when checking flex license (#11110) (40f9d09)</li> <li>show proper error message for when MAU threshold absent when checking flex license #11093 (40f9d09)</li> <li>ssaCustomAttributes is missing in response from Auth server Configuration endpoint (#11120) (b4a4cf6)</li> </ul>"},{"location":"CHANGELOG/#code-refactoring","title":"Code Refactoring","text":"<ul> <li>jans-cedarling: move TOKEN_CONFIGS into the token_metadata schema (#10972) (533236a)</li> </ul>"},{"location":"CHANGELOG/#140-2025-02-12","title":"1.4.0 (2025-02-12)","text":""},{"location":"CHANGELOG/#features_9","title":"Features","text":"<ul> <li>agama: add support for parameterizable enter/exit urls in flows (#10716) (71fbcb7)</li> <li>agama: allow integration of Agama flows in AS consent (#10727) (4ef6c9a)</li> <li>config-api: lock stat endpoint and SAML TR fix (#10755) (11bddd1)</li> <li>config-api: testng framework cleanup changes (#10736) (77d6646)</li> <li>demo-tarp: use @janssenproject/cedarling_wasm npm package #10805 (#10806) (b178d4a)</li> <li>jans-auth-server: allow invoke consent script by acr #10548 (#10712) (e1982e1)</li> <li>jans-cedarling: add krakend plugin (#10713) (78457b6)</li> <li>jans-cedarling: custom tokens and putting tokens in principal attrs (#10706) (c342a05)</li> <li>jans-cedarling: implement benchmarks for startup and authz (#10775) (80f0b63)</li> <li>jans-cedarling: implement environment variable loading for sidecar (#10751) (21d8ef5)</li> <li>jans-cedarling: Improve log searching and retrieval (#10772) (9286f82)</li> <li>jans-cedarling: Load bootstrap properties from environment variables (#10692) (d7200cb)</li> <li>jans-cedarling: update sidecar for log retrieval (#10786) (bd67f89)</li> <li>jans-linux-setup: restart admin-ui via jans (#10740) (2a0aaf6)</li> <li>jans-lock: redirect for consent if external script is enabled a\u2026 (#10771) (c3e4a97)</li> <li>jans-lock: redirect for consent if external script is enabled and client is not authorized (c3e4a97)</li> <li>update help section of tarp (#10708) (bee683b)</li> <li>use @janssenproject/cedarling_wasm npm package #10805 (b178d4a)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_10","title":"Bug Fixes","text":"<ul> <li>account absent start url in native flows (#10731) (2c0cc62)</li> <li>account absent start url in native flows #10729 (2c0cc62)</li> <li>align consent script wrt latest AS updates (#10780) (6cb802b)</li> <li>config-api: asset upload config and saml document store changes (#10734) (8e9d43e)</li> <li>Corrected fido-2-devices link to heading in user management document. issue#9636. (8ffc483)</li> <li>docs: corrected fido-2-devices link to heading in user management document (8ffc483)</li> <li>docs: update Agama Lab quick start guide (#10779) (7403ed1)</li> <li>docs: update broken link in custom claims document (#10781) (40b7039)</li> <li>docs: update LDAP link document with configuration details (#10824) (53dd493)</li> <li>jans-auth-server: always save access_token to persistence regardless of cache configuration #10763 (#10784) (cf8ce67)</li> <li>jans-auth-server: second authorization challenge call does not invoke the right script #10745 (#10746) (3ba585c)</li> <li>jans-auth-server: typo in determineConsentFlow method #10758 (#10759) (52cabdb)</li> <li>jans-cedarling: fix token handling (#10761) (2533e30)</li> <li>jans-cli-tui: save config-api configuration (#10724) (6a955a4)</li> <li>jans-cli-tui: ScrollablePane for config-api main screen (#10722) (4585f3a)</li> <li>jans-linux-setup: fido document store paths (#10801) (881c1e0)</li> <li>jans-linux-setup: revert admin-ui restart (27faefc)</li> <li>jans-linux-setup: Store fido2 authenticator_cert in DB (#10697) (86966df)</li> <li>jans-linux-setup: update jansservices module post setup (#10715) (cfa301f)</li> <li>references to file location_type (#10797) (cfaab7e)</li> <li>update resource endpoints for terraform (#10836) (5dfee2b)</li> </ul>"},{"location":"CHANGELOG/#130-2025-01-20","title":"1.3.0 (2025-01-20)","text":""},{"location":"CHANGELOG/#features_10","title":"Features","text":"<ul> <li>agama: modify RRF and RFAC behavior for non-web clients (#10547) (58fd359)</li> <li>allow integration of Agama flows into the authz challenge enpoint (#10587) (856f9fe)</li> <li>cedarling integration with tarp (#10681) (4f44337)</li> <li>cloud-native: secure mounted configuration schema (#10577) (57c266a)</li> <li>extract wasm tar in /jans-tarp folder (#10689) (ca8f453)</li> <li>integrate cedarling with jans-tarp (#10662) (9f9ae8a)</li> <li>jans-auth-server: introduced new 'prepareAuthzRequest' method in authorization challenge script (#10598) (02c240e)</li> <li>jans-auth: log current folder in UserJansExtUidAttributeTest test (ca79ace)</li> <li>jans-auth: log current folder in UserJansExtUidAttributeTest test (#10667) (51ce4dc)</li> <li>jans-auth: Remove copyright footer (#10666) (474661c)</li> <li>jans-auth: Show valid client name or id in consent form (#10649) (5a53d53)</li> <li>jans-cedarling: add to decision log diagnostic info (#10581) (6f8dc7c)</li> <li>jans-cedarling: add WASM bindings for Cedarling (#10542) (ec7c7e1)</li> <li>jans-cedarling: implement CEDARLING_ID_TOKEN_TRUST_MODE (#10585) (d76f28c)</li> <li>jans-cedarling: Make SparKV use generics, and update MemoryLogger to use those. (#10593) (25c7a49)</li> <li>jans-fido2: Add test cases for RP domain origin validation and handle multiple origins #9248 (22f0cbe)</li> <li>jans-fido2: Add test cases for RP domain origin. (#10572) (22f0cbe)</li> <li>jans-lock: lock should collect MAU and MAC based on log entries\u2026 (#10328) (b8a7e1a)</li> <li>jans-pycloudlib: secure mounted configuration schema (#10551) (2d27184)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_11","title":"Bug Fixes","text":"<ul> <li>actions: immutable github sha  instead of github head_ref (5091b56)</li> <li>agama: update expected status code (#10618) (c0dce75)</li> <li>build acct linking agama (#10575) (85b95ec)</li> <li>cloud-native: add missing endpoints to aio image (#10595) (5fb1903)</li> <li>cloud-native: resolve image builds on slow network (#10524) (3409098)</li> <li>config-api: setting agama flow as auth method (#10539) (3c00152)</li> <li>docker-jans-auth: missing permissions on /app/templates (#10641) (f1b3ca2)</li> <li>docker-jans-persistence-loader: exclude external tables when creating indexes (#10522) (9610bc1)</li> <li>docs: add documentation for <code>jans</code> wrapper command (#10611) (b65f5e1)</li> <li>docs: correct the file name for Keycloak link document (#10680) (35e6ef0)</li> <li>docs: minor fixes to the Jans README (#10604) (41bf8b8)</li> <li>docs: minor URL fixes (ba9908d)</li> <li>docs: minor URL fixes (#10632) (ba9908d)</li> <li>docs: remove tent references (040ff17)</li> <li>docs: remove tent references from documentation (#10603) (040ff17)</li> <li>implement missing method from interface (#10646) (2381a09)</li> <li>jans-auth-server: access evaluation tests are failing on jenkins (#10630) (8789289)</li> <li>jans-auth-server: access evaluation tests are failing on jenkins #10629 (37e177c)</li> <li>jans-auth-server: access evaluation tests are failing on jenkins #10629 (8789289)</li> <li>jans-auth-server: challenge endpoint returns 400 if authorize throws an unexpected exception (#10553) (02c3df7)</li> <li>jans-auth-server: failing test - SelectAccountHttpTest selectAccountTest #10647 (d19e34f)</li> <li>jans-auth-server: NPE during client name rendering #10663  (9dbcb0d)</li> <li>jans-auth-server: test is failing - TokenRestWebServiceHttpTest requestAccessTokenFail #10637 (db38009)</li> <li>jans-auth-server: tests corrections (ef8a07a)</li> <li>jans-auth: log current folder in UserServiceTest test (#10675) (1468b47)</li> <li>jans-cedarling: fix Cedarling WASM docs (#10601) (7690030)</li> <li>jans-kc-link: remove default keycloak configs (#10679) (261c936)</li> <li>jans-keycloak-link: unstatisfied dependencies (#10627) (721b8fe)</li> <li>startjanssendemo: enhance the script (1ba8e98)</li> <li>startjanssendemo: remove unneeded code and packages installation (#10531) (1ba8e98)</li> <li>update token script (role_based_scopes_update_token) should reje\u2026 (#10536) (3cd5d88)</li> <li>update token script (role_based_scopes_update_token) should reject the tampered user-info-jwt #10535 (3cd5d88)</li> </ul>"},{"location":"CHANGELOG/#120-2024-12-24","title":"1.2.0 (2024-12-24)","text":""},{"location":"CHANGELOG/#features_11","title":"Features","text":"<ul> <li>add internationalization in selector page (#10405) (00facf6)</li> <li>add programatic access to labels in Agama (#10313) (1e91d9b)</li> <li>config-api: agama download endpoint (#10463) (5bec96c)</li> <li>config-api: implemenetd agama repo endpoint and fixed user pwd validation for patch (#10373) (03d3529)</li> <li>jans-agama: update htmlunit (#10464) (3cc7c5a)</li> <li>jans-auth-server: access token lifetime from UpdateToken interception script has highest priority #9748 (#10379) (c2ef55d)</li> <li>jans-auth-server: added exp,nbf, and iat to UserInfo JWT (#10390) (c99a71a)</li> <li>jans-auth-server: allow to use openidSubAttribute for localAccountId for pairwise identifier look up #9696 (#10269) (5d72a06)</li> <li>jans-auth-server: introduced <code>/.well-known/authzen-configuration</code> endpoint (#10321) (efb7ab6)</li> <li>jans-auth-server: updated first party native authn implementation ( in backwards compatibility way) #10380 (#10442) (bc431fb)</li> <li>jans-cedarling: add logging <code>cedarling</code> version on start application (#10288) (20ed173)</li> <li>jans-cedarling: add support for Cedar schema action introspection (#10358) (ed0edb9)</li> <li>jans-cedarling: add well-known authzen configuration endpoint (#10435) (cc6fc7b)</li> <li>jans-cedarling: automatically add entity references into the context (#10387) (ed44ec0)</li> <li>jans-cedarling: Bootstrap support for JSON and YAML properties (#10216) (e7ffb08)</li> <li>jans-cedarling: implement loading policy store from CEDARLING_POLICY_STORE_URI (#10336) (ffe9f49)</li> <li>jans-cedarling: implement loading role from many JWT tokens (#10422) (8da040e)</li> <li>jans-cedarling: implement new bootstrap configs for JWT validation (#10306) (6d810a5)</li> <li>jans-cedarling: initialize flask sidecar (#10270) (46f9a51)</li> <li>jans-cedarling: pass entities data into the context (#10275) (e2e4f89)</li> <li>jans-cli-tui: user fido devices (#10305) (811d953)</li> <li>jans-fido2: major FIDO2 / Passkeys upgrade ProjectPasskeys (#10080) (e823bf7)</li> <li>jans-link: add ingress resource for jans-link (#10494) (2779a7e)</li> <li>jans-linux-setup: jans-fido2-model auth lib (#10468) (f99d870)</li> <li>jans-linux-setup: location of service scripts, config-api plugins (#10341) (7299fea)</li> <li>jans-linux-setup: Retreive Agama Lab project scripts (#10335) (26713a8)</li> <li>migrate and fix e-mail otp plugin (#10294) (d3f83cb)</li> <li>misc UI updates (#10278) (c0a6639)</li> <li>terraform-provider-jans: update terraform provider with latest API changes (#10485) (075650c)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_12","title":"Bug Fixes","text":"<ul> <li>actions: microk8s action passing correct arguments (#10363) (a1517a0)</li> <li>assign nightly version (2dd3484)</li> <li>bom: deprecate commons-lang due to conflict with commons-lang3 (#10267) (396551e)</li> <li>bug if version passed is a tag (82694ca)</li> <li>cloud-native: applications are failing to start when prometheus metrics are enabled (#10459) (b293ebe)</li> <li>config-api: application status endpoint specification changes (#10203) (c49a0af)</li> <li>config-api: user password being displayed as clear text (#10441) (4e7c13b)</li> <li>config-api: user password patch fix  (#10396) (0345f11)</li> <li>docker-jans-config-api: resolve path to external healthcheck script (#10450) (bef11a6)</li> <li>docker-jans-monolith: update scripts location (#10481) (45fe7a5)</li> <li>docs: autogenerate docs (#10232) (50e5957)</li> <li>jans-auth-server: lower possibility to get data loss during status index pool update #10284 (#10285) (16371ee)</li> <li>jans-auth: fido - #10445 modified the script and properties file for fido (#10446) (99285e9)</li> <li>jans-auth: fix client side jans-auth tests failures #10212 (#10213) (c0bc881)</li> <li>jans-casa: #10470 Enrollment of a passkey implies the enrollment of all three types of authenticator - client-device, hybrid, security-key (b0a7da3)</li> <li>jans-casa: assign nightly version for email 2fa plugin (#10300) (2dd3484)</li> <li>jans-casa: enrollment of a passkey implies the enrollment\u2026 (#10473) (b0a7da3)</li> <li>jans-cedarling: add handling nonexistent authorization decisions (#10431) (29d9bc6)</li> <li>jans-cedarling: add missing fields on LogEntry struct (#10297) (b91279f)</li> <li>jans-cedarling: fix sidecar docker (#10361) (48e8eae)</li> <li>jans-cedarling: revert \"pass entities data into the context\" (#10290) (5e10625)</li> <li>jans-cedarling: update example authorize_without_jwt_validation (#10308) (ccb376c)</li> <li>jans-cli-tui: display error for session search (#10251) (87a6c39)</li> <li>jans-cli-tui: properties object with no keys (#10411) (e0f55a0)</li> <li>jans-cli-tui: update user password (#10456) (927befc)</li> <li>jans-config-api: unable to update Admin-ui feature in webhook (#10220) (1244488)</li> <li>jans-fido: Resolve dependecy issue  (a71e866)</li> <li>jans-fido: Resolve dependecy issue #10080 (#10406) (b6b45e1)</li> <li>jans-keycloak-integration: kc startup issues #10348 (#10349) (ecd8e38)</li> <li>jans-linux-setup: auth server test configuration (#10365) (e68d275)</li> <li>jans-linux-setup: bug if version passed is a tag (#10274) (82694ca)</li> <li>jans-linux-setup: config-api plugin installation (#10389) (59ba1b0)</li> <li>jans-linux-setup: display CLI logs in jans script (#10262) (ef0f4fe)</li> <li>jans-linux-setup: download from tags (#10391) (c6d95a1)</li> <li>jans-orm: merge ORM changes from Gluu (#10293) (17e9443)</li> <li>monolithic: update scripts location (45fe7a5)</li> </ul>"},{"location":"CHANGELOG/#116-2024-11-20","title":"1.1.6 (2024-11-20)","text":""},{"location":"CHANGELOG/#breaking-changes_1","title":"\u26a0 BREAKING CHANGES","text":"<ul> <li>chore(charts)!: remove spanner support from Helm charts by @iromli in https://github.com/JanssenProject/jans/pull/10071</li> <li>chore(cloud-native)!: remove spanner support from OCI images by @iromli in https://github.com/JanssenProject/jans/pull/10070</li> <li>chore(jans-pycloudlib)!: remove couchbase support from pycloudlib by @iromli in https://github.com/JanssenProject/jans/pull/10129</li> <li>chore(cloud-native)!: remove couchbase support from OCI images by @iromli in https://github.com/JanssenProject/jans/pull/10132</li> <li>chore(charts)!: remove couchbase support from Helm charts by @iromli in https://github.com/JanssenProject/jans/pull/10138</li> </ul>"},{"location":"CHANGELOG/#whats-changed","title":"What's Changed","text":"<ul> <li>chore(jans-linux-setup) remove spanner db by @devrimyatar in https://github.com/JanssenProject/jans/pull/10068</li> <li>chore(charts)!: remove spanner support from Helm charts by @iromli in https://github.com/JanssenProject/jans/pull/10071</li> <li>fix(config-api): date filter fix by @pujavs in https://github.com/JanssenProject/jans/pull/10075</li> <li>chore(docs): docs remove spanner refs by @ossdhaval in https://github.com/JanssenProject/jans/pull/10076</li> <li>feat(jans-cedarling): improve error handling for JWKS responses by @rmarinn in https://github.com/JanssenProject/jans/pull/9982</li> <li>feat(jans-cedarling): ensure that all cedarling test fixture files are human-readable. by @djellemah in https://github.com/JanssenProject/jans/pull/10036</li> <li>feat(jans-config-api): adding allowSmtpKeystoreEdit property in admin-ui configuration by @duttarnab in https://github.com/JanssenProject/jans/pull/10091</li> <li>fix(jans-cli-tui): more verbose in smtp test response by @devrimyatar in https://github.com/JanssenProject/jans/pull/10090</li> <li>fix(jans-bom): define plugins in base parent project by @yurem in https://github.com/JanssenProject/jans/pull/10087</li> <li>fix(jans-orm): throw exception if table in DB is not exists by @yurem in https://github.com/JanssenProject/jans/pull/10096</li> <li>fix(jans-casa): primary button not changing color when customized via custom branding plugin by @mjatin-dev in https://github.com/JanssenProject/jans/pull/10084</li> <li>fix(jans-cli-tui): remove filePath when putting asset by @devrimyatar in https://github.com/JanssenProject/jans/pull/10107</li> <li>fix(jans-lock): fix broken link in lock docs by @yurem in https://github.com/JanssenProject/jans/pull/10110</li> <li>feat(jans-cedarling): add env variable for python by @SafinWasi in https://github.com/JanssenProject/jans/pull/10115</li> <li>chore(cloud-native)!: remove spanner support from OCI images by @iromli in https://github.com/JanssenProject/jans/pull/10070</li> <li>chore: upgrade javascript libraries to newer versions in HTML files by @mjatin-dev in https://github.com/JanssenProject/jans/pull/10108</li> <li>fix: remove unnecessary mount for k8s setup by @moabu in https://github.com/JanssenProject/jans/pull/10112</li> <li>docs(update): custom scripts docs update by @mmrraju in https://github.com/JanssenProject/jans/pull/10125</li> <li>chore(jans-pycloudlib)!: remove couchbase support from pycloudlib by @iromli in https://github.com/JanssenProject/jans/pull/10129</li> <li>fix(docs): fix docs link by @ossdhaval in https://github.com/JanssenProject/jans/pull/10123</li> <li>chore(jans-linux-setup): drop couchbase support by @devrimyatar in https://github.com/JanssenProject/jans/pull/10133</li> <li>fix(docs): remove Couchbase references by @ossdhaval in https://github.com/JanssenProject/jans/pull/10119</li> <li>chore(jans-cedarling): remove ipaddr by @SafinWasi in https://github.com/JanssenProject/jans/pull/10140</li> <li>ci: move jenkins operations to GH by @moabu in https://github.com/JanssenProject/jans/pull/10082</li> <li>chore(cloud-native)!: remove couchbase support from OCI images by @iromli in https://github.com/JanssenProject/jans/pull/10132</li> <li>feat(jans-cedarling): Implement check authorization principals based on the schema for action by @olehbozhok in https://github.com/JanssenProject/jans/pull/10126</li> <li>fix(jans-orm): update SQL ORM tests to conform latest JSON Filter API by @yurem in https://github.com/JanssenProject/jans/pull/10150</li> <li>fix(jans-link): add missing configuration providers by @yurem in https://github.com/JanssenProject/jans/pull/10124</li> <li>feat(jans-cedarling): update Trusted Issuers schema in the policy store by @rmarinn in https://github.com/JanssenProject/jans/pull/10141</li> <li>fix(jans-bom): update libs by @yurem in https://github.com/JanssenProject/jans/pull/10154</li> <li>fix(config-api): adding missing scope in spec and udated example of search field by @pujavs in https://github.com/JanssenProject/jans/pull/10156</li> <li>fix(jans-linux-setup): use sqlconnection instead of mysqlconnection by @devrimyatar in https://github.com/JanssenProject/jans/pull/10161</li> <li>chore(cloud-native): upgrade libs to reduce vulnerabilities by @iromli in https://github.com/JanssenProject/jans/pull/10168</li> <li>chore(charts)!: remove couchbase support from Helm charts by @iromli in https://github.com/JanssenProject/jans/pull/10138</li> <li>fix(jans-linux-setup): missing scopes of api-admin by @devrimyatar in https://github.com/JanssenProject/jans/pull/10162</li> <li>feat(jans-cli-tui): session management by @devrimyatar in https://github.com/JanssenProject/jans/pull/10164</li> <li>feat: implement native internationalization for Agama projects by @jgomer2001 in https://github.com/JanssenProject/jans/pull/10165</li> <li>ci: remove python3 ldap package by @moabu in https://github.com/JanssenProject/jans/pull/10172</li> <li>chore: adjust projects that use localization labels by @jgomer2001 in https://github.com/JanssenProject/jans/pull/10174</li> <li>feat(jans-cedarling): implement mapping JWT payload to\u00a0<code>cedar-policy</code>\u00a0entity by @olehbozhok in https://github.com/JanssenProject/jans/pull/10169</li> <li>refactor(jans-cedarling): relax JWT validation to allow optional claims by @rmarinn in https://github.com/JanssenProject/jans/pull/10173</li> <li>fix(jans-cli-tui): file type scripts by @devrimyatar in https://github.com/JanssenProject/jans/pull/10181</li> <li>chore(jans-pycloudlib): remove ldap references from pycloudlib by @iromli in https://github.com/JanssenProject/jans/pull/10177</li> <li>fix: admin-ui plugin should send appropriate message on expiry/ for inactive license. #10178 by @duttarnab in https://github.com/JanssenProject/jans/pull/10189</li> <li>User auth test by @yurem in https://github.com/JanssenProject/jans/pull/10191</li> <li>chore(jans-cedarling): update python example and docs by @SafinWasi in https://github.com/JanssenProject/jans/pull/10183</li> <li>feat(jans-auth-server): openID AuthZEN implementation by @yuriyz in https://github.com/JanssenProject/jans/pull/10197</li> <li>chore(release): release 1.1.6 by @moabu in https://github.com/JanssenProject/jans/pull/10201</li> </ul>"},{"location":"CHANGELOG/#1021-2023-12-14","title":"1.0.21 (2023-12-14)","text":""},{"location":"CHANGELOG/#bug-fixes_13","title":"Bug Fixes","text":"<ul> <li>location for saml plugin (#7097) (c57ba6c)</li> <li>remove agama inbound jar dependency (#7095) (c58c55c)</li> </ul>"},{"location":"CHANGELOG/#1020-2023-11-08","title":"1.0.20 (2023-11-08)","text":""},{"location":"CHANGELOG/#features_12","title":"Features","text":"<ul> <li>jans-tarp: user should be allowed to paste an SSA (or specify a file from disk) in DCR form #6161 (#6467) (9b1f694)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_14","title":"Bug Fixes","text":"<ul> <li>prepare for 1.0.20 release (c6e806e)</li> </ul>"},{"location":"CHANGELOG/#1019-2023-10-11","title":"1.0.19 (2023-10-11)","text":""},{"location":"CHANGELOG/#features_13","title":"Features","text":"<ul> <li>docker-jans: upgrade base image to Java 17 (#6231) (8ed40e9)</li> <li>keycloak refactoring referred to Issue #5330 review (#6157) (7319120)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_15","title":"Bug Fixes","text":"<ul> <li>charts: use interval-based cronjob schedule syntax (#6089) (2c0fc97)</li> <li>docs: autogenerate docs (#6261) (57137e4)</li> <li>docs: scripts should be shown alphabetically (#6222) (f60010c)</li> <li>prepare for 1.0.19 release (554fd43)</li> </ul>"},{"location":"CHANGELOG/#1018-2023-09-23","title":"1.0.18 (2023-09-23)","text":""},{"location":"CHANGELOG/#features_14","title":"Features","text":"<ul> <li>jans-auth-server: included org_id in the response of DCR #5787 (#6095) (34a5f8f)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_16","title":"Bug Fixes","text":"<ul> <li>jans-auth-server: redirect when session does not exist but client_id parameter is present (#6104) (f8f9591)</li> <li>jans-auth-server: swagger is malformed due to typo #6085 (#6086) (e1ae899)</li> <li>prepare for 1.0.18 release (87af7e4)</li> <li>remove content-type in header from /retrieve GET request #6096 (#6099) (a85d867)</li> </ul>"},{"location":"CHANGELOG/#1017-2023-09-17","title":"1.0.17 (2023-09-17)","text":""},{"location":"CHANGELOG/#bug-fixes_17","title":"Bug Fixes","text":"<ul> <li>docker-jans-fido2: search cache for session instead of persistence (#6040) (d8d4073)</li> <li>docker-jans-persistence-loader: search session by deviceSecret (#6038) (d299d7f)</li> <li>docs: autogenerate docs (#6065) (0f3cf5d)</li> <li>prepare for 1.0.17 release (4ba8c15)</li> </ul>"},{"location":"CHANGELOG/#1016-2023-08-02","title":"1.0.16 (2023-08-02)","text":""},{"location":"CHANGELOG/#features_15","title":"Features","text":"<ul> <li>jans-cli-tui: agama-cli (#5715) (5fec965)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_18","title":"Bug Fixes","text":"<ul> <li>docs: autogenerate docs (#5749) (9a29ec1)</li> <li>jans-linux-setup: load test data with setup.properties (#5723) (b2fa5de)</li> <li>prepare for 1.0.16 release (042ce79)</li> <li>prepare for 1.0.16 release (b2649c3)</li> </ul>"},{"location":"CHANGELOG/#1015-2023-07-12","title":"1.0.15 (2023-07-12)","text":""},{"location":"CHANGELOG/#bug-fixes_19","title":"Bug Fixes","text":"<ul> <li>prepare for 1.0.15 release (0e3cc2f)</li> </ul>"},{"location":"CHANGELOG/#1014-2023-06-12","title":"1.0.14 (2023-06-12)","text":""},{"location":"CHANGELOG/#bug-fixes_20","title":"Bug Fixes","text":"<ul> <li>docker-jans-auth-server: handle missing secret when comparing contents (#5187) (f2a373e)</li> <li>docs: autogenerate docs (#5225) (9c8e510)</li> <li>prepare for 1.0.14 release (25ccadf)</li> </ul>"},{"location":"CHANGELOG/#1013-2023-05-10","title":"1.0.13 (2023-05-10)","text":""},{"location":"CHANGELOG/#bug-fixes_21","title":"Bug Fixes","text":"<ul> <li>docker-jans-loadtesting-jmeter: rename incorrect reference to OCI image (#4908) (7db2c11)</li> <li>docs: autogenerate docs (#4933) (337239b)</li> <li>prepare for 1.0.13 release (493478e)</li> </ul>"},{"location":"CHANGELOG/#1012-2023-04-18","title":"1.0.12 (2023-04-18)","text":""},{"location":"CHANGELOG/#features_16","title":"Features","text":"<ul> <li>config-api: search pattern, client auth response and security fix (#4595) (4dbfcc2)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_22","title":"Bug Fixes","text":"<ul> <li>docs: autogenerate docs (#4652) (e353874)</li> <li>prepare for 1.0.12 release (6f83197)</li> </ul>"},{"location":"CHANGELOG/#1011-2023-04-05","title":"1.0.11 (2023-04-05)","text":""},{"location":"CHANGELOG/#features_17","title":"Features","text":"<ul> <li>backend changes for admin-ui to call licenseSpring apis via. SCAN #4461 (#4462) (3617a95)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_23","title":"Bug Fixes","text":"<ul> <li>docs: autogenerate docs (#4486) (a9b3eab)</li> <li>jans-linux-setup: re-orginize creating smtp configuration (#4457) (5b543cd)</li> <li>prepare for  release (60775c0)</li> </ul>"},{"location":"CHANGELOG/#1010-2023-03-16","title":"1.0.10 (2023-03-16)","text":""},{"location":"CHANGELOG/#features_18","title":"Features","text":"<ul> <li>config-api: agama deployment path param change and client authorization (#4147) (22323ce)</li> <li>docker-jans-persistence-loader: add online_access scope and enable agama engine by default (#4136) (8c0bbb3)</li> <li>docker-jans: add client auth scopes (#4156) (1ae907b)</li> <li>include jansDeviceData in SCIM Fido2Resource schema #4057 (#4115) (04436dc)</li> <li>jans-auth-server: added online_access scope to issue session bound refresh token #3012 (#4106) (635f611)</li> <li>jans-linux-setup: enable agama engine by default  (#4131) (7e432dc)</li> <li>tent: support additional params (#4044) (f521f7a)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_24","title":"Bug Fixes","text":"<ul> <li>add custom permissions (34336ac)</li> <li>config-api: smtp password decryption and encryption logic (#4161) (4aefb0d)</li> <li>config-api: user custom attribute changes and agama param changes (#4123) (291004e)</li> <li>docker-jans-config-api: remove licenseSpringCredentials from admin-ui jansConfDyn (#4125) (2cf8aa0)</li> <li>docs: autogenerate docs (#4200) (e20f399)</li> <li>formating issues (#4119) (c5b89ce)</li> <li>jans-cli-tui: dropdown widget raises error if not initial values provided (#4142) (0aa51eb)</li> <li>jans-cli-tui: working branch 11 (#3980) (fdba800)</li> <li>jans-fido2: handling exception fido2 get endpoints by invalid params (#4139) (a50d2af)</li> <li>jans-linux-setup: set jansAuthMode - default acr mode (#4162) (f7d0489)</li> <li>javadoc errors (#4088) (be10a09)</li> <li>prepare release for 1.0.10 (e996926)</li> <li>prevent getFlowByName method crash by refactoring #4128 (#4129) (092989b)</li> <li>terraform-provider-jans: update terraform module (#4164) (073ef39)</li> <li>terraform-provider-jans: update terraform provider (#4148) (92134c8)</li> <li>update chart image repositories (8eea271)</li> </ul>"},{"location":"CHANGELOG/#109-2023-03-09","title":"1.0.9 (2023-03-09)","text":""},{"location":"CHANGELOG/#features_19","title":"Features","text":"<ul> <li>agama: update gama deployment endpoint to support configuration properties (#4049) (392525c)</li> <li>getting license credentials from SCAN (#4052) (5c563b7)</li> <li>jans-auth-server: introduced additional_token_endpoint_auth_method client's property #3473 (#4033) (79dcb60)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_25","title":"Bug Fixes","text":"<ul> <li>docs: autogenerate docs (#4050) (dcbb645)</li> <li>docs: autogenerate docs (#4105) (da87cef)</li> <li>jans-auth-server: bad indentation in AS swagger.yaml #4108 (#4109) (cdcefd2)</li> <li>jans-config-api: getting license credentials from SCAN (#4055) (407d618)</li> <li>prepare 1.0.9 release (e6ea522)</li> <li>prepare 1.0.9 release (55f7e0c)</li> <li>update next SNAPSHOT and dev (0df0e7a)</li> </ul>"},{"location":"CHANGELOG/#108-2023-03-01","title":"1.0.8 (2023-03-01)","text":""},{"location":"CHANGELOG/#features_20","title":"Features","text":"<ul> <li>add to AS session the data passed in <code>Finish</code> (#3978) (12bedb7)</li> <li>Include additional attributes on SSA Get endpoint (#3983) (4fded3e)</li> <li>jans-cli-tui: enable super gluu option (#3970) (0200751)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_26","title":"Bug Fixes","text":"<ul> <li>docker-jans: add missing logs due to improper configuration (#3994) (c041f12)</li> <li>docker-jans: resolve required keys_ops_type for generating/rotating keys (#3990) (0ed67fb)</li> <li>fix user publicKey search (#3982) (d0584dd)</li> <li>jans-auth-server: WebApplicationException is not propagated out of \"Update Token\" script #3996 (#3997) (d561f14)</li> <li>jans-linux-setup: install cb before jans installation (#3981) (dfed3b5)</li> <li>jans-linux-setup: install ncurses-compat-libs cb backend for el8 (#3969) (412e07f)</li> <li>jans-linux-setup: start jans-auth after backend (#3975) (4afbcee)</li> <li>jans-pycloudlib: split aws secrets when payload is larger than 65536 bytes (#3971) (bd3d59b)</li> <li>solved error when generate jwt of ssa return error, but ssa persist in database (#3985) (768fd04)</li> </ul>"},{"location":"CHANGELOG/#107-2023-02-22","title":"1.0.7 (2023-02-22)","text":""},{"location":"CHANGELOG/#features_21","title":"Features","text":"<ul> <li>add -key_ops ALL to setup (ref: #3747) (#3755) (3ce4bb2)</li> <li>add authentication SG flow tests (#3877) (d5c3fac)</li> <li>add custom Github External Authenticator script for ADS #3625 (#3626) (f922a7a)</li> <li>add debug SG logging (#3730) (a0c9ca2)</li> <li>add fast forward suport to skip step authentication flow #3582 (#3583) (25ee0af)</li> <li>add Jupiter+Weld+Mockito+Extension to Fido2 (#3875) (0152435)</li> <li>add more loggers (#3742) (919bc86)</li> <li>add project metadata and related handling #3476 (#3584) (b95e53e)</li> <li>add support for postgres testing (3494925)</li> <li>Change org_id to String type and Add status in get SSA (#3763) (d01269a)</li> <li>config-api: config api configuration endpoint (#3648) (c798c4c)</li> <li>config-api: data conversion, audit log and swagger enhancement (#3588) (a87b75b)</li> <li>config-api: plugin endpoint and audit interceptor (#3613) (95fadc6)</li> <li>config-api: script default script validation for location (#3786) (446de9e)</li> <li>docker-jans-configurator: allow user-defined salt (#3624) (cf743b7)</li> <li>docker-jans-persistence-loader: add ssa admin scope (#3762) (540f619)</li> <li>docker-jans: add support for mounted hybrid properties file (#3623) (8c58a5a)</li> <li>docker-jans: change persistence entry check to read configuration (#3618) (d465c19)</li> <li>docker-jans: introduce key_ops when generating keys (#3770) (2495842)</li> <li>docs: updated swagger for new endpoint get jwt of ssa, also added more documentation for scopes. (7dcca94)</li> <li>jans-auth-server: add configurable rotation of client's registration access token #3578 (#3876) (83183c0)</li> <li>jans-auth-server: added dynamicRegistrationDefaultCustomAttributes to provide default custom attributes during dcr #3595 (#3596) (6202230)</li> <li>jans-auth-server: added flexible date formatter handler to AS (required by certification tools) #3600 (#3601) (f646d73)</li> <li>jans-auth-server: added flexible formatter handler for IdTokenFactory class (#3605) (f4b0179)</li> <li>jans-auth-server: added sector_identifier_uri content validation (certification) #3639 (#3641) (2583e53)</li> <li>jans-auth-server: introduced key_ops for granular map of crypto service to rotation profile #3415 (#3642) (58693c5)</li> <li>jans-auth-server: new endpoint for get jwt of ssa based on jti. (#3724) (7dcca94)</li> <li>jans-auth-server: OAuth 2.0 Step-up - added acr and auth_time #2589 (#3887) (2bd7a67)</li> <li>jans-auth-server: OAuth 2.0 Step-up - added acr and auth_time to introspection response #2589 (#3885) (a325998)</li> <li>jans-auth-server: provide ability to ignore/bypass prompt=consent #3721 (#3851) (c0286ba)</li> <li>jans-auth-server: provided ability to set scriptDns related attributes of client (e.g. introspectionScripts) #3645 (#3668) (cee2525)</li> <li>jans-auth-server: provided convenient method to add claim to AT as JWT in modifyAccessToken() method #3579 (#3629) (cf0a824)</li> <li>jans-auth-server: renamed \"key_ops\" -&gt; \"key_ops_type\" #3790 (#3791) (cadb3d6)</li> <li>jans-auth-server: renamed \"key_ops\" -&gt; \"key_ops_type\" #3790 (#3792) (7a6bcba)</li> <li>jans-auth-server: use key_ops=ssa to generate jwt from ssa (#3806) (2603bbb)</li> <li>jans-linux-setup create test client with all available scopes (#3696) (c2da52e)</li> <li>jans-linux-setup spanner rest client (#3436) (e4d1d0c)</li> <li>jans-linux-setup ssa admin scope (#3759) (485f7b4)</li> <li>jans-tent: add Jans Tent product (#3647) (80c53e0)</li> <li>optmize cleander job (#3737) (2a864d9)</li> <li>process lib directory in <code>.gama</code> files for ADS projects deployment (#3644) (40268ad)</li> <li>support cancel request (#3733) (2741e51)</li> <li>Support Super Gluu one step authentication to Fido2 server #3593 (#3599) (c013b16)</li> <li>terraform-provider-jans: update terraform module (#3813) (605dd16)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_27","title":"Bug Fixes","text":"<ul> <li>add init containers for adjusting ownership on upgrade (e20e817)</li> <li>add init containers for opendj (0264df2)</li> <li>auto installing of the GithubAuthenticatorForADS.py has been removed; (#3889) (bd6b7ad)</li> <li>cbor data stream lenght calculatro return wrong lengh #3614 (#3615) (22065ea)</li> <li>config-api: agama swagger spec and admin-ui web key issue (#3831) (1593997)</li> <li>config-api: fixed start-up issue due to scope objectclass case (#3697) (eac6440)</li> <li>config-api: plugin result subsequent call (#3633) (3e4d513)</li> <li>config-api: user service conflict with fido2 and script enhancement (#3767) (5753d39)</li> <li>docker-jans-monolith: use test client and secret (42c9556)</li> <li>docker-jans-persistence-loader: add missing persist tokens config when upgrading from previous version (#3849) (5b8036d)</li> <li>docker-jans: handle failure on running API requests to Kubernetes API server in Google Cloud Run (#3893) (a31dee3)</li> <li>fido2-client: conflict of log4j config (#3636) (77412d5)</li> <li>fix authenticatorData encoding (#3815) (687cb2a)</li> <li>fix fmt name (#3900) (4a6a0c1)</li> <li>fixes for cancel support (#3735) (3e64530)</li> <li>jans-auth-server: added testng to agama-inbound #3714 (#3719) (955ac8c)</li> <li>jans-auth-server: AS complication fails on main #3863 (#3864) (e2aa1a6)</li> <li>jans-auth-server: corrected issue caught by RegisterRequestTest #3683 (#3684) (3e201d8)</li> <li>jans-auth-server: error from introspection interception script is not propagated during AT as JWT creation #3904 (#3905) (8c551c0)</li> <li>jans-auth-server: jansApp attribute only relevant for SG (#3782) (6153a13)</li> <li>jans-auth-server: key_ops in jwks must be array #3777 (#3778) (2be2a03)</li> <li>jans-auth-server: provided corrected public key for outdated keystores during id_token creation if key_ops_type is absent #3840 (#3841) (3291eab)</li> <li>jans-auth-server: wrong Client Authn Method at token endpoint throws npe #3503 (#3598) (e3bd1e8)</li> <li>jans-cli-tui documentation and setup (#3818) (74660db)</li> <li>jans-cli-tui include pyproject.toml (ref: #3804) (#3835) (f250372)</li> <li>jans-cli-tui rename config-api swagger file (#3758) (a7e14a0)</li> <li>jans-cli-tui SSA org_id, status and software_roles (#3765) (4bd3e9a)</li> <li>jans-cli-tui typo (#3846) (aaab377)</li> <li>jans-cli-tui typo organisation (#3853) (58a974b)</li> <li>jans-cli-tui working branch 4 - many different improvements (#3504) (e572552)</li> <li>jans-cli-tui working branch 5 (#3649) (4d3f982)</li> <li>jans-cli-tui working branch 6 (#3794) (afea59d)</li> <li>jans-cli-tui working branch 7 (#3824) (776bab3)</li> <li>jans-cli-tui: working branch 9 (#3871) (9f16d75)</li> <li>jans-config-api: Fixing runtime ambiguity for RegistrationPersistenceService.java (#3756) (83c7b50)</li> <li>jans-config-api: runtime exceptions in config-api at startup (#3725) (8748cc3)</li> <li>jans-fido2: RegistrationPersistenceService implemntation (#3728) (d5b8b67)</li> <li>jans-linux-setup add twilio and jans-fido2 client libraries to jans-auth (#3716) (4f43328)</li> <li>jans-linux-setup conversion fails for null integer field (#3610) (207946c)</li> <li>jans-linux-setup downgrade cryptography (#3635) (c7b5e3b)</li> <li>jans-linux-setup downgrade jwt for py3.6 (#3621) (322f752)</li> <li>jans-linux-setup external libs in jans-fido2.xml (#3627) (8d4783b)</li> <li>jans-linux-setup installation without test client (#3706) (e45f19e)</li> <li>jans-linux-setup key_ops_type for key regeneration tool (ref: #3881) (#3882) (51c0750)</li> <li>jans-linux-setup ldif property objectClass should be case sensitive (#3702) (0dc14a0)</li> <li>jans-linux-setup rename config-api swagger file (#3678) (4615973)</li> <li>jans-linux-setup rename role_based_client as tui_client (#3630) (b331ef3)</li> <li>jans-linux-setup save test_client_id to setup.properties (#3844) (d1d898c)</li> <li>jans-linux-setup script locatipn is db (#3788) (4381928)</li> <li>jans-linux-setup script locatipn is db openbanking (#3789) (697efc5)</li> <li>jans-linux-setup sync test client variable names (#3862) (fe7e24c)</li> <li>jans-linux-setup test client fixes (#3699) (72e2f3f)</li> <li>jans-pycloudlib: avoid overwritten data by using merge strategy for AWS wrappers (#3832) (cf0d4e3)</li> <li>jans-pycloudlib: avoid overwritten data by using merge strategy for Google wrappers (#3826) (809b9db)</li> <li>jans-pycloudlib: split google secrets when payload is larger than 65536 bytes (#3890) (a86b098)</li> <li>license overwrite (055d72b)</li> <li>missing comma delimiter for Postgres index fields (#3741) (1a2d298)</li> <li>opendj jans vlume mount (4de4815)</li> <li>opendj statefulset permissions (0d9a2a7)</li> <li>prepare 1.0.7 release (ce02fd9)</li> <li>remove upgrade flag (bee17a7)</li> <li>rename role_based_client as tui_client (#3657) (c393cb2)</li> <li>store correct script revision after script reload from file (#3704) (2ca6a83), closes #3703</li> <li>tent: remove unknown module refference (#3802) (b01a015)</li> <li>terraform-provider-jans: update terraform module (#3869) (30e3c67)</li> <li>update configmaps ENVs (a797c61)</li> </ul>"},{"location":"CHANGELOG/#106-2023-01-09","title":"1.0.6 (2023-01-09)","text":""},{"location":"CHANGELOG/#features_22","title":"Features","text":"<ul> <li>add attributes and branch for ADS deployments #3095 (#3228) (2dc9267)</li> <li>add benchmark demo (#3325) (26bbb0c)</li> <li>add endpoint to do syntax check only #3277 (#3299) (3b23636)</li> <li>add endpoints for MVP ADS projects management #3094 (#3262) (8546356)</li> <li>added custom resource owner password script fro two-factor twilio authentication (#3208) (eae0ca1)</li> <li>agama: deploy flows from .gama files (#3250) (df14f8a)</li> <li>changes in admin-ui plugin to allow agama-developer-studio to use its OAuth2 apis #3085 (#3298) (9e9a7bd)</li> <li>config-api: audit log, agama ADS spec, fix for 0 index search (#3369) (ea04e2c)</li> <li>config-api: client claim enhancement, manual spec removed (#3413) (bd2cdf8)</li> <li>config-api: health check response rectification and Agama ADS swagger spec (#3293) (faf2888)</li> <li>docker-jans: add admin-ui scopes (#3530) (bc62673)</li> <li>docker-jans: enable prefix and group for stdout logs (#3481) (e7684e7)</li> <li>docs: jans TUI SCIM configuration -- screenshot (#3318) (7b463b0)</li> <li>docs: jans TUI SCIM configuration feature - screenshot1 (#3306) (d1adc98)</li> <li>docs: jans TUI SCIM configuration feature (#3305) (70e358e)</li> <li>jans-auth-server: added ability to return error out of introspection and update_token custom script #3255 (#3356) (a3e5227)</li> <li>jans-auth-server: added externalUriWhiteList configuration property before call external uri from AS #3130 (#3425) (6c7df6f)</li> <li>jans-auth-server: avoid compilation problem when version is flipped in test code #3148 (#3210) (4d61c7b)</li> <li>jans-auth-server: block authentication flow originating from a webview (#3204) (e48380e)</li> <li>jans-auth-server: draft for - improve dcr / ssa validation for dynamic  registration #2980 (#3109) (233a78c)</li> <li>jans-auth-server: end session - if id_token is expired but signature is correct, we should make attempt to look up session by \"sid\" claim #3231 (#3291) (cd11750)</li> <li>jans-auth-server: implemented auth server config property to disable prompt=login #3006 (#3522) (0233cd1)</li> <li>jans-auth-server: new configuration for userinfo has been added (#3349) (3ccc4a9)</li> <li>jans-auth-server: remove ox properties name (#3285) (f70b207)</li> <li>jans-auth-server: renamed \"code\"-&gt;\"random\" uniqueness claims of id_token to avoid confusion with Authorization Code Flow #3466 (#3467) (dd9d049)</li> <li>jans-config-api: added admin-ui scopes in config-api-rs-protect.json (c348ae6)</li> <li>jans-core: add AES utility class #3215 (#3242) (7e59795)</li> <li>jans-linux-setup script for adding sequenced users to rdbm backend (#3311) (63c74ec)</li> <li>problems with handling custom attributes #2752 (#3378) (3028a94)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_28","title":"Bug Fixes","text":"<ul> <li>#2201 (#3365) (ebca16b)</li> <li>#2201 (#3451) (0417c2a)</li> <li>#2201 removing an irrelevant head from mkdocs (#3478) (9771205)</li> <li>add 'java' to the list of restricted variable names #3533 (#3534) (a970d88)</li> <li>add link to api reference (#3394) (f091045)</li> <li>agama: after moving agama to jans-auth-server agama model tests are not run #3246 (#3247) (9887e23)</li> <li>agama: fix agama auth dependency which blocks build process #3149 (#3244) (8f9fee3)</li> <li>agama: fixing tests run on jenkins #3149 (#3261) (cc6c5e1)</li> <li>app_info.json value of JANS_BUILD (#3199) (fe35e85)</li> <li>Broken swagger address. (843f78b)</li> <li>catch org.eclipse.jetty.http.BadMessageException: in (#3330) (1e0ff76), closes #3329</li> <li>docs/requirements.txt to reduce vulnerabilities (#3523) (82efd8f)</li> <li>docs: jans logging configuration - VM Operation Guide - 1 (#3348) (e0f8c71)</li> <li>docs: jans TUI administration -- Config Guide - TUI -- Auth server (#3227) (16ab709)</li> <li>docs: jans TUI configuration -- Auth Server - TUI - image (#3237) (3fbc9e7)</li> <li>docs: jans TUI configuration -- Config Guide - Auth Server - Client configuration - TUI (#3233) (ee8e056)</li> <li>docs: jans TUI configuration -- Fido - TUI (#3251) (cd6eef1)</li> <li>docs: jans TUI configuration -- Fido Administration - TUI (#3252) (a371cda)</li> <li>docs: jans TUI installation -- Config Guide - TUI (#3224) (cc00a71)</li> <li>docs: missing single quotes (#3239) (9f38c6a)</li> <li>fix format string #3278 (#3281) (7104d9c)</li> <li>fix token indexes and clnId type (#3434) (4a18904)</li> <li>generate javadpcs envproperty (9182aa5)</li> <li>hash (cdb5204)</li> <li>hash (156fb2f)</li> <li>jans-auth-server/pom.xml to reduce vulnerabilities (#3314) (f3e8205)</li> <li>jans-auth-server: changed getAttributeValues to getAttributeObjectValues (#3346) (a39b61e)</li> <li>jans-auth-server: compilation error of server side tests #3363 (#3364) (e83c087)</li> <li>jans-auth-server: corrected keys description \"id_token &lt;purpose&gt;\" -&gt; \"Connect \" #3415 (#3560) (75f99bd) <li>jans-auth-server: Duplicate iss and aud on introspection as jwt #3366 (#3387) (8780e94)</li> <li>jans-auth-server: parse string from object (#3470) (db9b204)</li> <li>jans-auth-server: when obtain new token using refresh token, check whether scope is null (#3382) (22743d9)</li> <li>jans-cli-tui (#3287) (27e7518)</li> <li>jans-cli-tui refactor mouse operations (#3482) (39dc0c7)</li> <li>jans-config-api/pom.xml to reduce vulnerabilities (#3005) (3e642c2)</li> <li>jans-config-api: corrected broken swagger address (#3505) (843f78b)</li> <li>jans-eleven/pom.xml to reduce vulnerabilities (#3315) (813cf98)</li> <li>jans-linux setup enable couchbase for packages (#3249) (8f72ea6)</li> <li>jans-linux-setup agama test data file locations (#3313) (a39fc69)</li> <li>jans-linux-setup centos/rhel pgsql installation (#3404) (f168fbc)</li> <li>jans-linux-setup copy libs directory of agama test data (#3376) (6a5322d)</li> <li>jans-linux-setup enable mysqld on boot for el8 (#3456) (30d082a)</li> <li>jans-linux-setup load test data with jans-auth only (#3432) (f696fee)</li> <li>jans-linux-setup longtext for pgsql (#3266) (547cee8)</li> <li>jans-linux-setup opPolicyUri and opTosUri (#3411) (67e1d22)</li> <li>jans-linux-setup remove dependency to removed dependency yaml (#3422) (8385c96)</li> <li>jans-linux-setup set db component based on dn (#3290) (8d743f2)</li> <li>jans-linux-setup start mysql server before jans-auth on SUSE (#3500) (3822975)</li> <li>login page doesn't display the correct localized characters (#3528) (395b376), closes #1660</li> <li>minor (#3334) (3225455)</li> <li>modify clnId column type (#3459) (701394c)</li> <li>prepare for 1.0.6 release (9e4c8fb)</li> <li>remove multiple sed commands (#3526) (2b906db)</li> <li>TUI client pre-authorized (#3399) (ab30953)</li> <li>upgrade org.apache.httpcomponents:httpcore from 4.4.6 to 4.4.15 (#642) (069dceb)</li> <li>upgrade org.mvel:mvel2 from 2.1.3.Final to 2.4.14.Final (#648) (c4034d1)</li> <li>use correct Ubuntu version in README (#3393) (2673ccd)</li> <li>user attributes not updated #2753 (#3326) (c0a0f66)</li> <li>user attributes not updated #2753 (#3403) (f793f92)</li>"},{"location":"CHANGELOG/#105-2022-12-01","title":"1.0.5 (2022-12-01)","text":""},{"location":"CHANGELOG/#features_23","title":"Features","text":"<ul> <li>add custom annotation for configuration property and feature flag documentation (#2852) (9991d1c)</li> <li>add feature to include custom-claims in user-info endpoint of admin-ui plugin #2969 (#2970) (0549879)</li> <li>add jans cli tui (#2384) (c9c502b)</li> <li>allow to use like with lower together (#2944) (1807629)</li> <li>charts: add pdb and topology spread constrants (ce575c2)</li> <li>documentation for ssa and remove softwareRoles query param of get ssa (#3031) (d8e14eb)</li> <li>image: preserve attribute's values in jans-auth config (#3013) (3e9e7fc)</li> <li>jans cli to jans-cli-tui (#3063) (fc20e28)</li> <li>jans-auth-server: check offline_access implementation has all conditions defined in spec #1945 (#3004) (af30e4c)</li> <li>jans-auth-server: corrected GluuOrganization - refactor getOrganizationName() #2947 (#2948) (9275576)</li> <li>jans-auth-server: java docs for ssa (#2995) (892b87a)</li> <li>jans-auth-server: remove redirect uri on client registration when grant types is password or client credentials (#3076) (cd876b4)</li> <li>jans-auth-server: specify minimum acr for clients #343 (#3083) (b0034ec)</li> <li>jans-auth-server: swagger docs for ssa (#2953) (7f93bca)</li> <li>jans-auth-server: updated mau on refreshing access token #2955 (#3025) (56de619)</li> <li>jans-linux-setup include permission of all user roles (#3009) (62a421d)</li> <li>jans-pycloudlib: add AWS Secrets Manager support for configuration layers (#3112) (0522e61)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_29","title":"Bug Fixes","text":"<ul> <li>(jans-auth-server): fixed Client serialization/deserialization issue #2946 (#3064) (31b5bfc)</li> <li>(jans-auth-server): fixed client's sortby #3075 (#3079) (e6b0e58)</li> <li>#2487 - fido script, doc already moved to script-catalog (#2982) (10d8df5)</li> <li>#2487 - irrelevant folder, agama script is in agama-bridge (#2993) (d19b13a)</li> <li>#2487 - removing inwebo (#2975) (052f91f)</li> <li>#2487 - SIWA and SIWG (Sign in with Apple-Google), moved to script-catalog (#2983) (402e7ae)</li> <li>#2487 removing duplicated files (#3007) (9f3d051)</li> <li>#2487 scripts-catalog folder restructuring (#2999) (7b66f2b)</li> <li>#2666 (#3011) (f98cbc5)</li> <li>client-name, logout, user (#3122) (f374831)</li> <li>config-api: error handling for agama get and org patch (#3028) (21dd6e5)</li> <li>config-api: fix for swagger spec for scope creation and sessoin endpoint filter (#2949) (2989f1d)</li> <li>config-api: swagger update for enum and error handling (#2934) (6b61556)</li> <li>demo: incorrect URL to helm charts location (#2935) (b7e395b)</li> <li>disable github authentication and interception scripts by default and other changes. #3022 (#3023) (13f5998)</li> <li>ensure non-empty array is generated #2672 (#3047) (47902bd)</li> <li>getting ready for a release (0bda832)</li> <li>jans-auth-server: corrected regression made in token request #2921 (#2922) (deeae74)</li> <li>jans-auth-server: wrong import in GluuOrganization class which leads to failure on jans-config-api #2957 (#2958) (af4eda8)</li> <li>jans-auth-server: wrong userinfo_encryption_enc_values_supported in OpenID Configuration #2725 (#2951) (bc1a8ca)</li> <li>jans-cli-docs update links (#3118) (04fbb98)</li> <li>jans-config-api: user attributes not updated #2753 (082cfe3)</li> <li>jans-config-api: user attributes not updated #2753 (#3110) (803468b)</li> <li>jans-fido2: #1120 (#2928) (0fea95a)</li> <li>jans-fido2: #2840 (#2974) (d3351e1)</li> <li>jans-fido2: #2971 (#2972) (2f15cf8)</li> <li>jans-linux-setup fido2 script placeholder in scripts template (#2986) (70a4fe0)</li> <li>jans-linux-setup remove opendj sysv script (#2998) (13eebe4)</li> <li>jans-linux-setup service description for jans-auth (#2989) (6566d27)</li> <li>jans: added null check to avoid NullPointerException (#3077) (42d49b2)</li> <li>the admin-ui role/permission/mapping delete apis are not protected by appropriate permissions #2991 (#2992) (7d68021)</li> <li>typo (#2950) (6df810b)</li> </ul>"},{"location":"CHANGELOG/#104-2022-11-08","title":"1.0.4 (2022-11-08)","text":""},{"location":"CHANGELOG/#features_24","title":"Features","text":"<ul> <li>for file based scripts check both script revision and file (#2878) (97ab071)</li> <li>jans-auth-server: added token exchange support to client #2518 (#2855) (943d99f)</li> <li>jans-auth-server: ssa validation endpoint (#2842) (de8a86e)</li> <li>ssa revoke endpoint (#2865) (9c68f91)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_30","title":"Bug Fixes","text":"<ul> <li>#2825 (#2828) (5ce21aa)</li> <li>avoid NPE when configuration is missing #2857 (#2863) (4a27091)</li> <li>config-api: fixes for client creation, enum handling (#2854) (3121493)</li> <li>fix OR filters join when sub-filters uses lower (#2850) (3dc6b32)</li> <li>image: add missing write access in filesystem (#2846) (db4670d), closes #2844</li> <li>image: multiple dynamic scopes created when using 2 replicas (#2871) (5e0f1e6)</li> <li>jans-auth-server: fix language metadata format (#2883) (e21e206)</li> <li>jans-linux-setup render webapps.xml (#2839) (ed8fa84)</li> <li>pycloudlib: searching values from spanner returns empty set (#2833) (861a065)</li> </ul>"},{"location":"CHANGELOG/#103-2022-11-01","title":"1.0.3 (2022-11-01)","text":""},{"location":"CHANGELOG/#features_25","title":"Features","text":"<ul> <li>add inum claim in profile scope #2095 (#2096) (f67c32e)</li> <li>add new methods to allow get/set list of custom attributes from (#2105) (5ac23a1), closes #2104</li> <li>admin-ui apis refactoring #2388 (#2390) (c7b26e9)</li> <li>agama: add utility classes for inbound identity (#2204) (29f58ee)</li> <li>agama: add utility classes for inbound identity (#2231) (96e32a4)</li> <li>agama: add utility classes for inbound identity (#2280) (ca6fdc9)</li> <li>agama: add utility classes for inbound identity (#2417) (2878bdd)</li> <li>config-api: multiple pattern handling for search request (#2590) (46886fb)</li> <li>config-api: multiple pattern search in attribute api (#2491) (9f646ff)</li> <li>disable TLS in CB client by default (#2167) (8ec5dd3)</li> <li>docker-jans-fido2: allow creating initial persistence entry (#2029) (41dfab7)</li> <li>docker-jans-monolith: add docker jans monolith (#2323) (ba511c3)</li> <li>docker-jans-scim: allow creating initial persistence entry (#2035) (e485618)</li> <li>fix susrefire tests in filter module (#2141) (118d77c)</li> <li>generate zip files with CB/Spanner dependencies (#2715) (e4e2670)</li> <li>image: add custom libs for couchbase and spanner persistence (#2784) (db559dd)</li> <li>image: add token-exchange and device secret (#2788) (87c4676)</li> <li>image: generate scopes from swagger/openapi files (#2759) (63722ea)</li> <li>jans-auth-server: add access_token_singing_alg_values_supported to discovery #2372 (#2403) (3784c83)</li> <li>jans-auth-server: added allowSpontaneousScopes AS json config #2074 (#2111) (3083a3f)</li> <li>jans-auth-server: added convenient idTokenLifetime client property #2656 (#2668) (f97bfce)</li> <li>jans-auth-server: added creator info to scope (time/id/type) #1934 (#2023) (ca65b24)</li> <li>jans-auth-server: allow authentication for max_age=0 #2361 (#2362) (aed6ee3)</li> <li>jans-auth-server: allow end session with expired id_token_hint (by checking signature and sid) #2430 (#2431) (1b46b44)</li> <li>jans-auth-server: Draft support of OpenID Connect Native SSO  (#2711) (595d1aa)</li> <li>jans-auth-server: extended client schema - added jansClientGroup #1824 (#2299) (29cfd4e)</li> <li>jans-auth-server: renamed \"enabledComponents\" conf property -&gt; \"featureFlags\" #2290 (#2319) (56a33c4)</li> <li>jans-auth-server: updating arquillian tests 1247 (#2017) (ee200a7)</li> <li>jans-config-api: added new attributes (#1940) (757b22f)</li> <li>jans-config-api: agama flow endpoint (#1898) (0e73306)</li> <li>jans-config-api: agama patch endpoint (#2028) (0b96a95)</li> <li>jans-config-api: endpoint to get UmaResource based on clientId and swagger changes (#1912) (a3f9145)</li> <li>jans-config-api: enhancement to agama and uma resource endpoint  (#2015) (f2c19a1)</li> <li>jans-config-api: fetch the associated clients_id in GET scopes api response  (#1946) (ffe743c)</li> <li>jans-config-api: new endpoint to fetch scope by creator and type (#2098) (cf15d67)</li> <li>jans-config-api: pagination functionality for attribute endoint (#2232) (8bb8b70)</li> <li>jans-config-api: pagination functionality for endpoints and swagger spec rectification (#2397) (d893e13)</li> <li>jans-config-api: Scope object changes for creator details (#2033) (a8b8d76)</li> <li>jans-config-api: session management endpoint (#2158) (30f6e1a)</li> <li>jans-core: port Gluu ORM-based document store (#2581) (b61df80)</li> <li>jans-linux-setup delete_dn() (#2450) (b80a270)</li> <li>jans-linux-setup external CB/Spanner libs (#2730) (d97bffe)</li> <li>jans-linux-setup load agama test data (#2749) (c368a02)</li> <li>jans-linux-setup option reset-rdbm-db (#2413) (1029619)</li> <li>jans-linux-setup postgresql support (#2409) (08ecaf9)</li> <li>jans-linux-setup set_class_path() (#2442) (8128244)</li> <li>jans-linux-setup: added device_sso scope (#2766) (7c7af09)</li> <li>jans-linux-setup: added token exchange grant type (#2768) (b3abcfe)</li> <li>jans-scim: make max no. of operations and payload size of bulks operations parameterizable (#1872) (c27a45b)</li> <li>merge ORM from Gluu (#2468) (93149fd)</li> <li>need to fetch the associated clients_id in GET scopes api response #1923 (#1949) (88606a5)</li> <li>ssa creation endpoint (#2495) (61c83e3)</li> <li>sync mds v3 config in fido2 image (#2531) (56c8442)</li> <li>update Coucbase ORM to conform SDK 3.x (config updates) #1851 (#2118) (fceec83)</li> <li>update search by example to use multivalued property (#2298) (8ed3007)</li> <li>upgrade javax.servlet:javax.servlet-api from 3.1.0 to 4.0.1 (#646) (d186a05)</li> <li>upgrade org.jboss.resteasy:resteasy-servlet-initializer from 4.5.10.Final to 5.0.1.Final (#645) (a9a712d)</li> <li>upgrade org.jetbrains:annotations from 18.0.0 to 23.0.0 (#637) (e5fca5a)</li> <li>use entry in contain entry (#2311) (de9d00a)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_31","title":"Bug Fixes","text":"<ul> <li>#2143 (#2144) (ff7f9f4)</li> <li>#2157 (#2159) (dc8cb60)</li> <li>#776 (#2503) (a564431)</li> <li>#817 - script for DUO should have the universal prompt, other APIs are deprecated + documentation minor fixes (#2363) (ccc13af)</li> <li>#817 (#2364) (bbcd87a)</li> <li>admin-ui plugin should use encoded client_secret for authentication #2717 (#2718) (cc0020e)</li> <li>backticks CB attributes in N1QL (#2313) (d6db13d)</li> <li>cb ttl update sdk 3 (#2434) (534c6cb)</li> <li>close connections after reading metadata (#2327) (00f4f79)</li> <li>config-api: client default value handling (#2585) (fbcbbad)</li> <li>config-api: fix for acr error handling and spec enhancement for example (#2443) (8113841)</li> <li>config-api: fix for assosiated client not fetched for scope (#2540) (08488d1)</li> <li>config-api: fix for returning associated-clients for scope (#2567) (e623f64)</li> <li>config-api: fixing discrepancies in the api (#2216) (af4d3a5)</li> <li>config-api: rectified sortBy field for Agama resource (#2513) (bb3ac95)</li> <li>config-api: removing CB and MySqlDB endpoints and swagger fixes (#2480) (cc68cc9)</li> <li>config-api: scope addiotion while client creation (#2714) (d51ae24)</li> <li>config-api: search filter logic for attribute resource (#2310) (c75ff1d)</li> <li>config-api: specifying JSON values for Attribute enum properties (#2663) (55d20c8)</li> <li>config-api: swagger fixes for missing scope and admin-ui paths (#2697) (6dcbff3)</li> <li>config-api: swagger spec changes for session, properties endpoint and ignoring customobject for non LDAP DB (#2348) (c6acaac)</li> <li>docs: fix MarkupSafe hash (#2699) (adf2a6d)</li> <li>docs: revert MarkupSafe hash (#2701) (e722aed)</li> <li>don't backticks all in N1QL (#2316) (7cc721e)</li> <li>don't execute next paged search if current result count less than (#2171) (94a162f)</li> <li>fix search with % (#2307) (90987d7)</li> <li>fixed multiple encoding issue during authz (#2152) (fb0b6d7)</li> <li>forgot_password: update imports to jans locations (#1637) (6c6eeb3), closes #1601</li> <li>image: add missing script for openbanking installation (#2618) (de775a7)</li> <li>image: add missing ssa configuration (#2613) (b70b8b2)</li> <li>image: handle vulnerabilities reported by artifacthub scanner (#2436) (77d8d88)</li> <li>image: missing configuration for openbanking discovery (#2796) (ba664f0)</li> <li>image: remove metadata-root-ca.cer inside fido2 image (#2603) (9461fbc)</li> <li>images: conform to new couchbase persistence configuration (#2188) (c708542)</li> <li>include idtoken with dynamic scopes for ciba (#2108) (d9b5341)</li> <li>incorrect contents #817 (#2365) (746b33f)</li> <li>jans auth server: well known uppercase grant_types response_mode (#2706) (39f613d)</li> <li>Jans cli SCIM fixes (#2394) (a009943)</li> <li>jans-auth-server: \"login:prompt\" property passed in request object JWT breaks authentication #2493 (#2537) (9d4d84a)</li> <li>jans-auth-server/pom.xml to reduce vulnerabilities (#2466) (86e62f9)</li> <li>jans-auth-server/pom.xml to reduce vulnerabilities (#2520) (f927692)</li> <li>jans-auth-server: added schema for ssa, corrected persistence, added ttl #2543 (#2544) (ce2bc3f)</li> <li>jans-auth-server: client tests expects \"scope to claim\" mapping which are disabled by default #1873 (958cc92)</li> <li>jans-auth-server: fixing client tests effected by \"scope to claim\" mapping which is disabled by default #1873 (#1910) (6d81792)</li> <li>jans-auth-server: generate description during built-in key rotation #1790 (#2068) (cd1a77d)</li> <li>jans-auth-server: increased period of session authn time check (#1918) (a41905a)</li> <li>jans-auth-server: native sso - return device secret if device_sso scope is present #2790 (#2791) (9fa213f)</li> <li>jans-auth-server: npe - regression in token endpoint (#2763) (fe659d7)</li> <li>jans-auth-server: NPE during OB discovery #2793 (#2794) (fb3ee86)</li> <li>jans-auth-server: npe in discovery if SSA endpoint is absent #2497 (#2498) (c3b00b4)</li> <li>jans-auth-server: perform redirect_uri validation if FAPI flag is true #2500 (#2502) (aad0460)</li> <li>jans-auth-server: PKCE parameters from first SSO request retains in further calls (#2620) (de98b41)</li> <li>jans-auth-server: ssa get endpoint (#2719) (35ffbf0)</li> <li>jans-auth-server: structure, instance customAttributes, initial data for ssa (#2577) (f11f789)</li> <li>jans-cli access token expiration (#2352) (d506c8e)</li> <li>jans-cli displayName for OpenID Clients with MySQL backend (ref: #2314) (#2315) (e0dff68)</li> <li>jans-cli endpint param (#2569) (f6faa71)</li> <li>jans-cli fixes (#2429) (c9673dc)</li> <li>jans-cli fixes (#2515) (ccaacc8)</li> <li>jans-cli info for ConfigurationAgamaFlow (#2561) (2c446a7)</li> <li>jans-cli tabulate attrbiutes (#2321) (cb1e40d)</li> <li>jans-cli user patch (#2334) (fa3592b)</li> <li>jans-client-api: upgrade seleniumhq version from 3.x to 4.x (#2110) (d48271e)</li> <li>jans-config-api parameter month is not mandatory for endpoint /stat (#2459) (0654f98)</li> <li>jans-config-api/plugins/sample/demo/pom.xml to reduce vulnerabilities (#2625) (14dd8a6)</li> <li>jans-config-api/plugins/sample/demo/pom.xml to reduce vulnerabilities (#853) (2792b53)</li> <li>jans-config-api/plugins/sample/helloworld/pom.xml to reduce vulnerabilities (#2630) (0e39fb7)</li> <li>jans-config-api/plugins/sample/helloworld/pom.xml to reduce vulnerabilities (#2727) (5f42948)</li> <li>jans-config-api/plugins/sample/helloworld/pom.xml to reduce vulnerabilities (#972) (e2ae05e)</li> <li>jans-config-api/pom.xml to reduce vulnerabilities (#1464) (c832f98)</li> <li>jans-config-api/pom.xml to reduce vulnerabilities (#1746) (9dfe60e)</li> <li>jans-config-api/pom.xml to reduce vulnerabilities (#1780) (3252ff7)</li> <li>jans-config-api/pom.xml to reduce vulnerabilities (#2655) (499ff89)</li> <li>jans-config-api: avoid loss of attributes in agama endpoints (#2058) (3c8f816)</li> <li>jans-config-api: config-api compilation failed in main #2030 (#2031) (1659da1)</li> <li>jans-config-api: Fix to not update Metadata for PUT and PATCH agama endpoint (#2046) (da93050)</li> <li>jans-config-api: issue UMA scope request being saved as OAUTH (#2063) (81472aa)</li> <li>jans-config-api: rectified endpoint url in swagger spec for uma resource (#1965) (0dc3b2e)</li> <li>jans-core: removed redundant reference #1927 (#1928) (064cbb8)</li> <li>jans-eleven/pom.xml to reduce vulnerabilities (#1463) (b6def37)</li> <li>jans-eleven/pom.xml to reduce vulnerabilities (#2471) (903bda2)</li> <li>jans-eleven/pom.xml to reduce vulnerabilities (#2519) (c0a2bbe)</li> <li>jans-eleven/pom.xml to reduce vulnerabilities (#2676) (d27a7f9)</li> <li>jans-linus-setup typo (#2427) (8b5f287)</li> <li>jans-linux-setup add mod_rewrite to httpd_2.4.conf (#1987) (b33b78e)</li> <li>jans-linux-setup Config API installation status (#2276) (6cf25ae)</li> <li>jans-linux-setup config api prompt (#2293) (abfa315)</li> <li>jans-linux-setup config-api scope type oauth (#2318) (8e48d71)</li> <li>jans-linux-setup debian11 installation (#2160) (8b99498)</li> <li>jans-linux-setup don't call package installation unless missing packages (#2641) (d340c3c)</li> <li>jans-linux-setup downloads dependencies without interaction in case -n (#2546) (d53f9a2)</li> <li>jans-linux-setup extract files (#2464) (35ced3e)</li> <li>jans-linux-setup humanize os name (#2066) (8c89638)</li> <li>jans-linux-setup install cb via apt for dependencies (#2330) (732ce6a)</li> <li>jans-linux-setup lowercase admin user status (#2274) (28e5f06)</li> <li>jans-linux-setup MySQL schema name is db name (#2592) (2fc3d6e)</li> <li>jans-linux-setup python3-psycopg2 (#2423) (0d4aad2)</li> <li>jans-linux-setup remove fido2 metadata-root-ca.cer (#2594) (139a6a4)</li> <li>jans-linux-setup scan docs/script-catalog for custom scripts (#2488) (de585c9)</li> <li>jans-linux-setup test data load (#2685) (4d4d848)</li> <li>jans-linux-setup typo (#2526) (4fa83fc)</li> <li>jans-linux-setup upgrade to MDS3 in fido2 (#2507) (fcbcd2f)</li> <li>jans-linux-setup-typo (#2523) (579ccac)</li> <li>jans-linux-setup: review columns size for Agama tables (#2324) (55d7a7e)</li> <li>jans-scim: improper handling response of get user operation (#2420) (b9e00af)</li> <li>jans-scim: X509 cert not set after successful POST request (#2407) (fd616c4)</li> <li>jans: config api and client api (#2408) (003af55)</li> <li>localized String should be converted to JSON (#2542) (30225f9)</li> <li>minor (#2470) (657b9f7)</li> <li>minor (#2786) (3f67763)</li> <li>moved contents under scripts-catalog (#2370) (fa2273a)</li> <li>moved to script-catalog (#2485) (960b87f)</li> <li>orm: length check added before accessing CustomObjectAttribute values (#2505) (6ff718f)</li> <li>pycloudlib: handle type mismatch for iterable (#2004) (46e0b2e)</li> <li>pycloudlib: set default values for JSONB column (#2651) (9b536ab)</li> <li>random password for keystores (#2102) (b7d9af1)</li> <li>remove request-body from delete endpoints of admin-ui plugin #2341 (#2342) (1429a85)</li> <li>scan docs/script-catalog for custom scripts (#2533) (5a0521e)</li> <li>select first sig key if none requested (#2494) (31fb464)</li> <li>update authn schemes in yaml descriptor #2414 (#2415) (4b239af)</li> <li>update chart repo (8e347a3)</li> <li>update chart repo (011af9d)</li> <li>update error pages (#1957) (3d63f4d)</li> <li>upgrade com.google.http-client:google-http-client-jackson2 from 1.26.0 to 1.40.1 (#644) (31bc823)</li> <li>use iterator to correcly remove OC attribute (#2138) (b590981)</li> </ul>"},{"location":"CHANGELOG/#miscellaneous-chores_3","title":"Miscellaneous Chores","text":"<ul> <li>release 1.0.2 (43dead6)</li> <li>release 1.0.2-1 (d01b51a)</li> </ul>"},{"location":"CHANGELOG/#102-2022-08-30","title":"1.0.2 (2022-08-30)","text":""},{"location":"CHANGELOG/#features_26","title":"Features","text":"<ul> <li>add inum claim in profile scope #2095 (#2096) (f67c32e)</li> <li>add new methods to allow get/set list of custom attributes from (#2105) (5ac23a1), closes #2104</li> <li>add newly redesigned jans-client-api (#1540) (4582ae5)</li> <li>add support for date ranges in statistic client #1575 (#1653) (8048cd9)</li> <li>add support for requestUriBlockList config (#1572) (63b3b74)</li> <li>added config to disable attempt to update before insert in cache (#1787) (d9a07ff)</li> <li>agama: add utility classes for inbound identity (#2204) (29f58ee)</li> <li>agama: add utility classes for inbound identity (#2231) (96e32a4)</li> <li>agama: allow the config-api to perform syntax check of flows (#1621) (2e99d3a)</li> <li>agama: reject usage of repeated input names (#1484) (aed8cf3)</li> <li>disable TLS in CB client by default (#2167) (8ec5dd3)</li> <li>docker-jans-fido2: allow creating initial persistence entry (#2029) (41dfab7)</li> <li>docker-jans-scim: allow creating initial persistence entry (#2035) (e485618)</li> <li>endpoint to get details of connected FIDO devices registered to users #1465 (#1466) (62522fe)</li> <li>expose prometheus metrics via jmx exporter (#1573) (205e320)</li> <li>fix susrefire tests in filter module (#2141) (118d77c)</li> <li>fix the dependencies and code issues (#1473) (f4824c6)</li> <li>introduce new hybrid persistence mapping (#1505) (a77ab60)</li> <li>jans linux setup enable/disable script via arg (#1634) (0b3cf16)</li> <li>jans linux setup openbanking CLI and certificate automation (#1472) (62b5868)</li> <li>jans-auth-server: add support for ranges in statistic endpoint (UI team request) (fd66720)</li> <li>jans-auth-server: added allowSpontaneousScopes AS json config #2074 (#2111) (3083a3f)</li> <li>jans-auth-server: added convenient method for up-scoping or down-scoping AT scopes #1218 (5d71655)</li> <li>jans-auth-server: added creator info to scope (time/id/type) #1934 (#2023) (ca65b24)</li> <li>jans-auth-server: added restriction for request_uri parameter (blocklist and allowed client.request_uri) #1503 (0696d92)</li> <li>jans-auth-server: added sid and authn_time for active sessions response (bf9b572)</li> <li>jans-auth-server: if applicationType is not set during client registration AS should default to 'web' #1687 (f9695e1)</li> <li>jans-auth-server: improve client assertion creation code (ClientAuthnRequest) #1182 (81946b2)</li> <li>jans-auth-server: improved TokenRestWebServiceValidator and added test for it #1591 (929048e)</li> <li>jans-auth-server: jwt \"exp\" must consider \"keyRegenerationInterval\" #1233 (023cf8a)</li> <li>jans-auth-server: make check whether user is active case insensitive #1550 (d141837)</li> <li>jans-auth-server: persist org_id from software statement into client's \"o\" attribute (021d3bd)</li> <li>jans-auth-server: removed dcrSkipSignatureValidation configuration property #1623 (6550247)</li> <li>jans-auth-server: removed id_generation_endpoint and other claims from discovery response #1827 (4068197)</li> <li>jans-auth-server: split grant validation logic into TokenRestWebServiceValidator  #1591 (812e605)</li> <li>jans-auth-server: split validation logic to TokenRestWebServiceValidator  #1591 (f9f6f49)</li> <li>jans-auth-server: updating arquillian tests 1247 (#2017) (ee200a7)</li> <li>jans-cli tabulate scim user list (#1518) (d370978)</li> <li>jans-client-api: migration to Weld/Resteasy and Jetty 11 - Issue 260 (#1319) (420ffc3)</li> <li>jans-client-api: Use injectable operations and remove serviceprovider (#1643) (982cab3)</li> <li>jans-config-api: added new attributes (#1940) (757b22f)</li> <li>jans-config-api: agama configuration integration (#1501) (e84575b)</li> <li>jans-config-api: agama flow endpoint (#1898) (0e73306)</li> <li>jans-config-api: agama patch endpoint (#2028) (0b96a95)</li> <li>jans-config-api: endpoint to get UmaResource based on clientId and swagger changes (#1912) (a3f9145)</li> <li>jans-config-api: enhancement to agama and uma resource endpoint  (#2015) (f2c19a1)</li> <li>jans-config-api: enhancement to expose user inum at root level of response (#1477) (1e4b6bc)</li> <li>jans-config-api: fetch the associated clients_id in GET scopes api response  (#1946) (ffe743c)</li> <li>jans-config-api: fixed user management swagger spec for mandatory fields (#1519) (29ff812)</li> <li>jans-config-api: new endpoint to fetch scope by creator and type (#2098) (cf15d67)</li> <li>jans-config-api: new functionality and swagger fix  (#1802) (fc81d1d)</li> <li>jans-config-api: Scope object changes for creator details (#2033) (a8b8d76)</li> <li>jans-config-api: session management endpoint (#2158) (30f6e1a)</li> <li>jans-config-api: swagger spec change to expose user inum at root level of response (#1483) (c202705)</li> <li>jans-config-api: user management endpoint 418 (#1548) (b95fa7b)</li> <li>jans-core: added StandaloneJavaCustomScriptManagerTest (48ba08b)</li> <li>jans-linux-setup add forgot password script (#1587) (b2e3eb3)</li> <li>jans-linux-setup agama (#1486) (6b23bfe)</li> <li>jans-linux-setup debian 11 packages (#1769) (6fbef91)</li> <li>jans-linux-setup Script for Keystroke Authentication (#1853) (11a9e04)</li> <li>jans-linux-setup: #1731 (#1732) (6fad15b)</li> <li>jans-linux-setup: added discoveryDenyKeys #1827 (f77a6da)</li> <li>jans-orm: update Couchbase ORM to use SDK 3.x #1851 (#1852) (d9d5157)</li> <li>jans-scim: make max no. of operations and payload size of bulks operations parameterizable (#1872) (c27a45b)</li> <li>need to fetch the associated clients_id in GET scopes api response #1923 (#1949) (88606a5)</li> <li>proper plugin activation of config-api container (#1627) (07cabb9)</li> <li>update Coucbase ORM to conform SDK 3.x (config updates) #1851 (#2118) (fceec83)</li> <li>update DSL to support shorthand for finish #1628 (71e4652)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_32","title":"Bug Fixes","text":"<ul> <li>: start_date and end_date not required in /stat reponse (swagger specs) #1767 (#1768) (c21452a)</li> <li>#2143 (#2144) (ff7f9f4)</li> <li>#2157 (#2159) (dc8cb60)</li> <li>a workaround for fido2 dependency (#1590) (527c928)</li> <li>add path parameter to /fido2/registration/entries #1465 (#1508) (808d0c4)</li> <li>agama: template overriding not working with more than one level of nesting (#1841) (723922a)</li> <li>build from source (#1793) (e389363)</li> <li>config-api: fixing discrepancies in the api (#2216) (af4d3a5)</li> <li>correct the link to image (#1660) (0943d81)</li> <li>docker-jans-persistence-loader/Dockerfile to reduce vulnerabilities (#1829) (8e4ae15)</li> <li>don't execute next paged search if current result count less than (#2171) (94a162f)</li> <li>fido2-plugin throwing error during deployment #1632 (#1633) (90d2c8a)</li> <li>fix typos and other issues in jans-config-api swagger specs #1665 (#1668) (3c3a0f4)</li> <li>images: conform to new couchbase persistence configuration (#2188) (c708542)</li> <li>include idtoken with dynamic scopes for ciba (#2108) (d9b5341)</li> <li>indentation (#1821) (8353092)</li> <li>jans app and java version (#1492) (1257e49)</li> <li>Jans cli user userpassword (#1542) (d2e13a2)</li> <li>jans-auth-server: client tests expects \"scope to claim\" mapping which are disabled by default #1873 (958cc92)</li> <li>jans-auth-server: corrected npe in JwtAuthorizationRequest (9c9e7bf)</li> <li>jans-auth-server: disable surefire for jans-auth-static (7869efa)</li> <li>jans-auth-server: fix missing jsonobject annotation (#1651) (be5b82a)</li> <li>jans-auth-server: fixed NPE during getting AT lifetime #1233 (f8be086)</li> <li>jans-auth-server: fixing client tests effected by \"scope to claim\" mapping which is disabled by default #1873 (#1910) (6d81792)</li> <li>jans-auth-server: generate description during built-in key rotation #1790 (#2068) (cd1a77d)</li> <li>jans-auth-server: increased period of session authn time check (#1918) (a41905a)</li> <li>jans-auth-server: sql localizedstring persistence SqlEntryManager (#1475) (b959b94)</li> <li>jans-cli download yaml files for build (#1635) (31b7e49)</li> <li>jans-cli help message format and prompt values (ref: #1352) (#1478) (37a9181)</li> <li>jans-cli hide menu item (#1510) (b70fc52)</li> <li>jans-cli user list failing for empty customAttributes (#1525) (7cbf10b)</li> <li>jans-client-api: minor observations PR13119 - typo transalation code-improvement (#1806) (6df2e42)</li> <li>jans-client-api: remove jans-config-api dependency and solve wrong  test dependencies (#1737) (97dbe9c)</li> <li>jans-client-api: upgrade seleniumhq version from 3.x to 4.x (#2110) (d48271e)</li> <li>jans-config-api add JAVA to programmingLanguage (ref: #1656) (#1667) (a885a92)</li> <li>jans-config-api: avoid loss of attributes in agama endpoints (#2058) (3c8f816)</li> <li>jans-config-api: config-api compilation failed in main #2030 (#2031) (1659da1)</li> <li>jans-config-api: Fix to not update Metadata for PUT and PATCH agama endpoint (#2046) (da93050)</li> <li>jans-config-api: fixed due to couchbase cluster changes(#1863) (c996b51)</li> <li>jans-config-api: fixes for path conflict for SCIM config and spec for UMA Resource mandatory fields (#1805) (6d8cff6)</li> <li>jans-config-api: issue UMA scope request being saved as OAUTH (#2063) (81472aa)</li> <li>jans-config-api: rectified endpoint url in swagger spec for uma resource (#1965) (0dc3b2e)</li> <li>jans-config-api: removed java_script from programmingLanguages (8b935d8)</li> <li>jans-config-api: swagger spec change to add missing attributes for Client (#1786) (e623771)</li> <li>jans-config-api: switch to 1.0.1-SNAPSHOT (e8a9186)</li> <li>jans-core: removed redundant reference #1927 (#1928) (064cbb8)</li> <li>jans-core: switch to 1.0.1-SNAPSHOT (dbe9355)</li> <li>jans-linux-setup add dummy jansRedirectURI to scim client (5023c02)</li> <li>jans-linux-setup add gcs module path for downloading apps (#1538) (e540738)</li> <li>jans-linux-setup add gcs path after packages check (ref: #1514) (#1516) (31dd609)</li> <li>jans-linux-setup add mod_rewrite to httpd_2.4.conf (#1987) (b33b78e)</li> <li>jans-linux-setup debian11 installation (#2160) (8b99498)</li> <li>jans-linux-setup disable script Forgot_Password_2FA_Token (#1662) (377affc)</li> <li>jans-linux-setup displayName of forgot-password script (#1595) (07a5ea0)</li> <li>jans-linux-setup download jans-auth for --download-exit (#1659) (879ed87)</li> <li>jans-linux-setup enable forgot-password script (#1597) (149d19c)</li> <li>jans-linux-setup humanize os name (#2066) (8c89638)</li> <li>jans-linux-setup jans and jetty version (ref: #1792) (#1795) (58cbe20)</li> <li>jans-linux-setup multiple argument --import-ldif (#1476) (5556f36)</li> <li>jans-linux-setup no prompt for eleven installation (#1748) (7228391)</li> <li>jans-linux-setup python executable when launching setup (#1683) (87ac58c)</li> <li>jans-linux-setup remove 101-jans.ldif and 77-customAttributes.ldif (#1831) (bea6302)</li> <li>jans-linux-setup remove apache config when uninstall (#1844) (4a5bc3e)</li> <li>jans-linux-setup remove temporary link file (#1495) (673859a)</li> <li>jans-linux-setup securing files and dirs under /etc/jans (#1782) (d64a7ae)</li> <li>jans-orm: fixed npe in filter processor and covered with tests (ef46516)</li> <li>jans-orm: switch to 1.0.1-SNAPSHOT (0030da7)</li> <li>login.xhtml: add google client js (#1666) (daf9849)</li> <li>main docker version (1220e1c)</li> <li>pycloudlib: handle type mismatch for iterable (#2004) (46e0b2e)</li> <li>random password for keystores (#2102) (b7d9af1)</li> <li>test data for login (#1757) (e043949)</li> <li>update chart repo (8e347a3)</li> <li>update chart repo (011af9d)</li> <li>update error pages (#1957) (3d63f4d)</li> <li>update external modules for otp/fido2 (#1589) (fc42181)</li> <li>use iterator to correcly remove OC attribute (#2138) (b590981)</li> </ul>"},{"location":"CHANGELOG/#miscellaneous-chores_4","title":"Miscellaneous Chores","text":"<ul> <li>prepare docker images release 1.0.1-1 (12660a8)</li> <li>prepare helm chart release 1.0.1 (ae78b76)</li> <li>release 1.0.1 (828bfe8)</li> <li>release 1.0.2 (43dead6)</li> <li>release 1.0.2-1 (d01b51a)</li> </ul>"},{"location":"CHANGELOG/#101-2022-07-06","title":"1.0.1 (2022-07-06)","text":""},{"location":"CHANGELOG/#features_27","title":"Features","text":"<ul> <li>add newly redesigned jans-client-api (#1540) (4582ae5)</li> <li>add support for date ranges in statistic client #1575 (#1653) (8048cd9)</li> <li>add support for requestUriBlockList config (#1572) (63b3b74)</li> <li>agama: allow the config-api to perform syntax check of flows (#1621) (2e99d3a)</li> <li>agama: improve flows timeout (#1447) (ccfb62e)</li> <li>agama: reject usage of repeated input names (#1484) (aed8cf3)</li> <li>endpoint to get details of connected FIDO devices registered to users #1465 (#1466) (62522fe)</li> <li>enhance error handling #1434 (a3f6314)</li> <li>expose prometheus metrics via jmx exporter (#1573) (205e320)</li> <li>fix the dependencies and code issues (#1473) (f4824c6)</li> <li>introduce new hybrid persistence mapping (#1505) (a77ab60)</li> <li>jans linux setup enable/disable script via arg (#1634) (0b3cf16)</li> <li>jans linux setup openbanking CLI and certificate automation (#1472) (62b5868)</li> <li>jans-auth-server: add support for ranges in statistic endpoint (UI team request) (fd66720)</li> <li>jans-auth-server: added convenient method for up-scoping or down-scoping AT scopes #1218 (5d71655)</li> <li>jans-auth-server: added restriction for request_uri parameter (blocklist and allowed client.request_uri) #1503 (0696d92)</li> <li>jans-auth-server: added sid and authn_time for active sessions response (bf9b572)</li> <li>jans-auth-server: improve client assertion creation code (ClientAuthnRequest) #1182 (81946b2)</li> <li>jans-auth-server: make check whether user is active case insensitive #1550 (d141837)</li> <li>jans-auth-server: persist org_id from software statement into client's \"o\" attribute (021d3bd)</li> <li>jans-auth-server: removed dcrSkipSignatureValidation configuration property #1623 (6550247)</li> <li>jans-cli --no-suggestion for automated testing (#1437) (187cc07)</li> <li>jans-cli tabulate scim user list (#1518) (d370978)</li> <li>jans-client-api: migration to Weld/Resteasy and Jetty 11 - Issue 260 (#1319) (420ffc3)</li> <li>jans-config-api: agama configuration integration (#1501) (e84575b)</li> <li>jans-config-api: enhancement to expose user inum at root level of response (#1477) (1e4b6bc)</li> <li>jans-config-api: fixed user management swagger spec for mandatory fields (#1519) (29ff812)</li> <li>jans-config-api: swagger spec change to expose user inum at root level of response (#1483) (c202705)</li> <li>jans-config-api: user management endpoint 418 (#1548) (b95fa7b)</li> <li>jans-core: added Discovery.java script and sample external service (440f2dd)</li> <li>jans-core: added StandaloneJavaCustomScriptManagerTest (48ba08b)</li> <li>jans-core: added test dependencies to scripts (53e5f67)</li> <li>jans-linux-setup add forgot password script (#1587) (b2e3eb3)</li> <li>jans-linux-setup agama (#1486) (6b23bfe)</li> <li>proper plugin activation of config-api container (#1627) (07cabb9)</li> <li>update DSL to support shorthand for finish #1628 (71e4652)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_33","title":"Bug Fixes","text":"<ul> <li>a workaround for fido2 dependency (#1590) (527c928)</li> <li>add path parameter to /fido2/registration/entries #1465 (#1508) (808d0c4)</li> <li>correct the link to image (#1660) (0943d81)</li> <li>fido2-plugin throwing error during deployment #1632 (#1633) (90d2c8a)</li> <li>fix typos and other issues in jans-config-api swagger specs #1665 (#1668) (3c3a0f4)</li> <li>jans app and java version (#1492) (1257e49)</li> <li>Jans cli user userpassword (#1542) (d2e13a2)</li> <li>jans-auth-server: added SessionRestWebService to rest initializer (f0ebf67)</li> <li>jans-auth-server: corrected npe in JwtAuthorizationRequest (9c9e7bf)</li> <li>jans-auth-server: disable surefire for jans-auth-static (7869efa)</li> <li>jans-auth-server: fix missing jsonobject annotation (#1651) (be5b82a)</li> <li>jans-auth-server: sql localizedstring persistence SqlEntryManager (#1475) (b959b94)</li> <li>jans-cli download yaml files for build (#1635) (31b7e49)</li> <li>jans-cli help message format and prompt values (ref: #1352) (#1478) (37a9181)</li> <li>jans-cli hide menu item (#1510) (b70fc52)</li> <li>jans-cli user list failing for empty customAttributes (#1525) (7cbf10b)</li> <li>jans-config-api add JAVA to programmingLanguage (ref: #1656) (#1667) (a885a92)</li> <li>jans-config-api: removed java_script from programmingLanguages (8b935d8)</li> <li>jans-config-api: switch to 1.0.1-SNAPSHOT (e8a9186)</li> <li>jans-core: switch to 1.0.1-SNAPSHOT (dbe9355)</li> <li>jans-linux-setup add gcs module path for downloading apps (#1538) (e540738)</li> <li>jans-linux-setup add gcs path after packages check (ref: #1514) (#1516) (31dd609)</li> <li>jans-linux-setup disable script Forgot_Password_2FA_Token (#1662) (377affc)</li> <li>jans-linux-setup displayName of forgot-password script (#1595) (07a5ea0)</li> <li>jans-linux-setup download jans-auth for --download-exit (#1659) (879ed87)</li> <li>jans-linux-setup enable forgot-password script (#1597) (149d19c)</li> <li>jans-linux-setup multiple argument --import-ldif (#1476) (5556f36)</li> <li>jans-linux-setup python executable when launching setup (#1683) (87ac58c)</li> <li>jans-linux-setup remove temporary link file (#1495) (673859a)</li> <li>jans-orm: switch to 1.0.1-SNAPSHOT (0030da7)</li> <li>main docker version (1220e1c)</li> <li>remove jans-auth-common dependency #1459 (75f4fb5)</li> <li>update external modules for otp/fido2 (#1589) (fc42181)</li> <li>update pom #1438 (#1439) (66b9962)</li> </ul>"},{"location":"CHANGELOG/#miscellaneous-chores_5","title":"Miscellaneous Chores","text":"<ul> <li>prepare docker images release 1.0.1-1 (12660a8)</li> <li>prepare helm chart release 1.0.1 (ae78b76)</li> <li>release 1.0.1 (828bfe8)</li> </ul>"},{"location":"CHANGELOG/#100-2022-05-20","title":"1.0.0 (2022-05-20)","text":""},{"location":"CHANGELOG/#features_28","title":"Features","text":"<ul> <li>add helper to create persistence entry from LDIF file (#1262) (f2e653e)</li> <li>add schema updates #1390 (c9023b3)</li> <li>add script for Google login (#1141) (bac9144)</li> <li>add super-jans project (1ac74d0)</li> <li>adding logs to debug license issues#1258 (#1281) (8a08771)</li> <li>adjust ownership and permission to avoid bloated images (#1312) (d016682)</li> <li>allow flows to access their metadata properties #1340 (344ba04)</li> <li>call id-generation script when creating user/group #1145 (3a9a03a)</li> <li>config-cli enumerate scope type (275533b)</li> <li>create apis to verify and save license api-keys in Admin UI #1196 (#1203) (315faec)</li> <li>initial agama commit #1322 (#1323) (0148bc8)</li> <li>Jans linux setup refactor (#1328) (79d3a75)</li> <li>Jans linux setup ubuntu22 Installation (#1325) (8597750)</li> <li>jans-auth-config: user mgmt endpoint - wip (9c8094a)</li> <li>jans-auth-server: #808 sign-in with apple interception script (c21183a)</li> <li>jans-auth-server: adapted authorization ws to use authzrequest (58c5336)</li> <li>jans-auth-server: added authzrequest abstraction (af8faf0)</li> <li>jans-auth-server: authorized acr values (#1068) (26e576a)</li> <li>jans-auth-server: changed prog lang name python-&gt;jython (b9ba291)</li> <li>jans-auth-server: client registration language metadata (#1237) (a8d0157)</li> <li>jans-auth-server: enable person authn script to have multiple acr names (#1074) (1dc9250)</li> <li>jans-auth-server: force signed request object (#1052) (28ebbc1)</li> <li>jans-auth-server: hide 302 redirect exception in logs #1294 (00197c7)</li> <li>jans-auth,jans-cli,jans-config-api: changes to handle new attribute description in Client object and new custom script type (d64e042)</li> <li>jans-auth,jans-cli,jans-config-api: changes to handle new attribute description in Client object and new custom script type (a096110)</li> <li>jans-auth,jans-cli,jans-config-api: changes to handle new attribute description in Client object and new custom script type (d4a9f15)</li> <li>jans-cli display users in tabular form (#1296) (7f75d39)</li> <li>jans-cli group common items in menu (ref: #892) (#1306) (819f8f7)</li> <li>jans-cli obtain list of attrbiutes from server when creating user (1f9b62d)</li> <li>jans-cli tabulate attribute list (#1313) (a684484)</li> <li>jans-cli use test client (ref: #1283) (#1285) (6320af7)</li> <li>jans-config-api: added custom script patch endpoint (6daa4f6)</li> <li>jans-config-api: added patch endpoint for custom script (e274e20)</li> <li>jans-config-api: added patch endpoint for custom script (f8da77d)</li> <li>jans-config-api: added scope DN validation while client creation (#1293) (f276605)</li> <li>jans-config-api: converting fido2 endpoint to plugin  (#1304) (88c3fff)</li> <li>jans-config-api: exposed attributes at root value (3c3df7a)</li> <li>jans-config-api: exposed attributes at root value (40570a7)</li> <li>jans-config-api: fixed build issue due to LocalizedString change (#1329) (3b5ab78)</li> <li>jans-config-api: ignore client.customObjectClasses value for persistence type other than LDAP (#1073) (622bcf4)</li> <li>jans-config-api: rectified test properties file  (#1222) (5b80f67)</li> <li>jans-config-api: removed encrypttion and decryption of user password (7f50ad0)</li> <li>jans-config-api: removed unused import (8a41484)</li> <li>jans-config-api: user custom attributes at root level - 1348 (5b3f0a1)</li> <li>jans-config-api: user management api (b367d44)</li> <li>jans-config-api: user management api (517e7f2)</li> <li>jans-config-api: user management api (a034bc3)</li> <li>jans-config-api: user management endpoint (f28f3b8)</li> <li>jans-config-api: user management enhancement to chk mandatory feilds (903ba5a)</li> <li>jans-config-api: user management enhancement to chk mandatory feilds (0bc2282)</li> <li>jans-config-api: user management enhancement to chk mandatory feilds (e6e2781)</li> <li>jans-config-api: user management mandatory field chk changes (e242ec6)</li> <li>jans-config-api: user management patch endpoint (0a7ad7d)</li> <li>jans-config-api: user mgmt endpoint (a093758)</li> <li>jans-config-api: user mgmt endpoint (ad66713)</li> <li>jans-config-api: user mgmt endpoint (0f7a723)</li> <li>jans-config-api: user mgmt endpoint (379ca09)</li> <li>jans-config-api: user mgmt endpoint (f98c59e)</li> <li>jans-config-api: user mgmt endpoint (0ea10fd)</li> <li>jans-config-api: user mgmt endpoint - wip (70987f6)</li> <li>jans-config-api: user mgmt endpoint - wip (af30358)</li> <li>jans-config-api: user mgmt endpoint - wip (aadbf8b)</li> <li>jans-config-api: user mgmt endpoint -wip (ac35327)</li> <li>jans-config-api: user mgmt endpoints (1d53b2e)</li> <li>jans-config-api: user mgmt endpoints (5cd1ad5)</li> <li>jans-config-api: user mgmt patch endpoint (1180068)</li> <li>jans-config-api: user mgmt patch endpoint (12a08e1)</li> <li>jans-config-api: user mgmt patch endpoint (0427186)</li> <li>jans-config-api: user mgmt patch endpoint (cb7d36c)</li> <li>jans-config-api: user mgt plugin (ccc56f8)</li> <li>jans-config-api: user mgt plugin (ae132cf)</li> <li>jans-config-api: user-management endpoints (#1167) (d8e97c4)</li> <li>jans-core: added more error logs if script is not loaded (4084aeb)</li> <li>jans-core: added pure java discovery sample custom script (1d01ba7)</li> <li>jans-core: compile java code on the fly for custom script (5da6e27)</li> <li>jans-core: corrected StandaloneCustomScriptManager (0a52ec8)</li> <li>jans-core: remove UPDATE_USER and USER_REGISTRATION scripts #1289 (c34e75d)</li> <li>jans-linux-setup config-api fido2-plugin (ref: #1303) (#1308) (ea929c0)</li> <li>jans-linux-setup copy site packages in case of pyz (8a8a05e)</li> <li>jans-linux-setup fido metadata folder (8e95b7a)</li> <li>jans-linux-setup load pure java sample custom script (#1335) (60cb36c)</li> <li>jans-linux-setup refactor key reneration for all backends (ref: #1147) (#1228) (cbe29c4)</li> <li>jans-linux-setup set DefaultTimeoutStartSec=300s (#1279) (6b511c4)</li> <li>jans-linux-setup show version (b16b77d)</li> <li>jans-linux-setup: config-api user management plugin (ref: ##1213) (#1223) (450c78c)</li> <li>jans-linux-setup: multivalued json enhancement (#1102) (b8fb658)</li> <li>jans: jetty 11 integration (#1123) (6c1caa1)</li> <li>merge ORM from Gluu (#1200) (685a159)</li> <li>move file downloads to setup (2680bd0)</li> <li>pre-populate role scope mapping dynamically (#1201) (3ab6a11)</li> <li>remove Jython's pip from images (#1176) (e3f374f)</li> <li>user management enhancement to chk mandatory feilds (3ac4b19)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_34","title":"Bug Fixes","text":"<ul> <li>#1107 - not required (cf46672)</li> <li>#1107 jansCodeChallengeHash missing (65ac184)</li> <li>add issue guidelines to TOC (#1188) (192165b)</li> <li>add missing permission and defaultPermissionInToken attribute in role-scope mapping (#1270) (e2c67ec)</li> <li>adjust beans and schema #1107 (#1248) (369129d)</li> <li>admin-ui: the backend issues related to jetty 11 migration #1258 (#1259) (d61be0b)</li> <li>agama: adjust pom version #1402 (#1403) (930f080)</li> <li>agama: adjust pom version #1402 (#1404) (86bf614)</li> <li>avoid duplicated client when re-running persistence-loader and configurator (#1134) (5567ba9)</li> <li>broken links (86d0232)</li> <li>bug(jans-auth-server): custom pages are not found #1318 (e1e0bf9)</li> <li>change column size of jansFido2AuthnEntry.jansAuthData column (#1066) (f1c3ffa)</li> <li>code smells (e5aaad7)</li> <li>config-api: scim user management endpoint failing due to conflict with user mgmt path (#1181) (8ee47a0)</li> <li>Data too long for column #1107 (8eb2c70)</li> <li>errors adding/upgrading data into couchbase persistence (#1226) (db71324)</li> <li>extract directory (fe7a3c5)</li> <li>fix license apis#1258 (#1271) (14c6a2b)</li> <li>handle index error for JSON columns (#1205) (90f77c3)</li> <li>hyperlinks (#1209) (d1e1ed6)</li> <li>invalid LDAP schema reading token_server client ID (#1321) (db4f080)</li> <li>jans cli update readme (2f4f57f)</li> <li>jans-auth-server: added faces context as source of locale (#1189) (ce770ae)</li> <li>jans-auth-server: authorize page message policy (#1096) (f10ccb1)</li> <li>jans-auth-server: corrected fallback value of checkUserPresenceOnRefreshToken (a822ae5)</li> <li>jans-auth-server: corrected log vulnerability (1000a60)</li> <li>jans-auth-server: corrected npe in response type class (941248d)</li> <li>jans-auth-server: corrected signature algorithm identification with java 11 and later (3e203f2)</li> <li>jans-auth-server: corrected thread-safety bug in ApplicationAuditLogger #803 (ef73c2b)</li> <li>jans-auth-server: disabled issuing AT by refresh token if user status=inactive (3df72a8)</li> <li>jans-auth-server: do not serialize jwkThumbprint (d8634fe)</li> <li>jans-auth-server: during encryption AS must consider client's jwks too, not only jwks_uri (475b154)</li> <li>jans-auth-server: dynamic client registration managment delete event (911e54b)</li> <li>jans-auth-server: escape login_hint before rendering (e1a682a)</li> <li>jans-auth-server: fixed equals/hashcode by removing redundant dn field (d27659d)</li> <li>jans-auth-server: fixed server and tests after jetty 11 migration (#1354) (3fa19f4)</li> <li>jans-auth-server: gluuStatus -&gt; jansStatus (7f86d6d)</li> <li>jans-auth-server: isolate regex redirection uri validation test (#1075) (cca0551)</li> <li>jans-auth-server: removed CONFIG_API from AS supported script types #1286 (c209868)</li> <li>jans-auth-server: removed ThumbSignInExternalAuthenticator (a13ca51)</li> <li>jans-auth-server: renamed localization resoruces files #1198 (#1199) (4561f2a)</li> <li>jans-auth-server: restored id generator call to external custom script (#1128) (5ba98c1)</li> <li>jans-auth-server: use duration class instead of custom util to calculate seconds from date to now (#1249) (5ae76ab)</li> <li>jans-auth-server: validate redirect_uri blank and client redirect uris single item to return by default (#1046) (aa139e4)</li> <li>jans-cl update WebKeysConfiguration (#1211) (54847bc)</li> <li>jans-cli allow emptying list attrbiutes by _null (#1166) (571c5cd)</li> <li>jans-cli code smells (1dc5cb0)</li> <li>jans-cli do not require client if access token is provided (6b787ec)</li> <li>jans-cli hardcode enums (739a759)</li> <li>jans-cli scope dn/id when creating client (518f971)</li> <li>jans-cli scope dn/id when creating client (f056abf)</li> <li>jans-cli: corrected typo (#1050) (4d93a49)</li> <li>jans-client-api replace netstat with ss in startup script (#1246) (cde3fb1)</li> <li>jans-config-api: corrected typo in swagger spec (3c11556)</li> <li>jans-config-api: LDAP test endpoint fix (#1320) (fb0e132)</li> <li>jans-core: corrected ExternalUmaClaimsGatheringService (cfe1b6d)</li> <li>jans-linux-setup --add-module (4f6b8a9)</li> <li>jans-linux-setup code smell (09bb36e)</li> <li>jans-linux-setup code smell (b790c01)</li> <li>jans-linux-setup code smell (3c57d5e)</li> <li>jans-linux-setup code smells (4f362e5)</li> <li>jans-linux-setup code smells (824cf1f)</li> <li>jans-linux-setup code smells (b2a48db)</li> <li>jans-linux-setup code smells (e930f16)</li> <li>jans-linux-setup code smells (45953c6)</li> <li>jans-linux-setup code smells (b01da85)</li> <li>jans-linux-setup config-api plugin dependencies (#1310) (b5577dd)</li> <li>jans-linux-setup copy_tree (2c2ad3a)</li> <li>jans-linux-setup create json index for multivalued attributes (#1131) (be9e63c)</li> <li>jans-linux-setup dependency prompt-toolkit (865647e)</li> <li>jans-linux-setup maven url (244135d)</li> <li>jans-linux-setup move mysql-timezone to config (31df7db)</li> <li>jans-linux-setup multivalued json mapping (ref: #1088) (#1090) (e3d9dbf)</li> <li>jans-linux-setup openbanking setup issues (3837dd2)</li> <li>jans-linux-setup set log level to TRACE for test data (#1345) (21a2120)</li> <li>jans-linux-setup typo (#1311) (97723d5)</li> <li>jans-linux-setup url of config api scim plugin (da007f0)</li> <li>jans-linux-setup-key key-regeneration fix spanner host (#1229) (5a472ad)</li> <li>jans-linux-setup: copy user-mgt-plugin (#1225) (8def41a)</li> <li>jans-linux-setup: defaults loggingLevel to INFO (#1346) (26b1163)</li> <li>jans-linux-setup: enable mod_auth_openidc (#1048) (40e24ea)</li> <li>jans-linux-setup: minor typo (#1109) (32b5af5)</li> <li>jans-linux-setup: rdbm index (#1135) (ec3bd1b)</li> <li>jans-linux-setup: remove attributes of size 64 from sql_data_types.json (#1112) (1726d09)</li> <li>linux-setup don't use personCustomObjectClassList for RDBMS (ref: #1214) (#1216) (4d8dff7)</li> <li>Make column wider #1044 (f3e393f)</li> <li>Security Hotspot (4e091c4)</li> <li>Security Hotspot (1899a39)</li> <li>set permission for jans-auth.xml explicitly (#1315) (80f33a2)</li> <li>submit button is missing from the Properties page #175 (2424965)</li> <li>the admin-ui backend issues related to jetty 11 migration #1258 (cf94d5f)</li> <li>typo and indexing error (#1125) (dc87dc0)</li> <li>Typo httpLoggingExludePaths jans-auth-server jans-cli jans-config-api jans-linux-setup docker-jans-persistence-loader (47a20ee)</li> <li>typo in jans-cli interactive mode (25f5971)</li> <li>update api-admin permissions from config api yaml (#1183) (438c896)</li> <li>update mysql/spanner mappings #1053 (94fb2c6)</li> <li>update templates #1053 (2e33a43)</li> <li>Use highest level script in case ACR script is not found. Added FF to keep existing behavior. (#1070) (07473d9)</li> <li>use secure http urls for maven repositories (#1353) (496b5b2)</li> <li>use shutil instead of zipfile (c0a0cde)</li> </ul>"},{"location":"CHANGELOG/#miscellaneous-chores_6","title":"Miscellaneous Chores","text":"<ul> <li>prepare release 1.0.0-1 (8985928)</li> <li>release 1.0.0 (9644d1b)</li> <li>release 1.0.0 (b2895f2)</li> <li>release 1.0.0-beta.16 (a083ad6)</li> <li>release 1.0.0-beta.16 (90e4bb2)</li> <li>release 1.0.0-beta.16 (eec2073)</li> <li>release 1.0.0-beta.16 (cd92ead)</li> <li>release 1.0.0-beta.16 (7f0a91b)</li> <li>release 1.0.0-beta.16 (c2ad604)</li> <li>release 1.0.0-beta.16 (a641486)</li> <li>release 1.0.0-beta.16 (94d5791)</li> <li>release 1.0.0-beta.16 (16de429)</li> <li>release 1.0.0-beta.16 (72915c0)</li> <li>release 1.0.0-beta.16 (3ea2b37)</li> <li>release 1.0.0-beta.16 (78a6d39)</li> <li>release 1.0.0-beta.16 (11bfa93)</li> <li>release 1.0.0-beta.16 (22b180b)</li> <li>release 1.0.0-beta.16 (b9acd0b)</li> <li>release 1.0.0-beta.16 (328cd30)</li> <li>release 1.0.0-beta.16 (5a84602)</li> <li>release 1.0.0-beta.16 (4923277)</li> <li>release 1.0.0-beta.16 (258ba96)</li> <li>release 1.0.0-beta.16 (77c4423)</li> <li>release 1.0.0-beta.16 (688b324)</li> </ul>"},{"location":"CHANGELOG/#100-beta16-2022-03-14","title":"1.0.0-beta.16 (2022-03-14)","text":""},{"location":"CHANGELOG/#features_29","title":"Features","text":"<ul> <li>add acrValues property in admin-ui configuration. #1016 (#1017) (88b591a)</li> <li>add support for role-based client (i.e. jans-cli) (#956) (306bd52)</li> <li>add support to import custom ldif (#1002) (0b6334a)</li> <li>add validity length (in days) for certs (#981) (abc89dc)</li> <li>jans-auth-server: forbid plain pkce if fapi=true (fapi1-advanced-final-par-plain-pkce-rejected fail) #946 (21cecb0)</li> <li>jans-auth-server: new client config option defaultpromptlogin #979 (4e3de26)</li> <li>jans-cli: get access token from arg (#1013) (efd718a)</li> <li>jans-config-api: swagger spec change to add extension (4f9d76c)</li> <li>jans-config-api: swagger spec change to add extension to differentiate plugin en\u2026 (4f9d76c)</li> <li>jans-linux-setup: check availibility of ports for OpenDJ backend (#949) (a2944c1)</li> <li>jans-linux-setup: install mod_auth_openidc (ref: #909) (#952) (270a7b6)</li> <li>jans-linux-setup: refactored argsp (#969) (409d364)</li> <li>support regex client attribute to validate redirect uris (#1005) (a78ee1a)</li> <li>swagger spec change to add extension to differentiate plugin endpoint (bb3b88a)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_35","title":"Bug Fixes","text":"<ul> <li>** jans-linux-setup:** added to extraClasspath (#968) (bfb0bfe)</li> <li>add missing values for openbanking (#939) (b140892)</li> <li>avoid jetty hot-deployment issue (#1012) (a343215)</li> <li>change in swagger spec for jwks to return missing attributes (477643b)</li> <li>ci: fix change identification logic (#966) (e964291)</li> <li>jans cli build issues (update doc and fix requirements) (#938) (18d1507)</li> <li>jans-auth-server: corrected ParValidatorTest #946 (04a01fd)</li> <li>jans-auth-server: corrected sonar reported issue (7c88078)</li> <li>jans-auth-server: fix npe (e6debb2)</li> <li>jans-auth-server: reduce noise in logs when session can't be found (47afc47)</li> <li>jans-auth-server: removed reference of removed tests #996 (cabc4f2)</li> <li>jans-auth-server: validate pkce after extraction data from request object (#999) (29fdfae)</li> <li>jans-config-api: create openid client throwing 502 (#1004) (3f58aff)</li> <li>jans-linux-setup add dependency python3-prompt-toolkit (#975) (2d4a101)</li> <li>jans-linux-setup flex-setup argsp (7ee41a7)</li> <li>jans-linux-setup flex-setup argsp (7ee41a7)</li> <li>jans-linux-setup flex-setup argsp (9a00e93)</li> <li>jans-linux-setup getting argparser (#974) (5fc60d4)</li> <li>jans-linux-setup remove fido authentication scripts from template (#991) (753ab0c)</li> <li>jans-linux-setup: backup cli direcory if any (#976) (dc42d0f)</li> <li>jans-linux-setup: not copy duo_web.py (#971) (b5691b5)</li> <li>jans-linux-setup: openbanking argparser issue (#985) (ab40173)</li> <li>jans-linux-setup: require python3-distutils for deb clones (#967) (9a76f23)</li> <li>jans-linux-setup: update suse15 dependency (#980) (3be0ffa)</li> </ul>"},{"location":"CHANGELOG/#miscellaneous-chores_7","title":"Miscellaneous Chores","text":"<ul> <li>release 1.0.0-beta.16 (a083ad6)</li> <li>release 1.0.0-beta.16 (90e4bb2)</li> <li>release 1.0.0-beta.16 (eec2073)</li> <li>release 1.0.0-beta.16 (cd92ead)</li> <li>release 1.0.0-beta.16 (7f0a91b)</li> <li>release 1.0.0-beta.16 (c2ad604)</li> <li>release 1.0.0-beta.16 (a641486)</li> <li>release 1.0.0-beta.16 (94d5791)</li> <li>release 1.0.0-beta.16 (16de429)</li> <li>release 1.0.0-beta.16 (72915c0)</li> <li>release 1.0.0-beta.16 (3ea2b37)</li> <li>release 1.0.0-beta.16 (78a6d39)</li> <li>release 1.0.0-beta.16 (11bfa93)</li> <li>release 1.0.0-beta.16 (22b180b)</li> <li>release 1.0.0-beta.16 (b9acd0b)</li> <li>release 1.0.0-beta.16 (328cd30)</li> <li>release 1.0.0-beta.16 (5a84602)</li> <li>release 1.0.0-beta.16 (4923277)</li> <li>release 1.0.0-beta.16 (258ba96)</li> <li>release 1.0.0-beta.16 (77c4423)</li> <li>release 1.0.0-beta.16 (688b324)</li> <li>release 1.0.0-beta.16 (4e86f15)</li> <li>release 1.0.0-beta.16 (8d514ee)</li> <li>release 1.0.0-beta.16 (0899898)</li> </ul>"},{"location":"CHANGELOG/#100-beta15-2022-03-02","title":"1.0.0-beta.15 (2022-03-02)","text":""},{"location":"CHANGELOG/#features_30","title":"Features","text":"<ul> <li>#836 support push token update on finish authentication (#837) (4d6d916)</li> <li>add correlation id in pages and rest endpoints to track logs (#410) (b9c39af)</li> <li>add correlation id in pages and rest endpoints to track logs (#410) (27fab9f)</li> <li>add deletable flag to admin-ui role object #888 (#901) (5b95a55)</li> <li>add Gluu Casa support (608a9b8)</li> <li>add Gluu Casa support (608a9b8)</li> <li>add Gluu Casa support (089a872)</li> <li>add Gluu Casa support (089a872)</li> <li>add Helm chart for Core Janssen Distro (#753) (edb35d7)</li> <li>add jansClaimName to all attrbiutes (8f219fb)</li> <li>add jansClaimName to all attrbiutes (0947757)</li> <li>add POST /rolePermissionsMapping for adding new rolePermissionsMapping entry #144 (41d5913)</li> <li>add POST /rolePermissionsMapping for adding new rolePermissionsMapping entry #144 (85e777b)</li> <li>add POST /rolePermissionsMapping for adding new rolePermissionsMapping entry #144 (6ac57dc)</li> <li>add POST /rolePermissionsMapping for adding new rolePermissionsMapping entry #144 (d5b28fc)</li> <li>add POST /rolePermissionsMapping for adding new rolePermissionsMapping entry #144 (bd34c29)</li> <li>add POST /rolePermissionsMapping for adding new rolePermissionsMapping entry #144 (149aeb1)</li> <li>add POST /rolePermissionsMapping for adding new rolePermissionsMapping entry #144 (7bcad3b)</li> <li>add POST /rolePermissionsMapping for adding new rolePermissionsMapping entry #144 (932a45b)</li> <li>add POST /rolePermissionsMapping for adding new rolePermissionsMapping entry #144 (cc4bc91)</li> <li>add POST /rolePermissionsMapping for adding new rolePermissionsMapping entry #144 (4b2bea7)</li> <li>added ability remove all tokens per client by token type (3cd3ada)</li> <li>added ability remove all tokens per client by token type (5e8fad9)</li> <li>allow jwt tokens for scim service protection #834 (#856) (392b3fc)</li> <li>ce-setup add python cryptography library to dependency (d312479)</li> <li>ce-setup: deploy facter script (ref: #622) (#624) (9426517)</li> <li>enable/disable admin-ui frontend plugins (ref: #150) (aaf8ca1)</li> <li>enable/disable admin-ui frontend plugins (ref: #150) (66ca69f)</li> <li>if value is null return null to token type hint (78ed12f)</li> <li>if value is null return null to token type hint (848f1ca)</li> <li>image: implement role-based scope script (#813) (bd68898)</li> <li>image: push otp and super_gluu configuration to secrets (#784) (87bd7fe)</li> <li>jans-auth-server: add methods to dynamic client registration script to modify POST, PUT and GET responses (#661) (2aa2ba8)</li> <li>jans-auth-server: added cache support to /stat endpoint (e1dba92)</li> <li>jans-auth-server: added new stat response service with test (9d60629)</li> <li>jans-auth-server: added post response modification method (db936f9)</li> <li>jans-auth-server: added put response modification method (00a24f2)</li> <li>jans-auth-server: added read response modification method (ec8864b)</li> <li>jans-auth-server: added to par extra nbf and exp (for 60min) validation (#838) (9db47a4)</li> <li>jans-auth-server: allow return custom authz params to rp in response (#756) (0e865fb)</li> <li>jans-auth-server: extending crypto support sub pr4 (#670) (fe07d76)</li> <li>jans-auth-server: invoke custom script methods for response modification (da44d5a)</li> <li>jans-auth-server: preparations for revoke refresh tokens for client (b1cf69b)</li> <li>jans-auth-server: preparations for revoke refresh tokens for client (2641574)</li> <li>jans-auth-server: reject par without pkce for fapi (332df41)</li> <li>jans-auth-server: set public subject identifier per client (#800) (c303bbc)</li> <li>jans-auth-server: turn off consent for pairwise openid-only scope (#708) (a96007d)</li> <li>jans-ce-setup: ce-setup suse compatibility (#692) (f0076fc)</li> <li>jans-ce-setup: extending crypto support, sub pr4; #142; (#669) (b8fda09)</li> <li>jans-ce-setup: updated client registration script with newly added methods (595bfd4)</li> <li>jans-cli logout (ref: #706) (#723) (0cc51bc)</li> <li>jans-config-api: add deletable flag to admin-ui role object #888 (#900) (500a773)</li> <li>jans-config-api: all config-api plugins should be in same plugins folder in maven repo #851 (#852) (cca93b2)</li> <li>jans-config-api: config api interception script (#840) (8e4c688)</li> <li>jans-config-api: organization configuration management endpoints (#790) (40ca464)</li> <li>jans-config-api: scim config endpoint issue #271 (#665) (a6e9a04)</li> <li>jans-config-api: security issue - upgrade dependencies (#883) (10568ff)</li> <li>jans-config-api: swagger update for default value (#862) (8f59921)</li> <li>jans-config-api: underlying server stats #275 (ae6f2d7)</li> <li>jans-core: added methods for register response modification (9f18613)</li> <li>jans-core: added read response modification method (74bbe38)</li> <li>jans-linux-setup: added config-api interception script (ref: #831) (#882) (48a3195)</li> <li>jans-linux-setup: import custom ldif (#873) (363cf0e)</li> <li>jans-linux-setup: Jans linux setup pkg mysql and uninstall (#827) (0fb53e1)</li> <li>jans-setup: updated sample revoke script (45e43db)</li> <li>jans-setup: updated sample revoke script (607a23c)</li> <li>linux-setup node installer (662a27f)</li> <li>par should be able to register with nbf (a4a2981)</li> <li>protecting Admin-UI Plugin Apis #142 (52e8846)</li> <li>protecting Admin-UI Plugin Apis #142 (a1a0d54)</li> <li>removed revoke token context (84b27cd)</li> <li>removed revoke token context (4f71ae2)</li> <li>support MySQL with MariaDB engine gluu #18 (#712) (9071db4)</li> <li>underlying server stats (ae6f2d7)</li> <li>underlying server stats (0f36336)</li> <li>underlying server stats (56b72e9)</li> <li>update base images #672 (#673) (0a23d08)</li> <li>update config-api image (#874) (b9f56c3)</li> <li>use ExecutionContext instead of token revoke context in custom scripts (b67af11)</li> <li>use ExecutionContext instead of token revoke context in custom scripts (e1ba0b4)</li> </ul>"},{"location":"CHANGELOG/#bug-fixes_36","title":"Bug Fixes","text":"<ul> <li>brazilob jarm fapi conformance test last7 issues (#695) (edab074)</li> <li>ce-setup: typo (af37066)</li> <li>certmanager: patches for auth handler (#626) (d95453f)</li> <li>check MariaDB json in result set metadata (96b6772)</li> <li>client tests have been restored #1595; (76593c5)</li> <li>client tests have been restored #1595; (1cc118f)</li> <li>client tests have been restored #1595; (5570336)</li> <li>client tests have been restored #1595; (ef5cc52)</li> <li>client tests have been restored #1595; (776ce2a)</li> <li>client tests have been restored #1595; (8818dbc)</li> <li>client tests have been restored #1595; (87e0963)</li> <li>client tests have been restored #1595; (b43f3cd)</li> <li>client tests have been updated #1595; (17ab35d)</li> <li>client tests have been updated #1595; (4c352df)</li> <li>client tests have been updated #1595; (e705bc9)</li> <li>client tests have been updated #1595; (c4d9c2e)</li> <li>codacy warnings (0aca641)</li> <li>codacy warnings (1f5b246)</li> <li>code reformatting as suggested (a70ceda)</li> <li>copyrights have been added #1595; (72b4ad9)</li> <li>copyrights have been added #1595; (b6f6ae5)</li> <li>corrected uma test failures (12299fd)</li> <li>corrected uma test failures (ff26824)</li> <li>correction as suggested in review (adddb1a)</li> <li>data_provider, multiplying redundant calls of u test functions, listener has been added; (fab2f75)</li> <li>data_provider, multiplying redundant calls of u test functions, listener has been added; (096b0ac)</li> <li>doc_id for base (#149) (e7b4747)</li> <li>doc_id for base (#149) (eb0801e)</li> <li>early exit to avoid nested if(s) (ab65ac9)</li> <li>error has been added to the unit tests #1595; (53b4daa)</li> <li>error has been added to the unit tests #1595; (ac35a91)</li> <li>error has been removed from unit tests #1595; (fdecdc2)</li> <li>error has been removed from unit tests #1595; (e7330d6)</li> <li>fail has been added (for testing) #1595; (e5b7161)</li> <li>fail has been added (for testing) #1595; (aef4f3a)</li> <li>fail has been removed #1595; (cfa61e7)</li> <li>fail has been removed #1595; (fd65b1c)</li> <li>fix method to determine if Db is MariaDB (edf5a8d)</li> <li>fix RDBS export entry and DeleteNotifier (#864) (ce5b2e6)</li> <li>for JARM issue 310 311 and 314  (ae0cdb9)</li> <li>gprcio bug in build error (0ee6386)</li> <li>gprcio bug in build error (664a4fe)</li> <li>image: update images (#775) (b31059c)</li> <li>import Nullable (5057531)</li> <li>improving usage data_provider name; (6c47925)</li> <li>improving usage data_provider name; (5acd2e2)</li> <li>jans-auth-server: check alg none to display error JARM issue310 (#786) (b21a052)</li> <li>jans-auth-server: corrected 500 error if absent redirect_uri in object for fapi (89e586a)</li> <li>jans-auth-server: corrected error code for absent redirect_uri in object (fapi) (f73430c)</li> <li>jans-auth-server: corrected jarm error response (1d4b53b)</li> <li>jans-auth-server: corrected jarm isuue #310 (#773) (e1cdc19)</li> <li>jans-auth-server: corrected jarm response mode (9e3bf69)</li> <li>jans-auth-server: corrected npe in jarm (5cae544)</li> <li>jans-auth-server: corrected wrong expires_in (428c5b3)</li> <li>jans-auth-server: covered one more case when consent is off (8b59739)</li> <li>jans-auth-server: don't fail registration without custom script (#711) (277be82)</li> <li>jans-auth-server: error code correction unregister redirect_uri (#814) #816 (fe4d6a0)</li> <li>jans-auth-server: fixed device authz tests (8a952d7)</li> <li>jans-auth-server: fixed error code during error response creation (0d47490)</li> <li>jans-auth-server: for issue#315 JARM registered redirect uri (#752) (fe2dc59)</li> <li>jans-auth-server: if consent is off then check whether response already have access_tokne (81ad31b)</li> <li>jans-auth-server: if consent is off then check whether response already have code (294bb22)</li> <li>jans-auth-server: jarm failing tests (#745) (5d0b401)</li> <li>jans-auth-server: jarm tests fix (ddf3423)</li> <li>jans-auth-server: made tknCde consistency=true for UmaRPT (298a35a)</li> <li>jans-auth-server: made tknCde consistency=true for UmaRPT (0554882)</li> <li>jans-auth-server: set par expiration to request object exp #824 (#860) (c835c38)</li> <li>jans-ce-setup monorepo tweaks (36c2d0b)</li> <li>jans-ce-setup: add npm run plugin:clean to admin-ui setup (70f01bf)</li> <li>jans-cli sync swagger file from jans-config-api (#759) (315c699)</li> <li>jans-client-api/server/pom.xml to reduce vulnerabilities (89756bb)</li> <li>jans-client-api: corrected test cases configuration #724 (#726) (f98db00)</li> <li>jans-cli: jans cli pkg fixes (#854) (9e96e4c)</li> <li>jans-cli: retain scim client in config.ini (#872) (8346517)</li> <li>jans-config-api: excluded test from execution (#760) (3af6672)</li> <li>jans-config-api: license validity period should be read only #731 (f88095b)</li> <li>jans-config-api: multiple custom lib not working  (#907) (9ef6fa4)</li> <li>jans-config-api: sql configuration endpoints are not found #793 (#794) (d8f2ea9)</li> <li>jans-fido2: use diamond operator (#764) (5950a26)</li> <li>jans-linux-setup config-api default file (#910) (86ff007)</li> <li>jans-linux-setup openbanking (1a5f708)</li> <li>jans-linux-setup : tweak install.py for new directory structure (#825) (493337f)</li> <li>jans-linux-setup update config-api scim plugin maven url (#866) (885a06d)</li> <li>jans-linux-setup: added missing values for openbanking (#913) (1977eec)</li> <li>jans-linux-setup: fixed link in readme.md (edf735e)</li> <li>jans-linux-setup: missing code for platform authenticator (TouchID) (#792) (263b76a)</li> <li>jans-linux-setup: remove non-utf character from description of attribute 98FC (#877) (321a8e9)</li> <li>jans-linux-setup: restore changes after 4babe55a494c0edad899776f086d8c59368031f2 (#835) (c8f4b19)</li> <li>jans-linux-setup: service install check for jetty 10 (#911) (a7e57aa)</li> <li>jans-linux-setup: uninstall does not prompt with -n (#887) (c009dd5)</li> <li>JARM tests fix (3bfb95f)</li> <li>license validity period should be read only #731 (#746) (73931f5)</li> <li>linux-setup apache config file name (#719) (46ce0ae)</li> <li>linux-setup mariadb json data types (#714) (4c21be2)</li> <li>linux-setup suse httpd configuration (#734) (7767b5e)</li> <li>listener class has been fixed #1595; (af141a3)</li> <li>listener class has been fixed #1595; (8c7e0c3)</li> <li>listener has been renamed; (d4cb3a7)</li> <li>listener has been renamed; (7f283f3)</li> <li>listener has been updated #1595; (527d1c2)</li> <li>listener has been updated #1595; (03bac01)</li> <li>listener has been updated #1595; (c31cf42)</li> <li>listener has been updated #1595; (21b8f56)</li> <li>listener has been updated; (f3cbc35)</li> <li>listener has been updated; (0673a15)</li> <li>newly added eddsa cause exception (#727) (6e5a865)</li> <li>pycloudlib: missing tar option to not restore file timestamp #613 (#627) (d19fbfd)</li> <li>remove remote theme (bcca289)</li> <li>reorder java modifiers (#750) (e5401b2)</li> <li>replace non UTF-8 characters (#770) (bb386cd)</li> <li>temp removing client tests #1595; (a04fa23)</li> <li>temp removing client tests #1595; (b6b965f)</li> <li>temp removing client tests #1595; (494f788)</li> <li>temp removing client tests #1595; (8261a1f)</li> <li>update admin ui properties (#778) (2052d02)</li> <li>update config github pages (#771) (5c5b979)</li> <li>update scripts (#765) (8b9aaca)</li> <li>update wrong import #905 (#906) (af55a81)</li> <li>upgrade commons-codec:commons-codec from 1.7 to 20041127.091804 (3d319b8)</li> <li>upgrade oauth.signpost:signpost-commonshttp4 from 2.0.0 to 2.1.1 (7246e8f)</li> <li>upgrade org.apache.httpcomponents:httpcore from 4.4.5 to 4.4.15 (82689d2)</li> <li>upgrade org.bitbucket.b_c:jose4j from 0.6.4 to 0.7.9 (874e2ad)</li> <li>upgrade org.codehaus.jettison:jettison from 1.3.2 to 1.4.1 (5ffe19d)</li> <li>use diamond operator (#766) (57664b0)</li> <li>vm setup suse fixes (#705) (2f69a8a)</li> </ul>"},{"location":"CHANGELOG/#miscellaneous-chores_8","title":"Miscellaneous Chores","text":"<ul> <li>release 1.0.0-beta.15 (ee5b719)</li> <li>release 1.0.0-beta.15 (ca6d1c9)</li> <li>release 1.0.0-beta.15 (b65bab2)</li> </ul>"},{"location":"CODE_OF_CONDUCT/","title":"Janssen Code of Conduct v1.0","text":""},{"location":"CODE_OF_CONDUCT/#our-pledge","title":"Our Pledge","text":"<p>In the interest of fostering an open and welcoming environment, we as contributors and maintainers pledge to making participation in our project and our community a harassment-free experience for everyone, regardless of age, body size, disability, ethnicity, sex characteristics, gender identity and expression, level of experience, education, socio-economic status, nationality, personal appearance, race, religion, or sexual identity and orientation.</p>"},{"location":"CODE_OF_CONDUCT/#our-standards","title":"Our Standards","text":"<p>Examples of behavior that contributes to creating a positive environment include:</p> <ul> <li>Using welcoming and inclusive language</li> <li>Being respectful of differing viewpoints and experiences</li> <li>Gracefully accepting constructive criticism</li> <li>Focusing on what is best for the community</li> <li>Showing empathy towards other community members</li> </ul> <p>Examples of unacceptable behavior by participants include:</p> <ul> <li>The use of sexualized language or imagery and unwelcome sexual attention or advances</li> <li>Trolling, insulting/derogatory comments, and personal or political attacks</li> <li>Public or private harassment</li> <li>Publishing others\u2019 private information, such as a physical or electronic address, without explicit permission</li> <li>Other conduct which could reasonably be considered inappropriate in a professional setting</li> </ul>"},{"location":"CODE_OF_CONDUCT/#our-responsibilities","title":"Our Responsibilities","text":"<p>Janssen Project members, project participants and contributors (collectively, \"participants\") are responsible for clarifying the standards of acceptable behavior and are expected to take appropriate and fair corrective action in response to any instances of unacceptable behavior.</p> <p>The Technical Steering Committee (\"TSC\") of the Janssen Project has the right and responsibility  to remove, edit, or reject comments, commits, code, wiki edits, issues, and other contributions that are not aligned to this Code of Conduct, or to ban temporarily or permanently any participant for other behaviors that they deem inappropriate, threatening, offensive, or harmful.</p> <p>All participants have determined that The Linux Foundation is the most optimal organization to shepherd the development of this project. Participants acknowledge and agree to The Linux Foundation's exclusive right to use \"Janssen Project\" and any other names and trademarks associated with the open source project and Janssen Project and to authorize others\u2019 use of the marks, establish guidelines for such use, and to delegate these responsibilities. Participants agree not to take any action inconsistent with such rights and to cooperate in any action which The Linux Foundation deems necessary or desirable to prevent confusion or establish or preserve these rights. Participants will not independently adopt, use, or attempt to register any trademarks or trade names that are confusingly similar to these names.</p>"},{"location":"CODE_OF_CONDUCT/#scope","title":"Scope","text":"<p>This Code of Conduct applies both within project spaces and in public spaces when an individual is representing the project or its community. Examples of representing a project or community include using an official project e-mail address, posting via an official social media account, or acting as an appointed representative at an online or offline event. Representation of a project may be further defined and clarified by project maintainers.</p>"},{"location":"CODE_OF_CONDUCT/#enforcement","title":"Enforcement","text":"<p>Instances of abusive, harassing, or otherwise unacceptable behavior may be reported by contacting the Executive Director, or, if the complaint involves the Executive Director, a member of the steering committee. All complaints will be reviewed and investigated and will result in a response that is deemed necessary and appropriate to the circumstances. The project team is obligated to maintain confidentiality with regard to the reporter of an incident. Further details of  specific enforcement policies may be posted separately. Participants who do not follow or enforce the Code of Conduct in good faith may face temporary or permanent repercussions as determined by the steering committee.</p>"},{"location":"CODE_OF_CONDUCT/#attribution","title":"Attribution","text":"<p>This Code of Conduct is adapted from the Contributor Covenant, version 1.4, available at https://www.contributor-covenant.org/version/1/4/code-of-conduct.html. For answers to common questions about this code of conduct, see https://www.contributor-covenant.org/faq</p>"},{"location":"CONTRIBUTING/","title":"Contributing to Janssen Project","text":"<p>Purpose of this guide is to provide necessary information and resources to community in order to make successful contribution to the Janssen Project.</p> <p>There are many ways you can contribute. Of course you can contribute code. But we also need people to write documentation and guides, to help us with testing, to answer questions on the forums and chat, to review PR's, to help us with devops and CI/CD, to provide feedback on usability, and to promote the project through outreach. Also, by sharing metrics with us, we can gain valuable insights into how the software performs in the wild.</p>"},{"location":"CONTRIBUTING/#join-the-community","title":"Join the Community","text":"<ul> <li>Repo: Watch and Star Janssen repository on GitHub</li> <li>Discussions: Join interesting discussions at GitHub Discussions</li> <li>Chat: We have an active community chat on Zulip. You can register for free their with your GitHub identity.</li> <li>Tweet: Janssen is on Twitter too. Follow us there to stay up to date on release announcements and news around Janssen.</li> </ul>"},{"location":"CONTRIBUTING/#first-time-contributors","title":"First Time Contributors","text":"<p>In case you are first-time contributor, then you can start with our good first issues list These are issues where you can easily contribute and community members will guide and support your contribution as always.</p> <p>If you need Janssen installation to test out your fix, here are the steps.</p>"},{"location":"CONTRIBUTING/#contribution-guidelines","title":"Contribution Guidelines","text":"<p>We are really glad you are reading this, because we need volunteer developers to help this project come to fruition.</p> <ul> <li>Code of Conduct</li> <li>Issues</li> <li>Triaging</li> <li>Coding Conventions</li> </ul>"},{"location":"CONTRIBUTING/#code-of-conduct","title":"Code of Conduct","text":"<p>Janssen project has a Code of Conduct to which all contributors must adhere, please read it before interacting with the repository or the community in any way.</p>"},{"location":"CONTRIBUTING/#about-issues","title":"About Issues","text":"<p>There are four kinds of issues you can open:</p> <ul> <li>Bug report: you believe you found a problem in a project and you want to discuss and get it fixed,   creating an issue with the bug report template is the best way to do so.</li> <li>Feature Request: any kind of new feature need to be discussed in this kind of issue, do you want a new rule or a new feature? This is the kind of issue you want to open. Be very good at explaining your intent, it's always important that others can understand what you mean in order to discuss, be open and collaborative in letting others help you getting this done!</li> <li> <p>Security Vulnerability: If you identify a security problem, please report it immediately, providing details about the nature, and if applicable, how to reproduce it. If you want to report an issue privately, you can email security@gluu.org.</p> </li> <li> <p>Failing tests: you noticed a flaky test or a problem with a build? This is the kind of issue to triage that!</p> </li> </ul> <p>The best way to get involved in the project is through issues, you can help in many ways:</p> <ul> <li>Issues triaging: participating in the discussion and adding details to open issues is always a good thing,   sometimes issues need to be verified, you could be the one writing a test case to fix a bug!</li> <li>Fix an issue: you can help in getting issue fixed in many ways. More often by opening a pull request. In case you are first-time contributor, then you can start with our good first issues list These are issues where you can easily contribute and community members will guide and support your contribution as always.</li> </ul>"},{"location":"CONTRIBUTING/#triaging","title":"Triaging","text":"<p>Triage is a process of evaluating issues and PRs in order to determine their characteristics and take quick actions if possible.</p> <p>When you triage an issue, you:</p> <ul> <li> <p>assess whether it has merit or not</p> </li> <li> <p>quickly close it by correctly answering a question</p> </li> <li> <p>point the reporter to a resource or documentation answering the issue</p> </li> <li> <p>tag it via labels, projects, or milestones</p> </li> <li> <p>take ownership submitting a PR for it, in case you want \ud83d\ude07</p> </li> </ul> <p>Here is how we continously triage new issues and PRs so that contributors can contribute faster and better.</p>"},{"location":"CONTRIBUTING/#code-conventions-and-guidelines","title":"Code Conventions and Guidelines","text":""},{"location":"CONTRIBUTING/#commits","title":"Commits","text":"<p>Janssen Project mandates all commits to follow guidelines as below.</p> <ul> <li>Commit messages</li> </ul> <p>As commit convention, we adopt Conventional Commits v1.0.0, we have an history   of commits that do not adopt the convention but any new commit must follow it to be eligible for merge.</p> <ul> <li> <p>Add GPG signature to your commit</p> <p>To ensure that contribution is coming for a trusted source, all commits should be signed using GPG key and verified by GitHub. If you have GPG key setup already then just use <code>-S</code> switch with your commit to sign it. If you need to setup your GPG key and verification, then you can find detailed instructions in GitHub's commit signature verification guide</p> </li> <li> <p>Add DCO sign-off</p> <p>The Developer Certificate of Origin (DCO) is a lightweight way for contributors to certify that they wrote or otherwise have the right to submit the code they are contributing to the project.</p> <p>Contributors to the Janssen project sign-off that they adhere to these requirements by adding a <code>Signed-off-by</code> line to commit messages.</p> <pre><code>This is a commit message\n\nSigned-off-by: Foo Bar &lt;foobar@spam.org&gt;\n</code></pre> <p>Git even has a <code>-s</code> command line option to append this automatically to your commit message:</p> <pre><code>$ git commit -s -m 'This is my commit message'\n</code></pre> <p>In all, if you have your GPG verification setup, your commit command should look like</p> <pre><code>git commit -S -s -m 'message that follows conventional commit style'\n</code></pre> </li> </ul>"},{"location":"CONTRIBUTING/#branches","title":"Branches","text":"<p>Branch name should have component name as prefix, eg <code>jans-core-mybranch</code></p>"},{"location":"CONTRIBUTING/#prs","title":"PRs","text":"<ul> <li>PR titles should also follow Conventional Commits v1.0.0. This will help in keeping merge commit messages inline with commit message standards</li> <li>Squash commits into small number of cohesive commits before raising a PR</li> <li>PR should be rebased on main branch so that there are minimal or no conflicts at the time of merge</li> <li>PR should only have changes related to target feature or issue. Create a separate PR for formatting or other quick bug fixes</li> <li>PR should include relevant documentation changes</li> <li>PR should include unit and integration tests</li> </ul>"},{"location":"CONTRIBUTING/#issues","title":"Issues","text":"<ul> <li>Issue titles should follow Conventional Commits v1.0.0</li> </ul>"},{"location":"CONTRIBUTING/#backport-changes-to-a-different-version","title":"Backport changes to a different version","text":"<p>Backport changes are now supported through a workflow through labels prefixed with <code>backport/</code>. For-example to backport changes in a certain PR to version <code>v1.0.0</code> a label to that PR matching the version must be added i.e <code>backport/v1.0.0</code>. The flow consists of creating a new branch, cherry-picking the changes of the original PR and creating a new PR to merge them.</p>"},{"location":"CONTRIBUTING/#license-header","title":"License Header","text":"<p>The Janssen Project uses Apache-2.0 license. Any existing or new code file has to start with the license header as shown below:</p> <pre><code>/*\n * This software is available under the Apache-2.0 license. \n * See https://www.apache.org/licenses/LICENSE-2.0.txt for full text.\n *\n * Copyright (c) 2025, Gluu, Inc. \n */\n</code></pre> <p>If the developers sign a CLA(Contributor License Agreement) they can retain the copyright. Once the CLA has been signed, contributions can be accepted from the contributor with the License header as below. Make sure to replace <code>[github-username]</code> with contributor's GitHub username:</p> <pre><code>/*\n * This software is available under the Apache-2.0 license. \n * See https://www.apache.org/licenses/LICENSE-2.0.txt for full text.\n *\n * Copyright (c) 2025, [github-username]. \n */\n</code></pre> <p>Signing the CLA</p> <p>The current version of CLA can be found here. This is just for your reference. This same CLA will be signed digitally by following the steps below:</p> <ol> <li>The contributor sends an e-mail (<code>legal@jans.io</code>) expressing willingness to contribute and sign the CLA. In the email, mention your GitHub account username from which the contributions will be made. If contributions will be made on behalf of an organization, then along with the GitHub username, mention the job title and organization's name in the email.</li> <li>Contributor receives an email with CLA and instructions on how to sign digitally. Follow the instructions and complete the signing process.</li> </ol>"},{"location":"CONTRIBUTING/#project-maturity-stages","title":"Project Maturity Stages","text":"<p>Graduated</p> <ul> <li>Projects that are mature, production-ready, and widely adopted, with a strong and diverse contributor base. These have met all CNCF graduation criteria, including security, governance, and community sustainability.</li> </ul> <p>Incubating</p> <ul> <li>Projects that show growth and use in production environments, with active maintainers and contributors. They meet certain CNCF standards but are still maturing toward full graduation.</li> </ul> <p>Experimental</p> <ul> <li>Early-stage or experimental projects that are under active development but not yet proven in production. They are accepted for innovation and potential community interest.</li> </ul> <p>Demo</p> <ul> <li>Projects focused on tooling. These projects might be of a transient nature, not committed by Janssen Project roadmap.</li> </ul> <p>Sunsetting</p> <ul> <li>Projects that are in the process of being retired. These components are no longer under active development.</li> </ul>"},{"location":"CONTRIBUTING/#contributing-to-the-documentation","title":"Contributing to the documentation","text":"<p>Great documentation is a reflection of software's maturity and the great community that stands behind it. Contributing to the Janssen Project documentation is the easiest way to learn about the Janssen Project and to get involved in the community process.</p> <p>In order to ensure consistency of style, language, format, and terminology across all documents, please follow the guidelines below:</p>"},{"location":"CONTRIBUTING/#glossary-of-terms","title":"Glossary of terms","text":"<p>This glossary helps to keep terms and their meanings consistent across documentation.</p> <ul> <li> <p><code>Janssen Project</code> or <code>Jans</code>:</p> <p>Refers to the official project name under Linux Foundation that seeks to build the world's fastest and most comprehensive cloud-native identity and access management software platform</p> </li> <li> <p><code>Janssen Server</code>:</p> <p>Refers to a set of software components developed under the Janssen Project. Components of the Janssen Server include client and server implementations of the OAuth, OpenID Connect, SCIM and FIDO standards. The term <code>Janssen Server</code> is used to refer to these components as a group.</p> </li> <li> <p><code>jans-auth-server</code>:</p> <p>Refers to a module within the Janssen Server named <code>jans-auth-server</code>. This is one of the significant modules of the Janssen Server that has an implementation for OAuth and OpenId Connect.</p> </li> <li> <p>Janssen Server module names:</p> <p>For correct naming of other modules of the Janssen Server, please refer to README</p> </li> </ul>"},{"location":"CONTRIBUTING/#documentation-style-guide","title":"Documentation Style Guide","text":"<p>Janssen Project documentation uses Markdown. Guidelines below are intended to bring consistency in writing and formatting documents.</p> <p>Testing</p> <p>Janssen Project documentation site is published using MkDocs. Markdown parsers used by GitHub and the one used by MkDocs may have slight variations in how they generate HTML. So, for a small number of cases, document may look different between GitHub and Janssen Project documentation site. Hence it is critical to test documentation changes locally before pushing to repository. This will ensure that final HTML rendering of documents by MkDocs is as desired.</p>"},{"location":"CONTRIBUTING/#document-title","title":"Document Title","text":"<p>The document title summarises what the document aims to achieve and at the same time, it plays a critical role in making the document easy to find via search. Below are a few guidelines to write good titles for documents.</p> <ul> <li> <p>Every document must start with a title. Meaning, <code>#&lt;space&gt;&lt;title text&gt;</code></p> </li> <li> <p>Title should summarise what the document is trying to achieve. For examples: <code>Integrating with the Apache mod_auth_openidc module</code>, <code>Integrating DUO's Universal Prompt as an authentication method</code>, <code>Install using Ubuntu Linux Package</code></p> </li> <li> <p>Title should include its context. For example, the document under <code>Installation</code>&gt;<code>VM Installation</code>&gt;<code>Ubuntu</code> should not be titled as just <code>Ubuntu</code> but it should have a more detailed title similar to  <code>Install using Ubuntu Linux Package</code>. When required, to keep the title from becoming too long, assume that <code>Janssen Server</code> is already understood as context.</p> </li> <li> <p>Titles should be written using title case</p> </li> </ul>"},{"location":"CONTRIBUTING/#document-tags","title":"Document Tags","text":"<p>Janssen Project documentation uses tags to make the search more accurate and add context to search results. Following are guidelines and examples to follow while adding tags to a document.</p> <ul> <li>Maximum 6 tags</li> <li>First three should establish the context of the section hierarchy under which the document belongs. See the example below.</li> <li>Remaining tags can be based on the content of the document.</li> <li>Each tag should be a single word (no spaces, hyphens or commas, etc)</li> <li>All tags should be in lowercase</li> </ul> <p>Example:</p> <p>Let's look at how to add tags to a document that is located on documentation site at path <code>Administration -&gt; Installation -&gt; VM installation</code>. Also, assume that the document describes the steps to install Janssen Project on the Ubuntu platform. Tags below would be recommended:</p> <pre><code>---\ntags:\n - administration\n - installation\n - vm\n - ubuntu\n---\n</code></pre>"},{"location":"CONTRIBUTING/#referencing-janssen-project-release-in-documents","title":"Referencing Janssen Project Release in Documents","text":"<p>We often need to reference release numbers in the documentation. For example, Ubuntu package installation guide. In this guide, the following command is documented:</p> <pre><code>wget https://github.com/JanssenProject/jans/releases/download/v1.1.4/jans_1.1.4.ubuntu20.04_amd64.deb -P /tmp\n</code></pre> <p>Above command contains references to the release number at two places. <code>v1.1.4</code> in the URL and <code>1.1.4</code> as part of the file name. There are many such places throughout the documentation when release numbers need to be mentioned. Whenever we make a new release, these numbers need to change as they point to the latest release number. This becomes a manual task.</p> <p>To avoid this manual, error-prone approach the Janssen Project uses a release marker, <code>0.0.0-nightly</code> instead of writing actual release numbers in the <code>head</code>(latest) documentation branch. So, when there is a need to mention the release number, instead of writing the actual release number, use the release marker. Let's see how to document the above command (at the <code>head</code> version) so that it stays up-to-date release after release.</p> <pre><code>wget https://github.com/JanssenProject/jans/releases/download/nightly/jans_0.0.0-nightly.ubuntu20.04_amd64.deb -P /tmp\n</code></pre> <p>Warning</p> <ul> <li> <p><code>head</code> version of documentation may contain the release marker at various places. URLs, commands etc. So, URLs, and commands might not work as it is. Users will have to manually replace the marker or use the most recent stable release documentation.</p> </li> <li> <p>Release marker should be used only when contributing to the latest documentation. Not when updating documentation for previous releases.</p> </li> </ul>"},{"location":"CONTRIBUTING/#general-text","title":"General Text","text":"<ul> <li>Allow long lines to wrap, rather than manually breaking them. For example, the Introduction paragraph is a single line</li> <li>Keep explanations short and clear</li> <li>Use complete sentences when possible</li> <li>To make text italicised, put an <code>_</code> on each side, like this: <code>_word_</code>.</li> <li>To bold text, put a double <code>*</code> on each end, like this: <code>**word**</code></li> <li>Leave a blank line between paragraphs. Count a header as a paragraph for this purpose</li> <li>Avoid passive voice as much as possible. It's clearer to say that a subject does something than to say a result was done</li> <li>Avoid using <code>you</code> in statements as much as possible. For example, instead of saying <code>You can navigate to...</code> simply say <code>Navigate to...</code></li> </ul>"},{"location":"CONTRIBUTING/#page-setup","title":"Page Setup","text":"<ul> <li>Start your page with a title on the first line</li> <li>Follow with a concise overview of the document / product's purpose</li> <li>Organize the information in the document from least technical to most technical if possible. Start conceptual, then get detailed</li> </ul>"},{"location":"CONTRIBUTING/#lists","title":"Lists","text":"<ul> <li>Leave a blank line between text and first item in the list</li> <li>Only use a numbered list if the order of the list matters</li> <li>A line of a list should not end with a period. If it's multiple sentences, like this one, drop the last period</li> <li>Start each item in the list with a capital letter</li> <li>End each item in the list with at least three spaces. This makes sure the line breaks properly</li> <li>To make a bulleted list, start each line with <code>-</code></li> <li> <p>To make a numbered list, start each line with <code>1.</code> For example:</p> <pre><code>1. This is the first item\n1. This is the second item\n1. This is the third item\n</code></pre> <p>It will look like this:</p> <pre><code>1. This is the first item\n2. This is the second item\n3. This is the third item\n</code></pre> </li> <li> <p>To include additional lines in a list item, start the sub-line with four spaces. For example:</p> <pre><code>1. This is the first item in a list   \n   There are four spaces to start this line   \n   Another four spaces here   \n   This keeps all text inside the numbered list item, before starting...   \n\n1. The following list item   \n</code></pre> </li> </ul> <p>It will look like this:</p> <ol> <li> <p>This is the first item in a list     There are four spaces to start this line     Another four spaces here     This keeps all text inside the list, before starting...</p> </li> <li> <p>The following list item</p> </li> </ol> <p>Other formatting considerations</p> <ul> <li> <p>Admonitions cannot be nested inside a list. They must be aligned all the way left. Inserting them within a list will break the list sequence (starting back over from 1).</p> </li> <li> <p>Nesting a fenced block of code in a numbered list is more challenging, as the list and code block syntaxes clash. To nest a code block into a list, insert four spaces to the left of all lines of the formatting. For example:</p> </li> </ul> <pre><code>1. This is the first item  \n    ```\n    This is code  \n    This is also code.\n    ```\n1. This is the second item  \n</code></pre> <p>It will look like this:</p> <ol> <li> <p>This is the first item  </p> <pre><code>This is code  \nThis is also code.\n</code></pre> </li> <li> <p>This is the second item  </p> </li> </ol>"},{"location":"CONTRIBUTING/#headings","title":"Headings","text":"<ul> <li>Headings should be in title format. All important words should be capitalized</li> <li>The main title of the page should start with a single <code>#</code>, then each level of subheading should add one. For example, the first subheading should start with <code>##</code>, a subheading of that should use <code>###</code>, and so on</li> </ul>"},{"location":"CONTRIBUTING/#code-formatting","title":"Code Formatting","text":"<ul> <li>To format text as code within a line of normal text, surround the code with a single backtick (`).</li> <li> <p>If the code is to be on its own line, it should be a fenced code block. To make a fenced code block, make a line before and after the code with three backticks:</p> <pre><code>    ```\n    This is code\n    ```\n</code></pre> </li> <li> <p>We use the SuperFences plugin to enhance this functionality.</p> </li> </ul>"},{"location":"CONTRIBUTING/#examples-navigation","title":"Examples &amp; Navigation","text":"<ul> <li>When possible, provide an example in the form of code output or a screenshot</li> <li> <p>To instruct a user to click a button, or navigate to a certain page or through a menu, use the following style:</p> <pre><code>Navigate to `Configuration` &gt; `Authentication` and click the `Passport` tab\n</code></pre> </li> </ul> <p>It will look like this:</p> <p>Navigate to <code>Configuration</code> &gt; <code>Authentication</code> and click the <code>Passport</code> tab</p>"},{"location":"CONTRIBUTING/#linking","title":"Linking","text":"<p>We recommend using relative linking syntax when linking to other artifacts in repository. Linking to a page within the same repo use this format: <code>[text for the link](../where/the/link/goes.md)</code></p> <ul> <li>You must link to the <code>.md</code> file on GitHub for it to work properly</li> <li>As an example, to make text <code>this link</code> link to a Markdown document named <code>example.md</code> in the same directory, you'd type it as <code>[this link](./example.md)</code></li> </ul> <p>Service Commands</p> <p>The Janssen Server supports many different Operating Systems (e.g. Ubuntu, SUSE etc.). Service commands can vary. Rather than \"hard coding\" service commands into documentation, please instead reference the dedicated documentation page for Service Commands.</p> <p>In documenting a process that involves a service restart, the Service Command documentation is linked:</p> <pre><code>## Add the attribute to MySQL\n\n - Add custom attribute \n - [Restart](https://jans.io/docs/vm-ops/restarting-services/) the `jans-auth.service` service.\n</code></pre> <p>The word <code>Restart</code> is simply linked to the dedicated doc for Service Commands.</p>"},{"location":"CONTRIBUTING/#tables","title":"Tables","text":"<ul> <li>Try to make tables visually readable by spacing to make distinct columns</li> <li>The header for each column must be separated by at least three dashes</li> <li>Use outer pipes for consistency</li> <li>If an entry is too long to fit in the neat boxes, that's fine, just try to keep it legible</li> <li>An example table follows:</li> </ul> <p><code>text  |This    |Is     |A     |Table    |  |--------|-------|------|---------|  |1       |2      |3     |4        |  |Word    |Code   |Text  |Table    |</code></p> <p>It looks like this:</p> This Is A Table 1 2 3 4 Word Code Text Table"},{"location":"CONTRIBUTING/#help-on-technical-writing","title":"Help On Technical Writing","text":"<p>It is essential for everyone in the community to actively participate in the documentation. At the same time, not everyone is formally trained or experienced in writing technical documents. To help everyone understand the basics of good technical writing, we have listed a few resources below. Going through these resources will not take a lot of time and will help in writing better technical documents.</p> <ul> <li>Introduction to Technical Writing (part-1)</li> <li>Introduction to Technical Writing (part-2)</li> </ul>"},{"location":"CONTRIBUTING/#contribution-workflow","title":"Contribution Workflow","text":""},{"location":"CONTRIBUTING/#find-something-to-work-on","title":"Find something to work on","text":"<p>Best place to find something to work on is to look at currently open issues. If you are a first time contributor then starting with list of good first issues is best.</p>"},{"location":"CONTRIBUTING/#start-a-discussion","title":"Start a discussion","text":"<p>Start a GitHub Discussion about what you are planning to contribute. Explain the feature or issue that you are planning to contribute and what your proposed solution or implementation approach is. Janssen is a community-driven project and it's helpful to get the community's view about it.</p>"},{"location":"CONTRIBUTING/#create-an-issue","title":"Create an issue","text":"<p>Take your time to write a proper issue including a good summary and description. Outcome of GitHub discussion about your contribution can help you create good content for the issue. As a first step when creating a new issue, an issue template has to be selected. Select appropriate <code>issue template</code> and it'll help you create an issue with right content.</p> <p>Remember that issue may be the first thing a reviewer of your PR will look at to get an idea of what you are proposing. It will also be used by the community in the future to find about what new features and enhancements are included in new releases.</p>"},{"location":"CONTRIBUTING/#implement-the-change","title":"Implement the change","text":"<p>All contributions to Janssen Project should be made via GitHub pull requests (PR).</p> <p>New to PR workflow?? Learn and practice it at first-contributions</p>"},{"location":"CONTRIBUTING/#create-a-fork","title":"Create a Fork","text":"<p>Fork Janssen repository. And create a clone.</p>"},{"location":"CONTRIBUTING/#implement-the-change_1","title":"Implement the Change","text":"<p>Start working on changes as required.</p> <ul> <li>Make sure the code conventions are being followed.</li> <li>Use static code analysis and linting tools to make sure the code is high-quality.</li> <li>Write tests first and then code. Ensure that integration tests that cover your code are appropriately updated and reviewed.</li> <li>Create PR early and push often.</li> <li>Janssen uses GitHub actions to run automated checks on PR changes. Ensure that these checks are passing with every push.</li> <li>Engage PR reviewers at the start so that they can continue to review code as it is developed and in small chunks.</li> <li>For a change that is non-trivial(an enhancement or a new feature), design should be reviewed. This should be done via PR by adding appropriate code owners.</li> </ul>"},{"location":"CONTRIBUTING/#document","title":"Document","text":"<ul> <li> <p>PR should include changes in relevant documentation along with code changes.  PR is checked by bot to have either one of the following :</p> <ul> <li>A commit that follows commit guidelines with <code>docs:</code> message</li> <li>Changes in artifacts under <code>jans/docs</code></li> </ul> </li> <li> <p>If PR does not need any documentation changes, then the developer needs to acknowledge that in one of two ways:</p> <ul> <li>Add an empty commit to the PR (using <code>--allow-empty</code> git flag) with <code>docs:</code> message (i.e <code>docs: no doc changes required</code>)</li> <li>Add footer to the commit message of one of the code commits with <code>docs:</code> message e.g</li> </ul> <pre><code>fix: typo on class name\n\nMore details here.\n\ndocs: no docs modification\n</code></pre> </li> </ul>"},{"location":"CONTRIBUTING/#raise-a-pr","title":"Raise a PR","text":"<ul> <li>Make sure that PR title follows these guidelines</li> <li>Janssen uses GitHub PR template. Template provides helpful instructions to ensure new PRs are complete in details and easy to review. GitHub will populate new PR's description with these instructions. You can edit PR description as per your requirements.</li> <li>When PR is raised, GitHub will automatically assign reviewer to the PR based changed files and CODEOWNERS list.</li> <li>Once PR is raised, ensure that PR passes all the mandatory GitHub actions checks available on GitHub PR page. GitHub will not allow PR to be merged if any of the mandatory check is failing.</li> </ul>"},{"location":"CONTRIBUTING/#follow-through","title":"Follow Through","text":"<p>Once the PR is raised, wait for reviewers to start review. Reviewers will start review at the first opportunity available. If you want to draw attention, give a gentle reminder in PR comments. But please be patient.</p> <p>Follow activities on your PR closely till the time PR is merged. PR reviewer may want to suggest a change or may need to ask a question to get more clarity. Make sure you are actively collaborating. Once Reviewer has completed the review and approved the changes, the PR will be merged.</p> <p>That's it!! Congratulations on successful contribution. \ud83e\udd73 \ud83e\udd1f</p>"},{"location":"cedar-intro/","title":"What is Cedar","text":"<p>Cedar is a policy syntax invented by Amazon and used by their Verified Permission service. Cedar policies enable developers to implement fine-grain access control and externalize policies. To learn more about why the design of Cedar is intuitive, fast and safe, read this article or watch this video</p> <p>Cedar uses the PARC syntax:</p> <ul> <li>Principal</li> <li>Action</li> <li>Resource</li> <li>Context</li> </ul> <p>For example, you may have a policy that says Admins can write to the /config folder. The Admin role is the Principal, write is the Action, and the /config folder is the Resource. The Context is used to specify information about the environment, like the time of day or network address.</p> <p></p> <p>Fine grain access control makes sense in both the frontend and backend. In the frontend, mastery of authz can help developers build better UX. For example, why display form fields a user is not authorized to see? In the backend, fine grain policies are necessary for a zero trust architecture.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"agama/execution-rules/","title":"Flows execution rules","text":"<p>This document regards flow execution details. Engines implementing the Agama framework must account these aspects fully.</p> <p>Important</p> <p>The concept of \"top-level\" flow is used in several places throughout this page. It refers to a flow which has been directly launched from the user browser and hence has no parents (no callers).</p>","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#flows-lifecycle","title":"Flows lifecycle","text":"<p>From a programming perspective, a flow is a lot like a function or subroutine in a regular program. Once a flow is triggered, it must be executed from top to bottom until a <code>Finish</code> statement is encountered. There are no special requirements on flow initialization or flow structure either.</p> <p>In some cases, the <code>Finish</code> instruction is not reached because the flow:</p> <ul> <li>has crashed</li> <li>has been cancelled</li> <li>has timed out</li> </ul> <p>More on these conditions below. Otherwise, the flow is said to have finished and depending on the actual arguments passed to <code>Finish</code>, it can be said the flow finished successfully  or the flow failed.</p>","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#successful-flows","title":"Successful flows","text":"<p>When a flow finishes successfully, control returns to the caller (parent flow) and execution continues. In the case of a top-level flow, it is up to the concrete engine what to do next. Normally, the arguments passed to the <code>Finish</code> directive will drive the specific behavior, which could for instance authenticate a person.</p>","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#failed-flows","title":"Failed flows","text":"<p>When a flow fails, control returns to the caller (parent flow) and execution continues. In the case of a top-level flow, it is up to the concrete engine what to do next. Displaying an error page would be generally appropriate. The arguments passed to the <code>Finish</code> directive could be of use here.</p>","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#crashed-flows","title":"Crashed flows","text":"<p>A flow is said to have crashed if any of the below occur:</p> <ul> <li>Invalid code (syntactically wrong) was tried to be executed</li> <li>The last instruction was reached and <code>Finish</code> was not encountered</li> <li>An attempt to access a property or index of a <code>null</code> variable was made</li> <li>The invocation of a foreign routine, i.e. through <code>Call</code>, raised an error condition, and the error was not caught</li> <li>Any unexpected runtime error was raised </li> </ul> <p>When a flow crashes, the caller flow (if any) is said to have crashed too if it did not catch the given error. This rule applies recursively until the top-level flow is reached.</p> <p>When a top-level flow crashes, engines must:</p> <ul> <li>Show an error with a concise descriptive error description</li> <li>Append a fuller error message to whatever logging system is in place</li> <li>Terminate the flow execution to allow the user start again the flow later in a safe manner </li> </ul>","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#flows-timeout","title":"Flows timeout","text":"<p>The <code>Timeout</code> directive specifies a maximum allowable execution time for a top-level flow. When a flow exceeds this execution time, engines should display an error page accordingly.</p>","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#cancelled-flows","title":"Cancelled flows","text":"<p>Cancellation allows a flow to early interrupt the execution of a given subflow thus enabling the implementation of alternative routing without the need of re-writing subflows. It can only take place upon the execution of a given <code>RRF</code> instruction part of a subflow that has been <code>Trigger</code>ed.</p> <p>This feature is better understood via examples - note the link provided is specific to the Janssen Server engine only. Other engines may implement cancellation in a different way, the only requirement is to preserve the convention that the returned value of a cancelled flow must be of the form: <code>{ aborted: true, data: ..., url: ... }</code>.</p>","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#launching-flows","title":"Launching flows","text":"<p>Engines must provide specific mechanisms to launch a given flow in the user's browser and document how to pass input parameters to it and the formats allowed.</p>","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#logging","title":"Logging","text":"<p>Engines must maintain at least one logging destination (file, stream, etc.) to accumulate the messages passed in <code>Log</code> directives. Additionally, it should advertise the logging levels supported, their abbreviations if any, and the default logging level.</p>","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#rfac-and-callback-url","title":"RFAC and Callback URL","text":"<p>Engines must provide and maintain a fixed single URL that \"users\" of <code>RFAC</code> can supply to external systems in order to implement integrations with third-party sites that employ browser redirections. This URL should only be available for a given browser session while <code>RFAC</code> is in execution. Once the callback is visited or the flow times out (whichever occurs first), subsequent requests will respond with an HTTP 404 error.</p> <p>The mechanism used by the engine to make the redirect to the external site is implementation specific.</p>","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#assets-management","title":"Assets management","text":"<p>Engines must have an internal mechanism to store assets following a hierarchical (filesystem-like) structure. Such structure must have a defined \"root\" that in conjunction with a flow <code>Basepath</code> will allow the engine to resolve (locate) the paths to specific flow assets.</p> <p>Engines may support one or more templating technologies and file formats for rendering the UI pages.</p>","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#foreign-calls","title":"Foreign calls","text":"","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#languages-support","title":"Languages support","text":"<p>At least one programming language should be supported by an engine. This feature is critical because Agama DSL was designed to force developers use a distinct, more powerful language when the task at hand cannot be implemented by simple data manipulation or comparison of values.</p>","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#routines-lookup","title":"Routines lookup","text":"<p>Engines should define a clear mechanism to lookup the specific routine to be invoked when using the <code>Call</code> directive.</p> <p>Actually, the syntax of <code>Call</code> fits well into an object-oriented style. The table bellow illustrates this fact:</p> Example Potential semantics <code>Call a B c d</code> On object instance <code>a</code>, invoke method <code>B</code> passing <code>c</code> and <code>d</code> as parameters <code>Call x.y.z#S d</code> Invoke method <code>S</code> belonging to class <code>x.y.z</code> passing <code>d</code> as parameter. This variant maps to a \"static\" method invocation, where <code>S</code> does not require a specific instance to run on <p>In OOP, it is not uncommon to have a method <code>S</code> with several different signatures. The lookup mechanism should account disambiguation techniques, if possible.</p>","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#errors","title":"Errors","text":"<p>In the execution of the call, if an error occurs, the engine should raise an error catchable in Agama code. The structure or data type of this error is an engine-specific detail. Ideally the error should be easily inspected in Agama code so any required further processing is feasible in a flow.</p>","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#types-compatibility","title":"Types compatibility","text":"<p>The arguments conversion/compatibility is also an important topic. Most likely Agama types will not match the (foreign) target language types. This means passing a \"native\" Agama value as parameter in a method <code>Call</code> requires some form of compatibility with the target type in the  routine (method) signature. When compatibility does not make sense, seems too complex, or impossible, invocation should \"crash\" by raising some form of error.</p> <p>The same analysis has to be done in the other direction: from the target language to Agama. This is for the case where the <code>Call</code> returns a value. Such value should be \"manipulable\" in Agama code.</p>","tags":["administration","developer","agama"]},{"location":"agama/execution-rules/#other-considerations","title":"Other considerations","text":"<p>Engine implementers may consider to offer the ability for developers to supply routines without the need of engine restarts. This aims for an agile development experience.</p>","tags":["administration","developer","agama"]},{"location":"agama/gama-format/","title":"The <code>.gama</code> file format","text":"<p>In practice, a web flow will make use of a bunch of artifacts, like UI pages, images, stylesheets, and source code. Actually, to solve a real-world problem several flows are needed to be able to keep flexibility and complexity at acceptable levels. Here is where the concept project emerges.</p> <p>A project can be thought of as a container to hold all flows and related assets aimed at solving a particular problem - including metadata of the project itself. The idea of defining a standard way to specify projects brings several benefits:</p> <ul> <li>Provide a uniform conceptual scheme for community actors to interchange flows </li> <li>Provide Agama engine implementors common ground for the materialization of flows deployment</li> <li>Serve as reference for developers interested in coding tools such as an Agama IDE</li> </ul>","tags":["administration","developer","agama"]},{"location":"agama/gama-format/#anatomy-of-a-project","title":"Anatomy of a project","text":"<p>The below shows the structure of an Agama project:</p> <pre><code>\u251c\u2500\u2500 code/\n\u251c\u2500\u2500 lib/           \n\u251c\u2500\u2500 web/\n\u251c\u2500\u2500 project.json   \n\u251c\u2500\u2500 LICENSE        \n\u2514\u2500\u2500 README.md\n</code></pre> <ul> <li><code>code</code> directory holds all flows part of the project. Every flow - implemented in Agama language - has to reside in a separate file with extension <code>flow</code> and with file name matching the qualified name of the flow in question. This directory can have nested folders if desired  </li> <li><code>lib</code> may contain source code files in languages other than Agama and binary libraries required by the project, if any. Every engine can make use of the contents of this folder as needed  </li> <li><code>web</code> is expected to hold all UI templates plus required web assets (stylesheets, images, localization strings, etc.) that all flows in this project may use</li> <li><code>project.json</code> file contains metadata about this project. More on this later</li> <li><code>README.md</code> file may contain extra documentation in markdown format</li> <li><code>LICENSE</code> file may contain legal-related information</li> </ul> <p>Except for <code>code</code> and <code>web</code> directories, all elements in the file structure above are optional. Note that files in <code>web</code> must follow a directory structure that is consistent with respect to <code>Basepath</code> and <code>RRF</code> directives found in the included flows.</p>","tags":["administration","developer","agama"]},{"location":"agama/gama-format/#metadata","title":"Metadata","text":"<p><code>project.json</code> file is expected to contain metadata about the contents of the project in JSON format.</p> Field Description data type <code>projectName</code> A unique name that will be associated to this project string <code>version</code> Project's version. It is recommended to use semantic versioning format string <code>author</code> A user handle that identifies the author of the project string <code>license</code> A reference to applicable license terms string <code>description</code> string <code>configs</code> Object containing exemplifying configuration properties for flows that may need them. The keys of this field, if any, are qualified flow names already part of the project json object <code>noDirectLaunch</code> An array holding zero or more qualified flow names. This list is used to prevent certain flows to be launched directly from a web browser. It's a security measure to avoid end-users triggering flows at will array <p>All fields are optional and more can be added if desired.</p> <p>Below is an example of a <code>project.json</code> file:</p> <pre><code>{\n  \"projectName\": \"biometric-auth\",\n  \"version\": \"2.0.3\",\n  \"author\": \"avgJoe123\",\n  \"license\": \"apache-2.0\",\n  \"description\": \"Allows users to authenticate via fingerpint and/or iris recognition\",\n  \"configs\": {\n    \"com.acme.bio.IrisScan\": {\n        \"prop1\": \"secret\",\n        \"prop2\": { \"subprop\": [1, 2, 3] }\n    }\n  },\n  \"noDirectLaunch\": [ \"com.acme.bio.TraitExtractor\" ]\n}\n</code></pre> <p>Important</p> <p>Use the <code>configs</code> section wisely: <code>.gama</code> files must not contain real configuration properties because these files may be freely distributed; in practice, configurations hold sensitive data that should not be exposed</p>","tags":["administration","developer","agama"]},{"location":"agama/gama-format/#sample-project","title":"Sample project","text":"<p>As an example assume you want to deliver these two flows:</p> <pre><code>Flow test\n    Basepath \"hello\"\n\nin = { name: \"John\" }\nRRF \"templates/index.htm\" in\n\nLog \"Done!\"\nFinish \"john_doe\"\n</code></pre> <pre><code>Flow com.foods.sweet\n    Basepath \"recipes/desserts\"\n\n...\n\nchoice = RRF \"selection.htm\"\nlist = Call com.foods.RecipeUtils#retrieveIngredients choice.meal\n...\n</code></pre> <p>Here is how the project folder might look like:</p> <pre><code>\u251c\u2500\u2500 code/\n\u2502   \u2514\u2500\u2500 test.flow\n\u2502   \u2514\u2500\u2500 com.foods.sweet.flow\n\u251c\u2500\u2500 web/\n\u2502   \u251c\u2500\u2500 hello/\n|   |   \u2514\u2500\u2500 templates/\n\u2502   |       \u2514\u2500\u2500 index.htm\n\u2502   |           \u2514\u2500\u2500 js/\n\u2502   |               \u2514\u2500\u2500 font-awesome.js\n|   \u2514\u2500\u2500 recipes/\n\u2502       \u2514\u2500\u2500 desserts/\n\u2502           \u2514\u2500\u2500 selection.htm\n\u2502           \u2514\u2500\u2500 logo.png\n\u251c\u2500\u2500 lib/\n\u2502   \u2514\u2500\u2500 com/\n\u2502       \u2514\u2500\u2500 foods/\n\u2502           \u2514\u2500\u2500 RecipeUtils.java\n\u2514\u2500\u2500 project.json\n</code></pre>","tags":["administration","developer","agama"]},{"location":"agama/gama-format/#gama-file","title":"<code>.gama</code> file","text":"<p>Dealing with a folder this way can be awkward for sharing and other tasks. Instead, if the project contents are compressed using the ZIP file format, we have what is known as <code>.gama</code> file. Thus, a <code>.gama</code> file is a project archive that can be shared and deployed to an Agama engine.</p>","tags":["administration","developer","agama"]},{"location":"agama/gama-format/#project-deployment","title":"Project deployment","text":"<p>The actual \"deployment\" of an Agama project is an engine-specific detail. Engines must offer mechanisms for administrators and developers to \"install\" <code>.gama</code> files.</p>","tags":["administration","developer","agama"]},{"location":"agama/introduction/","title":"Agama overview","text":"<p>Agama is a framework that consists of:</p> <ul> <li>A DSL (domain-specific language) purposedly designed for writing web flows</li> <li>A set of rules that drive the behavior of such flows when they are executed</li> <li>The specification of a file format - known as <code>.gama</code> - useful for sharing Agama flows. Flows have the <code>.flow</code> file extension.  </li> </ul> <p>Here, a web flow is understood as a process composed by one or more stages, where at each stage an actor - normally a person - provides some kind of data or response by using a web browser or similar client. Throughout the process only a single actor is involved.</p>","tags":["administration","developer","agama"]},{"location":"agama/introduction/#dsl","title":"DSL","text":"<p>About the Agama language is worth to mention that:</p> <ul> <li>It helps depicting the structure of web flows in a natural way</li> <li>It is closer to human language than general-purpose programming languages</li> <li>It has a clean, concise, non-distracting syntax</li> <li>It has limited computational power by design, forcing computations to occur in a more formal, general-purpose language like Java, C++, etc.</li> </ul> <p>Intrinsic properties of the language include:</p> <ul> <li>It follows the imperative paradigm mainly and assumes a traditional sequential execution. It only makes use of a few declarative elements</li> <li>Flows can be treated as functions (reusable routines with well-defined inputs)</li> <li>It provides dedicated contructs for common patterns in web flows like:<ul> <li>\"show a page\" and \"retrieve the data user provided in that page\"</li> <li>\"redirect a user to an external site\" and later \"retrieve the data provided at a callback URL\"</li> </ul> </li> <li>It supports typical language elements like assignments, conditionals, loops, etc.</li> </ul> <p>Find the complete Agama DSL reference here.</p>","tags":["administration","developer","agama"]},{"location":"agama/introduction/#behavioral-rules-of-execution","title":"Behavioral rules of execution","text":"<p>These are aspects that concrete implementations of the framework must adhere to. Rules may include for instance:</p> <ul> <li>How and when a flow terminates </li> <li>If and how errors are handled in a flow</li> <li>How flows' assets, i.e. UI pages, images, stylesheets, etc., are organized or laid out</li> <li>How delegation of business logic execution occur in a language other than Agama</li> </ul> <p>A \"concrete implementation\" as referred above is known as an engine: a software component capable of running flows written in Agama DSL.</p> <p>More information on execution rules can be found here.</p>","tags":["administration","developer","agama"]},{"location":"agama/introduction/#gama-file-format","title":"<code>.gama</code> file format","text":"<p>Check this page for more information.</p>","tags":["administration","developer","agama"]},{"location":"agama/language-reference/","title":"Agama DSL reference","text":"<p>This document surveys the different constructs of the Agama domain-specific language.</p>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#code-comments","title":"Code comments","text":"<p>There is support for single line comments only (no block comments). Use <code>//</code> to start a comment. Comments can start anywhere in a line.</p>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#data-types","title":"Data types","text":"<p>In practice, values would fit into any of: string, boolean, number, list or map. Since routines implemented in other languages can be invoked (more on this later), returned values might not match up exactly with these categories, however this is not too relevant because there is no strict type enforcement in Agama.</p>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#literals","title":"Literals","text":"","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#strings","title":"Strings","text":"<ul> <li> <p>They are surrounded by double quotes. Examples: <code>\"Agama\"</code>, <code>\"blah\"</code>, <code>\"\"</code> (empty string) </p> </li> <li> <p>Backslash can be used to escape chars, like <code>\"Hello\\nGluu\"</code> (line feed), <code>\"Hi\\u0040\"</code> (unicode character) </p> </li> <li> <p>Including double quotes in strings requires unicode escaping, like <code>\"\\u0022\"</code>. Using <code>\"\\\"\"</code> won't work  </p> </li> </ul>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#booleans","title":"Booleans","text":"<ul> <li>Only <code>true</code> or <code>false</code> allowed (notice they are lowercased) </li> </ul>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#numbers","title":"Numbers","text":"<ul> <li> <p>They are expressed in base 10 only </p> </li> <li> <p>Can be signed or unsigned, with or without decimal: <code>0</code>, <code>-1</code>, <code>2.0</code>, <code>2.3</code>, <code>-3.000001</code>, etc. </p> </li> <li> <p>No exponential notation allowed (e.g. <code>1E-05</code>) </p> </li> <li> <p>The following are not valid: <code>.1</code>, <code>-.1</code>, <code>+1</code>. These are their OK equivalents: <code>0.1</code>, <code>-0.1</code>, <code>1</code> </p> </li> </ul>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#null","title":"Null","text":"<p>The \u201cspecial\u201d value <code>null</code> can be used (responsibly) to represent the absence of a value. It is a direct consequence of supporting the integration of other languages in the DSL.</p>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#lists","title":"Lists","text":"<ul> <li> <p>They are finite sequences. Elements are separated by commas </p> </li> <li> <p>Examples: <code>[ 1, 2, 3 ]</code>, <code>[ \"bah!\", \"humbug\" ]</code>, <code>[ ]</code> (empty list) </p> </li> <li> <p>Elements of a list do not have to be of the same type: <code>[ false, [ 0, 1], \"?\" ]</code> is legal but generally discouraged </p> </li> <li> <p>Commas can be surrounded by any combination of spaces and new lines. This is handy when a list takes up some space. This is legal: </p> </li> </ul> <pre><code>[ \"no\", \"such\",  \"thing\"  \n, \"as\", \"a\",\n            \"stupid\",\"question\"]\n</code></pre>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#maps","title":"Maps","text":"<ul> <li> <p>They are in essence associative arrays (a.k.a. dictionaries): unordered collections of key/value pairs </p> </li> <li> <p>Example: <code>{ brand: \"Ford\", color: null, model: 1963, overhaulsIn: [ 1979, 1999 ] }</code>. This map keys are <code>brand</code>, <code>color</code>, <code>model</code>, and <code>overhaulsIn</code> </p> </li> <li> <p>In literal notation, keys names must follow the pattern <code>[a-zA-Z]( _ | [a-zA-Z] | [0-9] )*</code> so these are all valid key names: <code>a</code>, <code>Agama</code>, <code>b_a</code>, <code>a0_0</code>; on the contrary, <code>_a</code>, <code>9</code>, <code>-a</code>, and <code>\"aha\"</code> are invalid key names </p> </li> <li> <p>As with lists, commas can be surrounded by any combination of spaces and new lines</p> </li> </ul>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#variables","title":"Variables","text":"<ul> <li> <p>Variable names follow the pattern: <code>[a-zA-Z]( _ | [a-zA-Z] | [0-9] )*</code> </p> </li> <li> <p>camelCase naming is recommended </p> </li> <li> <p>Variables are not declared, just used freely. Variables are always global in a given flow  </p> </li> <li> <p>They can be assigned a value using the equal sign. Example: <code>colors = [ \"red\", \"blue\" ]</code> </p> </li> <li> <p>They can be assigned several times in the same flow</p> </li> </ul>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#accessing-and-mutating-data-in-variables","title":"Accessing and mutating data in variables","text":"","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#strings_1","title":"Strings","text":"<ul> <li> <p>Suppose <code>x</code> is a string. Individual characters can be accessed by zero-based indexes: <code>x[0]</code>, <code>x[1]</code>, etc. and they are themselves considered strings of size 1 </p> </li> <li> <p><code>x.length</code> returns the string size (number of characters in it). </p> </li> <li> <p>Strings are not modifiable (neither size nor individual characters can be altered) </p> </li> </ul>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#lists_1","title":"Lists","text":"<ul> <li> <p>Suppose <code>x</code> is a list. Elements can be accessed by zero-based indexes: <code>x[0]</code>, <code>x[1]</code>, etc. </p> </li> <li> <p>Elements of a list can be assigned (and re-assigned) using indexes too. Example: <code>x[2] = false</code> </p> </li> <li> <p><code>x.length</code> returns the list size. This value can be updated in order to shrink or grow a list (e.g. <code>x.length = 10</code>). When extending a list beyond its current length, the \u201cgap\u201d created is filled with <code>null</code> values  </p> </li> <li> <p>An attempt to access an index position greater than or equal to the list size returns <code>null</code> (most general-purpose languages would raise a runtime error in this situation) </p> </li> <li> <p>Using expressions for indexing is not allowed, like <code>x[person.age]</code>, <code>x[y[0]]</code> </p> </li> <li> <p>Click here to learn more about access in lists </p> </li> </ul>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#maps_1","title":"Maps","text":"<ul> <li> <p>Suppose <code>x</code> is map. Values can be accessed by using \u201cdot notation\u201d </p> </li> <li> <p>Say <code>x = { brand: \"Ford\", color: null, model: 1963, overhaulsIn: [ 1979, 1999 ] }</code>, then <code>x.model</code> evaluates to <code>1963</code>, and <code>x.overhaulsIn[1]</code> evaluates to <code>1999</code> </p> </li> <li> <p>Setting the color would be like <code>x.color = \"white\"</code> </p> </li> <li> <p>A new key/value pair can be appended too: <code>x.maxSpeed = 90</code> </p> </li> <li> <p>Access of an unknown property evaluates to <code>null</code>: <code>x.owner</code> </p> </li> <li> <p>If a key name does not follow the pattern <code>[a-zA-Z]( _ | [a-zA-Z] | [0-9] )*</code> an alternative notation must be employed to retrieve or modify the associated value. Click here to learn more </p> </li> </ul>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#flow-structure","title":"Flow structure","text":"<p>A flow written in Agama consists of a header and one or more statements following.</p>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#header-basics","title":"Header basics","text":"<p>A header is declarative by nature. It starts with the <code>Flow</code> keyword followed by the qualified name of the flow, e.g. <code>Flow com.acme.FoodSurvey</code>. A qualified name is a sequence of one or more fragments separated by dot (<code>.</code>) where a fragment follows the pattern <code>[a-zA-Z]( _ | [a-zA-Z] | [0-9] )*</code>. By convention, qualified names shall adhere to a reverse Internet domain name notation.</p> <p>In a header, at minimum, a base path literal string must be provided (in an indented block). This sets the location where flow assets will reside relative to the assets root:</p> <pre><code>Flow com.acme.FoodSurvey\n    Basepath \"mydir\"\n</code></pre> <p>Here, assets refer to all elements required to build the end-user experience: UI pages, stylesheets, images, etc. The storage of these elements and location of the \"root\" are specific to the concrete Agama engine implementation used. Generally it will resemble a directory structure in a filesystem.</p> <p>Next, flow timeout may be specified. This is the maximum amount of time the end-user can take to fully complete a flow. For instance:</p> <pre><code>Flow com.acme.FoodSurvey\n    Basepath \"mydir\"\n    Timeout 100 seconds\n</code></pre> <p>An unsigned integer literal value must be specified after the <code>Timeout</code> keyword, if present.</p> <p>The <code>Configs</code> keyword may be used to designate a variable so the flow's properties can be accessed in the code. These properties are usually provided when the flow is created - normally through an administrative tool. This process varies from engine to engine.</p> <p>Often flow properties are used to supply configuration parameters to the flow. As an example, suppose a flow that sends a confirmation e-mail has to be implemented. Properties are a good place to hold the configuration of the outgoing mail server to employ: name, port, authentication credentials, etc. For instance, this is how the configuration properties would be bound to variable <code>conf</code>:</p> <pre><code>Flow com.acme.FoodSurvey\n    Basepath \"mydir\"\n    Timeout 100 seconds\n    Configs conf\n</code></pre>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#inputs","title":"Inputs","text":"<p>In addition to the above, and optionally too, flows may receive inputs from their callers. Input names can be listed using the <code>Inputs</code> keyword:</p> <pre><code>Flow com.acme.FoodSurvey\n    Basepath \"mydir\"\n    Inputs salutation askGender promptRealName\n</code></pre> <p>Input names follow the same naming conventions (patterns) of variables and can be treated as such in code.</p> <p>Important</p> <p>Note the difference between properties and inputs. Properties are parameters that callers of the flow should not control or be interested in. On the other hand, inputs are parameters that callers supply explicitly to make the flow exhibit certain behaviors.</p> <p>Check this section to learn how callers can pass values to input parameters of a flow.</p>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#flow-statements","title":"Flow statements","text":"<p>The statements that make up a flow - body - come after the header and start at column 1, ie. aligned with the <code>Flow</code> keyword:</p> <pre><code>Flow com.acme.FoodSurvey\n    Basepath \"mydir\"\n    Timeout 100 seconds\n    Configs conf\n    Inputs salutation askGender promptRealName\n\nx = \"Hi\"\ny = false\n...\n</code></pre> <p>There are several types of statements: branching, looping, web interaction, etc. They will be regarded in the subsequent sections of this document. Note Agama does not support the concept of subroutines/procedures; this is not needed because functional decomposition is carried out by calling subflows.</p>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#logging","title":"Logging","text":"<p>Flows can issue small messages (normally used as a form of troubleshooting) that will be appended to a log. Every message can be associated a severity level. Both the log location and available levels are engine specific.</p> <p>To append data to the flows log, use the <code>Log</code> instruction. Examples:</p> Code Message appended Notes <code>Log \"Hi there\"</code> Hi there <code>Log \"Hello\" \"world\"</code> Hello world <code>Log</code> can be passed a variable number of parameters <code>Log \"Hello\" \"world\" 0 false</code> Hello world 0 false <code>Log [1, 2, 3, 4, 5]</code> 1, 2, 3, ...more Lists and maps are not traversed wholly <code>Log \"Hell%% 0 %\" \"o\" \" world\" false</code> Hello world 0 false Placeholders usage <code>Log \"% % % yes\" 1 \"two\"</code> 1 two % yes <code>Log \"3\" \"%\" 0</code> 3 % 0 <code>Log \"@warn Today is Friday %th\" 13</code> Today is Friday 13th Message logged as warning (if the engine features a \"warning\" level) <code>Log \"@w Today's Armageddon \\u263A\"</code> Today's Armageddon \u263a Message logged as warning (if the engine features a \"w\" level - shortcut method) <p>Check your engine's documentation to learn more about how statements are logged.</p>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#conditionals-and-branching","title":"Conditionals and branching","text":"<p>Keywords <code>When</code> and <code>Otherwise</code> allow to write conditionals. With <code>and</code>, <code>or</code>, <code>is</code>, and <code>is not</code>, logical (boolean) expressions can be built. Examples:</p> <pre><code>car = { brand: \"Ford\", color: null, model: 1963 }\nWhen car.color is null\n    car.color = \"pink\"\n    ...\n</code></pre> <p>Nested conditionals:</p> <pre><code>... \nWhen car.color is \"pink\"\n    When car.brand is \"Ford\"\n        Log \"Weird-looking car\"\n        ...\n</code></pre> <p>Use of <code>Otherwise</code>:</p> <pre><code>...\nWhen car.color is not null\n    Log \"you have a regular painted car\"\n    ...\nOtherwise\n    ...\n</code></pre> <p>Boolean expressions can span several lines: <code>and</code> and <code>or</code> can be at the start or end of a line as long as the whole expression is left-aligned with its corresponding <code>When</code>. Examples:</p> <pre><code>//legal:\n\nWhen day is cloudy\n    When there is hope and\n    there is mercy  \n        Log \"let's rock n' roll\"\n\n    ...\n\nWhen day is cloudy\n    When there is hope and\n        // :D\n    there is mercy\n    or fear is null\n        Log \"let's rock n' roll\"\n\n    ... \n</code></pre> <pre><code>//illegal:\n\nWhen day is cloudy\n    When there is hope and\n        // :D\n    there is mercy  \n        or fear is null\n        Log \"let's rock n' roll\"   \n\n    ...\n\nWhen day is cloudy\n    When there is hope and\n        // :D\n    there is mercy\nor fear is null\n        Log \"let's rock n' roll\"   \n\n    ...\n</code></pre> <p>Notes:</p> <ul> <li> <p>Equality is designed to work with <code>null</code>, numbers, strings, and boolean values only. More exactly, a number should only be compared to a number, a string to a string, etc., otherwise the equality test evaluates to <code>false</code>. Comparing a value with itself evaluates to true regardless of type, i.e. <code>car is car</code>, <code>null is null</code>, <code>false is false</code> are all truthy</p> </li> <li> <p>Comparisons are limited to equality (<code>is</code>) or inequality (<code>is not</code>). For other forms of comparison you can resort foreign routines</p> </li> <li> <p>As expected <code>and</code> has higher priority than <code>or</code> when evaluating expressions. There is no way to group expressions to override the precedence: there are no parenthesis in Agama. Assigning the result of a boolean expression to a variable is not supported. These restrictions are important when writing conditionals</p> </li> </ul>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#advanced-matching","title":"Advanced matching","text":"<p>Agama's <code>Match ... to</code> is a construct similar to C/Java <code>switch</code>. Example:</p> <pre><code>car = ...\nx = ...\ny = ...\n// Assume x and y hold numbers\nz = [ 3.1416, 2.71828 ]\n\nMatch car.model to\n   x\n      //Code in this block will be executed if car.model is equal to the value of x\n      ...\n\n   -y //Here we use minus y\n      ...  \n\n   z[0]\n      ...\n\n   1.618 //Literal values can be used too for matching\n      ...  \n\n   null\n      ...\n\nOtherwise    //optional block\n   //Instructions here are executed if there was no match at all \n</code></pre>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#flow-finish","title":"Flow finish","text":"<p><code>Finish</code> is used to terminate a flow's execution. A flow can finish successfully or failed. Examples:</p> CodeMeaning <pre><code>Finish true\n</code></pre> Shorthand for flow finished successfully <pre><code>Finish false\n</code></pre> Shorthand for failed flow <pre><code>it = { success: true, data: { userId: \"as9233Qz\", ... }}\nFinish it\n</code></pre> Flow finished successfully. Some relevant data attached <pre><code>it = { success: false,\n    error: \"User entered a wrong password 3 times\" }\nFinish it\n</code></pre> Flow failed. Error description attached <pre><code>Finish \"as9233Qz\"\n</code></pre> Shorthand for <code>{ success: true, data: { userId: \"as9233Qz\" } }</code> <pre><code>it = { nonsense: [ null ] }\nFinish it.nonsense\n</code></pre> This causes the flow to crash. Note this is not equivalent to <code>Finish false</code> (which means the flow ended with a negative outcome). <p>Notes:</p> <ul> <li>Unless otherwise stated by the concrete engine implementation, a map literal should not be passed directly as argument. This means the following is illegal: <code>Finish { success: false, error: \"spacetime singularity\" }</code>. The examples above list several syntactically valid usages</li> <li>Any statement found after <code>Finish</code> is not reached and thus, not executed</li> <li>If no <code>Finish</code> statement is found in a flow's execution, this will degenerate in flow crash</li> <li>When a flow is finished and was used as subflow (part of the execution of a bigger parent flow), the parent does not terminate. Execution continues at the following instruction that triggered the subflow. More on <code>Trigger</code> later</li> <li>Using <code>data</code> in the <code>Finish</code> directive is an effective way to communicate information to callers (parent flows)</li> <li>Learn more about flows lifecycle here </li> </ul>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#web-interaction","title":"Web interaction","text":"<p>Web interaction constructs bring the most value to Agama. Developers can express the concepts of \u201dredirect a user to an external site and retrieve any data later provided\u201d or \u201cshow a page and grab user data after interaction\u201d using atomic instructions.</p>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#rfac","title":"RFAC","text":"<p><code>RFAC</code> (stands for Redirect and Fetch at callback) abstracts the process of redirecting the user's browser to an external site and then collect the data presented later at a designated callback URL. This feature is particularly useful in inbound identity scenarios (e.g. to support social login).</p> ExampleDetails <pre><code>RFAC \"https://login.twitter.com/?blah..&amp;boo=...\"\n</code></pre> Redirects to the given location. Once the user browser is taken to the callback URL by the external site (twitter.com), the flow continues ignoring any data included <pre><code>map = { twitter: { loginUrl: \"https://...\", ... }, ... }\nresult = RFAC map.twitter.loginUrl\n</code></pre> Redirects to the given location. Once the user browser is taken to the callback URL by the external site, the data included in the query string or payload is stored in <code>result</code> (a map) for further processing <p>The callback URL varies depending on the engine used. Check your engine's docs.</p>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#rrf","title":"RRF","text":"<p><code>RRF</code> (stands for Render-Reply-Fetch) abstracts the process of rendering a UI template, send the produced markup to the browser and grab user-provided data back at the server side.</p> ExampleDetails <pre><code>RRF \"survey.htm\"\n</code></pre> Renders the template <code>survey.htm</code> (located in this flow's base path) and resulting markup is replied to user's browser.Data submitted by the user is ignored          <pre><code>obj = { salutation: \"Hey!\", ... }\nresult = RRF \"survey.htm\" obj\n</code></pre> Renders the template <code>survey.htm</code> by injecting the data passed in <code>obj</code> and the resulting markup is replied to user's browser.Data submitted by the user is stored in variable <code>result</code>: a map whose keys are named according to the form fields present in <code>survey.htm</code> <p>Notes:</p> <ul> <li>The template location must be specified with a string literal only (not a variable)</li> <li>Where and how to store templates is an engine-specific detail as well as the file formats supported. See Assets management.</li> <li>Use map variables - not literal maps - for the second argument of <code>RRF</code></li> </ul>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#looping","title":"Looping","text":"<p>There are two constructs available for looping in Agama: <code>Repeat</code> and <code>Iterate over</code>.</p>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#repeat","title":"Repeat","text":"<p><code>Repeat</code> was designed with the concept of attempts/retries in mind: a set of statements are executed, a condition can optionally be supplied in order to abort the loop early, and (optionally too) a block of statements can be executed before the next iteration is started if the condition evaluated to <code>false</code>. A loop is given a maximum number of iterations. Examples:</p> ExampleNotes <pre><code>month = \"\u2026\"\nRepeat 3 times max\n    data = RRF \"guess_birthday_month.htm\"\n    //Quit is optional in loops\n    Quit When data.guess is month \n</code></pre> A loop that runs 3 iterations at most.A page is shown at every iteration.If the value entered by the user matches that of <code>month</code> variable, the loop is aborted earlier <pre><code>x = \u2026 // an integer value\nmonth = \"\u2026\"\nobj = { error: null }\nRepeat x times max\n    data = RRF \"guess_birthday_month.htm\" obj\n    Quit When data.guess is month\n    obj.error = \"Wrong! try again\"\n</code></pre> Similar to previous exampleThis time the max no. of iterations is set using a variableWhen there is a miss a message error is set (which the UI template may potentially use) <pre><code>x = \u2026 // an integer value\nmonth = \"\u2026\"\nobj = { error: null }\ny = Repeat x times max\n    data = RRF \"guess_birthday_month.htm\" obj\n    Quit When data.guess is month\n    obj.error = \"Wrong! try again\"\n    Log \"Attempt number:\" idx[0]\n</code></pre> Similar to previous exampleAfter the loop finishes, variable <code>y</code> will contain the total number of iterations made to completion. This excludes partial iterations aborted by <code>Quit</code>, thus, <code>y &lt;= x</code>Note the usage of implicit variable <code>idx</code> which holds the current (zero-based) iteration number","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#iterate-over","title":"Iterate over","text":"<p><code>Iterate over</code> is used to traverse the items of a string, list, or the keys of a map. At every iteration, a variable is set with the current item or key name. As with <code>Repeat</code>, a loop may be aborted earlier, an optional block of statements can be specified after <code>Quit</code>, and the total number of iterations can be stored in a variable.</p> ExampleNotes <pre><code>seasons = [ \"spring\", \"winter\", \"fall\", \"summer\" ]\nIterate over seasons using sn\n    Log \"There is nothing like\" sn\n</code></pre> A loop running over a simple list. Every element visited is referenced with variable <code>sn</code> <pre><code>human = { weight: 100, height: 5.9, age: 26 }\nIterate over human using attribute\n    Log attribute \"is\" human.$attribute\n</code></pre> Iterates over the keys of the map printing both the key and its associated value. To learn about the <code>.$</code> notation see Maps and dot notation <pre><code>seasons = [ \"spring\", \"winter\", \"fall\", \"summer\" ]\nsports = [ \"soccer\", \"golf\", \"tennis\" ]\nIterate over seasons using sn\n    Iterate over sports using sport\n        Log \"There is nothing like playing % in %\" sport sn \n</code></pre> Nested loops <pre><code>seasons = [ \"spring\", \"winter\", \"fall\", \"summer\" ]\nsports = [ \"soccer,\" \"golf\", \"tenis\" ]\nIterate over seasons using sn\n    y = Iterate over sports using sport\n        Log \"Shall we play % in % ?\" sport sn\n        Quit When sn is \"winter\"\n        Log \"yes!\"\n    Log \"We played % sports in %\" y sn \n</code></pre> Similar to the previous example. The inner loop is aborted upon a given condition. Note the total number of complete iterations is recorded in <code>y</code> every time the inner loop finishes. <pre><code>seasons = [ \"spring\", \"winter\", \"fall\", \"summer\" ]\nsports = [ \"soccer,\" \"golf\", \"tenis\" ]\nIterate over seasons using sn\n    Iterate over sports using sport\n        Log idx[0] idx[1] \n</code></pre> Prints iteration numbers: 0 0, 0 1, 0 2, 1 0, 1 1, 1 2, ... 3 2The index used in <code>idx</code> is <code>0</code> for the outermost loop and increases by one at every level of loop nesting","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#subflows","title":"Subflows","text":"<p>A flow can <code>Trigger</code> another flow (a.k.a subflow) and grab its response when <code>Finish</code>ed. This feature materializes flow composition and re-use in Agama.</p> ExampleNotes <pre><code>Trigger jo.jo.PersonalInfoGathering\n</code></pre> Starts the flow with qualified name <code>jo.jo.PersonalInfoGathering</code>.Returned data is ignored <pre><code>outcome = Trigger jo.jo.PersonalInfoGathering null false\nLog \"subflow returned with success?\" outcome.success\n</code></pre> Starts a flow passing parameters (assuming <code>PersonalInfoGathering</code> receives two inputs).<code>outcome</code> will contain the map used when the subflow ended <pre><code>outcome | E = Trigger jo.jo.PersonalInfoGathering null false \n</code></pre> Similar to the previous example. If for some reason <code>PersonalInfoGathering</code> crashes, variable <code>E</code> will hold a reference to the error for further processing. Otherwise <code>E</code> evaluates to <code>null</code>. The type/structure of <code>E</code> is an engine-specific detail. The variable on the left of the pipe (<code>|</code>) can be omitted if the outcome of the flow will not be inspected <pre><code>userPrefs = { otp: \"...\", ... }\nMatch userPrefs.otp to\n    \"e-mail\"\n        flow = \"co.acme.EmailOTP\"\n    \"sms\"\n        flow = \"co.acme.SmsOTP\"\nTrigger $flow \n</code></pre> Starts a flow whose qualified name is determined at runtime","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#input-parameters","title":"Input parameters","text":"<p>The values passed after the flow name in <code>Trigger</code> are supplied as input parameters in the order declared by the subflow's <code>Inputs</code>. When not enough values are passed, the unassigned inputs will hold a <code>null</code> value.</p> <p>Unless otherwise stated by the concrete engine implementation, list and map literals should not be passed as arguments to <code>Trigger</code>:</p> <ul> <li> <p>Illegal: <code>Trigger subflow { key: [ 1, 2 , 3] } [ \"Yeeha!\" ]</code></p> </li> <li> <p>Legal: <code>Trigger subflow x car.model list[1] null false -3 \"Sam\"</code></p> </li> </ul>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#template-overrides","title":"Template overrides","text":"<p>When re-using flows, existing templates may not match the required look-and-feel or layout of the flow that is being built, or may require minor adjustments to fit better the parent's needs. These can be overcome by declaring which templates the developer would like to override for a given subflow call. Example:</p> <pre><code>outcome = Trigger jo.jo.PersonalInfoGathering\n    Override templates \"path/basic.htm\" \"\" \"path2/dir/detail.htm\" \"tmp/mydetail.htm\"\nLog \"subflow returned with success?\" outcome.success\n</code></pre> <p>In an indented block using the <code>Override templates</code> keyword, several string literals can be provided. They specify the paths of the (subflows) templates that will be overriden by the parent and the corresponding new paths. In the example above, templates <code>path/basic.htm</code> and <code>path2/dir/detail.htm</code> rendered by flow <code>PersonalInfoGathering</code> (or its subflows) won't be picked from these locations but from the base path of the current (parent) flow using names <code>basic.htm</code> and <code>tmp/mydetail.htm</code> respectively. Usage of empty string denotes reusing the same file name than the original file.</p> <p>Alternatively, every pair of original vs. new path can be specified in a single line for more clarity, like this:</p> <pre><code>outcome = Trigger jo.jo.PersonalInfoGathering\n    Override templates \"path/basic.htm\" \"\" \n    \"path2/dir/detail.htm\" \"tmp/mydetail.htm\"\n    ...\n</code></pre> <p>Note</p> <p>The new (overriding) templates will be injected with the same data original templates would receive. In other words, this directive only \"modifies\" the first parameter of <code>RRF</code> instructions.</p>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#foreign-routines","title":"Foreign routines","text":"<p>Business logic implemented in languages other than Agama can be re-used by means of the <code>Call</code> instruction. <code>Call</code> plays a key role because Agama code serves fundamentally as a depiction of a flow hiding most of the internal details and low-level computations which are in turn delegated to foreign routines.</p> <p>The syntax of this directive is very general and actual semantics are left to the concrete engine. Roughly, here is how a <code>Call</code> can be structured:</p> <pre><code>( var_expr? ('|' var_name)? = )? Call alnum(.alnum)* (#alnum)? arg*\n</code></pre> <p>where:</p> <ul> <li>var_name is a variable name, e.g.: <code>x</code>, <code>fooBar</code>, <code>x_0</code></li> <li>var_expr is a variable expression, e.g.: <code>x</code>, <code>x.a</code>, <code>x[1].b</code>, etc.</li> <li>alnum is syntactically identical to var_name but does not necessarily refer to an existing variable in the code, for instance, it may describe a path to locate a routine in a library</li> <li>arg is a var_expr or any string, number, boolean, null literal</li> </ul> <p>So the below are all syntactically valid invocations:</p> <pre><code>Call apple#pear\nCall apple#pear \"Hi\" x 16\nCall apple.banana#pear \"Hi\" abc 16\nfoo = Call apple.banana#pear \"Hi\" abc 16\nfoo | error = Call apple.banana#pear \"Hi\" abc 16\n| error = Call apple.banana#pear \"Hi\" abc 16 x[0].ahoy.ahoy\nfoo = Call street fighters true false\n</code></pre> <p>Again, the semantics are given by the specific engine. Consult your engine documentation for examples.</p> <p>Unless otherwise stated by the concrete engine implementation, list and map literals should not be passed as arguments to method calls directly. This means the following is illegal: <code>Call co.Utils#routine { key: [ 1, 2 , 3] } [ \"Yeeha!\" ]</code>.</p>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#advanced-and-special-cases-in-variable-manipulation","title":"Advanced and special cases in variable manipulation","text":"","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#indexing-in-lists","title":"Indexing in lists","text":"<p>Accessing/modifying list elements requires providing a numeric index between the brackets, e.g. <code>x[ 0 ]</code>. Note variables can also be used for indexing, like <code>x[ y ]</code> where <code>y</code> is a positive integer or zero.</p> <p>For the below table, assume <code>x = [ \"one\", \"two\", \"three\" ]</code>.</p> <pre><code>x[1]\n//\"two\"\n</code></pre> <pre><code>y = 1\nx[y]\n//\"two\"\n</code></pre> <pre><code>x[\"1\"]\n//illegal\n</code></pre> <pre><code>x[ z[0] ]\n//illegal: variable expressions not allowed for indexes \n</code></pre> <pre><code>x[obj.property]\n//illegal: variable expressions not allowed for indexes\n</code></pre>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#maps-and-dot-notation","title":"Maps and dot notation","text":"<p>The regular \u201cdot\u201d notation is limited in the sense it is fairly static: developers have to have prior knowledge about the keys' names, in other words,  about the structure of maps and nested submaps, like in <code>person.homeAddress.postalCode</code>.</p> <p>Also, there might be cases where a key name does not fit the required pattern, like in <code>person.street-address</code> or <code>persona.direcci\u00f3n</code>; even worse, there might be cases where the actual key is only known at runtime.</p> <p>There are ways to overcome this:</p> ExampleNotes <pre><code>x.\"- wow!\"\n</code></pre> Access the value associated to the key named <code>-wow!</code> <pre><code>prop = ...\nx.$prop \n</code></pre> Access the value associated to the key whose name is contained in the variable <code>prop</code> (that holds a string value). Note actual value of <code>prop</code> may be originated from a Java call or another form of computation <pre><code>propA = ...\npropB = ...\nx.$propA.c.\"d\".$propB\n</code></pre> A mix of notations is valid.For example, if <code>x= { a: { b: 0, c: { c: true, d: { e: null, f: \"hello\" } } } }</code>, <code>propA</code> is equal to <code>\"a\"</code>, and <code>propB</code> to <code>\"f\"</code>, the expression on the left evaluates <code>\"hello\"</code> <p>Usage of <code>.$</code> requires to supply a variable after the dollar sign: grouped variable expressions are not supported. Thus, it is not possible to achieve something like <code>x.a.c.($map.mykey).f</code> in order to obtain <code>\"hello\"</code> if <code>map = { mykey: \"d\" }</code>.</p>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#indexing-in-maps","title":"Indexing in maps","text":"<p>For convenience, when a key name \u201clooks like\u201d a positive integer (or zero), e.g. <code>\"2\"</code>, <code>\"10\"</code>, etc., numeric values can directly be used to get/set data in a map:</p> <pre><code>x = { }\nx.\"1\" = \"golf\"\nx[1]    //retrieves \"golf\"\nx[2] = \"polo\"    //adds the key/value pair \"2\" / \"polo\"\n</code></pre>","tags":["developer","agama","DSL","reference"]},{"location":"agama/language-reference/#language-keywords","title":"Language keywords","text":"<p>The following is a list of reserved words and as such, cannot be used as variable names or maps keys (in literal notation).</p> Keyword Purpose/usage Basepath header declaration Call Java interaction Configs header declaration Finish termination Flow header declaration Inputs header declaration Iterate over loops Log logging Match conditionals Otherwise conditionals Override templates web interaction Quit conditionals and loops Repeat loops RFAC web interaction RRF web interaction seconds header declaration times max loops to conditionals Timeout header declaration Trigger subflow calls using loops When conditionals Operator and is is not or Special literals true false null","tags":["developer","agama","DSL","reference"]},{"location":"agama-catalog/community/","title":"Agama Community Projects","text":"<p>This folder contains Agama projects maintained by community developers.</p>","tags":["administration","agama","projects","community"]},{"location":"agama-catalog/jans/","title":"Agama Core Projects","text":"<p>This folder contains Agama projects maintained by the Jans core team.</p>","tags":["administration","agama","projects","core"]},{"location":"agama-catalog/jans/inboundID/","title":"Inbound identity with Agama","text":"<p>Using Agama administrators can delegate authorization to external services like social sites and enterprise access management solutions, e.g. Microsoft Entra ID, Oracle Access Management, etc. In a typical setting users are presented a login form with a \"Sign in with...\" button for authentication to take place at a given 3rd party in order to get access to a target application.</p> <p>This process is usually referred to as \"inbound identity\". In this document the steps required to setup inbound identity in your Janssen server are presented.</p>"},{"location":"agama-catalog/jans/inboundID/#requisites","title":"Requisites","text":"<ul> <li>A Janssen server with config-api installed</li> <li>Starter knowledge of OAuth2/OpenId Connect and the Java programming language</li> </ul>"},{"location":"agama-catalog/jans/inboundID/#terminology","title":"Terminology","text":"<ul> <li> <p>Provider: An external identity provider, often a social site. Every provider is associated with a unique identifier</p> </li> <li> <p>Provider preselection: A process that designates the provider to employ for authentication without the end-user  making a explicit decision, i.e. without a \"Sign in with\" button. Here the provider may be inferred from contextual data elicited at earlier stages, for instance.</p> </li> </ul>"},{"location":"agama-catalog/jans/inboundID/#scope","title":"Scope","text":"<p>There is a great amount of different mechanisms providers may employ to materialize the authentication process. The current offering in Agama is focused on OAuth2-compliant providers (includes OpendId Connect), more specifically those supporting the <code>code</code> authorization grant. This does not mean other grants or even different protocols such as SAML cannot be supported, however organizations would have to engage in extra development efforts in this case.</p> <p>If the providers of interest already support the <code>code</code> authorization grant, the amount of work is significantly reduced.</p>"},{"location":"agama-catalog/jans/inboundID/#flows-involved","title":"Flows involved","text":""},{"location":"agama-catalog/jans/inboundID/#provider","title":"Provider","text":"<p>For every provider to support there has to be an Agama flow that must:</p> <ul> <li>Redirect the browser to the provider's site for the user to enter his login credentials</li> <li>Return profile data of the given user</li> </ul> <p>To facilitate administrators' work, the following providers are already implemented:</p> <ul> <li>Apple</li> <li>Facebook, Github, Google (through the \"Generic provider\" flow)</li> </ul>"},{"location":"agama-catalog/jans/inboundID/#main-flow","title":"Main flow","text":"<p>The actual process of inbound identity occurs here. This flow is already implemented and ready to use. The following is a summary of the steps involved:</p> <ol> <li> <p>A provider selection page is displayed. The list includes all (enabled) providers defined in the configuration of this flow. Additionally an option to use an existing local account is displayed (i.e. no inbound identity)</p> </li> <li> <p>The flow associated to the selected provider is launched. Actually, if the main flow was passed a provider identifier as parameter, step 1 is skipped and the given flow is launched directly  </p> </li> <li> <p>If the flow triggered at step 2 did not finish successfully, the main flow finishes likewise. Else, the profile data returned is transformed using the applicable attribute mapping for the provider. More on attribute mappings here</p> </li> <li> <p>If the resulting profile data lacks a value for e-mail, and the provider was configured to require it, a form is displayed where the user can enter his e-mail address</p> </li> <li> <p>User provisioning takes place, in other words, a local user entry is created in the Janssen server database. If an entry already exists, it is updated as long as the provider is configured to allow so</p> </li> <li> <p>The flow finishes successfully and the user gets access to the target application</p> </li> </ol> <p>Note the above design does not involve communication protocols. It is responsability of the concrete provider flow how to implement this aspect. The main flow can remain unmodified regardless of any change in existing flows or when new ones are added.</p> <p>Feel free to modify this flow or create one based on it if customizations are required.</p>"},{"location":"agama-catalog/jans/inboundID/#deployment","title":"Deployment","text":"<p>To start, ensure the Agama engine and bridge are enabled. More info here.</p>"},{"location":"agama-catalog/jans/inboundID/#add-agama-inbound-jar","title":"Add agama-inbound jar","text":"<p>Let's add the required libraries to the authentication server:</p> <ul> <li>Visit this page, navigate to the folder matching your Janssen server version, and download the jar file</li> <li>SSH to the server. Transfer the file to directory <code>/opt/jans/jetty/jans-auth/custom/libs</code></li> <li>Restart the server, e.g. <code>systemctl restart jans-auth</code></li> </ul>"},{"location":"agama-catalog/jans/inboundID/#make-a-gama-archive","title":"Make a <code>gama</code> archive","text":"<p>gama files are deployable units in the Agama engine. To create one, simply zip the contents of project subdirectory. The resulting archive must have three folders at top-level: <code>web</code>, <code>lib</code>, and <code>code</code>. The file extension does not matter in the end.</p> <p>To quickly collect the contents of <code>project</code>, you can do the following:</p> <pre><code>git clone --depth 1 https://github.com/JanssenProject/jans.git\ncd jans/docs/agama-catalog/jans/inboundID/project\n</code></pre>"},{"location":"agama-catalog/jans/inboundID/#deploy-the-archive","title":"Deploy the archive","text":"<p>Transfer the archive to your server, and then run <code>/opt/jans/jans-cli/jans_cli_tui.py</code>. Follow the prompts and then enter the Agama menu (<code>Alt + m</code>). Using you keyboard TAB key, highlight the button \"Upload\", and press ENTER. Browse and select the file.</p> <p>Wait 30 seconds and press the <code>d</code> key. This will show the result of the deployment. Ensure no errors are reported.</p>"},{"location":"agama-catalog/jans/inboundID/#configuration-handling","title":"Configuration handling","text":""},{"location":"agama-catalog/jans/inboundID/#collect-providers-configurations","title":"Collect providers configurations","text":"<p>For every provider collect OAuth 2.0 configurations - or OpenId Connect if supported. Instructions to do this vary across different social sites. For the case of Facebook, for instance, this is approximately what needs to be done:</p> <ul> <li>Login to Facebook and register as developer</li> <li>Create an application with Facebook login capabilities</li> <li>In the Facebook login settings add <code>https://&lt;your-host&gt;/jans-auth/fl/callback</code> as a valid OAuth redirect URI</li> <li>Finally grab the app Id and secret from the app settings page</li> </ul> <p>For Apple, some guidelines are included at the end of this document.</p>"},{"location":"agama-catalog/jans/inboundID/#supply-configurations","title":"Supply configurations","text":"<p>Still in TUI, press the <code>c</code> key and then choose to export the sample configurations locally. Inspect the generated file. It provides \"dummy\" placeholders to supply the actual configurations.</p> <p>The configuration is held in a JSON object whose keys are identifiers of identity providers. The associated value for a key is a JSON object itself and follows the structure represented by this Java class.</p> <p>This is an example of a configuration for a couple of identity providers:</p> <pre><code>{\n\n\"github\": {\n  \"flowQname\": \"io.jans.inbound.GenericProvider\",\n  \"displayName\": \"Github\",\n  \"mappingClassField\": \"io.jans.inbound.Mappings.GITHUB\",\n  \"oauthParams\": { ... }\n},\n\n\"google\": {\n  \"flowQname\": \"io.jans.inbound.GenericProvider\",\n  \"displayName\": \"Google\",\n  \"mappingClassField\": \"io.jans.inbound.Mappings.GOOGLE\"\n  \"enabled\": false,\n  \"skipProfileUpdate\": true,\n  \"oauthParams\": { ... }\n}\n\n}\n</code></pre> <p>The table below explains the meaning of properties:</p> Name Description Mandatory <code>flowQname</code> The qualified name of the Agama flow associated to this provider (must exist in <code>code</code> directory) Yes <code>displayName</code> Short name of the provider (will be shown in the selector page) Yes <code>oauthParams</code> The actual OAuth configuration for the given provider. See below Yes <code>openIdParams</code> OpenId connect configuration. See notes below No <code>mappingClassField</code> The qualified name of the attribute mapping for this provider Yes <code>logoImg</code> Relative path to the logo image (will be shown in the selector page) No <code>enabled</code> A boolean value indicating whether this provider can be shown (and triggered) from the main flow or not. Default value is <code>true</code> No <code>skipProfileUpdate</code> Determines if profile data should not be updated for a user if an entry already exists locally for him. Default value is <code>false</code> No <code>cumulativeUpdate</code> When <code>true</code>, existing value(s) of an attribute are preserved when the incoming profile data already contains value(s) for such attribute, otherwise its values are replaced by the incoming ones entirely. Default value is <code>false</code> No <code>requestForEmail</code> Whether to prompt the user to enter his e-mail if the data supplied by the identity provider does not contain one. Default value is <code>false</code> No <code>emailLinkingSafe</code> Determines if an existing account with the same e-mail of the user about to be provisioned can be treated as the same person No <p>Notes:</p> <ul> <li><code>logoImg</code> path is relative to the base path of the main flow, i.e. <code>inboundID</code></li> <li>Set <code>emailLinkingSafe</code> to true only if you trust the provider, i.e. the incoming e-mail data is securely verified. For security, never set it to <code>true</code> when <code>requestForEmail</code> is also <code>true</code></li> </ul> <p>Property <code>oauthParams</code> adheres to the following structure:</p> Name Description <code>authzEndpoint</code> The authorization endpoint as in section 3.1 of RFC 7649 <code>tokenEndpoint</code> The token endpoint as in section 3.2 of RFC 7649 <code>userInfoEndpoint</code> The endpoint where profile data can be retrieved. This is not part of the OAuth2 specification <code>clientId</code> The identifier of the client to use, see section 1.1 and 2.2 of RFC 7649. This client is assumed to be confidential as in section 2.1 <code>clientSecret</code> Secret associated to the client <code>scopes</code> A JSON array of strings that represent the scopes of the access tokens to retrieve <code>redirectUri</code> Redirect URI as in section 3.1.2 of RFC 7649 <code>clientCredsInRequestBody</code> <code>true</code> indicates the client authenticates at the token endpoint by including the credentials in the body of the request, otherwise, HTTP Basic authentication is assumed. See section 2.3.1 of RFC 7649 <code>custParamsAuthReq</code> A JSON object (keys and values expected to be strings) with extra parameters to pass to the authorization endpoint if desired <code>custParamsTokenReq</code> A JSON object (keys and values expected to be strings) with extra parameters to pass to the token endpoint if desired <p>Edit the properties you consider relevant for every provider. Generally, from the above table, the first six are the only needed.</p> <p>Section <code>openIdParams</code> can be used when the provider supports OpenId Connect too. This will reduce considerably the amount of properties you will need to supply in section  <code>oauthParams</code>. Here's the structure:</p> Name Description <code>host</code> The URL of the provider, e.g. <code>https://may.hem</code> <code>useDCR</code> If the provider supports dynamic client registration set this to <code>true</code>. It will be a time saver <code>useCachedClient</code> Once client registration occurs for the first time, no more registration attempts will be made until the client is about to expire. Set this to <code>false</code> to force registration every time authentication is about to take place <p>When providing <code>openIdParams</code>, the <code>host</code> will be used to grab the endpoints mentioned in the <code>oauthParams</code> section automatically, namely, authorization, token, and userInfo endpoints.  When <code>useDCR</code> is set to <code>true</code>, a client will be registered so there is no need to supply <code>clientId</code> and <code>clientSecret</code>. Under these circumstances, most of times only <code>scopes</code> will be needed under the <code>oauthParams</code> section.</p>"},{"location":"agama-catalog/jans/inboundID/#attribute-mappings","title":"Attribute mappings","text":"<p>This is the process through which the raw user profile data received by an identity provider is transformed into an object suitable for being stored in the Janssen's user database. Here, developers have the opportunity to \"map\" or \"transform\" the incoming data to one compatible with the data types, formats, and names required by the database.</p> <p>As an example suppose a provider returned the following:</p> <pre><code>{\n  \"id\": dfsg2-3bui2.2.5+ld1,\n  \"email\": \"moe@doedoe.co\",\n  \"last_name\": \"Doe\",\n  \"first_name\": \"Moe\"\n}\n</code></pre> <p>None of this attributes exist in Janssen; database adheres to LDAP naming. Conformant names would be <code>uid</code>, <code>mail</code>, <code>sn</code>, and <code>givenName</code>. Also, let's assume you want to set <code>displayName</code> to a string composed by the first and last names separated by a white space. Writing a mapping is required.</p> <p>A mapping is implemented in Java in the form of a <code>java.util.function.UnaryOperator&lt;Map&lt;String, Object&gt;&gt;</code>, that is, a function that takes a <code>Map&lt;String, Object&gt;</code> as input and returns a <code>Map&lt;String, Object&gt;</code> as result. Several examples are provided here.</p> <p>Note property <code>mappingClassField</code> of every provider defined in the main flow points to the fully qualified name of a mapping. Not all mappings have to belong to the same class.</p>"},{"location":"agama-catalog/jans/inboundID/#import-configurations","title":"Import configurations","text":"<p>Once the JSON file you have been editing is ready, hit <code>c</code> key again in TUI. This time choose to import the configuration and select the file.</p>"},{"location":"agama-catalog/jans/inboundID/#test","title":"Test","text":"<p>Launch the main flow (learn about this topic here). If everything was setup correctly, a screen with a \"Sign in using\" heading will be shown and next to it links to the providers sites. When clicking on a link, the browser will be taken to the given website for authentication. A prompt for consent of release of personal information may appear as well. Finally, the browser is returned back to your server and then to the target application as described earlier.</p>"},{"location":"agama-catalog/jans/inboundID/#how-to-add-another-provider","title":"How to add another provider?","text":"<p>Note: If you want to integrate Apple Sign In, skip this section: guidelines are included at the end of this document.</p> <p>In practice most identity providers adhere to the OAuth2 <code>code</code> grant and require configurations similar to the sample provided. Follow these steps:</p> <ol> <li>In your local machine, create a new project with the required layout: directories <code>web</code>, <code>code</code> and <code>lib</code></li> <li>Place the logo inside <code>web</code></li> <li>If an existing attribute mapping cannot be reused, implement one for this provider and put the source (Java/Groovy) in <code>lib</code> directory </li> <li>Create the archive and deploy it in the server using TUI</li> <li>Include the configuration for the new provider in the main's flow (<code>io.jans.inbound.ExternalSiteLogin</code>) config, for instance:</li> </ol> <pre><code>\"new-provider-ID\": {\n  \"flowQname\": \"io.jans.inbound.GenericProvider\",\n  \"displayName\": \"...\",\n  \"mappingClassField\": \"Qualified name of the attribute mapping\",\n  \"logoImg\": \"path to the logo image relative to the base path of the main flow (you can use things like ../)\"\n  \"oauthParams\": { ... }\n}\n</code></pre> <p>Do your tests. If you consider the \"generic\" provider flow does not cope, add a new flow to the recently created project (in folder <code>code</code>) to better suit the provider requirements. Redeploy and test again.</p>"},{"location":"agama-catalog/jans/inboundID/#writing-your-own-mapping","title":"Writing your own mapping","text":"<p>Ensure you went through this already. Some important considerations:</p> <ul> <li>A mapping has to be declared as a public field in a public class</li> <li>Several providers can use the same mapping</li> </ul> <p>While working on a mapping, having to pack the class in a jar file, uploading it to the server, and then restarting  every time a modification is made can be a big burden. To avoid this you can place the source (java) file in the <code>lib</code> directory of your project and leverage hot reloading. Ensure to create the usual directory hierarchy in <code>lib</code> corresponding to your class package.</p> <p>A \"template\" for quickly start writing a mapping is already available. Save with <code>.java</code> extension and edit the body of the lambda expression.</p> <p>If you use <code>DEBUG</code> level in your server, you will see in the log the result of the mapping every time it is applied. Check for a message like \"Mapped profile is\".</p>"},{"location":"agama-catalog/jans/inboundID/#appendix-integrating-sign-in-with-apple","title":"Appendix: integrating \"Sign In With Apple\"","text":"<p>Integrating this provider requires a good amount of work. In the following we provide a summary.</p> <p>Ensure you have an Apple developer account to start. This tutorial does a great job at explaining the necessary steps. As you go with it, please collect the following elements:</p> <ul> <li>A service ID</li> <li>A team ID</li> <li>A key ID and a key file </li> </ul> <p>You will be prompted to provide a domain name and a return URL. Provide <code>&lt;your-jans-host&gt;</code> and <code>https://&lt;your-jans-host&gt;/jans-auth/fl/callback</code> respectively, ensuring the changes are effectively saved in the developer's portal.</p> <p>The configuration for this provider would look like:</p> <pre><code>\"apple\": {\n  \"flowQname\": \"io.jans.inbound.Apple\",\n  \"displayName\": \"Apple\",\n  \"mappingClassField\": \"io.jans.inbound.Mappings.APPLE\",\n  \"logoImg\": \"apple.png\",\n  \"oauthParams\": {\n      \"authzEndpoint\": \"https://appleid.apple.com/auth/authorize\",\n      \"tokenEndpoint\": \"https://appleid.apple.com/auth/token\",\n      \"clientId\": \"&lt;SERVICE ID&gt;\",\n      \"key\": \"&lt;ONE-LINER CONTENTS OF KEY FILE&gt;\",\n      \"keyId\": \"&lt;KEY ID&gt;\",\n      \"teamId\": \"&lt;TEAM ID&gt;\",\n      \"scopes\": [\"email\", \"name\"],\n      \"custParamsAuthReq\": { \"response_mode\": \"form_post\" },\n      \"clientCredsInRequestBody\": true\n  }\n}\n</code></pre> <p>For <code>key</code>, remove the lines regarding begin/end of the private key entirely. Also remove any line breaks: a one-liner is required.</p>"},{"location":"agama-catalog/jans/inboundID/#expected-journey","title":"Expected journey","text":"<p>The accompanying images illustrate the steps end-users will go through when using the inbound identity flow taking the Apple route:</p> <ol> <li> <p>Initial provider selector page</p> <p></p> </li> <li> <p>Prompt for credentials at Apple website</p> <p></p> </li> <li> <p>Prompt for a second factor, e.g. SMS (optional)</p> <p></p> </li> <li> <p>Prompt for browser trust</p> <p></p> </li> <li> <p>Prompt before returning to original site</p> <p></p> </li> </ol> <p>Finally, the user should land at the target application.</p>"},{"location":"agama-catalog/vendor/","title":"Agama Vendor Projects","text":"<p>This folder contains Agama projects maintained by third party vendors.</p>","tags":["administration","agama","projects","vendor"]},{"location":"assets/","title":"Index","text":"<p>Use the assets directory to store digital assets like images and diagrams that are used to support documentation for all modules.</p>"},{"location":"assets/#directory-structure","title":"Directory Structure","text":"<p><code>logo</code>: This directory holds logo files used for official documentation and publications. Do not change these files without consulting the CODEOWNER.</p>"},{"location":"assets/#guidelines","title":"Guidelines","text":"<ul> <li>Name the file using 4 to 5 keywords (separated by dash <code>-</code>) which describes content of the file i.e <code>diagram-user-registration-sequence.pdf</code></li> <li>Max file size 1MB each</li> <li>images format preferably <code>.png</code></li> <li>diagrams format preferably <code>.svg</code></li> <li>Preferred diagramming tool: <code>draw.io</code>. Upload <code>.drawio</code> file along with diagram pdf file with same name. This allows future updates to the diagram to keep it updated</li> </ul>"},{"location":"assets/casa/","title":"Doc","text":""},{"location":"casa/","title":"Jans Casa Documentation","text":"<p>Jans Casa (\"Casa\") is a self-service web portal for end-users to manage authentication and authorization preferences for their account in a Janssen Server.</p> <p>For example, as people interact with an organization's digital services, they may need to:</p> <ul> <li>Enroll, delete and manage two-factor authentication (2FA) credentials for their account (e.g. FIDO security keys, mobile apps, phone numbers, etc.)</li> <li>Turn 2FA on and off</li> <li>View and manage which external apps have been authorized to access what personal data</li> <li>View trusted devices</li> </ul> <p>Casa provides a platform for people to perform these account security functions and more in a friendly, straightforward manner.</p>","tags":["Casa","Introduction"]},{"location":"casa/#two-factor-authentication","title":"Two-factor authentication","text":"<p>The core use case for Casa is self-service 2FA. If people need to call the helpdesk every time they get a new phone or security key, supporting strong authentication becomes prohibitively expensive.</p> <p>Out-of-the-box, Casa can be used to enroll and manage the following authenticators:</p> <ul> <li>FIDO2 security keys like Yubikeys </li> <li>OTP hardware cards like these or dongles like these</li> <li>OTP mobile apps like Google Authenticator, FreeOTP, etc.       </li> <li>Mobile phone numbers able to receive OTPs via SMS   </li> <li>Passwords      </li> </ul> <p>Additional authenticators and use cases can be supported via custom plugins.</p>","tags":["Casa","Introduction"]},{"location":"casa/#2fa-enrollment-apis","title":"2FA enrollment APIs","text":"<p>To facilitate 2FA device enrollment during account registration, or elsewhere in an application ecosystem, Casa exposes APIs  for enrolling the following types of authenticators:</p> <ul> <li>Phone numbers for SMS OTP</li> <li>OTP apps, cards, or dongles  </li> <li>FIDO security keys</li> </ul>","tags":["Casa","Introduction"]},{"location":"casa/#configuration-via-apis","title":"Configuration via APIs","text":"<p>Besides a comprehensive graphical admin console, application settings can also be manipulated by means of a configuration API.</p>","tags":["Casa","Introduction"]},{"location":"casa/#existing-plugins","title":"Existing plugins","text":"<p>Casa is a plugin-oriented, Java web application. Existing functionality can be extended and new functionality and APIs can be introduced through plugins. Currently, there are plugins available for the following:</p> <ul> <li>2FA settings</li> <li>Accounts linking</li> <li>Consent management</li> <li>Custom branding</li> <li>BioID</li> <li>Email OTP</li> <li>Certificate authentication</li> </ul> <p>If you are interested in onboarding additional authentication methods to Casa, read this guide.</p>","tags":["Casa","Introduction"]},{"location":"casa/#user-roles","title":"User roles","text":"<p>There are two types of users in Jans Casa:</p> <ul> <li> <p>Regular users: Any user in the Janssen Server  </p> </li> <li> <p>Admin users: Users having the <code>CasaAdmin</code> role </p> </li> </ul> <p>Admin users have access to the Casa admin console. All users can manage their 2FA credentials, as outlined in the user guide.</p> <p>A user can be \"turned\" into an administrator by editing his profile - in TUI for instance - ensuring <code>CasaAdmin</code> is part of his <code>role</code> attribute.</p>","tags":["Casa","Introduction"]},{"location":"casa/#get-started","title":"Get started","text":"<p>Use the following links to get started with Casa:</p>","tags":["Casa","Introduction"]},{"location":"casa/#admin-guide","title":"Admin Guide","text":"<ul> <li>Quick start</li> <li>Admin console </li> <li>Custom branding </li> <li>FAQs </li> </ul>","tags":["Casa","Introduction"]},{"location":"casa/#user-guide","title":"User Guide","text":"<ul> <li>Home</li> </ul>","tags":["Casa","Introduction"]},{"location":"casa/#developer-guide","title":"Developer guide","text":"<ul> <li>Home</li> <li>Adding authentication methods</li> </ul>","tags":["Casa","Introduction"]},{"location":"casa/user-guide/","title":"Jans Casa User Guide","text":"<p>Jans Casa (\"Casa\") is a self-service web portal for managing account security preferences. The primary use-case for Casa is self-service 2FA, but other use cases and functionalities can be supported via Casa plugins. The options displayed in the user portal will always depend upon which settings have been enabled by the administrator.</p>","tags":["Casa","user guide"]},{"location":"casa/user-guide/#sign-in-for-the-first-time","title":"Sign in for the first time","text":"<p>To log in to Casa, navigate to <code>https://&lt;yourdomain&gt;/jans-casa</code>.</p> <p>If you have an existing account, sign in with your standard username and password.</p>","tags":["Casa","user guide"]},{"location":"casa/user-guide/#credential-dashboard","title":"Credential Dashboard","text":"<p>The credential dashboard displays widgets for each type of supported 2FA credential (e.g. U2F keys, OTP apps, etc.). Each widget includes summary details of enrolled credentials and a button to add / change credentials.</p> <p></p> <p>To manage existing credentials and enroll new credentials, click the <code>Manage</code> button:</p> <p></p>","tags":["Casa","user guide"]},{"location":"casa/user-guide/#2fa-overview","title":"2FA overview","text":"","tags":["Casa","user guide"]},{"location":"casa/user-guide/#turn-2fa-onoff","title":"Turn 2FA on/off","text":"<p>After the minimum number of credentials have been enrolled (as specified by the system admin), 2FA can be turned on by clicking the switch in the Second Factor Authentication widget:</p> <p></p> <p>If the switch is not visible, your administrator may have configured the system so that 2FA is turned on automatically when enough credentials are available.</p> <p>When prompted for 2FA, the specific credential to be prompted first varies depending on the priority of credentials established by the administrator and the user's preferred method, if set.</p> <p>If at any time the credential prompted is unavailable, you have the option to present any other previously enrolled 2FA credential type.</p> <p>To turn off 2FA, click again the switch.</p>","tags":["Casa","user guide"]},{"location":"casa/user-guide/#2fa-settings-and-trusted-devices","title":"2FA settings and trusted devices","text":"<p>If enabled by the system administrator, you can set your own policy for when 2FA is enforced. To manage your settings, after enrolling credentials and turning on 2FA, click the <code>Manage your 2FA settings</code> button in the Preferred Authentication Mechanism widget.</p> <p></p> <p>By default, you will be able to choose from a few 2FA policies:</p> <ul> <li>Always (upon every login attempt)</li> <li>If the location (e.g. city) detected in the login attempt is unrecognized</li> <li>If the device used to login is unrecognized</li> </ul> <p>If you opt for 2FA based on location, device, or both, a new widget will appear to display your trusted devices.</p> <p></p>","tags":["Casa","user guide"]},{"location":"casa/user-guide/#2fa-best-practices","title":"2FA best practices","text":"<p>Depending on the device used to get access, some credentials are more convenient to use than others. For instance, security keys may not be compatible with mobile phones or certain browsers.</p> <p>To reduce the chance of account lockout, enroll at least two different types of 2FA credentials -- e.g. one security key and one OTP app; or one OTP app and one SMS phone number, etc. This way, regardless which device you're using to access a protected resource, you will have a usable option for passing strong authentication.</p>","tags":["Casa","user guide"]},{"location":"casa/user-guide/#2fa-credential-details-enrollment","title":"2FA credential details &amp; enrollment","text":"<p>The details page provides additional information about each enrolled credential, for instance its name and date of enrollment. Nicknames can be edited, credentials can be deleted and new credentials can be enrolled and nicknamed.</p> <p>Depending on administrator configurations, some of the below sections may or may not be available, or sections not listed here may appear.</p> <p>Warning</p> <p>When a credential is deleted, it cannot be recovered. Deleting credentials may result in 2FA being turned off.</p>","tags":["Casa","user guide"]},{"location":"casa/user-guide/#fido-2-security-keys","title":"FIDO 2 security keys","text":"<p>To add a new FIDO 2 credential, navigate to <code>2FA credentials</code> &gt; <code>Security Keys</code>. Insert the fido key and click <code>Ready</code>. Casa will prompt to press the button on the key.</p> <p></p> <p>Add a nickname and click <code>Add</code>. Once added, the new device will appear in a list on the same page. Click the pencil to edit the device's nickname or the trashcan to delete the device.</p> <p></p>","tags":["Casa","user guide"]},{"location":"casa/user-guide/#otp-tokens","title":"OTP Tokens","text":"<p>To add a new OTP token, navigate to <code>2FA credentials</code> &gt; <code>OTP Tokens</code>.</p> <p></p> <p>To add a soft OTP token, choose the <code>Soft token</code> option and follow the on-screen.</p> <p>For a hard token, choose the <code>Hard Token</code> option.</p> <p></p> <p>Add the key associated with the device and the 6 digit code. Add a nickname for the device and click <code>Add</code>.</p> <p>Once it's added, the new device will appear in a list on the same page. Click the pencil to edit the device's nickname or the trashcan to delete the device.</p>","tags":["Casa","user guide"]},{"location":"casa/user-guide/#mobile-phone-numbers","title":"Mobile Phone Numbers","text":"<p>To add a new mobile phone number for one-time passcodes, navigate to <code>2FA credentials</code> &gt; <code>Mobile Phone Numbers</code>.</p> <p></p> <p>Enter a phone number and click 'Send SMS' to get the passcode. Enter the code received, nickname the mobile number, and click <code>Add</code>.</p> <p>Once it's added, the new mobile number will appear in a list on the same page. Click the pencil to edit the mobile number's nickname or the trashcan to delete the mobile number.</p>","tags":["Casa","user guide"]},{"location":"casa/user-guide/#password-reset","title":"Password Reset","text":"<p>If enabled by the system administrator, Casa can also be used to change your password.</p> <p>Navigate to the <code>Password Reset</code> widget. Enter your current and new passwords, then click <code>Change password</code>.</p> <p></p>","tags":["Casa","user guide"]},{"location":"casa/user-guide/#consent-management","title":"Consent Management","text":"<p>If the administrator has enabled the <code>Consent Management</code> plugin, it will appear in the navigation menu for all users.</p> <p>New entries are added automatically whenever the user is prompted for, and authorizes the release of their personal data to an application accessed using their Janssen Server account.</p> <p></p>","tags":["Casa","user guide"]},{"location":"casa/user-guide/#revoking-consent","title":"Revoking consent","text":"<p>When a previously granted consent decision is revoked, the user will be re-prompted to authorize release of their data if/when they attempt to access the application again.</p>","tags":["Casa","user guide"]},{"location":"casa/administration/2fa-basics/","title":"About Two-Factor Authentication (2FA)","text":"<p>Note</p> <p>You can tailor different aspects of 2FA behavior in Casa using the plugin developed for this purpose.</p>","tags":["Casa","2FA","two-factor"]},{"location":"casa/administration/2fa-basics/#availability","title":"Availability","text":"<p>By default, strong (two-factor) authentication will be available to users of Casa once they have added at least two credentials. By requiring users to register two strong credentials, the number of account lockouts that require admin intervention will be greatly reduced. If one credential is lost, there will be at least one fallback mechanism available. Avoiding user lockout is important because it prevents a serious burden for IT administrators.</p> <p>There is no limit to the number of credentials a user can enroll, and credentials do not need to be of the same type: any combination is valid.</p>","tags":["Casa","2FA","two-factor"]},{"location":"casa/administration/2fa-basics/#supported-types-of-2fa","title":"Supported types of 2FA","text":"<p>Users will only be able to add credentials with a type matching one of the already enabled authentication methods in the admin console. Other methods may be supported via plugins.</p>","tags":["Casa","2FA","two-factor"]},{"location":"casa/administration/2fa-basics/#resetting-a-users-2fa-availability","title":"Resetting a user's 2FA availability","text":"<p>In the event a user loses access to his account, admins can revert the user's authentication method to \"password only\" by following the steps shown in the troubleshooting guide.</p>","tags":["Casa","2FA","two-factor"]},{"location":"casa/administration/2fa-basics/#associated-strength-of-credentials","title":"Associated \"strength\" of credentials","text":"<p>When authenticating, a user with 2FA turned on, will be challenged to present the credential having the \"strongest\" authentication method (from his already available enrolled credentials). The relative strength of methods can be assigned in the authentication methods screen of the admin console.</p>","tags":["Casa","2FA","two-factor"]},{"location":"casa/administration/2fa-basics/#forcing-users-to-enroll-a-specific-credential-before-2fa-is-available","title":"Forcing users to enroll a specific credential before 2FA is available","text":"<p>To further reduce the likelihood of lockouts, you can force users to initially enroll, for instance, one OTP credential before any other. OTP credentials are generally more accessible than their counterparts (like Fido) since they normally don't demand special conditions from the device used to access, like having a USB port.</p> <p>To do so, add a property named <code>2fa_requisite</code> to the configuration of the Agama flow that backs the given authentication method, and assign <code>true</code> as its value. You can do this via TUI. Note this mechanism is applicable for the out-of-the-box authentication methods supported by Casa. For other methods contributed via plugins, consult their respective documentation.</p> <p>You can flag more than one method as requisite. In this case users will be encouraged to enroll one credential associated to any of the flagged methods.</p> <p>If a user attempts to delete their only available credential matching the requisite method, a prompt will appear warning that doing so will disable 2FA, that is, resetting to password authentication.</p> <p>If you are a developer coding a plugin that adds an authentication method, you can make the method a requisite by properly implementing method <code>mayBe2faActivationRequisite</code> part of interface <code>AuthnMethod</code>.</p>","tags":["Casa","2FA","two-factor"]},{"location":"casa/administration/2fa-basics/#enrolling-credentials-upon-registration-or-first-login","title":"Enrolling credentials upon registration or first login","text":"<p>If the previous scenario is not enough for your needs, you can force users to enroll credentials and turn 2FA on before the first usage of the application. This can be done in two ways:</p> <ul> <li> <p>Creating a new Agama project that takes charge of credentials enrollment and then reuses the flows bundled with the standard Agama project which performs the actual authentication. Learn more about this in the developer pages</p> </li> <li> <p>Making enrollments occur at registration time (through the application you use for this purpose)</p> </li> </ul>","tags":["Casa","2FA","two-factor"]},{"location":"casa/administration/admin-console/","title":"Admin Console","text":"<p>This document reviews the available options for configuring Casa. All configuration changes applied via the admin console take effect immediately with no restart or other actions required.</p>","tags":["Casa","administration","admin console"]},{"location":"casa/administration/admin-console/#authentication-methods","title":"Authentication methods","text":"<p>Here you can choose the type of 2FA credentials you want to support in Casa. Every authentication method is represented by a widget you can enable or disable. Administrators can arrange widgets according to perceived \"strength\" order, that is, methods considered safer than others can be placed on top of the list. This ordering has two practical consequences:</p> <ul> <li> <p>When a user has 2FA turned on, he will be prompted safer methods first when authenticating. However, if the user has already chosen a preferred method in his dashboard, the prompt favors his choice</p> </li> <li> <p>In the user's dashboard enrolling options are presented following the defined order</p> </li> </ul> <p></p> <p>Widgets shown vary according to plugins installed. In a fresh installation, the following are supported out-of-the-box:</p> <ul> <li>OTP via SMS</li> <li>TOTP/HOTP: mobile OTP apps and hard tokens (cards, key fobs, dongles, etc.)</li> <li>FIDO devices</li> </ul> <p>To add more authentication methods, please check the developer guide.</p>","tags":["Casa","administration","admin console"]},{"location":"casa/administration/admin-console/#password-settings","title":"Password settings","text":"<p>In this section, administrators may configure:</p> <ul> <li>The ability for users to reset their password from inside Casa</li> <li>Apply the rules defined for the <code>userPassword</code> attribute (length and regular expression) in Casa</li> </ul> <p></p>","tags":["Casa","administration","admin console"]},{"location":"casa/administration/admin-console/#reset-to-password-authentication","title":"Reset to password authentication","text":"<p>If a user is locked out for any reason (e.g. lost device, etc.), an admin can navigate to <code>Reset to password authentication</code> in the admin console to turn 2FA off for them. Type the username (or part of) in the text field and then press search. Once the user has been located, click the checkbox and click the <code>Reset to password</code> button. The row will become disabled, and a success message will be displayed.</p> <p></p>","tags":["Casa","administration","admin console"]},{"location":"casa/administration/admin-console/#branding","title":"Branding","text":"<p>Most organizations will want to custom brand Jans Casa. Follow our guide to learn more about custom branding Casa.</p> <p></p>","tags":["Casa","administration","admin console"]},{"location":"casa/administration/admin-console/#plugins","title":"Plugins","text":"<p>Through an easy-to-use screen, administrators can easily manage installed plugins and add new ones.</p>","tags":["Casa","administration","admin console"]},{"location":"casa/administration/admin-console/#logging","title":"Logging","text":"<p>Application logs are useful sources of information to diagnose anomalies and understand possible causes of errors if presented. Casa uses the Log4J2 logging framework for this. The severity level for logs can be modified at runtime and requires no restart. For more information about logging, check the FAQ entry.</p> <p></p>","tags":["Casa","administration","admin console"]},{"location":"casa/administration/admin-console/#cors-domains","title":"CORS domains","text":"<p>If a given plugin exposes one or more web services that are to be consumed from within a web browser, you can whitelist the origin domains from which consumption can takes place.</p>","tags":["Casa","administration","admin console"]},{"location":"casa/administration/admin-console/#2fa-settings","title":"2FA settings","text":"<p>Warning</p> <p>This feature is only if the 2FA settings plugin is installed</p> <p>In the 2FA settings screen, an admin can:</p> <ul> <li>Specify the minimum number of credentials a user must enroll before 2FA can be turned on</li> <li>Determine whether 2FA should be automatically enabled upon credential enrollment</li> <li>Whether users can turn 2FA on and off their own</li> <li>Whether users can choose a preferred authentication method</li> <li>Choose from a few predefined policies for when 2FA should be prompted.</li> </ul> <p></p> <p>To reduce the chance of lockouts, we recommend setting a minimum of two (2) strong credentials.</p> <p>Predefined 2FA policy options include:</p> <ul> <li>Enforce strong authentication for every login attempt</li> <li>Prompt for 2FA when users' location is unrecognized</li> <li>Prompt for 2FA when users' device is unrecognized</li> <li>Allow the user to set their own strong authentication policy</li> </ul> <p>The default policy is to enforce 2FA for every login attempt. If the admin opts to allow users to manager their own policy, a new widget will appear in the user-facing dashboard as described in the user guide.</p> <p>In addition, the plugin exposes an API to programmatically manipulate these settings.</p>","tags":["Casa","administration","admin console"]},{"location":"casa/administration/change-context-path/","title":"Change Application Context Path","text":"<p>To publish the application at a location other than <code>/casa</code>, do the following:</p> <ol> <li> <p>Log into Janssen Server using SSH       </p> </li> <li> <p>Edit tag <code>&lt;Set name=\"contextPath\"&gt;</code> in file     <code>/opt/jans/jetty/jans-casa/webapps/jans-casa.xml</code> with the new path you want     to use. For example, if you chose <code>/creds</code>, you would do the following:    </p> <pre><code>  &lt;Set name=\"contextPath\"&gt;/creds&lt;/Set&gt;     \n</code></pre> </li> <li> <p>Edit tag <code>&lt;Set name=\"contextPath\"&gt;</code> in file     <code>/opt/jans/jetty/jans-casa/webapps/jans-casa_web_resources.xml</code>     appropriately with the new path you want to use.</p> </li> <li> <p>Adjust Apache's .conf file:    </p> <ul> <li> <p>Locate the <code>https_jans.conf</code> file. The exact location will vary depending on your distribution. In Ubuntu, for example, you can find it at <code>/etc/apache2/sites-available</code></p> </li> <li> <p>Find the section starting with <code>&lt;Location /casa&gt;</code> and replace the 2 occurrences of <code>casa</code> with the path of your choice. Do not use trailing slashes   </p> </li> <li> <p>Add the following directive: <code>Redirect /casa /&lt;new-context-path&gt;</code> before all <code>&lt;Location&gt;</code> and <code>&lt;Proxy&gt;</code> sections</p> </li> </ul> </li> <li> <p>Wait for around 1 minute (so the server picks the script changes), then restart Casa and Apache services. Use this page as a guide</p> </li> <li> <p>The application should be accessible now at the new URL.</p> </li> </ol>","tags":["Casa","administration","context path"]},{"location":"casa/administration/custom-branding/","title":"Custom branding","text":"<p>In Casa, administrators can supply their own logo and favicon to better match the organization's look and feel. If you want to apply more advanced customizations, adding the custom branding plugin is the way to go.</p> <p>Note</p> <p>This page covers customizations available through the custom branding plugin. It is assumed you have already added it to your Casa installation.</p> <p>The plugin allows administrators to easily alter the appearance of Casa. There are two ways to tweak the design: a quick point-and-click set of changes that you can preview immediately, or a lower-level approach that allows you to supply your own CSS file and images (this is known as external assets directory usage).</p>","tags":["Casa","administration","custom branding","brand"]},{"location":"casa/administration/custom-branding/#quick-design-customization","title":"Quick design customization","text":"<p>Click on <code>Custom branding</code> in the admin console, and choose <code>Upload images and pick colors</code>. With this branding alternative, you can apply some visual changes effortlessly with zero CSS coding. You can:</p> <ul> <li>Supply your company logo and favicon</li> <li>Choose the background color for the page header</li> <li>Choose button colors</li> <li>Edit the footer text</li> </ul> <p></p> <p>Once you supply your files, color values, and footer text, click on <code>Save</code> and see the changes take immediately by navigating to a different page or opening a new browser tab. Repeat the process till you get the combination that best matches your organization's look and feel.</p> <p>With \"Primary buttons\" we refer to the vast majority of buttons that trigger some action such as saving, updating or accepting - whether in the user pages or the admin UI itself. \"Cancel\" covers undo, close or cancel, while \"Misc\" is for anything not fitting any of the previous usages.</p> <p>You can choose \"Use defaults\" if you feel comfortable with the Bootstrap-like colors offered in Jans Casa.</p>","tags":["Casa","administration","custom branding","brand"]},{"location":"casa/administration/custom-branding/#using-the-external-assets-directory","title":"Using the external assets directory","text":"<p>Note</p> <p>Intermediate-level knowledge of CSS is required for this task.</p>","tags":["Casa","administration","custom branding","brand"]},{"location":"casa/administration/custom-branding/#background","title":"Background","text":"<p>Casa's UI design is driven by one CSS stylesheet and a few images. Specifically, Casa leverages the following UI frameworks:</p> <ul> <li>ZK</li> <li>Tachyons 4.11</li> <li>Font Awesome 5.12</li> </ul> <p>Particularly, ZK's default theme CSS file was disabled to offer a higher degree of flexibility in design. This enables Tachyons to claim control over style rules applied to HTML markup.</p>","tags":["Casa","administration","custom branding","brand"]},{"location":"casa/administration/custom-branding/#external-assets-directory","title":"External assets directory","text":"<p>In the <code>/opt/jans/jetty/casa/static</code> folder, you can place your own version of the main stylesheet and images Casa uses. No other stylesheet should be overriden.</p> <p>To start, log in to the Janssen Server and do the following:</p> <pre><code>cd /opt/jans/jetty/jans-casa/static\njar -xf ../webapps/jans-casa.war images styles/gluu/style.css  \n</code></pre> <p>This will copy the files you can edit later (these are the original versions provided out of the box in Casa).</p> <p>If you place additional files in this directory, ensure ownership is set to recursive. For instance, you can:</p> <pre><code>$ chown -R jetty:jetty /opt/jans/jetty/jans-casa/static/\n</code></pre>","tags":["Casa","administration","custom branding","brand"]},{"location":"casa/administration/custom-branding/#enable-and-apply-your-customizations","title":"Enable and apply your customizations","text":"<p>In the admin console, navigate to <code>Custom branding</code> &gt; <code>Use Casa external assets directory</code>. From that point on, your installation is reading relevant files from the <code>static</code> directory.</p> <p>Note</p> <p>In CSS, the rules' order of appearance is important. For all Casa pages, style.css is loaded first, then tachyons.css. This means rules for Tachyons have higher priority unless <code>!important</code> is used.</p> <p>The main stylesheet (<code>style.css</code>) is located at <code>/opt/jans/jetty/jans-casa/static/styles/gluu</code> if you have followed the instructions above.</p> <p>Here are some tips for applying your customizations:</p> <ul> <li> <p>Get acquainted with functional CSS. This is the approach followed in Casa. Here, here, and here you can find useful introductory material.</p> </li> <li> <p>Inspect the DOM tree generated for application pages and determine the CSS selectors you need to edit or things you have to add in order to alter the appearance. Use your web browser's facilities to inspect web page composition: this is usually part of any browser's developer toolbar. Moreover, they allow you to change styles on the fly so you can play a lot before applying the real changes.</p> </li> <li> <p>Don't override rules that are already defined in Tachyons. Conversely, ZK rules (which are prefixed with <code>z-</code>) are safe to be re-defined since ZK CSS isn't included.</p> </li> <li> <p>In most circumstances, your work will come down to editing existing rules in <code>style.css</code>. HTML markup will show rules (in the <code>class</code> attribute) prefixed with <code>cust-</code> that are apparently not defined anywhere. These rules are intended to give admins the opportunity to add their design tastes. The following is a list of custom selectors you can add to <code>style.css</code>. Names are in general self-explanatory, the images below help clarify more.</p> <ul> <li>cust-menu-item  </li> <li>cust-content-heading  </li> <li>cust-sections-wrapper  </li> <li>cust-section  </li> <li>cust-panel  </li> <li>cust-modal-window  </li> <li>cust-edit-button  </li> <li>cust-link-button  </li> <li>cust-delete-button  </li> <li>cust-primary-button  </li> <li>cust-cancel-button  </li> <li>cust-misc-button  </li> <li>cust-text-input  </li> <li>cust-progress-bar  </li> </ul> </li> </ul> <p></p> <p></p>","tags":["Casa","administration","custom branding","brand"]},{"location":"casa/administration/custom-branding/#viewing-your-changes","title":"Viewing your changes","text":"<p>There is no need to restart the application for the changes to take effect. However, most static files are cached by browsers, so you will need to open a fresh private browsing (incognito) session.</p> <p>If you tried the above and still don't see changes, try hitting the resource URL directly in a new browser tab. For example, to load the <code>style.css</code> file in your browser, visit <code>https://&lt;host-name&gt;/casa/custom/styles/gluu/style.css</code>. That way, you can determine if your changes are there.</p>","tags":["Casa","administration","custom branding","brand"]},{"location":"casa/administration/custom-branding/#reverting-to-default-theme","title":"Reverting to Default Theme","text":"<p>If for any reason you wish to restore the default theme, select \"Use default (Gluu Inc.) theme\" in the admin dashboard.</p>","tags":["Casa","administration","custom branding","brand"]},{"location":"casa/administration/custom-branding/#examples","title":"Examples","text":"<p>Here are solutions for common use cases:</p>","tags":["Casa","administration","custom branding","brand"]},{"location":"casa/administration/custom-branding/#use-a-different-logo","title":"Use a different logo","text":"<p>Just replace <code>images/logo.png</code> (relative to the <code>static</code> directory) with your own image.</p>","tags":["Casa","administration","custom branding","brand"]},{"location":"casa/administration/custom-branding/#use-a-different-favicon","title":"Use a Different Favicon","text":"<p>Replace <code>images/favicon.ico</code> with your own image.</p>","tags":["Casa","administration","custom branding","brand"]},{"location":"casa/administration/custom-branding/#change-the-font-used-in-text","title":"Change the Font Used in Text","text":"<p>The vast majority of text that appears in the application uses the same font. To set the default font, locate at the bottom of <code>style.css</code> a declaration like <code>@import url('https://fonts.googleapis.com...</code> and point to one of your choosing. Check out this page to learn more about Google fonts.</p> <p>Then, scroll down and modify the <code>html</code> and <code>body</code> selectors appropriately with the font you picked.</p> <p>If you want to use your own fonts instead of Google's, you can use <code>@font-face</code> for this purpose. Copy your <code>ttf</code>, <code>woff</code>, <code>svg</code> or <code>eot</code> files somewhere in the <code>static</code> directory and link them appropriately.</p> <p>To use the more classical fonts like \"Helvetica\", \"Arial\", etc., simply update <code>html</code> and <code>body</code> selectors passing the <code>font-family</code> name.</p>","tags":["Casa","administration","custom branding","brand"]},{"location":"casa/administration/faq/","title":"Frequently Asked Questions","text":"","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#common-administrative-tasks","title":"Common administrative tasks","text":"","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#where-are-the-logs","title":"Where are the logs?","text":"<p>The application logs are located at <code>/opt/jans/jetty/jans-casa/logs</code>. By default, Casa uses the INFO level for messages. You can change the log level at will using the app's admin UI.</p>","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#how-do-i-custom-brand-casa","title":"How do I custom brand Casa?","text":"<p>We have a dedicated page covering the topic of custom branding here.</p>","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#what-ports-are-used-by-the-application","title":"What ports are used by the application?","text":"<p>Casa uses port <code>8080</code>. One way to see if the app is up and running is by checking whether this port is open by issuing a command like <code>netstat -nltp</code>.</p>","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#how-to-turn-2fa-off-for-a-user","title":"How to turn 2FA off for a user?","text":"<p>If a user has been locked out for any reason (e.g. lost devices), you can reset his \"authentication method\" to password by accessing the admin console and choosing the menu item labelled \"Reset users preference\". Type the username (or part of) in the text field and then press search. Once you locate the user in the result grid, click the corresponding row and then hit \"Change to password\". The row will become disabled, and you'll see a success message.</p> <p>If you've followed the steps as described above, next time he attempts to log in, he won't be asked to present any credentials other than password to enter.</p>","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#how-to-adjust-the-issuer-for-otp-tokens","title":"How to adjust the issuer for OTP tokens","text":"<p>When people add OTP mobile apps, the enrollment appears in the device associated with an \"issuer\", so it is easy to recognize where the OTPs generated can be used. To keep track of which OTPs are valid for which IDPs, the issuer property can be adjusted in flow <code>io.jans.casa.authn.otp</code> part of Casa Agama project - you can use TUI for this purpose. For example, you might want to set the <code>issuer</code> property to <code>ACME Dev</code> on your dev server, and <code>ACME, Inc.</code> on your production server.</p>","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#errors-shown-in-the-ui","title":"Errors shown in the UI","text":"","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#a-page-with-a-service-temporarily-unavailable-message-appears-when-accessing-the-application","title":"A page with a \"Service Temporarily Unavailable\" message appears when accessing the application","text":"<p>This is the 503 HTTP error. There is an Apache server in front of the application and this means the reverse proxy couldn't establish a communication internally with the app. This usually happens when Casa hasn't started completely, so it's usually a matter of waiting a few seconds.</p>","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#an-unauthorized-access-error-is-shown-when-accessing-the-application","title":"An \"Unauthorized access\" error is shown when accessing the application","text":"<p>This is caused by an unauthorized access attempt (e.g. users requesting URLs without ever logging in or after session has expired).</p>","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#an-error-occurred-casa-did-not-start-properly-is-shown-when-accessing-the-application","title":"\"An error occurred: Casa did not start properly\" is shown when accessing the application","text":"<p>This occurs whenever the application failed to start successfully. Check the log to diagnose the problem. Try to find a message like \"WEBAPP INITIALIZATION FAILED\" and see the traces above it. Often, error messages are self-explanatory.</p> <p>Once fixed, please restart the application. You will have to see a \"WEBAPP INITIALIZED SUCCESSFULLY\" message to know that it's working.</p>","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#miscellanenous","title":"Miscellanenous","text":"","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#admin-console-is-not-shown","title":"Admin console is not shown","text":"<p>If you have logged in using an administrative account and cannot find any admin features in the UI ensure you have gone through these steps.</p>","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#a-previously-enabled-method-is-not-available-anymore","title":"A previously enabled method is not available anymore","text":"<p>Check if the plugin that contributed the given authentication method was removed. The out-of-the-box methods will always appear listed.</p>","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#what-kind-of-totphotp-devices-are-supported","title":"What kind of TOTP/HOTP devices are supported?","text":"<p>Both soft (mobile apps) or hard tokens (keyfobs, cards, etc.) are supported. Supported algorithms are <code>HmacSHA1</code>, <code>HmacSHA256</code>, and <code>HmacSHA512</code>.</p>","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#authentication-fails-when-using-totp-or-hotp-with-no-apparent-reason","title":"Authentication fails when using TOTP or HOTP with no apparent reason","text":"<p>For Time-based OTP, ensure the time of your server is correctly synchronized (use NTP for instance). The time lag of the authentication device used (for instance, a mobile phone) versus server time should not be significant.</p> <p>Big time differences can cause unsuccessful attempts to enroll TOTP credentials in Casa.</p> <p>For Event-based OTP (HOTP), ensure you are using a suitable value for <code>look ahead window</code> (we suggest at least 10). Check the configuration of flow <code>io.jans.casa.authn.otp</code> part of Casa Agama project - you can use TUI for this purpose.</p>","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#the-user-interface-is-not-showing-any-means-to-enroll-credentials","title":"The user interface is not showing any means to enroll credentials","text":"<p>In the administration console, ensure one or more authentication methods have been enabled.</p>","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#a-user-cannot-turn-2fa-on","title":"A user cannot turn 2FA on","text":"<p>To turn 2FA on, the user has to have enrolled at least a certain number of credentials through the app. Only after this is met, he will be able to perform this action.</p> <p>In the administration console you can specify the minimum number of enrolled credentials needed to enable second factor authentication for users. Please check the 2FA Settings plugin for more details.</p>","tags":["Casa","administration","faq"]},{"location":"casa/administration/faq/#my-problem-is-not-listed-here","title":"My problem is not listed here","text":"<p>Feel free to ask Janssen Server community.</p>","tags":["Casa","administration","faq"]},{"location":"casa/administration/localization/","title":"Casa localization","text":"<p>Casa supports multilingual support through resource bundles. Administrators supply bundles as plaintext files ending with the <code>.properties</code> file extension.</p> <p>By default, Casa contains three bundles, each in a separate file. These bundles contain the internationalization labels in the English language, as displayed in a default Casa installation. For example, to add support for French, you would have to create the following files:</p> File Description <code>user_fr.properties</code> Contains labels mostly found in user-facing pages <code>admin_fr.properties</code> Contains labels mostly found in administrator-facing pages <code>general_fr.properties</code> Contains labels found widely across the app and plugins","tags":["Casa","administration","localization"]},{"location":"casa/administration/localization/#adding-internationalization-labels","title":"Adding internationalization labels","text":"<p>To supply labels in a particular language (or even if you want to override the English translation provided), do the following:</p> <ol> <li>Log in to the Janssen Server using SSH</li> <li>Extract the Casa default labels: <code>/opt/jre/bin/jar -xf /opt/jans/jetty/jans-casa/webapps/casa.war WEB-INF/classes/labels</code></li> <li>Run <code>cp WEB-INF/classes/labels/*.properties .</code> and delete WEB-INF dir: <code>rm -R WEB-INF/</code></li> <li>Add the appropriate suffix to the properties files found in the current directory, ie. <code>_de</code> for German, <code>_es</code> for Spanish, <code>_ja</code> for Japanese, etc.</li> <li>Edit the contents of files accordingly. Use UTF-8 encoding for opening and saving</li> <li><code>cd</code> to <code>/opt/jans/jetty/jans-casa/static</code></li> <li>Create directory <code>i18n</code> if it does not exist: <code>mkdir i18n</code></li> <li>Transfer the properties files to the <code>i18n</code> folder</li> <li>Ensure <code>jetty</code> user has permission for reading the files</li> <li>Restart casa</li> </ol> <p>Log in to the application and review your work. Make necessary edits and repeat the process.</p>","tags":["Casa","administration","localization"]},{"location":"casa/administration/localization/#how-are-labels-picked","title":"How are labels picked?","text":"<p>In Casa, the rule for displaying contents is leveraged from the underlying framework. In short, the locale to use per session is picked based on the end-user browser settings.</p> <p>As an example, if the browser was configured to use U.S. English, the locale will be <code>en_US</code>. This means that files ending in  <code>_en_US.properties</code> will be considered first. Then, the country suffix is removed and thus <code>_en.properties</code> is looked up. Finally the non-suffixed ones are considered, that is, the default label files bundled with Casa.</p> <p>Additionally, end users can pick the language of their preference by selecting a language item from the dropdown list appearing at the bottom of any Casa page. The list is only shown if there are two or more languages available to display.</p>","tags":["Casa","administration","localization"]},{"location":"casa/administration/localization/#localization-in-plugins","title":"Localization in plugins","text":"<p>Plugins also support localization through the \"zk-label\" bundle. If you have installed plugins developed by Gluu, they will only contain a single default English file.</p> <p>To add your own translation for plugin texts, proceed as follows:</p> <ol> <li><code>cd</code> to the folder where you stored the jar file of the plugin of interest.</li> <li>Extract the plugin's default labels (requires Java bin on your path): <code>jar -xf JAR_FILE labels/zk-label.properties</code></li> <li><code>cd</code> to <code>labels</code> folder</li> <li>Add the appropriate suffix to the properties file, ie. <code>_de</code> for German, <code>_es</code> for Spanish, <code>_ja</code> for Japanese, etc.</li> <li>Edit the contents accordingly. Use UTF-8 encoding for opening and saving</li> <li>Connect to your Janssen Server using SSH</li> <li><code>cd</code> to <code>/opt/jans/jetty/jans-casa/static</code></li> <li>Create directory <code>i18n</code> if it does not exist: <code>mkdir i18n</code></li> <li>Transfer the properties file to the <code>i18n</code> folder</li> <li>Ensure <code>jetty</code> user has permission for reading</li> <li>Restart casa</li> </ol> <p>Note</p> <p>If your plugins have a <code>zk-label.properties</code>, you can accumulate all plugin texts into a single file, or you can use a different filename for each plugin.</p>","tags":["Casa","administration","localization"]},{"location":"casa/administration/localization/#properties-file-syntax","title":"Properties file syntax","text":"<p>Administrators acquainted with the format used for properties files in Java will find Casa resource bundle files familiar. The format used in Casa differs slightly, but it is more powerful. To learn more about this topic, visit this page.</p>","tags":["Casa","administration","localization"]},{"location":"casa/administration/localization/#tips","title":"Tips","text":"<ul> <li> <p>Not all entries present in default label files have to be translated in your own localized versions. If you are comfortable with the current text for a particular entry, you can simply remove it to use the one in the default files.</p> </li> <li> <p>There is no need to supply specific translations for countries. While supported, most of time it suffices to create files suffixed with the language code, for instance <code>_es</code>, and not with country code (e.g <code>_es_CO</code>, <code>_es_AR</code>, <code>_es_EC</code>, <code>_es_ES</code>, etc.) </p> </li> <li> <p>Actual filenames for properties files are not relevant. Upon start, Casa will parse all properties files present in <code>i18n</code> folder.</p> </li> </ul>","tags":["Casa","administration","localization"]},{"location":"casa/administration/quick-start/","title":"Jans Casa Quick Start Guide","text":"<p>Note</p> <p>This document is intended for administrators only. Learn here how to \"grant\" administrative privileges for Casa.</p> <p>Use this guide to install and configure your Casa deployment.</p>","tags":["Casa","quick start"]},{"location":"casa/administration/quick-start/#installation","title":"Installation","text":"<p>Jans Casa can be used with Janssen Server or Gluu Flex Server. At installation time (applies to any of these two products), you will be prompted if you desire to include Casa. If you want to add Casa post-installation, you will simply have to re-run the installer and ensure to select Casa.</p>","tags":["Casa","quick start"]},{"location":"casa/administration/quick-start/#configuration","title":"Configuration","text":"","tags":["Casa","quick start"]},{"location":"casa/administration/quick-start/#enable-authentication-methods","title":"Enable authentication methods","text":"<p>The \"out-of-the-box\" login experience in Casa consists of the usual username and password prompt. To start leveraging a stronger authentication login to Casa with an administrative account (visit <code>https://&lt;your-server-name&gt;/jans-casa</code>) and activate the methods you want to offer Casa users.</p> <p>Important: usage of OTP via SMS requires the setup of a Twilio account and populating configuration properties of flow <code>io.jans.casa.authn.twilio_sms</code> found in Casa Agama project. You can do the latter via TUI. We encourage you to use the online Twilio testing tools beforehand to ensure you can send SMS to the countries you are targetting.</p>","tags":["Casa","quick start"]},{"location":"casa/administration/quick-start/#add-the-strong-authentication-settings-plugin","title":"Add the strong authentication settings plugin","text":"<p>This step is optional. Check this page for more information. Use this plugin if you need to exercise an advanced control on how 2FA behaves in your Casa deployment.</p>","tags":["Casa","quick start"]},{"location":"casa/administration/quick-start/#test-enrollment-and-2fa","title":"Test enrollment and 2FA","text":"<p>Do the following steps using a testing account with no administrative privileges:</p> <ul> <li>Login to Casa. Only username and password should be prompted</li> <li>Use the menu on the left to access the screens from which enrollment of credentials can be performed</li> <li>Ensure at least two credentials have been added. In the home page, turn on 2FA </li> <li>Log off and log back in. From now on, besides username and password, one credential has to be presented to get access</li> </ul> <p>Click here to learn more about 2FA in Casa.</p>","tags":["Casa","quick start"]},{"location":"casa/administration/quick-start/#finish-configuration","title":"Finish configuration","text":"<p>Once you are done with testing, you may use casa as the default authentication method of Janssen Server using TUI  to log in users via Casa for all applications the server protects.</p> <p>Finally, as a security measure you can thoroughly disable access to the administrative console of Casa by following the steps below:</p> <ol> <li>Connect to your server</li> <li>Navigate to <code>/opt/jans/jetty/jans-casa</code></li> <li>remove file <code>.administrable</code> (ie. <code>rm .administrable</code>)</li> </ol> <p>If you want to make the admin console available again you need to recreate the marker file:</p> <ol> <li>Create an empty file (eg. <code>touch .administrable</code>)</li> <li>Run <code>chown casa:casa .administrable</code> (do this only if you are on FIPS environment)</li> <li>Logout in case you have an open browser session, and login again</li> </ol> <p>Note</p> <p>In cloud-native setup, the admin console can be enabled/disabled by changing the value of <code>casa.adminEnabled</code> attribute in <code>values.yaml</code> file (and run <code>helm install</code> or <code>helm upgrade</code>). See examples below:</p> <ol> <li> <p>For the vanilla Janssen chart:</p> <pre><code>global:\n  casa:\n    # admin console is enabled by default; set the value to false to disable the console\n    adminEnabled: true\n</code></pre> </li> <li> <p>For the all-in-one Janssen chart:</p> <pre><code>casa:\n  # admin console is enabled by default; set the value to false to disable the console\n  adminEnabled: true\n</code></pre> </li> </ol>","tags":["Casa","quick start"]},{"location":"casa/administration/quick-start/#check-out-available-plugins","title":"Check out available plugins","text":"<p>Browse our catalog of plugins to add features and expand Casa!.</p>","tags":["Casa","quick start"]},{"location":"casa/developer/add-authn-methods/","title":"Onboarding custom authentication methods","text":"<p>Out-of-the-box Casa supports some useful authentication methods for a secure, pleasant authentication experience. Adding more authentication mechanisms is possible and requires certain development effort. In this guide we summarize the steps required to do so and give you some useful pointers to start your coding journey.</p> <p>Supporting a new authentication mechanisms consists of two tasks: coding an Agama flow and creating a plugin that contributes an authentication method. The former has to do with the authentication flow the user experiences (to access Casa or other apps), while the latter with the credential enrollment process.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/add-authn-methods/#agama-flow","title":"Agama flow","text":"<p>Note</p> <p>Acquaintance with Agama framework and Agama project management is required</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/add-authn-methods/#about-casa-authentication-flow","title":"About Casa authentication flow","text":"<p>Authentication in Casa is implemented through an Agama project called casa - in TUI you can see it listed in the Agama management screen. As a first step, the user is requested to enter the username and password combination, then depending on how the application is configured, personal user settings,  and access policies defined, a second factor may be requested.</p> <p>The casa project allows to onboard new types of second factors (authentication mechanisms) and also provides a user experience that supports backtracking: if a user is asked to present a specific credential and that credential is not currently available or is not working, he can choose an alternative method for authentication where a different type of credential will be prompted. Users can backtrack several times.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/add-authn-methods/#flow-requisites","title":"Flow requisites","text":"<p>To code the flow corresponding to the authentication method to add, you can use the Agama project found  here as a canvas. Ensure the following conditions are met so that it properly integrates in the main Casa flow:</p> <p>The flow will be passed an Agama map containing information of the person attempting the authentication. This input parameter will contain at least three keys: <code>uid</code>, <code>inum</code>, and <code>name</code>. <code>uid</code> and <code>inum</code> map directly to attributes stored in the user's profile and are never empty, <code>name</code> is a displayable name which may come from attribute <code>givenName</code> or <code>displayName</code>. All values are strings.</p> <p>The flow should terminate with a <code>true</code> outcome if the user successfully passes the challenge, presents the expected credential, etc. In any other case, <code>false</code> must be returned and an optional error message can be included for the caller flow (<code>io.jans.casa.authn.main</code>) to show it in the screen. Any additional data attached in the <code>Finish</code> instruction will not be processed.</p> <p>If for some reason your flow crashes, the corresponding exception will be printed to the logs, the caller will continue running, and the browser taken to the selector page where an error message will be displayed.</p> <p>Note your project may contain more flows to serve as utilitarians or simply to break down the authentication flow into smaller, more manageable pieces.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/add-authn-methods/#about-templates","title":"About templates","text":"<p>Regarding UI templates, it is recommended to re-use a couple of Freemarker macros available in the casa project. This will allow your flow's UI to have the same look-and-feel of flows bundled out-of-the box, like OTP and fido. Additionally this will allow to properly incorporate backtracking. Import the <code>commons</code> template in your UI page:</p> <pre><code>&lt;#import \"../kz1vc3/commons.ftlh\" as com&gt;\n</code></pre> <p>Copy the above line of code in the first line of your templates, preferably. Note you may need to add extra <code>../</code> fragments in the path to <code>commons.ftlh</code> depending on the directory level where your template resides inside the <code>web</code> subdirectory of your Agama project.</p> <p>Then call the <code>main</code> macro and supply your markup, like this:</p> <pre><code>&lt;@com.main&gt;\n    &lt;!-- your markup here --&gt;\n&lt;@com.main&gt;\n</code></pre> <p>The above will generate a page incorporating the required CSS files and will render the header and footer appropriately while leaving your content in the center of the page. The casa project makes heavy use the Tachyons CSS. You may like to use those for building templates instead of incorporating yet another styling framework.</p> <p>It is highly recommended to include the following near the bottom of your markup (still inside the <code>main</code> call block):</p> <pre><code>&lt;@com.alternative /&gt;\n</code></pre> <p>This will render a form with a text and a link that will allow users to \"escape\" from your flow and take another route, i.e. to backtrack:</p> <p></p> <p>Then, in your flow's code, you handle the escape this way:</p> <pre><code>data = RRF \"mytemplate.ftlh\" ...\n\nWhen data.skipped is \"\"\n    Finish false\n</code></pre> <p>The above means your flow can finish with <code>false</code> not only if the authentication did not succeed but also when users wants to backtrack.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/add-authn-methods/#the-selector-page","title":"The selector page","text":"<p>When backtracking, a selector page is shown where all available methods for the given user are displayed - sorted by strength. From here, the user can take another route to be challenged for an alternative credential.</p> <p></p> <p>Every element in the list has an icon and descriptive text associated. These elements are configurable and for the case of adding an authentication method, both icon and text should be supplied. To do so, locate in TUI the casa Agama project. See how the flow <code>io.jans.casa.authn.main</code> has a <code>selector</code> section in its configurations. This is a dictionary (JSON object) where keys are qualified names of flows and values are dictionaries at the same time - this where you can provide the required info.</p> <p>For example, if your authentication method is backed by a flow <code>com.acme.authn.food</code>, the casa project configuration may look like</p> <pre><code>{\n    \"io.jans.casa.authn.main\": {\n        \"selector\": {\n            \"com.acme.authn.food\": {\n                \"icon\": \"&lt;i class='fas fa-pizza-slice'&gt;&lt;/i&gt;\",\n                \"text\": \"A sentence describing what the user is supposed to present in the next screen\"\n            },\n            ...\n        }\n    },\n    ...\n}\n</code></pre> <p>Alternatively, a pointer to a localized message can be used instead of <code>text</code>. This is the recommended practice if localization/internationalization is relevant. In this case, something like the below will work:</p> <pre><code>            ...\n            \"com.acme.authn.food\": {\n                \"icon\": \"&lt;i class='fas fa-pizza-slice'&gt;&lt;/i&gt;\",\n                \"textKey\": \"foodAuth.methodTitle\"\n            }\n            ...\n</code></pre> <p>as long as the message key <code>foodAuth.methodTitle</code> is defined in the project's <code>labels.txt</code> file, or elsewhere in another project. Note <code>textKey</code> takes precedence over <code>text</code> when rendering the page.</p> <p>Both <code>icon</code> and <code>textKey</code> (or <code>text</code>) may contain HTML markup. In this example we are using the font awesome library available in the selector page for rendering a nice icon but we could have used any other thing here like an <code>img</code> tag, for instance.</p> <p>Ensure to properly escape double quotes if necessary. Also make the markup a one-liner: JSON strings cannot span several lines.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/add-authn-methods/#recommended-practices","title":"Recommended practices","text":"<p>Note</p> <p>Ensure to go through this page before proceeding</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/add-authn-methods/#config-settings","title":"Config settings","text":"<p>Use a single place to store configuration settings for your authentication method. The most convenient place is in the Agama project itself. You may have configs associated to each flow in your project and they can be accessed directly in your flows code. Additionally, they can be easily read from your plugin's Java code this way:</p> <pre><code>ips = io.jans.casa.misc.Utils.managedBean(IPersistenceService.class);\nJSONObject p = ips.getAgamaFlowConfigProperties(\"flow qname\");\n</code></pre> <p>Out-of-the-box methods in Casa employ this strategy. Also when you do this, every time a change in project configuration is detected, your Java code gets notified: a call to method <code>reloadConfiguration</code> of your extension is issued, see class <code>SampleCredentialAuthnMethod</code> in the sample credential plugin.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/add-authn-methods/#retries","title":"Retries","text":"<p>Giving the user only one chance to pass an authentication challenge is unfair. Code your flow so users have a couple of opportunities to fail before finishing with <code>false</code> as outcome. Agama's <code>Repeat</code> directive helps you cover this case.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/add-authn-methods/#key-questions","title":"Key questions","text":"<p>As you try to assemble your project, you will come up with some design decisions, for instance:</p> <ul> <li>How to model and store credentials associated to the authentication method? </li> <li>What kind of parameters are relevant for the authentication method?</li> <li>What's the algorithm for authenticating users once they have supplied a valid username/password combination?</li> </ul> <p>Depending on the answers, you may like to start instead with plugin development first. This is not always the case though, however, getting your hands on the plugin might help unclutter the path.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/add-authn-methods/#enrollment-plugin","title":"Enrollment plugin","text":"<p>Coding a Casa plugin is mainly a Java development task. You can use the \"Sample credential\" plugin as a template to start the work. Ensure you have:</p> <ul> <li> <p>A Jans Server installation that includes Jans Casa - prefer a VM environment over the CN edition for development purposes. Also, you'll need a way to connect to your server via SSH</p> </li> <li> <p>A copy of the Jans repository (a shallow clone of <code>main</code> branch is OK): https://github.com/JanssenProject/jans</p> </li> </ul>","tags":["Casa","developer guide"]},{"location":"casa/developer/add-authn-methods/#plugin-deployment","title":"Plugin deployment","text":"<p>Start with deploying the plugin to get acquainted with the process:</p> <ol> <li>In the local development machine, <code>cd</code> to <code>./jans/jans-casa/plugins/samples/sample-cred</code></li> <li>Run <code>mvn -Dmaven.test.skip package</code>. This may take several minutes (lots of network requests). Once you get it done, the next time you can add the <code>-o</code> switch (offline mode) for faster results</li> <li>A <code>target</code> folder with a couple of jar files in it will be generated</li> </ol> <p>Access Casa admin console and in the plugins page, upload the file suffixed with <code>jar-with-dependencies.jar</code>. After one minute approximately, visit the \"Authentication methods\" page, check the \"Favorite color\" widget, and click on \"Save\". Then logout.</p> <p>Login again, this time with a non administrative account. In the landing page (user's dashboard), an item labeled \"Your favorite color\" will be shown on the left (under the \"2FA credentials\" heading). Also, a panel in the central area of the page will be added in accordance.</p> <p>Click on \"Your favorite color\" and you'll land a page to let Casa know what your favorite color is!. This color will be used as a second factor for authentication. Ensure you have enabled another method such as OTP so you can enroll an additional credential in order to be able to active 2FA for this account.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/add-authn-methods/#study-the-sample-project","title":"Study the sample project","text":"<p>Now it's time for you to go through the project folder checking one file at a time. Most of files contain comments that explain the purpose of things.</p> <p>Ensure you make a deep inspection of file <code>./src/main/resources/assets/user/cred_details.zul</code>. It contains the markup of the page you visited earlier.</p> <p>Make an excursion to interface <code>AuthnMethod</code> found in <code>shared</code> maven module. Note it brings a couple of default methods. Class <code>SampleCredentialAuthnMethod</code> implements this interface.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/add-authn-methods/#editing-the-project","title":"Editing the project","text":"<p>Modifying the project may require you to edit files mainly with <code>.java</code>, <code>.zul</code>, or <code>.properties</code> extensions. Most Java classes used in this plugin can be found in:</p> <ul> <li>The repository you cloned earlier</li> <li>The ZK framework documentation</li> <li>Standard Java SE API docs</li> </ul> <p>You can remove the plugin and add it as many times as you like - no restarts are needed unless things go really weird. You can do so either via the admin console or by dropping/removing the file directly in the filesystem (the path is <code>/opt/jans/jetty/jans-casa/plugins</code>).</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/add-authn-methods/#page-tweaks","title":"Page tweaks","text":"<p>If you alter a <code>.zul</code> file and then package and redeploy the plugin, you will most probably not see any change taking effect in the UI page. This is because the ZK framework caches the <code>.zul</code> pages by default for a very long period. To change this behavior do the following:</p> <ol> <li>Connect to your VM and <code>cd</code> to <code>/opt/gluu/jetty/jans-casa/webapps</code></li> <li>Extract ZK descriptor:      <pre><code># jar -xf jans-casa.war WEB-INF/zk.xml\n</code></pre></li> <li>Locate XML tag <code>file-check-period</code> and remove it including its surrounding parent <code>desktop-config</code></li> <li>Save the file and patch the application war:     <pre><code># jar -uf jans-casa.war WEB-INF/zk.xml\n</code></pre></li> <li>Restart casa (e.g. <code>systemctl casa restart</code>)</li> </ol> <p>From now on, any template change will take effect after 5 seconds.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/overview/","title":"Developer guide","text":"<p>This page gives developers relevant pointers for several tasks including:</p> <ul> <li>Plugins development</li> <li>Configuration management</li> <li>Credentials enrollment</li> <li>Customization of Casa's authentication flow</li> </ul>","tags":["Casa","developer guide"]},{"location":"casa/developer/overview/#plugins","title":"Plugins","text":"<p>A plugin is an artifact packaged in a Java ARchive (jar file) that augments the functionalities available in your default Casa installation. The following is by no means an extensive list of things you can add via plugins:</p> <ul> <li>Menu items in user's menu, top-right dropdown menu, or admin's dashboard menu</li> <li>UI pages with arbitrary content (and backend-functionality!), this also applies for the admin dashboard</li> <li>Static files (e.g. Javascript, images, stylesheets, etc.)</li> <li>REST services</li> <li>Authentication mechanisms to be supported by the application</li> </ul> <p>In addition to the above:</p> <ul> <li>Any plugin can have easy access to the underlying Jans Server database</li> <li>Plugins can onboard their own libraries (jar files) and classes</li> </ul>","tags":["Casa","developer guide"]},{"location":"casa/developer/overview/#tools","title":"Tools","text":"<p>Acquaintance with the following technologies is recommended:</p> <ul> <li>Java 11 or higher, maven</li> <li>ZK 9 framework</li> <li>PF4J framework</li> <li>HTML/CSS/Javascript</li> <li>The underlying database engine used by your Jans Server installation, e.g. PostgreSQL, MySQL, etc.</li> </ul>","tags":["Casa","developer guide"]},{"location":"casa/developer/overview/#sample-plugins","title":"Sample plugins","text":"<p>The best way to start learning Casa plugin development is by playing with the sample plugins you can find here. Clone the repository (a shallow clone of <code>main</code> branch is fine), <code>cd</code> to one of the directories in the folder and run <code>mvn package</code>, then upload the resulting <code>jar-with-dependencies</code> through the administration console.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/overview/#configuration-management","title":"Configuration management","text":"<p>Most aspects of Casa that are configurable through the admin console UI can be programmatically operated using the configuration API. A formal description  can be found here. Note all endpoints are protected by OAuth tokens which must have the <code>https://jans.io/casa.config</code> scope.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/overview/#credentials-enrollment","title":"Credentials enrollment","text":"<p>Casa has enrollment capabilities built-in but there are use cases where credential enrollment needs to happen elsewhere in your app ecosystem. A typical scenario is in a user registration application, where users are asked to enroll strong authentication credentials during account creation. To facilitate these tasks, Casa exposes APIs  for enrolling the following types of authenticators:</p> <ul> <li>Phone numbers for SMS OTP</li> <li>OTP apps or tokens  </li> <li>FIDO2 security keys</li> </ul> <p>Note</p> <p>Per spec FIDO 2 credentials can only be enrolled from a page belonging to the same domain or subdomain of your Gluu Server.</p> <p>In addition to the above, the API also provides endpoints to query the number/type of credentials currently enrolled by a user as well as means to turn 2FA on and off.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/overview/#customizing-the-authentication-flow","title":"Customizing the authentication flow","text":"<p>The authentication experience the user faces when trying to access Casa is implemented in an Agama project which is attached to the authentication server when Casa is installed.  As with all authentication flows in Janssen, they belong to (run in the context of) the <code>jans-auth</code> application. This distinction is important because <code>jans-auth</code> and <code>casa</code> are separate Java webapps executed on different Jetty instances.</p> <p>In Casa flow, the user is requested to enter the username and password combination, then depending on how the application is configured, personal user settings, and access policies defined, a second factor may be requested.</p> <p>While this may cater most companies requirements, sometimes there is the need to customize the authentication experience. In fact, Agama facilitates this by design. Here are some things companies would like to do:</p> <ul> <li>Alter the UI pages - e.g. look-and-feel, structure, etc. </li> <li>Support more authentication methods</li> <li>Add links to the initial screen to take users to different authentication paths, for instance, to leverage social sites login</li> <li>Include an account registration process</li> <li>Include an extra final screen in case of password expiration</li> <li>Add a \"forgot password\" link</li> </ul> <p>Important</p> <p>You might be tempted to take the Agama project archive, apply some editions, add files to it, repack, and redeploy it. While this might seem the easiest thing to do, it is also the worst thing to do. Authentication journeys can be extended/tailored by means of creating additional projects. Try not to hack/patch the original project.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/overview/#casa-acr-update","title":"Casa ACR update","text":"<p>Given the warning above, there has to be a way to launch a different Agama flow than the one used by default to log into Casa. This can be achieved by supplying a value for Casa's <code>acr</code> startup variable: in VM-based installations, locate the file <code>/etc/default/casa</code> in and modify the variable as needed. The format is <code>agama_&lt;qualified-name-of-your-flow&gt;</code>. Then restart Casa.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/overview/#requisites","title":"Requisites","text":"<p>Regardless of the customization required, it is desirable to get acquaintance with Agama framework. This is a good time to go through the Agama developer guide pages found in the  Administration section of Jans Server docs. Specifically, several of the Agama advanced usages will help you materialize your requirements.</p> <p>Extract the Agama project to your development machine. It is useful to get an idea of how and what the out-of-the-box project does. Also, keep the Freemarker manual at hand.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/overview/#page-customizations","title":"Page customizations","text":"<p>The UI pages of the default Casa flow resemble the design of the Casa app itself. Also, modifications applied through the \"custom branding\" functionalities are automatically reflected in flow pages without any sort of intervention. This is neat, but if you need to go further, you will have to code the UI pages your own based on the existing ones.</p> <p>For this purpose, create a new Agama project with one flow in it. Pick one of the pages you want to change from the original project and build your own - initially keep it really simple: a dummy page is OK. From your new flow, use the <code>Trigger</code> directive to launch flow <code>io.jans.casa.authn.main</code>. Add an <code>Override templates</code> directive to your <code>Trigger</code> so the page in Casa project is superseded by the page you are creating. This is explained here.</p> <p>Pack your new project and deploy it. Wait for around 30 seconds and try to log into Casa to see the changes. Note you have to configure casa so your flow is launched, not the default one, ie. <code>io.jans.casa.authn.main</code>. This was explained earlier.</p> <p>Do as many changes as needed to your page. Then pick another page to alter and feed your <code>Override templates</code> accordingly. Repeat until your are done. Recall there is no need to restart <code>jans-auth</code> or <code>casa</code>.</p> <p>In some cases, the original look-and-feel may be satisfying but it's the text content what you would like to change. Agama engine supports localization and internationalization as explained here so you can supply  translated messages in your own project and make templates use those. Note Casa is only bundled with a set of \"default\" labels out-of-the box and thus pages don't change content regardless of browser's language or location. By overriding templates and providing labels in several languages, you can achieve full localization/internationalization in the authentication UI.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/overview/#support-more-authentication-methods","title":"Support more authentication methods","text":"<p>This is probably the most common requirement. Visit this page to learn more.</p>","tags":["Casa","developer guide"]},{"location":"casa/developer/overview/#other-forms-of-customization","title":"Other forms of customization","text":"<p>Most forms of customization can be tackled using flow cancellation. Through cancellation, a flow can be aborted while running and the control returned to one of its callers.  Learn more about this topic here.</p> <p>As an example, let's assume you want to add a \"don't have an account? register here\" button in the initial screen of Casa flow. Here's what you can do:</p> <ul> <li> <p>Create a new Agama project with one flow in it. Copy the page that prompts username and password into your project. Below the login button, add a form containing markup like <code>&lt;button type=\"submit\" name=\"_abort\"&gt;don't have an account? register here&lt;/button&gt;</code></p> </li> <li> <p>In your flow, let's call it <code>A</code>, use the <code>Trigger</code> directive to launch flow <code>io.jans.casa.authn.main</code>. Add an <code>Override templates</code> directive to your <code>Trigger</code> so the original login page in Casa project is superseded by the page you created</p> </li> <li> <p>Create another flow, let's call it <code>B</code>. This will be the \"registration\" flow which will present one or more screens to grab data in order to create an account for the user. Make <code>B</code> finish with <code>true</code> outcome if the account was successfully created, otherwise finish with <code>false</code></p> </li> <li> <p>Back in flow <code>A</code>, add code to check if <code>io.jans.casa.authn.main</code> was aborted, if so, launch flow <code>B</code>. For simplicity, if <code>B</code> didn't go well, terminate <code>A</code></p> </li> <li> <p>If <code>B</code> went well, show the original login form, that is, no registration button this time</p> </li> <li> <p>Add code for termination </p> </li> </ul> <p>So flow <code>A</code> will end up looking more or less like this:</p> <pre><code>...\nresult = Trigger io.jans.casa.authn.main\n    Override templates \"kz1vc3/main.ftlh\" \"newPage.ftlh\"\n\nWhen result.aborted is true\n    //registration button was clicked\n    result = Trigger B\n\n    When result.success is false\n        Finish false\n\n    result = Trigger io.jans.casa.authn.main\n\nFinish result\n</code></pre> <p>Here we have taken a simplistic approach to make the example concise. In practice you may like to be more elaborated and include an \"already have an account?\" button in the registration page, which could create a sort of navigational loop. Here the <code>Repeat</code> directive will emerge in your code for sure.</p> <p>Note</p> <p>When trying to customize an existing flow, familiarize with all possible paths the flow can take you to. Consider all possible screens and determine which require adjustments and the points at which cancellation is of use. Sometimes you will have to glance its <code>.flow</code> file (Agama code) to get a better idea.</p>","tags":["Casa","developer guide"]},{"location":"casa/plugins/2fa-settings/","title":"2FA Settings Plugin","text":"<p>This plugin allows administrators to configure how and when 2FA is applied. Admins may:</p> <ol> <li>Specify the minimum number of credentials users must enroll before 2FA can be used</li> <li>Allow 2FA to be automatically enabled upon credential enrollment</li> <li>Prevent users to turn 2FA on and off their own</li> <li>Allow users to choose a preferred method of authentication</li> </ol> <p>When (2) is not used, option (3) is disabled. This is the default behavior exhibited in Casa where users explicitly enable or disable 2FA usage.</p> <p>When (2) is active, 2FA is turned on as soon as the user enrolls a credential and the minimum required is fulfilled. Bear in mind:</p> <ul> <li>Automatic enablement happens only via GUI: enrollments made using the API will have to turn 2FA on by means of the API itself</li> <li>Plugins attaching authentication methods to Casa have to explicitly call method <code>notifyEnrollment</code> of <code>SndFactorAuthenticationUtils</code> upon successful enrollments (see the javadocs).</li> </ul> <p>Also, 2FA is automatically turned on upon login for users with enough credentials registered and not having 2FA turned on yet.</p> <p>With (4) users may choose a preferred type of credential. This means that when requested for a second factor, a credential of such \"preferred\" type will be prompted first instead of the credential considered the \"strongest\". The strength associated to a method is equal to the numeric level assigned to the custom script that represents the method.</p> <p>For more restrictive scenarios, administrators have the option to remove the 2FA switch (3) from the user's dashboard.</p> <p>Additionally this plugin allows to:</p> <ul> <li> <p>Choose from a set of predefined policies for when 2FA should be prompted:</p> <ul> <li>Always (at every login attempt)</li> <li>When user's location is unrecognized</li> <li>When user's device is unrecognized</li> <li>Users can define their own policy (based on the above)</li> </ul> </li> <li> <p>Set how long a location or device can be deemed as recognized</p> </li> </ul> <p>Moreover, when administrators allow users to set their own strong authentication policy, users can:</p> <ul> <li>View the list of physical devices they have used to login (e.g. PC, tablet, phone)</li> <li>View the time and location (city) associated to the last login event</li> <li>Remove a device from the list (eg. when it should not be considered trustworthy anymore)</li> </ul> <p>A device/location is considered trustworthy when the user has presented a strong credential in order to login to Casa in such device/location. Subsequent login attempts from trustworthy (recognized) device/locations will not require them to present a second factor.</p>","tags":["Casa","2FA"]},{"location":"casa/plugins/2fa-settings/#requirements","title":"Requirements","text":"<ul> <li>The plugin jar file must match the version of your Janssen Server installation.</li> </ul>","tags":["Casa","2FA"]},{"location":"casa/plugins/2fa-settings/#installation","title":"Installation","text":"<ol> <li> <p>Download the plugin</p> </li> <li> <p>Log in to Casa using an administrator account</p> </li> <li> <p>Navigate to <code>Administration console</code> &gt; <code>Casa plugins</code></p> <p></p> </li> <li> <p>Click on <code>Add a plugin...</code> and select the plugin jar file</p> </li> <li> <p>Click on <code>Add</code> </p> </li> </ol>","tags":["Casa","2FA"]},{"location":"casa/plugins/2fa-settings/#how-to-use","title":"How to use","text":"<p>For administrators, a new link labeled \"2FA settings\" appears in the dashboard menu to access the function.</p> <p></p> <p>For regular users, proper details appear in the widget where 2FA is turned on.</p> <p></p>","tags":["Casa","2FA"]},{"location":"casa/plugins/2fa-settings/#api","title":"API","text":"<p>Configurations provided by this plugin can also be applied by means of the API exposed for this purpose. A formal description of the API can be found in this swagger file. Note all endpoints are protected by tokens which must have the <code>https://jans.io/casa.config</code> OAuth scope.</p>","tags":["Casa","2FA"]},{"location":"casa/plugins/bioid/","title":"BioID plugin","text":"<p>This plugin allows users to enroll their BioID facial biometrics.</p>","tags":["Casa","Biometrical"]},{"location":"casa/plugins/bioid/#requirements","title":"Requirements","text":"<ul> <li>A Janssen server installation with Casa installed</li> <li>A BioID account. Register on the BioID site </li> <li>Application credentials from the BWS Portal. Please register an application against your account. You will need the app identifier, app secret, storage and partition. </li> </ul>","tags":["Casa","Biometrical"]},{"location":"casa/plugins/bioid/#installation","title":"Installation","text":"<ol> <li>Download the plugin jar.</li> <li>Log into Casa as an administrator, navigate to <code>Administration Console &gt; Casa plugins</code> and add the plugin jar</li> <li>Restart the casa service: <code>sudo systemctl restart jans-casa</code></li> <li>Using the TUI, navigate to <code>Auth Server</code> &gt; <code>Clients</code>, open the details for <code>Client for Casa</code>, and add the following redirect URI: <code>https://&lt;hostname&gt;/jans-casa/pl/bioid-plugin/user/interlude.zul</code>. Replace <code>&lt;hostname&gt;</code> with the hostname of your server, and save the client.</li> <li>Run the following commands to generate the Agama flow file:</li> </ol> <p><pre><code>git clone --depth 1 --branch main --no-checkout https://github.com/JanssenProject/jans.git\ncd jans/jans-casa/plugins/bioid/extras/agama\nzip -r casa-bioid.gama ./*\n</code></pre> 1. Transfer the <code>casa-bioid.gama</code> file to the server, and deploy it using the TUI 1. Using the TUI, export the sample configuration, edit it according to the specification below and import it back in</p>","tags":["Casa","Biometrical"]},{"location":"casa/plugins/bioid/#agama-configuration","title":"Agama Configuration","text":"<pre><code>{\n  \"io.jans.agama.bioid.enroll\": {\n    \"host\": \"https://&lt;HOSTNAME&gt;/jans-auth/fl/callback\",\n    \"endpoint\": \"https://bws.bioid.com/extension/\",\n    \"appIdentifier\": \"\",\n    \"appSecret\": \"\",\n    \"storage\": \"\",\n    \"partition\": \"\"\n  }\n}\n</code></pre> <ul> <li><code>host</code>: Replace <code>&lt;HOSTNAME&gt;</code> with the hostname of your server</li> <li><code>endpoint</code>: BioID API endpoint. Leave as default</li> <li><code>appIdentifier</code>: The app identifier string from BWS Portal - Configuration</li> <li><code>appSecret</code>: The app secret from BWS Portal - Configuration</li> <li><code>storage</code>: Storage value from BWS Portal - Configuration</li> <li><code>partition</code>: Partition value from BWS Portal - Configuration</li> </ul>","tags":["Casa","Biometrical"]},{"location":"casa/plugins/bioid/#how-to-use","title":"How to use","text":"<p>The plugin provides a user menu. When clicking the <code>Click to Enroll</code> button, Casa launches the <code>io.jans.agama.bioid.enroll</code> flow on the authorization server. This flow queries the BioID database for existing enrollments for the user. If the user has not enrolled, the flow presents the BWS GUI for enrollment. Upon success, the flow redirects back to a Casa landing page. Deletion of credentials is not supported as of now because Casa is unaware of enrollment status of a user.</p>","tags":["Casa","Biometrical"]},{"location":"casa/plugins/cert-authn-tutorial/","title":"Tutorial: smart card authentication in Janssen","text":"<p>With Casa's certificate authentication plugin administrators can configure client certificate authentication so users can present digital certificates as a form of second-factor authentication. Some organizations opt to deploy certificate authentication through the use of smart cards - physical cards with embedded integrated circuits that act as security tokens. This practice is considered to offer a high level of security compared to other forms of multi-factor authentication. A well-known example of smart card usage is the U.S. Department of Defense (DoD).</p> <p>In this document we present a basic example on how to use security keys from the YubiKey 5 series for smart card authentication.</p>","tags":["Casa","2FA","Certificate","Smartcards","Yubikeys"]},{"location":"casa/plugins/cert-authn-tutorial/#requisites","title":"Requisites","text":"<ul> <li>Certificate authentication plugin installed, configured, and tested</li> <li>One or more security keys from the YubiKey 5 series</li> <li>A machine with Microsoft Windows</li> <li>Firefox browser (optional)</li> </ul> <p>Notes: - This document only provides steps for Microsoft Edge and Mozilla Firefox on Windows - It is assumed the certificates used for testing were already generated and are available as files (PEM/p12). Usage of Windows is intended only for client testing</p>","tags":["Casa","2FA","Certificate","Smartcards","Yubikeys"]},{"location":"casa/plugins/cert-authn-tutorial/#yubikey-initialization","title":"Yubikey initialization","text":"<p>Before starting to use a YubiKey for smart card operations, it is recommended to change the PIN, PUK, and management key from their default values. These two pages bring useful information in this regard:</p> <ul> <li>https://developers.yubico.com/PIV/Guides/Device_setup.html</li> <li>https://developers.yubico.com/PIV/Introduction/Admin_access.html</li> </ul> <p>For mere testing purposes, you may skip this entirely - the default values are listed in the last link provided.</p> <p>The Yubico PIV Tool (required for Firefox) may also be used to set PIN, PUK, and management key as described in section \"Preparing a YubiKey for real use\" of this document.</p>","tags":["Casa","2FA","Certificate","Smartcards","Yubikeys"]},{"location":"casa/plugins/cert-authn-tutorial/#smart-card-authentication-with-edge","title":"Smart card authentication with Edge","text":"","tags":["Casa","2FA","Certificate","Smartcards","Yubikeys"]},{"location":"casa/plugins/cert-authn-tutorial/#install-the-smart-card-minidriver","title":"Install the smart card minidriver","text":"<p>This is a piece of software that allows Windows (and Edge) to interface smoothly with Yubikeys as smart cards. Installers available at Yubico website.</p>","tags":["Casa","2FA","Certificate","Smartcards","Yubikeys"]},{"location":"casa/plugins/cert-authn-tutorial/#import-a-certificate","title":"Import a certificate","text":"<p>When setting up the Casa plugin, admins (or users themselves) imported their certificates in the certificate manager of the web browser. Here, the certificate has to be imported into the Yubikey instead. Here's how to do so:</p> <ol> <li> <p>As administrator, run the following commands:</p> <pre><code>reg add \"HKLM\\SOFTWARE\\Microsoft\\Cryptography\\Defaults\\Provider\\Microsoft Base Smart Card Crypto Provider\" /v AllowPrivateExchangeKeyImport /t REG_DWORD /d 1\n\nreg add \"HKLM\\SOFTWARE\\Microsoft\\Cryptography\\Defaults\\Provider\\Microsoft Base Smart Card Crypto Provider\" /v AllowPrivateSignatureKeyImport /t REG_DWORD /d 1\n</code></pre> </li> <li> <p>Insert the key</p> </li> <li> <p>Run <code>certutil -csp \"Microsoft Base Smart Card Crypto Provider\" -importpfx C:\\Path\\to\\user.p12</code>. Enter the PIN when prompted</p> </li> </ol>","tags":["Casa","2FA","Certificate","Smartcards","Yubikeys"]},{"location":"casa/plugins/cert-authn-tutorial/#test","title":"Test","text":"<p>Using Microsoft Edge, follow steps similar to those when the plugin was formerly tested. Here, the browser dialog for picking a cert will be shown, and then a prompt will appear for entering the Yubikey PIN.</p>","tags":["Casa","2FA","Certificate","Smartcards","Yubikeys"]},{"location":"casa/plugins/cert-authn-tutorial/#smart-card-authentication-with-firefox","title":"Smart card authentication with Firefox","text":"","tags":["Casa","2FA","Certificate","Smartcards","Yubikeys"]},{"location":"casa/plugins/cert-authn-tutorial/#install-the-yubico-piv-tool","title":"Install the Yubico PIV Tool","text":"<p>This is a tool that provides administrative PIV capabilities for Yubikeys and also bundles a PKCS#11 module that enables a communication bridge between the Yubikeys and other software such as Firefox. Installers for Windows are available at Yubico website</p>","tags":["Casa","2FA","Certificate","Smartcards","Yubikeys"]},{"location":"casa/plugins/cert-authn-tutorial/#import-a-certificate_1","title":"Import a certificate","text":"<p>When setting up the Casa plugin, admins (or users themselves) imported their certificates in the certificate manager of the web browser. Here, the certificate has to be imported into the Yubikey instead. Follow the steps below:</p> <ol> <li> <p>In a command line window, run <code>c:\\Program Files\\Yubico\\Yubico PIV Tool\\bin\\yubico-piv-tool -s9a -KPKCS12 -aimport-key -aimport-certificate -i C:\\Path\\to\\user.p12</code>. Enter the Yubikey PIN when prompted. This will import the end-entity certificate into slot <code>9a</code> - more about slots here</p> </li> <li> <p>You can run <code>c:\\Program Files\\Yubico\\Yubico PIV Tool\\bin\\yubico-piv-tool -astatus</code> to ensure the certificate was properly added</p> </li> <li> <p>Open Firefox settings. In the certificate manager, go to the \"Authorities\" tab and import the issuer certificate (of the end-entity cert)</p> </li> </ol>","tags":["Casa","2FA","Certificate","Smartcards","Yubikeys"]},{"location":"casa/plugins/cert-authn-tutorial/#load-ykcs11-module","title":"Load YKCS11 module","text":"<ol> <li> <p>As administrator, ensure the <code>bin</code> directory of the PIV tool is added to the <code>Path</code> environment variable. This path may look like <code>c:\\Program Files\\Yubico\\Yubico PIV Tool\\bin</code></p> </li> <li> <p>Still in the Firefox settings, locate \"Security devices\" and click on \"Load\". Choose a name for the Yubikey PKCS#11  module and browse to the <code>bin</code> directory of the PIV tool. Finally select the file <code>libykcs11.dll</code></p> </li> <li> <p>Restart Firefox</p> </li> </ol>","tags":["Casa","2FA","Certificate","Smartcards","Yubikeys"]},{"location":"casa/plugins/cert-authn-tutorial/#test_1","title":"Test","text":"<p>Using Firefox, follow steps similar to those when the plugin was formerly tested. Here, the browser dialog for picking a cert will be shown, and then a prompt will appear for entering the Yubikey PIN.</p>","tags":["Casa","2FA","Certificate","Smartcards","Yubikeys"]},{"location":"casa/plugins/cert-authn-tutorial/#useful-resources","title":"Useful resources","text":"<ul> <li>https://support.yubico.com/s/article/YubiKey-smart-card-deployment-guide</li> <li>https://developers.yubico.com/PIV/Guides/</li> <li>https://support.yubico.com/s/article/Enabling-Smart-Card-in-Firefox-on-Windows</li> <li>https://developers.yubico.com/yubico-piv-tool/YKCS11/Supported_applications/firefox.html</li> </ul>","tags":["Casa","2FA","Certificate","Smartcards","Yubikeys"]},{"location":"casa/plugins/cert-authn/","title":"Client certificate authentication","text":"","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#overview","title":"Overview","text":"<p>At a high level, certificate authentication is a method of verifying identity using digital certificates. Here, the client (user or device) provides a certificate to the server to prove its identity. A certificate contains information like a digital signature, expiration date, name of client (a.k.a subject), certificate authority (CA) name, serial number, and more, all structured using the X.509 standard. Actual authentication occurs in the SSL/TLS handshake, an important process that takes place before any relevant data is transmitted in an SSL/TLS session.</p> <p>The Casa client certificate authentication plugin offers:</p> <ul> <li>Enrollment of digital certificates (may include automatic user registration)</li> <li>Authentication by presenting a valid certificate (no username or password required)</li> <li>Use enrolled certificates as a form of second-factor authentication</li> </ul>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#requisites","title":"Requisites","text":"<ul> <li>A Janssen server with Apache or nginx HTTP front</li> <li>Jans Casa 1.16.0 or higher. Need it in an older version?</li> <li>It is assumed your organization already has an established mechanism of certificate issuance and deployment. For the purpose of testing, this documentation provides manual steps for issuing certificates</li> </ul>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#configuration-steps","title":"Configuration steps","text":"<p>The below are the steps required to setup client certificate authentication with Casa in Jans:</p> <ul> <li>Generate client certificates and an associated certificate chain for testing. This may be skipped if you already own certificates</li> <li>Import client certificates in the user's browser</li> <li>Setup a cert pickup URL in your front HTTP server</li> <li>Deploy and configure the cert-authn Agama project in the server</li> <li>Install the cert-authn Casa plugin</li> <li>Update the Casa ACR</li> </ul>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#generate-testing-certificates","title":"Generate testing certificates","text":"<p>Note</p> <p>This section assumes the usage of a *nix machine. Translate commands to your OS accordingly</p> <p>Note</p> <p>Downloads listed here will take up no more than 32MB of bandwidth</p> <p>For this task, two approaches are covered here. You can choose any or even both for a more extensive testing:</p> <ul> <li> <p>Reusing already made testing certificates. These are PKI testing certificates published by the Computer Research Security Center of NIST ITL</p> </li> <li> <p>Creating a tiny CA through free, open-source tools provided by Smallstep Labs. This approach is easy too - just need to run a few commands</p> </li> </ul> <p>The steps given are supposed to be executed in a developer or administrative machine, not your Janssen server.</p> NIST PKI test certsGenerating certs with Smallstep <p>Visit the PKI testing site and download the test descriptions and test data of the Path Validation Testing Program. Extract the contents and in a new, separate directory, copy the following:</p> <p>Signing certificates:</p> <ul> <li>GoodCACert.crt</li> <li>TrustAnchorRootCertificate.crt</li> </ul> <p>End-entity certificates:</p> <ul> <li>ValidCertificatePathTest1EE.p12</li> <li>InvalidEESignatureTest3EE.p12</li> <li>ValidGeneralizedTimenotAfterDateTest8EE.p12</li> </ul> <p>There are many end-entity certificates and they map to the tests described in the PDF file downloaded earlier. These three were just picked to exemplify configuration and testing of client certificate authentication in Jans.</p> <p><code>crt</code> files are in DER (binary) format and they constitute the so called \"certificate chain\" or \"certificate path\". Here is how to generate the chain in PEM format:</p> <pre><code>echo \"-----BEGIN CERTIFICATE-----\" &gt; chain.pem\nbase64 TrustAnchorRootCertificate.crt &gt;&gt; chain.pem\necho \"-----END CERTIFICATE-----\" &gt;&gt; chain.pem\n\necho \"-----BEGIN CERTIFICATE-----\" &gt;&gt; chain.pem\nbase64 GoodCACert.crt &gt;&gt; chain.pem\necho \"-----END CERTIFICATE-----\" &gt;&gt; chain.pem\n</code></pre> <p>In summary, the result is a file containing Base64-encoded certs of the root CA followed by the intermediate CA employed to sign the end-entity (user) certificates.</p> <ol> <li> <p>Download and install <code>step-ca</code> (a private online CA). Go to <code>https://github.com/smallstep/certificates/releases/latest</code> and pick the artifact that best matches your OS/platform</p> </li> <li> <p>Downlod and install <code>step-cli</code> (<code>step-ca</code> client). Go to <code>https://github.com/smallstep/cli/releases/latest</code> and pick the artifact that best matches your OS/platform</p> </li> <li> <p>Create a file containing the password to encrypt the CA keys, for instance <code>echo 'Admin1.' &gt; capwd</code></p> </li> <li> <p>Initialize a PKI without CA configuration: <code>step ca init --pki --name foobar --deployment-type standalone --password-file capwd</code>. After completion some feedback will be shown including the location of the root certificate and intermediate certificate. Keep those paths at hand</p> </li> <li> <p>Build the certificate chain file: <code>cat .step/certs/root_ca.crt .step/certs/intermediate_ca.crt &gt; chain.pem</code></p> </li> <li> <p>Create a private key and a certificate for <code>cn=Joe</code> (subject of the cert): <code>step certificate create Joe joe.crt joe.key --ca ~/.step/certs/intermediate_ca.crt --ca-key ~/.step/secrets/intermediate_ca_key --ca-password-file capwd --not-after=720h</code>. This command will create a certificate signed with the intermediate certificate</p> </li> <li> <p>Inspect the created cert: <code>step certificate inspect joe.crt</code>. Note the expiration is of 30 days and that \"Client authentication\" is explicitly part of the extended key usages</p> </li> <li> <p>Package Joe's certificate and key into a <code>p12</code> file: <code>step certificate p12 joe.p12 joe.crt joe.key</code>. You will be prompted two passwords: one for the <code>p12</code> file itself, and the password previously used to encrypt the private key of the user certificate</p> </li> </ol>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#import-client-certificates","title":"Import client certificates","text":"<p>Instructions for this vary among browsers. Often, it boils down to locating a \"certificates\" section in the settings menu and import the <code>p12</code> file under \"Your certificates\". A prompt will appear: enter the password used when the <code>p12</code> file was generated.</p> <p>If using the NIST PKI test certs, type password. Import all the <code>p12</code> files copied.</p>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#setup-a-cert-pickup-url","title":"Setup a cert pickup URL","text":"<p>For certificate authentication, the HTTP sever must configured so the <code>CertificateRequest</code> message is sent in the TLS handshake. This will make the client (web browser in this case) show a dialog for the user to pick one certificate from those already imported into the browser's certificate manager.</p> <p></p> <p>The instructions to setup this URL vary depending on the TLS version required and type of HTTP server. Here we provide guidance for Apache 2.4 with TLS 1.2 and 1.3. You can translate the Apache configuration directives directly to nginx. If you face issues or use a different server, please open a discussion.</p> <p>Note</p> <p>The last available version of TLS is 1.3 and is highly recommended to use it.</p> Apache 2.4 with TLS 1.3Apache 2.4 with TLS 1.2 <p>This configuration requires creating a subdomain or opening a new port for serving HTTPs. There will be only one URL served in this case, e.g. <code>https://acme.co:444/</code>; all other content will respond with HTTP 404 (not found). Hitting this URL will bring up the native web browser dialog for selecting a user certificate.  </p> <p>The easiest way to set this up is adding a <code>VirtualHost</code> directive associated to a new port, for instance 444. This snippet exemplifies a safe way to do so. Note you have to edit accordingly:</p> <ul> <li>The server name</li> <li>The paths to the SSL certificate. This is the web serving certificate and is unrelated to the certificates used for authentication</li> </ul> <p>Transfer the edited file to <code>/etc/apache2/sites-enabled</code>. Note there is already a file named <code>https_jans.conf</code> with a <code>VirtualHost</code> for port 443 that you can use as a guide. Finally, add a <code>Listen 444</code> directive to file <code>/etc/apache2/ports.conf</code>.</p> <p>This is the fastest approach and involves adding a directive inside the existing <code>VirtualHost</code> for port 443 in  <code>/etc/apache2/sites-enabled/https_jans.conf</code>. Copy this snippet and paste it just after the closing of the <code>Location</code> directive associated to <code>/jans-casa</code>.</p> <p>In this case your cert pickup URL is <code>https://&lt;your-host-name&gt;/jans-casa/pl/cert-authn/index.zul</code>.</p>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#test","title":"Test","text":"<p>Restart Apache (e.g. <code>systemctl restart apache2</code>) and in a browser visit the URL configured, e.g. <code>https://acme.co:444</code> (TLS 1.3) or <code>https://acme.co/jans-casa/pl/cert-authn/index.zul</code> (TLS 1.2). This will display a dialog like this listing the certificates imported so far. Do not select anything and close the browser window.</p>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#deploy-and-configure-the-agama-project","title":"Deploy and configure the Agama project","text":"<p>The <code>cert-authn</code> Agama project is a utility project that allows administrators do things like:</p> <ul> <li> <p>Display a login page where users are shown the option to present a certificate</p> <ul> <li> <p>If the certificate is not mapped to an existing account, a new identity is created with the attributes found in the cert (automatic user registration). Then access to the application is granted</p> </li> <li> <p>If the certificate is mapped to an existing account, access to the application is granted to such user</p> </li> </ul> </li> <li> <p>Display a login page as the above including the configured identity providers, if any, in case the accounts linking plugin is installed  </p> </li> <li> <p>Offer users the ability to enroll a certificate when they are already logged into Casa</p> </li> <li> <p>Usage of certificates as a form of second-factor authentication</p> </li> </ul> <p>Offering users the login page and the account onboarding regarded above is up to administrators (optional feature).</p> <p>Note</p> <p>Instructions provided here assume usage of TUI. Do the equivalent in admin-ui or other configuration mechanism</p> <ol> <li> <p>Download the certificate authentication Agama project archive: <code>https://maven.jans.io/maven/io/jans/casa/plugins/cert-authn-agama/0.0.0-nightly/cert-authn-agama-0.0.0-nightly-project.zip</code></p> </li> <li> <p>Transfer the zip file to a location in the server and deploy it. For example, if using TUI, go to Agama menu -&gt; \"Upload project\". Wait one minute</p> </li> <li> <p>Scroll through the list of projects until <code>cert-authn</code> is highlighted</p> </li> <li> <p>Open the configuration management dialog (press <code>c</code>) and choose to export the sample configuration to a file on disk</p> </li> <li> <p>Edit property <code>certPickupUrl</code> of flow <code>io.jans.casa.cert.promptAndValidate</code> accordingly. This is the URL that displays the browser dialog for choosing a certificate</p> </li> <li> <p>If you did not generate testing certificates, i.e. already own some certs, create a file named <code>chain.pem</code> by concatenating the contents in PEM format of the certificate chain starting with the root CA cert, and appending the rest of intermediate certificates. The last certificate would be the one employed to sign the end-entity (user certificate). Ensure the BEGIN/END CERTIFICATE marker lines are included</p> </li> <li> <p>Compute a one-liner JSON string for the contents of <code>certChainPEM</code> property, for example: <code>sed -i.bak ':a;N;$!ba;s/\\n/\\\\n/g' chain.pem</code></p> </li> <li> <p>Optional. If integration with accounts linking plugin is desired, set <code>useAcctLinking</code> to <code>true</code> for flow <code>io.jans.casa.cert.oneStepAuthn</code></p> </li> <li> <p>Optional. Reference an attribute mapping for account onboarding in property <code>mappingClassField</code> of flow <code>io.jans.casa.cert.standaloneOneStepAuthn</code>. More details here</p> </li> <li> <p>Save the JSON file and open again the configuration management dialog for the cert-authn Agama project. Import the resulting file</p> </li> </ol> <p>The next optional step is assigning an icon to certificate authentication for the Casa selector page:</p> <ol> <li> <p>Scroll through the list of projects until the <code>casa</code> project is highlighted</p> </li> <li> <p>Open the project details (press <code>v</code>) and export the current configuration to a file on disk</p> </li> <li> <p>Edit the file: in the <code>selector</code> section under <code>io.jans.casa.authn.main</code>, add:</p> <pre><code>\"io.jans.casa.authn.cert\": {\n   \"icon\": \"&lt;span class='fa-layers fa-fw f2 mr1 nl2'&gt;&lt;i class='far fa-circle' data-fa-transform='shrink-4 up-3 right-4'&gt;&lt;/i&gt;&lt;i class='far fa-circle' data-fa-transform='shrink-5 up-3 right-4'&gt;&lt;/i&gt;&lt;i class='far fa-circle' data-fa-transform='shrink-6 up-3 right-4'&gt;&lt;/i&gt;&lt;i class='fas fa-bookmark' data-fa-transform='rotate-30 shrink-9 down-4'&gt;&lt;/i&gt;&lt;i class='fas fa-bookmark' data-fa-transform='rotate--30 shrink-9 down-4 right-8'&gt;&lt;/i&gt;&lt;/span&gt;\",\n   \"textKey\": \"casa.selector.certauthn\"\n}\n</code></pre> </li> <li> <p>Save the file, and import it back as the configuration for project <code>casa</code></p> </li> </ol>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#install-the-cert-authn-plugin","title":"Install the cert-authn plugin","text":"<ol> <li> <p>Download the plugin jar file <code>https://maven.jans.io/maven/io/jans/casa/plugins/cert-authn/0.0.0-nightly/cert-authn-0.0.0-nightly-jar-with-dependencies.jar</code> and copy to your server's <code>/opt/jans/jetty/jans-casa/plugins</code>. Alternatively upload the file using Casa itself: go to <code>Administration console</code> &gt; <code>Casa plugins</code></p> </li> <li> <p>Wait one minute. In the admin console, navigate to the \"Authentication methods\" page. A new \"User certificates\" widget will appear. Enable the authentication method, drag it to the location (priority) desired, and hit \"Save\"</p> </li> <li> <p>Navigate to Casa main dashboard. A new menu item will appear for the certificate enrollment</p> </li> </ol>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#update-the-casa-acr","title":"Update the Casa ACR","text":"<p>This step is required only if account onboarding via certificate attributes is desired or if you want to authenticate users by presenting a certificate alone (no username).</p> <p>Note these instructions apply for VM-based installations. On containers-based environments, please open a GitHub discussion or a support ticket.</p> <ol> <li> <p>Download file <code>https://maven.jans.io/maven/io/jans/jans-scim-model/0.0.0-nightly/jans-scim-model-0.0.0-nightly.jar</code> and place it in your server under <code>/opt/jans/jetty/jans-auth/custom/libs</code></p> </li> <li> <p>Edit the file <code>/etc/default/jans-casa</code>: locate a segment that reads <code>-Dacr=</code> and assign <code>agama_io.jans.casa.cert.oneStepAuthn</code> as new value. Save the change</p> </li> <li> <p>Restart <code>jans-casa</code> and <code>jans-auth</code> services</p> </li> </ol>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#testing","title":"Testing","text":"<p>Warning</p> <p>The dialog for users to pick a certificate from the already imported certificates do not behave the same for all browsers. In some cases, a browser will \"cache\" the selection and remember the choice for the whole browsing session or even for several days. Sometimes, the user can choose for how long the selection is remembered. You can always clear the SSL cache to make the prompt appear again. Instructions to do so vary.</p>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#enrollment","title":"Enrollment","text":"<p>Use one or more testing users in Jans. Assign (enroll) testing certificates as desired. Here's how to do it for a single account:</p> <ol> <li> <p>Ensure you have imported the user certificates in <code>p12</code> format into the certificate manager of the given browser</p> </li> <li> <p>Login as the user and click on \"Manage certificates\" on the main dashboard</p> </li> <li> <p>Read the hints given for an effective enrollment. Click on the \"Proceed\" button</p> </li> <li> <p>The browser will be redirected to the configured cert pickup URL and a native dialog will appear. From here, choose one of the available certificates</p> </li> <li> <p>A message will appear acknowledging the certificate was successfully linked to the account. Click on \"Return\"</p> </li> <li> <p>The browser will be taken to the listing of currently enrolled certificates. A new entry will appear associated to the certificate previously chosen</p> </li> </ol> <p>Testing can be extended to the following scenarios:</p> <ul> <li>Enroll an additional certificate</li> <li>Attempt to enroll an already enrolled certificate</li> <li>Attempt to enroll an expired certificate</li> <li>Attempt to enroll an invalid certificate if you have one at hand (as in the NIST PKI certs), or a certificate issued with a certificate chain that is different from the chain currently configured for the <code>cert-authn</code> Agama project</li> </ul>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#authentication","title":"Authentication","text":"<p>Once testing users have certificates enrolled, add other credentials like OTP so second-factor authentication can be turned on for them.</p> <p>Here are steps for testing authentication for a given user (happy path):</p> <ol> <li> <p>If there is a Casa session open, log out and try to login again</p> </li> <li> <p>Supply username and password</p> </li> <li> <p>On the selection page click on \"user certificates\". If this option does not appear, ensure you have properly followed these steps</p> </li> <li> <p>The browser will be redirected to the configured cert pickup URL. If no dialog appears, the browser is reusing a previous selection. Close the window and start again, or flush the SSL cache</p> </li> <li> <p>Select one of the already enrolled certificates. Authentication should succeed</p> </li> </ol> <p>Testing can be extended to the following scenarios where authentication should fail:</p> <ul> <li>Selecting a certificate imported in the browser but not enrolled in Casa</li> <li>Selecting a certificate a different user has enrolled</li> <li>Selecting a certificate that was enrolled but has expired</li> <li>Not selecting any certificate: hitting \"Cancel\" or \"Don't send a certificate\" option in the browser dialog</li> </ul>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#account-onboarding-optional","title":"Account onboarding (optional)","text":"<p>Having followed these steps, visit the Casa login page.</p> <ol> <li> <p>Click on the \"Smart card | User certificate\" option</p> </li> <li> <p>The browser will be redirected to the configured cert pickup URL and a native dialog will appear. From here, choose one of the available certificates</p> </li> <li> <p>You will be authenticated as the user who previously enrolled that cert, otherwise a new account has been created for the user. Check the user profile data (TUI or admin-ui) and see how attributes have been populated for the account</p> </li> </ol>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#faq","title":"FAQ","text":"","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#is-the-plugin-compatible-with-smart-cards","title":"Is the plugin compatible with smart cards?","text":"<p>Yes. There is a simple demonstrative tutorial available.</p>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#how-to-customize-the-browser-dialog-for-not-remembering-the-user-choice","title":"How to customize the browser dialog for not remembering the user choice?","text":"<p>This is not possible - at least from Janssen server.</p>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#does-the-plugin-support-revocation","title":"Does the plugin support revocation?","text":"<p>It's not implemented but we may add CRL functionality on request. OCSP is another option but it seems to be a discouraged practice these days.</p> <p>Another practice to consider for your PKI is using passive revocation and short-lived certificates. Here, a certificate that has been revoked can no longer be renewed at the CA. It will still be valid for the remainder of its validity period, but cannot be prolonged.</p>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#can-the-plugin-be-used-on-older-versions-of-jans","title":"Can the plugin be used on older versions of Jans?","text":"<p>The plugin can be run in versions 1.1.5 to 1.15.0 with a subtle update in the application descriptor. Run the following in your VM-based installation:</p> <ul> <li> <p><code>cd</code> to <code>/opt/jans/jetty/jans-casa/webapps</code></p> </li> <li> <p>Run <code>jar -xf jans-casa.war WEB-INF/web.xml</code></p> </li> <li> <p>Edit <code>web.xml</code> by inserting the following inside the <code>web-app</code> tag:</p> <pre><code>&lt;session-config&gt;\n    &lt;tracking-mode&gt;COOKIE&lt;/tracking-mode&gt;\n&lt;/session-config&gt;\n</code></pre> </li> <li> <p>Save the file and update the war file: <code>jar -uf jans-casa.war WEB-INF/web.xml</code></p> </li> <li> <p>Run <code>rm -rf WEB-INF</code></p> </li> <li> <p>Restart casa</p> </li> </ul>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#are-certificates-required-to-have-the-client-authentication-purpose-in-the-extended-key-usage","title":"Are certificates required to have the Client Authentication purpose in the extended key usage?","text":"<p>No. Section 4.2.1.12 of RFC 5280 mentions:</p> <p>Certificate using applications MAY require that the extended key usage extension be present and that a particular purpose be indicated in order for the certificate to be acceptable to that application.</p> <p>We chose not to require the presence of the purpose.</p>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#whats-the-roundtripmaxtime-property-in-the-agama-project-used-for","title":"What's the <code>roundTripMaxTime</code> property in the Agama project used for?","text":"<p>The implementation requires defining a maximum time for the completion of the task consisting of initiating enrollment (or authentication), selecting a certificate, entering a PIN (in the case of smart cards), and returning to the page that originated the task. A default value of 45 seconds is used.</p> <p>If the process is not completed in this timeframe, it will fail and the log will report errors regarding expired cache entries. In this case, consider using a higher value for <code>roundTripMaxTime</code>.</p>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#how-does-account-onboarding-work","title":"How does account onboarding work?","text":"<p>Registering an account based on the information found in a certificate is done via attribute mappings: Config property <code>mappingClassField</code> of flow <code>io.jans.casa.cert.standaloneOneStepAuthn</code> points to a Java method found in class <code>io.jans.casa.certauthn.AttributeMappings</code> of the cert-authn Agama project. Such method takes a <code>Map&lt;String, String&gt;</code> as input and returns a <code>Map&lt;String, String&gt;</code> as well.</p> <p>The input data contains the key/value pairs found in the subject of the certificate. As an example, if the cert was issued to <code>CN=Joe, O=foobar</code>, then the map will look like:</p> Attribute Name Value <code>cn</code> Joe <code>o</code> foobar <p>Note attribute names are lowercased. Additionally, if there is a Subject Alternative Name (SAN) consisting of an e-mail, the input map will contain such value under attribute name <code>mail</code>.</p> <p>The \"input\" map can then be used to generate the resulting profile of the user to onboard. For example, by default the project employs a method called <code>STRAIGHT</code>, which returns a copy of the incoming map restricted to the attributes <code>o</code>, <code>cn</code>, <code>l</code>, and <code>mail</code>. Also the <code>uid</code> attribute is added with the same value of <code>mail</code>. This mapping is useful in general but administrators might like to supply their own mapping.</p> <p>To provide your own mapping, edit the cert-authn project: in file <code>lib/io/jans/casa/certauthn/AttributeMappings.java</code> add a new field based on the current (<code>STRAIGHT</code>) mapping. Then point to the new mapping in the project configuration accordingly. Ensure to always set an <code>uid</code>.</p> <p>Note attribute mapping only takes place when creating an account, that is, if the certificate in question is associated to an existing user, no profile update occurs.</p>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/cert-authn/#is-there-a-way-to-offer-certificate-enrollmentauthentication-without-having-casa-installed","title":"Is there a way to offer certificate enrollment/authentication without having Casa installed?","text":"<p>Yes, that's possible. Open a GitHub discussion or a support ticket.</p>","tags":["Casa","2FA","Certificate","Smartcards"]},{"location":"casa/plugins/consent-management/","title":"Consent Management Plugin","text":"<p>The Consent Management plugin gives end-users the ability to view and revoke previously granted authorizations provided to applications accessed with their account in a Janssen Server.</p>","tags":["Casa","Consent"]},{"location":"casa/plugins/consent-management/#requirements","title":"Requirements","text":"<ul> <li>The plugin jar file must match the version of your Casa (and Janssen Server) installation.</li> </ul>","tags":["Casa","Consent"]},{"location":"casa/plugins/consent-management/#installation","title":"Installation","text":"<ol> <li> <p>Download the plugin</p> </li> <li> <p>Login to Casa using an administrator account</p> </li> <li> <p>Visit <code>Administration console</code> &gt; <code>Casa plugins</code></p> <p></p> </li> <li> <p>Click on <code>Add a plugin...</code> and select the plugin jar file</p> </li> <li> <p>Click on <code>Add</code> </p> </li> </ol>","tags":["Casa","Consent"]},{"location":"casa/plugins/consent-management/#user-guide","title":"User guide","text":"<p>For information on how to use the plugin, see the User Guide</p>","tags":["Casa","Consent"]},{"location":"casa/plugins/custom-branding/","title":"Custom Branding Plugin","text":"<p>This plugin allows admins to apply a design customization by choosing colors, favicon, logo, and footer text to match their company's look and feel. Alternatively, they can supply all assets (images and CSS files) externally to cover more demanding needs.</p>","tags":["Casa","Branding"]},{"location":"casa/plugins/custom-branding/#requirements","title":"Requirements","text":"<ul> <li>The plugin jar file must match the version of your Casa (and Janssen Server) installation.</li> </ul>","tags":["Casa","Branding"]},{"location":"casa/plugins/custom-branding/#installation","title":"Installation","text":"<ol> <li> <p>Download the plugin</p> </li> <li> <p>Login to Casa using an administrator account</p> </li> <li> <p>Visit <code>Administration console</code> &gt; <code>Casa plugins</code></p> <p></p> </li> <li> <p>Click on <code>Add a plugin...</code> and select the plugin jar file</p> </li> <li> <p>Click on <code>Add</code> </p> </li> </ol>","tags":["Casa","Branding"]},{"location":"casa/plugins/custom-branding/#how-to-use","title":"How to use","text":"<p>See the custom branding page for full instructions.</p>","tags":["Casa","Branding"]},{"location":"casa/plugins/email-otp/","title":"E-mail OTP Plugin","text":"<p>With this plugin, administrators can onboard a new type of authentication factor consisting of one-time passcodes (OTP) delivered to the user's inbox.</p> <p>This plugin simply shows a list of the already registered e-mail addresses of the user in the UI of Casa, however the accompanying Agama project contributes a new option in the authentication experience where the user is prompted to enter an OTP delivered to one of his e-mail addresses, if any.</p> <p>By adding the plugin and the corresponding Agama project to your server, all users having at least one e-mail address in his profile (database attribute <code>mail</code>) will be given the option to get a passcode delivered and then prompted for such as a form of 2FA.</p>","tags":["Casa","OTP"]},{"location":"casa/plugins/email-otp/#requirements","title":"Requirements","text":"<p>The SMTP configuration must be previously populated in the Jans Server. For this purpose you can use an administrative tool like TUI. Visit the SMTP section and fill the values requested. Ensure to run and pass the test presented before proceeding. Then, restart the authentication server.</p>","tags":["Casa","OTP"]},{"location":"casa/plugins/email-otp/#installation","title":"Installation","text":"","tags":["Casa","OTP"]},{"location":"casa/plugins/email-otp/#plugin","title":"Plugin","text":"<ol> <li> <p>Download the plugin jar file</p> </li> <li> <p>Login to Casa using an administrative account</p> </li> <li> <p>Visit <code>Administration console</code> &gt; <code>Casa plugins</code></p> <p></p> </li> <li> <p>Click on <code>Add a plugin...</code> and select the plugin file</p> </li> <li> <p>Click on <code>Add</code> and wait for one minute</p> </li> <li> <p>Visit the <code>Authentication methods</code> section of the admin console. Tick the <code>Registered e-mails</code> widget, drag it to the desired position, and finally hit <code>Save</code></p> </li> </ol>","tags":["Casa","OTP"]},{"location":"casa/plugins/email-otp/#agama-project","title":"Agama project","text":"<ol> <li> <p>Download the project archive</p> </li> <li> <p>Deploy the project onto the server - you can use TUI for this task</p> </li> <li> <p>Parameterize the project - you can use the project's sample configuration as a guide. The below summarizes the properties used:</p> <ul> <li><code>otp_length</code>: Number of digits the OTPs will have (passcode length)</li> <li><code>otp_lifetime</code>: Passcode expiration in minutes</li> <li><code>subject</code>: Subject to use in e-mail messages. You can use <code>%s</code> as a placeholder to insert the value of the generated OTP</li> <li><code>message</code>: Body of e-mail messages. You can use <code>%s</code> as a placeholder to insert the value of the generated OTP. Basic HTML markup is supported; ensure to properly escape characters like double quotes - keep in mind this is JSON content  </li> </ul> </li> <li> <p>Parameterize the <code>casa</code> project: in the <code>casa</code> project configuration, locate the <code>selector</code> section under <code>io.jans.casa.authn.main</code> flow and add an entry with key <code>io.jans.casa.authn.emailotp</code>. Assign an icon and a pointer to a short descriptive text. Example:</p> <pre><code>...\n\"io.jans.casa.authn.emailotp\": {\n    \"icon\": \"&lt;i class='fas fa-envelope' data-fa-transform='shrink-1'&gt;&lt;/i&gt;\",\n    \"textKey\": \"email2fa.selector_text\"\n}\n...\n</code></pre> </li> </ol>","tags":["Casa","OTP"]},{"location":"casa/plugins/email-otp/#test","title":"Test","text":"<ol> <li> <p>Create one or more testing users with real e-mail addresses associated to their accounts</p> </li> <li> <p>Log into casa with such users and enroll some credential, like a passkey. Then turn 2fA for them.</p> </li> <li> <p>Logout and login again. A new option for receiving OTPs via e-mail will be presented</p> </li> </ol>","tags":["Casa","OTP"]},{"location":"casa/plugins/email-otp/#user-guide","title":"User guide","text":"<p>Using the plugin is straightforward and does not require further explanation.</p>","tags":["Casa","OTP"]},{"location":"casa/plugins/accts-linking/account-linking-index/","title":"Accounts Linking Plugin","text":"<p>This plugin allows users to \"link\" their local Jans account with existing accounts at third-party identity providers like OIDC OPs and social sites, e.g. Apple, Facebook, Google, etc.</p> <p>Besides the usual onboarding of a plugin jar file in Casa, administrators must deploy a number of additional components. This will be regarded later. However let's summary the key points of the accounts linking experience:</p> <ul> <li>When a user tries to login to Casa, the usual username/password form is presented but also a list of links that can take him to external sites (third-party identity providers) where authentication takes place</li> <li>Once authenticated, user profile data is grabbed from the external site - this is all backchannel</li> <li>A process called attribute mapping is performed on profile data. This is a transformation process that turns incoming profile data into a shape compatible with a regular Jans database user entry</li> <li>If the mapped profile data matches an existing user in the Jans database, the existing entry is updated with the incoming data, otherwise, a new entry is inserted - this is called user provisioning. When provisioning occurs, the account has no password associated  </li> <li>Finally the user is given access to Casa</li> </ul> <p>From the perspective of a user already logged into Casa, the experience is as follows:</p> <ul> <li>In casa, a menu item is provided which takes the user to a (Casa) page that shows a list of third-party identity providers. For every provider there are options to trigger linking in case there is no account linked yet (external site authentication is launched), or to remove the linked account from the user profile </li> <li>If an account has no password assigned, removal of linked accounts is not allowed. However, a functionality for the user to assign himself a password is provided</li> </ul>","tags":["Casa","Accounts Linking"]},{"location":"casa/plugins/accts-linking/account-linking-index/#components-deployment","title":"Components deployment","text":"<p>The pieces that allow materialization of the experience summarized above are the following:</p> <p>a) The Casa plugin jar file</p> <p>b) The Agama inbound identity project</p> <p>c) The Casa accounts linking Agama project</p> <p>Most of work is demanded on setting up project c, where configuration of identity providers and attribute mapping tuning takes place.</p> <p>In the following, it is assumed you have a VM-based installation of Jans Server (or Gluu Flex) available with Casa installed. In a separate machine, ensure you have SSH/SCP/SFTP access to such server and <code>git</code> installed.</p> <ol> <li> <p>Download the plugin jar file <code>https://maven.jans.io/maven/io/jans/casa/plugins/acct-linking/0.0.0-nightly/acct-linking-0.0.0-nightly-jar-with-dependencies.jar</code> and copy to your server's <code>/opt/jans/jetty/jans-casa/plugins</code></p> </li> <li> <p>Download the utility jar file <code>https://maven.jans.io/maven/io/jans/agama-inbound/0.0.0-nightly/agama-inbound-0.0.0-nightly.jar</code> and copy to your server's <code>/opt/jans/jetty/jans-auth/custom/libs</code></p> </li> <li> <p>In TUI, visit the Clients screen, locate the client labeled \"Client for Casa\". Add the following redirect URI to the list: <code>https://&lt;your-jans-host&gt;/jans-casa/pl/acct-linking/user/interlude.zul</code>. Replace the name of your Jans server accordingly. Also, add the scope <code>https://jans.io/oauth/config/agama.readonly</code> to the list of scopes  </p> </li> <li> <p>Run the following commands to generate the archive of the Agama inbound identity project</p> <pre><code>git clone --depth 1 https://github.com/JanssenProject/jans.git\ncd jans/docs/agama-catalog/jans/inboundID/project\nzip -r inbound.zip *\n</code></pre> </li> <li> <p>Download the Casa accounts linking Agama project <code>https://maven.jans.io/maven/io/jans/casa/plugins/acct-linking-agama/0.0.0-nightly/acct-linking-agama-0.0.0-nightly-project.zip</code></p> </li> <li> <p>Transfer the two zip files to a location in the server, deploy both archives separately using TUI (Agama menu -&gt; \"Add a New Project\" ). So, there will be two projects: <code>casa-account-linking</code> and <code>agama-inbound-oauth</code>. </p> </li> <li> <p>Finally restart the authentication server</p> </li> </ol>","tags":["Casa","Accounts Linking"]},{"location":"casa/plugins/accts-linking/account-linking-index/#configuration","title":"Configuration","text":"<p>The first step is figuring out the external sites to support. Keep in mind only OpenID or OAuth 2.0 based providers can be onboarded. There is not support for SAML IDPs.</p> <p>The procedures for getting configuration settings in order to integrate third party providers vary widely. Here, only basic guidelines are given:</p> <ul> <li> <p>If the provider is OpenId-compliant and supports dynamic client registration, obtain the OP URL and the scopes list to use when requesting user profile information. Most of times the scopes <code>openid</code>, <code>profile</code> and <code>email</code> will fit the bill </p> </li> <li> <p>If the provider is OpenId-compliant and does not support dynamic client registration, obtain the OP URL and scopes as in the previous case, and also a client ID and secret</p> </li> <li> <p>If the provider does not support OpenId. Obtain the following:</p> <ul> <li>The authorization endpoint URL</li> <li>The token endpoint URL</li> <li>The endpoint URL where profile data can be retrieved</li> <li>Client credentials (ID and secret)</li> <li>Scopes to use when requesting user profile information</li> </ul> </li> </ul> <p>The steps required to grab the above data vary among providers. Normally this is obtained through a sort of administrative developer GUI tool. If you are prompted for a \"redirect URI\" in such tool, provide <code>https://&lt;your-jans-host&gt;/jans-auth/fl/callback</code>.</p> <p>Now it's time to supply the settings grabbed. The component these configurations are injected to is the Casa accounts linking Agama project. To make the effort easier, this project is bundled with some dummy configuration properties you can use as a template. Proceed as follows:</p> <ol> <li>In TUI, open the Agama tab and scroll through the list of projects until the <code>casa-account-linking</code> is highlighted</li> <li>Open the configuration management dialog (press <code>c</code>) and choose to export the sample configuration to a file on disk</li> <li>Apply changes as needed - this is covered in a separate doc page here. Note you can add or remove sections in the file at will, and that providers can also be disabled so they are not listed in the login page or in Casa app</li> <li>Still in TUI, choose to import the file you have edited</li> </ol> <p>For VM-based installations, update the file <code>/etc/default/jans-casa</code>. Locate a segment that reads <code>-Dacr=</code> and assign  <code>agama_io.jans.casa.authn.acctlinking</code> as new value. This will make Casa use the flow found in the accounts linking project - not the flow bundled out-of-the-box.</p> <p>Finally restart Casa and conduct your testing. You will now see the login page contains a list of links to the configured identity providers.</p>","tags":["Casa","Accounts Linking"]},{"location":"casa/plugins/accts-linking/accts-linking-agama/","title":"Accounts linking project configuration","text":"<p>The accounts linking Agama project must be configured in order to integrate third-party identity providers. The configuration of this project is supplied in a JSON file whose structure is like:</p> <pre><code>{\n\"io.jans.casa.authn.acctlinking\": {\n\n    \"providerID_1\": { ... },\n    \"providerID_2\": { ... },\n    ...\n}\n}\n</code></pre> <p>Each property part of the JSON object <code>io.jans.casa.auth.acctlinking</code> holds the configuration of a different identity provider. Here's a how a typical configuration of a provider looks like:</p> <pre><code>{\n    \"displayName\": \"Goooogle\",\n    \"flowQname\": \"io.jans.inbound.GenericProvider\",\n    \"mappingClassField\": \"io.jans.casa.acctlinking.Mappings.GOOGLE\",    \n    \"oauthParams\": {\n        \"authzEndpoint\": \"https://accounts.google.com/o/oauth2/v2/auth\",\n        \"tokenEndpoint\": \"https://oauth2.googleapis.com/token\",\n        \"userInfoEndpoint\": \"https://www.googleapis.com/oauth2/v3/userinfo\",\n        \"clientId\": \"202403151302\",\n        \"clientSecret\": \"m|a1l2d3i4t5a6S7h8a9k0i'r\u00bfa\",\n        \"scopes\": [\"email\", \"profile\"]\n    }\n}\n</code></pre> <p>In this case, we are populating the configuration of an OAuth-based provider called \"Goooogle\".</p> <p>The tables shown in this page list all possible properties to configure a provider. Particularly, two properties deserve the most detail:</p> <ol> <li> <p><code>flowQname</code>. Agama projects are made up of flows - think of small \"web journeys\". This property must contain the name of an existing flow capable of interfacing with the identity provider of interest. Often, there is no need to write such \"interfacing\" flow. The below are ready-to-use and cover most of real-world cases, specifically  OpenId/OAuth providers that support the authorization code grant (see section 1.3 of rfc6749):</p> <ul> <li> <p><code>io.jans.inbound.GenericProvider</code>. It implements the authorization code flow where the user's browser is taken to the external site. When authentication completes, a <code>code</code> is received at a designated redirect (callback) URL. With such <code>code</code> an access token is obtained as well as user's profile data. This flow supports dynamic client registration</p> </li> <li> <p><code>io.jans.inbound.Apple</code>. It implements the authorization code flow with some nuances required in order to integrate \"Apple Sign In\"</p> </li> </ul> </li> <li> <p><code>mappingClassField</code>. This is key for performing the attribute mapping process and the user provisioning. The remainder of this document is dedicated to these two aspects</p> </li> </ol> <p>Note</p> <p>Recall <code>enabled</code> is a handy property that can be used to temporarily \"deactive\" a given identity provider.</p>","tags":["Casa","Accounts Linking","Agama"]},{"location":"casa/plugins/accts-linking/accts-linking-agama/#configuring-attribute-mappings","title":"Configuring attribute mappings","text":"<p>An introduction to attribute mapping can be found here. Unless an elaborated processing of attributes is required, a basic knowledge of Java language suffices to write a useful mapping.</p> <p>To write a mapping, you can use the samples provided as a guideline (see folder <code>lib/io/jans/casa/acctlinking</code> in the Agama accounts linking project). You can add your mapping in the same file or create a new Java class for this purpose.  Then save your changes, re-package (zip) the project, re-deploy, and update (re-import) the configuration if necessary.</p> <p>Specifically, for Casa accounts linking, the mapping must include an attribute named <code>ID</code>. While <code>ID</code> is not part of the Jans database, here it is used to supply what could be understood as the identifier of the user at the external site. For instance, in a social site this may be the username or email. The example below shows how to set <code>ID</code> assuming the username was returned by the external site in an attribute named <code>userId</code>:</p> <pre><code>profile -&gt; {\n    Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();\n\n    map.put(\"ID\", profile.get(\"userId\"));\n    ...\n    return map;\n}\n</code></pre> <p>In the above example, <code>profile</code> is a <code>Map&lt;String, Object&gt;</code> that holds the attribute-value pairs the third-party identity provider released for this user. For the interested, <code>profile</code> contents are dumped to the server logs (check <code>jans-auth_script.log</code>) so it is easy to peak into the values. Check for a message in <code>debug</code> level starting with \"Profile data\".</p> <p>Both the ID of identity provider and the ID of the user will end up stored in an auxiliary database attribute. This helps to identify if the incoming user is already known (has been onboarded previously).</p> <p>When the attribute mapping is applied, the <code>uid</code> attribute is set as well. This is the username the incoming user will be assigned in the local Jans database. The <code>uid</code> is automatically generated based on <code>ID</code> unless the mapping already populates the <code>uid</code> directly.</p> <p>The return value of the mapping is a <code>Map&lt;String, Object&gt;</code>. This caters for cases where resulting attributes hold booleans, dates, numbers, strings, etc. When the attribute has to hold multiple values, you can use an array or a Java <code>Collection</code> object, like a <code>List</code>.</p>","tags":["Casa","Accounts Linking","Agama"]},{"location":"casa/plugins/accts-linking/accts-linking-agama/#user-provisioning","title":"User provisioning","text":"<p>After attribute mapping occurs, the local database is checked to determine if the incoming user is known (based on the <code>ID</code> in the mapping and the ID of the provider in question). If no match is found, the user is onboarded: a new entry is created in the database using the information found in the resulting mapping. Otherwise, the exact behavior varies depending on the provider configuration as follows:</p> <ul> <li>If <code>skipProfileUpdate</code> is set to <code>false</code>, the existing database entry is left untouched, otherwise:</li> <li>If <code>cumulativeUpdate</code> is set to <code>false</code>, the existing attributes in the entry which are part of the mapping are overwritten</li> <li>If <code>cumulativeUpdate</code> is set to <code>true</code>, the existing attribute values in the entry are preserved and new values are added if present in the mapping</li> </ul> <p>The updates just referenced apply to the matching entry based on mapping and provider ID, however, when <code>emailLinkingSafe</code> is set to <code>true</code> and the mapping comes with a <code>mail</code> value equal to an existing e-mail in the database, the update is carried over the e-mail matching entry.</p>","tags":["Casa","Accounts Linking","Agama"]},{"location":"cedarling/","title":"An Overview of The Cedarling","text":"<p>The Cedarling, powered by the Rust Cedar engine, provides a fast, embeddable, and self-contained solution for policy-based authorization, designed for both client-side and server-side enforcement. This makes it particularly well-suited for latency-sensitive environments like databases, browser-based applications, mobile apps, API gateways, and embedded devices. At less than 2M in size, it's small enough to load into your browser or mobile application. When embedded, the Cedarling avoids slow cloud policy decisions, enabling sub-millisecond performance. The Cedarling never fetches data to make a decision--this is a performance killer and would make the PDP unreliable. The application must fetch all data and tokens before it makes an authorization request.</p> <p>The Cedarling can be:</p> <ul> <li>Embedded in browsers using the WASM npm package</li> <li>Embedded in mobile apps using the iOS or Android SDKs</li> <li>Integrated into backend services using the Java, Go, Rust, Python, or C SDKs</li> <li>Deployed as a sidecar</li> <li>Deployed as a centralized cloud PDP service</li> </ul> <p></p> <p>The Cedarling is not merely a library--it is an embeddable Policy Decision Point (PDP), which includes an in-memory cache to enable efficient logging. It connects to a Policy Repository to obtain its policies. Enterprises may also want to connect the Cedarling to a hub system to send its audit logs--a record of every decision to allow or deny access to a capability. From the hub system, enterprises can perform threat detection and stream the logs to a SIEM or ITDR.</p> <p>The supports JWT validation and claims mapping through some of its authorization interfaces. We call this Token Based Access Control--where developers present a collection of tokens to obtain authorization to a capability. JWTs provide trusted contextual information to the Cedarling.  The payload of a JWT token is a JSON document, and frequently a complex string, like a URI. Through the use of regular expressions, developers can parse strings and map them to Cedar entities. This provides a mechanism to map data from trusted issuers to Cedar policies.</p> <p>About Cedar</p> <p>Cedar is a policy syntax invented by Amazon and used by  its Verified Permission service. Cedar  policies enable developers to implement fine-grain access control and externalize  policies. Cedar is a CNCF candidate project. To learn more about why the design of Cedar  is intuitive, fast and safe, check out this article  or watch this video</p> <p>If you're wondering how Cedar compares to Rego or OpenFGA, read this  white paper.</p> <p>These Cedarling docs assume you have a basic understanding of Cedar policy syntax and  language features.</p> <p>On initialization, the Cedarling loads a \"policy store\" -- a set of policies, a schema, and a list of trusted token issuers. Policy stores are application-specific, meaning each store does not contain all policies and schema for all applications in your domain. Each policy store has unique policies and a schema needed only for one specific application.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/#cedarling-interfaces","title":"Cedarling Interfaces","text":"<p>At a high level, developers interact with the Cedarling using six core interfaces:</p> <ul> <li>Initialization (<code>init</code>) \u2013 Loads the policy store and retrieves configuration settings.</li> <li>Authorization (<code>authorize</code>) \u2013 Evaluates policies by sending a bundle of JWTs to specify the principal.</li> <li>Authorization (<code>authorize_unsigned</code>) \u2013 Evaluates policies with an application asserted principal.</li> <li>Multi-Issuer Authorization (<code>authorize_multi_issuer</code>) \u2013 Evaluates policies based on multiple JWT tokens from different issuers without requiring traditional user/workload principals.</li> <li>Context Data API (<code>data</code>) \u2013 Pushes external data into the evaluation context, making it available in Cedar policies through the <code>context.data</code> namespace.</li> <li>Logging (<code>log</code>) \u2013 Retrieves decision and system logs for auditing. </li> </ul> <p>Developers call the <code>init</code> interface on startup of their application, causing the Cedarling to read its bootstrap properties and load its policy store. If configured for JWT validation, the Cedarling will fetch the most recent issuer public keys and metadata.</p> <p>The standard <code>authorize</code> method answers the question: \"Is this action, on this resource, given this context, allowed with these JWTs?\". The Cedarling returns the decision--allow or deny. If denied, the Cedarling returns \"diagnostics\"--additional context to clarify why the decision was not allowed. During <code>authz</code>, the Cedarling can perform two more important jobs: (1) validate JWT tokens; (2) log the resulting decision.</p> <p>The <code>authorize_unsigned</code> variant is used when JWTs have already been validated by the application, or when working with non-token based principals. It follows the same evaluation logic but skips JWT validation steps.</p> <p>The <code>authorize_multi_issuer</code> method is designed for scenarios where applications need to evaluate authorization based on multiple JWT tokens from different issuers in a single request. Unlike the standard <code>authorize</code> method which creates traditional User and Workload principals, this method evaluates policies based purely on the token entities themselves. Each token is validated, converted to a Cedar entity, and made available in the policy evaluation context. This approach is particularly useful for federation scenarios, API gateways handling tokens from multiple identity providers, or applications where authorization depends on capabilities asserted by different issuers rather than a single user identity. Policies can reference individual tokens using predictable naming conventions like <code>context.tokens.acme_access_token</code> or <code>context.tokens.google_id_token</code>.</p> <p>The <code>data</code> interface enables developers to push external data into the Cedarling's evaluation context. This data is automatically injected under the <code>context.data</code> namespace during policy evaluation, allowing policies to make decisions based on dynamically pushed data. Data can be stored with optional TTL (Time To Live) for automatic expiration. See the Cedarling interfaces documentation for more information.</p> <p>The <code>log</code> interface enables developers to retrieve decision and system logs from the Cedarling's in-memory cache. See the Cedarling log documentation for more information.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/#cedarling-components","title":"Cedarling Components","text":"<p>The following diagram is a high-level picture of the Cedarling components:</p> <p></p> <ul> <li>Cedar Engine a recent release of the Rust Cedar Engine, thanks to Amazon.</li> <li>SparKV is an in-memory key-value store that supports automatic expiration of data.</li> <li>Interfaces perform actions described above</li> <li>JWT Engine is used to validate JWT signatures, JWT content (e.g., <code>exp</code>), and to    check if the JWT token is revoked (using the Status List JWT) </li> <li>Lock Engine is used for enterprise deployments to load the Policy Store from a    trusted source and send logs for central storage. </li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/#token-based-access-control-tbac-v-application-asserted-identity","title":"Token Based Access Control (TBAC) v. Application Asserted Identity","text":"<p>The Cedarling has two different authorization interfaces. One requires the developer to provide JWTs to prove the identity of the principal: \"It's Bob, and here's the token to prove it!\" The other allows the application to assert the identity of the principal: \"It's Bob, trust me, I authenticated him.\"</p> <p>It's actually more powerful than that. The Cedarling allows the developer to pass not one token, but several tokens. This enables the developer to assert not only the human identity, but the software identities (or \"Workload\") that were involved in the issuance of the token. Token Based Access Control (TBAC) answers the question: \"Given this bundle of tokens, is this action on this resource allowed in this context?\" Or you could say more simply, \"Does this bundle of tokens authorize this capability?\" While RBAC policies are about roles, ABAC policies are about attributes, TBAC policies are about tokens.</p> <p>TBAC helps developers implement security based on JWTs from trusted issuers like identity providers, hardware platforms, and federations. One of the Cedarling authorization interfaces automatically creates a User and Workload entity based on the most common OAuth and OpenID tokens. A new Cedarling authorization interface will enable reasoning on a collection of tokens from different issuers(watch the issue Jans-11834).</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/#cedarling-and-zero-trust","title":"Cedarling and Zero Trust","text":"<p>Zero Trust is a modern security model that assumes no implicit trust\u2014every request must be explicitly authorized based on policies, identity, and context. The Cedarling enables end-to-end Zero Trust enforcement by embedding fine-grained authorization across the entire security stack, from client devices to backend services and databases.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/#end-to-end-authorization-enforcement","title":"End-to-End Authorization Enforcement","text":"<p>The Cedarling can be deployed at every layer to ensure that access decisions are consistently enforced. The diagram below illustrates how the Cedarling operates in a hypothetical mobile application architecture:</p> <p></p> <ol> <li>Identity Provider (IDP) Enforcement </li> <li>The IDP can use the Cedarling to determine if a mobile application should be allowed      to register.  </li> <li> <p>Example: An IDP policy might restrict registration to applications that present a      valid Software Statement Assertion (SSA) or Google Play Integrity Attestation.</p> </li> <li> <p>Client-Side Authorization in Mobile and Web Apps </p> </li> <li>A mobile application can embed the Cedarling to enforce real-time access control      before exposing UI components or calling APIs.  </li> <li> <p>Example: A finance app may check if a user's token has elevated risk signals (e.g.,      logging in from a new device) before enabling high-risk transactions.</p> </li> <li> <p>API Gateway Enforcement </p> </li> <li>API gateways can use the Cedarling to validate JWT claims and scope permissions      before forwarding requests to backend services.  </li> <li> <p>Example: A gateway might block API requests missing a valid <code>admin</code> scope or ensure      an OAuth token is not revoked.</p> </li> <li> <p>Backend Service Authorization </p> </li> <li>The backend server can re-evaluate authorization decisions, ensuring end-to-end      security rather than trusting the API gateway or mobile app.  </li> <li> <p>Example: Even if a request passes through an API gateway, the backend can recheck      authorization policies to prevent privilege escalation.</p> </li> <li> <p>Database-Level Policy Enforcement </p> </li> <li>The Cedarling can be embedded within databases to filter data at query time,      ensuring only authorized records are returned.  </li> <li>Example: A multi-tenant SaaS application may enforce row-level security, so a user      can only access their own organization's data.</li> </ol>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/#why-zero-trust-needs-cedarlings","title":"Why Zero Trust Needs Cedarlings","text":"<p>Traditional access control models assume network perimeters are secure, leading to excessive trust in internal components. The Cedarling aligns with Zero Trust by:</p> <ul> <li>Eliminating implicit trust\u2014each authorization decision is enforced based on real-time    policies.</li> <li>Improving re-usability of policies across applications to enable multi-layer security</li> <li>Ensuring consistent policies\u2014from client devices to backend services and databases,    enforcing the same security rules everywhere.</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/#cedarling-and-threat-detection","title":"Cedarling and Threat Detection","text":"<p>Beyond enforcing policies, the Cedarling plays a role in intrusion detection by logging every decision. These logs can be analyzed in a SIEM (Security Information and Event Management) system to detect: - Unusual access patterns (e.g., a user requesting sensitive data from an unrecognized   location). - Token misuse (e.g., an expired JWT being replayed). - Privilege escalation attempts (e.g., a non-admin trying to access admin-only APIs).</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/#zero-trust-conclusion","title":"Zero Trust Conclusion","text":"<p>By embedding the Cedarling across multiple layers of the application stack, organizations can enforce Zero Trust security, reduce unauthorized access, and gain visibility into access patterns. Whether it's protecting frontend applications, securing API gateways, or enforcing access policies at the database level, the Cedarling ensures every request is explicitly authorized everywhere.</p> <p>Why is it \"The Cedarling\"</p> <p>In every system where it runs, the Cedarling becomes the guardian of policy, the  gatekeeper of decisions. It\u2019s lightweight, fast, and embedded close to the action\u2014 evaluating access at the speed of the web. Like the kernel, the compiler, or the  firewall, it earns the definite article because it does something definite. It stands in  your stack, quiet but crucial, deciding who gets through. The Cedarling isn\u2019t a library.  It\u2019s a presence.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/developer/cedarling-kotlin/","title":"Cedarling Java binding","text":"<p>UniFFI (Universal Foreign Function Interface) is a tool developed by Mozilla to simplify cross-language bindings, primarily between Rust and other languages like Kotlin, Swift, and Python. It allows Rust libraries to be used in these languages without manually writing complex foreign function interface (FFI) bindings.</p> <p>Please refer to this document for details on the structs, enums, and functions exposed by UniFFI bindings. This section outlines the process of generating the Kotlin binding for Cedarling using Cedarling UniFFI. The Kotlin binding is then wrapped in a Java class to enable convenient use in Java applications.</p>"},{"location":"cedarling/developer/cedarling-kotlin/#building-from-source","title":"Building from Source","text":"<p>Apart from using the Cedarling binding using the package manager, you can also build it from source.</p>"},{"location":"cedarling/developer/cedarling-kotlin/#prerequisites","title":"Prerequisites","text":"<ul> <li>Rust: Install it from the official Rust website.</li> <li>Java Development Kit (JDK): version 11 </li> <li>Apache Maven: Install it from Apache Maven Website</li> </ul>"},{"location":"cedarling/developer/cedarling-kotlin/#building","title":"Building","text":"<ul> <li>Build Cedarling by executing below command from <code>./jans/jans-cedarling</code> of cloned jans project:    <pre><code>cargo build -r -p cedarling_uniffi\n</code></pre>    In <code>target/release</code>, you should find the <code>libcedarling_uniffi.dylib</code> (if Mac OS), <code>libcedarling_uniffi.so</code> (if Linux OS), or <code>libcedarling_uniffi.dll</code> (if Windows OS) file, depending on the operating system you are using.</li> </ul> <p>Note</p> <p>You can use pre-built <code>libcedarling_uniffi.so</code> from the Jans releases page if you are using Linux OS.</p> <ul> <li>Generate the bindings for Kotlin by running the command below. Replace <code>{build_file}</code> with <code>libcedarling_uniffi.dylib</code>, <code>libcedarling_uniffi.so</code>, or <code>libcedarling_uniffi.dll</code>, depending on which file is generated in <code>target/release</code>.    <pre><code>cargo run --bin uniffi-bindgen generate --library ./target/release/{build_file} --language kotlin --out-dir ./bindings/cedarling-java/src/main/kotlin/io/jans/cedarling\n</code></pre></li> </ul> <p>Note</p> <p>You can use pre-built kotlin binding (<code>cedarling_uniffi-kotlin-{version}.zip</code>) from the Jans releases page.</p> <ul> <li> <p>Copy the generated <code>libcedarling_uniffi.dylib</code>, <code>libcedarling_uniffi.so</code>, or <code>libcedarling_uniffi.dll</code> file to resource directory of the <code>cedarling-java</code> Maven project. Replace <code>{build_file}</code> in the below commad with <code>libcedarling_uniffi.dylib</code>, <code>libcedarling_uniffi.so</code>, or <code>libcedarling_uniffi.dll</code>, depending on which file is generated in <code>target/release</code>.    <pre><code>mkdir ./bindings/cedarling-java/src/main/resources\ncp ./target/release/{build_file} ./bindings/cedarling-java/src/main/resources\n</code></pre></p> </li> <li> <p>Change directory to <code>./bindings/cedarling-java</code> and run below command to build <code>cedarling-java</code> jar file. This will generate <code>cedarling-java-{version}-distribution.jar</code> at <code>./bindings/cedarling-java/target/</code>.    <pre><code> mvn clean install\n</code></pre></p> </li> </ul>"},{"location":"cedarling/developer/cedarling-kotlin/#recipes","title":"Recipes","text":""},{"location":"cedarling/developer/cedarling-kotlin/#use-the-cedarling-java-binding-in-custom-scripts","title":"Use the Cedarling Java binding in custom scripts","text":"<p>Here is a simple recipe to add scopes in access-token using update_token script only if the requesting client has <code>authorization_code</code> grant-type. We will use below policy for this:</p> <pre><code>@id(\"Allow if the grant type is authorization_code\")\npermit (\n  principal is Jans::Workload,\n  action == Jans::Action::\"Execute\",\n  resource is Jans::Application\n)\nwhen {\n  principal.grantTypes.contains(\"authorization_code\")\n};\n</code></pre> <p>Steps:</p> <ul> <li>Upload bootstrap.json and policy-store.json at <code>/opt/jans/jetty/jans-auth/custom/static</code> location of the auth server. The Asset Screen can be used to upload assets.</li> <li>Upload the generate <code>cedarling-java-{version}.jar</code> at <code>/opt/jans/jetty/jans-auth/custom/libs</code> location of the auth server.</li> </ul> <p>Note</p> <p>Rather than building the cedarling-java-{version}.jar from source code, you can directly download the latest version of the jar from the Maven repository.</p> <ul> <li>The following java Update Token script has been created for calling Cedarling authorization. Enable the script with following Custom Properties:</li> </ul> Key Values BOOTSTRAP_JSON_PATH ./custom/static/bootstrap.json <ul> <li> <p>Map the script with the client used to perform authentication.    </p> </li> <li> <p>The script runs before access_token generation and includes <code>openid</code> and <code>profile</code> scopes into the token if the oidc client has <code>authorization_code</code> in grant-types. </p> </li> </ul>"},{"location":"cedarling/developer/cedarling-kotlin/#build-a-sample-java-project-using-the-kotlin-binding","title":"Build a sample Java Project using the Kotlin binding","text":"<ol> <li> <p>Build Cedarling by executing below command from <code>./jans/jans-cedarling</code> of cloned jans project:     <pre><code>cargo build -r -p cedarling_uniffi\n</code></pre>    In <code>target/release</code>, you should find the <code>libcedarling_uniffi.dylib</code> (if Mac OS), <code>libcedarling_uniffi.so</code> (if Linux OS), or <code>libcedarling_uniffi.dll</code> (if Windows OS) file, depending on the operating system you are using.</p> </li> <li> <p>Generate the bindings for Kotlin by running the command below. Replace <code>{build_file}</code> with <code>libcedarling_uniffi.dylib</code>, <code>libcedarling_uniffi.so</code>, or <code>libcedarling_uniffi.dll</code>, depending on which file is generated in <code>target/release</code>.     <pre><code>cargo run --bin uniffi-bindgen generate --library ./target/release/{build_file} --language kotlin --out-dir ./bindings/cedarling_uniffi/javaApp/src/main/kotlin/org/example\n</code></pre></p> </li> <li> <p>Copy the generated <code>libcedarling_uniffi.dylib</code>, <code>libcedarling_uniffi.so</code>, or <code>libcedarling_uniffi.dll</code> file to resource directory of the sample Java Maven project. Replace <code>{build_file}</code> in the below commad with <code>libcedarling_uniffi.dylib</code>, <code>libcedarling_uniffi.so</code>, or <code>libcedarling_uniffi.dll</code>, depending on which file is generated in <code>target/release</code>.     <code>bash     cp ./target/release/{build_file} ./bindings/cedarling_uniffi/javaApp/src/main/resources</code>git add </p> </li> <li> <p>Change directory to sample Java project (<code>./bindings/cedarling_uniffi/javaApp</code>) and run below command to run the main method of a Maven project from the terminal.     <pre><code> mvn clean install\n mvn exec:java -Dexec.mainClass=\"org.example.Main\"\n</code></pre> The method will execute the steps for Cedarling initialization with a sample bootstrap configuration, run authorization with sample tokens, resource and context inputs and call log interface to print authorization logs on console.</p> </li> </ol> <p>Note the following points in the sample Java Maven project to understand the changes required for using the Kotlin binding in other Java projects.</p> <ul> <li>The sample <code>tokens</code>, <code>resource</code> and <code>context</code> input files along with files containing <code>bootstrap configuration</code> and <code>policy- store</code> used by the sample application are present at <code>./bindings/cedarling_uniffi/javaApp/src/main/resources/config</code>.</li> <li>Refer to the Java code in org.example.Main to see how Cedarling's <code>init</code>, <code>authz</code>, and <code>log</code> interfaces are called using the Kotlin binding.</li> </ul>"},{"location":"cedarling/developer/cedarling-kotlin/#required-dependencies","title":"Required Dependencies","text":"<p>Add the following dependencies in the pom.xml.</p> <ul> <li> <p>Java Native Access (JNA): A Java library that allows Java code to call native shared libraries (like .so on Linux, .dll on Windows, or .dylib on macOS) without writing JNI (Java Native Interface) code.</p> </li> <li> <p>kotlinx.coroutines: Adds support for asynchronous programming using coroutines.</p> </li> <li> <p>kotlin-stdlib-jdk: The kotlin-stdlib-jdk8 library is a variant of the Kotlin standard library that includes additional features specifically designed to work with JDK 8 (Java Development Kit 8) or higher.</p> </li> <li> <p>nimbus-jose-jwt: The nimbus-jose-jwt library is a Java library used for working with JWTs (JSON Web Tokens) and JOSE (JavaScript Object Signing and Encryption) standards</p> </li> <li> <p>jackson-databind: The jackson-databind library is a core module of the Jackson JSON processing framework in Java</p> </li> </ul>"},{"location":"cedarling/developer/cedarling-rust/","title":"Cedarling Rust Developer Guide","text":"","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#including-in-the-project","title":"Including in the project","text":"<p>The Cedarling library is not yet uploaded to crates.io, so the only way to use it right now is by including it directly from the source in your project.</p> <p>1. Clone the Jans repository</p> <pre><code>git clone https://github.com/JanssenProject/jans.git\ncd jans/jans-cedarling/cedarling\n</code></pre> <p>2. Add to your <code>Cargo.toml</code></p> <pre><code>[dependencies]\ncedarling = { path = \"path/to/jans/jans-cedarling/cedarling\" }\nserde = { version = \"1.0\", features = [\"derive\"] }\nserde_json = \"1.0\"\ntokio = { version = \"1.0\", features = [\"full\"] }\n</code></pre> <p>3. Alternative: Using Git Dependency</p> <pre><code>[dependencies]\ncedarling = { git = \"https://github.com/JanssenProject/jans\", package = \"cedarling\" }\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#building","title":"Building","text":"","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#building-cedarling","title":"Building Cedarling","text":"<p>To build an executable library for Cedarling, follow the instructions here.</p>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#building-examples","title":"Building Examples","text":"<p>The Cedarling project includes several examples that demonstrate different use cases. Follow the steps below to build these examples.</p>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#building-examples_1","title":"Building Examples","text":"<p>1. Clone the repository</p> <pre><code>git clone https://github.com/JanssenProject/jans.git\ncd jans/jans-cedarling\n</code></pre> <p>2. Build the library</p> <pre><code>cargo build --release\n</code></pre> <p>3. Run tests</p> <pre><code>cargo test --workspace\n</code></pre> <p>4. Generate documentation</p> <pre><code>cargo doc -p cedarling --no-deps --open\n</code></pre> <p>5. Build examples</p> <pre><code># Run JWT validation example\ncargo run -p cedarling --example authorize_with_jwt_validation\n\n# Run unsigned authorization example\ncargo run -p cedarling --example authorize_unsigned\n\n# Stdout logging\ncargo run -p cedarling --example log_init -- stdout\n\n# Memory logging with TTL\ncargo run -p cedarling --example log_init -- memory 3600\n\n# Disable logging\ncargo run -p cedarling --example log_init -- off\n\n# Lock Server Integration\ncargo run -p cedarling --example lock_integration\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#complete-example","title":"Complete Example","text":"<p>Here's a complete example showing initialization, authorization, and logging:</p> <pre><code>use cedarling::*;\nuse std::collections::{HashMap, HashSet};\nuse jsonwebtoken::Algorithm;\nuse serde_json::json;\n\nstatic POLICY_STORE_YAML: &amp;str = include_str!(\"../../test_files/policy-store_ok.yaml\");\n\n#[tokio::main]\nasync fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {\n    // Initialize Cedarling\n    let cedarling = Cedarling::new(&amp;BootstrapConfig {\n        application_name: \"example_app\".to_string(),\n        log_config: LogConfig {\n            log_type: LogTypeConfig::Memory(MemoryLogConfig {\n                log_ttl: 3600, // 1 hour\n                max_item_size: None,\n                max_items: None,\n            }),\n            log_level: LogLevel::INFO,\n        },\n        policy_store_config: PolicyStoreConfig {\n            source: PolicyStoreSource::Yaml(POLICY_STORE_YAML.to_string()),\n        },\n        jwt_config: JwtConfig {\n            jwks: None,\n            jwt_sig_validation: false,\n            jwt_status_validation: false,\n            signature_algorithms_supported: HashSet::new(),\n        }.allow_all_algorithms(),\n        authorization_config: AuthorizationConfig {\n            use_user_principal: true,\n            use_workload_principal: true,\n            principal_bool_operator: JsonRule::new(serde_json::json!(\n                {\"===\": [{\"var\": \"Jans::User\"}, \"ALLOW\"]}\n            )).unwrap(),\n            ..Default::default()\n        },\n        entity_builder_config: EntityBuilderConfig::default()\n            .with_user()\n            .with_workload(),\n        lock_config: None,\n    }).await?;\n\n    // Perform unsigned authorization\n    let principals = vec![EntityData {\n        cedar_entity_mapping: CedarEntityMapping {\n            entity_type: \"Jans::User\".to_string(),\n            id: \"test_user\".to_string(),\n        },\n        attributes: HashMap::from_iter([\n            (\"roles\".to_string(), json!([\"admin\"])),\n            (\"email\".to_string(), json!(\"admin@example.com\")),\n        ]),\n    }];\n\n    let resource = EntityData {\n        cedar_entity_mapping: CedarEntityMapping {\n            entity_type: \"Jans::Application\".to_string(),\n            id: \"admin_panel\".to_string(),\n        },\n        attributes: HashMap::from_iter([\n            (\"permission_level\".to_string(), json!(\"admin\")),\n        ]),\n    };\n\n    let request = RequestUnsigned {\n        principals,\n        action: r#\"Jans::Action::\"Read\"\"#.to_string(),\n        resource,\n        context: json!({}),\n    };\n\n    let result = cedarling.authorize_unsigned(request).await?;\n    println!(\"Authorization result: {}\", result.decision);\n\n    // Retrieve logs\n    let logs = cedarling.pop_logs();\n    println!(\"Retrieved {} log entries\", logs.len());\n\n    Ok(())\n}\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#api-reference","title":"API Reference","text":"","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#core-types","title":"Core Types","text":"<ul> <li> <p><code>Cedarling</code></p> <p>The main struct for interacting with Cedarling.</p> <pre><code>pub struct Cedarling {\n    // Implementation details\n}\n</code></pre> </li> </ul>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#bootstrapconfig","title":"<code>BootstrapConfig</code>","text":"<p>Configuration for initializing Cedarling.</p> <pre><code>pub struct BootstrapConfig {\n    pub application_name: String,\n    pub log_config: LogConfig,\n    pub policy_store_config: PolicyStoreConfig,\n    pub jwt_config: JwtConfig,\n    pub authorization_config: AuthorizationConfig,\n    pub entity_builder_config: EntityBuilderConfig,\n    pub lock_config: Option&lt;LockConfig&gt;,\n}\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#request","title":"<code>Request</code>","text":"<p>Token-based authorization request.</p> <pre><code>pub struct Request {\n    pub tokens: HashMap&lt;String, String&gt;,\n    pub action: String,\n    pub resource: EntityData,\n    pub context: serde_json::Value,\n}\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#requestunsigned","title":"<code>RequestUnsigned</code>","text":"<p>Unsigned authorization request.</p> <pre><code>pub struct RequestUnsigned {\n    pub principals: Vec&lt;EntityData&gt;,\n    pub action: String,\n    pub resource: EntityData,\n    pub context: serde_json::Value,\n}\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#entitydata","title":"<code>EntityData</code>","text":"<p>Represents an entity in the authorization system.</p> <pre><code>pub struct EntityData {\n    pub cedar_entity_mapping: CedarEntityMapping,\n    pub attributes: HashMap&lt;String, serde_json::Value&gt;,\n}\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#cedarentitymapping","title":"<code>CedarEntityMapping</code>","text":"<p>Represents the entity type and id mapping.</p> <pre><code>pub struct CedarEntityMapping {\n    pub entity_type: String,\n    pub id: String,\n}\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#main-methods","title":"Main Methods","text":"","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#cedarlingnew","title":"<code>Cedarling::new()</code>","text":"<p>Initialize a new Cedarling instance.</p> <pre><code>pub async fn new(config: &amp;BootstrapConfig) -&gt; Result&lt;Self, CedarlingError&gt;\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#authorize","title":"<code>authorize()</code>","text":"<p>Perform token-based authorization.</p> <pre><code>pub async fn authorize(&amp;self, request: Request) -&gt; Result&lt;AuthorizeResult, CedarlingError&gt;\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#authorize_unsigned","title":"<code>authorize_unsigned()</code>","text":"<p>Perform unsigned authorization.</p> <pre><code>pub async fn authorize_unsigned(&amp;self, request: RequestUnsigned) -&gt; Result&lt;AuthorizeResult, CedarlingError&gt;\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#pop_logs","title":"<code>pop_logs()</code>","text":"<p>Retrieve and clear all logs.</p> <pre><code>pub fn pop_logs(&amp;self) -&gt; Vec&lt;LogEntry&gt;\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#get_log_ids","title":"<code>get_log_ids()</code>","text":"<p>Get all available log IDs.</p> <pre><code>pub fn get_log_ids(&amp;self) -&gt; Vec&lt;String&gt;\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#get_log_by_id","title":"<code>get_log_by_id()</code>","text":"<p>Get a specific log entry by ID.</p> <pre><code>pub fn get_log_by_id(&amp;self, id: &amp;str) -&gt; Option&lt;LogEntry&gt;\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#configuration","title":"Configuration","text":"","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#bootstrap-properties","title":"Bootstrap Properties","text":"<p>Cedarling can be configured using bootstrap properties. See the bootstrap properties documentation for complete configuration options.</p>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#environment-variables","title":"Environment Variables","text":"<p>You can also configure Cedarling using environment variables:</p> <pre><code>export CEDARLING_APPLICATION_NAME=\"my_app\"\nexport CEDARLING_LOG_TYPE=\"stdout\"\nexport CEDARLING_LOG_LEVEL=\"INFO\"\nexport CEDARLING_POLICY_STORE_LOCAL_FN=\"/path/to/policy-store.yaml\"\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#configuration-loading","title":"Configuration Loading","text":"<pre><code>use cedarling::*;\n\n// Load from environment variables\nlet config = BootstrapConfig::from_env();\n\n// Load from JSON string\nlet config = BootstrapConfig::from_json(json_string)?;\n\n// Load from file\nlet config = BootstrapConfig::from_file(\"config.json\")?;\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#testing-and-debugging","title":"Testing and Debugging","text":"","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#running-tests","title":"Running Tests","text":"<pre><code># Run all tests\ncargo test --workspace\n\n# Run specific test\ncargo test -p cedarling test_name\n\n# Run tests with output\ncargo test -- --nocapture\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#running-benchmarks","title":"Running Benchmarks","text":"<pre><code># Run all benchmarks\ncargo bench -p cedarling\n\n# Run specific benchmark\ncargo bench -p cedarling benchmark_name\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#code-coverage","title":"Code Coverage","text":"<pre><code># Install coverage tool\ncargo install cargo-llvm-cov\n\n# Generate coverage report\ncargo llvm-cov --html --open\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#profiling","title":"Profiling","text":"<pre><code># Run profiling example\ncargo run --example profiling\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#debugging","title":"Debugging","text":"<p>Enable debug logging:</p> <pre><code>let config = BootstrapConfig {\n    log_config: LogConfig {\n        log_level: LogLevel::DEBUG,\n        ..Default::default()\n    },\n    // ... other config\n};\n</code></pre>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/cedarling-rust/#see-also","title":"See Also","text":"<ul> <li>Getting Started with Cedarling Rust</li> <li>Cedarling TBAC quickstart</li> <li>Cedarling Unsigned quickstart</li> <li>Cedarling Sidecar Tutorial</li> <li>Cedarling Properties</li> </ul>","tags":["cedarling","rust","developer","documentation"]},{"location":"cedarling/developer/mobile-apps/cedarling-android/","title":"Using UniFFI binding Android App","text":"<p>Cedarling UniFFI binding exposes its <code>init</code>, <code>authz</code> and <code>log</code> interfaces to different languages and on all the different platforms, including Kotlin for Android. This section covers how to build and use Cedarling UniFFI binding in an Android app.</p>"},{"location":"cedarling/developer/mobile-apps/cedarling-android/#prerequisites","title":"Prerequisites","text":"<ul> <li>Rust: Install it from the official Rust website.</li> <li>Android Studio: Download from the official site.</li> </ul>"},{"location":"cedarling/developer/mobile-apps/cedarling-android/#building","title":"Building","text":"<ol> <li> <p>Build the library:     <pre><code>cargo build -r -p cedarling_uniffi\n</code></pre>    In <code>target/release</code>, you should find the <code>libcedarling_uniffi.dylib</code> (if Mac OS), <code>libcedarling_uniffi.so</code> (if Linux OS), or <code>libcedarling_uniffi.dll</code> (if Windows OS) file, depending on the operating system you are using.</p> </li> <li> <p>Set up cargo-ndk for cross-compiling:     <pre><code>cargo install cargo-ndk\n</code></pre></p> </li> <li> <p>Add targets for Android:     <pre><code>rustup target add \\\n        aarch64-linux-android \\\n        armv7-linux-androideabi \\\n        i686-linux-android \\\n        x86_64-linux-android\n</code></pre></p> </li> <li> <p>Compile the dynamic libraries in ./app/src/main/jniLibs (next to java and res directories) in the sample <code>androidApp</code> project.     <pre><code>cargo ndk -o ./bindings/cedarling_uniffi/androidApp/app/src/main/jniLibs \\\n        --manifest-path ./Cargo.toml \\\n        -t armeabi-v7a \\\n        -t arm64-v8a \\\n        -t x86 \\\n        -t x86_64 \\\n        build \\\n        -p cedarling_uniffi --release\n</code></pre></p> </li> <li> <p>Generate the bindings for Kotlin by running the command below. Replace <code>{build_file}</code> with <code>libcedarling_uniffi.dylib</code>, <code>libcedarling_uniffi.so</code>, or <code>libcedarling_uniffi.dll</code>, depending on which file is generated in <code>target/release</code>.     <pre><code>cargo run --bin uniffi-bindgen generate --library ./target/release/{build_file} --language kotlin --out-dir ./bindings/cedarling_uniffi/androidApp/app/src/main/java/com/example/androidapp/cedarling/uniffi\n</code></pre></p> </li> <li> <p>We have included a sample android app using Cedarling UniFFI binding for making authorisation decisions. Open the <code>androidApp</code> project on Android Studio and run the project on simulator.</p> </li> </ol>"},{"location":"cedarling/developer/mobile-apps/cedarling-ios/","title":"Using UniFFI binding iOS App","text":"<p>Cedarling UniFFI binding exposes its <code>init</code>, <code>authz</code> and <code>log</code> interfaces to different languages and on all the different platforms, including Swift for iOS. This section covers how to build and use Cedarling UniFFI binding in an iOS app.</p>"},{"location":"cedarling/developer/mobile-apps/cedarling-ios/#prerequisites","title":"Prerequisites","text":"<ul> <li>Rust: Install it from the official Rust website.</li> <li>Xcode: Available on the Mac App Store.</li> </ul>"},{"location":"cedarling/developer/mobile-apps/cedarling-ios/#building","title":"Building","text":"<ol> <li> <p>Clone the jans monorepo and change directory to <code>/path/of/jans/jans-cedarling</code>.    <pre><code> git clone https://github.com/JanssenProject/jans.git\n cd /path/of/jans/jans-cedarling\n</code></pre></p> </li> <li> <p>Build the library:    <pre><code>cargo build -r -p cedarling_uniffi\n</code></pre>    In <code>target/release</code>, you should find the <code>libcedarling_uniffi.dylib</code> (if Mac OS), <code>libcedarling_uniffi.so</code> (if Linux OS), or <code>libcedarling_uniffi.dll</code> (if Windows OS) file, depending on the operating system you are using.</p> </li> <li> <p>Generate the bindings for Swift by running the command below. Replace <code>{build_file}</code> with <code>libcedarling_uniffi.dylib</code>, <code>libcedarling_uniffi.so</code>, or <code>libcedarling_uniffi.dll</code>, depending on which file is generated in <code>target/release</code>.    <pre><code>cargo run --bin uniffi-bindgen generate --library ./target/release/{build_file} --language swift --out-dir ./bindings/cedarling_uniffi/output\n</code></pre></p> </li> <li> <p>Building the iOS binaries and adding these targets to Rust.    <pre><code>rustup target add aarch64-apple-ios-sim aarch64-apple-ios\n</code></pre></p> </li> <li> <p>Build the library for Swift.    <pre><code>cargo build --release --target=aarch64-apple-ios-sim\ncargo build --release --target=aarch64-apple-ios\n</code></pre>    You should have two binaries <code>target/aarch64-apple-ios-sim/release/libcedarling_uniffi.a</code> and <code>target/aarch64-apple-ios/release/libcedarling_uniffi.a</code>.</p> </li> <li> <p>The XCFramework will allow us to import the library with zero effort in Xcode. First, we need to rename the file ./bindings/cedarling_uniffi/output/cedarling_uniffiFFI.modulemap to ./bindings/cedarling_uniffi/output/module.modulemap. Then, we can create the XCFramework:    <pre><code>xcodebuild -create-xcframework \\\n        -library ./target/aarch64-apple-ios-sim/release/libcedarling_uniffi.a -headers ./bindings/cedarling_uniffi/output \\\n        -library ./target/aarch64-apple-ios/release/libcedarling_uniffi.a -headers ./bindings/cedarling_uniffi/output \\\n        -output \"ios/Mobile.xcframework\"\n</code></pre></p> </li> <li> <p>Open <code>./jans-cedarling/bindings/cedarling_uniffi/iOSApp</code> in Xcode. Import both the XCFramework Mobile.xcframework and the Swift file bindings <code>bindings/output/cedarling_uniffi.swift</code> files into your project (drag and drop should work).</p> </li> <li> <p>Run iOS project on simulator.</p> </li> </ol> <p>We have included a sample iOS app using Cedarling UniFFI binding for making authorisation decisions. Here is a demonstration video of its working.</p>"},{"location":"cedarling/developer/mobile-apps/cedarling-uniffi/","title":"UniFFI binding for Cedarling","text":"<p>UniFFI (Universal Foreign Function Interface) is a tool developed by Mozilla to simplify cross-language bindings, primarily between Rust and other languages like Kotlin, Swift, and Python. It allows Rust libraries to be used in these languages without manually writing complex foreign function interface (FFI) bindings. For eg. developing iOS applications typically involves languages like Swift or Objective-C. However, with the advent of UniFFI, it\u2019s now possible to use rust code iOS apps.</p> <p>Speaking about Cedarling, it interacts with outside world mainly using 3 interfaces <code>init</code>, <code>authz</code> and <code>log</code>. The UniFFI binding for Cedarling wraps the init, authz and log interfaces of Cedarling and uses the Procedural Macros to expose them to other languages. It also exposes the required Structs and Enums used as parameters and return-types in these interfaces.</p>"},{"location":"cedarling/developer/mobile-apps/cedarling-uniffi/#exposed-functions","title":"Exposed Functions","text":"<ul> <li>Cedarling::load_from_json</li> </ul> <p>Loads a Cedarling instance from a JSON configuration.</p> <pre><code>#[uniffi::constructor]\npub fn load_from_json(config: String) -&gt; Result&lt;Self, CedarlingError&gt;\n</code></pre> <p>Usage in Swift:</p> <pre><code>let cedarling = try Cedarling.loadFromJson(config: configJson);\n</code></pre> <p>Usage in Kotlin:</p> <pre><code>val cedarling: Cedarling = Cedarling.loadFromJson(configJson)\n</code></pre> <ul> <li>Cedarling::load_from_file</li> </ul> <p>Loads a Cedarling instance from a configuration file.</p> <pre><code>#[uniffi::constructor]\npub fn load_from_file(path: String) -&gt; Result&lt;Self, CedarlingError&gt;\n</code></pre> <p>Usage in Swift:</p> <pre><code>let cedarling = try Cedarling.loadFromFile(path: \"/path/to/config.json\")\n</code></pre> <p>Usage in Kotlin:</p> <pre><code>val cedarling: Cedarling = Cedarling.loadFromJson(\"/path/to/config.json\")\n</code></pre> <ul> <li>Cedarling::authorize</li> </ul> <p>Handles authorization requests.</p> <pre><code>#[uniffi::method]\n     pub fn authorize(\n         &amp;self,\n         tokens: HashMap&lt;String, String&gt;,\n         action: String,\n         resource_type: String,\n         resource_id: String,\n         payload: String,\n         context: String,\n     ) -&gt; Result&lt;AuthorizeResult, AuthorizeError&gt; \n</code></pre> <p>Usage in Swift:</p> <pre><code>let result = try cedarling.authorize(tokens: tokenMap, action: \"Jans::Action::\\\"Update\\\"\", resourceType: \"Jans::Issue\", resourceId: \"some_id\", payload: \"{}\", context: \"\")\n</code></pre> <p>Usage in Kotlin:</p> <pre><code>val authResult: AuthorizeResult = cedarling.authorize(tokenMap, \"Jans::Action::\\\"Update\\\"\", \"Jans::Issue\", \"some_id\", \"{}\", \"{}\")\n</code></pre> <ul> <li>Cedarling::pop_logs</li> </ul> <p>Retrieves logs as JSON strings.</p> <pre><code>#[uniffi::method]\npub fn pop_logs(&amp;self) -&gt; Result&lt;Vec&lt;String&gt;, LogError&gt; \n</code></pre> <p>Usage in Swift:</p> <pre><code>let logs = try cedarling.popLogs()\n</code></pre> <p>Usage in Kotlin:</p> <pre><code>val logs = cedarling.popLogs()\n</code></pre> <ul> <li>Cedarling::get_log_by_id</li> </ul> <p>Retrieves a log entry by ID.</p> <pre><code>#[uniffi::method]\npub fn get_log_by_id(&amp;self, id: &amp;str) -&gt; Result&lt;String, LogError&gt;\n</code></pre> <p>Usage in Swift:</p> <pre><code>let log = try cedarling.getLogById(id: \"log123\")\n</code></pre> <p>Usage in Kotlin:</p> <pre><code>val logs = cedarling.getLogById(\"log123\")\n</code></pre> <ul> <li>Cedarling::get_log_ids</li> </ul> <p>Get all log ids</p> <pre><code>#[uniffi::method]\npub fn get_log_ids(&amp;self) -&gt; Vec&lt;String&gt;\n</code></pre> <p>Usage in Swift:</p> <pre><code>let ids = try cedarling.getLogIds()\n</code></pre> <p>Usage in Kotlin:</p> <pre><code>val ids = cedarling.getLogById(\"log123\")\n</code></pre> <ul> <li>Cedarling::get_logs_by_tag</li> </ul> <p>Get logs by tag, like <code>log_kind</code> or <code>log level</code>.</p> <pre><code>#[uniffi::method]\npub fn get_logs_by_tag(&amp;self, tag: &amp;str) -&gt; Result&lt;Vec&lt;String&gt;, LogError&gt; {\n</code></pre> <p>Usage in Swift:</p> <pre><code>let logs = try cedarling.getLogsByTag(tag: \"DEBUG\")\n</code></pre> <p>Usage in Kotlin:</p> <pre><code>val logs = cedarling.getLogsByTag(\"DEBUG\")\n</code></pre> <ul> <li>Cedarling::get_logs_by_request_id</li> </ul> <p>Get all logs by request_id</p> <pre><code>#[uniffi::method]\npub fn get_logs_by_request_id(&amp;self, request_id: &amp;str) -&gt; Result&lt;Vec&lt;String&gt;, LogError&gt;\n</code></pre> <p>Usage in Swift:</p> <pre><code>let logs = try cedarling.getLogsByRequestId(request_id: \"12434-32323-43434\")\n</code></pre> <p>Usage in Kotlin:</p> <pre><code>val logs = cedarling.getLogsByRequestId(\"12434-32323-43434\")\n</code></pre> <ul> <li>Cedarling::get_logs_by_request_id_and_tag</li> </ul> <p>Get log by request_id and tag, like composite key <code>request_id</code> + <code>log_kind</code>.</p> <pre><code>#[uniffi::method]\npub fn get_logs_by_request_id_and_tag(\n     &amp;self,\n     request_id: &amp;str,\n     tag: &amp;str,\n ) -&gt; Result&lt;Vec&lt;String&gt;, LogError&gt;\n</code></pre> <p>Usage in Swift:</p> <pre><code>let logs = try cedarling.getLogsByRequestIdAndTag(request_id: \"12434-32323-43434\", tag: \"Decision\")\n</code></pre> <p>Usage in Kotlin:</p> <pre><code>val logs = cedarling.getLogsByRequestId(\"12434-32323-43434\", \"Decision\")\n</code></pre>"},{"location":"cedarling/developer/sidecar/cedarling-sidecar-overview/","title":"Sidecar Overview","text":"<p>The sidecar is a containerized Flask project that uses the <code>cedarling_python</code> binding and implements the AuthZen specification. This image can run alongside another service and uses cedarling to validate evaluation requests against a policy store.</p>","tags":["cedarling","sidecar"]},{"location":"cedarling/developer/sidecar/cedarling-sidecar-overview/#docker-setup","title":"Docker setup","text":"<ul> <li>Ensure that you have installed docker</li> <li>Create a file called <code>bootstrap.json</code>. You may use this sample file.</li> <li>Modify the bootstrap file to your specifications. In particular you need to provide a link to your policy store in <code>CEDARLING_POLICY_STORE_URI</code>. The configuration keys are described here.</li> <li>Pull the docker image:   <pre><code>docker pull ghcr.io/janssenproject/jans/cedarling-flask-sidecar:0.0.0-nightly\n</code></pre></li> <li> <p>Run the docker image, replacing <code>&lt;/absolute/path/to/bootstrap.json&gt;</code> with the absolute path to your bootstrap file:</p> <pre><code>docker run -d \\\n  -e APP_MODE='development' \\\n  -e CEDARLING_BOOTSTRAP_CONFIG_FILE=/bootstrap.json \\\n  -e SIDECAR_DEBUG_RESPONSE=False \\\n  -e DISABLE_HASH_CHECK=False \\\n  --mount type=bind,src=&lt;/absolute/path/to/bootstrap.json&gt;,dst=/bootstrap.json \\\n  -p 5000:5000\\\n  ghcr.io/janssenproject/jans/cedarling-flask-sidecar:0.0.0-nightly\n</code></pre> <ul> <li><code>-d</code> runs the sidecar in daemon mode in the background. Omit this if you want to run the sidecar in the foreground to monitor logs in real time.</li> <li><code>SIDECAR_DEBUG_RESPONSE</code> will cause the sidecar to return extra diagnostic information for each query if set to <code>True</code>. This may be useful to check which policies are being used to reach a decision.</li> <li><code>DISABLE_HASH_CHECK</code> will disable checking the hash of the subject and resource IDs. This is useful when the SHA256 checksum of large objects are difficult to compute consistently due to string representation, spacing and other causes that may generate a different hash.</li> <li>Take note of the output of the command. This is the container ID of the sidecar.</li> <li>The sidecar runs in the background on port 5000. OpenAPI documentation is available at <code>http://0.0.0.0:5000/swagger-ui</code></li> <li>To stop the sidecar, run <code>docker container stop &lt;container ID&gt;</code></li> </ul> </li> </ul>","tags":["cedarling","sidecar"]},{"location":"cedarling/developer/sidecar/cedarling-sidecar-overview/#usage","title":"Usage","text":"<p>The sidecar has one endpoint: <code>/cedarling/evaluation</code>.</p> <p>Example request to the evaluation endpoint:</p> <p>Note</p> <p>The request shown below is designed against the AuthZen specification and should not be used for a regular cedarling deployment.</p> <pre><code>{\n  \"subject\": {\n    \"type\": \"JWT\",\n    \"id\": &lt;SHA256 hash of the properties dictionary&gt;,\n    \"properties\": {\n      \"access_token\": \"\",\n      \"id_token\": \"\",\n      \"userinfo_token\": \"\"\n    }\n  },\n  \"resource\": {\n    \"type\": \"Application\",\n    \"id\": &lt;SHA256 hash of the properties dictionary&gt;,\n    \"properties\": {\n      \"cedar_entity_mapping\": {\n        \"entity_type\": \"Jans::Application\",\n        \"id\": \"some_id\"\n      },\n      \"app_id\": \"application_id\",\n      \"name\": \"Some Application\",\n      \"url\": {\n        \"host\": \"jans.test\",\n        \"path\": \"/protected-endpoint\",\n        \"protocol\": \"http\"\n      }\n    }\n  },\n  \"action\": {\n    \"name\": \"Jans::Action::\\\"Read\\\"\"\n  },\n  \"context\": {\n    \"device_health\": [\"Healthy\"],\n    \"fraud_indicators\": [\"Allowed\"],\n    \"geolocation\": [\"America\"],\n    \"network\": \"127.0.0.1\",\n    \"network_type\": \"Local\",\n    \"operating_system\": \"Linux\",\n    \"user_agent\": \"Linux\",\n    \"current_time\": 1\n  }\n}\n</code></pre> <p>Cedarling requires OpenID Userinfo, Access, and ID tokens to construct the principal entity, as described here. These values are sent in the subject field's properties. Furthermore, the sidecar expects the SHA256 checksum of the subject and resource's <code>properties</code> dictionary to be passed as their corresponding IDs, as shown in the example above. A more detailed example of creating an AuthZen request can be seen in the gateway example.</p> <p>Upon creating the principal, action, resource, and context entities, cedarling will evaluate these entities against the policies defined in the policy store. Then it will return a true/false decision. If the decision is false, the sidecar will analyze cedarling diagnostics and provide additional information for the admin.</p> <p>Example of <code>true</code> case:</p> <pre><code>{\n  \"decision\": true\n}\n</code></pre> <p>Example of <code>false</code> case:</p> <pre><code>{\n  \"context\": {\n    \"reason_admin\": {\n      \"person diagnostics\": [],\n      \"person error\": [],\n      \"person evaluation\": \"DENY\",\n      \"workload diagnostics\": [],\n      \"workload evaluation\": \"DENY\",\n      \"workload_error\": []\n    }\n  },\n  \"decision\": false\n}\n</code></pre> <p>In this example both the person and workload evaluations were <code>DENY</code>, so the decision was false. Additional information is returned in the <code>context</code> field.</p>","tags":["cedarling","sidecar"]},{"location":"cedarling/developer/sidecar/cedarling-sidecar-tutorial/","title":"Cedarling Sidecar Tutorial","text":"","tags":["administration","Cedar","Cedarling","Quick start guide","Cedarling Hello World"]},{"location":"cedarling/developer/sidecar/cedarling-sidecar-tutorial/#introduction","title":"Introduction","text":"<p>The goal of this tutorial is to show how to use the Cedarling Sidecar. To demonstrate this, we'll build a very simple Python Flask API Gateway that calls the Cedarling sidecar Authzen REST endpoint to authorize access based on the content of a JWT access token.</p>","tags":["administration","Cedar","Cedarling","Quick start guide","Cedarling Hello World"]},{"location":"cedarling/developer/sidecar/cedarling-sidecar-tutorial/#sequence-diagram","title":"Sequence diagram","text":"<pre><code>sequenceDiagram\ntitle API Gateway\nactor User\nparticipant Gateway\nparticipant Sidecar\n\nUser-&gt;Gateway: GET /protected\\nAuthorization: Bearer ...\nGateway-&gt;Sidecar: POST /cedarling/evaluation\\n{\"subject\": {\"type\": \"JWT\", \"id\": \"cedarling\", \"properties\": {\"access_token\": \"...\"} }}\nSidecar-&gt;Sidecar: cedarling.authorize(access_token)\n\nalt ALLOW\n    Sidecar-&gt;Gateway: {\"decision\": true}\n    Gateway-&gt;User: 200 {\"result\": \"protected resource\"}\nelse DENY\n    Sidecar-&gt;Gateway: {\"decision\": false, \"context\": {...}}\n    Gateway-&gt;User: 403 Forbidden\nend\n</code></pre>","tags":["administration","Cedar","Cedarling","Quick start guide","Cedarling Hello World"]},{"location":"cedarling/developer/sidecar/cedarling-sidecar-tutorial/#sample-authzen-request","title":"Sample Authzen request","text":"<p>Note</p> <p>The request shown below is designed against the AuthZen specification and should not be used for a regular cedarling deployment.</p> <pre><code>{\n  \"subject\": {\n    \"type\": \"token_bundle\",\n    \"id\": &lt;SHA256 hash of the properties dictionary&gt;,\n    \"properties\": {\n      \"access_token\": \"\"\n    }\n  },\n  \"resource\": {\n    \"type\": \"Request\",\n    \"id\": &lt;SHA256 hash of the properties dictionary&gt;,\n    \"properties\": {\n      \"cedar_entity_mapping\": {\n        \"entity_type\": \"Jans::HTTP_Request\",\n        \"id\": \"some_id\"\n      },\n      \"header\": {},\n      \"url\": {\n        \"protocol\": \"http\",\n        \"host\": \"www.acme.tld\",\n        \"path\": \"/protected\"\n      }\n    }\n  },\n  \"action\": {\n    \"name\": \"Jans::Action::\\\"GET\\\"\"\n  },\n  \"context\": {}\n}\n</code></pre>","tags":["administration","Cedar","Cedarling","Quick start guide","Cedarling Hello World"]},{"location":"cedarling/developer/sidecar/cedarling-sidecar-tutorial/#prerequisites","title":"Prerequisites","text":"<p>Before you begin, make sure you have the following:</p> <ul> <li><code>Docker</code> installed on your machine</li> <li><code>Python 3.10</code> or higher</li> <li><code>pipx</code> and <code>Poetry</code> installed if you're not using Docker</li> </ul>","tags":["administration","Cedar","Cedarling","Quick start guide","Cedarling Hello World"]},{"location":"cedarling/developer/sidecar/cedarling-sidecar-tutorial/#policy-store-setup-agama-lab","title":"Policy Store Setup (Agama Lab)","text":"<p>To begin using Cedarling, you need to set up a policy store. We'll use this Agama Lab for this purpose.</p> <ol> <li>Sign in to Agama Lab using your GitHub account and click on Policy Designer.    </li> <li>Choose a repository to store your Cedarling policies and schemas. Ensure that the repository has at least one commit on the default branch.    </li> <li>After initialization, create a policy store named <code>gatewayDemo</code>.    </li> <li>Open the policy store and navigate to Policies.</li> <li>Click <code>Add Policy</code>, select <code>Text Editor</code>.    </li> <li>Paste the following Cedar policy:</li> </ol> <pre><code>@id(\"allow_one\")\npermit(\n  principal is Jans::Workload,\n  action == Jans::Action::\"GET\",\n  resource is Jans::HTTP_Request\n)\nwhen {\n  principal has access_token.scope &amp;&amp;\n  principal.access_token.scope.contains(\"openid\")\n};\n</code></pre> <ol> <li>Click <code>Save</code>. Agama Lab will validate your policy.</li> <li> <p>Next, click on <code>Trusted Issuers</code> and add the following issuer:</p> </li> <li> <p>Name: <code>Gluu</code></p> </li> <li>Description: <code>Gluu</code></li> <li>OpenID Configuration Endpoint: <code>https://account.gluu.org/.well-known/openid-configuration</code></li> <li>Copy the URL for your policy store; you'll need it for the sidecar setup.      </li> </ol>","tags":["administration","Cedar","Cedarling","Quick start guide","Cedarling Hello World"]},{"location":"cedarling/developer/sidecar/cedarling-sidecar-tutorial/#deploy-cedarling-sidecar","title":"Deploy Cedarling Sidecar","text":"","tags":["administration","Cedar","Cedarling","Quick start guide","Cedarling Hello World"]},{"location":"cedarling/developer/sidecar/cedarling-sidecar-tutorial/#docker-instructions","title":"Docker Instructions","text":"<p>Create a file named <code>bootstrap.json</code>. You may use the sample file.</p> <ul> <li>Set <code>CEDARLING_POLICY_STORE_URI</code> to the URL you copied from Agama Lab.</li> <li>Set <code>CEDARLING_USER_AUTHZ</code> to \"disabled\"</li> <li>Set <code>CEDARLING_MAPPING_WORKLOAD</code> to <code>Jans::Workload</code></li> <li>Set <code>CEDARLING_ID_TOKEN_TRUST_MODE</code> to \"never\"</li> </ul> <p>Pull the Docker image:</p> <pre><code>docker pull ghcr.io/janssenproject/jans/cedarling-flask-sidecar:0.0.0-nightly\n</code></pre> <p>Run the Docker image, replacing <code>&lt;/absolute/path/to/bootstrap.json&gt;</code> with the absolute path to your bootstrap file:</p> <pre><code>docker run -d \\\n  -e APP_MODE='development' \\\n  -e CEDARLING_BOOTSTRAP_CONFIG_FILE=/bootstrap.json \\\n  -e SIDECAR_DEBUG_RESPONSE=True \\\n  -e DISABLE_HASH_CHECK=False \\\n  --mount type=bind,src=&lt;/absolute/path/to/bootstrap.json&gt;,dst=/bootstrap.json \\\n  -p 5000:5000\\\n  ghcr.io/janssenproject/jans/cedarling-flask-sidecar:0.0.0-nightly\n</code></pre> <p>The sidecar is now running on http://127.0.0.1:5000. Keep track of the output of the previous command, it is your Docker container ID.</p>","tags":["administration","Cedar","Cedarling","Quick start guide","Cedarling Hello World"]},{"location":"cedarling/developer/sidecar/cedarling-sidecar-tutorial/#python-instructions-if-docker-is-unavailable","title":"Python instructions (if Docker is unavailable)","text":"<ul> <li>Clone the Janssen repository and navigate to <code>jans/jans-cedarling/flask-sidecar</code>.</li> <li>Run <code>poetry install</code> to install dependencies.</li> <li>Download and install the latest Cedarling nightly wheel:</li> </ul> <pre><code>wget https://github.com/JanssenProject/jans/releases/download/nightly/cedarling_python-0.0.0-cp310-cp310-manylinux_2_31_x86_64.whl\n</code></pre> <ul> <li>Install the nightly wheel:</li> </ul> <pre><code>poetry run pip install cedarling_python-0.0.0-cp310-cp310-manylinux_2_31_x86_64.whl\n</code></pre> <ul> <li> <p>Modify <code>secrets/bootstrap.json</code> to your specifications.</p> </li> <li> <p>Navigate to <code>jans/jans-cedarling/flask-sidecar/main</code></p> </li> <li> <p>Create a file called <code>.env</code> and paste in the following content. Alternatively, set the following environment variables:</p> </li> </ul> <pre><code>APP_MODE=development\nCEDARLING_BOOTSTRAP_CONFIG_FILE=../secrets/bootstrap.json\nSIDECAR_DEBUG_RESPONSE=False\nDISABLE_HASH_CHECK=False\n</code></pre> <ul> <li> <p>Run the sidecar: <code>poetry run flask run</code></p> </li> <li> <p>The sidecar is now running on http://127.0.0.1:5000</p> </li> </ul>","tags":["administration","Cedar","Cedarling","Quick start guide","Cedarling Hello World"]},{"location":"cedarling/developer/sidecar/cedarling-sidecar-tutorial/#setup-test-gateway","title":"Setup Test Gateway","text":"<p>We will use Flask to create a simple API Gateway.</p> <ul> <li>Create a folder called <code>demo</code> and navigate to it.</li> <li>Create a virtual environment and activate it:</li> </ul> <pre><code>python -m venv venv\nsource venv/bin/activate\n</code></pre> <ul> <li>Install Flask and requests.</li> </ul> <pre><code>pip install flask requests\n</code></pre> <ul> <li>Create a file called <code>gateway.py</code> with the following content:</li> </ul> <pre><code>from flask import Flask, abort, request\nimport requests\nimport json\nfrom hashlib import sha256\n\ndef generate_hash(input) -&gt; str:\n    encoded_str = json.dumps(input).encode(\"utf-8\")\n    digest = sha256(encoded_str).hexdigest()\n    return digest\n\n\napp = Flask(__name__)\n\n@app.route(\"/protected\")\ndef protected():\n    token = request.headers.get(\"Authorization\")\n    if token is None:\n        abort(403)\n    token_jwt = token.split(\" \")[1]\n    print(token_jwt)\n    subject_properties = {\n        \"access_token\": token_jwt\n    }\n    subject_hash = generate_hash(subject_properties)\n    resource_properties = {\n        \"cedar_entity_mapping\": {\n            \"entity_type\": \"Jans::HTTP_Request\",\n            \"id\": \"some_id\"\n        },\n        \"header\": {},\n        \"url\": {\n            \"protocol\": \"http\",\n            \"host\": \"www.acme.tld\",\n            \"path\": \"/protected\"\n        }\n    }\n    resource_hash = generate_hash(resource_properties)\n    payload = {\n        \"subject\": {\n            \"type\": \"token_bundle\",\n            \"id\": subject_hash,\n            \"properties\": subject_properties \n        },\n        \"resource\": {\n            \"type\": \"type\",\n            \"id\": resource_hash,\n            \"properties\": resource_properties \n        },\n        \"action\": {\n            \"name\": \"Jans::Action::\\\"GET\\\"\"\n        },\n        \"context\": {}\n    }\n    response = requests.post(\"http://127.0.0.1:5000/cedarling/evaluation\", json=payload)\n    if response.ok and response.json()[\"decision\"] == True:\n        return {\"protected_content\": \"secret\"}\n    abort(403)\n\nif __name__ == '__main__':\n    app.run(port=5001)\n</code></pre> <ul> <li>Run the gateway:</li> </ul> <pre><code>flask --app gateway run --port 5001\n</code></pre>","tags":["administration","Cedar","Cedarling","Quick start guide","Cedarling Hello World"]},{"location":"cedarling/developer/sidecar/cedarling-sidecar-tutorial/#test-the-setup","title":"Test the Setup","text":"<ul> <li> <p>Access the protected endpoint via browser: http://127.0.0.1:5001/protected.   You should get a 403 Forbidden response.</p> </li> <li> <p>Access the protected endpoint via curl with the provided JWT:</p> </li> </ul> <pre><code>curl http://127.0.0.1:5001/protected -H \"Authorization: Bearer eyJraWQiOiJjb25uZWN0X2Y5YTAwN2EyLTZkMGItNDkyYS05MGNkLWYwYzliMWMyYjVkYl9zaWdfcnMyNTYiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJxenhuMVNjcmI5bFd0R3hWZWRNQ2t5LVFsX0lMc3BaYVFBNmZ5dVlrdHcwIiwiY29kZSI6IjNlMmEyMDEyLTA5OWMtNDY0Zi04OTBiLTQ0ODE2MGMyYWIyNSIsImlzcyI6Imh0dHBzOi8vYWNjb3VudC5nbHV1Lm9yZyIsInRva2VuX3R5cGUiOiJCZWFyZXIiLCJjbGllbnRfaWQiOiJkN2Y3MWJlYS1jMzhkLTRjYWYtYTFiYS1lNDNjNzRhMTFhNjIiLCJhdWQiOiJkN2Y3MWJlYS1jMzhkLTRjYWYtYTFiYS1lNDNjNzRhMTFhNjIiLCJhY3IiOiJzaW1wbGVfcGFzc3dvcmRfYXV0aCIsIng1dCNTMjU2IjoiIiwibmJmIjoxNzMxOTUzMDMwLCJzY29wZSI6WyJyb2xlIiwib3BlbmlkIiwicHJvZmlsZSIsImVtYWlsIl0sImF1dGhfdGltZSI6MTczMTk1MzAyNywiZXhwIjoxNzMyMTIxNDYwLCJpYXQiOjE3MzE5NTMwMzAsImp0aSI6InVaVWgxaERVUW82UEZrQlBud3BHemciLCJ1c2VybmFtZSI6IkRlZmF1bHQgQWRtaW4gVXNlciIsInN0YXR1cyI6eyJzdGF0dXNfbGlzdCI6eyJpZHgiOjMwNiwidXJpIjoiaHR0cHM6Ly9qYW5zLnRlc3QvamFucy1hdXRoL3Jlc3R2MS9zdGF0dXNfbGlzdCJ9fX0.Pt-Y7F-hfde_WP7ZYwyvvSS11rKYQWGZXTzjH_aJKC5VPxzOjAXqI3Igr6gJLsP1aOd9WJvOPchflZYArctopXMWClbX_TxpmADqyCMsz78r4P450TaMKj-WKEa9cL5KtgnFa0fmhZ1ZWolkDTQ_M00Xr4EIvv4zf-92Wu5fOrdjmsIGFot0jt-12WxQlJFfs5qVZ9P-cDjxvQSrO1wbyKfHQ_txkl1GDATXsw5SIpC5wct92vjAVm5CJNuv_PE8dHAY-KfPTxOuDYBuWI5uA2Yjd1WUFyicbJgcmYzUSVt03xZ0kQX9dxKExwU2YnpDorfwebaAPO7G114Bkw208g\"\n</code></pre> <ul> <li>If the JWT is valid and the policy allows access, you should receive the following response:</li> </ul> <pre><code>{\n  \"protected_content\": \"secret\"\n}\n</code></pre>","tags":["administration","Cedar","Cedarling","Quick start guide","Cedarling Hello World"]},{"location":"cedarling/developer/sidecar/cedarling-sidecar-tutorial/#check-logs","title":"Check Logs","text":"<p>The cedarling decision log will be outputted by the Docker container or directly by the API to stdout. In the case of Docker, this can be retrieved like so:</p> <pre><code>$ docker logs &lt;container ID&gt;\n</code></pre> <pre><code>{\n  \"request_id\": \"0194cdbc-b8c7-798d-8cc8-fb483448e6fa\",\n  \"timestamp\": \"2025-02-03T21:34:44.935Z\",\n  \"log_kind\": \"Decision\",\n  \"pdp_id\": \"e122cc37-14f7-4033-a547-6791f339218b\",\n  \"policystore_id\": \"c92b24bb010b772e7702811ae0725986bf7d3b39656e\",\n  \"policystore_version\": \"1.6.15\",\n  \"principal\": \"Workload\",\n  \"Workload\": { \"client_id\": \"slkacm3cv5-vat1u~elog\" },\n  \"diagnostics\": {\n    \"reason\": [\"840da5d85403f35ea76519ed1a18a33989f855bf1cf8\"],\n    \"errors\": []\n  },\n  \"action\": \"Jans::Action::\\\"GET\\\"\",\n  \"resource\": \"Jans::HTTP_Request::\\\"some_id\\\"\",\n  \"decision\": \"ALLOW\",\n  \"tokens\": {\n    \"access_token\": {\n      \"jti\": \"uZUh1hDUQo6PFkBPnwpGzg\"\n    }\n  },\n  \"decision_time_ms\": 0\n}\n</code></pre>","tags":["administration","Cedar","Cedarling","Quick start guide","Cedarling Hello World"]},{"location":"cedarling/developer/sidecar/cedarling-sidecar-tutorial/#customizing-the-policy","title":"Customizing the policy","text":"<p>Let's add one more check in the policy. This time we want to check if the <code>acr</code> in the access token matches a particular value, for example <code>simple_password_auth</code>. This change will essentially involve two changes.</p> <ol> <li>Update the schema</li> <li>Update the policy</li> </ol> <p>Let's update the schema first using steps the below:</p> <ol> <li>Go to the <code>Policy Designer</code>.</li> <li>Navigate to <code>Schema</code> \u2192 <code>Entity Types</code>.</li> <li>Edit the <code>access_token</code> entity type.</li> <li>Add a new field <code>acr</code> with the type set to <code>String</code>.</li> <li>Save the schema.</li> </ol> <p>Once the schema has been updated, your new updated Access_token entity type json should be similar to the one below:</p> <pre><code>{\n  \"shape\": {\n    \"type\": \"Record\",\n    \"attributes\": {\n      \"aud\": {\n        \"type\": \"EntityOrCommon\",\n        \"name\": \"String\"\n      },\n      \"exp\": {\n        \"type\": \"EntityOrCommon\",\n        \"name\": \"Long\"\n      },\n      \"iat\": {\n        \"type\": \"EntityOrCommon\",\n        \"name\": \"Long\"\n      },\n      \"iss\": {\n        \"type\": \"EntityOrCommon\",\n        \"name\": \"TrustedIssuer\"\n      },\n      \"jti\": {\n        \"type\": \"EntityOrCommon\",\n        \"required\": false,\n        \"name\": \"String\"\n      },\n      \"nbf\": {\n        \"type\": \"EntityOrCommon\",\n        \"required\": false,\n        \"name\": \"Long\"\n      },\n      \"scope\": {\n        \"type\": \"Set\",\n        \"required\": false,\n        \"element\": {\n          \"type\": \"EntityOrCommon\",\n          \"name\": \"String\"\n        }\n      },\n      \"acr\": {\n        \"type\": \"String\",\n        \"required\": false\n      }\n    }\n  }\n}\n</code></pre> <p>Let's make the corresponding changes in the policy.</p> <pre><code>@id(\"allow_one\")\npermit(\n  principal is Jans::Workload,\n  action == Jans::Action::\"GET\",\n  resource is Jans::HTTP_Request\n)\nwhen {\n  principal has access_token.acr &amp;&amp;\n  principal.acr == \"simple_password_auth\"\n};\n</code></pre> <p>The policy now checks whether the <code>acr</code> value in the access token is present and matches <code>simple_password_auth</code>.</p>","tags":["administration","Cedar","Cedarling","Quick start guide","Cedarling Hello World"]},{"location":"cedarling/integrations/cedarling-krakend/","title":"Cedarling KrakenD Plugin","text":"<p>This is a KrakenD HTTP server plugin that intercepts a call to a selected endpoint, uses the embedded Cedarling PDP and allows access only if the authorization result is <code>true</code>.</p>","tags":["Cedar","Cedarling","KrakenD"]},{"location":"cedarling/integrations/cedarling-krakend/#functionality","title":"Functionality","text":"<ol> <li>During startup, the KrakenD plugin reads the environment variables and initializes a Cedarling instance</li> <li>When the protected endpoint is called, the plugin intercepts the call and creates a Cedarling authorization request.</li> <li>If the result of the authorization request is <code>true</code>, the plugin allows the endpoint to respond. Otherwise, the plugin responds with <code>403 Forbidden</code></li> </ol> <p>Sequence Diagram</p>","tags":["Cedar","Cedarling","KrakenD"]},{"location":"cedarling/integrations/cedarling-krakend/#downloading","title":"Downloading","text":"<p>The cedarling-krakend plugin builds are available via Janssen releases. Please note that builds are architecture, platform, and KrakenD version specific. This means that builds compiled against KrakenD version <code>2.9.0</code> for Windows will not work on other versions or operating systems. The build tags are formatted as follows:</p> <pre><code>cedarling-krakend-&lt;architecture&gt;-&lt;krakend version and platform&gt;-&lt;Janssen version&gt;.so\n</code></pre> <p>Use the following table to find which build you need:</p> amd64 arm64 Docker <code>amd64-builder-2.9.0-0.0.0.so</code> <code>arm64-builder-2.9.0-0.0.0.so</code> On-premise <code>amd64-builder-2.9.0-linux-generic-0.0.0.so</code> <code>arm64-builder-2.9.0-linux-generic-0.0.0.so</code> <p>If you are running a different version of KrakenD, you can use the following steps to build the plugin yourself.</p>","tags":["Cedar","Cedarling","KrakenD"]},{"location":"cedarling/integrations/cedarling-krakend/#building","title":"Building","text":"<ul> <li>Clone the <code>cedarling-krakend</code> folder of the Janssen Repository:   <pre><code>git clone --filter blob:none --no-checkout https://github.com/JanssenProject/jans\ncd jans\ngit sparse-checkout init --cone\ngit checkout main\ngit sparse-checkout set jans-cedarling\ncd cedarling-krakend\n</code></pre></li> <li>Download the dynamic shared object file(s) for the <code>cedarling_go</code> binding, compiled for your platform:</li> <li>Windows:<ul> <li>cedarling_go.dll</li> <li>cedarling_go.lib</li> </ul> </li> <li>Mac OS: cedarling_go.dylib</li> <li>Linux: libcedarling_go.so</li> <li> <p>Build the plugin, replacing <code>&lt;x.y.z&gt;</code> with the KrakenD version you want to build against:</p> </li> <li> <p>For Docker targets:</p> </li> </ul> <pre><code>docker run -it -v \"$PWD:/app\" -w /app krakend/builder:&lt;x.y.z&gt; go build -buildmode=plugin -o cedarling-krakend.so .\n</code></pre> <ul> <li>For on-premise installations:</li> </ul> <pre><code>docker run -it -v \"$PWD:/app\" -w /app krakend/builder:&lt;x.y.z&gt;-linux-generic go build -buildmode=plugin -o cedarling-krakend.so .\n</code></pre> <ul> <li>For ARM64 Docker targets:</li> </ul> <pre><code>docker run -it -v \"$PWD:/app\" -w /app \\\n    -e \"CGO_ENABLED=1\" \\\n    -e \"CC=aarch64-linux-musl-gcc\" \\\n    -e \"GOARCH=arm64\" \\\n    -e \"GOHOSTARCH=amd64\" \\\n    krakend/builder:&lt;x.y.z&gt; \\\n    go build -ldflags='-extldflags=-fuse-ld=bfd -extld=aarch64-linux-musl-gcc' \\\n    -buildmode=plugin -o cedarling-krakend.so .\n</code></pre> <ul> <li>For ARM64 on-premise installs:</li> </ul> <pre><code>docker run -it -v \"$PWD:/app\" -w /app \\\n    -e \"CGO_ENABLED=1\" \\\n    -e \"CC=aarch64-linux-gnu-gcc\" \\\n    -e \"GOARCH=arm64\" \\\n    -e \"GOHOSTARCH=amd64\" \\\n    krakend/builder:&lt;x.y.z&gt;-linux-generic \\\n    go build -ldflags='-extldflags=-fuse-ld=bfd -extld=aarch64-linux-gnu-gcc' \\\n    -buildmode=plugin -o cedarling-krakend.so .\n</code></pre>","tags":["Cedar","Cedarling","KrakenD"]},{"location":"cedarling/integrations/cedarling-krakend/#prerequisites-for-testing","title":"Prerequisites for testing","text":"<p>To test the plugin, you will need:</p> <ul> <li>A cedarling policy store with a policy for our gateway. To create this, please follow these steps.</li> <li>For our demo, we will use this sample policy as outlined in the instructions:   <pre><code>@id(\"allow_one\")\npermit(\n  principal is gatewayDemo::Workload,\n  action == gatewayDemo::Action::\"GET\",\n  resource is gatewayDemo::HTTP_Request\n)\nwhen {\n    principal has access_token.scope &amp;&amp;\n    principal.access_token.scope.contains(\"profile\")\n};\n</code></pre></li> <li>This policy will allow access so long as the access token contains the <code>profile</code> scope.</li> <li>A KrakenD server installation. For development purposes, the binary install is recommended. For production setups, the Docker method is recommended.</li> <li>The plugin <code>.so</code> file for your architecture. For Mac OS hosts, ARM64 is required.</li> <li>The dynamic shared object file(s) for the <code>cedarling_go</code> binding, compiled for your platform:</li> <li>Windows:<ul> <li>cedarling_go.dll</li> <li>cedarling_go.lib</li> </ul> </li> <li>Mac OS: cedarling_go.dylib</li> <li>Linux: libcedarling_go.so</li> <li>A configuration file. Sample configuration is provided in krakend.json.</li> </ul>","tags":["Cedar","Cedarling","KrakenD"]},{"location":"cedarling/integrations/cedarling-krakend/#configuration","title":"Configuration","text":"<p>Check the sample configuration in <code>krakend.json</code> to see an example KrakenD configuration which loads the plugin. The following table describes the plugin-specific configuration keys. These keys are mandatory and must be provided. Additional configuration is described in KrakenD documentation.</p> <p>The <code>namespace</code> field in the configuration needs to be the cedar namespace you used when creating the policy store. By default, Agama Lab sets the namespace to <code>Jans</code>. If you are following the demo, you will use the same name.</p> Field Type Example Description path String /protected KrakenD endpoint to protect namespace String Jans Cedar namespace being used by the policy store","tags":["Cedar","Cedarling","KrakenD"]},{"location":"cedarling/integrations/cedarling-krakend/#running","title":"Running","text":"<p>Warning: Windows and Mac OS are untested. Only Linux has been fully tested against KrakenD.</p> <ol> <li>Place <code>krakend.json</code> and the dynamic shared object file(s) in your current working directory</li> <li>Create a folder named <code>plugin</code> in the current working directory and place the plugin <code>.so</code> file in that folder</li> <li> <p>To properly load the shared library, Linux and Mac OS platforms need to be told where to find your shared object file. On Windows this is detected automatically so long as the object file is placed in the current working directory.</p> </li> <li> <p>Mac OS: <code>export DYLD_LIBRARY_PATH=$(pwd):$DYLD_LIBRARY_PATH</code></p> </li> <li> <p>Linux: <code>export LD_LIBRARY_PATH=$(pwd):$LD_LIBRARY_PATH</code></p> <p>On Linux, you can verify the dynamic linking like so:</p> <pre><code>$ ldd plugin/*.so\n...\nlibcedarling_go.so =&gt; /path/to/current/directory/libcedarling_go.so\n</code></pre> </li> <li> <p>Set the Cedarling bootstrap variables in your environment.</p> </li> <li> <p>For gateway functionality, at minimum you will need the following properties set:</p> </li> </ol> <pre><code>CEDARLING_APPLICATION_NAME=Gateway\nCEDARLING_POLICY_STORE_URI=&lt;Your policy store URI&gt;\nCEDARLING_WORKLOAD_AUTHZ=enabled\nCEDARLING_PRINCIPAL_BOOLEAN_OPERATION={\\\"===\\\":[{\\\"var\\\":\\\"Jans::Workload\\\"},\\\"ALLOW\\\"]}\nCEDARLING_ID_TOKEN_TRUST_MODE=never\n</code></pre> <ol> <li>Run the KrakenD server: <code>krakend run -c krakend.json</code></li> <li>KrakenD is running on <code>http://127.0.0.1:8080</code></li> <li>Test with no authentication: <code>curl http://127.0.0.1:8080/protected</code>. You should get a 403 Forbidden</li> <li>Test with authentication (a sample token is provided):</li> </ol> <pre><code>export ACCESS_TOKEN=eyJraWQiOiJjb25uZWN0X2Y5YTAwN2EyLTZkMGItNDkyYS05MGNkLWYwYzliMWMyYjVkYl9zaWdfcnMyNTYiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJxenhuMVNjcmI5bFd0R3hWZWRNQ2t5LVFsX0lMc3BaYVFBNmZ5dVlrdHcwIiwiY29kZSI6IjNlMmEyMDEyLTA5OWMtNDY0Zi04OTBiLTQ0ODE2MGMyYWIyNSIsImlzcyI6Imh0dHBzOi8vYWNjb3VudC5nbHV1Lm9yZyIsInRva2VuX3R5cGUiOiJCZWFyZXIiLCJjbGllbnRfaWQiOiJkN2Y3MWJlYS1jMzhkLTRjYWYtYTFiYS1lNDNjNzRhMTFhNjIiLCJhdWQiOiJkN2Y3MWJlYS1jMzhkLTRjYWYtYTFiYS1lNDNjNzRhMTFhNjIiLCJhY3IiOiJzaW1wbGVfcGFzc3dvcmRfYXV0aCIsIng1dCNTMjU2IjoiIiwibmJmIjoxNzMxOTUzMDMwLCJzY29wZSI6WyJyb2xlIiwib3BlbmlkIiwicHJvZmlsZSIsImVtYWlsIl0sImF1dGhfdGltZSI6MTczMTk1MzAyNywiZXhwIjoxNzMyMTIxNDYwLCJpYXQiOjE3MzE5NTMwMzAsImp0aSI6InVaVWgxaERVUW82UEZrQlBud3BHemciLCJ1c2VybmFtZSI6IkRlZmF1bHQgQWRtaW4gVXNlciIsInN0YXR1cyI6eyJzdGF0dXNfbGlzdCI6eyJpZHgiOjMwNiwidXJpIjoiaHR0cHM6Ly9qYW5zLnRlc3QvamFucy1hdXRoL3Jlc3R2MS9zdGF0dXNfbGlzdCJ9fX0.Pt-Y7F-hfde_WP7ZYwyvvSS11rKYQWGZXTzjH_aJKC5VPxzOjAXqI3Igr6gJLsP1aOd9WJvOPchflZYArctopXMWClbX_TxpmADqyCMsz78r4P450TaMKj-WKEa9cL5KtgnFa0fmhZ1ZWolkDTQ_M00Xr4EIvv4zf-92Wu5fOrdjmsIGFot0jt-12WxQlJFfs5qVZ9P-cDjxvQSrO1wbyKfHQ_txkl1GDATXsw5SIpC5wct92vjAVm5CJNuv_PE8dHAY-KfPTxOuDYBuWI5uA2Yjd1WUFyicbJgcmYzUSVt03xZ0kQX9dxKExwU2YnpDorfwebaAPO7G114Bkw208g\n\ncurl http://127.0.0.1:8080/protected -H \"Authorization: Bearer $ACCESS_TOKEN\"\n</code></pre> <p>KrakenD is configured to respond with the health check response if authentication succeeds.</p>","tags":["Cedar","Cedarling","KrakenD"]},{"location":"cedarling/quick-start/cedarling-quick-start/","title":"Authorization Using The Cedarling","text":"<p>This quick start guide shows how to quickly test authorization of a user action using the Cedarling. We will be using the application-asserted identity approach in this guide to implement role based access control(RBAC). Refer to this section to understand how to use Cedarling with TBAC approach.</p> <p>To see authorization using Cedarling in action, we need 3 things.</p> <ol> <li>An authorization policy</li> <li>A request for user action</li> <li>A running instance of the Cedarling</li> </ol> <p>For <code>1</code> above, we will use a ready demo policy.</p> <p>For <code>2</code> and <code>3</code>, we will use Janssen Tarp. Janssen Tarp is an easy to install browser plug-in that comes with embedded Cedarling instance (WASM). Janssen Tarp also provides user interface to build authorization and authentication requests for testing purpose.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","quick start","TBAC"]},{"location":"cedarling/quick-start/cedarling-quick-start/#prerequisite","title":"Prerequisite","text":"<ul> <li>Install the Janssen Tarp on Chrome or Firefox.</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","quick start","TBAC"]},{"location":"cedarling/quick-start/cedarling-quick-start/#implement-rbac-using-cedarling","title":"Implement RBAC using Cedarling","text":"<p>In this section, we will see how to implement the role-based access control using the Cedarling when the information about the principal is supplied by the host application. We can call this approach the application asserted identity approach.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","quick start","TBAC"]},{"location":"cedarling/quick-start/cedarling-quick-start/#step-1-create-the-cedar-policy-and-schema","title":"Step-1: Create the Cedar Policy and Schema","text":"<p>The Cedarling needs policies and a schema to authorize access. These are bundled in a policy store (a JSON file). To aid in this quick start guide, we have already created a policy store at quick start GitHub repository. We will use this policy store to allow/deny the incoming authorization request.</p> Agama Lab: For authoring policies and managing the policy store <p>Alternatively, you can also use the Agama Lab For authoring policies and  managing the policy stores. </p> <p>Agama Lab is a free web tool provided by Gluu. This tool makes it very  easy to author, update policies and schema using a web interface. Follow the steps below if you want to make changes to the demo policy that we are  using above.</p> <ul> <li>Go to the CedarlingQuickstart repository where the demo policy store is hosted<ul> <li>Click on <code>Fork</code></li> <li>uncheck the <code>Copy the master branch only</code> option </li> </ul> </li> <li>Install Agama Lab app and allow access to forked repository</li> <li>Open the Agama Lab policy designer.</li> <li>Click on <code>Change Repository</code>.</li> <li>Select the option <code>Manually Type Repository URL</code>.</li> <li>Paste the URL of your forked repository, then click the <code>Select</code> button.</li> <li>This will open the dashboard with two policy stores listed. Open the policy store named <code>tarpUnsignedDemo</code>.</li> <li>Now you can update the policy and schema using the    policy designer</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","quick start","TBAC"]},{"location":"cedarling/quick-start/cedarling-quick-start/#step-2-configure-tarp","title":"Step-2: Configure Tarp","text":"<p>In this step, we will add the policy store details in the Janssen Tarp that is installed in the browser. The Cedarling instance embedded in the Tarp will use the policy stored in the store (from Step-1) to evaluate the authorization result.</p> <ol> <li>Open the Janssen Tarp installed in the browser</li> <li>Navigate to the <code>Cedarling</code> tab and click on <code>Add Configurations</code></li> <li>Paste the following configuration parameters as JSON. Make sure to update the <code>&lt;Policy Store URI&gt;</code> value to point to your policy store    <pre><code>{\n    \"CEDARLING_APPLICATION_NAME\": \"My App\",\n    \"CEDARLING_POLICY_STORE_URI\": \"&lt;Policy Store URI&gt;\",\n    \"CEDARLING_LOG_TYPE\": \"std_out\",\n    \"CEDARLING_LOG_LEVEL\": \"INFO\",\n    \"CEDARLING_USER_AUTHZ\": \"enabled\",\n    \"CEDARLING_WORKLOAD_AUTHZ\": \"disabled\",\n    \"CEDARLING_PRINCIPAL_BOOLEAN_OPERATION\": {\n      \"===\": [{\"var\": \"Jans::User\"}, \"ALLOW\"]\n    },\n    \"CEDARLING_JWT_SIG_VALIDATION\": \"disabled\",\n    \"CEDARLING_JWT_STATUS_VALIDATION\": \"disabled\",\n    \"CEDARLING_MAPPING_USER\": \"Jans::User\",\n    \"CEDARLING_MAPPING_WORKLOAD\": \"Jans::Workload\",\n    \"CEDARLING_JWT_SIGNATURE_ALGORITHMS_SUPPORTED\": [\n      \"HS256\", \"RS256\"\n    ],\n    \"CEDARLING_ID_TOKEN_TRUST_MODE\": \"never\"\n}\n</code></pre></li> <li>Click <code>Save</code> to initialize the Cedarling. The Cedarling will fetch and validate your policy store during the initialization. </li> </ol> <p>The Cedarling is ready to receive and evaluate authorization requests at this stage.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","quick start","TBAC"]},{"location":"cedarling/quick-start/cedarling-quick-start/#step-3-test-authorization-using-the-cedarling","title":"Step-3: Test authorization using the Cedarling","text":"<ol> <li>Go to Tarp's <code>Cedarling</code> tab, click on <code>Cedarling Unsigned Authz Form</code></li> <li>Input the following in respective input boxes:</li> </ol> Principal<pre><code>    [\n      {\n        \"cedar_entity_mapping\": {\n          \"entity_type\": \"Jans::User\",\n          \"id\": \"some_id\"\n        },\n        \"sub\": \"some_sub\",\n        \"role\": [\n          \"Teacher\"\n        ]\n      }\n    ]\n</code></pre> Actions<pre><code>Jans::Action::\"Read\"\n</code></pre> Resource<pre><code>    {\n      \"cedar_entity_mapping\": {\n        \"entity_type\": \"Jans::SecretDocument\",\n        \"id\": \"some_id\"\n      }\n    }\n</code></pre> <p>Leave the <code>Context</code> blank.</p> <p>The request is ready to be sent. Click <code>Cedarling Authz Request</code> to send the request to the embedded Cedarling. After evaluation of the authorization request, the Cedarling will respond with a JSON payload. Similar to what is shown below.</p> Sample Response<pre><code>    {\n      \"decision\": true,\n      \"request_id\": \"019602e5-b148-7d0b-9d15-9d000c0d370b\",\n      ...\n    }\n</code></pre> <p>The top-level <code>decision: true</code> confirms successful authorization.</p> <p>Let's check a scenario where authorization is denied. Remove the role from the <code>Principal</code> entity and test the authorization.</p> Principal<pre><code>[\n  {\n    \"cedar_entity_mapping\": {\n      \"entity_type\": \"Jans::User\",\n      \"id\": \"some_id\"\n    },\n    \"sub\": \"some_sub\",\n    \"role\": []\n  }\n]\n</code></pre> <p>And click <code>Cedarling Authz Request</code> again. Cedarling will return a new result:</p> Sample Response<pre><code>{\n  \"decision\": false,\n  ...\n}\n</code></pre> <p>The top-level <code>decision: false</code> shows Cedarling denying authorization.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","quick start","TBAC"]},{"location":"cedarling/quick-start/cedarling-quick-start/#implement-rbac-using-signed-tokens-tbac","title":"Implement RBAC using signed tokens (TBAC)","text":"<p>In this guide, we will use Token-Based Access Control (TBAC) to implement role-based access control (RBAC).</p> <p>For better understanding of the TBAC flow, see the diagram below.</p> TBAC Sequence diagram <pre><code>sequenceDiagram\n    title Cedarling and Tarp\n\n    participant Browser\n    participant Tarp\n    participant Auth Server\n\n    Browser-&gt;&gt;Tarp: Enter Auth Server config\n    Tarp-&gt;&gt;Auth Server: Dynamic Client Registration \n    Auth Server-&gt;&gt;Tarp: Client ID and Secret\n    Browser-&gt;&gt;Tarp: Enter Cedarling bootstrap config\n    Tarp-&gt;&gt;Auth Server: GET /jans-auth/restv1/jwks\n    Auth Server-&gt;&gt;Tarp: JWKS\n    Tarp-&gt;&gt;Tarp: Initialize Cedarling\n    Browser-&gt;&gt;Tarp: Start authentication flow\n    Tarp-&gt;&gt;Auth Server: GET /jans-auth/restv1/authorize?...\n    Auth Server-&gt;&gt;Tarp: /callback?code=...\n    Tarp-&gt;&gt;Auth Server: GET /jans-auth/restv1/token\n    Auth Server-&gt;&gt;Tarp: {\"access_token\": &lt;JWT&gt;}\n\n    Browser-&gt;&gt;Tarp: Cedarling authorization flow(principal, action, resource, context)\n    Tarp-&gt;&gt;Browser: Cedarling Decision </code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","quick start","TBAC"]},{"location":"cedarling/quick-start/cedarling-quick-start/#prerequisites","title":"Prerequisites","text":"<ul> <li>Install the Janssen Tarp on Chrome or Firefox.</li> <li>Instance of Janssen Server or any other IDP with following configuration   in place.<ul> <li>Allow dynamic client registration</li> <li>Allow registered clients to request the <code>role</code> scope</li> <li>Have a user with the <code>role</code> claim set to the value <code>Teacher</code> and    return this claim in the userinfo token</li> </ul> </li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","quick start","TBAC"]},{"location":"cedarling/quick-start/cedarling-quick-start/#step-1-create-cedar-policy-and-schema","title":"Step-1: Create Cedar Policy and Schema","text":"<p>For this guide, we have created a policy store in the demo GitHub repository.</p> <p>The policy store has two policies. The first grants access to all actions and all resources to the users with the <code>Teacher</code> role. The second allows only <code>Read</code> permission to students with the <code>Student</code> role to any resource. The two policies are as follows:</p> <pre><code>@id(\"allow_teacher\")\npermit(\n  principal in Jans::Role::\"Teacher\",\n  action,\n  resource\n);\n</code></pre> <pre><code>@id(\"allow_student_read\")\npermit(\n  principal in Jans::Role::\"Student\",\n  action in [Jans::Action::\"Read\"],\n  resource\n)\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","quick start","TBAC"]},{"location":"cedarling/quick-start/cedarling-quick-start/#step-2-update-the-idp-information","title":"Step-2 Update the IDP information","text":"<p>The policy store in the demo repository has information about the IDP that released the tokens. You'll need to fork the demo repository and update the policy store to point it to your IDP instance. Follow the steps below to do this.</p> <ul> <li>Fork the demo repository. While creating the fork, uncheck the   <code>Copy the main branch only</code> checkbox.</li> <li> <p>Update the <code>openid_configuration_endpoint</code> key in the policy store JSON file   named <code>449805c83e13f332b1b35eac6ffa93187fbd1c648085.json</code> in the fork.    Set the value to    the <code>.well-known/openid-configuration</code> endpoint of your IDP. </p> <p>For instance:</p> <pre><code>\"openid_configuration_endpoint\": \"https://test-jans.gluu.info/.well-known/openid-configuration\"\n</code></pre> </li> <li> <p>Copy the link of the policy store file's raw content. This is the same file that you edited in the step above.   The URI would be similar to the shown below. This URI will be used in the next step when we configure Tarp.</p> <pre><code>https://raw.githubusercontent.com/JanssenProject/CedarlingQuickstart/refs/heads/main/449805c83e13f332b1b35eac6ffa93187fbd1c648085.json\n</code></pre> </li> </ul> Agama Lab: For authoring policies and managing the policy store <p>Alternatively, you can also use the Agama Lab For authoring policies and  managing the policy stores. </p> <p>Agama Lab is a free web tool provided by Gluu. This tool makes it very  easy to author, update policies and schema using an user interface. Follow the steps below to make changes to the policy that we are using above.</p> <ul> <li>Go to the CedarlingQuickstart repository where the demo policy store is hosted<ul> <li>Click on <code>Fork</code></li> <li>uncheck the <code>Copy the master branch only</code> option </li> </ul> </li> <li>Install Agama Lab app and allow access to forked repository</li> <li>Open the Agama Lab policy designer.</li> <li>Click on <code>Change Repository</code>.</li> <li>Select the option <code>Manually Type Repository URL</code>.</li> <li>Paste the URL of your forked repository, then click the <code>Select</code> button.</li> <li>This will open the dashboard with two policy stores listed. Open the policy store named <code>tarpDemo</code>.</li> <li>Now you can update the policy and schema using the    policy designer </li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","quick start","TBAC"]},{"location":"cedarling/quick-start/cedarling-quick-start/#step-3-configure-tarp-with-the-policy-store","title":"Step-3: Configure Tarp with the policy store","text":"<p>We will now add the policy store details in the Janssen Tarp that is installed in the browser. The Cedarling instance embedded in the Tarp will use the policy from the store (from step-1) to evaluate the authorization request.</p> <ol> <li>Open Tarp installed in the Chrome browser</li> <li>Click <code>Add Client</code>. Use details below to add a new client.<ul> <li>Issuer: The hostname of your IDP</li> <li>Expiry: The day after today</li> <li>Scopes: <code>openid</code>, <code>profile</code>, <code>role</code></li> </ul> </li> <li>Click <code>Register</code> to register a new client on your IDP.</li> <li>Go to <code>Cedarling</code> tab and click <code>Add Configurations</code></li> <li>Select <code>JSON</code> configuration type and Paste the config as given below.    Remember to replace <code>&lt;Policy Store URI&gt;</code> with    the URI of your policy store:    <pre><code>      {\n        \"CEDARLING_APPLICATION_NAME\": \"My App\",\n        \"CEDARLING_POLICY_STORE_URI\": \"&lt;Policy Store URI&gt;\",\n        \"CEDARLING_LOG_TYPE\": \"std_out\",\n        \"CEDARLING_LOG_LEVEL\": \"INFO\",\n        \"CEDARLING_USER_AUTHZ\": \"enabled\",\n        \"CEDARLING_WORKLOAD_AUTHZ\": \"disabled\",\n        \"CEDARLING_PRINCIPAL_BOOLEAN_OPERATION\": {\n          \"===\": [{\"var\": \"Jans::User\"}, \"ALLOW\"]\n        },\n        \"CEDARLING_JWT_SIG_VALIDATION\": \"enabled\",\n        \"CEDARLING_JWT_STATUS_VALIDATION\": \"disabled\",\n        \"CEDARLING_MAPPING_USER\": \"Jans::User\",\n        \"CEDARLING_MAPPING_WORKLOAD\": \"Jans::Workload\",\n        \"CEDARLING_JWT_SIGNATURE_ALGORITHMS_SUPPORTED\": [\n          \"HS256\", \"RS256\"\n        ],\n        \"CEDARLING_ID_TOKEN_TRUST_MODE\": \"never\"\n      }\n</code></pre></li> <li>Click <code>Save</code> to initialize Cedarling.</li> </ol> <p>This will start the embedded Cedarling instance in the Tarp.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","quick start","TBAC"]},{"location":"cedarling/quick-start/cedarling-quick-start/#step-4-test-the-policy-using-the-cedarling","title":"Step-4: Test the policy using the Cedarling","text":"<p>Since we are implementing TBAC, we have to authenticate the user first to get the tokens.</p> <ol> <li>In Tarp, under <code>Authentication flow</code> tab, click the \u26a1 icon to begin authentication</li> <li> <p>Use the following inputs to fill the form:</p> <ul> <li>ACR: <code>basic</code></li> <li>Scopes: <code>openid</code>, <code>profile</code>, <code>role</code></li> <li>Check the <code>Display access and ID token after authentication</code> checkbox</li> </ul> </li> <li> <p>Click the <code>Trigger auth flow</code> button</p> </li> <li>Login using username and password of a user who has the <code>Teacher</code> role assigned in the IDP</li> <li>Click <code>Allow</code> on the consent screen</li> <li>If the authentication is successful, Tarp will show you a page with token details </li> <li>Move to <code>Cedarling</code> tab and select <code>Cedarling Signed Authz Form</code> tab</li> <li>Use the details below as an input to this form:<ul> <li>Principal: select all 3 tokens. In TBAC approach here, we are passing tokens (i.e signed JWTs) in place of JSON string.</li> <li>Action: <code>Jans::Action::\"Write\"</code></li> <li>Resource:     <pre><code>{\n  \"cedar_entity_mapping\": {\n    \"entity_type\": \"Jans::SecretDocument\",\n    \"id\": \"some_id\"\n  }\n}\n</code></pre></li> <li>Leave the <code>context</code> as default</li> </ul> </li> <li>Click <code>Cedarling Authz Request</code> Sample Response<pre><code>{\n  ...\n  \"decision\": true,\n  \"request_id\": \"019602f1-c964-7dbb-8a07-5b66b642e502\"\n}\n</code></pre></li> </ol> <p>The top-level <code>decision: true</code> confirms successful authorization.</p> <p>To test the negative case, we will do the following:</p> <ol> <li>Modify the user in the IDP to have the <code>Student</code> role instead of <code>Teacher</code></li> <li>Logout from the Cedarling if you are logged in and rerun the authorization flow with the same parameters to obtain new tokens</li> <li>Run signed authorization using the same inputs</li> <li>The top-level <code>decision: false</code> confirms failed authorization. The first policy in the store allowed full access to users in the <code>Teacher</code> role, but the second policy only allowed <code>Read</code> access, which fails since our request was <code>Write</code> access.</li> <li>Repeat the authorization with action <code>Jans::Action::\"Read\"</code> to confirm that the user has <code>Read</code> access but not <code>Write</code> access</li> </ol>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","quick start","TBAC"]},{"location":"cedarling/reference/cedarling-authz/","title":"Authorization Using Cedarling","text":"<p>The Policy Store contains the Cedar Policies, Cedar Schema, and optionally, a list of the Trusted IDPs. The Cedarling loads its Policy Store during initialization as a static JSON file or fetched via HTTPS. In enterprise deployments, the Cedarling can retrieve its Policy Store from a Jans Lock Server OAuth protected endpoint.</p> <p>Developers need to define Cedar Schema that makes sense for their application. For example, a developer writing a customer support application might define an \"Issue\" Resource and Actions like \"Reply\" or \"Close\". Once the schema is defined, developers can author policies to model the fine grain access controls needed to implement the business rules of their application. The easiest way to define schema and policies is to use the AgamaLab Policy Designer. This is a free developer tool hosted by Gluu.</p> <p></p> <p>The JWTs, Resource, Action, and Context are sent in the authz request. Cedar Pricipals entities are derived from JWT tokens. The OpenID Connect (\"OIDC\") JWTs are joined by the Cedarling to create User and Role entities; the OAuth access token is used to create a Workload entity, which is the software that is acting on behalf of the Person (or autonomously). The Cedarling validates that given its policies, Role, Person and Workload are authorized. If one of Role or Person and Workload is authorized then the request is allowed to proceed.</p> <p>The Cedarling maps \"Roles\" out-of-the-box. In Cedar, Roles are a special kind of Principal. Instead of saying \"User can perform action\", we can say \"Role can perform action\"--a convenient way to implement RBAC. Developers can specify which JWT claim is used to map Cedar Roles. For example, one domain may use the <code>role</code> user claim of the OpenID Userinfo token; another domain may use the <code>memberOf</code> claim in the OIDC id_token.</p> <p>Developers can also express a variety of policies beyond the limitations of RBAC by expressing ABAC conditions, or combining ABAC and RBAC conditions. For example, a policy like Admins can access a \"private\" Resource from the private network, during business hours. In this case \"Admins\" is the role, but the other conditions are ABAC. Policy evaluation is fast because Cedar uses the RBAC role to \"slice\" the data, minimizing the number of entries on which to evaluate the ABAC conditions.</p> <p>The OIDC <code>id_token</code> JWT represents a Person authentication event. The access token JWT represents a Workload authentication event. These tokens contain other interesting contextual data. The <code>id_token</code> tells you who authenticated, when they authenticated, how they authenticatated, and optionally other claims like the User's roles. An OAuth access token can tell you information about the Workload that obtained the JWT, its extent of access as defined by the OAuth Authorization Server (i.e. the values of the <code>scope</code> claim), or other claims--domains frequently enhance the access token to contain business specific data needed for policy evaluation.</p> <p>The Cedarling authorizes a Person using a certain piece of software, which is called a \"Workload\". From a logical perspective, (<code>person_allowed</code> AND <code>workload_allowed</code>) must be <code>True</code>. The JWT's, Action, Resource and Context is sent by the application in the authorization request. For example, this is a sample request from a hypothetical application:</p> <pre><code>const bootstrap_config = {...};\nconst cedarling = await init(bootstrap_config);\nlet input = {\n  \"tokens\": {\n    \"access_token\": \"eyJhbGc....\",\n    \"id_token\": \"eyJjbGc...\",\n    \"userinfo_token\": \"eyJjbGc...\",\n  },\n  \"action\": \"View\",\n  \"resource\": {\n    \"cedar_entity_mapping\": {\n      \"entity_type\": \"Ticket\",\n      \"id\": \"ticket-10101\"\n    },\n    \"owner\": \"bob@acme.com\",\n    \"org_id\": \"Acme\"\n  },\n  \"context\": {\n    \"ip_address\": \"54.9.21.201\",\n    \"network_type\": \"VPN\",\n    \"user_agent\": \"Chrome 125.0.6422.77 (Official Build) (arm64)\",\n    \"time\": \"1719266610.98636\",\n  }\n}\n\ndecision_result = await cedarling.authorize(input)\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/reference/cedarling-authz/#automatically-adding-entity-references-to-the-context","title":"Automatically Adding Entity References to the Context","text":"<p>Cedarling simplifies context creation by automatically including certain entities. This means you don't need to manually pass their references when using them in your policies. The following entities are automatically added to the context.</p> <ul> <li>Workload Entity</li> <li>User Entity</li> <li>Resource Entity</li> <li>Access Token Entity</li> <li>ID Token Entity</li> <li>Userinfo Token Entity</li> </ul> <p>Additionally, any default entities defined in the policy store are available for all authorization decisions without needing to be explicitly passed in the request. Entity merging automatically resolves conflicts, ensuring that request entities take precedence over default entities when UIDs match.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/reference/cedarling-authz/#example-policy","title":"Example Policy","text":"<p>Below is an example policy schema that illustrates how entities are used:</p> <pre><code>type Context = {\n  \"access_token\": Access_token,\n  \"time\": Long,\n  \"user\": User,\n  \"workload\": Workload\n};\n\ntype Url = {\n  \"host\": String,\n  \"path\": String,\n  \"protocol\": String\n};\n\nentity Access_token = {\n  \"exp\": Long,\n  \"iss\": Jans::TrustedIssuer\n};\n\nentity Issue = {\n  \"country\": String,\n  \"org_id\": String\n};\n\nentity Role;\n\nnamespace Jans{\n  entity TrustedIssuer = {\n    \"issuer_entity_id\": Url\n  };\n}\n\n\nentity User in [Role] = {\n  \"country\": String,\n  \"email\": String,\n  \"sub\": String,\n  \"username\": String\n};\n\nentity Workload = {\n  \"client_id\": String,\n  \"iss\": Jans::TrustedIssuer,\n  \"name\": String,\n  \"org_id\": String\n};\n\naction \"Update\" appliesTo {\n  principal: [Role, Workload, User],\n  resource: [Issue],\n  context: {\n    \"access_token\": Access_token,\n    \"time\": Long,\n    \"user\": User,\n    \"workload\": Workload\n  }\n};\n\naction \"View\" appliesTo {\n  principal: [Role, Workload, User],\n  resource: [Issue],\n  context: Context\n};\n</code></pre> <p>Note: The <code>TrustedIssuer</code> namespace corresponds to its name.</p> <p>With this schema, you only need to provide the fields that are not automatically included. For instance, to define the <code>time</code> in the context:</p> <pre><code>let context = {\n  time: 1719266610.98636,\n};\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/reference/cedarling-authz/#unsigned-authorization-authorize_unsigned","title":"Unsigned Authorization (authorize_unsigned)","text":"<p>The <code>authorize_unsigned</code> method allows making authorization decisions without JWT token verification. This is useful when:</p> <ul> <li>You already have verified the principals through other means</li> <li>You need to make authorization decisions for non-token based scenarios</li> <li>You're implementing custom authentication flows</li> </ul> <p>Example usage:</p> <pre><code>let input = {\n  principals: [\n    {\n      id: \"user123\",\n      type: \"User\",\n      email: \"user@example.com\",\n      roles: [\"admin\"],\n    },\n  ],\n  action: \"View\",\n  resource: {\n    cedar_entity_mapping: {\n      entity_type: \"Ticket\",\n      id: \"ticket-10101\",\n    },\n    owner: \"bob@acme.com\",\n    org_id: \"Acme\",\n  },\n  context: {\n    ip_address: \"54.9.21.201\",\n    network_type: \"VPN\",\n    user_agent: \"Chrome 125.0.6422.77 (Official Build) (arm64)\",\n    time: \"1719266610.98636\",\n  },\n};\n\ndecision_result = await cedarling.authorize_unsigned(input);\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/reference/cedarling-authz/#when-to-use-authorize_unsigned-vs-authorize","title":"When to use authorize_unsigned vs authorize","text":"Feature authorize authorize_unsigned JWT validation Yes No Token requirements Requires valid JWTs Accepts raw entities Use case Standard auth flows Custom auth flows Security Higher (validates) Lower (trusts input)","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/reference/cedarling-authz/#multi-issuer-authorization-authorize_multi_issuer","title":"Multi-Issuer Authorization (authorize_multi_issuer)","text":"<p>The <code>authorize_multi_issuer</code> method enables authorization decisions based on multiple JWT tokens from different issuers in a single request. Unlike the standard <code>authorize</code> method which creates User and Workload principals, multi-issuer authorization evaluates policies based purely on token entities themselves.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/reference/cedarling-authz/#key-differences-from-standard-authorization","title":"Key Differences from Standard Authorization","text":"Feature authorize authorize_multi_issuer Principal Model User/Workload entities No principals - token-based context Token Sources Single issuer expected Multiple issuers supported Token Types Fixed (access, id, userinfo) Flexible with explicit mapping Context Structure User/Workload in context Individual token entities in context.tokens Use Case Standard RBAC/ABAC flows Federation, API gateways, multi-issuer apps Policy Principal <code>principal is User/Workload</code> Not applicable (principal-less) Policy Context Access <code>context.user</code>, <code>context.workload</code> <code>context.tokens.{issuer}_{token_type}</code>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/reference/cedarling-authz/#how-it-works","title":"How It Works","text":"<ol> <li>Token Input: Developers provide an array of <code>TokenInput</code> objects, each containing:</li> <li><code>mapping</code>: The Cedar entity type (e.g., \"Jans::Access_Token\", \"Acme::DolphinToken\")</li> <li> <p><code>payload</code>: The JWT token string</p> </li> <li> <p>Token Validation: Each token is validated using the existing Cedarling JWT validation capabilities:</p> </li> <li>Signature verification</li> <li>Expiration and time-based validation</li> <li>Status list validation (if configured)</li> <li> <p>Only tokens from trusted issuers are processed</p> </li> <li> <p>Entity Creation: Each valid token becomes a Cedar entity with:</p> </li> <li>Token metadata (type, jti, issuer, exp, validated_at)</li> <li>JWT claims stored as entity tags</li> <li> <p>All claims stored as Sets of strings by default for consistency</p> </li> <li> <p>Context Building: Valid tokens are organized into a <code>tokens</code> collection with predictable naming:</p> </li> <li>Field naming: <code>{issuer_name}_{token_type}</code></li> <li>Example: <code>context.tokens.acme_access_token</code>, <code>context.tokens.google_id_token</code></li> <li> <p>Issuer name comes from trusted issuer metadata or JWT iss claim</p> </li> <li> <p>Policy Evaluation: Policies evaluate based on token entities in context without requiring a principal</p> </li> </ol>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/reference/cedarling-authz/#example-usage","title":"Example Usage","text":"<pre><code>// Create tokens array with explicit mappings\nlet tokens = [\n  {\n    mapping: \"Jans::Access_Token\",\n    payload: \"eyJhbGciOiJIUzI1NiIs...\"\n  },\n  {\n    mapping: \"Jans::Id_Token\", \n    payload: \"eyJhbGciOiJFZERTQSIs...\"\n  },\n  {\n    mapping: \"Acme::DolphinToken\",\n    payload: \"ey1b6cfMef21084633a7...\"\n  }\n];\n\n// Create multi-issuer request\nlet request = {\n  tokens: tokens,\n  action: \"Jans::Action::\\\"Read\\\"\",\n  resource: {\n    cedar_entity_mapping: {\n      entity_type: \"Jans::Document\",\n      id: \"doc-123\"\n    },\n    owner: \"alice@example.com\",\n    classification: \"confidential\"\n  },\n  context: {\n    ip_address: \"54.9.21.201\",\n    time: Date.now()\n  }\n};\n\n// Execute authorization\nlet result = await cedarling.authorize_multi_issuer(request);\n\n// Check decision\nif (result.decision) {\n  console.log(\"Access allowed\");\n} else {\n  console.log(\"Access denied\");\n}\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/reference/cedarling-authz/#policy-examples","title":"Policy Examples","text":"<p>Policies for multi-issuer authorization reference tokens directly in the context:</p> <pre><code>// Policy checking token from specific issuer with claim\npermit(\n  principal,\n  action == Jans::Action::\"Read\",\n  resource in Jans::Document\n) when {\n  context has tokens.acme_access_token &amp;&amp;\n  context.tokens.acme_access_token.hasTag(\"scope\") &amp;&amp;\n  context.tokens.acme_access_token.getTag(\"scope\").contains(\"read:documents\")\n};\n\n// Policy requiring tokens from multiple issuers\npermit(\n  principal,\n  action == TradeAssociation::Action::\"Vote\",\n  resource in TradeAssociation::Resource::\"Elections\"\n) when {\n  // Require token from trade association\n  context has tokens.trade_association_access_token &amp;&amp;\n  context.tokens.trade_association_access_token.hasTag(\"member_status\") &amp;&amp;\n  context.tokens.trade_association_access_token.getTag(\"member_status\").contains(\"Corporate Member\") &amp;&amp;\n  // AND require token from company\n  context has tokens.nexo_access_token &amp;&amp;\n  context.tokens.nexo_access_token.hasTag(\"scope\") &amp;&amp;\n  context.tokens.nexo_access_token.getTag(\"scope\").contains(\"trade_association_rep\")\n};\n\n// Policy with custom token type\npermit(\n  principal,\n  action == Acme::Action::\"SwimWithDolphin\",\n  resource == Acme::Resource::\"MiamiAcquarium\"\n) when {\n  context has tokens.dolphin_acme_dolphin_token &amp;&amp;\n  context.tokens.dolphin_acme_dolphin_token.hasTag(\"waiver\") &amp;&amp;\n  context.tokens.dolphin_acme_dolphin_token.getTag(\"waiver\").contains(\"signed\")\n};\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/reference/cedarling-authz/#token-collection-naming-convention","title":"Token Collection Naming Convention","text":"<p>The Cedarling uses a predictable algorithm to create token collection field names:</p> <p>Pattern: <code>{issuer_name}_{token_type}</code></p> <p>Issuer Name Resolution:</p> <ol> <li>Look up issuer in trusted issuer metadata and use the <code>name</code> field</li> <li>If no <code>name</code> field, use hostname from JWT <code>iss</code> claim</li> <li>Convert to lowercase and replace special characters with underscores</li> </ol> <p>Token Type Resolution:</p> <ol> <li>Extract from mapping field (e.g., \"Jans::Access_Token\")</li> <li>Split by namespace separator (\"::\")</li> <li>Convert to lowercase, preserving underscores</li> </ol> <p>Examples:</p> <ul> <li>JWT issuer: <code>https://idp.acme.com/auth</code>, Trusted issuer name: <code>\"Acme\"</code>, Mapping: <code>Jans::Access_Token</code> \u2192 <code>acme_access_token</code></li> <li>JWT issuer: <code>https://login.microsoftonline.com/tenant</code>, Trusted issuer name: <code>\"Microsoft\"</code>, Mapping: <code>Jans::Id_Token</code> \u2192 <code>microsoft_id_token</code></li> <li>JWT issuer: <code>https://idp.dolphin.sea/auth</code>, Trusted issuer name: <code>\"Dolphin\"</code>, Mapping: <code>Acme::DolphinToken</code> \u2192 <code>dolphin_acme_dolphin_token</code></li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/reference/cedarling-authz/#error-handling","title":"Error Handling","text":"<p>Graceful Token Validation Failures:</p> <ul> <li>Invalid tokens are ignored and logged</li> <li>Authorization continues with remaining valid tokens</li> <li>At least one valid token is required for authorization to proceed</li> </ul> <p>Non-Deterministic Token Detection:</p> <ul> <li>System rejects requests with multiple tokens of the same type from the same issuer</li> <li>Example: Two \"Jans::Access_Token\" from \"Acme\" issuer will fail</li> <li>This prevents ambiguous policy evaluation</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/reference/cedarling-authz/#use-cases","title":"Use Cases","text":"<ol> <li>Federation Scenarios: Applications accepting tokens from multiple identity providers</li> <li>API Gateways: Validating tokens from various upstream services in a single authorization check</li> <li>Multi-Organization Access: Requiring tokens from different organizations for collaborative workflows</li> <li>Capability-Based Authorization: Decisions based on capabilities asserted by different issuers rather than single user identity</li> <li>Zero Trust Architectures: Each token represents a verification from a different trust boundary</li> </ol>","tags":["administration","lock","authorization / authz","Cedar","Cedarling"]},{"location":"cedarling/reference/cedarling-entities/","title":"Cedarling Principal Mappings","text":"<p>Cedarling automatically creates the following entities:</p> <ul> <li>Trusted Issuer</li> <li>Workload</li> <li>User</li> <li>Role</li> <li>JWT Entities</li> </ul> <p>The entity type names of the Workload and User entities can be customized via the <code>CEDARLING_MAPPING_USER</code> and <code>CEDARLING_MAPPING_WORKLOAD</code> properties respectively.</p> <p>Notes</p> <ul> <li>All entity creation and attribute population logic is configurable via the Token Metadata Schema (TEMS) and Cedarling bootstrap properties.</li> <li>Attribute presence depends on token contents and policy store configuration.</li> <li>Role inheritance simplifies user-role mapping for RBAC policy enforcement.</li> </ul>","tags":["administration","Cedar","Cedarling","Principal","Mappings"]},{"location":"cedarling/reference/cedarling-entities/#trusted-issuer","title":"Trusted Issuer","text":"<p>Cedarling creates a Trusted Issuer entity at startup for each trusted issuer defined in the policy store.</p> <ul> <li>Namespace: Corresponds to the trusted issuer name of the trusted issuer object in the policy store..</li> <li>Type Name: <code>TrustedIssuer</code></li> <li>Entity ID:  Set using issuer url and corresponds iss in token.</li> </ul>","tags":["administration","Cedar","Cedarling","Principal","Mappings"]},{"location":"cedarling/reference/cedarling-entities/#workload-entity","title":"Workload Entity","text":"<p>Cedarling creates a Workload entity for each request when the <code>CEDARLING_WORKLOAD_AUTHZ</code> bootstrap property is set to <code>enabled</code>.</p> <ul> <li>Default Type Name: <code>Jans::Workload</code></li> <li>Entity ID: Determined by the <code>workload_id</code> attribute from the Token Entity Metadata Schema (TEMS).</li> <li>If <code>workload_id</code> is not set, Cedarling will fall back to the following claims (in order):</li> <li><code>aud</code> from the <code>access_token</code></li> <li><code>client_id</code> from the <code>access_token</code></li> <li><code>aud</code> from the <code>id_token</code> -- note that the Workload attributes that will be created from this will still be from the <code>access_token</code></li> <li>Entity Attributes: Extracted from by the claims of the <code>access_token</code>. Cedarling will check the schema and use the JWT claims with the same names as the Workload attributes.</li> </ul>","tags":["administration","Cedar","Cedarling","Principal","Mappings"]},{"location":"cedarling/reference/cedarling-entities/#example-workload-entity-creation","title":"Example Workload Entity Creation","text":"<p>With the following <code>access_token</code> claims:</p> <pre><code>{\n  \"iss\": \"https://test.com/\",\n  \"aud\": \"some_aud\",\n  \"jti\": \"some_jti\",\n}\n</code></pre> <p>and Cedar schema:</p> <pre><code>namespace Jans{\n  entity TrustedIssuer;\n};\n\nentity Workload = {\n  iss: Jans::TrustedIssuer,\n  client_id?: String,\n  aud?: String,\n  name?: String,\n  rp_id?: String,\n  spiffe_id?: String,\n  access_token?: Access_token,\n};\n</code></pre> <p>The following entity Workload Entity could be created:</p> <pre><code>{\n  \"uid\": {\"type\": \"Workload\", \"id\": \"some_aud\"},\n  \"attrs\": {\n    \"iss\": {\"__entity\": {\"type\": \"Jans::TrustedIssuer\", \"id\": \"https://test.com/\"}},\n    \"aud\": \"some_aud\"\n    \"access_token\": {\"__entity\": {\"type\": \"Access_token\", \"id\": \"some_jti\"}},\n  },\n  \"parents\": []\n}\n</code></pre>","tags":["administration","Cedar","Cedarling","Principal","Mappings"]},{"location":"cedarling/reference/cedarling-entities/#user-entity","title":"User Entity","text":"<p>Cedarling creates a User entity for each request when the <code>CEDARLING_USER_AUTHZ</code> bootstrap property is set to <code>enabled</code>.</p> <ul> <li>Default Type Name: <code>Jans::User</code></li> <li>Entity ID: Determined by the <code>user_id</code> attribute from the TEMS.</li> <li>If <code>user_id</code> is not set, Cedarling will fall back to the following claims (in order):</li> <li><code>sub</code> from the <code>userinfo_token</code></li> <li><code>sub</code> from the <code>id_token</code></li> <li>Entity Attributes: Determined by the combined claims of the <code>id_token</code> and <code>userinfo_token</code>. Cedarling will check the schema and use the JWT claims with the same names as the User attributes.</li> </ul>","tags":["administration","Cedar","Cedarling","Principal","Mappings"]},{"location":"cedarling/reference/cedarling-entities/#example-user-entity-creation","title":"Example User Entity Creation","text":"<p>With the following <code>id_token</code> claims:</p> <pre><code>{\n  \"iss\": \"https://test.com/\",\n  \"sub\": \"some_sub\",\n  \"email\": \"bob@email.com\",\n  \"jti\": \"id_tkn_jti\",\n  \"role\": \"role1\"\n}\n</code></pre> <p>and <code>userinfo_token</code> claims:</p> <pre><code>{\n  \"iss\": \"https://test.com/\",\n  \"sub\": \"some_sub\",\n  \"name\": \"bob\",\n  \"jti\": \"userinfo_tkn_jti\",\n  \"role\": [\"role2\", \"role3\"]\n}\n</code></pre> <p>and Cedar schema:</p> <pre><code>entity Role;\nentity User in [Role] = {\n  sub: String,\n  email: String,\n  name: String,\n};\n</code></pre> <p>The following entity Workload Entity could be created:</p> <pre><code>{\n  \"uid\": {\"type\": \"User\", \"id\": \"some_sub\"},\n  \"attrs\": {\n    \"sub\": \"some_sub\",\n    \"email\": \"email@email.com\",\n    \"name\": \"bob\"\n  },\n  \"parents\": [\n    {\"type\": \"Role\", \"id\": \"role1\"},\n    {\"type\": \"Role\", \"id\": \"role2\"},\n    {\"type\": \"Role\", \"id\": \"role3\"}\n  ]\n}\n</code></pre>","tags":["administration","Cedar","Cedarling","Principal","Mappings"]},{"location":"cedarling/reference/cedarling-entities/#role-entity","title":"Role Entity","text":"<p>Cedarling automatically attempts to create Role entities for each request.</p> <ul> <li>Default Type Name: <code>Jans::Role</code></li> <li>Entity ID: Determined by the <code>role_mapping</code> attribute from the TEMS.</li> <li>If <code>role_mapping</code> is not set, Cedarling will try to create Role entities based on the following claims (in order):</li> <li><code>role</code> from the <code>userinfo_token</code></li> <li><code>role</code> from the <code>id_token</code></li> </ul>","tags":["administration","Cedar","Cedarling","Principal","Mappings"]},{"location":"cedarling/reference/cedarling-entities/#rbac-support","title":"RBAC Support","text":"<p>Since Role entities are automatically assigned as parents of User entities, you can easily define RBAC policies like:</p> <pre><code>permit (\n   principal == Jans::Role::\"Admin\",\n   action in [Jans::Action::\"Compare\",Jans::Action::\"Execute\"],\n)\n</code></pre>","tags":["administration","Cedar","Cedarling","Principal","Mappings"]},{"location":"cedarling/reference/cedarling-entities/#jwt-entities","title":"JWT Entities","text":"<p>Cedarling creates JWT entities for each token defined in the trusted issuers schema.</p> <ul> <li>Type Name: Determined by the <code>entity_type_name</code> attribute from the TEMS.</li> <li>Entity ID: Determined by the <code>token_id</code> attribute from the TEMS.</li> </ul>","tags":["administration","Cedar","Cedarling","Principal","Mappings"]},{"location":"cedarling/reference/cedarling-entities/#attribute-mappings","title":"Attribute Mappings","text":"<p>Each claim in the JWT is automatically added to the JWT entity's attributes.</p>","tags":["administration","Cedar","Cedarling","Principal","Mappings"]},{"location":"cedarling/reference/cedarling-entities/#entity-merging-and-conflict-resolution","title":"Entity Merging and Conflict Resolution","text":"<p>Cedarling automatically merges entities from multiple sources during authorization requests. The merging process follows specific rules to ensure consistency and handle conflicts appropriately.</p>","tags":["administration","Cedar","Cedarling","Principal","Mappings"]},{"location":"cedarling/reference/cedarling-entities/#merging-order-and-precedence","title":"Merging Order and Precedence","text":"<ol> <li>Default Entities: Loaded first from policy store configuration</li> <li>Request Entities: Resource, issuers, roles, tokens, user, and workload entities</li> <li>Conflict Resolution: Request entities override default entities when UID conflicts occur</li> </ol>","tags":["administration","Cedar","Cedarling","Principal","Mappings"]},{"location":"cedarling/reference/cedarling-entities/#example-entity-override-scenario","title":"Example: Entity Override Scenario","text":"<p>When a resource entity has the same UID as a default entity:</p> <pre><code>// Default entity in policy store\n{\n  \"org1\": {\n    \"uid\": {\n      \"type\": \"Jans::Organization\",\n      \"id\": \"org1\"\n    },\n    \"attrs\": {\n      \"name\": \"Default Organization\",\n      \"is_active\": true\n    },\n    \"parents\": []\n  }\n}\n\n// Request resource entity\n{\n  \"uid\": {\n    \"type\": \"Jans::Organization\",\n    \"id\": \"org1\"\n  },\n  \"attrs\": {\n    \"name\": \"Updated Organization\", // Different name\n    \"is_active\": false // Different status\n  },\n  \"parents\": []\n}\n</code></pre> <p>Result: The request entity's attributes (<code>\"Updated Organization\"</code>, <code>is_active: false</code>) will be used, overriding the default entity's values.</p>","tags":["administration","Cedar","Cedarling","Principal","Mappings"]},{"location":"cedarling/reference/cedarling-interfaces/","title":"Cedarling Interfaces","text":"<p>Cedarling provides a number of methods to interface with the Cedar engine. These are described below.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-interfaces/#init","title":"Init","text":"<p>These methods are used to create a <code>BootstrapConfig</code> object, which is needed to initialize a Cedarling instance. Bootstrap properties are required to do this.</p> <ul> <li> <p><code>load_from_file(path)</code></p> <p>Creates a <code>BootstrapConfig</code> object by loading properties from a file </p> </li> <li> <p><code>load_from_json(config_json)</code></p> <p>Creates a <code>BootstrapConfig</code> object by reading in a string encoded JSON object containing properties.</p> </li> <li> <p><code>from_env(options)</code></p> <p>Creates a <code>BootstrapConfig</code> object by reading environment variables. If a dictionary is passed in, it will override environment variables.</p> </li> <li> <p><code>Cedarling(bootstrap_config)</code></p> <p>Initializes an instance of the Cedarling engine by reading the bootstrap configuration. </p> </li> </ul>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-interfaces/#authz","title":"Authz","text":"<p>These methods are called to create an authorization request, run authorization, and get decisions back.</p> <ul> <li> <p><code>Entity(entity_type, id, payload)</code></p> <p>Creates a <code>Principal</code> or a <code>Resource</code> entity.</p> <ul> <li> <p><code>from_dict(value)</code></p> <p>Creates a <code>Principal</code> or a <code>Resource</code> entity from a dictionary.</p> </li> </ul> </li> <li> <p><code>Request(tokens, action, resource, context)</code></p> <p>Creates a <code>Request</code> object which contains inputs for the Cedarling's authorization call.</p> </li> <li> <p><code>RequestUnsigned(principals, action, resource, context)</code></p> <p>Creates a <code>RequestUnsigned</code> object which contains inputs for Cedarling's unsigned authorization call.</p> </li> <li> <p><code>TokenInput(mapping, payload)</code></p> <p>Creates a <code>TokenInput</code> object representing a JWT token with an explicit type mapping. Used for multi-issuer authorization.</p> <ul> <li><code>mapping</code>: A string specifying the Cedar entity type (e.g., \"Jans::Access_Token\", \"Acme::DolphinToken\")</li> <li><code>payload</code>: The JWT token string</li> </ul> </li> <li> <p><code>AuthorizeMultiIssuerRequest(tokens, action, resource, context)</code></p> <p>Creates an <code>AuthorizeMultiIssuerRequest</code> object for multi-issuer authorization. </p> <ul> <li><code>tokens</code>: Array of <code>TokenInput</code> objects</li> <li><code>action</code>: The action to be authorized (required)</li> <li><code>resource</code>: The resource entity being accessed (required)</li> <li><code>context</code>: Optional additional context for policy evaluation</li> </ul> </li> <li> <p><code>authorize(request)</code></p> <p>Runs authorization against the provided <code>Request</code> object.</p> </li> <li> <p><code>authorize_unsigned(request)</code></p> <p>Runs unsigned authorization against the provided <code>RequestUnsigned</code> object. A trusted issuer is not required for this call.</p> </li> <li> <p><code>authorize_multi_issuer(request)</code></p> <p>Runs multi-issuer authorization against the provided <code>AuthorizeMultiIssuerRequest</code> object. Validates multiple JWT tokens from different issuers and evaluates policies based on token entities without requiring traditional user/workload principals.</p> </li> </ul>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-interfaces/#authz-result","title":"Authz Result","text":"<p>The following methods are called on the result obtained from the authorization call to view and analyze results, reasons and possible errors.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-interfaces/#authorizeresult-for-authorize-and-authorize_unsigned","title":"AuthorizeResult (for <code>authorize</code> and <code>authorize_unsigned</code>)","text":"<ul> <li> <p><code>is_allowed()</code></p> <p>Returns <code>true</code> only if the overall decision of the Cedarling is <code>true</code>.</p> </li> <li> <p><code>workload()</code></p> <p>Returns the decision of the <code>Workload</code> authorization</p> </li> <li> <p><code>principal()</code></p> <p>Returns the decision of the <code>Principal</code> authorization</p> </li> <li> <p><code>request_id()</code></p> <p>Returns the request ID of this authorization call. This is used to retrieve logs if the Cedarling is running in memory log mode.</p> </li> <li> <p><code>decision</code></p> <p>This field represents the decision of this authorization call (allow/deny)</p> </li> <li> <p><code>diagnostics</code></p> <p>This field contains additional information regarding the decision reached by Cedarling.</p> <ul> <li><code>reason</code></li> </ul> <p>This field is a set of policy IDs used to reach an <code>allow</code> decision, if they exist</p> <ul> <li><code>errors</code></li> </ul> <p>This field contains a list of errors during authorization, if they exist.</p> </li> </ul>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-interfaces/#multiissuerauthorizeresult-for-authorize_multi_issuer","title":"MultiIssuerAuthorizeResult (for <code>authorize_multi_issuer</code>)","text":"<ul> <li> <p><code>decision</code></p> <p>A boolean field representing whether the authorization request is allowed (<code>true</code>) or denied (<code>false</code>)</p> </li> <li> <p><code>response</code></p> <p>The Cedar policy engine response containing detailed decision information</p> <ul> <li><code>decision()</code> - Returns the decision (Allow/Deny)</li> <li><code>diagnostics()</code> - Returns diagnostics including reasons and errors<ul> <li><code>reason()</code> - Set of policy IDs that contributed to an Allow decision</li> <li><code>errors()</code> - List of errors encountered during policy evaluation</li> </ul> </li> </ul> </li> <li> <p><code>request_id</code></p> <p>The request ID for this authorization call, used for log retrieval and auditing</p> </li> </ul>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-interfaces/#logs","title":"Logs","text":"<p>These methods are called to retrieve logs from the memory of the Cedarling instance when it is running in <code>memory</code> mode.</p> <ul> <li> <p><code>pop_logs()</code></p> <p>Removes and returns the latest log from the memory of the Cedarling instance</p> </li> <li> <p><code>get_log_by_id(id)</code></p> <p>Retrieves a log given the ID of an active log entry. </p> </li> <li> <p><code>get_log_ids()</code></p> <p>Returns the list of all active log entries in Cedarling's memory.</p> </li> <li> <p><code>get_logs_by_tag(tag)</code></p> <p>Returns the list of all logs with a given tag. A tag can be either the type of log (System, Decision, Metric) or the log level</p> </li> <li> <p><code>get_logs_by_request_id(request_id)</code></p> <p>Returns the list of all logs with a given request ID. This request ID is obtained from an authorization result.</p> </li> <li> <p><code>get_logs_by_request_id_and_tag(request_id, tag)</code></p> <p>Returns the list of all logs with a given request ID and tag.</p> </li> </ul>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-interfaces/#context-data-api","title":"Context Data API","text":"<p>The Context Data API allows you to push external data into the Cedarling evaluation context, making it available in Cedar policies through the <code>context.data</code> namespace. This enables dynamic, runtime-based authorization decisions without modifying policies.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-interfaces/#push-data","title":"Push Data","text":"<ul> <li><code>push_data_ctx(key, value, ttl_secs)</code></li> </ul> <p>Pushes a value into the data store with an optional TTL (Time To Live).</p> <ul> <li><code>key</code>: The key for the data entry (string)</li> <li><code>value</code>: The value to store (any JSON-serializable/Cedar value: object, array, string, number, boolean, or null)</li> <li><code>ttl_secs</code>: Optional TTL in seconds. If not provided, uses the default TTL from configuration.</li> </ul> <p>Returns: <code>None</code> on success (or a boolean success flag, depending on the binding).</p> <p>Errors: The method may raise the following errors:   - <code>InvalidKey</code>: When the key is empty   - <code>StorageLimitExceeded</code>: When the configured storage capacity (<code>max_entries</code>) is exceeded   - <code>ValueTooLarge</code>: When the entry size (including metadata) exceeds <code>max_entry_size</code>   - <code>TTLExceeded</code>: When the requested TTL exceeds the configured <code>max_ttl</code> limit</p> <p>If the key already exists, the value will be replaced.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-interfaces/#get-data","title":"Get Data","text":"<ul> <li><code>get_data_ctx(key)</code></li> </ul> <p>Retrieves a value from the data store by key.</p> <ul> <li><code>key</code>: The key to retrieve (string)</li> </ul> <p>Returns the value if found, or <code>None</code>/<code>null</code> if the key doesn't exist or the entry has expired.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-interfaces/#get-data-entry","title":"Get Data Entry","text":"<ul> <li><code>get_data_entry_ctx(key)</code></li> </ul> <p>Retrieves a data entry with full metadata by key.</p> <ul> <li><code>key</code>: The key to retrieve (string)</li> </ul> <p>Returns a <code>DataEntry</code> object containing:   - <code>key</code>: The entry key   - <code>value</code>: The stored value   - <code>data_type</code>: The inferred Cedar type (String, Long, Bool, Set, Record, Entity, Ip, Decimal, DateTime, Duration)   - <code>created_at</code>: Timestamp when the entry was created (RFC 3339 format)   - <code>expires_at</code>: Timestamp when the entry expires (RFC 3339 format, or null if no TTL)   - <code>access_count</code>: Number of times this entry has been accessed</p>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-interfaces/#remove-data","title":"Remove Data","text":"<ul> <li><code>remove_data_ctx(key)</code></li> </ul> <p>Removes a value from the data store by key.</p> <ul> <li><code>key</code>: The key to remove (string)</li> </ul> <p>Returns <code>true</code> if the key existed and was removed, <code>false</code> otherwise.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-interfaces/#clear-data","title":"Clear Data","text":"<ul> <li><code>clear_data_ctx()</code></li> </ul> <p>Removes all entries from the data store.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-interfaces/#list-data","title":"List Data","text":"<ul> <li><code>list_data_ctx()</code></li> </ul> <p>Returns a list of all entries with their metadata.</p> <p>Returns an array of <code>DataEntry</code> objects containing key, value, type, and timing metadata.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-interfaces/#get-statistics","title":"Get Statistics","text":"<ul> <li><code>get_stats_ctx()</code></li> </ul> <p>Returns statistics about the data store.</p> <p>Returns a <code>DataStoreStats</code> object containing:   - <code>entry_count</code>: Number of entries currently stored   - <code>max_entries</code>: Maximum number of entries allowed (0 = unlimited)   - <code>max_entry_size</code>: Maximum size per entry in bytes (0 = unlimited)   - <code>metrics_enabled</code>: Whether metrics tracking is enabled   - <code>total_size_bytes</code>: Total size of all entries in bytes   - <code>avg_entry_size_bytes</code>: Average size per entry in bytes   - <code>capacity_usage_percent</code>: Percentage of capacity used (0.0-100.0)   - <code>memory_alert_threshold</code>: Memory usage threshold percentage (from config)   - <code>memory_alert_triggered</code>: Whether memory usage exceeds the alert threshold</p>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-interfaces/#using-data-in-cedar-policies","title":"Using Data in Cedar Policies","text":"<p>Data pushed via the Context Data API is automatically available in Cedar policies under the <code>context.data</code> namespace. The <code>context.data</code> values follow a three-tier resolution precedence:</p> <ol> <li>Inline request context values (highest precedence): Values provided directly in the authorization request context override all other sources.</li> <li>Pushed data (from the Context Data API): Data pushed via <code>push_data_ctx</code> overrides the default context.</li> <li>Default context (lowest precedence): Values from the default context configuration are used when not overridden by higher-precedence sources.</li> </ol> <p>When keys collide, higher-precedence values shadow lower-precedence ones. The <code>context.data</code> namespace combines values from all three sources, with inline values taking precedence over pushed data, and pushed data taking precedence over default context values.</p> <p>Example with safe key and attribute checks:</p> <pre><code>permit(\n    principal,\n    action == Action::\"read\",\n    resource\n) when {\n    context.data has \"user:123\" &amp;&amp;\n    context.data[\"user:123\"] has \"role\" &amp;&amp;\n    context.data[\"user:123\"].role.contains(\"admin\")\n};\n</code></pre> <p>The data is injected into the evaluation context before policy evaluation, allowing policies to make decisions based on dynamically pushed data without requiring policy changes.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","interfaces"]},{"location":"cedarling/reference/cedarling-jwt-mapping/","title":"Cedarling JWT Mapping","text":"","tags":["administration","lock","authorization / authz","Cedar","Cedarling","JWT"]},{"location":"cedarling/reference/cedarling-jwt-mapping/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","JWT"]},{"location":"cedarling/reference/cedarling-jwt-mapping/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","JWT"]},{"location":"cedarling/reference/cedarling-jwt-mapping/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","JWT"]},{"location":"cedarling/reference/cedarling-jwt-validation/","title":"Cedarling JWT Validation","text":"<p>Cedarling performs JWT (JSON Web Token) validation as part of its authorization workflow. This process ensures that only tokens from trusted issuers, with valid signatures and required claims, are used to make policy decisions. Optional revocation and trust-mode checks add further assurance and control.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","jwt","validation"]},{"location":"cedarling/reference/cedarling-jwt-validation/#overview","title":"Overview","text":"<p>Learn more about each part of the validation process:</p> <ul> <li>Signature Validation: Verifies the token's origin using trusted issuer keys.</li> <li>Content Validation: Ensures required claims like <code>exp</code> or <code>client_id</code> are present.</li> <li>ID Token Trust Mode: Validates relationships between different token types.</li> <li>JWT Status Validation: Checks if a token has been explicitly revoked.</li> <li>Local JWKS: Using local key stores for testing.</li> </ul> <p>Key Configuration Properties:</p> <ul> <li><code>CEDARLING_JWT_SIG_VALIDATION</code>: Controls JWT signature validation</li> <li><code>CEDARLING_JWT_STATUS_VALIDATION</code>: Controls JWT revocation checks  </li> <li><code>CEDARLING_ID_TOKEN_TRUST_MODE</code>: Controls ID token trust validation</li> <li><code>CEDARLING_LOCAL_JWKS</code>: Local key store for testing</li> </ul> <p>See the complete bootstrap properties reference for all available configuration options.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","jwt","validation"]},{"location":"cedarling/reference/cedarling-jwt-validation/#jwt-signature-validation","title":"JWT Signature Validation","text":"<p>At startup, Cedarling fetches public keys from trusted identity providers (IDPs) defined in the policy store. These keys are used to validate the signature of incoming JWTs.</p> <p>Running without trusted issuers</p> <p>When <code>CEDARLING_JWT_SIG_VALIDATION</code> is enabled, if no trusted issuers (or local JWKS) are configured, Cedarling still starts and logs a WARN indicating that signed authorization is unavailable. Unsigned requests (<code>authorize_unsigned</code>) continue to work, but any attempt to validate signed JWTs fails with <code>SignedAuthzUnavailable</code> until at least one trusted issuer or JWKS is configured. When <code>CEDARLING_JWT_SIG_VALIDATION</code> is disabled, this warning does not appear as signature validation is not required.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","jwt","validation"]},{"location":"cedarling/reference/cedarling-jwt-validation/#configuration","title":"Configuration","text":"<p>To enable this feature, set the <code>CEDARLING_JWT_SIG_VALIDATION</code> bootstrap property to <code>enabled</code>. For development and testing purposes, you can set this property to <code>disabled</code> and submit an unsigned JWT, such as one generated from jwt.io.</p> <p>On initialization, Cedarling will fetch the latest public keys from the issuers specified in the Policy Store and cache them. The system uses the JWT <code>iss</code> claim to select the appropriate keys for validation.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","jwt","validation"]},{"location":"cedarling/reference/cedarling-jwt-validation/#example-policy-store","title":"Example Policy Store","text":"<p>Cedarling only validates tokens issued by trusted issuers listed in the policy store. Tokens from issuers not listed in the policy store will be ignored and will not be used for entity creation.</p> <p>To allow an Access token like the one below to be used for authorization:</p> <pre><code>{\n  \"iss\": \"https://test.issuer.com\",\n  \"aud\": \"abc123\",\n  \"exp\": 1234567890\n}\n</code></pre> <p>You MUST define a trusted issuer in your policy store with a matching <code>openid_configuration_endpoint</code> (same host as the token's <code>iss</code> claim):</p> <pre><code>{\n  // ... other fields have been omitted for brevity\n  \"trusted_issuers\": {\n    \"my_trusted_issuer_id\": {\n      \"name\": \"my trusted issuer\",\n      \"description\": \"an IDP that i trust\",\n      \"openid_configuration_endpoint\": \"https://test.issuer.com/.well-known/openid-configuration\",\n      \"token_metadata\": { \n        \"access_token\": { \n          \"entity_type_name\": \"Jans::Access_token\",\n          \"token_id\": \"jti\",\n          \"workload_id\": \"client_id\",\n          \"required_claims\": [\"exp\", \"client_id\"]\n        }\n      }\n    }\n  }\n}\n</code></pre> <p>Additionally, only tokens explicitly named in the <code>token_metadata</code> section will be validated. All other tokens will be ignored.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","jwt","validation"]},{"location":"cedarling/reference/cedarling-jwt-validation/#validation-requirements","title":"Validation Requirements","text":"<p>In summary, for a token to be validated by Cedarling, two conditions must be met:</p> <ol> <li>The <code>iss</code> (Issuer) claim must match the host of an <code>openid_configuration_endpoint</code> in the policy store.</li> <li>The token must be provided under a token name defined in the corresponding <code>token_metadata</code></li> </ol> <pre><code>// Example authorize call\ncedarling.authorize({\n  \"tokens\": {\n    \"access_token\": \"&lt;access_token&gt;\", // will be validated and used for entity creation\n    \"id_token\": \"&lt;id_token&gt;\",         // will be ignored unless defined in token_metadata\n  },\n  // ...\n})\n</code></pre>","tags":["administration","authorization / authz","Cedar","Cedarling","jwt","validation"]},{"location":"cedarling/reference/cedarling-jwt-validation/#jwt-content-validation","title":"JWT Content Validation","text":"<p>Cedarling also supports validating the contents of a JWT by enforcing the presence of required claims. These requirements are defined in the <code>token_metadata</code> section of the policy store.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","jwt","validation"]},{"location":"cedarling/reference/cedarling-jwt-validation/#required-claims","title":"Required Claims","text":"<p>If timestamps are provided in the context, Cedarling always verifies:</p> <ul> <li><code>exp</code> (expiration)</li> <li><code>nbf</code> (not before)</li> </ul>","tags":["administration","authorization / authz","Cedar","Cedarling","jwt","validation"]},{"location":"cedarling/reference/cedarling-jwt-validation/#custom-required-claims","title":"Custom Required Claims","text":"<p>You can specify additional required claims in your token metadata configuration:</p> <pre><code>{\n  // ... other fields have been omitted for brevity\n  \"trusted_issuers\": {\n    \"my_trusted_issuer_id\": {\n      \"name\": \"my trusted issuer\",\n      \"description\": \"an IDP that i trust\",\n      \"openid_configuration_endpoint\": \"https://test.issuer.com/.well-known/openid-configuration\",\n      \"token_metadata\": { \n        \"access_token\": {\n          \"entity_type_name\": \"Jans::Access_token\",\n          \"required_claims\": [\"exp\", \"client_id\"]\n        }\n      }\n    }\n  }\n}\n</code></pre> <p>The above configuration means that any <code>access_token</code> must contain both the <code>exp</code> and <code>client_id</code> claims, or it will be rejected. Additionally, registered claims like the <code>exp</code> will also be validated according to RFC 7519 standards.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","jwt","validation"]},{"location":"cedarling/reference/cedarling-jwt-validation/#id-token-trust-mode","title":"ID Token Trust Mode","text":"<p>Cedarling supports an optional strict trust mode for validating relationships between different token types\u2014primarily ID tokens, Access tokens, and Userinfo tokens.</p> <p>This behavior is controlled via the <code>CEDARLING_ID_TOKEN_TRUST_MODE</code> bootstrap property.</p> <p>Implementation Status: Currently, only <code>strict</code> and <code>never</code> modes are implemented. Additional modes (<code>always</code>, <code>ifpresent</code>) are defined in the enum but not yet supported in the validation logic.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","jwt","validation"]},{"location":"cedarling/reference/cedarling-jwt-validation/#strict-mode","title":"<code>strict</code> Mode","text":"<p>If <code>CEDARLING_ID_TOKEN_TRUST_MODE</code> is set to <code>strict</code>, Cedarling will enforce the following:</p> <ol> <li>The <code>id_token</code>'s <code>aud</code> (Audience) must match the <code>access_token</code>'s <code>client_id</code>;</li> <li>If a <code>userinfo_token</code> is also provided:</li> <li>Its <code>sub</code> (Subject) must match that of the <code>id_token</code></li> <li>Its <code>aud</code> must also match the <code>access_token</code>'s <code>client_id</code>.</li> </ol> <p>These additional checks add another layer of identity assurance across tokens.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","jwt","validation"]},{"location":"cedarling/reference/cedarling-jwt-validation/#never-mode","title":"<code>never</code> Mode","text":"<p>Setting the validation level to <code>never</code> will not check for the conditions outlined in <code>strict</code> Mode.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","jwt","validation"]},{"location":"cedarling/reference/cedarling-jwt-validation/#jwt-status-validation","title":"JWT Status Validation","text":"<p>Cedarling optionally supports JWT revocation checks by validating the status bit of a \"Status Token\" JWT, as proposed in the OAuth Status Lists draft.</p> <p>This feature is toggled with the <code>CEDARLING_JWT_STATUS_VALIDATION</code> property.</p> <p>\u2139\ufe0f Use Case</p> <p>Enforcing token revocation can help mitigate account takeover risks by allowing for near-instant invalidation of compromised tokens.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","jwt","validation"]},{"location":"cedarling/reference/cedarling-jwt-validation/#jwt-validation-flow-diagram","title":"JWT Validation Flow Diagram","text":"<p>JWTs (JSON Web Tokens) contain authorization information that is used by the Cedarling to construct the Principal entities. In order to verify the authenticity of this information, the Cedarling can verify the integrity of the JWT by validating its signature and status(active, expired, or revoked). It does so by fetching the public keyset and the list of active tokens from the issuer of the JWT.</p> <p></p>","tags":["administration","authorization / authz","Cedar","Cedarling","jwt","validation"]},{"location":"cedarling/reference/cedarling-jwt-validation/#local-jwks","title":"Local JWKS","text":"<p>A local JWKS can be used by setting the <code>CEDARLING_LOCAL_JWKS</code> bootstrap property to a path to a local JSON file. When providing a local Json Web Key Store (JWKS), the file must follow the following schema:</p> <pre><code>{\n    \"trusted_issuer_id\": [ ... ],\n    \"another_trusted_issuer_id\": [ ... ]\n}\n</code></pre> <ul> <li>Where keys are <code>Trusted Issuer IDs</code> assigned to each key store</li> <li>and the values contains the JSON Web Keys as defined in RFC 7517.</li> <li>The <code>trusted_issuer_id</code> is used to tag a JWKS with a unique identifier and enables using multiple key stores.</li> </ul>","tags":["administration","authorization / authz","Cedar","Cedarling","jwt","validation"]},{"location":"cedarling/reference/cedarling-lock-server/","title":"Cedarling Lock Integration Setup Guide","text":"<p>For a Cedarling client to communicate with the Lock Server, it has to perform Dynamic Client Registration (DCR) with the Jans Auth Server.</p> <p>By default, clients cannot obtain the necessary scopes to interact with the lock server. Additional configuration is required on both the Auth Server and the client.</p> <p>This guide will walk you through the following setup processes:</p> <ul> <li>Auth Server Setup</li> <li>Client Setup</li> </ul>","tags":["cedarling","lock server"]},{"location":"cedarling/reference/cedarling-lock-server/#auth-server-setup","title":"Auth Server Setup","text":"","tags":["cedarling","lock server"]},{"location":"cedarling/reference/cedarling-lock-server/#1-creating-an-ssa-jwt","title":"1. Creating an SSA JWT","text":"<p>First, create a Software Statement Assertion (SSA) for your Cedarling client.</p> <p>The easiest way to do this is to use the Jans TUI:</p> <pre><code>jans tui\n</code></pre> <p>Navigate to:     <code>Auth Server</code> &gt; <code>SSA</code> &gt; <code>Add SSA</code></p> <p></p> <p>When creating the SSA, ensure you:</p> <ul> <li>Add the <code>Client Credentials</code> grant type</li> <li>Include the following software roles:<ul> <li><code>https://jans.io/oauth/lock/log.write</code></li> <li><code>https://jans.io/oauth/lock/health.write</code></li> <li><code>https://jans.io/oauth/lock/telemetry.write</code></li> </ul> </li> </ul> <p>After creation, export the SSA token and save it securely.</p>","tags":["cedarling","lock server"]},{"location":"cedarling/reference/cedarling-lock-server/#2-setting-up-the-interception-script","title":"2. Setting up the Interception Script","text":"<p>Next, configure an interception script to automatically add the required scopes when a Cedarling client registers.</p> <p>In your server, create a script file at <code>/opt/jans/jetty/jans-auth/custom/script/add_cedarling_scopes.py</code> with the following content:</p> <pre><code>from io.jans.model.custom.script.type.client import ClientRegistrationType\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.orm.util import ArrayHelper\nfrom io.jans.as.server.service import ScopeService\nfrom io.jans.as.model.util import JwtUtil\n\nclass ClientRegistration(ClientRegistrationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Cedarling Client registration. Initialization\"\n\n        if (not configurationAttributes.containsKey(\"jwks_uri\")):\n            print \"Cedarling Client registration. Initialization failed. Property jwks_uri is not specified\"\n            return False\n        else:\n            self.jwks_uri = configurationAttributes.get(\"jwks_uri\").getValue2()\n\n        if (not configurationAttributes.containsKey(\"scope_list\")):\n            print \"Cedarling Client registration. Initialization failed. Property scope_list is not specified\"\n            return False\n        else:\n            self.scope_list = configurationAttributes.get(\"scope_list\").getValue2().split(\" \")\n\n        if (not configurationAttributes.containsKey(\"trigger_scope\")):\n            print \"Cedarling Client registration. Initialization failed. Property trigger_scope is not specified\"\n            return False\n        else:\n            self.trigger_scope = configurationAttributes.get(\"trigger_scope\").getValue2()\n\n        # used to check if the scopes we're adding exists in the AS\n        self.scopeService = CdiUtil.bean(ScopeService)\n\n        print \"Cedarling Client registration. Initialized successfully\"\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print \"Cedarling Client registration. Destroy\"\n        print \"Cedarling Client registration. Destroyed successfully\"\n        return True   \n\n    def createClient(self, context):\n        print \"Cedarling Client registration. createClient\"\n\n        # Check if the request has an SSA\n        registerRequest = context.getRegisterRequest()\n        ssa = registerRequest.getSoftwareStatement()\n        if ssa == \"\":\n            print \"Cedarling Client registration. No SSA provided, defaulting\"\n            return True\n\n        # Check if the request has a trigger_scope (this is set as 'cedarling' by default) in the request.\n        # The trigger_scope is used to determine if we should add the scopes needed by Cedarling to the\n        # registering client.\n        # request_scopes = ArrayHelper.toString(registerRequest.getScope())\n        request_scopes = registerRequest.getScope()\n        if self.trigger_scope not in request_scopes:\n            print \"Cedarling Client registration. the scope '%s' was not included in the request, defaulting\" % self.trigger_scope\n            return True\n\n        # add cedarling scopes\n        client = context.getClient()\n        scopes = client.getScopes()\n        for scope in self.scope_list:\n            foundScope = self.scopeService.getScopeById(scope)\n            if foundScope is None:\n                print \"did not find scope '%s' in the AS\" % scope\n                return False\n            if len(scopes) == 0:\n                scopes = [foundScope.getDn()]\n            else:\n                scopes = ArrayHelper.addItemToStringArray(scopes, foundScope.getDn())\n\n        client.setScopes(scopes)\n\n        print \"Cedarling Client registration. added Cedarling scopes\"\n        return True\n\n    def updateClient(self, context):\n        print \"Cedarling Client registration. UpdateClient method\"\n        pass\n\n    def getApiVersion(self):\n        return 11\n\n    def getSoftwareStatementHmacSecret(self, context):\n        return \"\"\n\n    def getSoftwareStatementJwks(self, context):\n        print \"SSA Cedarling Client registration. getting jwks from '%s'\" %  self.jwks_uri\n        jwks = JwtUtil.getJSONWebKeys(self.jwks_uri)\n        if jwks is None:\n            print \"SSA Cedarling Client registration. jwks not found\"\n        return jwks.toString()\n\n    def modifyPutResponse(self, responseAsJsonObject, executionContext):\n        return False\n\n    def modifyReadResponse(self, responseAsJsonObject, executionContext):\n        return False\n\n    def modifyPostResponse(self, responseAsJsonObject, executionContext):\n        return False\n</code></pre> <ul> <li>you can also find a copy of this script in jans/jans-cedarling/lock-server-script/add_cedarling_scopes.py.</li> </ul> <p>Next, create a JSON file named <code>script_schema.json</code> with the following content:</p> <pre><code>{\n  \"name\": \"add_cedarling_scopes\",\n  \"aliases\": null,\n  \"description\": \"A DCR script that adds the required scopes by a client to interact with the lock server\",\n  \"scriptType\": \"client_registration\",\n  \"programmingLanguage\": \"python\",\n  \"moduleProperties\": [],\n  \"configurationProperties\": [\n        {\n                \"value1\": \"jwks_uri\",\n                \"value2\": \"https://demoexample.jans.io/jans-auth/restv1/jwks\",\n                \"hide\": false,\n                \"description\": \"JWKS URI used for the SSA validation\"\n        },\n        {\n                \"value1\": \"scope_list\",\n                \"value2\": \"https://jans.io/oauth/lock/log.write https://jans.io/oauth/lock/health.write https://jans.io/oauth/lock/telemetry.write\",\n                \"hide\": false,\n                \"description\": \"space-separated scopes that will be added by the script\"\n        },\n        {\n                \"value1\": \"trigger_scope\",\n                \"value2\": \"cedarling\",\n                \"hide\": false,\n                \"description\": \"the scope that must be present for the script to run\"\n        }\n  ],\n  \"level\": 100,\n  \"revision\": 0,\n  \"enabled\": true,\n  \"scriptError\": null,\n  \"modified\": false,\n  \"internal\": false,\n  \"locationType\": \"file\",\n  \"locationPath\": \"add_cedarling_scopes.py\"\n}\n</code></pre> <ul> <li>you can also find a copy of this schema in jans/jans-cedarling/lock-server-script/script_schema.json.</li> </ul> <p>Note:</p> <p>Do not change the field ordering; The Jans server expects a specific structure.</p> <p>Finally, register the script with the Auth Server:</p> <pre><code>jans cli --operation-id post-config-scripts --data ./script_schema.json\n</code></pre>","tags":["cedarling","lock server"]},{"location":"cedarling/reference/cedarling-lock-server/#3-testing-the-setup","title":"3. Testing the Setup","text":"<p>You can verify the setup by initializing a client registration with your SSA:</p> <pre><code>curl -kX POST https://demoexample.jans.io/jans-auth/restv1/register \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"token_endpoint_auth_method\": \"client_secret_basic\",\n    \"grant_types\": [\"client_credentials\"],\n    \"client_name\": \"cedarling-test\",\n    \"access_token_as_jwt\": true,\n    \"scope\": \"cedarling\",\n    \"software_statement\": \"&lt;YOUR_SSA_HERE&gt;\"\n}'\n</code></pre> <p>A successful response will contain the following scopes:</p> <pre><code>{\n  \"scope\": \"https://jans.io/oauth/lock/log.write https://jans.io/oauth/lock/health.write https://jans.io/oauth/lock/telemetry.write\"\n}\n</code></pre> <p>Note:</p> <p>If you want to learn more about configuring the example interception script, see the reference.</p>","tags":["cedarling","lock server"]},{"location":"cedarling/reference/cedarling-lock-server/#client-setup","title":"Client Setup","text":"<p>To enable Lock Server integration in the Cedarling client, configure the appropriate bootstrap properties.</p> <p>Here's a table of the available properties:</p> Property Description Allowed Values Default <code>CEDARLING_LOCK</code> Toggles the all the Lock Server integration features. <code>enabled</code>, <code>disabled</code> <code>disabled</code> <code>CEDARLING_LOCK_SERVER_CONFIGURATION_URI</code> URI to fetch Lock Server metadata (<code>.well-known/lock-master-configuration</code>). Required if <code>CEDARLING_LOCK</code> is <code>enabled</code>. String <code>\"\"</code> <code>CEDARLING_LOCK_DYNAMIC_CONFIGURATION</code> (WIP) Toggles listening for Server-Sent Events (SSE) config updates. <code>enabled</code>, <code>disabled</code> <code>disabled</code> <code>CEDARLING_LOCK_SSA_JWT</code> SSA JWT used for DCR. This is required if you followed the auth server setup. String <code>\"\"</code> <code>CEDARLING_LOCK_LOG_INTERVAL</code> Frequency (in seconds) of sending log messages to the Lock Server. <code>0</code> disables transmission. uint <code>0</code> <code>CEDARLING_LOCK_HEALTH_INTERVAL</code> (WIP) Frequency (in seconds) of sending health messages to the Lock Server. <code>0</code> disables transmission. uint <code>0</code> <code>CEDARLING_LOCK_TELEMETRY_INTERVAL</code> (WIP) Frequency (in seconds) of sending telemetry messages to the Lock Server. <code>0</code> disables transmission. uint <code>0</code> <code>CEDARLING_LOCK_LISTEN_SSE</code> (WIP) Toggles listening for updates from the Lock Server via SSE. <code>enabled</code>, <code>disabled</code> <code>disabled</code> <code>CEDARLING_LOCK_ACCEPT_INVALID_CERTS</code> Allows connection to servers with invalid certificates (for testing purposes only; not available for WASM builds). <code>enabled</code>, <code>disabled</code> <code>disabled</code>","tags":["cedarling","lock server"]},{"location":"cedarling/reference/cedarling-logs/","title":"Cedarling Logs","text":"","tags":["administration","lock","authorization / authz","Cedar","Cedarling","logging","audit"]},{"location":"cedarling/reference/cedarling-logs/#cedarling-audit-logs","title":"Cedarling Audit Logs","text":"<p>There are three different log records produced by the Cedarling:</p> <ul> <li><code>Decision</code> - The result and diagnostics of an authz decision</li> <li><code>System</code> - Startup, debug and other Cedarling messages not related to authz</li> <li><code>Metric</code>- Performance and usage data</li> </ul> <p>Logging execution model</p> <p>All platforms (native, WASM, and tests) perform JSON serialization and writing synchronously on the calling thread. Thread-safety for output streams is provided by Mutex and Send+Sync traits, not background-thread serialization. Regardless of the runtime, the log contents and retrieval APIs remain the same.</p> <p>The Cedarling has four logging options, which are configurable via the <code>CEDARLING_LOG_TYPE</code> bootstrap property:</p> <ul> <li><code>off</code> - no logging</li> <li><code>memory</code> - logs stored in Cedarling in-memory KV store, fetched by client via logging interface. This   is ideal for batching logs without impeding authz performance</li> <li><code>std_out</code> - write logs synchronously to std_out</li> <li><code>lock</code> - periodically POST logs to Jans Lock Server <code>/audit</code> endpoint for central archiving.</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","logging","audit"]},{"location":"cedarling/reference/cedarling-logs/#system-log-levels","title":"System Log Levels","text":"<p>Set with property <code>CEDARLING_LOG_LEVEL</code></p> <ul> <li><code>FATAL</code>: Indicates very severe error events that will likely lead the application to abort. These are the most critical issues.</li> <li><code>ERROR</code>: Designates error events that might still allow the application to continue running but indicate a significant problem.</li> <li><code>WARN</code>: Designates potentially harmful situations that should be addressed to prevent future issues.</li> <li><code>INFO</code>: Provides informational messages that highlight the progress of the application at a coarse-grained level.</li> <li><code>DEBUG</code>: Designates fine-grained informational events useful for debugging the application.</li> <li><code>TRACE</code>: Provides finer-grained informational events than DEBUG. It is often used for detailed tracing of program execution.</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","logging","audit"]},{"location":"cedarling/reference/cedarling-logs/#memory-log-interface","title":"Memory Log interface","text":"<p>This interface is used to interact with the memory log storage. It provides methods for getting logs and removing them from the storage. This interface is made available to other languages through bindings.</p> <p>Tags are used to filter logs. It can be <code>log_kind</code> and <code>log_level</code> values from log entry data.</p> <p>You can obtain the <code>request_id</code> from the result structure of the <code>authorize</code> method call.</p> <pre><code>/// Log Storage\n/// interface for getting log entries from the storage\npub trait LogStorage {\n    /// Return logs and remove them from the storage\n    fn pop_logs(&amp;self) -&gt; Vec&lt;serde_json::Value&gt;;\n\n    /// Get specific log entry\n    fn get_log_by_id(&amp;self, id: &amp;str) -&gt; Option&lt;serde_json::Value&gt;;\n\n    /// Returns a list of all log ids\n    fn get_log_ids(&amp;self) -&gt; Vec&lt;String&gt;;\n\n    /// Get logs by tag, like `log_kind` or `log level`.\n    /// Tag can be `log_kind`, `log_level`.\n    fn get_logs_by_tag(&amp;self, tag: &amp;str) -&gt; Vec&lt;serde_json::Value&gt;;\n\n    /// Get logs by request_id.\n    /// Return log entries that match the given request_id.\n    fn get_logs_by_request_id(&amp;self, request_id: &amp;str) -&gt; Vec&lt;serde_json::Value&gt;;\n\n    /// Get log by request_id and tag, like composite key `request_id` + `log_kind`.\n    /// Tag can be `log_kind`, `log_level`.\n    /// Return log entries that match the given request_id and tag.\n    fn get_logs_by_request_id_and_tag(&amp;self, request_id: &amp;str, tag: &amp;str)\n    -&gt; Vec&lt;serde_json::Value&gt;;\n}\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","logging","audit"]},{"location":"cedarling/reference/cedarling-logs/#jans-lock-server","title":"Jans Lock Server","text":"<p>In enterprise deployments, Janssen Lock Server collects Cedarling logs and can stream to a database or S3 bucket. The Cedarling decision logs provide compliance evidence of usage of the domain's externalized policies. The logs are also useful for forensic analysis to show everything the attacker attempted, both allowed and denied.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","logging","audit"]},{"location":"cedarling/reference/cedarling-logs/#sample-logs","title":"Sample logs","text":"<p>The JSON in this document is formatted for readability but is not prettified in the actual implementation.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","logging","audit"]},{"location":"cedarling/reference/cedarling-logs/#startup-message","title":"Startup Message","text":"<pre><code>{\n    \"request_id\": \"0193b8a8-efc0-77ce-bd90-4a62a2998462\",\n    \"timestamp\": \"2024-12-12T04:18:19.456Z\",\n    \"log_kind\": \"System\",\n    \"pdp_id\": \"d47e245e-beaa-4ea4-b899-b8184cd3eb7e\",\n    \"level\": \"DEBUG\",\n    \"msg\": \"configuration parsed successfully\"\n}\n{\n    \"request_id\": \"0193b8a8-efc1-7e42-9678-b2480268b91f\",\n    \"timestamp\": \"2024-12-12T04:18:19.457Z\",\n    \"log_kind\": \"System\",\n    \"pdp_id\": \"d47e245e-beaa-4ea4-b899-b8184cd3eb7e\",\n    \"level\": \"INFO\",\n    \"msg\": \"Cedarling Authz initialized successfully\",\n    \"application_id\": \"My App\",\n    \"cedar_lang_version\": \"4.1.0\",\n    \"cedar_sdk_version\": \"4.2.2\"\n}\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","logging","audit"]},{"location":"cedarling/reference/cedarling-logs/#decision-log","title":"Decision Log","text":"<p>Example of decision log.</p> <pre><code>{\n    \"request_id\": \"019394db-f52b-7b06-88b8-a288670a32c2\",\n    \"timestamp\": \"2024-12-05T05:27:43.403Z\",\n    \"log_type\": \"Decision\",\n    \"pdp_id\": \"9e189c4b-96ae-4818-8e7f-75a42186af15\",\n    \"policystore_id\": \"a1bf93115de86de760ee0bea1d529b521489e5a11747\",\n    \"policystore_version\": \"undefined\",\n    \"principal\": [\n        \"User\",\n        \"Workload\"\n    ],\n    \"User\": {\n        \"username\": \"admin@gluu.org\"\n    },\n    \"Workload\": {\n        \"org_id\": \"some_long_id\"\n    },\n    \"diagnostics\": {\n        \"reason\": [\n            {\n                \"id\": \"840da5d85403f35ea76519ed1a18a33989f855bf1cf8\",\n                \"description\": \"policy for user\"\n            }\n        ],\n        \"errors\": []\n    },\n    \"lock_client_id\": null,\n    \"action\": \"Jans::Action::\\\"Update\\\"\",\n    \"resource\": \"Jans::Issue::\\\"random_id\\\"\",\n    \"decision\": \"ALLOW\",\n    \"tokens\": {\n        \"id_token\": {\n            \"jti\": \"id_tkn_jti\"\n        },\n        \"Userinfo\": {\n            \"jti\": \"usrinfo_tkn_jti\"\n        },\n        \"access\": {\n            \"jti\": \"access_tkn_jti\"\n        }\n    },\n    \"decision_time_micro_sec\": 3\n}\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","logging","audit"]},{"location":"cedarling/reference/cedarling-logs/#field-definitions","title":"Field Definitions","text":"<ul> <li><code>request_id</code>: unique identifier for the decision request</li> <li><code>timestamp</code>: Derived if possible from the system or context--may be empty in cases where WASM can't access the system clock, and the time wasn't sent in the context.</li> <li><code>pdp_id</code>: unique identifier for the Cedarling</li> <li><code>policystore_id</code>: What policystore this Cedarling instance is using</li> <li><code>policystore_version</code>: What version of the policystore the Cedarling is using</li> <li><code>principal</code>: <code>User</code> | <code>Workload</code></li> <li><code>User</code>: A list of claims, specified by the <code>CEDARLING_DECISION_LOG_USER_CLAIMS</code> property, that must be present in the Cedar User entity</li> <li><code>Workload</code>:  A list of claims, specified by the <code>CEDARLING_DECISION_LOG_WORKLOAD_CLAIMS</code> property, that must be present in the Cedar Workload entity</li> <li><code>lock_client_id</code>: If this Cedarling has registered with a Lock Server, what is the client_id it received</li> <li><code>action</code>: From the request</li> <li><code>resource</code>: From the Request</li> <li><code>decision</code>: <code>ALLOW</code> or <code>DENY</code></li> <li><code>tokens</code>: Dictionary with the token type and claims which should be included in the log</li> <li><code>decision_time_micro_sec</code>: how long the decision took</li> </ul> <p>Whenever a request ends with a <code>DENY</code> and Cedar diagnostics contain errors, Cedarling also emits a separate <code>ERROR</code>-level Decision log that summarizes those diagnostics. This makes policy failures immediately visible even if the full debug log is filtered out.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","logging","audit"]},{"location":"cedarling/reference/cedarling-logs/#debug-log-sample","title":"Debug Log Sample","text":"<p>The result of the authorization is quite extensive because we log all <code>cedar-policy</code> entity information for forensic analysis. We cannot truncate the data, as it may contain critical information.</p> <pre><code>{\n    \"id\": \"01937015-4649-7aad-8df8-4976e4bd8565\",\n    \"time\": 1732752262,\n    \"log_type\": \"Decision\",\n    \"level\": \"DEBUG\",\n    \"pdp_id\": \"75f0dc93-0a90-4076-95fa-dc16d3f00375\",\n    \"msg\": \"Result of authorize.\",\n    \"application_id\": \"TestApp\",\n    \"action\": \"Jans::Action::\\\"Read\\\"\",\n    \"resource\": \"Jans::Application::\\\"some_id\\\"\",\n    \"context\": {\n        \"user_agent\": \"Linux\",\n        \"operating_system\": \"Linux\",\n        \"network_type\": \"Local\",\n        \"network\": \"127.0.0.1\",\n        \"geolocation\": [\n            \"America\"\n        ],\n        \"fraud_indicators\": [\n            \"Allowed\"\n        ],\n        \"device_health\": [\n            \"Healthy\"\n        ],\n        \"current_time\": 1732752262\n    },\n    \"entities\": [\n        {\n            \"uid\": {\n                \"type\": \"Jans::User\",\n                \"id\": \"qzxn1Scrb9lWtGxVedMCky-Ql_ILspZaQA6fyuYktw0\"\n            },\n            \"attrs\": {\n                \"sub\": \"qzxn1Scrb9lWtGxVedMCky-Ql_ILspZaQA6fyuYktw0\",\n                \"role\": [\n                    \"CasaAdmin\"\n                ],\n                \"email\": {\n                    \"domain\": \"jans.test\",\n                    \"uid\": \"admin\"\n                }\n            },\n            \"parents\": [\n                {\n                    \"type\": \"Jans::Role\",\n                    \"id\": \"CasaAdmin\"\n                }\n            ]\n        },\n        {\n            \"uid\": {\n                \"type\": \"Jans::id_token\",\n                \"id\": \"ijLZO1ooRyWrgIn7cIdNyA\"\n            },\n            \"attrs\": {\n                \"sub\": \"qzxn1Scrb9lWtGxVedMCky-Ql_ILspZaQA6fyuYktw0\",\n                \"acr\": \"simple_password_auth\",\n                \"exp\": 1731956630,\n                \"jti\": \"ijLZO1ooRyWrgIn7cIdNyA\",\n                \"amr\": [],\n                \"aud\": \"d7f71bea-c38d-4caf-a1ba-e43c74a11a62\",\n                \"iss\": {\n                    \"__entity\": {\n                        \"type\": \"Jans::TrustedIssuer\",\n                        \"id\": \"https://account.gluu.org\"\n                    }\n                },\n                \"iat\": 1731953030\n            },\n            \"parents\": []\n        },\n\n        ...\n\n        {\n            \"uid\": {\n                \"type\": \"Jans::Action\",\n                \"id\": \"Tag\"\n            },\n            \"attrs\": {},\n            \"parents\": []\n        }\n    ],\n    \"person_principal\": \"Jans::User::\\\"qzxn1Scrb9lWtGxVedMCky-Ql_ILspZaQA6fyuYktw0\\\"\",\n    \"person_diagnostics\": {\n        \"reason\": [\n            {\n                \"id\": \"840da5d85403f35ea76519ed1a18a33989f855bf1cf8\",\n                \"description\": \"simple policy example for principal user\"\n            }\n        ],\n        \"errors\": []\n    },\n    \"person_decision\": \"ALLOW\",\n    \"workload_principal\": \"Jans::Workload::\\\"d7f71bea-c38d-4caf-a1ba-e43c74a11a62\\\"\",\n    \"workload_diagnostics\": {\n        \"reason\": [\n            {\n                \"id\": \"444da5d85403f35ea76519ed1a18a33989f855bf1cf8\",\n                \"description\": \"simple policy example for principal workload\"\n            }\n        ],\n        \"errors\": []\n    },\n    \"workload_decision\": \"ALLOW\",\n    \"authorized\": true\n}\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","logging","audit"]},{"location":"cedarling/reference/cedarling-multi-issuer/","title":"Multi-Issuer Authorization Guide","text":"<p>This guide provides a comprehensive overview of Cedarling's multi-issuer authorization feature, including concepts, implementation patterns, and real-world use cases.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#overview","title":"Overview","text":"<p>Multi-issuer authorization (<code>authorize_multi_issuer</code>) enables applications to make authorization decisions based on multiple JWT tokens from different identity providers in a single request. Unlike traditional authorization that creates User and Workload principals, multi-issuer authorization evaluates policies based purely on token entities themselves.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#key-benefits","title":"Key Benefits","text":"<ul> <li>Federation Support: Native support for tokens from multiple identity providers</li> <li>Capability-Based Authorization: Make decisions based on capabilities asserted by different issuers</li> <li>Zero Trust Architecture: Each token represents verification from a different trust boundary</li> <li>Flexible Token Types: Support for custom token types beyond standard OAuth/OIDC tokens</li> <li>API Gateway Ready: Ideal for API gateways validating tokens from various upstream services</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#how-it-works","title":"How It Works","text":"","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#1-request-structure","title":"1. Request Structure","text":"<p>A multi-issuer authorization request consists of:</p> <pre><code>{\n  \"tokens\": [\n    {\n      \"mapping\": \"Jans::Access_Token\",\n      \"payload\": \"eyJhbGciOiJIUzI1NiIs...\"\n    },\n    {\n      \"mapping\": \"Jans::Id_Token\",\n      \"payload\": \"eyJhbGciOiJFZERTQSIs...\"\n    },\n    {\n      \"mapping\": \"Acme::DolphinToken\",\n      \"payload\": \"ey1b6cfMef21084633a7...\"\n    }\n  ],\n  \"action\": \"Jans::Action::\\\"Read\\\"\",\n  \"resource\": {\n    \"cedar_entity_mapping\": {\n      \"entity_type\": \"Jans::Document\",\n      \"id\": \"doc-123\"\n    },\n    \"owner\": \"alice@example.com\",\n    \"classification\": \"confidential\"\n  },\n  \"context\": {\n    \"ip_address\": \"54.9.21.201\",\n    \"time\": 1730000000\n  }\n}\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#2-token-processing-pipeline","title":"2. Token Processing Pipeline","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1. Token Input                                          \u2502\n\u2502    Array of tokens with explicit type mappings         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 2. Token Validation                                     \u2502\n\u2502    - Signature verification                             \u2502\n\u2502    - Time-based validation (exp, nbf, iat)             \u2502\n\u2502    - Status validation (revocation check)               \u2502\n\u2502    - Trusted issuer verification                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 3. Entity Creation                                      \u2502\n\u2502    - Create Cedar entity for each valid token          \u2502\n\u2502    - Store token metadata (type, jti, issuer, exp)     \u2502\n\u2502    - Store JWT claims as entity tags (Set&lt;String&gt;)     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 4. Token Collection Assembly                            \u2502\n\u2502    - Organize tokens with predictable naming           \u2502\n\u2502    - Pattern: {issuer_name}_{token_type}               \u2502\n\u2502    - Example: acme_access_token, google_id_token       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                     \u2502\n                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 5. Policy Evaluation                                    \u2502\n\u2502    - Evaluate Cedar policies without principal         \u2502\n\u2502    - Policies reference context.tokens.{name}          \u2502\n\u2502    - Return authorization decision                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#3-token-entity-structure","title":"3. Token Entity Structure","text":"<p>Each validated token becomes a Cedar entity:</p> <pre><code>entity Token = {\n  \"token_type\": String,        // e.g., \"Jans::Access_Token\"\n  \"jti\": String,               // Token ID\n  \"iss\"?: Jans::TrustedIssuer,  // JWT iss claim\n  \"exp\": Long,                 // Expiration timestamp\n  \"validated_at\": Long         // Validation timestamp\n} tags Set&lt;String&gt;;\n</code></pre> <p>All JWT claims are stored as tags and accessed using Cedar's tag operations:</p> <pre><code>context.tokens.acme_access_token.hasTag(\"scope\")\ncontext.tokens.acme_access_token.getTag(\"scope\").contains(\"read:profile\")\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#4-token-collection-naming","title":"4. Token Collection Naming","text":"<p>Tokens are organized in the context using a deterministic naming algorithm:</p> <p>Pattern: <code>{issuer_name}_{token_type}</code></p> <p>Issuer Name Resolution:</p> <ol> <li>Look up issuer in trusted issuer metadata</li> <li>Use the <code>name</code> field from configuration</li> <li>If no <code>name</code> field, extract hostname from JWT <code>iss</code> claim</li> <li>Convert to lowercase, replace special characters with underscores</li> </ol> <p>Token Type Resolution:</p> <ol> <li>Extract from <code>mapping</code> field (e.g., \"Jans::Access_Token\")</li> <li>Split by namespace separator (\"::\"), and use the last segment.</li> <li>Convert to lowercase, preserve underscores</li> </ol> <p>Examples:</p> JWT Issuer Trusted Issuer Name Token Mapping Result <code>https://idp.acme.com/auth</code> <code>\"Acme\"</code> <code>Jans::Access_Token</code> <code>acme_access_token</code> <code>https://accounts.google.com</code> <code>\"Google\"</code> <code>Jans::Id_Token</code> <code>google_id_token</code> <code>https://idp.dolphin.sea/auth</code> <code>\"Dolphin\"</code> <code>Acme::DolphinToken</code> <code>dolphin_acme_dolphin_token</code>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#use-cases","title":"Use Cases","text":"","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#use-case-1-federation-scenario","title":"Use Case 1: Federation Scenario","text":"<p>Scenario: A collaborative platform accepts tokens from multiple corporate identity providers.</p> <p>Requirements:</p> <ul> <li>Users can authenticate with their corporate IDP</li> <li>Authorization requires valid token from user's organization</li> <li>Different organizations have different permission structures</li> </ul> <p>Implementation:</p> <pre><code># User presents tokens from their corporate IDP and the platform IDP\ntokens = [\n    TokenInput(\n        mapping=\"Jans::Access_Token\",\n        payload=\"&lt;acme_corp_token&gt;\"  # From Acme Corp IDP\n    ),\n    TokenInput(\n        mapping=\"Platform::Access_Token\",\n        payload=\"&lt;platform_token&gt;\"  # From platform IDP\n    )\n]\n\nrequest = AuthorizeMultiIssuerRequest(\n    tokens=tokens,\n    action='Platform::Action::\"ShareDocument\"',\n    resource=document,\n    context={\"ip_address\": \"192.168.1.100\"}\n)\n\nresult = cedarling.authorize_multi_issuer(request)\n</code></pre> <p>Policy:</p> <pre><code>// Allow sharing if user has valid tokens from both IDPs\npermit(\n  principal,\n  action == Platform::Action::\"ShareDocument\",\n  resource in Platform::Document\n) when {\n  // Verify corporate IDP token with employee status\n  context has tokens.acme_corp_access_token &amp;&amp;\n  context.tokens.acme_corp_access_token.hasTag(\"employee_status\") &amp;&amp;\n  context.tokens.acme_corp_access_token.getTag(\"employee_status\").contains(\"active\") &amp;&amp;\n\n  // Verify platform token with sharing scope\n  context has tokens.platform_access_token &amp;&amp;\n  context.tokens.platform_access_token.hasTag(\"scope\") &amp;&amp;\n  context.tokens.platform_access_token.getTag(\"scope\").contains(\"share:documents\")\n};\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#use-case-2-api-gateway-with-multiple-upstream-services","title":"Use Case 2: API Gateway with Multiple Upstream Services","text":"<p>Scenario: An API gateway needs to validate tokens from various upstream microservices.</p> <p>Requirements:</p> <ul> <li>Each microservice issues its own JWT tokens</li> <li>Gateway validates all tokens before forwarding requests</li> <li>Authorization based on combination of service capabilities</li> </ul> <p>Implementation:</p> <pre><code>// Gateway receives tokens from multiple services\nlet tokens = [\n  {\n    mapping: \"AuthService::Access_Token\",\n    payload: authServiceToken,\n  },\n  {\n    mapping: \"PaymentService::Access_Token\",\n    payload: paymentServiceToken,\n  },\n  {\n    mapping: \"UserService::Access_Token\",\n    payload: userServiceToken,\n  },\n];\n\nlet request = {\n  tokens: tokens,\n  action: 'Gateway::Action::\"ProcessPayment\"',\n  resource: {\n    cedar_entity_mapping: {\n      entity_type: \"Gateway::Transaction\",\n      id: \"txn-12345\",\n    },\n    amount: 1000.0,\n    currency: \"USD\",\n  },\n  context: {\n    ip_address: request.ip,\n    user_agent: request.headers[\"user-agent\"],\n  },\n};\n\nlet result = await cedarling.authorize_multi_issuer(request);\n</code></pre> <p>Policy:</p> <pre><code>// Require tokens from all three services for payment processing\npermit(\n  principal,\n  action == Gateway::Action::\"ProcessPayment\",\n  resource in Gateway::Transaction\n) when {\n  // Auth service token with authenticated user\n  context has tokens.auth_service_access_token &amp;&amp;\n  context.tokens.auth_service_access_token.hasTag(\"authenticated\") &amp;&amp;\n\n  // Payment service token with sufficient balance\n  context has tokens.payment_service_access_token &amp;&amp;\n  context.tokens.payment_service_access_token.hasTag(\"balance_verified\") &amp;&amp;\n\n  // User service token with kyc_verified status\n  context has tokens.user_service_access_token &amp;&amp;\n  context.tokens.user_service_access_token.hasTag(\"kyc_verified\") &amp;&amp;\n  context.tokens.user_service_access_token.getTag(\"kyc_verified\").contains(\"true\")\n};\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#use-case-3-multi-organization-voting-system","title":"Use Case 3: Multi-Organization Voting System","text":"<p>Scenario: A trade association requires tokens from both the association and member organizations for voting.</p> <p>Requirements:</p> <ul> <li>User must have valid membership token from trade association</li> <li>User must have valid employee token from their organization</li> <li>Organization must be a corporate member</li> <li>User must be designated as voting representative</li> </ul> <p>Implementation:</p> <pre><code>tokens := []cedarling_go.TokenInput{\n    {\n        Mapping: \"TradeAssociation::MemberToken\",\n        Payload: memberToken,\n    },\n    {\n        Mapping: \"Jans::Access_Token\",\n        Payload: employeeToken,\n    },\n}\n\nrequest := cedarling_go.AuthorizeMultiIssuerRequest{\n    Tokens: tokens,\n    Action: `TradeAssociation::Action::\"Vote\"`,\n    Resource: cedarling_go.EntityData{\n        CedarMapping: cedarling_go.CedarMapping{\n            EntityType: \"TradeAssociation::Election\",\n            ID:         \"election-2025\",\n        },\n        Payload: map[string]any{\n            \"election_type\": \"board\",\n            \"year\":          2025,\n        },\n    },\n}\n\nresult, err := instance.AuthorizeMultiIssuer(request)\n</code></pre> <p>Policy:</p> <pre><code>permit(\n  principal,\n  action == TradeAssociation::Action::\"Vote\",\n  resource in TradeAssociation::Election\n) when {\n  // Require corporate membership token\n  context has tokens.trade_association_member_token &amp;&amp;\n  context.tokens.trade_association_member_token.hasTag(\"member_status\") &amp;&amp;\n  context.tokens.trade_association_member_token.getTag(\"member_status\").contains(\"Corporate Member\") &amp;&amp;\n\n  // Require employee token with voting representative designation\n  context has tokens.company_access_token &amp;&amp;\n  context.tokens.company_access_token.hasTag(\"role\") &amp;&amp;\n  context.tokens.company_access_token.getTag(\"role\").contains(\"voting_representative\")\n};\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#use-case-4-healthcare-hipaa-compliance","title":"Use Case 4: Healthcare HIPAA Compliance","text":"<p>Scenario: Healthcare system requires multiple consent tokens for accessing medical records.</p> <p>Requirements:</p> <ul> <li>Patient consent token required</li> <li>Provider credentials token required</li> <li>Facility authorization token required</li> <li>Purpose of use must match all tokens</li> </ul> <p>Implementation:</p> <pre><code>tokens = [\n    TokenInput(\n        mapping=\"Healthcare::PatientConsent\",\n        payload=patient_consent_token\n    ),\n    TokenInput(\n        mapping=\"Healthcare::ProviderCredentials\",\n        payload=provider_credentials_token\n    ),\n    TokenInput(\n        mapping=\"Healthcare::FacilityAuth\",\n        payload=facility_token\n    )\n]\n\nrequest = AuthorizeMultiIssuerRequest(\n    tokens=tokens,\n    action='Healthcare::Action::\"AccessMedicalRecord\"',\n    resource=medical_record,\n    context={\n        \"purpose_of_use\": \"TREATMENT\",\n        \"emergency\": False\n    }\n)\n</code></pre> <p>Policy:</p> <pre><code>permit(\n  principal,\n  action == Healthcare::Action::\"AccessMedicalRecord\",\n  resource in Healthcare::MedicalRecord\n) when {\n  // Patient consent token\n  context has tokens.patient_consent &amp;&amp;\n  context.tokens.patient_consent.hasTag(\"consent_status\") &amp;&amp;\n  context.tokens.patient_consent.getTag(\"consent_status\").contains(\"granted\") &amp;&amp;\n  context.tokens.patient_consent.hasTag(\"expiry\") &amp;&amp;\n  context.tokens.patient_consent.getTag(\"expiry\").contains(\"2025-12-31\") &amp;&amp;\n\n  // Provider credentials token\n  context has tokens.provider_credentials &amp;&amp;\n  context.tokens.provider_credentials.hasTag(\"license_status\") &amp;&amp;\n  context.tokens.provider_credentials.getTag(\"license_status\").contains(\"active\") &amp;&amp;\n  context.tokens.provider_credentials.hasTag(\"specialty\") &amp;&amp;\n\n  // Facility authorization token\n  context has tokens.facility_auth &amp;&amp;\n  context.tokens.facility_auth.hasTag(\"facility_type\") &amp;&amp;\n  context.tokens.facility_auth.getTag(\"facility_type\").contains(\"hospital\") &amp;&amp;\n\n  // Purpose of use alignment\n  context has purpose_of_use &amp;&amp;\n  context.purpose_of_use == \"TREATMENT\"\n};\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#use-case-5-zero-trust-network-with-custom-token-types","title":"Use Case 5: Zero Trust Network with Custom Token Types","text":"<p>Scenario: A zero-trust architecture uses custom tokens for device attestation, network verification, and user authentication.</p> <p>Requirements:</p> <ul> <li>Device attestation token from hardware TPM</li> <li>Network security token from network controller</li> <li>User authentication token from IDP</li> <li>All three required for accessing sensitive resources</li> </ul> <p>Implementation:</p> <pre><code>let tokens = [\n  {\n    mapping: \"Security::DeviceAttestation\",\n    payload: deviceAttestationToken, // From device TPM\n  },\n  {\n    mapping: \"Security::NetworkToken\",\n    payload: networkToken, // From network controller\n  },\n  {\n    mapping: \"Jans::Access_Token\",\n    payload: userAccessToken, // From IDP\n  },\n];\n\nlet result = await cedarling.authorize_multi_issuer({\n  tokens: tokens,\n  action: 'Security::Action::\"AccessClassified\"',\n  resource: {\n    cedar_entity_mapping: {\n      entity_type: \"Security::Document\",\n      id: \"classified-123\",\n    },\n    classification: \"SECRET\",\n    compartment: \"SPECIAL_ACCESS\",\n  },\n  context: {\n    location: \"secure_facility\",\n    time: Date.now(),\n  },\n});\n</code></pre> <p>Policy:</p> <pre><code>permit(\n  principal,\n  action == Security::Action::\"AccessClassified\",\n  resource in Security::Document\n) when {\n  // Device attestation with hardware-backed key\n  context has tokens.device_attestation &amp;&amp;\n  context.tokens.device_attestation.hasTag(\"tpm_verified\") &amp;&amp;\n  context.tokens.device_attestation.getTag(\"tpm_verified\").contains(\"true\") &amp;&amp;\n  context.tokens.device_attestation.hasTag(\"encryption_level\") &amp;&amp;\n  context.tokens.device_attestation.getTag(\"encryption_level\").contains(\"FIPS-140-2\") &amp;&amp;\n\n  // Network token from secure network\n  context has tokens.network_token &amp;&amp;\n  context.tokens.network_token.hasTag(\"network_type\") &amp;&amp;\n  context.tokens.network_token.getTag(\"network_type\").contains(\"CLASSIFIED\") &amp;&amp;\n  context.tokens.network_token.hasTag(\"segment\") &amp;&amp;\n  context.tokens.network_token.getTag(\"segment\").contains(\"HIGH_SIDE\") &amp;&amp;\n\n  // User access token with clearance\n  context has tokens.user_access_token &amp;&amp;\n  context.tokens.user_access_token.hasTag(\"clearance_level\") &amp;&amp;\n  context.tokens.user_access_token.getTag(\"clearance_level\").contains(\"SECRET\") &amp;&amp;\n\n  // Location verification\n  context has location &amp;&amp;\n  context.location == \"secure_facility\"\n};\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#configuration-guide","title":"Configuration Guide","text":"","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#schema-requirements","title":"Schema Requirements","text":"<p>IMPORTANT: Multi-issuer authorization requires specific Cedar schema modifications. Without these changes, authorization will fail with schema validation errors.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#required-schema-changes","title":"Required Schema Changes","text":"<p>Multi-issuer authorization creates token entities dynamically and places them in the Cedar context. Your schema must support:</p> <p>1. Token Entity Structure</p> <p>Token entities must have these required attributes:</p> <pre><code>namespace Jans{\n  entity Access_token = {\n    token_type?: String,        // Required for multi-issuer\n    jti?: String,               // Required for multi-issuer\n    iss?: Jans::TrustedIssuer,  // Required for multi-issuer\n    exp?: Long,                 // Required for multi-issuer\n    validated_at?: Long,        // Required for multi-issuer\n    // Other JWT claims as optional attributes\n    aud?: String,\n    iat?: Long,\n    scope?: Set&lt;String&gt;,\n    // ...\n  } tags Set&lt;String&gt;;         // Required for dynamic JWT claims\n\n  entity TrustedIssuer = {\n    issuer_entity_id: Url\n  };\n}\n</code></pre> <p>2. Context Structure</p> <p>The Context type must include a <code>tokens</code> field:</p> <pre><code>type Context = {\n  network?: String,\n  // ... other context fields\n  tokens?: TokensContext,   // Required for multi-issuer\n};\n\ntype TokensContext = {\n  total_token_count: Long,  // Required\n  // Individual token fields added dynamically\n};\n</code></pre> <p>3. Making Attributes Optional</p> <p>All token entity attributes (except the core multi-issuer fields) must be optional (<code>?</code>) to prevent schema validation errors. This is because multi-issuer tokens may not have all the claims that standard authorization tokens have.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#why-these-changes-are-needed","title":"Why These Changes Are Needed","text":"<ul> <li>Dynamic token entities: Multi-issuer authorization creates token entities on-the-fly without User/Workload principals</li> <li>Tag-based claims: JWT claims are stored as entity tags (<code>Set&lt;String&gt;</code> by default) for flexible access</li> <li>Context structure: Tokens are organized in <code>context.tokens.{issuer}_{token_type}</code> format</li> <li>Schema validation: Cedar validates entities against the schema; missing required fields cause errors</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#updating-core-schema","title":"Updating Core Schema","text":"<p>If you're using the default <code>cedarling_core.cedarschema</code> from Agama Lab, it has been updated to support multi-issuer authorization. If you have a custom schema, make sure to apply these changes.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#policy-store-configuration","title":"Policy Store Configuration","text":"<p>Configure trusted issuers with the <code>name</code> field for predictable token naming:</p> <pre><code>{\n  \"trusted_issuers\": {\n    \"acme_corp_issuer\": {\n      \"name\": \"AcmeCorp\",\n      \"description\": \"Acme Corporation Identity Provider\",\n      \"openid_configuration_endpoint\": \"https://idp.acme.com/.well-known/openid-configuration\",\n      \"token_metadata\": {\n        \"access_token\": {\n          \"entity_type_name\": \"AcmeCorp::Access_Token\",\n          \"token_id\": \"jti\"\n        }\n      }\n    },\n    \"google_issuer\": {\n      \"name\": \"Google\",\n      \"description\": \"Google Identity Provider\",\n      \"openid_configuration_endpoint\": \"https://accounts.google.com/.well-known/openid-configuration\",\n      \"token_metadata\": {\n        \"id_token\": {\n          \"entity_type_name\": \"Google::Id_Token\",\n          \"token_id\": \"jti\"\n        }\n      }\n    },\n    \"custom_service_issuer\": {\n      \"name\": \"CustomService\",\n      \"description\": \"Custom Service Provider\",\n      \"openid_configuration_endpoint\": \"https://service.example.com/.well-known/openid-configuration\",\n      \"token_metadata\": {\n        \"custom_token\": {\n          \"entity_type_name\": \"CustomService::ServiceToken\",\n          \"token_id\": \"jti\"\n        }\n      }\n    }\n  }\n}\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#cedar-schema-for-multi-issuer-tokens","title":"Cedar Schema for Multi-Issuer Tokens","text":"","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#core-token-schema-structure","title":"Core Token Schema Structure","text":"<p>Each token type (Access_Token, Id_Token, custom tokens) must follow this structure:</p> <pre><code>namespace Jans {\n  // Core token entity structure compatible with both standard and multi-issuer authorization\n  entity Access_token = {\n    // Required multi-issuer attributes\n    token_type?: String,        // Entity type name (e.g., \"Jans::Access_Token\")\n    jti?: String,               // JWT ID - unique token identifier\n    iss?: TrustedIssuer,        // Issuer entity reference (for standard authz)\n    exp?: Long,                 // Token expiration timestamp\n    validated_at?: Long,        // Timestamp when token was validated\n\n    // Optional JWT claims (make all optional for compatibility)\n    aud?: String,               // Audience\n    iat?: Long,                 // Issued at\n    scope?: Set&lt;String&gt;,        // OAuth scopes\n    client_id?: String,         // Client identifier\n    sub?: String,               // Subject\n    // Add other JWT claims as needed\n  } tags Set&lt;String&gt;;           // Tags store dynamic JWT claims\n\n  entity id_token = {\n    // Required multi-issuer attributes\n    token_type?: String,\n    jti?: String,\n    iss?: TrustedIssuer,\n    exp?: Long,\n    validated_at?: Long,\n\n    // Optional JWT claims\n    aud?: Set&lt;String&gt;,\n    iat?: Long,\n    sub?: String,\n    email?: email_address,\n    name?: String,\n    phone_number?: String,\n    role?: Set&lt;String&gt;,\n    acr?: String,\n    amr?: Set&lt;String&gt;,\n    // Add other JWT claims as needed\n  } tags Set&lt;String&gt;;\n\n  entity Userinfo_token = {\n    // Required multi-issuer attributes\n    token_type?: String,\n    jti?: String,\n    iss?: TrustedIssuer,\n    exp?: Long,\n    validated_at?: Long,\n\n    // Optional JWT claims\n    aud?: String,\n    iat?: Long,\n    sub?: String,\n    email?: email_address,\n    name?: String,\n    birthdate?: String,\n    phone_number?: String,\n    role?: Set&lt;String&gt;,\n    // Add other JWT claims as needed\n  } tags Set&lt;String&gt;;\n\n  entity TrustedIssuer = {\n    issuer_entity_id: Url\n  };\n}\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#custom-token-types","title":"Custom Token Types","text":"<p>For custom token types, follow the same pattern:</p> <pre><code>namespace Custom {\n  entity ServiceToken = {\n    // Required multi-issuer attributes\n    token_type?: String,\n    jti?: String,\n    iss?: Custom::TrustedIssuer,\n    exp?: Long,\n    validated_at?: Long,\n\n    // Custom token-specific attributes\n    service_id?: String,\n    permissions?: Set&lt;String&gt;,\n    service_tier?: String,\n  } tags Set&lt;String&gt;;\n\n  entity TrustedIssuer = {\n    issuer_entity_id: Url\n  };\n}\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#complete-context-schema","title":"Complete Context Schema","text":"<p>Define the Context type to include the tokens field:</p> <pre><code>type Context = {\n  // Standard context fields\n  network?: String,\n  network_type?: String,\n  user_agent?: String,\n  operating_system?: String,\n  device_health?: Set&lt;String&gt;,\n  current_time?: Long,\n  geolocation?: Set&lt;String&gt;,\n  fraud_indicators?: Set&lt;String&gt;,\n\n  // Multi-issuer tokens context (required)\n  tokens?: TokensContext,\n};\n\ntype TokensContext = {\n  total_token_count: Long,\n  // Individual token fields are added dynamically by Cedarling\n  // Pattern: {issuer_name}_{token_type} (e.g., acme_access_token)\n};\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#key-schema-principles","title":"Key Schema Principles","text":"<ol> <li>Optional Attributes: All token attributes must be optional (<code>?</code>) to support both standard and multi-issuer authorization</li> <li>Tags Declaration: All token entities must declare <code>tags Set&lt;String&gt;</code> for dynamic JWT claim storage</li> <li>Context Integration: The Context type must include an optional <code>tokens</code> field</li> <li>Consistency: Use the same attribute names across all token types (token_type, jti, issuer, exp, validated_at)</li> </ol>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#error-handling","title":"Error Handling","text":"","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#token-validation-failures","title":"Token Validation Failures","text":"<pre><code># Individual token validation failures are handled gracefully\ntokens = [\n    TokenInput(mapping=\"Jans::Access_Token\", payload=\"valid_token\"),\n    TokenInput(mapping=\"Jans::Id_Token\", payload=\"invalid_token\"),  # Will be ignored\n    TokenInput(mapping=\"Acme::CustomToken\", payload=\"valid_custom_token\")\n]\n\n# Authorization continues with valid tokens\n# Invalid tokens are logged but don't block processing\nresult = cedarling.authorize_multi_issuer(request)\n</code></pre> <p>However, if every token is invalid, Cedarling will raise an error. It is important that users always handle errors gracefully.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#non-deterministic-tokens","title":"Non-Deterministic Tokens","text":"<pre><code># ERROR: Multiple tokens of same type from same issuer\ntokens = [\n    TokenInput(mapping=\"Jans::Access_Token\", payload=\"token1\"),  # From Jans::Access_Token\n    TokenInput(mapping=\"Jans::Access_Token\", payload=\"token2\"),  # Also from Jans::Access_Token - ERROR!\n]\n\n# This non-deterministic.\n# Which token should policies reference?\n# Cedarling processes only the first item and writes log messages for all subsequent items that are skipped.\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#trusted-issuer-validation","title":"Trusted Issuer Validation","text":"<pre><code># Tokens from unknown issuers are rejected\ntokens = [\n    TokenInput(\n        mapping=\"Jans::Access_Token\",\n        payload=\"token_from_unknown_issuer\"  # ERROR if issuer not in trusted issuers\n    )\n]\n\n# Only tokens from issuers configured in policy store are accepted\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#best-practices","title":"Best Practices","text":"","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#1-use-descriptive-issuer-names","title":"1. Use Descriptive Issuer Names","text":"<p>Configure clear, predictable issuer names in your policy store:</p> <pre><code>{\n  \"name\": \"AcmeCorp\", // Good - clear and predictable\n  \"name\": \"Issuer1\" // Bad - unclear what this represents\n}\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#2-start-schema-less-for-development","title":"2. Start Schema-Less for Development","text":"<p>Begin without Cedar schemas for rapid development:</p> <ul> <li>All claims stored in tags as <code>Set&lt;String&gt;</code> </li> <li>Flexible and forgiving during development  </li> <li>Add schemas later for production type safety  </li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#3-implement-comprehensive-logging","title":"3. Implement Comprehensive Logging","text":"<p>Monitor token validation and policy evaluation:</p> <pre><code>result = cedarling.authorize_multi_issuer(request)\n\n# Retrieve logs for debugging\nlogs = cedarling.get_logs_by_request_id(result.request_id)\nfor log in logs:\n    print(f\"Log: {log}\")\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#4-handle-failed-tokens-gracefully","title":"4. Handle Failed Tokens Gracefully","text":"<p>Design policies to work with partial token sets:</p> <pre><code>// Allow if EITHER token is present\npermit(\n  principal,\n  action == Jans::Action::\"Read\",\n  resource in Jans::Document\n) when {\n  (context has tokens.acme_access_token &amp;&amp;\n   context.tokens.acme_access_token.hasTag(\"scope\") &amp;&amp;\n   context.tokens.acme_access_token.getTag(\"scope\").contains(\"read\")) ||\n  (context has tokens.google_access_token &amp;&amp;\n   context.tokens.google_access_token.hasTag(\"scope\") &amp;&amp;\n   context.tokens.google_access_token.getTag(\"scope\").contains(\"read\"))\n};\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#5-test-with-multiple-issuer-combinations","title":"5. Test with Multiple Issuer Combinations","text":"<p>Test policies with various token combinations:</p> <pre><code># Test with all tokens\nall_tokens_result = cedarling.authorize_multi_issuer(all_tokens_request)\n\n# Test with subset of tokens\npartial_tokens_result = cedarling.authorize_multi_issuer(partial_tokens_request)\n\n# Test with invalid tokens mixed in\nmixed_tokens_result = cedarling.authorize_multi_issuer(mixed_tokens_request)\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#migration-from-standard-authorization","title":"Migration from Standard Authorization","text":"<p>Migrating from <code>authorize()</code> to <code>authorize_multi_issuer()</code>:</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#before-standard-authorization","title":"Before (Standard Authorization)","text":"<pre><code>request = Request(\n    tokens={\n        \"access_token\": access_token,\n        \"id_token\": id_token\n    },\n    action='Jans::Action::\"Read\"',\n    resource=resource,\n    context=context\n)\n\nresult = cedarling.authorize(request)\nif result.is_allowed():\n    # Access granted\n</code></pre> <p>Policy:</p> <pre><code>permit(\n  principal is Jans::User,\n  action == Jans::Action::\"Read\",\n  resource in Jans::Document\n) when {\n  principal.email == resource.owner\n};\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#after-multi-issuer-authorization","title":"After (Multi-Issuer Authorization)","text":"<pre><code>request = AuthorizeMultiIssuerRequest(\n    tokens=[\n        TokenInput(mapping=\"Jans::Access_Token\", payload=access_token),\n        TokenInput(mapping=\"Jans::Id_Token\", payload=id_token)\n    ],\n    action='Jans::Action::\"Read\"',\n    resource=resource,\n    context=context\n)\n\nresult = cedarling.authorize_multi_issuer(request)\nif result.decision:\n    # Access granted\n</code></pre> <p>Policy:</p> <pre><code>permit(\n  principal,\n  action == Jans::Action::\"Read\",\n  resource in Jans::Document\n) when {\n  context has tokens.jans_id_token &amp;&amp;\n  context.tokens.jans_id_token.hasTag(\"email\") &amp;&amp;\n  context.tokens.jans_id_token.getTag(\"email\").contains(resource.owner)\n};\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-multi-issuer/#see-also","title":"See Also","text":"<ul> <li>Cedarling Authorization</li> <li>Cedarling Interfaces</li> <li>JWT Mapping</li> <li>Policy Store Configuration</li> <li>Python Examples</li> <li>Go Examples</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","multi-issuer","federation"]},{"location":"cedarling/reference/cedarling-policy-store/","title":"Cedarling Policy Store","text":"<p>The Policy Store provides:</p> <ol> <li>Cedar Schema: The Cedar schema encoded in Base64.</li> <li>Cedar Policies: The Cedar policies encoded in Base64.</li> <li>Trusted Issuers: Details about the trusted issuers (see below for syntax).</li> <li>Default Entities: Optional static entities that are loaded at startup and available for all policy evaluations (see below).</li> </ol> <p>For a comprehensive JSON schema defining the structure of the policy store, see: policy_store_schema.json. You test the validity of your policy store with this schema at [https://www.jsonschemavalidator.net/].</p> <p>Note: The <code>cedarling_store.json</code> file is only needed if the bootstrap properties: <code>CEDARLING_LOCK</code>; <code>CEDARLING_POLICY_STORE_URI</code>; and <code>CEDARLING_POLICY_STORE_ID</code> are not set to a local location. If you're fetching the policies remotely, you don't need a <code>cedarling_store.json</code> file.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#policy-store-formats","title":"Policy Store Formats","text":"<p>Cedarling supports two policy store formats and automatically detects the correct format based on file extension or URL:</p> Configuration Detection <code>CEDARLING_POLICY_STORE_URI</code> ending in <code>.cjar</code> Cedar Archive from URL <code>CEDARLING_POLICY_STORE_URI</code> (other) Legacy JSON from Lock Server <code>CEDARLING_POLICY_STORE_LOCAL_FN</code> pointing to directory Directory-based format <code>CEDARLING_POLICY_STORE_LOCAL_FN</code> with <code>.cjar</code> extension Cedar Archive file <code>CEDARLING_POLICY_STORE_LOCAL_FN</code> with <code>.json</code> extension JSON file <code>CEDARLING_POLICY_STORE_LOCAL_FN</code> with <code>.yaml</code>/<code>.yml</code> extension YAML file","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#1-legacy-single-file-format-jsonyaml","title":"1. Legacy Single-File Format (JSON/YAML)","text":"<p>The original format stores all policies and schema in a single JSON or YAML file with Base64-encoded content. This is documented in detail in the sections below.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#2-new-directory-based-format","title":"2. New Directory-Based Format","text":"<p>The new directory-based format uses human-readable Cedar files organized in a structured directory:</p> <pre><code>policy-store/\n\u251c\u2500\u2500 metadata.json           # Required: Store identification and versioning\n\u251c\u2500\u2500 manifest.json           # Optional: File checksums for integrity validation\n\u251c\u2500\u2500 schema.cedarschema      # Required: Cedar schema in human-readable format\n\u251c\u2500\u2500 policies/               # Required: Directory containing .cedar policy files\n\u2502   \u251c\u2500\u2500 allow-read.cedar\n\u2502   \u2514\u2500\u2500 deny-guest.cedar\n\u251c\u2500\u2500 templates/              # Optional: Directory containing .cedar template files\n\u251c\u2500\u2500 entities/               # Optional: Directory containing .json entity files\n\u2514\u2500\u2500 trusted-issuers/        # Optional: Directory containing .json issuer configs\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#metadatajson","title":"metadata.json","text":"<p>Contains policy store identification and versioning:</p> <pre><code>{\n  \"cedar_version\": \"4.4.0\",\n  \"policy_store\": {\n    \"id\": \"abc123def456\",\n    \"name\": \"My Application Policies\",\n    \"description\": \"Optional description\",\n    \"version\": \"1.0.0\",\n    \"created_date\": \"2024-01-01T00:00:00Z\",\n    \"updated_date\": \"2024-01-02T00:00:00Z\"\n  }\n}\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#manifestjson-optional","title":"manifest.json (Optional)","text":"<p>Provides integrity validation with file checksums:</p> <pre><code>{\n  \"policy_store_id\": \"abc123def456\",\n  \"generated_date\": \"2024-01-01T12:00:00Z\",\n  \"files\": {\n    \"metadata.json\": {\n      \"size\": 245,\n      \"checksum\": \"sha256:abc123...\"\n    },\n    \"schema.cedarschema\": {\n      \"size\": 1024,\n      \"checksum\": \"sha256:def456...\"\n    }\n  }\n}\n</code></pre> <p>When a manifest is present, Cedarling validates:</p> <ul> <li>File checksums match (SHA-256)</li> <li>File sizes match</li> <li>Policy store ID matches between manifest and metadata</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#policy-files","title":"Policy Files","text":"<p>Policies are stored as human-readable <code>.cedar</code> files in the <code>policies/</code> directory:</p> <pre><code>@id(\"allow-read\")\npermit(\n    principal,\n    action == MyApp::Action::\"read\",\n    resource\n);\n</code></pre> <p>Each policy file must have an <code>@id</code> annotation that uniquely identifies the policy.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#template-files","title":"Template Files","text":"<p>Templates are stored as human-readable <code>.cedar</code> files in the <code>templates/</code> directory:</p> <pre><code>@id(\"resource-access-template\")\npermit(\n    principal == ?principal,\n    action,\n    resource == ?resource\n);\n</code></pre> <p>Each template file must have an <code>@id</code> annotation and use Cedar's template slot syntax (<code>?principal</code>, <code>?resource</code>).</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#entity-files","title":"Entity Files","text":"<p>Entity files in the <code>entities/</code> directory use the Cedar JSON entity format as a JSON array. Each file can contain one or more entity definitions:</p> <pre><code>[\n  {\n    \"uid\": {\n      \"type\": \"Jans::Organization\",\n      \"id\": \"acme-dolphins\"\n    },\n    \"attrs\": {\n      \"name\": \"Acme Dolphins Division\",\n      \"org_id\": \"100129\",\n      \"domain\": \"acme-dolphin.sea\",\n      \"regions\": [\"Atlantic\", \"Pacific\", \"Indian\"]\n    },\n    \"parents\": []\n  },\n  {\n    \"uid\": {\n      \"type\": \"Jans::Role\",\n      \"id\": \"admin\"\n    },\n    \"attrs\": {\n      \"name\": \"Administrator\",\n      \"permissions\": [\"read\", \"write\", \"delete\"]\n    },\n    \"parents\": []\n  }\n]\n</code></pre> <p>Each entity requires:</p> <ul> <li><code>uid</code>: Object with <code>type</code> (Cedar entity type name, e.g., <code>\"Jans::Organization\"</code>) and <code>id</code> (unique entity identifier)</li> <li><code>attrs</code>: Object containing entity attributes matching your Cedar schema</li> <li><code>parents</code>: Optional array of parent entity references for hierarchical relationships</li> </ul> <p>Example with parent relationships (<code>entities/users.json</code>):</p> <pre><code>[\n  {\n    \"uid\": {\n      \"type\": \"Jans::User\",\n      \"id\": \"alice\"\n    },\n    \"attrs\": {\n      \"name\": \"Alice Smith\",\n      \"email\": \"alice@example.com\"\n    },\n    \"parents\": [\n      {\"type\": \"Jans::Role\", \"id\": \"admin\"},\n      {\"type\": \"Jans::Organization\", \"id\": \"acme-dolphins\"}\n    ]\n  }\n]\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#trusted-issuer-files","title":"Trusted Issuer Files","text":"<p>Trusted issuer configuration files in the <code>trusted-issuers/</code> directory define identity providers that can issue tokens. Each file contains a JSON object mapping issuer IDs to their configurations:</p> <pre><code>{\n  \"jans_issuer\": {\n    \"name\": \"Jans Server\",\n    \"description\": \"Primary Janssen Identity Provider\",\n    \"openid_configuration_endpoint\": \"https://jans.example.com/.well-known/openid-configuration\",\n    \"token_metadata\": {\n      \"access_token\": {\n        \"trusted\": true,\n        \"entity_type_name\": \"Jans::Access_token\",\n        \"token_id\": \"jti\",\n        \"workload_id\": \"aud\"\n      },\n      \"id_token\": {\n        \"trusted\": true,\n        \"entity_type_name\": \"Jans::Id_token\",\n        \"user_id\": \"sub\",\n        \"role_mapping\": \"role\"\n      }\n    }\n  }\n}\n</code></pre> <p>Each trusted issuer configuration includes:</p> <ul> <li><code>name</code>: Human-readable name for the issuer (used as namespace for <code>TrustedIssuer</code> entity)</li> <li><code>description</code>: Optional description of the issuer</li> <li><code>openid_configuration_endpoint</code>: HTTPS URL for the OpenID Connect discovery endpoint</li> <li><code>token_metadata</code>: Map of token types to their metadata configuration (see Token Metadata Schema)</li> </ul> <p>You can define multiple issuers in a single file or split them across multiple files in the <code>trusted-issuers/</code> directory.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#cedar-archive-cjar-format","title":"Cedar Archive (.cjar) Format","text":"<p>The directory structure can be packaged as a <code>.cjar</code> file (ZIP archive) for distribution:</p> <pre><code># Create a .cjar archive from a policy store directory\ncd policy-store &amp;&amp; zip -r ../policy-store.cjar .\n</code></pre> <p>Note: In WASM environments, only URL-based and inline string sources are available. Use <code>CEDARLING_POLICY_STORE_URI</code> with a <code>.cjar</code> URL or <code>init_from_archive_bytes()</code> for custom fetch scenarios.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#advanced-loading-from-bytes","title":"Advanced: Loading from Bytes","text":"<p>For scenarios requiring custom fetch logic (e.g., auth headers), archive bytes can be loaded directly:</p> <ul> <li>WASM: Use <code>init_from_archive_bytes(config, bytes)</code> function</li> <li>Rust: Use <code>PolicyStoreSource::ArchiveBytes(Vec&lt;u8&gt;)</code> or <code>load_policy_store_archive_bytes()</code> function</li> </ul> <pre><code>// WASM example with custom fetch\nconst response = await fetch(url, { headers: { Authorization: \"...\" } });\nconst bytes = new Uint8Array(await response.arrayBuffer());\nconst cedarling = await init_from_archive_bytes(config, bytes);\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#legacy-single-file-format-json","title":"Legacy Single-File Format (JSON)","text":"<p>The following sections document the legacy single-file JSON format.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#json-schema","title":"JSON Schema","text":"<p>The JSON Schema accepted by Cedarling is defined as follows:</p> <pre><code>{\n  \"cedar_version\": \"v4.0.0\",\n  \"policy_stores\": {\n      \"some_unique_string_id\": {\n          \"name\": \"DoveCRM Policy Store\",\n          \"description\": \"DoveCRM policies, schema, and trusted JWT issuers.\",\n          \"policies\": { ... },\n          \"schema\": { ... },\n          \"trusted_issuers\": { ... },\n          \"default_entities\": { ... }\n      }\n  }\n}\n</code></pre> <ul> <li>cedar_version : (String) The version of Cedar policy. The protocols of this version will be followed when processing Cedar schema and policies.</li> <li>policies : (Object) Base64 encoded object containing one or more policy IDs as keys, with their corresponding objects as values. See: policies schema.</li> <li>schema : (String | Object) Base64 encoded JSON Object. See schema below.</li> <li>trusted_issuers : (Object of {unique_id =&gt; IdentitySource}(#trusted-issuer-schema)) List of metadata for Identity Sources.</li> <li>default_entities : (Object) Optional map of entity IDs to encoded/default entity payloads. See Default Entities.</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#schema","title":"<code>schema</code>","text":"<p>Either String or Object, where Object is preferred.</p> <p>Where Object - An object with <code>encoding</code>, <code>content_type</code> and <code>body</code> keys. For example:</p> <pre><code>\"schema\": {\n    \"encoding\": \"none\", // can be one of \"none\" or \"base64\"\n    \"content_type\": \"cedar\", // can be one of \"cedar\" or \"cedar-json\"\n    \"body\": \"namespace Jans {\\ntype Url = {\"host\": String, \"path\": String, \"protocol\": String};...\"\n}\n</code></pre> <p>Where String - The schema in cedar-json format, encoded as Base64. For example:</p> <pre><code>\"schema\": \"cGVybWl0KAogICAgc...\"\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#default-entities","title":"Default Entities","text":"<p>Default entities allow you to preload static entity records that are available to every authorization request. Cedarling loads these at startup alongside policies and schema.</p> <p>Format:</p> <ul> <li>Each entry is a simple key-value pair where the key is the entity ID and the value is a Base64-encoded JSON object representing the entity payload.</li> <li>Default entities support two formats:</li> <li>Cedar format: <code>{\"uid\": {\"type\": \"...\", \"id\": \"...\"}, \"attrs\": {...}, \"parents\": [...]}</code></li> <li>Legacy format: <code>{\"entity_type\": \"...\", \"entity_id\": \"...\", ...attributes...}</code> (for backward compatibility)</li> </ul> <pre><code>\"default_entities\": {\n  \"1694c954f8d9\": \"eyJ1aWQiOnsidHlwZSI6IkphbnM6Ok9yZ2FuaXphdGlvbiIsImlkIjoiMTY5NGM5NTRmOGQ5In0sImF0dHJzIjp7Im8iOiJBY21lIERvbHBoaW5zIERpdmlzaW9uIiwib3JnX2lkIjoiMTAwMTI5IiwiZG9tYWluIjoiYWNtZS1kb2xwaGluLnNlYSIsInJlZ2lvbnMiOlsiQXRsYW50aWMiLCJQYWNpZmljIiwiSW5kaWFuIl19LCJwYXJlbnRzIjpbXX0=\",\n  \"74d109b20248\": \"eyJ1aWQiOnsidHlwZSI6IkphbnM6OlByaWNlTGlzdCIsImlkIjoiNzRkMTA5YjIwMjQ4In0sImF0dHJzIjp7ImRlc2NyaXB0aW9uIjoiMjAyNSBQcmljZSBMaXN0IiwicHJvZHVjdHMiOnsiMTUwMjAiOjkuOTUsIjE1MDUwIjoxNC45NX0sInNlcnZpY2VzIjp7IjUxMDAxIjo5OS4wLCI1MTAyMCI6Mjk5LjB9fSwicGFyZW50cyI6W119\"\n}\n</code></pre> <p>Example of the decoded payloads for two default entities:</p> <pre><code>{\n  \"1694c954f8d9\": {\n    \"uid\": {\n      \"type\": \"Jans::Organization\",\n      \"id\": \"1694c954f8d9\"\n    },\n    \"attrs\": {\n      \"o\": \"Acme Dolphins Division\",\n      \"org_id\": \"100129\",\n      \"domain\": \"acme-dolphin.sea\",\n      \"regions\": [\"Atlantic\", \"Pacific\", \"Indian\"]\n    },\n    \"parents\": []\n  },\n  \"74d109b20248\": {\n    \"uid\": {\n      \"type\": \"Jans::PriceList\",\n      \"id\": \"74d109b20248\"\n    },\n    \"attrs\": {\n      \"description\": \"2025 Price List\",\n      \"products\": { \"15020\": 9.95, \"15050\": 14.95 },\n      \"services\": { \"51001\": 99.0, \"51020\": 299.0 }\n    },\n    \"parents\": []\n  }\n}\n</code></pre> <p>Notes:</p> <ul> <li>Cedar policies can reference these entities directly by type and ID, just like any other entity present during evaluation.</li> <li>A common use case is defining an organization entity and writing policies that compare runtime attributes (e.g., <code>resource.org_id</code>) to attributes on the default entity.</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#entity-conflict-resolution","title":"Entity Conflict Resolution","text":"<p>When request entities have the same UID as default entities, Cedarling automatically resolves conflicts by giving request entities precedence over default entities. This ensures that runtime data can override static configurations while maintaining consistency.</p> <p>Example: If a resource entity with UID <code>\"org1\"</code> is passed in an authorization request, and a default entity with the same UID exists, the resource entity's attributes will be used instead of the default entity's attributes.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#cedar-policies-schema","title":"Cedar Policies Schema","text":"<p>The <code>policies</code> field describes the Cedar policies that will be used in Cedarling. Multiple policies can be defined, with each policy requiring a <code>unique_policy_id</code>.</p> <pre><code>  \"policies\": {\n    \"unique_policy_id\": {\n      \"cedar_version\" : \"v4.0.0\",\n      \"name\": \"Policy for Unique Id\",\n      \"description\": \"simple policy example\",\n      \"creation_date\": \"2024-09-20T17:22:39.996050\",\n      \"policy_content\": { ... },\n    },\n    ...\n  }\n</code></pre> <ul> <li>unique_policy_id: (String) A unique policy ID used to for tracking and auditing purposes.</li> <li>name : (String) A name for the policy</li> <li>description : (String) A brief description of cedar policy</li> <li>creation_date : (String) Policy creating date in <code>YYYY-MM-DDTHH:MM:SS.ssssss</code></li> <li>policy_content : (String | Object) The Cedar Policy. See policy_content below.</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#policy_content","title":"<code>policy_content</code>","text":"<p>Either String or Object, where Object is preferred.</p> <p>Where Object - An object with <code>encoding</code>, <code>content_type</code> and <code>body</code> keys. For example:</p> <pre><code>\"policy_content\": {\n    \"encoding\": \"none\", // can be one of \"none\" or \"base64\"\n    \"content_type\": \"cedar\", // ONLY \"cedar\" for now due to limitations in cedar-policy crate\n    \"body\": \"permit(\\n    principal is Jans::User,\\n    action in [Jans::Action::\\\"Update\\\"],\\n    resource is Jans::Issue\\n)when{\\n    principal.country == resource.country\\n};\"\n}\n</code></pre> <p>Where String - The policy in cedar format, encoded as Base64. For example:</p> <pre><code>\"policy_content\": \"cGVybWl0KAogICAgc...\"\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#example-of-policies","title":"Example of <code>policies</code>","text":"<p>Here is a non-normative example of the <code>policies</code> field:</p> <pre><code>  \"policies\": {\n    \"840da5d85403f35ea76519ed1a18a33989f855bf1cf8\": {\n      \"cedar_version\": \"v2.7.4\",\n      \"name\": \"Policy-the-first\",\n      \"description\": \"simple policy example for principal workload\",\n      \"creation_date\": \"2024-09-20T17:22:39.996050\",\n      \"policy_content\": \"cGVybWl0KAogICAgc...\"\n    },\n    \"0fo1kl928Afa0sc9123scma0123891asklajsh1233ab\": {\n      \"cedar_version\": \"v2.7.4\",\n      \"name\": \"Policy-the-second\",\n      \"description\": \"another policy example\",\n      \"creation_date\": \"2024-09-20T18:22:39.192051\",\n      \"policy_content\": \"kJW1bWl0KA0g3CAxa...\"\n    },\n    \"1fo1kl928Afa0sc9123scma0123891asklajsh1233ac\": {\n      \"cedar_version\": \"v2.7.4\",\n      \"name\": \"Policy-the-third\",\n      \"description\": \"another policy example\",\n      \"creation_date\": \"2024-09-20T18:22:39.192051\",\n      \"policy_content\": {\n        \"encoding\": \"none\",\n        \"content_type\" : \"cedar\",\n        \"body\": \"permit(...) where {...}\"\n      }\n    },\n    \"2fo1kl928Afa0sc9123scma0123891asklajsh1233ad\": {\n      \"cedar_version\": \"v2.7.4\",\n      \"name\": \"Policy-the-fourth\",\n      \"description\": \"another policy example\",\n      \"creation_date\": \"2024-09-20T18:22:39.192051\",\n      \"policy_content\": {\n        \"encoding\": \"base64\",\n        \"content_type\" : \"cedar\",\n        \"body\": \"kJW1bWl0KA0g3CAxa...\"\n      }\n    },\n    ...\n  }\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#trusted-issuers-schema","title":"Trusted Issuers Schema","text":"<p>This record contains the information needed to validate tokens from this issuer:</p> <pre><code>\"trusted_issuers\": {\n  \"trusted_issuer_id\" : {\n    \"name\": \"name_of_the_trusted_issuer\",\n    \"description\": \"description for the trusted issuer\",\n    \"openid_configuration_endpoint\": \"https://&lt;trusted-issuer-hostname&gt;/.well-known/openid-configuration\",\n    \"token_metadata\": {\n      \"access_tokens\": {\n        \"trusted\": true,\n        \"token_id\": \"jti\",\n        ...\n      },\n      \"id_tokens\": { ... },\n      \"userinfo_tokens\": { ... },\n      \"tx_tokens\": { ... },\n      ...\n    }\n  },\n  \"another_issuer_id\": {\n    ...\n  }\n  ...\n}\n</code></pre> <ul> <li>name : (String) The name of the trusted issuer.</li> <li>description : (String) A brief description of the trusted issuer, providing context for administrators.</li> <li>openid_configuration_endpoint : (String) The HTTPS URL for the OpenID Connect configuration endpoint (usually found at <code>/.well-known/openid-configuration</code>).</li> <li>trusted_issuer_id : (Object, optional) Metadata related to a particular issuer. You can add as many trusted issuers you want. Furthermore, the name this object is what will be used as the entity ID of the Trusted Issuer that Cedarling automatically creates at startup.</li> <li>token_metadata : (Object, optional) Tokens metadata in a map of token name -&gt; token metadata. See Token Metadata Schema.</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#token-metadata-schema","title":"Token Metadata Schema","text":"<p>The Token Entity Metadata Schema defines how tokens are mapped, parsed, and transformed within Cedarling. It allows you to specify how to extract user IDs, roles, and other claims from a token using customizable parsers.</p> <pre><code>{\n  \"trusted\": true,\n  \"entity_type_name\": \"Jans::Access_token\",\n  \"token_id\": \"jti\",\n  \"workload_id\": \"aud | client_id\",\n  \"user_id\": \"sub | uid | email\",\n  \"principal_mapping\": [\"Jans::Workload\"],\n  \"role_mapping\": \"role | group | memberOf\",\n  \"required_claims\": [\"iss\", \"exp\", \"some_custom_claim\", ...],\n  \"claim_mapping\": {\n    \"mapping_target\": {\n      \"parser\": \"&lt;type of parser ('regex' or 'json')&gt;\",\n      \"type\": \"&lt;type identifier (e.g., 'Acme::Email')&gt;\",\n      \"...\": \"Additional configurations specific to the parser\"\n    },\n  },\n}\n</code></pre> <ul> <li><code>\"trusted\"</code> (bool, Default: true): Allows toggling configuration without deleting the object.</li> <li><code>\"entity_type_name\"</code> (string, required): The type name of the Cedar Entity that will be created from the token; for example: \"Jans::Access_token\".</li> <li><code>\"principal_mapping\"</code> (array[string], Default: []): Describes where references of the created token entity should be included.</li> <li><code>\"token_id\"</code> (string, Default: \"jti\"): The JWT claim that will be used as the ID for the Token Entity.</li> <li><code>\"user_id\"</code> (string, Default: \"sub\"): The JWT claim that will be used as the ID for the User Entity.</li> <li><code>\"role_mapping\"</code> (string, Default: \"role\"): The JWT claim that will be used as the ID for any Role Entities. For more info, see: role mapping.</li> <li><code>\"workload_id\"</code> (string, Default: \"aud\"): The JWT claim that will be used as the ID for the Workload Entity.</li> <li><code>\"required_claims\"</code> (array[string], Default: []): A list of claims that must be present within the JWT to be considered valid. Additionally, if a required claim is a registered claim name under RFC 7519 Section 4.1, the claim will also be validated.</li> <li><code>\"claim_mapping\"</code> (object, Default: {}): Applies a transformation on a JWT's claim to types defined in the Cedar schema before creating the Token Entity's attribute. This enables creating a Cedar Type that has multiple attributes from a single JWT claim. For more info, see claim mapping.</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#role-mapping","title":"Role mapping","text":"<ul> <li>role_mapping: (String OR Array of String, Optional) Indicates which field in the token should be used for role-based access control. If not needed, set to an empty string (<code>\"\"</code>).</li> </ul> <p>You can include a <code>role_mapping</code> in each token, all of them will be executed by Cedarling. If none <code>role_mapping</code> defined the <code>Cedarling</code> will try to find role in <code>userinfo</code> token in field <code>role</code>.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#claim-mapping","title":"Claim mapping","text":"<ul> <li>claim_mapping: Defines how to extract and transform specific claims from the token. Each claim can have its own parser (<code>regex</code> or <code>json</code>) and type (<code>Acme::email_address</code>, <code>Acme::Url</code>, etc.).</li> </ul> <p>In regex attribute mapping like <code>\"UID\": {\"attr\": \"uid\", \"type\":\"String\"},</code>, <code>type</code> field can contain possible variants:</p> <ul> <li><code>String</code> - to string without transformation,</li> <li><code>Number</code> - parse string to float64 (JSON number) if error returns default value</li> <li><code>Boolean</code> - if string NOT empty map to true else false</li> </ul> <p>Note, use of regex named capture groups which is more readable by referring to parts of a regex match by descriptive names rather than numbers. For example, <code>(?P&lt;name&gt;...)</code> defines a named capture group where name is the identifier, and ... is the regex pattern for what you want to capture.</p> <p>When you use <code>(?x)</code> modifier in regexp, ensure that you escaped character <code>#</code> =&gt; <code>\\#</code>.</p> <p>example of mapping <code>email_address</code> and <code>Url</code>:</p> <pre><code>...\n  \"claim_mapping\": {\n    \"email\": {\n      \"parser\": \"regex\",\n      \"type\": \"Test::email_address\",\n      \"regex_expression\": \"^(?P&lt;UID&gt;[^@]+)@(?P&lt;DOMAIN&gt;.+)$\",\n      \"UID\": {\n        \"attr\": \"uid\",\n        \"type\": \"String\"\n      },\n      \"DOMAIN\": {\n        \"attr\": \"domain\",\n        \"type\": \"String\"\n      }\n    },\n    \"profile\": {\n      \"parser\": \"regex\",\n      \"type\": \"Test::Url\",\n      \"regex_expression\": \"(?x) ^(?P&lt;SCHEME&gt;[a-zA-Z][a-zA-Z0-9+.-]*):\\\\/\\\\/(?P&lt;HOST&gt;[^\\\\/:\\\\#?]+)(?::(?&lt;PORT&gt;\\\\d+))?(?P&lt;PATH&gt;\\\\/[^?\\\\#]*)?(?:\\\\?(?P&lt;QUERY&gt;[^\\\\#]*))?(?:(?P&lt;FRAGMENT&gt;.*))?\",\n      \"SCHEME\": {\n        \"attr\": \"scheme\",\n        \"type\": \"String\"\n      },\n      \"HOST\": {\n        \"attr\": \"host\",\n        \"type\": \"String\"\n      },\n      \"PORT\": {\n        \"attr\": \"port\",\n        \"type\": \"String\"\n      },\n      \"PATH\": {\n        \"attr\": \"path\",\n        \"type\": \"String\"\n      },\n      \"QUERY\": {\n        \"attr\": \"query\",\n        \"type\": \"String\"\n      },\n      \"FRAGMENT\": {\n        \"attr\": \"fragment\",\n        \"type\": \"String\"\n      }\n    }\n  }\n...\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#example-policy-store","title":"Example Policy store","text":"<p>Here is a non-normative example of a <code>cedarling_store.json</code> file:</p> <pre><code>{\n  \"cedar_version\": \"v4.0.0\",\n  \"policies\": {\n    \"840da5d85403f35ea76519ed1a18a33989f855bf1cf8\": {\n      \"description\": \"simple policy example\",\n      \"creation_date\": \"2024-09-20T17:22:39.996050\",\n      \"policy_content\": \"cedar_policy_encoded_in_base64\"\n    }\n  },\n  \"schema\": \"schema_encoded_in_base64\",\n  \"trusted_issuers\": {\n    \"08c6c18a654f492adcf3fe069d729b4d9e6bf82605cb\": {\n      \"name\": \"Google\",\n      \"description\": \"Consumer IDP\",\n      \"openid_configuration_endpoint\": \"https://accounts.google.com/.well-known/openid-configuration\",\n      \"token_metadata\": {\n        \"access_token\": {\n          \"trusted\": true,\n          \"entity_type_name\": \"Jans::Access_token\",\n          \"token_id\": \"jti\"\n        },\n        \"id_token\": {\n          \"trusted\": true,\n          \"entity_type_name\": \"Jans::Id_token\",\n          \"token_id\": \"jti\",\n          \"role_mapping\": \"role\"\n        },\n        \"userinfo_token\": {\n          \"trusted\": true,\n          \"entity_type_name\": \"Jans::Userinfo_token\",\n          \"token_id\": \"jti\",\n          \"role_mapping\": \"role\"\n        }\n      }\n    }\n  },\n  \"default_entities\": {\n    \"1694c954f8d9\": \"eyJ1aWQiOnsidHlwZSI6IkphbnM6Ok9yZ2FuaXphdGlvbiIsImlkIjoiMTY5NGM5NTRmOGQ5In0sImF0dHJzIjp7Im8iOiJBY21lIERvbHBoaW5zIERpdmlzaW9uIiwib3JnX2lkIjoiMTAwMTI5IiwiZG9tYWluIjoiYWNtZS1kb2xwaGluLnNlYSIsInJlZ2lvbnMiOlsiQXRsYW50aWMiLCJQYWNpZmljIiwiSW5kaWFuIl19LCJwYXJlbnRzIjpbXX0=\",\n    \"74d109b20248\": \"eyJ1aWQiOnsidHlwZSI6IkphbnM6OlByaWNlTGlzdCIsImlkIjoiNzRkMTA5YjIwMjQ4In0sImF0dHJzIjp7ImRlc2NyaXB0aW9uIjoiMjAyNSBQcmljZSBMaXN0IiwicHJvZHVjdHMiOnsiMTUwMjAiOjkuOTUsIjE1MDUwIjoxNC45NX0sInNlcnZpY2VzIjp7IjUxMDAxIjo5OS4wLCI1MTAyMCI6Mjk5LjB9fSwicGFyZW50cyI6W119\"\n  }\n}\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#multi-issuer-token-entities","title":"Multi-Issuer Token Entities","text":"<p>When using the <code>authorize_multi_issuer</code> method, Cedarling creates token entities dynamically without requiring predefined User/Workload principals. This section describes how these token entities are structured and made available in policies.</p> <p>\u26a0\ufe0f SCHEMA REQUIREMENT: Multi-issuer authorization requires specific Cedar schema modifications. Your schema must include the multi-issuer token structure or authorization will fail with schema validation errors. See Schema Requirements below.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#token-entity-structure","title":"Token Entity Structure","text":"<p>Each validated token in a multi-issuer authorization request becomes a Cedar entity with the following structure:</p> <p>Required Attributes (stored as entity attributes):</p> <ul> <li><code>token_type</code> (String): The entity type name (e.g., \"Jans::Access_Token\", \"Acme::DolphinToken\")</li> <li><code>jti</code> (String): Unique token identifier from JWT</li> <li><code>iss?</code> (TrustedIssuer): JWT issuer claim value (derived from iss to TrustedIssuer); optional when the token has not been verified or the issuer could not be determined.</li> <li><code>exp</code> (Long): Token expiration timestamp</li> <li><code>validated_at</code> (Long): Timestamp when Cedarling validated the token</li> </ul> <p>Optional Attributes (JWT claims stored as entity tags):</p> <ul> <li>All other JWT claims are stored as entity tags with <code>Set&lt;String&gt;</code> type by default</li> <li>Examples: <code>scope</code>, <code>aud</code>, <code>sub</code>, <code>client_id</code>, custom claims</li> </ul> <p>Complete Example:</p> <pre><code>namespace Jans{\n  entity Access_token = {\n    \"token_type\": String,        // Required: Entity type name\n    \"jti\": String,               // Required: Token ID\n    \"iss\": Jans::TrustedIssuer,  // Required: JWT issuer\n    \"exp\": Long,                 // Required: Expiration\n    \"validated_at\": Long,        // Required: Validation timestamp\n    // Optional JWT claims (must be optional)\n    \"aud\"?: String,\n    \"iat\"?: Long,\n    \"scope\"?: Set&lt;String&gt;,\n    // ... other claims\n  } tags Set&lt;String&gt;;            // Required: For dynamic claim storage\n\n  entity TrustedIssuer = {\n    issuer_entity_id: Url\n  };\n}\n</code></pre> <p>Important Notes:</p> <ul> <li>All token entity attributes (except the five required ones) must be optional (<code>?</code>) to support tokens with varying claim structures</li> <li>JWT claims not defined as attributes are stored as entity tags (Set by default) <li>The <code>tags Set&lt;String&gt;</code> declaration is required for dynamic JWT claim access</li>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#accessing-token-claims-in-policies","title":"Accessing Token Claims in Policies","text":"<p>JWT claims are accessed using Cedar's tag syntax:</p> <pre><code>// Check if token has a claim\ncontext.tokens.acme_access_token.hasTag(\"scope\")\n\n// Get claim value (returns a Set)\ncontext.tokens.acme_access_token.getTag(\"scope\")\n\n// Check if Set contains specific value\ncontext.tokens.acme_access_token.getTag(\"scope\").contains(\"read:profile\")\n</code></pre> <p>Examples of claim access:</p> <pre><code>// Single-valued claim (stored as single-element Set)\ncontext.tokens.acme_access_token.hasTag(\"sub\") &amp;&amp;\ncontext.tokens.acme_access_token.getTag(\"sub\").contains(\"user123\")\n\n// Multi-valued claim (stored as Set)\ncontext.tokens.acme_access_token.hasTag(\"scope\") &amp;&amp;\ncontext.tokens.acme_access_token.getTag(\"scope\").contains(\"read:profile\")\n\n// Audience claim (typically multi-valued)\ncontext.tokens.acme_access_token.hasTag(\"aud\") &amp;&amp;\ncontext.tokens.acme_access_token.getTag(\"aud\").contains(\"my-client-id\")\n\n// Custom claim\ncontext.tokens.dolphin_acme_dolphin_token.hasTag(\"waiver\") &amp;&amp;\ncontext.tokens.dolphin_acme_dolphin_token.getTag(\"waiver\").contains(\"signed\")\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#token-collection-in-context","title":"Token Collection in Context","text":"<p>Validated tokens are organized into a <code>tokens</code> collection in the Cedar context using predictable naming:</p> <pre><code>entity Tokens = {\n  // Format: {issuer_name}_{token_type}\n  \"acme_access_token\": Token,           // Access token from Acme\n  \"acme_id_token\": Token,               // ID token from Acme\n  \"google_id_token\": Token,             // ID token from Google\n  \"dolphin_acme_dolphin_token\": Token,  // Custom token type from Dolphin\n  \"total_token_count\": Long,            // Number of validated tokens\n};\n</code></pre> <p>The naming follows this pattern:</p> <ul> <li>Issuer name: From trusted issuer metadata <code>name</code> field, or hostname from JWT <code>iss</code> claim</li> <li>Token type: Extracted from the <code>mapping</code> field (e.g., \"Jans::Access_Token\" \u2192 \"access_token\")</li> <li>Both converted to lowercase with underscores replacing special characters</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#schema-requirements-for-multi-issuer","title":"Schema Requirements for Multi-Issuer","text":"","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#1-token-entity-schema","title":"1. Token Entity Schema","text":"<p>All token entities must include these five required attributes and declare tags:</p> <pre><code>namespace Jans {\n  entity Access_token = {\n    // *** REQUIRED ATTRIBUTES FOR MULTI-ISSUER ***\n    token_type?: String,        // Entity type (e.g., \"Jans::Access_Token\")\n    jti?: String,               // JWT ID - unique token identifier\n    iss?: Jans::TrustedIssuer,  // Issuer entity (for standard authz)\n    exp?: Long,                 // Token expiration timestamp\n    validated_at?: Long,        // Validation timestamp\n\n    // Optional JWT claims - ALL MUST BE OPTIONAL (?)\n    aud?: String,               // Audience\n    iat?: Long,                 // Issued at\n    scope?: Set&lt;String&gt;,        // OAuth scopes\n    client_id?: String,         // Client ID\n    sub?: String,               // Subject\n    // Add other claims as needed\n  } tags Set&lt;String&gt;;           // *** REQUIRED: For dynamic claims ***\n\n  entity id_token = {\n    // *** REQUIRED ATTRIBUTES FOR MULTI-ISSUER ***\n    token_type?: String,\n    jti?: String,\n    iss?: Jans::TrustedIssuer,\n    exp?: Long,\n    validated_at?: Long,\n\n    // Optional JWT claims - ALL MUST BE OPTIONAL (?)\n    aud?: Set&lt;String&gt;,\n    iat?: Long,\n    sub?: String,\n    email?: email_address,\n    name?: String,\n    phone_number?: String,\n    role?: Set&lt;String&gt;,\n    acr?: String,\n    amr?: Set&lt;String&gt;,\n    azp?: String,\n    birthdate?: String,\n    // Add other claims as needed\n  } tags Set&lt;String&gt;;           // *** REQUIRED: For dynamic claims ***\n\n  entity Userinfo_token = {\n    // *** REQUIRED ATTRIBUTES FOR MULTI-ISSUER ***\n    token_type?: String,\n    jti?: String,\n    iss?: Jans::TrustedIssuer,\n    exp?: Long,\n    validated_at?: Long,\n\n    // Optional JWT claims - ALL MUST BE OPTIONAL (?)\n    aud?: String,\n    iat?: Long,\n    sub?: String,\n    email?: email_address,\n    name?: String,\n    birthdate?: String,\n    phone_number?: String,\n    role?: Set&lt;String&gt;,\n    // Add other claims as needed\n  } tags Set&lt;String&gt;;           // *** REQUIRED: For dynamic claims ***\n\n  entity TrustedIssuer = {\n    issuer_entity_id: Url\n  };\n}\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#2-custom-token-types","title":"2. Custom Token Types","text":"<p>For custom token types, follow the same pattern:</p> <pre><code>namespace Acme {\n  entity DolphinToken = {\n    // *** REQUIRED ATTRIBUTES FOR MULTI-ISSUER ***\n    token_type?: String,\n    jti?: String,\n    iss?: Acme::TrustedIssuer,\n    exp?: Long,\n    validated_at?: Long,\n\n    // Custom token-specific attributes (all optional)\n    waiver?: String,\n    location?: String,\n    clearance_level?: Long,\n  } tags Set&lt;String&gt;;           // *** REQUIRED: For dynamic claims ***\n\n  entity TrustedIssuer = {\n    issuer_entity_id: Url\n  };\n}\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#3-context-type-schema","title":"3. Context Type Schema","text":"<p>The Context type must include a <code>tokens</code> field:</p> <pre><code>type Context = {\n  // Standard context fields\n  network?: String,\n  network_type?: String,\n  user_agent?: String,\n  operating_system?: String,\n  device_health?: Set&lt;String&gt;,\n  current_time?: Long,\n  geolocation?: Set&lt;String&gt;,\n  fraud_indicators?: Set&lt;String&gt;,\n\n  // *** REQUIRED FOR MULTI-ISSUER ***\n  tokens?: TokensContext,\n};\n\ntype TokensContext = {\n  total_token_count: Long,      // Required field\n  // Individual token fields added dynamically:\n  // Pattern: {issuer_name}_{token_type}\n  // Example: acme_access_token, google_id_token\n};\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#key-requirements","title":"Key Requirements","text":"<ol> <li>Required Attributes: Add <code>token_type</code>, <code>jti</code>, <code>issuer</code>, <code>exp</code>, <code>validated_at</code> to all token entities</li> <li>Optional Modifier: All attributes must be optional (<code>?</code>) to support varying token structures</li> <li>Tags Declaration: All token entities must declare <code>tags Set&lt;String&gt;</code> for dynamic JWT claims</li> <li>Context Update: Add <code>tokens?: TokensContext</code> field to your Context type</li> <li>Consistency: Use the same attribute names across all token entity types</li> </ol>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#why-these-changes-are-required","title":"Why These Changes Are Required","text":"<ul> <li>Schema Validation: Cedar validates all entities against the schema; missing required attributes cause authorization failures</li> <li>Dynamic Claims: JWT claims vary by issuer and token type; tags allow flexible claim storage</li> <li>Context Structure: Multi-issuer authorization places token entities in <code>context.tokens.*</code> which requires schema support</li> <li>Compatibility: Optional attributes ensure schema works with both standard and multi-issuer authorization</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#schema-update-checklist","title":"Schema Update Checklist","text":"<p>Before using multi-issuer authorization, verify your schema has:</p> <ul> <li>Added five required attributes to all token entities (token_type, jti, issuer, exp, validated_at)</li> <li>Made all token entity attributes optional (<code>?</code>)</li> <li>Added <code>tags Set&lt;String&gt;</code> declaration to all token entities</li> <li>Added <code>tokens?: TokensContext</code> field to Context type</li> <li>Defined <code>TokensContext</code> type with <code>total_token_count: Long</code></li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#policy-examples-using-token-entities","title":"Policy Examples Using Token Entities","text":"<p>Simple token validation:</p> <pre><code>permit(\n  principal,\n  action == Jans::Action::\"Read\",\n  resource in Jans::Document\n) when {\n  context has tokens.acme_access_token &amp;&amp;\n  context.tokens.acme_access_token.hasTag(\"scope\") &amp;&amp;\n  context.tokens.acme_access_token.getTag(\"scope\").contains(\"read:documents\")\n};\n</code></pre> <p>Multi-issuer validation:</p> <pre><code>permit(\n  principal,\n  action == Trade::Action::\"Vote\",\n  resource in Trade::Election\n) when {\n  // Require token from trade association\n  context has tokens.trade_association_access_token &amp;&amp;\n  context.tokens.trade_association_access_token.hasTag(\"member_status\") &amp;&amp;\n  context.tokens.trade_association_access_token.getTag(\"member_status\").contains(\"Corporate Member\") &amp;&amp;\n  // AND token from employer\n  context has tokens.company_access_token &amp;&amp;\n  context.tokens.company_access_token.hasTag(\"employee_id\")\n};\n</code></pre> <p>Custom token type:</p> <pre><code>permit(\n  principal,\n  action == Acme::Action::\"SwimWithDolphin\",\n  resource == Acme::Aquarium::\"Miami\"\n) when {\n  context has tokens.dolphin_acme_dolphin_token &amp;&amp;\n  context.tokens.dolphin_acme_dolphin_token.hasTag(\"waiver\") &amp;&amp;\n  context.tokens.dolphin_acme_dolphin_token.getTag(\"waiver\").contains(\"signed\") &amp;&amp;\n  context.tokens.dolphin_acme_dolphin_token.hasTag(\"clearance_level\") &amp;&amp;\n  context.tokens.dolphin_acme_dolphin_token.getTag(\"clearance_level\").contains(5)\n};\n</code></pre>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#trusted-issuer-configuration-for-multi-issuer","title":"Trusted Issuer Configuration for Multi-Issuer","text":"<p>The <code>name</code> field in trusted issuer configuration is critical for multi-issuer authorization:</p> <pre><code>\"trusted_issuers\": {\n  \"acme_issuer_id\": {\n    \"name\": \"Acme\",  // Used in token collection naming: \"acme_access_token\" and depict namespace for `TrustedIssuer` cedar type\n    \"description\": \"Acme Corporation IDP\",\n    \"openid_configuration_endpoint\": \"https://idp.acme.com/.well-known/openid-configuration\",\n    \"token_metadata\": {\n      \"access_token\": {\n        \"entity_type_name\": \"Jans::Access_Token\",\n        \"token_id\": \"jti\"\n      }\n    }\n  },\n  \"dolphin_issuer_id\": {\n    \"name\": \"Dolphin\",  // Used in token collection naming: \"dolphin_acme_dolphin_token\" and depict namespace for `TrustedIssuer` cedar type\n    \"description\": \"Dolphin Service Provider\",\n    \"openid_configuration_endpoint\": \"https://idp.dolphin.sea/.well-known/openid-configuration\",\n    \"token_metadata\": {\n      \"dolphin_token\": {\n        \"entity_type_name\": \"Acme::DolphinToken\",\n        \"token_id\": \"jti\"\n      }\n    }\n  }\n}\n</code></pre> <p>Note: The <code>name</code> field ensures predictable and secure token entity naming in the policy evaluation context. And is used as namespace for <code>TrustedIssuer</code> cedar type.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#policy-and-schema-authoring","title":"Policy and Schema Authoring","text":"<p>You can manually create your Cedar policies and schema in Visual Studio. Make sure you run the cedar command line tool to validate both your schema and policies.</p> <p>The easiest way to author your policy store is to use the Policy Designer in Agama Lab. This tool helps you define the policies, schema and trusted IDPs and to publish a policy store to a Github repository.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#minimum-supported-cedar-policy-schema","title":"Minimum supported <code>cedar-policy schema</code>","text":"<p>Here is example of a minimum supported <code>cedar-policy schema</code>:</p> <pre><code>namespace Jans {\n  entity id_token = {\"aud\": Set&lt;String&gt;,\"iss\": String, \"sub\": String, iss?: Jans::TrustedIssuer};\n  entity Role;\n  entity User in [Role] = {};\n  entity Access_token = {\"aud\": String,\"iss\": String, \"jti\": String, \"client_id\": String, iss?: Jans::TrustedIssuer};\n  entity Workload = {};\n  entity TrustedIssuer = {\n    issuer_entity_id: Url\n  };\n\n  entity Issue = {};\n  action \"Update\" appliesTo {\n    principal: [Workload, User, Role],\n    resource: [Issue],\n    context: {}\n  };\n}\n</code></pre> <p>Note: The principal you use may vary depending on the authorization method.</p> <p>You can extend all of this entites and add your own.</p> <p>Mandatory entities is: <code>id_token</code>, <code>Role</code>, <code>User</code>, <code>Access_token</code>, <code>Workload</code>. <code>Issue</code> entity and <code>Update</code> action are optinal. Is created for example, you can create others for your needs.</p> <p><code>Context</code> and <code>Resource</code> entities you can pass during authorization request and next entites creating based on the JWT tokens:</p> <ul> <li> <p><code>id_token</code> - entity based on the <code>id</code> JWT token fields.</p> </li> <li> <p>ID for entity based in <code>jti</code> field.</p> </li> <li> <p><code>Role</code> - define role of user.</p> </li> <li> <p>Mapping defined in <code>Token Metadata Schema</code>.</p> </li> <li>Claim in JWT usually is string or array of string.</li> <li> <p>Each <code>Role</code> is parent for <code>User</code>. So to check role in policy use operator <code>in</code> to check hierarchy.</p> </li> <li> <p><code>User</code> - entity based on the <code>id</code>and <code>userinfo</code> JWT token fields.</p> </li> <li> <p>If <code>id</code>and <code>userinfo</code> JWT token fields has different <code>sub</code> value, <code>userinfo</code> JWT token will be ignored.</p> </li> <li> <p>ID for entity based in <code>sub</code> field. (will be changed in future)</p> </li> <li> <p><code>Access_token</code> - entity based on the <code>access</code> JWT token fields.</p> </li> <li> <p>ID for entity based in <code>jti</code> field.</p> </li> <li> <p><code>Workload</code> - entity based on the <code>access</code> JWT token fields.</p> </li> <li>ID for entity based in <code>client_id</code> field.</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-policy-store/#note-on-test-fixtures","title":"Note on test fixtures","text":"<p>You will notice that test fixtures in the cedarling code base are quite often in yaml rather than in json.</p> <p>yaml is intended for cedarling internal use only.</p> <p>The rationale is that yaml has excellent support for embedded, indented, multiline string values. That is far easier to read than base64 encoded json strings, and is beneficial for debugging and validation that test cases are correct.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","policy store"]},{"location":"cedarling/reference/cedarling-principal-boolean-operations/","title":"User-Workload Boolean Operation","text":"<p>The <code>CEDARLING_PRINCIPAL_BOOLEAN_OPERATION</code> property specifies what boolean operation to use when combining authorization decisions for <code>USER</code> and <code>WORKLOAD</code> principals. This JSON Logic rule determines the final authorization outcome based on individual principal decisions.</p> <p>We use JsonLogic to define the boolean operation. The rule is evaluated against each principal decision, and the final result is determined based on the specified operation.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","boolean","operations"]},{"location":"cedarling/reference/cedarling-principal-boolean-operations/#variables-in-the-jsonlogic-rule","title":"Variables in the jsonlogic rule","text":"<p>Make sure that you use correct <code>var</code> name for <code>principal</code> types.</p> <p>When referencing principals in your JSON logic rules, you must use the full Cedar principal type identifier that includes namespace, entity name and optionally the entity ID. This matches exactly how principals are defined in your Cedar policies.</p> <p>Correct Format: <code>&lt;Namespace&gt;::&lt;EntityType&gt;</code> or <code>&lt;Namespace&gt;::&lt;EntityType&gt;::\"&lt;EntityID&gt;\"</code> Examples:</p> <ul> <li>Without ID: <code>Jans::User</code>, <code>Jans::Workload</code>, <code>Acme::Service</code></li> <li>With ID: <code>Jans::User::\"john_doe\"</code>, <code>Jans::Device::\"mobile_1234\"</code>, <code>Acme::Service::\"api_gateway\"</code>.  </li> </ul> <p>Notice: Make sure to correctly escape <code>\"</code> in JSON strings. For example <code>\"Acme::Service::\\\"api_gateway\\\"\"</code>.</p> <p>Why This Matters</p> <ul> <li>Matches Cedar's type system requirements</li> <li>Ensures proper variable resolution</li> <li>Maintains consistency with policy definitions</li> </ul> <p>Example Configuration</p> <pre><code>// CORRECT - Full type with namespace\n{\n    \"or\": [\n        {\"===\": [{\"var\": \"Jans::Workload\"}, \"ALLOW\"]},\n        {\"===\": [{\"var\": \"Jans::User\"}, \"ALLOW\"]}\n    ]\n}\n\n// INCORRECT - Missing namespace\n{\n    \"or\": [\n        {\"===\": [{\"var\": \"Workload\"}, \"ALLOW\"]}, // Will not resolve\n        {\"===\": [{\"var\": \"User\"}, \"ALLOW\"]}      // Will not resolve\n    ]\n}\n</code></pre> <p>Consequences of Incorrect Format - Authorization will fail with DENY - Potential evaluation errors in JSON logic - Mismatches with actual Cedar policy definitions</p>","tags":["administration","authorization / authz","Cedar","Cedarling","boolean","operations"]},{"location":"cedarling/reference/cedarling-principal-boolean-operations/#default-configuration","title":"Default configuration","text":"<p>Default value:</p> <pre><code>{\n    \"and\" : [\n        {\"===\": [{\"var\": \"Jans::Workload\"}, \"ALLOW\"]},\n        {\"===\": [{\"var\": \"Jans::User\"}, \"ALLOW\"]}\n    ]\n}\n</code></pre> <p>Explanation:</p> <ul> <li>The rule uses and to require both principals to be authorized</li> <li><code>{\"var\": \"Jans::Workload\"}</code> checks the workload principal's decision</li> <li><code>{\"var\": \"Jans::User\"}</code> checks the user principal's decision</li> <li><code>\"===\"</code> performs strict equality comparison against \"ALLOW\"</li> <li>both conditions must be true for final authorization to be granted</li> </ul>","tags":["administration","authorization / authz","Cedar","Cedarling","boolean","operations"]},{"location":"cedarling/reference/cedarling-principal-boolean-operations/#comparison-operators","title":"Comparison Operators","text":"<ul> <li>=== (Recommended): Strict equality check (type and value must match)</li> <li>==: Loose equality check (may cause type coercion errors if variables are missing)</li> </ul> <p>Note: For comparison better to use <code>===</code> instead of <code>==</code>. To avoid casting result to <code>Nan</code> if something goes wrong.</p>","tags":["administration","authorization / authz","Cedar","Cedarling","boolean","operations"]},{"location":"cedarling/reference/cedarling-principal-boolean-operations/#operation-types","title":"Operation Types","text":"","tags":["administration","authorization / authz","Cedar","Cedarling","boolean","operations"]},{"location":"cedarling/reference/cedarling-principal-boolean-operations/#and-operation","title":"AND Operation","text":"<pre><code>{\"and\": [condition1, condition2]}\n</code></pre> <ul> <li>Authorization succeeds only if ALL conditions are true</li> </ul> <p>Example:</p> <pre><code>{\n    \"and\" : [\n        {\"===\": [{\"var\": \"Jans::Workload\"}, \"ALLOW\"]},\n        {\"===\": [{\"var\": \"Jans::User\"}, \"ALLOW\"]}\n    ]\n}\n</code></pre>","tags":["administration","authorization / authz","Cedar","Cedarling","boolean","operations"]},{"location":"cedarling/reference/cedarling-principal-boolean-operations/#or-operation","title":"OR Operation","text":"<pre><code>{\"or\": [condition1, condition2]}\n</code></pre> <ul> <li>Authorization succeeds if ANY condition is true</li> </ul> <p>Example:</p> <pre><code>{\n    \"or\" : [\n        {\"===\": [{\"var\": \"Jans::Workload\"}, \"ALLOW\"]},\n        {\"===\": [{\"var\": \"Jans::User\"}, \"ALLOW\"]}\n    ]\n}\n</code></pre>","tags":["administration","authorization / authz","Cedar","Cedarling","boolean","operations"]},{"location":"cedarling/reference/cedarling-principal-boolean-operations/#best-practices","title":"Best Practices","text":"<ol> <li>Use Strict Comparison (===)</li> <li>Prevents unexpected type conversions</li> <li>Returns DENY instead of errors when variables are missing</li> <li> <p>Explicit Principal References</p> <pre><code>// Good - explicit principal type\n{\"===\": [{\"var\": \"Jans::Workload\"}, \"ALLOW\"]}\n\n// Bad - incorrect principal type\n{\"===\": [{\"var\": \"Workload\"}, \"ALLOW\"]}\n</code></pre> </li> </ol>","tags":["administration","authorization / authz","Cedar","Cedarling","boolean","operations"]},{"location":"cedarling/reference/cedarling-principal-boolean-operations/#error-scenarios","title":"Error Scenarios","text":"<ul> <li>Using == with missing principals:</li> </ul> <pre><code>{\"==\": [{\"var\": \"MissingPrincipal\"}, \"ALLOW\"]}  // Throws error\n</code></pre> <ul> <li>Type mismatches:</li> </ul> <pre><code>{\"===\": [{\"var\": \"Jans::Workload\"}, true]}  // Always false\n</code></pre>","tags":["administration","authorization / authz","Cedar","Cedarling","boolean","operations"]},{"location":"cedarling/reference/cedarling-properties/","title":"Cedarling Properties","text":"<p>These Bootstrap Properties control default application level behavior.</p>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","properties"]},{"location":"cedarling/reference/cedarling-properties/#required-properties-for-startup","title":"Required properties for startup","text":"<ul> <li><code>CEDARLING_APPLICATION_NAME</code> : Human friendly identifier for this Cedarling instance.</li> </ul> <p>To enable usage of principals at least one of the following keys must be provided:</p> <ul> <li> <p><code>CEDARLING_WORKLOAD_AUTHZ</code> : When <code>enabled</code>, Cedar engine authorization is queried for a Workload principal.</p> </li> <li> <p><code>CEDARLING_USER_AUTHZ</code> : When <code>enabled</code>, Cedar engine authorization is queried for a User principal.</p> </li> </ul> <p>To load policy store one of the following keys must be provided:</p> <ul> <li> <p><code>CEDARLING_POLICY_STORE_LOCAL</code> : JSON object as string with policy store. You can use this converter.</p> </li> <li> <p><code>CEDARLING_POLICY_STORE_URI</code> : URL to fetch policy store from. Cedarling automatically detects the format:</p> </li> <li>URLs ending in <code>.cjar</code> \u2192 loads as Cedar Archive</li> <li> <p>Other URLs \u2192 loads as legacy JSON from Lock Server</p> </li> <li> <p><code>CEDARLING_POLICY_STORE_LOCAL_FN</code> : Path to local policy store. Cedarling automatically detects the format:</p> </li> <li>Directories \u2192 loads as directory-based policy store</li> <li><code>.cjar</code> files \u2192 loads as Cedar Archive</li> <li><code>.json</code> files \u2192 loads as JSON</li> <li><code>.yaml</code>/<code>.yml</code> files \u2192 loads as YAML</li> </ul> <p>New Directory-Based Format (Native platforms only):</p> <p>Cedarling now supports a directory-based policy store format with human-readable Cedar files. See Policy Store Formats for details.</p> <p>Note: In WASM environments, only <code>CEDARLING_POLICY_STORE_URI</code> and <code>CEDARLING_POLICY_STORE_LOCAL</code> are available. File and directory sources (<code>CEDARLING_POLICY_STORE_LOCAL_FN</code>) are not supported in WASM due to lack of filesystem access.</p> <p>Note</p> <p>All other fields are optional and can be omitted. If a field is not provided, Cedarling will use the default value specified in the property definition.</p> <p>Auxilliary properties</p> <ul> <li> <p><code>CEDARLING_POLICY_STORE_ID</code> : The identifier of the policy store in case there is more than one policy_store_id in the policy store.</p> </li> <li> <p><code>CEDARLING_PRINCIPAL_BOOLEAN_OPERATION</code> : property specifies whether to authorize the <code>USER</code>, <code>WORKLOAD</code> or both when making authorization decisions.   Use <code>\"===\": [{\"var\": \"Jans::User\"}, \"ALLOW\"]</code> if you only want user authorization. Use <code>\"===\": [{\"var\": \"Jans::Workload\"}, \"ALLOW\"]</code> if you only want workload authorization. See here if you want anything more complicated.</p> </li> <li> <p><code>CEDARLING_TOKEN_CACHE_MAX_TTL</code> : Allows to limit maximum token cache TTL in seconds. (Token cache is used to avoid decoding and validation same token twice, so it is optimization.) Default value is zero what means disable maximum TTL and will be used <code>exp</code> token field to calculate TTL.</p> </li> <li> <p><code>CEDARLING_TOKEN_CACHE_CAPACITY</code> : Maximum number of tokens the cache can store. Default value is 100. 0 means no limit.</p> </li> <li> <p><code>CEDARLING_TOKEN_CACHE_EARLIEST_EXPIRATION_EVICTION</code> : Enables eviction policy based on the earliest expiration time. When the cache reaches its capacity, the entry with the nearest expiration timestamp will be removed to make room for a new one. Default value is <code>true</code>.</p> </li> </ul> <p>Cedar Entity Mapping properties</p> <ul> <li><code>CEDARLING_MAPPING_USER</code> : Name of Cedar User schema entity if we don't want to use default. When specified Cedarling try build defined entity (from schema) as user instead of default <code>User</code> entity defined in <code>cedar</code> schema. Works in namespace defined in the policy store. Default value: <code>Jans::User</code>.</li> <li><code>CEDARLING_MAPPING_WORKLOAD</code> : Name of Cedar Workload schema entity. Default value: <code>Jans::Workload</code>.</li> <li><code>CEDARLING_MAPPING_ROLE</code> : Name of Cedar Role schema entity. Default value: <code>Jans::Role</code>.</li> <li><code>CEDARLING_UNSIGNED_ROLE_ID_SRC</code> : The attribute that will be used to create the Role entity when using the unsigned interface. Defaults to <code>\"role\"</code>.</li> <li><code>CEDARLING_MAPPING_TRUSTED_ISSUER</code> : Mapping name of cedar schema TrustedIssuer entity. Default value: <code>Jans::TrustedIssuer</code>.</li> </ul> <p>The following bootstrap properties are needed to configure log behavior:</p> <ul> <li><code>CEDARLING_LOG_TYPE</code> : <code>off</code>, <code>memory</code>, <code>std_out</code></li> <li><code>CEDARLING_LOG_LEVEL</code> : System Log Level See here. Default to <code>WARN</code></li> <li><code>CEDARLING_DECISION_LOG_USER_CLAIMS</code> : List of claims to map from user entity, such as [\"sub\", \"email\", \"username\", ...]</li> <li><code>CEDARLING_DECISION_LOG_WORKLOAD_CLAIMS</code> : List of claims to map from workload entity, such as [\"client_id\", \"rp_id\", ...]</li> <li><code>CEDARLING_DECISION_LOG_DEFAULT_JWT_ID</code> : Token claims that will be used for decision logging. Default is \"jti\", but perhaps some other claim is needed.</li> <li><code>CEDARLING_LOG_TTL</code> : in case of <code>memory</code> store, TTL (time to live) of log entities in seconds.</li> <li><code>CEDARLING_LOG_MAX_ITEMS</code> : Maximum number of log entities that can be stored using Memory logger. If used <code>0</code> value means no limit. And If missed or None, default value is applied.</li> <li><code>CEDARLING_LOG_MAX_ITEM_SIZE</code> : Maximum size of a single log entity in bytes using Memory logger. If used <code>0</code> value means no limit. And If missed or None, default value is applied.</li> <li><code>CEDARLING_STDOUT_MODE</code> : Logging mode for stdout logger: <code>async</code> or <code>immediate</code> (default). Only applicable for native targets (not WASM). Defaults to <code>immediate</code>.</li> <li><code>CEDARLING_STDOUT_TIMEOUT_MILLIS</code> : Flush timeout in milliseconds for async stdout logging. Only applicable for native targets (not WASM). Defaults to 100 ms.</li> <li><code>CEDARLING_STDOUT_BUFFER_LIMIT</code> : Buffer size limit in bytes for async stdout logging. Only applicable for native targets (not WASM). Defaults to 1 MB (2^20 bytes).</li> </ul> <p>The following bootstrap properties are needed to configure JWT and cryptographic behavior:</p> <ul> <li> <p><code>CEDARLING_LOCAL_JWKS</code> : Path to a local file containing a JWKS</p> </li> <li> <p><code>CEDARLING_JWT_SIG_VALIDATION</code> : <code>enabled</code> | <code>disabled</code> -- Whether to check the signature of all JWT tokens. This requires an <code>iss</code> is present.</p> </li> <li><code>CEDARLING_JWT_STATUS_VALIDATION</code> : <code>enabled</code> | <code>disabled</code> -- Whether to check the status of the JWT. On startup, the Cedarling should fetch and retreive the latest Status List JWT from the <code>.well-known/openid-configuration</code> via the <code>status_list_endpoint</code> claim and cache it. See the IETF Draft for more info.</li> <li><code>CEDARLING_JWT_SIGNATURE_ALGORITHMS_SUPPORTED</code> : Only tokens signed with these algorithms are acceptable to the Cedarling.</li> <li> <p><code>CEDARLING_ID_TOKEN_TRUST_MODE</code> : <code>strict</code> | <code>never</code> | <code>always</code> | <code>ifpresent</code>. Varying levels of validations based on the preference of the developer.</p> </li> <li> <p><code>strict</code> (default): Enforces strict validation rules:</p> <ul> <li>ID token <code>aud</code> must contain the access token <code>client_id</code> (the <code>aud</code> field is an array that must contain the <code>client_id</code>)</li> <li>If userinfo token is present, its <code>sub</code> must match the ID token <code>sub</code></li> </ul> </li> <li><code>never</code>: Disables ID token validation entirely (useful for testing)</li> <li><code>always</code>: Always validates ID tokens when present (less strict than <code>strict</code> mode) - Not yet implemented</li> <li><code>ifpresent</code>: Validates ID tokens only if they are provided - Not yet implemented</li> </ul> <p>The following bootstrap properties are for advanced configuration:</p> <ul> <li><code>CEDARLING_MAX_BASE64_SIZE</code> : Maximum size in bytes for Base64-encoded content (policies, schema, etc.)</li> <li><code>CEDARLING_MAX_DEFAULT_ENTITIES</code> : Maximum number of default entities that can be loaded from the policy store.</li> </ul> <p>The following bootstrap properties are needed to configure the Context Data API:</p> <ul> <li> <p><code>CEDARLING_DATA_STORE_MAX_ENTRIES</code> : Maximum number of entries that can be stored in the data store. Default value is <code>10000</code>. Set to <code>0</code> for unlimited entries.</p> </li> <li> <p><code>CEDARLING_DATA_STORE_MAX_ENTRY_SIZE</code> : Maximum size per entry in bytes. Default value is <code>1048576</code> (1 MB). Set to <code>0</code> for unlimited size.</p> </li> <li> <p><code>CEDARLING_DATA_STORE_DEFAULT_TTL</code> : Default TTL (Time To Live) in seconds for entries that don't specify a TTL. Default value is <code>None</code> (entries will not expire). When set, entries without an explicit TTL will use this value.</p> </li> <li> <p><code>CEDARLING_DATA_STORE_MAX_TTL</code> : Maximum allowed TTL in seconds. Default value is <code>3600</code> (1 hour). Entries with TTL exceeding this value will be rejected. Omit this property for unlimited TTL.</p> </li> <li> <p><code>CEDARLING_DATA_STORE_ENABLE_METRICS</code> : Whether to enable metrics tracking for data entries (access counts, etc.). Default value is <code>true</code>.</p> </li> <li> <p><code>CEDARLING_DATA_STORE_MEMORY_ALERT_THRESHOLD</code> : Memory usage threshold percentage (0.0-100.0) for triggering alerts. Default value is <code>80.0</code>. When capacity usage exceeds this threshold, <code>memory_alert_triggered</code> will be <code>true</code> in statistics.</p> </li> </ul> <p>The following bootstrap properties are only needed for the Lock Server Integration.</p> <ul> <li><code>CEDARLING_LOCK</code> : <code>enabled</code> | <code>disabled</code>. If <code>enabled</code>, the Cedarling will connect to the Lock Server for policies, and subscribe for SSE events.</li> <li><code>CEDARLING_LOCK_SERVER_CONFIGURATION_URI</code> : Required if <code>LOCK</code> == <code>enabled</code>. URI where Cedarling can get JSON file with all required metadata about the Lock Server, i.e. <code>.well-known/lock-master-configuration</code>.</li> <li><code>CEDARLING_LOCK_DYNAMIC_CONFIGURATION</code> : <code>enabled</code> | <code>disabled</code>, controls whether Cedarling should listen for SSE config updates.</li> <li><code>CEDARLING_LOCK_SSA_JWT</code> : SSA for DCR in a Lock Server deployment. The Cedarling will validate this SSA JWT prior to DCR.</li> <li><code>CEDARLING_LOCK_LOG_INTERVAL</code> : How often to send log messages to Lock Server (0 to turn off transmission).</li> <li><code>CEDARLING_LOCK_HEALTH_INTERVAL</code> : How often to send health messages to Lock Server (0 to turn off transmission).</li> <li><code>CEDARLING_LOCK_TELEMETRY_INTERVAL</code> : How often to send telemetry messages to Lock Server (0 to turn off transmission).</li> <li><code>CEDARLING_LOCK_LISTEN_SSE</code> : <code>enabled</code> | <code>disabled</code>: controls whether Cedarling should listen for updates from the Lock Server.</li> <li><code>CEDARLING_LOCK_ACCEPT_INVALID_CERTS</code> : <code>enabled</code> | <code>disabled</code>: Allows interaction with a Lock server with invalid certificates. Mainly used for testing. Doesn't work for WASM builds.</li> </ul>","tags":["administration","lock","authorization / authz","Cedar","Cedarling","properties"]},{"location":"cedarling/reference/cedarling-terms/","title":"Cedarling Terms","text":"","tags":["administration","cedarling","intro","terms"]},{"location":"cedarling/reference/cedarling-terms/#policy-store","title":"Policy Store","text":"<p>A policy store is a JSON encoded file that contains information for the Cedarling's functions. Agama Lab can be used to easily create policy stores. Further information on policy stores can be found here</p>","tags":["administration","cedarling","intro","terms"]},{"location":"cedarling/reference/cedarling-terms/#schema","title":"Schema","text":"<p>A schema is a declaration of the structure of the entity types that you want to support in your application and for which you want Cedar to provide authorization services. For example, an application acting as a gateway to filter HTTP requests may use a schema with structural definitions for requests, tokens, and any other information required to make decisions. A schema may be human-readable or JSON formatted. Schemas created by Agama Lab are JSON formatted and base64-encoded by default. The schemas provided in this document are human-readable for convenience.</p> <p>Further reading: Cedar Schema Reference</p> <p>Cedarling comes with a default schema which contains a namespace called <code>Jans</code> and includes many entities representing common OpenID connect concepts.</p>","tags":["administration","cedarling","intro","terms"]},{"location":"cedarling/reference/cedarling-terms/#entity","title":"Entity","text":"<p>An entity in Cedar is a stored object that serves as the representation for principals, actions, and resources that are part of your application. In OpenID terminology, an entity can represent a user, a token, an application, or an HTTP Request. Entities are represented as JSON objects in Cedarling. Each entity in Cedarling has at least the following properties:</p> <ul> <li><code>type</code>: The name of this entity type, as specified in the schema.</li> <li><code>id</code>: A unique identifier for the entity.</li> <li>Any additional attributes for this entity type as defined in the schema</li> </ul> <p>Continuing the gateway example, the schema may have a definition for an HTTP Request:</p> <pre><code>entity HTTP_Request = {\n    \"header\": {\n    \"Accept\"?: String\n    }, \n};\n</code></pre> <p>And Cedarling would create an <code>HTTP_Request</code> entity like so:</p> <pre><code>{\n    \"entity_type\": \"HTTP_Request\",\n    \"id\": \"1\",\n    \"header\": {\n        \"Accept\": \"application/json\"\n    }\n}\n</code></pre> <p>Cedarling creates a number of entities based on the input provided, which are described below.</p>","tags":["administration","cedarling","intro","terms"]},{"location":"cedarling/reference/cedarling-terms/#principal","title":"Principal","text":"<p>The principal element in a Cedar policy represents a user, service, or other identity that can make a request to perform an action on a resource in your application. The principal entity in Cedarling is an object that is evaluated against the principal element in a cedar policy. As Cedarling is primarily concerned with OpenID Connect flows, the principal entity is generally created from the three standard OpenID tokens: Access, ID, and Userinfo. Based on these tokens, Cedarling creates a principal entity that falls into one of these categories:</p> <ul> <li>Workload: When only the access token is provided. This represents an OAuth client.</li> <li>User: When at least two tokens are provided. This represents an end user attempting to be authorized.</li> <li>Role: As per cedar best practices, a role in Cedarling is defined as a group of user or workload entities with no additional attributes. This allows us to create role based access control (RBAC) policies which are more performant than attribute based access control. The default schema provides definition for <code>Role</code> and Cedarling automatically creates the <code>Role</code> entity if this claim is present in one or more tokens.</li> </ul> <p>In case no token is provided or the use case is not based on OpenID, Cedarling supports unsigned authorization, where the principal entity is manually provided by the user in the form of a list of JSON objects.</p> <p>For example, given a schema defining a user:</p> <p><pre><code>entity HTTP_Request = {\n    \"sub\": String,\n    \"role\": Set&lt;String&gt;,\n};\n</code></pre> We can create a User entity: <pre><code>[\n  {\n    \"type\": \"User\",\n    \"id\": \"some_id\",\n    \"sub\": \"some_sub\",\n    \"role\": [\"admin\"]\n  }\n]\n</code></pre></p>","tags":["administration","cedarling","intro","terms"]},{"location":"cedarling/reference/cedarling-terms/#action","title":"Action","text":"<p>The action element in a Cedar policy is a list of the operations in your application for which this policy statement controls access. Action is different from other entities in that only the name of the action and the namespace where it is located is sufficient to create this entity, as the rest are handled by Cedarling. Therefore:</p> <p>Given a schema with the namespace <code>Jans</code> and an action representing a GET request:</p> <pre><code>namespace Jans {\n    action GET appliesTo {\n      principal: [Workload],\n    };\n}\n</code></pre> <p>The input to create the Action entity is this string: <code>Jans::Action::\"GET\"</code></p>","tags":["administration","cedarling","intro","terms"]},{"location":"cedarling/reference/cedarling-terms/#resource","title":"Resource","text":"<p>The resource element in a Cedar policy is a resource defined by your application that can be accessed or modified by the specified action. For Cedarling, the Resource entity is the object on which the Principal performs the Action. For example, a Workload entity (Principal) performing a GET request (Action) on an HTTP endpoint (Resource). The Resource entity must be created by providing JSON input as defined in the schema.</p> <p>Given the schema for an <code>HTTP_Request</code> resource:</p> <pre><code>entity HTTP_Request = {\n    \"header\": {\n    \"Accept\"?: String\n    }, \n};\n</code></pre> <p>We create the resource entity:</p> <pre><code>{\n    \"entity_type\": \"HTTP_Request\",\n    \"id\": \"1\",\n    \"header\": {\n        \"Accept\": \"application/json\"\n    }\n}\n</code></pre>","tags":["administration","cedarling","intro","terms"]},{"location":"cedarling/reference/cedarling-terms/#context","title":"Context","text":"<p>The context input parameter is used to provide details specific to a request, such as the date and time the request was sent, the IP address the request originated from, or whether the user was authenticated using a multi-factor authentication device. For Cedarling, the Context is optional and <code>null</code> or its equivalents may be passed in case there is no such value. Similar to Action, the <code>type</code> and <code>id</code> are not needed to construct Context and the rest is passed as JSON according to the schema.</p> <p>Given the schema definition:</p> <pre><code>type Context = {\n    network?: String,\n    network_type?: String,\n    user_agent?: String,\n    operating_system?: String,\n    device_health?: Set&lt;String&gt;,\n    current_time?: Long,\n    geolocation?: Set&lt;String&gt;,\n    fraud_indicators?: Set&lt;String&gt;,\n};\n</code></pre> <p>The Context is constructed:</p> <pre><code>{\n    \"current_time\": int(time.time()),\n    \"device_health\": [\"Healthy\"],\n    \"fraud_indicators\": [\"Allowed\"],\n    \"geolocation\": [\"America\"],\n    \"network\": \"127.0.0.1\",\n    \"network_type\": \"Local\",\n    \"operating_system\": \"Linux\",\n    \"user_agent\": \"Linux\"\n}\n</code></pre>","tags":["administration","cedarling","intro","terms"]},{"location":"cedarling/reference/cedarling-terms/#jwt-entities","title":"JWT entities","text":"<p>When performing signed authorization (one or more OpenID tokens are provided) and when token definitions are available in the schema, Cedarling creates an entity corresponding to each type of token and adds them to the User or Workload entities. These entities can then be referred to during policy creation.</p> <p>For example, given an access token, the workload will have the access token entity. Thus we can refer to it in a policy:</p> <pre><code>permit(\n  principal is Jans::Workload,\n  action,\n  resource\n)\nwhen {\n    principal has access_token.scope &amp;&amp;\n    principal.access_token.scope.contains(\"profile\")\n};\n</code></pre>","tags":["administration","cedarling","intro","terms"]},{"location":"cedarling/tutorials/cedarling-getting-started/","title":"Getting Started with Cedarling","text":"<p>Cedarling is a lightweight, embeddable Policy Decision Point (PDP) that enables fast, fine-grained, and decentralized access control across modern applications. Built on the Rust-based Cedar engine, Cedarling is designed for both client-side and server-side use, supporting environments like browsers, mobile apps, cloud-native services, and API gateways.</p> <p>Cedarling supports both Token-Based Access Control (TBAC) using JWTs and unsigned authorization requests. In both cases, it enforces policies locally for low-latency and consistent Zero Trust security.</p> <p>You can integrate Cedarling into your application using the following language libraries:</p> <ul> <li>JavaScript</li> <li>Python</li> <li>Rust</li> <li>Kotlin</li> <li>Swift</li> <li>Golang</li> <li>Java</li> </ul> <p>Alternatively, you can use the Cedarling Sidecar for a drop-in deployment.</p> <p>From here, you can either jump directly to the language-specific examples above or continue reading for a high-level overview of how Cedarling works.</p>","tags":["cedar","cedarling","getting-started"]},{"location":"cedarling/tutorials/cedarling-getting-started/#cedarling-interfaces","title":"Cedarling Interfaces","text":"<p>The main way you will interact with Cedarling are through the following interfaces</p> <ul> <li>Initialization</li> <li>Authorization</li> <li>Context Data API</li> <li>Logging</li> </ul>","tags":["cedar","cedarling","getting-started"]},{"location":"cedarling/tutorials/cedarling-getting-started/#initialization","title":"Initialization","text":"<p>The initialization or <code>init</code> interface is how you will initialize Cedarling. Initialization involves loading:</p> <p>Bootstrap Configuration</p> <ul> <li>A set of properties that will tells how Cedarling behaves within your application.</li> <li>Learn more in the bootstrap properties guide.</li> </ul> <p>Policy Store</p> <ul> <li>A JSON file containing the schema, policies, trusted issuers, and token metadata schema used for making authorization decisions.</li> <li>Learn more in the policy store guide.</li> </ul> <p>The bootstrap configuration and policy store directly influence how Cedarling performs authorization.</p> JavaScriptPythonRustKotlinSwiftGoJava <pre><code>import initWasm, { init } from \"/pkg/cedarling_wasm.js\";\n\nlet cedarling = await init({});\n</code></pre> <pre><code>cedarling = Cedarling(BootstrapConfig.load_from_file(\n  \"./bootstrap_props.json\"\n))\n</code></pre> <pre><code>let cedarling = Cedarling::new(&amp;BootstrapConfig::from_env().unwrap());\n</code></pre> <pre><code>// Assigning a multi-line JSON string representing the Bootstrap configuration for Cedarling\nval bootstrapConfig: String = \"\"\"\n    {\n        \"CEDARLING_APPLICATION_NAME\": \"My App\",\n    ...\n    }\n\"\"\";\n\nval cedarling: Cedarling? = Cedarling.loadFromJson(bootstrapConfig);\n</code></pre> <pre><code>// Assigning a multi-line JSON string representing the Bootstrap configuration for Cedarling\nlet bootstrapConfig: String = \"\"\"\n    {\n        \"CEDARLING_APPLICATION_NAME\": \"My App\",\n    ...\n    }\n\"\"\"\n\nlet cedarling = try Cedarling.loadFromJson(config: bootstrapConfig)\n</code></pre> <pre><code>config := map[string]any{\n    \"CEDARLING_APPLICATION_NAME\": \"My App\",\n}\ninstance, err := cedarling_go.NewCedarling(config)\nif err != nil {\n    panic!(\"Error during init: %s\", err)\n}\n</code></pre> <pre><code>import uniffi.cedarling_uniffi.*;\n...\n /*\n* In a production environment, the bootstrap configuration should not be hardcoded.\n* Instead, it should be loaded dynamically from external sources such as environment variables,\n* configuration files, or a centralized configuration service.\n*/\nString bootstrapJsonStr = \"\"\"\n    {\n        \"CEDARLING_APPLICATION_NAME\":   \"MyApp\",\n        ...\n    }\n\"\"\";\n\ntry {\n    CedarlingAdapter cedarlingAdapter = new CedarlingAdapter();\n    cedarlingAdapter.loadFromJson(bootstrapJsonStr);\n} catch (CedarlingException e) {\n    System.out.println(\"Unable to initialize Cedarling\" + e.getMessage());\n} catch (Exception e) {\n    System.out.println(\"Unable to initialize Cedarling\" + e.getMessage());\n}\n</code></pre>","tags":["cedar","cedarling","getting-started"]},{"location":"cedarling/tutorials/cedarling-getting-started/#authorization","title":"Authorization","text":"<p>The authorization, or <code>authz</code>, interface is used to evaluate access control decisions by answering the question:</p> <p>Is this Action, on this Resource, in this Context, allowed for these Principals?</p> <p>When using Cedarling, Action and Resource are typically defined in the policy store, while Principal and Context are supplied at runtime via the <code>authz</code> interface.</p> <p>Cedarling currently provides two modes of authorization:</p> <p>Standard (Token-based) Interface</p> <ul> <li>Extracts the Principal from a JWT.</li> <li>Accepts the Context as a structured map.</li> </ul> JavaScriptPythonRustKotlinSwiftGoJava <pre><code>const tokens = {\n  access_token: \"&lt;access_token&gt;\",\n  id_token: \"&lt;id_token&gt;\",\n  userinfo_token: \"&lt;userinfo_token&gt;\",\n};\n\nconst action = 'Jans::Action::\"Read\"';\n\nconst resource = {\n  cedar_entity_mapping: {\n    entity_type: \"Jans::Application\",\n    id: \"app_id_001\"\n  },\n  name: \"Some Application\",\n  url: {\n    host: \"example.com\",\n    path: \"/admin-dashboard\",\n    protocol: \"https\",\n  },\n};\n\nconst context = {\n  current_time: Date.now(),\n  device_health: [\"Healthy\"],\n  fraud_indicators: [\"Allowed\"],\n  geolocation: [\"America\"],\n  network: \"127.0.0.1\",\n  network_type: \"Local\",\n  operating_system: \"Linux\",\n};\n\nconst result = await cedarling.authorize({\n  tokens,\n  action,\n  resource,\n  context,\n});\n</code></pre> <pre><code>import time\n\ntokens = {\n    \"access_token\": \"&lt;access_token&gt;\",\n    \"id_token\": \"&lt;id_token&gt;\",\n    \"userinfo_token\": \"&lt;userinfo_token&gt;\"\n}\n\naction = 'Jans::Action::\"Read\"'\n\nresource = {\n    \"cedar_entity_mapping\": {\n        \"entity_type\": \"Jans::Application\",\n        \"id\": \"app_id_001\"\n    },\n    \"name\": \"Some Application\",\n    \"url\": {\n        \"host\": \"example.com\",\n        \"path\": \"/admin-dashboard\",\n        \"protocol\": \"https\"\n    }\n}\n\ncontext = {\n    \"current_time\": int(time.time() * 1000),\n    \"device_health\": [\"Healthy\"],\n    \"fraud_indicators\": [\"Allowed\"],\n    \"geolocation\": [\"America\"],\n    \"network\": \"127.0.0.1\",\n    \"network_type\": \"Local\",\n    \"operating_system\": \"Linux\",\n}\n\nresult = cedarling.authorize(Request(\n    tokens,\n    action,\n    resource,\n    context,\n))\n</code></pre> <pre><code>use std::collections::HashMap;\nuse chrono::Utc;\nuse serde_json::json;\n\nlet tokens = HashMap::from([\n    (\"access_token\".to_string(), \"&lt;access_token&gt;\".to_string()),\n    (\"id_token\".to_string(), \"&lt;id_token&gt;\".to_string()),\n    (\"userinfo_token\".to_string(), \"&lt;userinfo_token&gt;\".to_string()),\n]);\n\nlet action = \"Jans::Action::\\\"Read\\\"\".to_string();\n\nlet resource = json!({\n    \"cedar_entity_mapping\": {\n        \"entity_type\": \"Jans::Application\",\n        \"id\": \"app_id_001\"\n    },\n    \"name\": \"Some Application\",\n    \"url\": {\n        \"host\": \"example.com\",\n        \"path\": \"/admin-dashboard\",\n        \"protocol\": \"https\"\n    }\n});\n\nlet context = json!({\n    \"current_time\": Utc::now().timestamp_millis(),\n    \"device_health\": [\"Healthy\"],\n    \"fraud_indicators\": [\"Allowed\"],\n    \"geolocation\": [\"America\"],\n    \"network\": \"127.0.0.1\",\n    \"network_type\": \"Local\",\n    \"operating_system\": \"Linux\",\n});\n\nlet result = cedarling.authorize(Request {\n    tokens,\n    action,\n    resource,\n    context,\n});\n</code></pre> <pre><code>val tokens = mapOf(\n    \"access_token\" to \"&lt;access_token&gt;\",\n    \"id_token\" to \"&lt;id_token&gt;\",\n    \"userinfo_token\" to \"&lt;userinfo_token&gt;\"\n)\n\nval action = \"\"\"Jans::Action::\"Read\"\"\"\"\n\nval resource = mapOf(\n    \"cedar_entity_mapping\" to mapOf(\n        \"entity_type\" to \"Jans::Application\",\n        \"id\" to \"app_id_001\"\n    ),\n    \"name\" to \"Some Application\",\n    \"url\" to mapOf(\n        \"host\" to \"example.com\",\n        \"path\" to \"/admin-dashboard\",\n        \"protocol\" to \"https\"\n    )\n)\n\nval context = mapOf(\n    \"current_time\" to System.currentTimeMillis(),\n    \"device_health\" to listOf(\"Healthy\"),\n    \"fraud_indicators\" to listOf(\"Allowed\"),\n    \"geolocation\" to listOf(\"America\"),\n    \"network\" to \"127.0.0.1\",\n    \"network_type\" to \"Local\",\n    \"operating_system\" to \"Linux\"\n)\n\nval result = cedarling?.authorize(\n    tokens,\n    action,\n    resource[\"cedar_entity_mapping\"]?.get(\"entity_type\") as String,\n    resource[\"cedar_entity_mapping\"]?.get(\"id\") as String,\n    anyToJson(resource),\n    context\n)\n</code></pre> <pre><code>let tokens: [String: String] = [\n    \"access_token\": \"&lt;access_token&gt;\",\n    \"id_token\": \"&lt;id_token&gt;\",\n    \"userinfo_token\": \"&lt;userinfo_token&gt;\"\n]\n\nlet action = #\"Jans::Action::\"Read\"\"#\n\nlet resource: [String: Any] = [\n    \"cedar_entity_mapping\": [\n        \"entity_type\": \"Jans::Application\",\n        \"id\": \"app_id_001\"\n    ],\n    \"name\": \"Some Application\",\n    \"url\": [\n        \"host\": \"example.com\",\n        \"path\": \"/admin-dashboard\",\n        \"protocol\": \"https\"\n    ]\n]\n\nlet context: [String: Any] = [\n    \"current_time\": Int(Date().timeIntervalSince1970 * 1000),\n    \"device_health\": [\"Healthy\"],\n    \"fraud_indicators\": [\"Allowed\"],\n    \"geolocation\": [\"America\"],\n    \"network\": \"127.0.0.1\",\n    \"network_type\": \"Local\",\n    \"operating_system\": \"Linux\"\n]\n\nlet payloadJsonString = try JSONSerialization.data(\n    withJSONObject: resource,\n    options: []\n).toUtf8String()\n\nlet result: AuthorizeResult = try cedarling.authorize(\n    tokens: tokens,\n    action: action,\n    resourceType: resource[\"cedar_entity_mapping\"]?.get(\"entity_type\") as! String,\n    resourceId: resource[\"cedar_entity_mapping\"]?.get(\"id\") as! String,\n    payload: payloadJsonString,\n    context: context\n)\n</code></pre> <pre><code>tokens := map[string]string {\n    \"access_token\": \"&lt;access_token&gt;\",\n    \"id_token\": \"&lt;id_token&gt;\",\n    \"userinfo_token\": \"&lt;userinfo_token&gt;\"\n}\naction := \"Jans::Action::\\\"Read\\\"\"\nresource := cedarling_go.EntityData{\n    CedarMapping: cedarling_go.CedarMapping{\n        EntityType: \"Jans::Application\",\n        ID: \"app_id_001\",\n    },\n    Payload: map[string]any{\n        \"name\": \"Some Application\",\n        \"url\": map[string]string{\n            \"host\": \"example.com\",\n            \"path\": \"/admin-dashboard\",\n            \"protocol\": \"https\",\n        },\n    },\n}\ncontext := map[string]any{\n    \"current_time\": time.Now().Unix(),\n    \"device_health\": [\"Healthy\"],\n    \"fraud_indicators\": [\"Allowed\"],\n    \"geolocation\": [\"America\"],\n    \"network\": \"127.0.0.1\",\n    \"network_type\": \"Local\",\n    \"operating_system\": \"Linux\",\n}\nrequest := cedarling_go.Request{\n    Tokens: tokens,\n    Action: action,\n    Resource: resource,\n    Context: context,\n}\nresult, err := cedarling_instance.Authorize(request)\nif err != nil {\n    panic!(err)\n}\n</code></pre> <pre><code>String resource = \"\"\"\n    {\n      \"cedar_entity_mapping\": {\n        \"entity_type\": \"Jans::Application\",\n        \"id\": \"app_id_001\"\n      },\n      \"name\": \"Some Application\",\n      \"url\": {\n        \"host\": \"example.com\",\n        \"path\": \"/admin-dashboard\",\n        \"protocol\": \"https\"\n      }\n    }\n\"\"\";\n\nString action = \"Jans::Action::\\\"Update\\\"\";\n\nString context = \"\"\"\n    {\n      \"device_health\": [\"Healthy\"],\n      \"fraud_indicators\": [\"Allowed\"],\n      \"geolocation\": [\"America\"],\n      \"network\": \"127.0.0.1\",\n      \"network_type\": \"Local\",\n      \"operating_system\": \"Linux\",\n      \"user_agent\": \"Linux\"\n    }\n\"\"\";\n\nMap&lt;String, String&gt; tokens = Map.of(\n    \"access_token\", \"&lt;access_token&gt;\",\n    \"id_token\", \"&lt;id_token&gt;\",\n    \"userinfo_token\", \"&lt;userinfo_token&gt;\"\n);\n\n// Perform authorization\nAuthorizeResult result = adapter.authorize(tokens, action, new JSONObject(resource), new JSONObject(context));\nif(result.getDecision()) {\n    System.out.println(\"Access granted\");\n} else {\n    System.out.println(\"Access denied\");\n}\n</code></pre> <p>Unsigned Authorization</p> <ul> <li>Accepts the Principal directly without requiring a JWT.</li> <li>This makes authorization decisions by passing a set of Principals directly.</li> <li>Similar to the standard interface, the Context is passed in as-is in a map-like structure.</li> </ul> <p>Multi-Issuer Authorization</p> <ul> <li>Doesn't use principal and all token information is stored in context.</li> <li>This makes authorization decisions by rules based on context values (token payloads).</li> </ul> <p>More information</p>","tags":["cedar","cedarling","getting-started"]},{"location":"cedarling/tutorials/cedarling-getting-started/#context-data-api","title":"Context Data API","text":"<p>The Context Data API allows you to push external data into the Cedarling evaluation context, making it available in Cedar policies through the <code>context.data</code> namespace. This enables dynamic, runtime-based authorization decisions.</p> JavaScriptPythonRustKotlinSwiftGoJava <pre><code>// Push data with optional TTL (5 minutes = 300 seconds)\ncedarling.push_data_ctx(\"user:123\", {\n  role: [\"admin\", \"editor\"],\n  country: \"US\"\n}, 300);\n\n// Get data\nconst value = cedarling.get_data_ctx(\"user:123\");\nif (value) {\n  console.log(`User roles: ${value.role}`);\n}\n\n// Get statistics\nconst stats = cedarling.get_stats_ctx();\nconsole.log(`Entries: ${stats.entry_count}/${stats.max_entries}`);\n</code></pre> <pre><code># Push data with optional TTL (5 minutes = 300 seconds)\ncedarling.push_data_ctx(\"user:123\", {\n    \"role\": [\"admin\", \"editor\"],\n    \"country\": \"US\"\n}, ttl_secs=300)\n\n# Get data\nvalue = cedarling.get_data_ctx(\"user:123\")\nif value is not None:\n    print(f\"User roles: {value['role']}\")\n\n# Get statistics\nstats = cedarling.get_stats_ctx()\nprint(f\"Entries: {stats.entry_count}/{stats.max_entries}\")\n</code></pre> <pre><code>use std::time::Duration;\nuse serde_json::json;\n\n// Push data with optional TTL (5 minutes)\ncedarling.push_data_ctx(\n    \"user:123\",\n    json!({\n        \"role\": [\"admin\", \"editor\"],\n        \"country\": \"US\"\n    }),\n    Some(Duration::from_secs(300))\n)?;\n\n// Get data\nif let Some(value) = cedarling.get_data_ctx(\"user:123\")? {\n    println!(\"User roles: {:?}\", value[\"role\"]);\n}\n\n// Get statistics\nlet stats = cedarling.get_stats_ctx()?;\nprintln!(\"Entries: {}/{}\", stats.entry_count, stats.max_entries);\n</code></pre> <pre><code>// Push data with optional TTL (5 minutes = 300 seconds)\n// JsonValue is represented as String in Kotlin/JVM bindings\nval value = \"\"\"{\"role\":[\"admin\",\"editor\"],\"country\":\"US\"}\"\"\"\ncedarling.pushDataCtx(\"user:123\", value, 300L)\n\n// Get data\nval result = cedarling.getDataCtx(\"user:123\")\nif (result != null) {\n    // Parse and use the JSON string\n}\n\n// Get statistics\nval stats = cedarling.getStatsCtx()\nprintln(\"Entries: ${stats.entryCount}/${stats.maxEntries}\")\n</code></pre> <pre><code>// Push data with optional TTL (5 minutes = 300 seconds)\nlet value = JsonValue(value: \"{\\\"role\\\":[\\\"admin\\\",\\\"editor\\\"],\\\"country\\\":\\\"US\\\"}\")\ntry cedarling.pushDataCtx(key: \"user:123\", value: value, ttlSecs: 300)\n\n// Get data\nif let result = try cedarling.getDataCtx(key: \"user:123\") {\n    let jsonStr = result.inner()\n    // Parse and use the JSON string\n}\n\n// Get statistics\nlet stats = try cedarling.getStatsCtx()\nprint(\"Entries: \\(stats.entryCount)/\\(stats.maxEntries)\")\n</code></pre> <pre><code>package main\n\nimport \"time\"\n\nfunc main() {\n    // Push data with optional TTL (5 minutes)\n    userData := map[string]any{\n        \"role\":    []string{\"admin\", \"editor\"},\n        \"country\": \"US\",\n    }\n    ttl := 5 * time.Minute\n    err := instance.PushData(\"user:123\", userData, &amp;ttl)\n    if err != nil {\n        // Handle error\n    }\n\n// Get data\nvalue, err := instance.GetData(\"user:123\")\nif err != nil {\n    // Handle error\n}\nif value != nil {\n    // Use the value\n}\n\n// Get statistics\nstats, err := instance.GetStats()\nif err != nil {\n    // Handle error\n}\nfmt.Printf(\"Entries: %d/%d\\n\", stats.EntryCount, stats.MaxEntries)\n</code></pre> <pre><code>import uniffi.cedarling_uniffi.*;\n\n// Push data with optional TTL (5 minutes = 300 seconds)\n// In Java/Kotlin bindings, JsonValue is represented as a plain String\nString value = \"{\\\"role\\\":[\\\"admin\\\",\\\"editor\\\"],\\\"country\\\":\\\"US\\\"}\";\nCedarling cedarling = adapter.getCedarling();\ncedarling.pushDataCtx(\"user:123\", value, 300L);\n\n// Get data\nString result = cedarling.getDataCtx(\"user:123\");\nif (result != null) {\n    // Parse and use the JSON string\n    JSONObject data = new JSONObject(result);\n}\n\n// Get statistics\nDataStoreStats stats = cedarling.getStatsCtx();\nSystem.out.println(\"Entries: \" + stats.getEntryCount() + \"/\" + stats.getMaxEntries());\n</code></pre> <p>Data pushed via the Context Data API is automatically available in Cedar policies under the <code>context.data</code> namespace:</p> <pre><code>permit(\n    principal,\n    action == Action::\"read\",\n    resource\n) when {\n    context.data has \"user:123\" &amp;&amp;\n    context.data[\"user:123\"].role.contains(\"admin\")\n};\n</code></pre>","tags":["cedar","cedarling","getting-started"]},{"location":"cedarling/tutorials/cedarling-getting-started/#logging","title":"Logging","text":"<p>Cedarling supports logging of both decision and system events, useful for auditing and troubleshooting. Logging is optional and can be configured (or disabled) via the bootstrap properties.</p>","tags":["cedar","cedarling","getting-started"]},{"location":"cedarling/tutorials/cedarling-getting-started/#whats-next","title":"What's next?","text":"<p>You're now ready to dive deeper into Cedarling. From here, you could either:</p> <ul> <li>See how you can use RBAC with Cedarling using signed tokens.</li> <li>Explore how to use Cedarling's Unsigned interface.</li> <li>Use the Cedarling Sidecar for a quick, zero-code deployment.</li> <li>Learn more about why Cedarling exists and the problems it solves.  RBAC using signed tokens (TBAC)</li> </ul>","tags":["cedar","cedarling","getting-started"]},{"location":"cedarling/tutorials/go/","title":"Getting Started with Cedarling Go Bindings","text":"<p>Go bindings for the Jans Cedarling authorization engine, providing policy-based access control.</p>","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/go/#installation","title":"Installation","text":"","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/go/#build-with-dynamic-linking","title":"Build with dynamic linking","text":"<ol> <li> <p>Download the appropriate pre-built binary for your platform from the Jans releases page or build it from source as    described above.</p> </li> <li> <p>Specify linker flags in your main.go file to link against the Cedarling library.</p> <pre><code>// #cgo LDFLAGS: -L. -lcedarling_go\nimport \"C\"\n</code></pre> <p>And make sure that the Cedarling library files are located in the same directory as your main package.</p> </li> <li> <p>Use <code>go get</code> to fetch the Cedarling Go package</p> <pre><code>go get github.com/JanssenProject/jans/jans-cedarling/bindings/cedarling_go\n</code></pre> </li> <li> <p>Build your Go application</p> <pre><code>go build .\n</code></pre> </li> <li> <p>Run the application</p> <ul> <li> <p>Windows</p> <ul> <li>Place the Rust artifacts (<code>cedarling_go.dll</code> and <code>cedarling_go.lib</code>) alongside the Go binary.</li> <li>Windows searches libraries in directories below in the   following order<ol> <li>The directory containing your Go executable (recommended location)</li> <li>Windows system directories (e.g., <code>C:\\Windows\\System32</code>)</li> <li>The <code>PATH</code> environment variable directories</li> </ol> </li> </ul> </li> <li> <p>Linux</p> <p>Add the library directory that contains <code>libcedarling_go.so</code> to the <code>LD_LIBRARY_PATH</code> environment variable</p> <pre><code>export LD_LIBRARY_PATH=$(pwd):$LD_LIBRARY_PATH\n</code></pre> </li> <li> <p>MacOS</p> <p>Add the library directory that contains <code>libcedarling_go.dylib</code> to the <code>LD_LIBRARY_PATH</code> environment variable</p> <pre><code>export DYLD_LIBRARY_PATH=$(pwd):$DYLD_LIBRARY_PATH\n</code></pre> </li> </ul> </li> </ol>","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/go/#build-from-source","title":"Build from Source","text":"<p>Follow these instructions to build from source.</p>","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/go/#prerequisites","title":"Prerequisites","text":"<ul> <li>Go 1.20+</li> <li>Rust tool-chain</li> </ul>","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/go/#steps-to-build-from-source","title":"Steps to build from source","text":"<ol> <li> <p>Build the Rust library</p> <p>Clone the Janssen repository:</p> <pre><code>git clone --depth 1 https://github.com/JanssenProject/jans.git\n</code></pre> <p>We use <code>--depth 1</code> to avoid cloning unnecessary history and minimalize the download size.</p> <p>Navigate to the Cedarling Go bindings directory:</p> <pre><code>cd jans/jans-cedarling/bindings/cedarling_go\n</code></pre> <pre><code>cargo build --release -p cedarling_go\n</code></pre> </li> <li> <p>Copy the built artifacts to your application directory</p> <pre><code># Windows\ncp target/release/cedarling_go.dll .\ncp target/release/cedarling_go.dll.lib cedarling_go.lib\n\n# Linux\ncp target/release/libcedarling_go.so .\n\n# macOS\ncp target/release/libcedarling_go.dylib .\n</code></pre> <p>or use scripts provided in the repository to automate this process:</p> <pre><code>sh build_and_copy_artifacts.sh\n</code></pre> <p>Run go test to ensure everything is working correctly:</p> <pre><code>go test .\n</code></pre> </li> </ol>","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/go/#usage","title":"Usage","text":"","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/go/#initialization","title":"Initialization","text":"<pre><code>import \"github.com/JanssenProject/jans/jans-cedarling/bindings/cedarling_go\"\n\n// Example configuration (populate dynamically in production)\nconfig := map[string]any{\n    \"CEDARLING_APPLICATION_NAME\":   \"MyApp\",\n    \"CEDARLING_POLICY_STORE_ID\":    \"your-policy-store-id\",\n    \"CEDARLING_USER_AUTHZ\":         \"enabled\",\n    \"CEDARLING_WORKLOAD_AUTHZ\":     \"enabled\",\n    \"CEDARLING_LOG_LEVEL\":          \"INFO\",\n    \"CEDARLING_LOG_TYPE\":           \"std_out\",\n    \"CEDARLING_POLICY_STORE_LOCAL_FN\": \"/path/to/policy-store.json\",\n}\n\ninstance, err := cedarling_go.NewCedarling(config)\nif err != nil {\n    panic(err)\n}\n</code></pre>","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/go/#policy-store-sources","title":"Policy Store Sources","text":"<p>Go bindings support all native policy store source types. See Cedarling Properties for the full list of configuration options.</p> <p>Example configurations:</p> <pre><code>// Load from a directory\nconfig := map[string]any{\n    \"CEDARLING_APPLICATION_NAME\":      \"MyApp\",\n    \"CEDARLING_POLICY_STORE_LOCAL_FN\": \"/path/to/policy-store/\",\n    // ... other config\n}\n\n// Load from a local .cjar archive (Cedar Archive)\nconfig := map[string]any{\n    \"CEDARLING_APPLICATION_NAME\":      \"MyApp\",\n    \"CEDARLING_POLICY_STORE_LOCAL_FN\": \"/path/to/policy-store.cjar\",\n    // ... other config\n}\n\n// Load from a remote .cjar archive (Cedar Archive)\nconfig := map[string]any{\n    \"CEDARLING_APPLICATION_NAME\":   \"MyApp\",\n    \"CEDARLING_POLICY_STORE_URI\":   \"https://example.com/policy-store.cjar\",\n    // ... other config\n}\n</code></pre> <p>See Policy Store Formats for more details.</p>","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/go/#authorization","title":"Authorization","text":"<p>Cedarling provides two main interfaces for performing authorization checks: Token-Based Authorization and Unsigned Authorization. Both methods involve evaluating access requests based on various factors, including principals (entities), actions, resources, and context. The difference lies in how the Principals are provided.</p> <ul> <li>Token-Based Authorization is the standard method where principals are extracted from JSON Web Tokens (JWTs), typically used in scenarios where you have existing user authentication and authorization data encapsulated in tokens.</li> <li>Unsigned Authorization allows you to pass principals directly, bypassing tokens entirely. This is useful when you need to authorize based on internal application data, or when tokens are not available.</li> </ul>","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/go/#token-based-authorization","title":"Token-Based Authorization","text":"<p>1. Define the resource:</p> <pre><code>resource := cedarling_go.EntityData{\n    CedarMapping: cedarling_go.CedarMapping{\n        EntityType: \"Jans::Issue\",\n        ID:         \"random_id\",\n    },\n    Payload: map[string]any{\n        \"org_id\":  \"some_long_id\",\n        \"country\": \"US\",\n    },\n}\n</code></pre> <p>2. Define the action:</p> <pre><code>action := `Jans::Action::\"Update\"`\n</code></pre> <p>3. Build the request with tokens:</p> <pre><code>request := cedarling_go.Request{\n    Tokens: map[string]string{\n        \"access_token\":   \"your.jwt.token\",\n        \"id_token\":       \"your.id.token\",\n        \"userinfo_token\": \"your.userinfo.token\",\n    },\n    Action:   action,\n    Resource: resource,\n}\n</code></pre> <p>4. Authorize:</p> <pre><code>result, err := instance.Authorize(request)\nif err != nil {\n    // Handle error\n}\n\nif result.Decision {\n    fmt.Println(\"Access granted\")\n} else {\n    fmt.Println(\"Access denied\")\n}\n</code></pre>","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/go/#unsigned-authorization","title":"Unsigned Authorization","text":"<p>In unsigned authorization, you pass a set of Principals directly, without relying on tokens. This can be useful when the application needs to perform authorization based on internal data, or when token-based data is not available.</p> <p>1. Define the principals:</p> <pre><code>principals := []cedarling_go.EntityData{\n    {\n        CedarMapping: cedarling_go.CedarMapping{\n            EntityType: \"Jans::User\",\n            ID:         \"random_id\",\n        },\n        Payload: map[string]any{\n            \"role\":    []string{\"admin\"},\n            \"country\": \"US\",\n            \"sub\":     \"random_sub\",\n        },\n    },\n}\n</code></pre> <p>2. Build the request:</p> <pre><code>request := cedarling_go.RequestUnsigned{\n    Principals: principals,\n    Action:     `Jans::Action::\"Update\"`,\n    Resource:   resource, // From previous example\n}\n</code></pre> <p>3. Authorize:</p> <pre><code>result, err := instance.AuthorizeUnsigned(request)\nif err != nil {\n    // Handle error\n}\nif result.Decision {\n   fmt.Println(\"Access granted\")\n} else {\n    fmt.Println(\"Access denied\")\n}\n</code></pre>","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/go/#multi-issuer-authorization","title":"Multi-Issuer Authorization","text":"<p>Multi-issuer authorization allows you to make authorization decisions based on multiple JWT tokens from different issuers in a single request without requiring traditional User/Workload principals.</p> <p>1. Create tokens with explicit type mappings:</p> <pre><code>tokens := []cedarling_go.TokenInput{\n    {\n        Mapping: \"Jans::Access_Token\",\n        Payload: \"eyJhbGciOiJIUzI1NiIs...\",\n    },\n    {\n        Mapping: \"Jans::Id_Token\",\n        Payload: \"eyJhbGciOiJFZERTQSIs...\",\n    },\n    {\n        Mapping: \"Acme::DolphinToken\",  // Custom token type\n        Payload: \"ey1b6cfMef21084633a7...\",\n    },\n}\n</code></pre> <p>2. Define the resource:</p> <pre><code>resource := cedarling_go.EntityData{\n    CedarMapping: cedarling_go.CedarMapping{\n        EntityType: \"Jans::Document\",\n        ID:         \"doc_123\",\n    },\n    Payload: map[string]any{\n        \"owner\":          \"alice@example.com\",\n        \"classification\": \"confidential\",\n    },\n}\n</code></pre> <p>3. Build the multi-issuer request:</p> <pre><code>request := cedarling_go.AuthorizeMultiIssuerRequest{\n    Tokens:   tokens,\n    Action:   `Jans::Action::\"Read\"`,\n    Resource: resource,\n    Context: map[string]any{\n        \"ip_address\": \"54.9.21.201\",\n        \"time\":       time.Now().Unix(),\n    },\n}\n</code></pre> <p>4. Authorize:</p> <pre><code>result, err := instance.AuthorizeMultiIssuer(request)\nif err != nil {\n    // Handle error\n    fmt.Printf(\"Authorization failed: %v\\n\", err)\n    return\n}\n\nif result.Decision {\n    fmt.Println(\"Access granted\")\n    fmt.Printf(\"Request ID: %s\\n\", result.RequestID)\n\n    // Access detailed Cedar response\n    fmt.Printf(\"Cedar decision: %s\\n\", result.Response.Decision().ToString())\n\n    // Get diagnostic information\n    diagnostics := result.Response.Diagnostics()\n    if len(diagnostics.Reason()) &gt; 0 {\n        fmt.Printf(\"Policies used: %v\\n\", diagnostics.Reason())\n    }\n    if len(diagnostics.Errors()) &gt; 0 {\n        fmt.Printf(\"Errors: %v\\n\", diagnostics.Errors())\n    }\n} else {\n    fmt.Println(\"Access denied\")\n}\n</code></pre> <p>Key differences from standard authorization:</p> <ul> <li>No User/Workload principals - authorization based purely on token entities</li> <li>Supports multiple tokens from different issuers in a single request</li> <li>Tokens referenced in policies as <code>context.tokens.{issuer}_{token_type}</code></li> <li>Custom token types supported via <code>Mapping</code> field</li> </ul> <p>Policy Example for Multi-Issuer:</p> <pre><code>// Require token from specific issuer with claim\npermit(\n  principal,\n  action == Jans::Action::\"Read\",\n  resource in Jans::Document\n) when {\n  context has tokens.acme_access_token &amp;&amp;\n  context.tokens.acme_access_token.hasTag(\"scope\") &amp;&amp;\n  context.tokens.acme_access_token.getTag(\"scope\").contains(\"read:documents\")\n};\n\n// Require tokens from multiple issuers\npermit(\n  principal,\n  action == Trade::Action::\"Vote\",\n  resource in Trade::Election\n) when {\n  context has tokens.trade_association_access_token &amp;&amp;\n  context.tokens.trade_association_access_token.hasTag(\"member_status\") &amp;&amp;\n  context.tokens.trade_association_access_token.getTag(\"member_status\").contains(\"Corporate Member\") &amp;&amp;\n  context has tokens.company_access_token &amp;&amp;\n  context.tokens.company_access_token.hasTag(\"employee_id\")\n};\n</code></pre>","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/go/#logging","title":"Logging","text":"<p>Retrieve logs stored in memory:</p> <pre><code>// Get all logs and clear the buffer\nlogs := instance.PopLogs()\n\n// Get a specific log by ID\nlog := instance.GetLogById(\"log123\")\n\n// Get logs by tag (e.g., \"info\")\nlogs := instance.GetLogsByTag(\"info\")\n</code></pre>","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/go/#defined-api","title":"Defined API","text":"<p>Auto-generated documentation is available on pkg.go.dev.</p>","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/go/#see-also","title":"See Also","text":"<ul> <li>Multi-Issuer Authorization Details</li> <li>JWT Mapping for Multi-Issuer</li> <li>Policy Store Configuration</li> </ul>","tags":["cedarling","golang","getting-started"]},{"location":"cedarling/tutorials/java/","title":"Getting Started with Cedarling Java","text":"","tags":["cedarling","java","getting-started"]},{"location":"cedarling/tutorials/java/#installation","title":"Installation","text":"","tags":["cedarling","java","getting-started"]},{"location":"cedarling/tutorials/java/#using-the-package-manager","title":"Using the package manager","text":"<p>Prerequisites</p> <ul> <li>Java Development Kit (JDK): version 11 or higher</li> </ul> <p>To use Cedarling Java bindings in Java Maven Project add following <code>repository</code> and <code>dependency</code> in pom.xml of the project.</p> <pre><code>    &lt;repositories&gt;\n        &lt;repository&gt;\n            &lt;id&gt;jans&lt;/id&gt;\n            &lt;name&gt;Janssen project repository&lt;/name&gt;\n            &lt;url&gt;https://maven.jans.io/maven&lt;/url&gt;\n        &lt;/repository&gt;\n    &lt;/repositories&gt;\n</code></pre> <pre><code>        &lt;dependency&gt;\n            &lt;groupId&gt;io.jans&lt;/groupId&gt;\n            &lt;artifactId&gt;cedarling-java&lt;/artifactId&gt;\n            &lt;version&gt;{latest-jans-stable-version}&lt;/version&gt;\n        &lt;/dependency&gt;\n</code></pre>","tags":["cedarling","java","getting-started"]},{"location":"cedarling/tutorials/java/#building-from-source","title":"Building from Source","text":"<p>Refer to the following guide for steps to build the Java binding from source.</p>","tags":["cedarling","java","getting-started"]},{"location":"cedarling/tutorials/java/#usage","title":"Usage","text":"","tags":["cedarling","java","getting-started"]},{"location":"cedarling/tutorials/java/#initialization","title":"Initialization","text":"<p>We need to initialize Cedarling first.</p> <pre><code>        import uniffi.cedarling_uniffi.*;\n        import io.jans.cedarling.binding.wrapper.CedarlingAdapter;\n        ...\n\n        /*\n         * In a production environment, the bootstrap configuration should not be hardcoded.\n         * Instead, it should be loaded dynamically from external sources such as environment variables,\n         * configuration files, or a centralized configuration service.\n         */\n        String bootstrapJsonStr = \"\"\"\n            {\n            \"CEDARLING_APPLICATION_NAME\":   \"MyApp\",\n            \"CEDARLING_POLICY_STORE_ID\":    \"your-policy-store-id\",\n            \"CEDARLING_USER_AUTHZ\":         \"enabled\",\n            \"CEDARLING_WORKLOAD_AUTHZ\":     \"enabled\",\n            \"CEDARLING_LOG_LEVEL\":          \"INFO\",\n            \"CEDARLING_LOG_TYPE\":           \"std_out\",\n            \"CEDARLING_POLICY_STORE_LOCAL_FN\": \"/path/to/policy-store.json\"\n        }\n        \"\"\";\n\n        try {\n            CedarlingAdapter cedarlingAdapter = new CedarlingAdapter();\n            cedarlingAdapter.loadFromJson(bootstrapJsonStr);\n        } catch (CedarlingException e) {\n            System.out.println(\"Unable to initialize Cedarling\" + e.getMessage());\n        } catch (Exception e) {\n            System.out.println(\"Unable to initialize Cedarling\" + e.getMessage());\n        }\n</code></pre>","tags":["cedarling","java","getting-started"]},{"location":"cedarling/tutorials/java/#policy-store-sources","title":"Policy Store Sources","text":"<p>Java bindings support all native policy store source types. See Cedarling Properties for the full list of configuration options and Policy Store Formats for format details.</p> <p>Example configurations:</p> <pre><code>// Load from a directory\nString bootstrapJsonStr = \"\"\"\n    {\n        \"CEDARLING_APPLICATION_NAME\": \"MyApp\",\n        \"CEDARLING_POLICY_STORE_LOCAL_FN\": \"/path/to/policy-store/\"\n    }\n    \"\"\";\n\n// Load from a local .cjar archive (Cedar Archive)\nString bootstrapJsonStr = \"\"\"\n    {\n        \"CEDARLING_APPLICATION_NAME\": \"MyApp\",\n        \"CEDARLING_POLICY_STORE_LOCAL_FN\": \"/path/to/policy-store.cjar\"\n    }\n    \"\"\";\n\n// Load from a remote .cjar archive (Cedar Archive)\nString bootstrapJsonStr = \"\"\"\n    {\n        \"CEDARLING_APPLICATION_NAME\": \"MyApp\",\n        \"CEDARLING_POLICY_STORE_URI\": \"https://example.com/policy-store.cjar\"\n    }\n    \"\"\";\n</code></pre> <p>See Policy Store Formats for more details.</p>","tags":["cedarling","java","getting-started"]},{"location":"cedarling/tutorials/java/#authorization","title":"Authorization","text":"<p>Cedarling provides two main interfaces for performing authorization checks: Token-Based Authorization and Unsigned Authorization. Both methods involve evaluating access requests based on various factors, including principals (entities), actions, resources, and context. The difference lies in how the Principals are provided.</p> <ul> <li>Token-Based Authorization is the standard method where principals are extracted from JSON Web Tokens (JWTs), typically used in scenarios where you have existing user authentication and authorization data encapsulated in tokens.</li> <li>Unsigned Authorization allows you to pass principals directly, bypassing tokens entirely. This is useful when you need to authorize based on internal application data, or when tokens are not available.</li> </ul>","tags":["cedarling","java","getting-started"]},{"location":"cedarling/tutorials/java/#token-based-authorization","title":"Token-Based Authorization","text":"<p>1. Define the resource:</p> <p>This represents the resource that the action will be performed on, such as a protected API endpoint or file.</p> <pre><code>    String resource = \"\"\"\n        {\n          \"app_id\": \"app_id_001\",\n          \"cedar_entity_mapping\": {\n            \"entity_type\": \"Jans::Issue\",\n            \"id\": \"admin_ui_id\"\n          },\n          \"name\": \"App Name\",\n          \"permission\": \"view_clients\"\n        }\n        \"\"\";\n</code></pre> <p>2. Define the action:</p> <p>An action represents what the principal is trying to do to the resource. For example, read, write, or delete operations.</p> <pre><code>String action = \"Jans::Action::\\\"Update\\\"\";\n</code></pre> <p>3. Define Context</p> <p>The context represents additional data that may affect the authorization decision, such as time, location, or user-agent.</p> <pre><code>    String context = \"\"\"\n        {\n          \"device_health\": [\"Healthy\"],\n          \"fraud_indicators\": [\"Allowed\"],\n          \"geolocation\": [\"America\"],\n          \"network\": \"127.0.0.1\",\n          \"network_type\": \"Local\",\n          \"operating_system\": \"Linux\",\n          \"user_agent\": \"Linux\"\n        }\n    \"\"\";\n</code></pre> <p>4. Prepare tokens</p> <pre><code>    String accessToken = \"&lt;access_token&gt;\";\n    String idToken = \"&lt;id_token&gt;\";\n    String userinfoToken = \"&lt;userinfo_token&gt;\";\n</code></pre> <p>5. Authorize</p> <p>Finally, call the <code>authorize</code> function to check whether the principals are allowed to perform the specified action on the resource.</p> <pre><code>    //Generate Map containing tokens\n    Map&lt;String, String&gt; tokens = Map.of(\n        \"access_token\", accessToken,\n        \"id_token\", idToken,\n        \"userinfo_token\", userinfoToken\n    );\n\n    // Perform authorization\n    AuthorizeResult result = adapter.authorize(tokens, action, new JSONObject(resource), new JSONObject(context));\n    if(result.getDecision()) {\n        System.out.println(\"Access granted\");\n    } else {\n        System.out.println(\"Access denied\");\n    }\n</code></pre>","tags":["cedarling","java","getting-started"]},{"location":"cedarling/tutorials/java/#custom-principal-authorization-unsigned","title":"Custom Principal Authorization (Unsigned)","text":"<p>1. Define principals:</p> <pre><code>    String principals = \"\"\"\n        const principals = [\n          {\n            \"cedar_entity_mapping\": {\n              \"entity_type\": \"Jans::Workload\",\n              \"id\": \"some_workload_id\"\n            },\n            \"client_id\": \"some_client_id\",\n          },\n          {\n            \"cedar_entity_mapping\": {\n              \"entity_type\": \"Jans::User\",\n              \"id\": \"random_user_id\"\n            },\n            \"roles\": [\"admin\", \"manager\"]\n          },\n        ];\n        \"\"\";\n</code></pre> <p>Similarly, create and initialize String variables with action, resource, context as done in Token-Based Authorization.</p> <p>2. Authorize</p> <p>Finally, call the <code>authorize</code> function to check whether the principals are allowed to perform the specified action on the resource.</p> <pre><code>        List&lt;EntityData&gt; principals = List.of(EntityData.Companion.fromJson(principals));\n\n        AuthorizeResult result = adapter.authorizeUnsigned(principals, action, new JSONObject(resource), new JSONObject(context));\n        if(result.getDecision()) {\n            System.out.println(\"Access granted\");\n        } else {\n            System.out.println(\"Access denied\");\n        }\n</code></pre>","tags":["cedarling","java","getting-started"]},{"location":"cedarling/tutorials/java/#logging","title":"Logging","text":"<p>The logs could be retrieved using the <code>pop_logs</code> function.</p> <pre><code>    // Get all logs and clear the buffer\n    List&lt;String&gt; logEntrys = adapter.popLogs();\n    // Get a specific log by ID\n    List&lt;String&gt; logEntrys = adapter.getLogIds();\n    String logEntry = adapter.getLogById(logEntrys.get(0));\n    // Get logs by tag (e.g., \"System\")\n    adapter.getLogsByTag(\"System\");\n</code></pre>","tags":["cedarling","java","getting-started"]},{"location":"cedarling/tutorials/java/#defined-api","title":"Defined API","text":"<p>Defined APIs are listed here</p>","tags":["cedarling","java","getting-started"]},{"location":"cedarling/tutorials/java/#see-also","title":"See Also","text":"<ul> <li>Cedarling TBAC quickstart</li> <li>Cedarling Unsigned quickstart</li> </ul>","tags":["cedarling","java","getting-started"]},{"location":"cedarling/tutorials/javascript/","title":"Getting Started with Cedarling in a JavaScript app","text":"<p>This guide combines the JavaScript usage instructions with the WebAssembly (WASM) build and API reference for Cedarling.</p>","tags":["cedarling","javascript","WASM","browser app","getting-started"]},{"location":"cedarling/tutorials/javascript/#installation","title":"Installation","text":"","tags":["cedarling","javascript","WASM","browser app","getting-started"]},{"location":"cedarling/tutorials/javascript/#using-the-package-manager","title":"Using the package manager","text":"<p>You can easily install Cedarling using WASM.</p> <pre><code>npm i @janssenproject/cedarling_wasm\n</code></pre> <p>Alternatively, see here, if you want to build Cedarling from the source.</p>","tags":["cedarling","javascript","WASM","browser app","getting-started"]},{"location":"cedarling/tutorials/javascript/#build-from-source","title":"Build from Source","text":"","tags":["cedarling","javascript","WASM","browser app","getting-started"]},{"location":"cedarling/tutorials/javascript/#requirements","title":"Requirements","text":"<p>Rust 1.63 or Greater. Ensure that you have <code>Rust</code> version 1.63 or higher installed. You can check your current version of Rust using the command below.</p> Command<pre><code>rustc --version\n</code></pre> <p>Installed <code>wasm-pack</code> via <code>Cargo</code>. You can install it with the following command:</p> Command<pre><code>cargo install wasm-pack\n</code></pre> <p>Ensure that Clang is installed with support for WebAssembly targets. You can check the installation and available targets with:</p> Command<pre><code>clang -print-targets\n</code></pre> <p>Check <code>clang</code> version</p> Command<pre><code>clang --version\n</code></pre>","tags":["cedarling","javascript","WASM","browser app","getting-started"]},{"location":"cedarling/tutorials/javascript/#building","title":"Building","text":"<p>Clone the Janssen server repository from the GitHub and change the directory to the <code>cedarling_wasm</code> directory:</p> Command<pre><code>cd /path/to/jans/jans-cedarling/bindings/cedarling_wasm\n</code></pre> <p>Build the WebAssembly package in release mode after you've reached the <code>cedarling_wasm</code> directory. <code>wasm-pack</code> automatically optimizes the WebAssembly binary file using <code>wasm-opt</code> for better performance.</p> Command<pre><code>wasm-pack build --release --target web\n</code></pre> <p>To view the WebAssembly project in action, you can run a local server. One way to do this is by using the following command:</p> Command<pre><code>python3 -m http.server\n</code></pre>","tags":["cedarling","javascript","WASM","browser app","getting-started"]},{"location":"cedarling/tutorials/javascript/#usage","title":"Usage","text":"<p>Sample Apps</p> <p>You can find usage examples at the following locations in the Janssen server repository:</p> <ul> <li>A sample app that demonstrates basic usage.</li> <li>A fully featured Cedarling browser app where you can test and validate your configuration.</li> </ul>","tags":["cedarling","javascript","WASM","browser app","getting-started"]},{"location":"cedarling/tutorials/javascript/#initialization","title":"Initialization","text":"<p>Since Cedarling is a WASM module, you need to initialize it first.</p> <pre><code>import initWasm, { init } from \"@janssenproject/cedarling_wasm\";\n\n// initialize the WASM binary\nawait initWasm();\n\nlet cedarling = init(\n  \"CEDARLING_APPLICATION_NAME\": \"My App\",\n  // make sure to update this with your own policy store\n  \"CEDARLING_POLICY_STORE_URI\": \"https://raw.githubusercontent.com/...\",\n  \"CEDARLING_LOG_TYPE\": \"std_out\",\n  \"CEDARLING_LOG_LEVEL\": \"DEBUG\",\n  \"CEDARLING_USER_AUTHZ\": \"enabled\",\n  \"CEDARLING_WORKLOAD_AUTHZ\": \"disabled\",\n  \"CEDARLING_JWT_SIG_VALIDATION\": \"disabled\",\n  \"CEDARLING_ID_TOKEN_TRUST_MODE\": \"never\",\n});\n</code></pre>","tags":["cedarling","javascript","WASM","browser app","getting-started"]},{"location":"cedarling/tutorials/javascript/#policy-store-sources-wasm","title":"Policy Store Sources (WASM)","text":"<p>In WASM environments, filesystem access is not available. Use one of these options:</p> <pre><code>// Option 1: URL-based loading (simple)\nlet cedarling = await init({\n  CEDARLING_POLICY_STORE_URI: \"https://example.com/policy-store.cjar\",\n  // ... other config\n});\n\n// Option 2: Inline JSON string\nlet cedarling = await init({\n  CEDARLING_POLICY_STORE_LOCAL: JSON.stringify(policyStoreObject),\n  // ... other config\n});\n\n// Option 3: Custom fetch with auth headers\nimport initWasm, {\n  init_from_archive_bytes,\n} from \"@janssenproject/cedarling_wasm\";\n\nconst response = await fetch(\"https://example.com/policy-store.cjar\", {\n  headers: { Authorization: `Bearer ${token}` },\n});\nconst bytes = new Uint8Array(await response.arrayBuffer());\nlet cedarling = await init_from_archive_bytes(config, bytes);\n</code></pre> <p>For the directory-based format, package your policy store as a <code>.cjar</code> file and host it:</p> <pre><code>cd policy-store &amp;&amp; zip -r ../policy-store.cjar .\n</code></pre> <p>See Policy Store Formats for details.</p>","tags":["cedarling","javascript","WASM","browser app","getting-started"]},{"location":"cedarling/tutorials/javascript/#authorization","title":"Authorization","text":"<p>Cedarling provides two main interfaces for performing authorization checks: Token-Based Authorization and Unsigned Authorization. Both methods involve evaluating access requests based on various factors, including principals (entities), actions, resources, and context. The difference lies in how the Principals are provided.</p> <ul> <li>Token-Based Authorization is the standard method where principals are extracted from JSON Web Tokens (JWTs), typically used in scenarios where you have existing user authentication and authorization data encapsulated in tokens.</li> <li>Unsigned Authorization allows you to pass principals directly, bypassing tokens entirely. This is useful when you need to authorize based on internal application data, or when tokens are not available.</li> </ul>","tags":["cedarling","javascript","WASM","browser app","getting-started"]},{"location":"cedarling/tutorials/javascript/#token-based-authorization","title":"Token-Based Authorization","text":"<p>To perform an authorization check, follow these steps:</p> <p>1. Prepare tokens</p> <pre><code>const access_token = \"&lt;access_token&gt;\";\nconst id_token = \"&lt;id_token&gt;\";\nconst userinfo_token = \"&lt;userinfo_token&gt;\";\n</code></pre> <p>Your principals will be built from these tokens.</p> <p>2. Define the resource</p> <p>This represents the resource that the action will be performed on, such as a protected API endpoint or file.</p> <pre><code>const resource = {\n  cedar_entity_mapping: {\n    entity_type: \"Jans::Application\",\n    id: \"app_id_001\",\n  },\n  name: \"App Name\",\n  url: {\n    host: \"example.com\",\n    path: \"/admin-dashboard\",\n    protocol: \"https\",\n  },\n};\n</code></pre> <p>3. Define the action</p> <p>An action represents what the principal is trying to do to the resource. For example, read, write, or delete operations.</p> <pre><code>const action = 'Jans::Action::\"Read\"';\n</code></pre> <p>4. Define Context</p> <p>The context represents additional data that may affect the authorization decision, such as time, location, or user-agent.</p> <pre><code>const context = {\n  current_time: Math.floor(Date.now() / 1000),\n  device_health: [\"Healthy\"],\n  fraud_indicators: [\"Allowed\"],\n  geolocation: [\"America\"],\n  network: \"127.0.0.1\",\n  network_type: \"Local\",\n  operating_system: \"Linux\",\n  user_agent: \"Linux\",\n};\n</code></pre> <p>5. Build the request</p> <p>Now you'll construct the request by including the principals, action, and context.</p> <pre><code>const request = {\n  tokens: {\n    access_token: access_token,\n    id_token: id_token,\n    userinfo_token: userinfo_token,\n  },\n  action: action,\n  resource: resource,\n  context: context,\n};\n</code></pre> <p>6. Perform Authorization</p> <p>Finally, call the <code>authorize</code> function to check whether the principals are allowed to perform the specified action on the resource.</p> <pre><code>const authorize_result = await cedarling.authorize(request);\n</code></pre>","tags":["cedarling","javascript","WASM","browser app","getting-started"]},{"location":"cedarling/tutorials/javascript/#unsigned-authorization","title":"Unsigned Authorization","text":"<p>In unsigned authorization, you pass a set of Principals directly, without relying on tokens. This can be useful when the application needs to perform authorization based on internal data, or when token-based data is not available.</p> <p>1. Define the Principals</p> <pre><code>const principals = [\n  {\n    cedar_entity_mapping: {\n      entity_type: \"Jans::Workload\",\n      id: \"some_workload_id\",\n    },\n    client_id: \"some_client_id\",\n  },\n  {\n    cedar_entity_mapping: {\n      entity_type: \"Jans::User\",\n      id: \"random_user_id\",\n    },\n    roles: [\"admin\", \"manager\"],\n  },\n];\n</code></pre> <p>2. Define the Resource</p> <p>This represents the resource that the action will be performed on, such as a protected API endpoint or file.</p> <pre><code>const resource = {\n  cedar_entity_mapping: {\n    entity_type: \"Jans::Application\",\n    id: \"app_id_001\",\n  },\n  name: \"App Name\",\n  url: {\n    host: \"example.com\",\n    path: \"/admin-dashboard\",\n    protocol: \"https\",\n  },\n};\n</code></pre> <p>3. Define the Action</p> <p>An action represents what the principal is trying to do to the resource. For example, read, write, or delete operations.</p> <pre><code>const action = 'Jans::Action::\"Write\"';\n</code></pre> <p>4. Define the Context</p> <p>The context represents additional data that may affect the authorization decision, such as time, location, or user-agent.</p> <pre><code>const context = {\n  current_time: Math.floor(Date.now() / 1000),\n  device_health: [\"Healthy\"],\n  location: \"US\",\n  network: \"127.0.0.1\",\n  operating_system: \"Linux\",\n};\n</code></pre> <p>5. Build the Request</p> <p>Now you'll construct the request by including the principals, action, and context.</p> <pre><code>const request = {\n  principals: principals,\n  action: action,\n  resource: resource,\n  context: context,\n};\n</code></pre> <p>6. Perform Authorization</p> <p>Finally, call the <code>authorize</code> function to check whether the principals are allowed to perform the specified action on the resource.</p> <pre><code>const result = await cedarling.authorize_unsigned(request);\n</code></pre>","tags":["cedarling","javascript","WASM","browser app","getting-started"]},{"location":"cedarling/tutorials/javascript/#logging","title":"Logging","text":"<p>The logs could be retrieved using the <code>pop_logs</code> function.</p> <pre><code>const logs = cedarling.pop_logs();\nconsole.log(logs);\n</code></pre>","tags":["cedarling","javascript","WASM","browser app","getting-started"]},{"location":"cedarling/tutorials/javascript/#defined-api","title":"Defined API","text":"<pre><code>/**\n * Create a new instance of the Cedarling application.\n * This function can take as config parameter the eather `Map` other `Object`\n */\nexport function init(config: any): Promise&lt;Cedarling&gt;;\n/**\n * A WASM wrapper for the Rust `cedarling::AuthorizeResult` struct.\n * Represents the result of an authorization request.\n */\nexport class AuthorizeResult {\n\n  /**\n   * Convert `AuthorizeResult` to json string value\n   */\n  json_string(): string;\n  principal(principal: string): AuthorizeResultResponse | undefined;\n  /**\n   * Result of authorization where principal is `Jans::Workload`\n   */\n  get workload(): AuthorizeResultResponse | undefined;\n  /**\n   * Result of authorization where principal is `Jans::Workload`\n   */\n  set workload(value: AuthorizeResultResponse | null | undefined);\n  /**\n   * Result of authorization where principal is `Jans::User`\n   */\n  get person(): AuthorizeResultResponse | undefined;\n  /**\n   * Result of authorization where principal is `Jans::User`\n   */\n  set person(value: AuthorizeResultResponse | null | undefined);\n  /**\n   * Result of authorization\n   * true means `ALLOW`\n   * false means `Deny`\n   *\n   * this field is [`bool`] type to be compatible with [authzen Access Evaluation Decision](https://openid.github.io/authzen/#section-6.2.1).\n   */\n  decision: boolean;\n  /**\n   * Request ID of the authorization request\n   */\n  request_id: string;\n}\n/**\n * A WASM wrapper for the Rust `cedar_policy::Response` struct.\n * Represents the result of an authorization request.\n */\nexport class AuthorizeResultResponse {\n\n  /**\n   * Authorization decision\n   */\n  readonly decision: boolean;\n  /**\n   * Diagnostics providing more information on how this decision was reached\n   */\n  readonly diagnostics: Diagnostics;\n}\n/**\n * The instance of the Cedarling application.\n */\nexport class Cedarling {\n\n  /**\n   * Create a new instance of the Cedarling application.\n   * Assume that config is `Object`\n   */\n  static new(config: object): Promise&lt;Cedarling&gt;;\n  /**\n   * Create a new instance of the Cedarling application.\n   * Assume that config is `Map`\n   */\n  static new_from_map(config: Map&lt;any, any&gt;): Promise&lt;Cedarling&gt;;\n  /**\n   * Authorize request\n   * makes authorization decision based on the [`Request`]\n   */\n  authorize(request: any): Promise&lt;AuthorizeResult&gt;;\n  /**\n   * Authorize request for unsigned principals.\n   * makes authorization decision based on the [`RequestUnsigned`]\n   */\n  authorize_unsigned(request: any): Promise&lt;AuthorizeResult&gt;;\n  /**\n   * Get logs and remove them from the storage.\n   * Returns `Array` of `Map`\n   */\n  pop_logs(): Array&lt;any&gt;;\n  /**\n   * Get specific log entry.\n   * Returns `Map` with values or `null`.\n   */\n  get_log_by_id(id: string): any;\n  /**\n   * Returns a list of all log ids.\n   * Returns `Array` of `String`\n   */\n  get_log_ids(): Array&lt;any&gt;;\n  /**\n   * Get logs by tag, like `log_kind` or `log level`.\n   * Tag can be `log_kind`, `log_level`.\n   */\n  get_logs_by_tag(tag: string): any[];\n  /**\n   * Get logs by request_id.\n   * Return log entries that match the given request_id.\n   */\n  get_logs_by_request_id(request_id: string): any[];\n  /**\n   * Get log by request_id and tag, like composite key `request_id` + `log_kind`.\n   * Tag can be `log_kind`, `log_level`.\n   * Return log entries that match the given request_id and tag.\n   */\n  get_logs_by_request_id_and_tag(request_id: string, tag: string): any[];\n}\n/**\n * Diagnostics\n * ===========\n *\n * Provides detailed information about how a policy decision was made, including policies that contributed to the decision and any errors encountered during evaluation.\n */\nexport class Diagnostics {\n\n  /**\n   * `PolicyId`s of the policies that contributed to the decision.\n   * If no policies applied to the request, this set will be empty.\n   *\n   * The ids should be treated as unordered,\n   */\n  readonly reason: string[];\n  /**\n   * Errors that occurred during authorization. The errors should be\n   * treated as unordered, since policies may be evaluated in any order.\n   */\n  readonly errors: PolicyEvaluationError[];\n}\nexport class JsJsonLogic {\n  apply(logic: any, data: any): any;\n}\n/**\n * PolicyEvaluationError\n * =====================\n *\n * Represents an error that occurred when evaluating a Cedar policy.\n */\nexport class PolicyEvaluationError {\n\n  /**\n   * Id of the policy with an error\n   */\n  readonly id: string;\n  /**\n   * Underlying evaluation error string representation\n   */\n  readonly error: string;\n}\n</code></pre>","tags":["cedarling","javascript","WASM","browser app","getting-started"]},{"location":"cedarling/tutorials/javascript/#see-also","title":"See Also","text":"<ul> <li>Cedarling TBAC quickstart</li> <li>Cedarling Unsigned quickstart</li> <li>Cedarling Sidecar Tutorial</li> </ul>","tags":["cedarling","javascript","WASM","browser app","getting-started"]},{"location":"cedarling/tutorials/kotlin/","title":"Getting Started with Cedarling Kotlin","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p> <p>Have questions in the meantime?</p> <p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p> <p>Want to contribute?</p> <p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["cedarling","kotlin","getting-started"]},{"location":"cedarling/tutorials/python/","title":"Getting Started with Cedarling Python","text":"<ul> <li>Installation</li> <li>Usage</li> </ul>","tags":["cedarling","python","getting-started"]},{"location":"cedarling/tutorials/python/#installation","title":"Installation","text":"<p>At the moment, the Cedarling Python bindings are not available via package managers like PyPI. To use them, you can either download a pre-compiled <code>cedarling_python</code> wheel from the releases page or build it from the source.</p>","tags":["cedarling","python","getting-started"]},{"location":"cedarling/tutorials/python/#building-from-source","title":"Building from source","text":"<p>The recommended approach is to compile a Python wheel using Maturin, a tool for building and publishing Rust-based Python packages.</p> <p>1. Set up a virtual environment</p> <pre><code>python -m venv venv\nsource venv/bin/activate\n</code></pre> <p>2. Install <code>maturin</code></p> <pre><code># for non-Linux systems\npip install maturin\n\n# for Linux systems\npip install maturin[patchelf]\n</code></pre> <p>3. Clone the jans repository and navigate to the python bindings directory.</p> <pre><code>git clone https://github.com/JanssenProject/jans.git jans\ncd jans/jans-cedarling/bindings/cedarling_python/\n</code></pre> <p>Build the bindings</p> <p>You have two options from here:</p> <p>a. Build a wheel</p> <pre><code>maturin build --release\n</code></pre> <p>This produces a <code>.whl</code> file in the <code>target/wheels/</code> directory.</p> <p>b. Install into your virtual environment directly</p> <pre><code>maturin develop\n</code></pre>","tags":["cedarling","python","getting-started"]},{"location":"cedarling/tutorials/python/#including-in-projects","title":"Including in projects","text":"<p>If you're using a dependency manager like Poetry, you can:</p> <p>Option 1: Add the wheel via CLI</p> <pre><code>poetry add path/to/wheel.whl\n</code></pre> <p>Option 2: Install it manually into Poetry's virtual environment</p> <pre><code>poetry run pip install path/to/wheel.whl\n</code></pre> <p>Option 3: Add it to <code>pyproject.toml</code> statically</p> <pre><code>[tool.poetry.dependencies]\ncedarling_python = {path = \"path/to/wheel.whl\"}\n</code></pre> <p>For other dependency managers, refer to their documentation on how to use local wheels.</p>","tags":["cedarling","python","getting-started"]},{"location":"cedarling/tutorials/python/#usage","title":"Usage","text":"","tags":["cedarling","python","getting-started"]},{"location":"cedarling/tutorials/python/#initialization","title":"Initialization","text":"<pre><code># Load the bootstrap properties from the environment variable, using default values\n# for unset properties\nbootstrap_config = BootstrapConfig.from_env()\n\n# Initialize Cedarling\ncedarling = Cedarling(bootstrap_config)\n</code></pre> <p>See the python documentation for <code>BootstrapConfig</code> for other config loading options.</p>","tags":["cedarling","python","getting-started"]},{"location":"cedarling/tutorials/python/#policy-store-sources","title":"Policy Store Sources","text":"<p>Python bindings support all policy store source types. See Cedarling Properties for the full list of configuration options.</p> <p>Example configurations:</p> <pre><code># Load from a directory\nos.environ[\"CEDARLING_POLICY_STORE_LOCAL_FN\"] = \"/path/to/policy-store/\"\nbootstrap_config = BootstrapConfig.from_env()\n\n# Load from a local .cjar archive (Cedar Archive)\nos.environ[\"CEDARLING_POLICY_STORE_LOCAL_FN\"] = \"/path/to/policy-store.cjar\"\nbootstrap_config = BootstrapConfig.from_env()\n\n# Load from a remote .cjar archive (Cedar Archive)\nos.environ[\"CEDARLING_POLICY_STORE_URI\"] = \"https://example.com/policy-store.cjar\"\nbootstrap_config = BootstrapConfig.from_env()\n</code></pre> <p>See Policy Store Formats for more details.</p>","tags":["cedarling","python","getting-started"]},{"location":"cedarling/tutorials/python/#authorization","title":"Authorization","text":"<p>Cedarling provides two main interfaces for performing authorization checks: Token-Based Authorization and Unsigned Authorization. Both methods involve evaluating access requests based on various factors, including principals (entities), actions, resources, and context. The difference lies in how the Principals are provided.</p> <ul> <li>Token-Based Authorization is the standard method where principals are extracted from JSON Web Tokens (JWTs), typically used in scenarios where you have existing user authentication and authorization data encapsulated in tokens.</li> <li>Unsigned Authorization allows you to pass principals directly, bypassing tokens entirely. This is useful when you need to authorize based on internal application data, or when tokens are not available.</li> </ul>","tags":["cedarling","python","getting-started"]},{"location":"cedarling/tutorials/python/#token-based-authorization","title":"Token-Based Authorization","text":"<p>To perform an authorization check, follow these steps:</p> <p>1. Prepare tokens</p> <pre><code>access_token = \"&lt;access_token&gt;\"\nid_token = \"&lt;id_token&gt;\"\nuserinfo_token = \"&lt;userinfo_token&gt;\"\n</code></pre> <p>Your principals will be built from these tokens.</p> <p>2. Define the resource</p> <pre><code>resource = EntityData(\n  cedar_entity_mapping=CedarEntityMapping(\n    entity_type=\"Jans::Application\",\n    id=\"app_id_001\"\n  ),\n  name=\"App Name\",\n  url={\n    \"host\": \"example.com\",\n    \"path\": \"/admin-dashboard\",\n    \"protocol\": \"https\"\n  }\n)\n</code></pre> <p>3. Define the action</p> <pre><code>action = 'Jans::Action::\"Read\"'\n</code></pre> <p>4. Define Context</p> <pre><code>context = {\n  \"current_time\": int(time.time()),\n  \"device_health\": [\"Healthy\"],\n  \"fraud_indicators\": [\"Allowed\"],\n  \"geolocation\": [\"America\"],\n  \"network\": \"127.0.0.1\",\n  \"network_type\": \"Local\",\n  \"operating_system\": \"Linux\",\n  \"user_agent\": \"Linux\"\n}\n</code></pre> <p>5. Build the request</p> <pre><code>request = Request(\n  tokens={\n    \"access_token\": access_token,\n    \"id_token\": id_token,\n    \"userinfo_token\": userinfo_token,\n  },\n  action=action,\n  resource=resource,\n  context=context\n)\n</code></pre> <p>6. Authorize</p> <pre><code>authorize_result = cedarling.authorize(request)\n</code></pre>","tags":["cedarling","python","getting-started"]},{"location":"cedarling/tutorials/python/#unsigned-authorization","title":"Unsigned Authorization","text":"<p>In unsigned authorization, you pass a set of Principals directly, without relying on tokens. This can be useful when the application needs to perform authorization based on internal data, or when token-based data is not available.</p> <p>1. Define the Principals</p> <pre><code>principals = [\n  EntityData(\n    cedar_entity_mapping=CedarEntityMapping(\n      entity_type=\"Jans::Workload\",\n      id=\"some_workload_id\"\n    ),\n    client_id=\"some_client_id\",\n  ),\n  EntityData(\n    cedar_entity_mapping=CedarEntityMapping(\n      entity_type=\"Jans::User\",\n      id=\"random_user_id\"\n    ),\n    roles=[\"admin\", \"manager\"]\n  ),\n]\n</code></pre> <p>2. Define the Resource</p> <p>This represents the resource that the action will be performed on, such as a protected API endpoint or file.</p> <pre><code>resource = EntityData(\n  cedar_entity_mapping=CedarEntityMapping(\n    entity_type=\"Jans::Application\",\n    id=\"app_id_001\"\n  ),\n  name=\"App Name\",\n  url={\n    \"host\": \"example.com\",\n    \"path\": \"/admin-dashboard\",\n    \"protocol\": \"https\"\n  }\n)\n</code></pre> <p>3. Define the Action</p> <p>An action represents what the principal is trying to do to the resource. For example, read, write, or delete operations.</p> <pre><code>action = 'Jans::Action::\"Write\"'\n</code></pre> <p>4. Define the Context</p> <p>The context represents additional data that may affect the authorization decision, such as time, location, or user-agent.</p> <pre><code>context = {\n    \"current_time\": int(time.time()),\n    \"device_health\": [\"Healthy\"],\n    \"location\": \"US\",\n    \"network\": \"127.0.0.1\",\n    \"operating_system\": \"Linux\",\n}\n</code></pre> <p>5. Build the Request</p> <p>Now you'll construct the request by including the principals, action, and context.</p> <pre><code>request = RequestUnsigned(\n  principals=principals,\n  action=action,\n  resource=resource,\n  context=context\n)\n</code></pre> <p>6. Perform Authorization</p> <p>Finally, call the <code>authorize</code> function to check whether the principals are allowed to perform the specified action on the resource.</p> <pre><code>result = cedarling.authorize_unsigned(request);\n</code></pre>","tags":["cedarling","python","getting-started"]},{"location":"cedarling/tutorials/python/#multi-issuer-authorization","title":"Multi-Issuer Authorization","text":"<p>Multi-issuer authorization allows you to make authorization decisions based on multiple JWT tokens from different issuers without requiring traditional User/Workload principals.</p> <p>1. Create Tokens</p> <pre><code>from cedarling_python import TokenInput\n\ntokens = [\n  TokenInput(\n    mapping=\"Jans::Access_Token\",\n    payload=\"&lt;access_token_jwt&gt;\"\n  ),\n  TokenInput(\n    mapping=\"Jans::Id_Token\",\n    payload=\"&lt;id_token_jwt&gt;\"\n  ),\n  TokenInput(\n    mapping=\"Acme::DolphinToken\",  # Custom token type\n    payload=\"&lt;custom_token_jwt&gt;\"\n  )\n]\n</code></pre> <p>2. Define the Resource</p> <pre><code>resource = EntityData(\n  cedar_entity_mapping=CedarEntityMapping(\n    entity_type=\"Jans::Document\",\n    id=\"doc_123\"\n  ),\n  owner=\"alice@example.com\",\n  classification=\"confidential\"\n)\n</code></pre> <p>3. Define the Action</p> <pre><code>action = 'Jans::Action::\"Read\"'\n</code></pre> <p>4. Define Context</p> <pre><code>context = {\n  \"ip_address\": \"54.9.21.201\",\n  \"time\": int(time.time())\n}\n</code></pre> <p>5. Build the Request</p> <pre><code>from cedarling_python import AuthorizeMultiIssuerRequest\n\nrequest = AuthorizeMultiIssuerRequest(\n  tokens=tokens,\n  action=action,\n  resource=resource,\n  context=context\n)\n</code></pre> <p>6. Perform Authorization</p> <pre><code>result = cedarling.authorize_multi_issuer(request)\n\n# Check decision\nif result.decision:\n  print(\"Access allowed\")\n  print(f\"Request ID: {result.request_id}\")\nelse:\n  print(\"Access denied\")\n</code></pre> <p>Key Differences from standard authentication:</p> Feature authorize authorize_multi_issuer Principal Model User/Workload entities No principals - token-based Token Sources Single issuer expected Multiple issuers supported Result Type <code>AuthorizeResult</code> <code>MultiIssuerAuthorizeResult</code> Decision Access <code>result.is_allowed()</code>, <code>result.workload()</code>, <code>result.person()</code> <code>result.decision</code> (boolean) Use Case Standard RBAC/ABAC Federation, multi-org access","tags":["cedarling","python","getting-started"]},{"location":"cedarling/tutorials/python/#logging","title":"Logging","text":"<p>The logs could be retrieved using the <code>pop_logs</code> function.</p> <pre><code># Obtain latest logs from cedarling\nlogs: dict = cedarling.pop_logs()\n\n# Or obtain by request ID after authorization is performed\nrequest_id = result.request_id()\nlogs: dict = cedarling.get_log_by_id(request_id)\n</code></pre>","tags":["cedarling","python","getting-started"]},{"location":"cedarling/tutorials/python/#see-also","title":"See Also","text":"<ul> <li>Cedarling TBAC quickstart</li> <li>Cedarling Unsigned quickstart</li> <li>Cedarling Sidecar Tutorial</li> <li>Multi-Issuer Authorization Details</li> </ul>","tags":["cedarling","python","getting-started"]},{"location":"cedarling/tutorials/rust/","title":"Getting Started with Cedarling in a Rust app","text":"","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/tutorials/rust/#installation","title":"Installation","text":"","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/tutorials/rust/#building-from-source","title":"Building from source","text":"<p>To get started, clone the Jans repository. The source can be found in the [<code>jans-cedarling/cedarling</code>] directory.</p>","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/tutorials/rust/#requirements","title":"Requirements","text":"<p>If you haven't installed Rust yet, follow the official installation guide:</p> <pre><code>curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh\n</code></pre> <p>After installation, restart your terminal or run:</p> <pre><code>source $HOME/.cargo/env\n</code></pre> <p>Verify the installation:</p> <pre><code>rustc --version\ncargo --version\n</code></pre>","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/tutorials/rust/#building","title":"Building","text":"<p>1. Clone the repository</p> <pre><code>git clone https://github.com/JanssenProject/jans.git\ncd jans/jans-cedarling\n</code></pre> <p>2. Build the library</p> <pre><code>cargo build --release\n</code></pre> <p>3. Run tests</p> <pre><code>cargo test --workspace\n</code></pre> <p>4. Generate documentation</p> <pre><code>cargo doc -p cedarling --no-deps --open\n</code></pre>","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/tutorials/rust/#usage","title":"Usage","text":"","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/tutorials/rust/#initialization","title":"Initialization","text":"<pre><code>use cedarling::*;\n\n// Load the bootstrap properties from the environment variable, using default values\n// for unset properties\nlet bootstrap_config = BootstrapConfig.from_env();\n\n// Initialize Cedarling\nlet cedarling = Cedarling::new(bootstrap_config)\n</code></pre> <p>See the bootstrap properties docs for other config loading options.</p>","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/tutorials/rust/#policy-store-sources","title":"Policy Store Sources","text":"<p>Rust bindings support all policy store source types:</p> Source Type Description <code>PolicyStoreSource::Json(String)</code> Inline JSON policy store <code>PolicyStoreSource::Yaml(String)</code> Inline YAML policy store <code>PolicyStoreSource::FileJson(PathBuf)</code> Local JSON file <code>PolicyStoreSource::FileYaml(PathBuf)</code> Local YAML file <code>PolicyStoreSource::Directory(PathBuf)</code> Local directory with Cedar files <code>PolicyStoreSource::CjarFile(PathBuf)</code> Local Cedar archive file <code>PolicyStoreSource::CjarUrl(String)</code> Remote <code>.cjar</code> archive from URL <code>PolicyStoreSource::LockServer(String)</code> Remote Lock Server <code>PolicyStoreSource::ArchiveBytes(Vec&lt;u8&gt;)</code> Raw archive bytes (custom fetch) <p>Loading from Bytes:</p> <p>For advanced use cases (embedded archives, custom fetch logic):</p> <pre><code>use cedarling::*;\n\n// Option 1: Via PolicyStoreSource enum (recommended)\nlet archive_bytes: Vec&lt;u8&gt; = fetch_archive_with_auth();\nlet config = BootstrapConfig::default()\n    .with_policy_store_source(PolicyStoreSource::ArchiveBytes(archive_bytes));\n\n// Option 2: Direct function call\nuse cedarling::common::policy_store::loader::load_policy_store_archive_bytes;\nlet loaded = load_policy_store_archive_bytes(archive_bytes)?;\n</code></pre> <p>Example programmatic configuration:</p> <pre><code>use cedarling::*;\nuse std::path::PathBuf;\n\n// Load from a directory\nlet config = BootstrapConfig::default()\n    .with_policy_store_source(PolicyStoreSource::Directory(\n        PathBuf::from(\"/path/to/policy-store/\")\n    ));\n\n// Load from a local .cjar archive (Cedar Archive)\nlet config = BootstrapConfig::default()\n    .with_policy_store_source(PolicyStoreSource::CjarFile(\n        PathBuf::from(\"/path/to/policy-store.cjar\")\n    ));\n\n// Load from a remote .cjar archive (Cedar Archive)\nlet config = BootstrapConfig::default()\n    .with_policy_store_source(PolicyStoreSource::CjarUrl(\n        \"https://example.com/policy-store.cjar\".to_string()\n    ));\n</code></pre> <p>See Policy Store Formats for more details.</p>","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/tutorials/rust/#authorization","title":"Authorization","text":"<p>Cedarling provides two main interfaces for performing authorization checks: Token-Based Authorization and Unsigned Authorization. Both methods involve evaluating access requests based on various factors, including principals (entities), actions, resources, and context. The difference lies in how the Principals are provided.</p> <ul> <li>Token-Based Authorization is the standard method where principals are extracted from JSON Web Tokens (JWTs), typically used in scenarios where you have existing user authentication and authorization data encapsulated in tokens.</li> <li>Unsigned Authorization allows you to pass principals directly, bypassing tokens entirely. This is useful when you need to authorize based on internal application data, or when tokens are not available.</li> </ul>","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/tutorials/rust/#token-based-authorization","title":"Token-Based Authorization","text":"<p>To perform an authorization check, follow these steps:</p> <p>1. Prepare tokens</p> <pre><code>let access_token = \"your_access_token_here\".to_string();\nlet id_token = \"your_id_token_here\".to_string();\nlet userinfo_token = \"your_userinfo_token_here\".to_string();\n</code></pre> <p>Your principals will be built from these tokens.</p> <p>2. Define the resource</p> <pre><code>use std::collections::HashMap;\nuse serde_json::json;\n\nlet resource = EntityData {\n  cedar_entity_mapping: CedarEntityMapping {\n    entity_type: \"Jans::Application\".to_string(),\n    id: \"app_id_001\".to_string(),\n  },\n  payload: HashMap::from_iter([\n    (\"protocol\".to_string(), json!(\"https\")),\n    (\"host\".to_string(), json!(\"example.com\")),\n    (\"path\".to_string(), json!(\"/admin-dashboard\")),\n  ]),\n}\n</code></pre> <p>3. Define the action</p> <pre><code>let action = r#\"Jans::Action::\"Read\"\"#.to_string();\n</code></pre> <p>4. Define Context</p> <pre><code>use std::time::{SystemTime, UNIX_EPOCH};\nuse serde_json::json;\n\nlet context = json!({\n    \"current_time\": SystemTime::now().duration_since(UNIX_EPOCH).unwrap().as_millis(),\n    \"device_health\": [\"Healthy\"],\n    \"fraud_indicators\": [\"Allowed\"],\n    \"geolocation\": [\"America\"],\n    \"network\": \"127.0.0.1\",\n    \"network_type\": \"Local\",\n    \"operating_system\": \"Linux\",\n    \"user_agent\": \"Linux\"\n});\n</code></pre> <p>5. Build the request</p> <pre><code>use std::collections::HashMap;\n\nlet request = Request {\n    tokens: HashMap::from([\n        (\"access_token\".to_string(), access_token),\n        (\"id_token\".to_string(), id_token),\n        (\"userinfo_token\".to_string(), userinfo_token),\n    ]),\n    action,\n    resource,\n    context,\n};\n</code></pre> <p>6. Authorize</p> <pre><code>let result = cedarling.authorize(request).await?;\n\nmatch result.decision {\n    true =&gt; println!(\"Access granted\"),\n    false =&gt; println!(\"Access denied: {:?}\", result.diagnostics),\n}\n</code></pre>","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/tutorials/rust/#unsigned-authorization","title":"Unsigned Authorization","text":"<p>In unsigned authorization, you pass a set of Principals directly, without relying on tokens. This can be useful when the application needs to perform authorization based on internal data, or when token-based data is not available.</p> <p>1. Define the Principals</p> <pre><code>use cedarling::*;\nuse std::collections::HashMap;\nuse serde_json::json;\n\nlet principals = vec![\n  EntityData {\n    cedar_entity_mapping: CedarEntityMapping {\n      entity_type: \"Jans::Workload\".to_string(),\n      id: \"some_workload_id\".to_string(),\n    },\n    payload: HashMap::from_iter([\n      (\"client_id\".to_string(), json!(\"some_client_id\")),\n    ]),\n  },\n  EntityData {\n    cedar_entity_mapping: CedarEntityMapping {\n      entity_type: \"Jans::User\".to_string(),\n      id: \"random_user_id\".to_string(),\n    },\n    payload: HashMap::from_iter([\n      (\"roles\".to_string(), json!([\"admin\", \"manager\"])),\n    ]),\n  },\n]\n</code></pre> <p>2. Define the Resource</p> <p>This represents the resource that the action will be performed on, such as a protected API endpoint or file.</p> <pre><code>use std::collections::HashMap;\nuse serde_json::json;\n\nlet resource = EntityData {\n  cedar_entity_mapping: CedarEntityMapping {\n    entity_type: \"Jans::Application\".to_string(),\n    id: \"app_id_001\".to_string(),\n  },\n  payload: HashMap::from_iter([\n    (\"protocol\".to_string(), json!(\"https\")),\n    (\"host\".to_string(), json!(\"example.com\")),\n    (\"path\".to_string(), json!(\"/admin-dashboard\")),\n  ]),\n}\n</code></pre> <p>3. Define the Action</p> <p>An action represents what the principal is trying to do to the resource. For example, read, write, or delete operations.</p> <pre><code>let action = r#\"Jans::Action::\"Read\"\"#.to_string();\n</code></pre> <p>4. Define the Context</p> <p>The context represents additional data that may affect the authorization decision, such as time, location, or user-agent.</p> <pre><code>use std::time::{SystemTime, UNIX_EPOCH};\nuse serde_json::json;\n\nlet context = json!({\n    \"current_time\": SystemTime::now().duration_since(UNIX_EPOCH).unwrap().as_millis(),\n    \"device_health\": [\"Healthy\"],\n    \"fraud_indicators\": [\"Allowed\"],\n    \"geolocation\": [\"America\"],\n    \"network\": \"127.0.0.1\",\n    \"network_type\": \"Local\",\n    \"operating_system\": \"Linux\",\n    \"user_agent\": \"Linux\"\n});\n</code></pre> <p>5. Build the Request</p> <p>Now you'll construct the request by including the principals, action, and context.</p> <pre><code>use std::collections::HashMap;\n\nlet request = RequestUnsigned {\n    principals,\n    action,\n    resource,\n    context,\n};\n</code></pre> <p>6. Perform Authorization</p> <p>Finally, call the <code>authorize_unsigned</code> function to check whether the principals are allowed to perform the specified action on the resource.</p> <pre><code>let result = cedarling.authorize_unsigned(request).await?;\n\nmatch result.decision {\n    true =&gt; println!(\"Access granted\"),\n    false =&gt; println!(\"Access denied: {:?}\", result.diagnostics),\n}\n</code></pre>","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/tutorials/rust/#logging","title":"Logging","text":"<p>The logs could be retrieved using the <code>pop_logs</code> function.</p> <pre><code>let logs = cedarling.pop_logs();\nprintln!(\"{:#?}\", logs);\n</code></pre> <p>For more detailed logging capabilities, see the Cedarling Rust Developer Guide.</p>","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/tutorials/rust/#example","title":"Example","text":"<p>Refer to Cedarling Rust Developer Guide for a complete code example.</p>","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/tutorials/rust/#defined-api","title":"Defined API","text":"<p>Please refer to Cedarling Rust Developer Guide.</p>","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/tutorials/rust/#see-also","title":"See Also","text":"<ul> <li>Cedarling Rust Developer Guide</li> <li>Cedarling TBAC quickstart</li> <li>Cedarling Unsigned quickstart</li> <li>Cedarling Sidecar Tutorial</li> </ul>","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/tutorials/swift/","title":"Getting Started with Cedarling Swift","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p> <p>Have questions in the meantime?</p> <p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p> <p>Want to contribute?</p> <p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["cedarling","rust","getting-started"]},{"location":"cedarling/uniffi/cedarling-sample-inputs/","title":"Cedarling sample inputs","text":""},{"location":"cedarling/uniffi/cedarling-sample-inputs/#bootstrapjson","title":"bootstrap.json","text":"<pre><code>{\n    \"CEDARLING_APPLICATION_NAME\": \"Cedarling-Test-In-Custom-Script\",\n    \"CEDARLING_AUDIT_HEALTH_INTERVAL\": 0,\n    \"CEDARLING_AUDIT_TELEMETRY_INTERVAL\": 0,\n    \"CEDARLING_DYNAMIC_CONFIGURATION\": \"disabled\",\n    \"CEDARLING_ID_TOKEN_TRUST_MODE\": \"never\",\n    \"CEDARLING_JWT_SIGNATURE_ALGORITHMS_SUPPORTED\": [\n    \"HS256\",\n    \"RS256\"\n    ],\n    \"CEDARLING_JWT_SIG_VALIDATION\": \"disabled\",\n    \"CEDARLING_JWT_STATUS_VALIDATION\": \"disabled\",\n    \"CEDARLING_LISTEN_SSE\": \"disabled\",\n    \"CEDARLING_LOCAL_JWKS\": null,\n    \"CEDARLING_LOCK\": \"disabled\",\n    \"CEDARLING_LOCK_SSA_JWT\": null,\n    \"CEDARLING_LOG_LEVEL\": \"DEBUG\",\n    \"CEDARLING_LOG_TYPE\": \"std_out\",\n    \"CEDARLING_POLICY_STORE_ID\": \"cdeb4b635459898300a5893589a76b726e202dcb5a86\",\n    \"CEDARLING_POLICY_STORE_URI\": \"./custom/static/policy-store.json\",\n    \"CEDARLING_PRINCIPAL_BOOLEAN_OPERATION\": {\n    \"===\": [\n            {\n            \"var\": \"Jans::Workload\"\n            },\n            \"ALLOW\"\n        ]\n    },\n    \"CEDARLING_USER_AUTHZ\": \"enabled\",\n    \"CEDARLING_WORKLOAD_AUTHZ\": \"enabled\",\n    \"id\": \"7a962b6e-aa45-4418-a94a-ee382d20a723\"\n}\n</code></pre>"},{"location":"cedarling/uniffi/cedarling-sample-inputs/#policy-storejson","title":"policy-store.json","text":"<pre><code>{\n    \"cedar_version\": \"4.4.0\",\n    \"policy_stores\": {\n        \"3cf98caf8e7fdb289c922ba9514118dcba716ce426ae\": {\n        \"name\": \"admin_ui_store\",\n        \"description\": \"Admin UI Policy Store\\t\",\n        \"policies\": {\n        \"7c52efd895db799901d8590a2c5e3a76539d4a6de514\": {\n            \"description\": \"Authorization policy\",\n            \"creation_date\": \"2025-06-09T12:32:26.114299\",\n            \"policy_content\": \"QGlkKCJBdXRob3JpemF0aW9uIHBvbGljeSIpCnBlcm1pdCAoCiAgcHJpbmNpcGFsIGlzIEphbnM6Oldvcmtsb2FkLAogIGFjdGlvbiA9PSBKYW5zOjpBY3Rpb246OiJFeGVjdXRlIiwKICByZXNvdXJjZSBpcyBKYW5zOjpBcHBsaWNhdGlvbgopCndoZW4gewogIHByaW5jaXBhbC5ncmFudFR5cGVzLmNvbnRhaW5zKCJhdXRob3JpemF0aW9uX2NvZGUiKQp9Ow==\"\n            }\n        },\n        \"trusted_issuers\": {},\n        \"schema\": \"eyJKYW5zIjp7ImNvbW1vblR5cGVzIjp7IkNvbnRleHQiOnsidHlwZSI6IlJlY29yZCIsImF0dHJpYnV0ZXMiOnsiY3VycmVudF90aW1lIjp7InR5cGUiOiJFbnRpdHlPckNvbW1vbiIsInJlcXVpcmVkIjpmYWxzZSwibmFtZSI6IkxvbmcifSwiZGV2aWNlX2hlYWx0aCI6eyJ0eXBlIjoiU2V0IiwicmVxdWlyZWQiOmZhbHNlLCJlbGVtZW50Ijp7InR5cGUiOiJFbnRpdHlPckNvbW1vbiIsIm5hbWUiOiJTdHJpbmcifX0sImZyYXVkX2luZGljYXRvcnMiOnsidHlwZSI6IlNldCIsInJlcXVpcmVkIjpmYWxzZSwiZWxlbWVudCI6eyJ0eXBlIjoiRW50aXR5T3JDb21tb24iLCJuYW1lIjoiU3RyaW5nIn19LCJnZW9sb2NhdGlvbiI6eyJ0eXBlIjoiU2V0IiwicmVxdWlyZWQiOmZhbHNlLCJlbGVtZW50Ijp7InR5cGUiOiJFbnRpdHlPckNvbW1vbiIsIm5hbWUiOiJTdHJpbmcifX0sIm5ldHdvcmsiOnsidHlwZSI6IkVudGl0eU9yQ29tbW9uIiwicmVxdWlyZWQiOmZhbHNlLCJuYW1lIjoiU3RyaW5nIn0sIm5ldHdvcmtfdHlwZSI6eyJ0eXBlIjoiRW50aXR5T3JDb21tb24iLCJyZXF1aXJlZCI6ZmFsc2UsIm5hbWUiOiJTdHJpbmcifSwib3BlcmF0aW5nX3N5c3RlbSI6eyJ0eXBlIjoiRW50aXR5T3JDb21tb24iLCJyZXF1aXJlZCI6ZmFsc2UsIm5hbWUiOiJTdHJpbmcifSwidXNlcl9hZ2VudCI6eyJ0eXBlIjoiRW50aXR5T3JDb21tb24iLCJyZXF1aXJlZCI6ZmFsc2UsIm5hbWUiOiJTdHJpbmcifX19LCJlbWFpbF9hZGRyZXNzIjp7InR5cGUiOiJSZWNvcmQiLCJhdHRyaWJ1dGVzIjp7ImRvbWFpbiI6eyJ0eXBlIjoiRW50aXR5T3JDb21tb24iLCJuYW1lIjoiU3RyaW5nIn0sInVpZCI6eyJ0eXBlIjoiRW50aXR5T3JDb21tb24iLCJuYW1lIjoiU3RyaW5nIn19fSwiVXJsIjp7InR5cGUiOiJTdHJpbmcifX0sImVudGl0eVR5cGVzIjp7IkFwcGxpY2F0aW9uIjp7InNoYXBlIjp7InR5cGUiOiJSZWNvcmQiLCJhdHRyaWJ1dGVzIjp7ImdyYW50VHlwZXMiOnsidHlwZSI6IlNldCIsImVsZW1lbnQiOnsidHlwZSI6IkVudGl0eU9yQ29tbW9uIiwibmFtZSI6IlN0cmluZyJ9fX19fSwiUm9sZSI6eyJzaGFwZSI6eyJ0eXBlIjoiUmVjb3JkIiwiYXR0cmlidXRlcyI6e319fSwiVHJ1c3RlZElzc3VlciI6eyJzaGFwZSI6eyJ0eXBlIjoiUmVjb3JkIiwiYXR0cmlidXRlcyI6eyJpc3N1ZXJfZW50aXR5X2lkIjp7InR5cGUiOiJFbnRpdHlPckNvbW1vbiIsIm5hbWUiOiJVcmwifX19fSwiVXNlciI6eyJzaGFwZSI6eyJ0eXBlIjoiUmVjb3JkIiwiYXR0cmlidXRlcyI6eyJlbWFpbCI6eyJ0eXBlIjoiRW50aXR5T3JDb21tb24iLCJyZXF1aXJlZCI6ZmFsc2UsIm5hbWUiOiJlbWFpbF9hZGRyZXNzIn0sInJvbGUiOnsidHlwZSI6IlNldCIsImVsZW1lbnQiOnsidHlwZSI6IkVudGl0eU9yQ29tbW9uIiwibmFtZSI6IlN0cmluZyJ9fSwic3ViIjp7InR5cGUiOiJFbnRpdHlPckNvbW1vbiIsInJlcXVpcmVkIjpmYWxzZSwibmFtZSI6IlN0cmluZyJ9fX0sIm1lbWJlck9mVHlwZXMiOlsiUm9sZSJdfSwiV29ya2xvYWQiOnsic2hhcGUiOnsidHlwZSI6IlJlY29yZCIsImF0dHJpYnV0ZXMiOnsiY2xpZW50X2lkIjp7InR5cGUiOiJFbnRpdHlPckNvbW1vbiIsIm5hbWUiOiJTdHJpbmcifSwiaXNzIjp7InR5cGUiOiJFbnRpdHlPckNvbW1vbiIsInJlcXVpcmVkIjpmYWxzZSwibmFtZSI6IlRydXN0ZWRJc3N1ZXIifSwibmFtZSI6eyJ0eXBlIjoiRW50aXR5T3JDb21tb24iLCJyZXF1aXJlZCI6ZmFsc2UsIm5hbWUiOiJTdHJpbmcifSwicnBfaWQiOnsidHlwZSI6IkVudGl0eU9yQ29tbW9uIiwicmVxdWlyZWQiOmZhbHNlLCJuYW1lIjoiU3RyaW5nIn0sInNwaWZmZV9pZCI6eyJ0eXBlIjoiRW50aXR5T3JDb21tb24iLCJyZXF1aXJlZCI6ZmFsc2UsIm5hbWUiOiJTdHJpbmcifSwiZ3JhbnRUeXBlcyI6eyJ0eXBlIjoiU2V0IiwiZWxlbWVudCI6eyJ0eXBlIjoiRW50aXR5T3JDb21tb24iLCJuYW1lIjoiU3RyaW5nIn19fX19fSwiYWN0aW9ucyI6eyJFeGVjdXRlIjp7ImFwcGxpZXNUbyI6eyJwcmluY2lwYWxUeXBlcyI6WyJXb3JrbG9hZCJdLCJyZXNvdXJjZVR5cGVzIjpbIkFwcGxpY2F0aW9uIl0sImNvbnRleHQiOnsidHlwZSI6IkNvbnRleHQifX19fX19\"\n        }\n    }\n}\n</code></pre>"},{"location":"cedarling/uniffi/cedarling-sample-inputs/#sample_cedarling_update_tokenjava","title":"sample_cedarling_update_token.java","text":"<pre><code>import io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.token.UpdateTokenType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport uniffi.cedarling_uniffi.*;\nimport io.jans.cedarling.binding.wrapper.CedarlingAdapter;\nimport java.util.Map;\nimport io.jans.as.server.service.external.context.ExternalUpdateTokenContext;\nimport io.jans.as.server.model.common.AccessToken;\nimport org.json.JSONObject;\nimport java.util.List;\nimport java.util.ArrayList;\nimport io.jans.as.model.common.GrantType;\nimport java.io.IOException;\nimport java.nio.file.Files;\nimport java.nio.file.Path;\nimport java.nio.file.Paths;\nimport com.google.common.collect.Sets;\n\n\npublic class UpdateTokenCedarling implements UpdateTokenType {\n\n    private static final Logger log = LoggerFactory.getLogger(CustomScriptManager.class);\n    CedarlingAdapter cedarlingAdapter = null;\n\n\n    public boolean init(Map &lt; String, SimpleCustomProperty &gt; configurationAttributes) {\n        log.info(\"UpdateTokenCedarling initialized!!!\");\n        // Check if bootstrap JSON file path is configured\n        if (!configurationAttributes.containsKey(\"BOOTSTRAP_JSON_PATH\")) {\n            log.error(\"Initialization. Property bootstrap_file_path is not specified.\");\n            return true;\n        }\n        log.info(\"Initialize Cedarling...\");\n\n        // Get bootstrap file path\n        String bootstrapFilePath = configurationAttributes.get(\"BOOTSTRAP_JSON_PATH\").getValue2();\n\n        String bootstrapJson = null;\n        try {\n            // Read bootstrap JSON from file\n            bootstrapJson = readFile(bootstrapFilePath);\n            // Initialize Cedarling adapter\n            cedarlingAdapter = new CedarlingAdapter();\n            cedarlingAdapter.loadFromJson(bootstrapJson);\n        } catch (CedarlingException e) {\n            log.error(\"Unable to initialize Cedarling\" + e.getMessage());\n            return true;\n        } catch (Exception e) {\n            log.error(\"Unable to initialize Cedarling\" + e.getMessage());\n            return true;\n        }\n        log.info(\"Cedarling Initialization successful...\");\n\n        return true;\n    }\n\n    public boolean init(CustomScript customScript, Map &lt; String, SimpleCustomProperty &gt; configurationAttributes) {\n        log.info(\"UpdateTokenCedarling initialized!!!\");\n        // Check if bootstrap JSON file path is configured\n        if (!configurationAttributes.containsKey(\"BOOTSTRAP_JSON_PATH\")) {\n            log.error(\"Initialization. Property bootstrap_file_path is not specified.\");\n            return true;\n        }\n        log.info(\"Initialize Cedarling...\");\n\n        // Get bootstrap file path\n        String bootstrapFilePath = configurationAttributes.get(\"BOOTSTRAP_JSON_PATH\").getValue2();\n\n        String bootstrapJson = null;\n        try {\n            // Read bootstrap JSON from file\n            bootstrapJson = readFile(bootstrapFilePath);\n            // Initialize Cedarling adapter\n            cedarlingAdapter = new CedarlingAdapter();\n            cedarlingAdapter.loadFromJson(bootstrapJson);\n        } catch (CedarlingException e) {\n            log.error(\"Unable to initialize Cedarling\" + e.getMessage());\n            return true;\n        } catch (Exception e) {\n            log.error(\"Unable to initialize Cedarling\" + e.getMessage());\n            return true;\n        }\n        log.info(\"Cedarling Initialization successful...\");\n\n        return true;\n    }\n\n    public boolean destroy(Map &lt; String, SimpleCustomProperty &gt; configurationAttributes) {\n        return true;\n    }\n\n    public int getApiVersion() {\n        return 1;\n    }\n\n    @Override\n    public boolean modifyIdToken(Object jwr, Object tokenContext) {\n        return false;\n    }\n\n    @Override\n    public boolean modifyRefreshToken(Object refreshToken, Object tokenContext) {\n        return false;\n    }\n\n    @Override\n    public boolean modifyAccessToken(Object accessTokenObj, Object contextObj) {\n        try {\n            AccessToken accessToken = (AccessToken) accessTokenObj;\n            ExternalUpdateTokenContext context = (ExternalUpdateTokenContext) contextObj;\n\n            // Collect client grant types\n            List &lt; String &gt; grantTypes = new ArrayList &lt; &gt; ();\n            for (GrantType gt: context.getClient().getGrantTypes()) {\n                grantTypes.add(gt.getValue());\n            }\n\n            // Build principal and resource entities\n            JSONObject principalJson = buildPrincipalJson(context.getClient().getClientId(), grantTypes);\n            JSONObject resourceJson = buildResourceJson(grantTypes);\n\n            // Convert principal JSON to EntityData\n            List &lt; EntityData &gt; principalEntities =\n                List.of(EntityData.Companion.fromJson(principalJson.toString()));\n\n            // Empty context (placeholder for future extension)\n            JSONObject contextJson = new JSONObject(\"{}\");\n\n            // Call Cedarling authorization\n            AuthorizeResult result = cedarlingAdapter.authorizeUnsigned(\n                principalEntities,\n                \"Jans::Action::\\\"Execute\\\"\",\n                resourceJson,\n                contextJson\n            );\n\n            log.info(\"Cedarling Authz Response Decision: {}\", result.getDecision());\n\n            // If authorized \u2192 overwrite scopes\n            if (result.getDecision()) {\n                context.overwriteAccessTokenScopes(accessToken, Sets.newHashSet(\"openid\", \"profile\"));\n                return true;\n            }\n\n        } catch (AuthorizeException | EntityException e) {\n            log.error(\"Error in Cedarling Authz\", e);\n            return false;\n        }\n\n        return false;\n    }\n\n    /** Helper: Build Principal JSON \n     * {\n     *    \"cedar_entity_mapping\": {\n     *        \"entity_type\": \"Jans::Workload\",\n     *        \"id\": \"wl_id\"\n     *    },\n     *    \"client_id\": \"xxxxxxxx-xxxxx-xxxx-xxxxxxxx\",\n     *    \"grantTypes\": [\"authorization_code\", \"refresh_token\"]\n     *}\n     * */\n    private JSONObject buildPrincipalJson(String clientId, List &lt; String &gt; grantTypes) {\n        JSONObject json = new JSONObject();\n        json.put(\"cedar_entity_mapping\", new JSONObject()\n            .put(\"entity_type\", \"Jans::Workload\")\n            .put(\"id\", \"wl_id\"));\n        json.put(\"client_id\", clientId);\n        json.put(\"grantTypes\", grantTypes);\n\n        log.debug(\"Principal JSON: {}\", json);\n        return json;\n    }\n\n    /** Helper: Build Resource JSON \n     * \n     * {\n     *    \"cedar_entity_mapping\": {\n     *        \"entity_type\": \"Jans::Application\",\n     *        \"id\": \"app_id\"\n     *    },\n     *    \"grantTypes\": [\"authorization_code\", \"client_credentials\"]\n     *}\n     * */\n    private JSONObject buildResourceJson(List &lt; String &gt; grantTypes) {\n        JSONObject json = new JSONObject();\n        json.put(\"cedar_entity_mapping\", new JSONObject()\n            .put(\"entity_type\", \"Jans::Application\")\n            .put(\"id\", \"app_id\"));\n        json.put(\"grantTypes\", grantTypes);\n\n        log.debug(\"Resource JSON: {}\", json);\n        return json;\n    }\n\n    @Override\n    public int getRefreshTokenLifetimeInSeconds(Object tokenContext) {\n        return 0;\n    }\n\n    @Override\n    public int getIdTokenLifetimeInSeconds(Object context) {\n        return 0;\n    }\n\n    @Override\n    public int getAccessTokenLifetimeInSeconds(Object context) {\n        return 0;\n    }\n\n    public String readFile(String filePath) {\n        Path path = Paths.get(filePath).toAbsolutePath();\n        try {\n            return Files.readString(path);\n        } catch (IOException e) {\n            throw new RuntimeException(e);\n        }\n    }\n\n}\n</code></pre>"},{"location":"contribute/developer-faq/","title":"Developer FAQs","text":"","tags":["developer","faq"]},{"location":"contribute/developer-faq/#how-to-enable-debug-logs-for-jans-cli-and-tui-configuration-tools","title":"How to enable debug logs for jans-cli and TUI configuration tools","text":"<p>By default, logging is not enabled for CLI or TUI tools on Janssen Server. Follow the steps below to enable and configure logging for CLI and TUI tools:</p> <ul> <li>Log in as root user</li> <li>open config file for editing <code>~/.config/jans-cli.ini</code></li> <li>Update value for <code>debug</code> to <code>true</code> and add new entry for <code>log_dir</code> key with value pointing to directory where logs need to be generated. e.g    <pre><code>debug = true\nlog_dir = /opt/jans\n</code></pre></li> <li>Close currently open TUI session if any and open a new one</li> <li>Logs should get available at location configured in <code>log_dir</code> in files <code>cli_debug.log</code> and <code>dev-tui.log</code></li> </ul>","tags":["developer","faq"]},{"location":"contribute/developer-faq/#how-to-get-certificate-from-lets-encrypt","title":"How to get certificate from Let's encrypt","text":"<p><code>Let's Encrypt</code> is a CA that provides free CA certificates. You can use these certificates to enable HTTPS communication with Janssen Server. Refer to this  guide from Let's Encrypt to know more. We have compiled a set of commands for different OS platforms to help you as a quick reference to generate Let's Encrypt CA certificates.</p>","tags":["developer","faq"]},{"location":"contribute/developer-faq/#suse","title":"Suse","text":"<pre><code>sudo zypper -n install certbot\n</code></pre> <pre><code>sudo certbot certonly --webroot -w /srv/www/htdocs -d FQDN\n</code></pre>","tags":["developer","faq"]},{"location":"contribute/developer-faq/#ubuntu","title":"Ubuntu","text":"<p><pre><code>sudo apt update &amp;&amp; sudo apt install certbot python3-certbot-apache\n</code></pre> <pre><code>sudo certbot --apache -d FQDN\n</code></pre></p> <p>To check certbot status <pre><code>sudo systemctl status certbot.timer\n</code></pre></p> <p>To renew certificate run <pre><code>sudo certbot renew --dry-run\n</code></pre></p>","tags":["developer","faq"]},{"location":"contribute/developer-faq/#rhel","title":"RHEL","text":"<p><pre><code>sudo yum install certbot python3-certbot-apache\n</code></pre> <pre><code>sudo certbot certonly --apache\n</code></pre></p>","tags":["developer","faq"]},{"location":"contribute/developer-faq/#how-to-install-janssen-server-openbanking-for-testing","title":"How to install Janssen Server OpenBanking for testing?","text":"<p>Note</p> <ul> <li>Use this installation for testing only</li> <li>Good understanding of Janssen Server installation process in general is a prerequisite. Here we are just highlighting steps without a lot of details. Visit installation documentation for complete understanding.</li> </ul> <p>This installation uses Gluu Testing certificate.</p>","tags":["developer","faq"]},{"location":"contribute/developer-faq/#download-installer","title":"Download Installer","text":"<pre><code>wget https://raw.githubusercontent.com/JanssenProject/jans/nightly/jans-linux-setup/jans_setup/install.py -O install.py\n</code></pre>","tags":["developer","faq"]},{"location":"contribute/developer-faq/#execute-installer","title":"Execute Installer","text":"<pre><code>python3 install.py --profile=openbanking --args=\"-ob-key-fn=/opt/jans/jans-setup/openbanking/static/ob-gluu-test.key -static-kid=ob-gluu-test -jwks-uri=https://ox.gluu.org/icrby8xcvbcv/ob/ob-gluu-test.jwks --disable-ob-auth-script -ob-alias=ob-gluu-test\"\n</code></pre> <p>Please enter defaults for the following questions (press just enter key), it will download certificate from jwksUri</p> <pre><code>Use external key? [Y|n] : y\n  Openbanking Key File [/opt/jans/jans-setup/openbanking/static/ob-gluu-test.key] : \n  Openbanking Certificate File [/root/obsigning.pem] : \n  Openbanking Key Alias [ob-gluu-test] : \n</code></pre>","tags":["developer","faq"]},{"location":"contribute/developer-faq/#configure-certificate","title":"Configure Certificate","text":"<pre><code> jans cli -CC /opt/jans/jans-setup/output/CA/client.crt -CK /opt/jans/jans-setup/output/CA/client.key\n</code></pre>","tags":["developer","faq"]},{"location":"contribute/developer-faq/#test","title":"Test","text":"<p>This test uses Gluu Testing certificate.</p>","tags":["developer","faq"]},{"location":"contribute/developer-faq/#device-authentication","title":"device authentication","text":"<p>After installation we have to complete device authentication to use openbanking.</p>","tags":["developer","faq"]},{"location":"contribute/developer-faq/#testing-using-im-mode","title":"Testing using IM mode","text":"<p>launch jans-cli using below command</p> <p><pre><code>jans cli -CC /opt/jans/jans-setup/output/CA/client.crt -CK /opt/jans/jans-setup/output/CA/client.key\n</code></pre> further testing is same as jans server</p>","tags":["developer","faq"]},{"location":"contribute/developer-faq/#testing-using-command-line-mode","title":"Testing using command line mode","text":"<p>we can run below command at command line. for ex: <pre><code>jans cli -CC /opt/jans/jans-setup/output/CA/client.crt -CK /opt/jans/jans-setup/output/CA/client.key \u2013operation-id get-oauth-openid-clients\n</code></pre></p> <p>same way we can run  other commands. rest is same for jans and openbanking</p>","tags":["developer","faq"]},{"location":"contribute/testing/","title":"Test And Quality Assurance For Janssen Project","text":"<p>The Janssen Project is a large, complex project with tons of inter-dependency.  If we aren't test-driven, anarchy will ensue.</p> <p>Every line of code at Janssen Project goes through various tests at different stages of development. Most of these tests are automated and executed as part of our CI-CD pipeline, while others are executed manually.</p>","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#unit-testing","title":"Unit testing","text":"<p>Do not submit any code without a corresponding unit test. Also, any bug fixes should increment unit test coverage. All unit tests are executed with any subsequent Jenkins build.</p>","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#component-testing","title":"Component testing","text":"<p>Component testing uses real-world use cases to exercise a portion of the software, using typical data inputs. Developers should document component stories and submit them to the component test library for the respective repository. A tester should be able to run component tests manually. Component tests should run automatically with each Jenkins build.</p> <p>The OpenID Foundation certification tests supplement the component testing library, and should be run for each major release of the software for which they are available.</p>","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#performance-testing","title":"Performance testing","text":"<p>Performance tests are critical to optimization of the persistence and caching implementation. All major releases of the software should be tested for performance with all supported database and cache configurations using the Cloud Native distribution. The VM distribution will not be performance tested, as the main goal for this distribution is development and small deployments. The JMeter test tool should be used to generate the load. These tests are published so community members can run their own bench-marking analysis.</p> <p>In addition to standard performance testing, it\u2019s highly recommended to perform full benchmarking to understand your system\u2019s performance under load. The Benchmarking Documentation provides a comprehensive guide for testing with JMeter scripts and other load generation tools.</p>","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#ha-tests","title":"HA Tests","text":"<p>HA tests should be run against the Cloud Native distribution, which by design is active-active with no single point of failure. The HA testing should simulate taking down various pieces of infrastructure, to see if authentications can still proceed. Also, what happens to transactions that were in progress during the crash?</p>","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#penetration-tests","title":"Penetration tests","text":"<p>Penetration testing is highly deployment specific. Depending on different implementations of the Janssen Project software, you may achieve different levels of risk mitigation. Thus it is important that organizations that operate their own IAM platform based on Janssen perform their own penetration testing.</p>","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#dependency-vulnerabilities","title":"Dependency Vulnerabilities","text":"<p>Dependency vulnerabilities are monitored by GitHub. In addition we plan to use the Linux Foundation Community Bridge vulnerability detection platform.</p>","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#contributing-to-the-documentation","title":"Contributing to the Documentation","text":"<p>While contributing documentation to official Janssen Project documentation it is important to ensure the following.</p> <ul> <li>Changes adhere to the style guidelines </li> <li>Changes have been proofread to remove any typographical or grammatical errors</li> <li>If section titles are being updated or removed, check and update any reference links to that section.</li> <li>Changes render correctly on the documentation static site</li> </ul> <p>The command below will checkout the documentation and deploy the static site locally. Any changes made to the local documentation will be live reloaded on the locally deployed static site.</p> <pre><code>git clone --depth 100 --filter blob:none --no-checkout https://github.com/janssenproject/jans \\\n    &amp;&amp; cd jans \\\n    &amp;&amp; git sparse-checkout init --cone \\\n    &amp;&amp; git checkout main \\\n    &amp;&amp; git sparse-checkout add docs \\\n    &amp;&amp; git sparse-checkout add --skip-checks mkdocs.yml \\\n    &amp;&amp; cd docs \\\n    &amp;&amp; poetry install --no-root \\\n    &amp;&amp; poetry run mkdocs serve -f ../mkdocs.yml\n</code></pre>","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#open-banking","title":"Open Banking","text":"<p>We are working on developing this content under issue 2548. If you\u2019d like to contribute the content, get started with the Contribution Guide</p>","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#how-to-test-openbanking","title":"How to test OpenBanking?","text":"<p>This test uses a Gluu Testing Certificate.</p>","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#device-authentication","title":"device authentication","text":"<p>After installation, we have to complete device authentication to use OpenBanking.</p>","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#testing-using-commnd-line-mode","title":"Testing using commnd line mode","text":"<p>We can run the below command on the command line. For example:</p> <pre><code>jans cli -CC /opt/jans/jans-setup/output/CA/client.crt -CK /opt/jans/jans-setup/output/CA/client.key \u2013operation-id get-oauth-openid-clients\n</code></pre> <p>in the same way we can run other commands. Rest of the testing is same for jans and openbanking.</p>","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#release-quality-assurance","title":"Release Quality Assurance","text":"<p>Once all the code changes for a particular release have been committed, we perform a set of tests and go through a list of checkpoints to make sure release candidate (RC) build is healthy and functioning well.</p>","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#pre-release-qa-checklist","title":"Pre-release QA checklist","text":"<p>As part of pre-release QA check, we run a set of manual sanity checks on test environments with various deployment configurations.</p>","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#test-environments","title":"Test Environments","text":"# OS Platform Persistance Type Deployment Type (VM/CN) Test 2 SUSE 15 Mysql VM installation and sanity testing 3 SUSE 15 Pgsql VM installation and sanity testing 5 RHEL 8 Mysql VM installation and sanity testing 6 RHEL 8 Pgsql VM installation and sanity testing 8 Ubuntu20 Mysql VM installation and sanity testing 9 Ubuntu20 Pgsql VM installation and sanity testing 11 Ubuntu22 Mysql VM installation and sanity testing 12 Ubuntu22 Pgsql VM installation and sanity testing","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#sanity-checks","title":"Sanity checks","text":"<ul> <li>Review functioning of <code>.well-known</code> endpoints for OpenId, Fido, UMA, SCIM modules </li> <li>Test device authentication flow using TUI  </li> <li>Test password authentication flow using Jans Tarp </li> <li>Test Agama project deployment and functioning  </li> </ul>","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/testing/#post-release-qa-checklist","title":"Post-release QA checklist","text":"# QA Checks 1 Package installation verification on all OS Platforms as in pre-release tests","tags":["administration","contribute","Testing","Quality Assurance"]},{"location":"contribute/ci-cd/release-process/","title":"Release Process","text":"<p>The release process starts on scheduled times detailed in the milestones of the Janssen project. The release manager is responsible for coordinating the release process and ensuring that all steps are completed. The process is as follows:</p> <ol> <li>Release Planning: The release manager creates a release plan that normally includes the release date, the version number, and the main features that will be included in the release. The release plan is shared with the team for review and feedback.</li> <li>Feature Freeze: The release manager announces the feature freeze date. After this date, no new features will be added to the release. The team focuses on fixing bugs and improving the quality of the release. QA starts testing the release.</li> <li>Code Freeze: The release manager announces the code freeze date. After this date, no new code will be added to the release. The team focuses on fixing bugs and improving the quality of the release. QA team verifies testing the release.</li> <li>Release Candidate: The release manager creates a release candidate and shares it with the team for testing. The team tests the release candidate and reports any issues found. The release manager fixes the issues and creates a new release candidate. This process continues until the release candidate is stable. This is normally done via a PR process and release branch following the structure <code>release-&lt;version&gt;</code>.</li> <li>Release: The release manager creates the final release and shares it with the team. The team tests the final release and reports any issues found. The release manager fixes the issues and creates a new release. This process continues until the final release is stable.</li> <li>Release Notes: The release manager creates the release notes and shares them with the team. The release notes include the version number, the main features included in the release, and any known issues. The release notes are shared with the community. This process is automated and picked up through conventional commits developers submit.</li> <li>Release Announcement: The release manager announces the release to the community. The announcement includes the version number, the main features included in the release, and any known issues. The announcement is shared on the Janssen website, the Janssen blog, and social media. The release manager also sends an email to the Janssen mailing list.</li> <li>Post-Release: The release manager monitors the release and addresses any issues that arise. The team continues to work on the next release.</li> <li>Release Retrospective: The release manager conducts a retrospective to review the release process and identify areas for improvement. The team provides feedback on the release process. The release manager uses this feedback to improve the release process for future releases.</li> <li>Next Release Planning: The release manager starts planning the next release. The process starts again from step 1. A branch <code>release-&lt;version&gt;</code> is created for the next dev and snapshot release with a similar process from step 1 and is merged into <code>main</code>.</li> </ol>","tags":["Release","faq"]},{"location":"contribute/ci-cd/release-process/#future-plans","title":"Future plans","text":"<p>We are planning a full move to SemVer for all Janssen projects that will be scheduled bi-weekly. In this move, the Google <code>release-please</code> GitHub workflow  will be activated to automatically release the projects according to the conventional commits submitted.</p>","tags":["Release","faq"]},{"location":"contribute/development/development/","title":"Developing for Janssen Project","text":"<p>This section provides useful resources and how-tos to the developers who want to participate in the development of the Janssen Project.</p> <ul> <li>Setup local development workspace using Eclipse</li> <li>Remote debug Janssen Server</li> <li>Run integration tests locally</li> <li>Useful tools and techniques</li> </ul> <p>Explore left navigation bar on the documentation site for complete list.</p>"},{"location":"contribute/development/local-run-under-eclipse/","title":"Local Run Under Eclipse","text":"<p>Follow this step-by-step guide to install, configure, and run <code>Jans CE</code> and its components (including OpenDJ and FIDO2) in a local development environment using Eclipse.</p>","tags":["development","contribute","workspace","eclipse"]},{"location":"contribute/development/local-run-under-eclipse/#data-preparation","title":"Data preparation","text":"<ol> <li>Install Jans CE into VM with all required components. During install select LDAP server. It's most easier way to copy data developer workstation</li> <li>Copy folders to local disk to tree like this:</li> </ol> <pre><code>  D:\\Developement\\jans\\jans_1.1.3-2024-07-08\n   |-etc\n     |- certs\\*\n     |- jans\\*\n   |-jans-setup\n   |-jython-2.7.4\n   |-opendj\n</code></pre>","tags":["development","contribute","workspace","eclipse"]},{"location":"contribute/development/local-run-under-eclipse/#eclipse-plugins","title":"Eclipse plugins","text":"<p>Install next Eclipse plugins:</p> <ul> <li>Apache Directory Studio (select browser part only)</li> <li>Eclipse jetty 7.0.0</li> </ul>","tags":["development","contribute","workspace","eclipse"]},{"location":"contribute/development/local-run-under-eclipse/#run-server-locally","title":"Run server locally","text":"<p>This section shows how to run Fido2 server, for example</p> <ul> <li> <p>Start OpenDJ from local folder.</p> </li> <li> <p>Connect to OpenDJ with Apache DS plugin and update config</p> <p></p> </li> <li> <p>Configure new Jetty Webapp run configuration. Here are screenshots:</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> </li> </ul>","tags":["development","contribute","workspace","eclipse"]},{"location":"contribute/development/local-run-under-eclipse/#expected-result","title":"Expected result","text":"","tags":["development","contribute","workspace","eclipse"]},{"location":"contribute/development/remote-debugging/","title":"Remote Debugging","text":"<p>Janssen Server modules run as Java processes. Hence, like any other Java process the JVM running the module can be configured to open a debug port where a remote debugger can be attached. The steps below will show how to configure <code>auth-server</code> module for remote debugging.</p> <ol> <li>Pass the command-line options to the JVM</li> </ol> <p>On the Janssen Server host, open the service config file     <code>/etc/default/jans-auth</code> and add the following JVM parameters to as     <code>JAVA_OPTIONS</code> <pre><code>-Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=6001\n</code></pre>    This will open the port <code>6001</code> for the remote debugger. Any other port can     also be used based on availability.</p> <ol> <li> <p>Restart <code>jans-auth</code> services     <pre><code>systemctl restart jans-auth.service\n</code></pre></p> </li> <li> <p>Check if the port is open and accessible from within the Janssen Server host    Use the <code>jdb</code> tool from JDK to test if the JVM port has been opened    <pre><code>./&lt;path-to-JDK&gt;/bin/jdb -attach 6001\n</code></pre>    if the port is open, it'll give you output like the below:    <pre><code>Set uncaught java.lang.Throwable\nSet deferred uncaught java.lang.Throwable\nInitializing jdb ...\n&gt;\n</code></pre>    press <code>ctrl+c</code> to come out of it.</p> </li> <li> <p>Ensure that the port is accessible from outside the host VM as well and     firewalls are configured accordingly</p> </li> <li> <p>Connect to the remote port on the Janssen Server host from the developer     workstation. Use any IDE (Intellij, Eclipse,    etc.) to create and run a remote debugging profile. Provide IP and debug     port of the Janssen Server host.</p> </li> </ol> <p>For IntelliJIdea, create a debug configuration as below:</p> <p></p>","tags":["development","contribute","remote debug"]},{"location":"contribute/development/run-integration-tests/","title":"Run Integration Tests with a Janssen Server VM","text":"<p>The procedures for running the Janssen integration test suite against an installed Janssen Server.</p>","tags":["development","contribute","vm","integration tests","workspace"]},{"location":"contribute/development/run-integration-tests/#component-setup","title":"Component Setup","text":"<p>Instructions in this guide can be used if Janssen Server is installed on a VM. Developers can use a virtualization software (like VMWare) or use LxD containers to create VM on developer workstation or use a remote cloud VM.</p> <p></p> <p>OS platform for Developer Workstation</p> <p>Steps in this guide are applicable to any OS platform a Developer workstation may have. Example commands given in this guide are for Ubuntu Linux based workstation.</p>","tags":["development","contribute","vm","integration tests","workspace"]},{"location":"contribute/development/run-integration-tests/#install-janssen-server","title":"Install Janssen Server","text":"<p>Install the Janssen server using one of the methods described in the VM installation guide. Note the points below when following installation instructions.</p> <ul> <li>Make a note   of the <code>host name</code> that you assign to the Janssen server during the    installation. For this guide, the Janssen hostname would be <code>janssen.op.io</code></li> <li>Choose to install with test data load. This can be achieved by using    the <code>-t</code> switch when invoking the setup script   from installation instructions.</li> </ul> <p>Use the VM installation guide for the complete set of instructions.</p> <p>Once the installation is complete, check if the <code>.well-known</code> end-points of the Janssen server from the browser. A successful response will ascertain that the The Janssen server running inside the local VM is healthy and also accessible from the developer's machine.</p> <p>Note</p> <p>Based on developer setup it may be necessary to add appropriate IP-HOST mapping to the developer workstation. For instance, on a Linux-based developer workstation, this means adding a mapping to <code>/etc/hosts</code> file. Make sure that VM's IP is mapped to a FQDN like <code>janssen.op.io</code>. Refering to VM with <code>localhost</code> or just IP will not work.</p> <p>URI for OpenID configuration <code>.well-known</code> endpoint:</p> <pre><code>https://janssen.op.io/jans-auth/.well-known/openid-configuration\n</code></pre> <p>The response received should be JSON formatted Janssen configuration details, similar to those below.</p> <pre><code>{\n\"request_parameter_supported\" : true,\n\"pushed_authorization_request_endpoint\" : \"https://janssen.op.io/jans-auth/restv1/par\",\n\"introspection_endpoint\" : \"https://janssen.op.io/jans-auth/restv1/introspection\",\n\"claims_parameter_supported\" : false,\n\"issuer\" : \"https://janssen.op.io\",\n\"userinfo_encryption_enc_values_supported\" : [ \"RSA1_5\", \"RSA-OAEP\", \"A128KW\", \"A256KW\" ],\n\"id_token_encryption_enc_values_supported\" : [ \"A128CBC+HS256\", \"A256CBC+HS512\", \"A128GCM\", \"A256GCM\" ],\n\"authorization_endpoint\" : \"https://janssen.op.io/jans-auth/restv1/authorize\",\n\"service_documentation\" : \"http://jans.org/docs\",\n\"authorization_encryption_alg_values_supported\" : [ \"RSA1_5\", \"RSA-OAEP\", \"A128KW\", \"A256KW\" ],\n\"id_generation_endpoint\" : \"https://janssen.op.io/jans-auth/restv1/id\",\n\"claims_supported\" : [ \"street_address\", \"country\", \"zoneinfo\", \"birthdate\", \"role\", \"gender\", \"user_name\", \"formatted\", \"phone_mobile_number\", \"preferred_username\", \"inum\", \"locale\", \"updated_at\", \"post_office_box\", \"nickname\", \"preferred_language\", \"email\", \"website\", \"email_verified\", \"profile\", \"locality\", \"room_number\", \"phone_number_verified\", \"given_name\", \"middle_name\", \"picture\", \"name\", \"phone_number\", \"postal_code\", \"region\", \"family_name\", \"jansAdminUIRole\" ],\n\"scope_to_claims_mapping\" : [ {\n  \"user_name\" : [ \"user_name\" ]\n}, {\n  \"https://jans.io/scim/users.write\" : [ ]\n}, {\n  \"https://jans.io/scim/groups.read\" : [ ]\n}, {\n  \"https://jans.io/scim/all-resources.search\" : [ ]\n}, {\n  \"https://jans.io/scim/fido.write\" : [ ]\n}, {\n  \"https://jans.io/scim/groups.write\" : [ ]\n}, {\n  \"https://jans.io/scim/fido2.read\" : [ ]\n}, {\n  \"https://jans.io/scim/fido.read\" : [ ]\n}, {\n  \"https://jans.io/scim/fido2.write\" : [ ]\n</code></pre>","tags":["development","contribute","vm","integration tests","workspace"]},{"location":"contribute/development/run-integration-tests/#setup-the-certificates","title":"Setup The Certificates","text":"<p>To run the tests against the installed Janssen Server, the workstation JRE needs to have the appropriate certificate installed. Update cacerts using the steps below:</p> <ul> <li> <p>extract certificate for Janssen server with name <code>janssen.op.io</code> On Developer Workstation<pre><code>openssl s_client -connect test.local.jans.io:443 2&gt;&amp;1 |sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' &gt; /tmp/httpd.crt\n</code></pre>   this command takes a few seconds to return.</p> </li> <li> <p>Update cacerts of your JRE which is being used by the code workspace. For example, <code>/usr/lib/jvm/java-11-amazon-corretto</code>. When running the command below, it    will prompt for cert store password. Provide   the correct password. The default password is <code>changeit</code>.   <pre><code>keytool -import -alias janssen.op.io -keystore /usr/lib/jvm/java-11-amazon-corretto/lib/security/cacerts -file /tmp/httpd.crt\n</code></pre></p> </li> </ul>","tags":["development","contribute","vm","integration tests","workspace"]},{"location":"contribute/development/run-integration-tests/#configure-developer-workspace","title":"Configure developer workspace","text":"<p>Now that we have Janssen Server running in a VM and it is accessible from the developer workstation as well, we will create and configure the code base on the developer workspace to run integration tests.</p> <p>Get Janssen server code from Janssen GitHub repository. Note the path to this location, we will refer to it as <code>source-base</code>.</p> <p>Janssen Server is composed of multiple modules. For example <code>source-base/jans-auth-server</code>, <code>source-base/jans-link</code> etc.</p> <p>Each module has its own set of tests. Below are the instructions for configuring each module for tests.</p> <p>What is a Profile directory?</p> <ul> <li>To run integration tests, the developer workspace needs to know details about he Janssen Server agaist which the tests are to be run.</li> <li>Janssen Server workspace holds this information in <code>source-base/module/sub-module/profiles</code> directory.</li> <li>The <code>profiles</code> directory can contain one or more sub-directories, each representing a profile(i.e a target Janssen Server). These profile directories are used to hold files that contain important information required to run tests.</li> <li>Developers can create one or more profiles and use them to run tests against different Janssen Servers.</li> <li>This guide uses Janssen Server hostname,  <code>janssen.op.io</code>, as profile name.</li> </ul>","tags":["development","contribute","vm","integration tests","workspace"]},{"location":"contribute/development/run-integration-tests/#configuring-the-jans-auth-server-module","title":"Configuring the jans-auth-server module","text":"<p>Configuring <code>jans-auth-server</code> module involves setting up profiles for <code>client</code>, <code>server</code> and <code>agama</code> sub-modules.</p> <p>Follow the steps below to configure the profile for the client and server sub-modules.</p> <ol> <li>Move to the module directory    <pre><code> cd source-base/jans-auth-server\n</code></pre></li> <li> <p>As a precautionary measure, let's first remove any old profile artifacts  from the <code>jans-auth-server</code> workspace.    <pre><code>rm -rf ./jans-auth\nrm -rf ./client/profiles/janssen.op.io\nrm -rf ./server/profiles/janssen.op.io\nrm -rf ./agama/engine/profiles/janssen.op.io\n</code></pre></p> </li> <li> <p>Since Janssen Server has been installed with test data, the installer also    created the profile files required to run    the test.    These files are kept on the VM under    <code>/opt/jans/jans-setup/output/test/jans-auth</code> directory. Copy over <code>jans-auth</code> directory from Janssen Server VM    to <code>source-base/jans-auth-server</code> on developer workstation.</p> </li> <li>Create new profile directories.    <pre><code>mkdir -p ./client/profiles/janssen.op.io\nmkdir -p ./server/profiles/janssen.op.io\nmkdir -p ./agama/engine/profiles/janssen.op.io\n</code></pre></li> <li>Copy the contents of <code>jans-auth</code> directory into the respective sub-module's <code>janssen.op.io</code> profile directory    <pre><code>cp ./jans-auth/client/* ./client/profiles/janssen.op.io\ncp ./jans-auth/server/* ./server/profiles/janssen.op.io\ncp ./jans-auth/config-agama-test.properties ./agama/engine/profiles/janssen.op.io/config-agama-test.properties\n</code></pre></li> <li>Copy keystore file <code>profiles/default/client_keystore.p12</code> from <code>default</code> profile directory to    the <code>janssen.op.io</code> profile directory    <pre><code>cp -f ./client/profiles/default/client_keystore.p12 ./client/profiles/janssen.op.io\ncp -f ./server/profiles/default/client_keystore.p12 ./server/profiles/janssen.op.io\n</code></pre></li> </ol>","tags":["development","contribute","vm","integration tests","workspace"]},{"location":"contribute/development/run-integration-tests/#running-the-tests","title":"Running The Tests","text":"<p>Each module in Janssen Server has its tests that have to be executed separately. For example, to run integration tests for <code>jans-auth-server</code> module, run the following maven command at the directory level:</p> <pre><code>mvn -Dcfg=janssen.op.io test\n</code></pre>","tags":["development","contribute","vm","integration tests","workspace"]},{"location":"contribute/development/run-integration-tests/#configuring-the-jans-core-module","title":"Configuring the jans-core module","text":"<p>This module does not require a profile setup. It can be built with below maven command.</p> <pre><code>mvn clean compile install\n</code></pre>","tags":["development","contribute","vm","integration tests","workspace"]},{"location":"contribute/development/run-integration-tests/#configuring-the-jans-link-module","title":"Configuring the jans-link module","text":"<p>This module does not require a profile setup. It can be built with the below maven command.</p> <pre><code>mvn clean compile install\n</code></pre>","tags":["development","contribute","vm","integration tests","workspace"]},{"location":"contribute/development/run-integration-tests/#configuring-the-jans-orm-module","title":"Configuring the jans-orm module","text":"<p>This module does not require a profile setup. It can be built with the below maven command.</p> <pre><code>mvn clean compile install\n</code></pre>","tags":["development","contribute","vm","integration tests","workspace"]},{"location":"contribute/development/run-integration-tests/#configuring-the-agama-module","title":"Configuring the agama module","text":"<p>This module does not require a profile setup. It can be built with the below maven command.</p> <pre><code>mvn clean compile install\n</code></pre>","tags":["development","contribute","vm","integration tests","workspace"]},{"location":"contribute/development/run-integration-tests/#configuring-the-scim-module","title":"Configuring the SCIM module","text":"<p>This module does not require a profile setup. It can be built with the below maven command.</p>","tags":["development","contribute","vm","integration tests","workspace"]},{"location":"contribute/development/run-integration-tests/#profile-setup-for-client-and-server-modules","title":"Profile setup for client and server modules","text":"<p>Many Janssen Server modules and sub-modules use test configuration stored in a directory named <code>profile</code>. The profile directory contains files that hold important information required to run tests. Developers can create one or more profiles and use them to run tests against different Janssen Servers.</p> <p>Since Janssen Server has been installed with test data, the installer also created the profile files required to run the test. For SCIM/client module, these files are kept on the VM under <code>/opt/jans/jans-setup/output/test/scim-client</code> directory. Copy over this directory to any location on the developer workstation.</p> <p>Follow the steps below to configure the profile for the client module. The same steps should be followed for setting up a profile for the server module.</p> <ol> <li>Under <code>jans-scim/client/profiles</code> directory, create a new directory and name it <code>janssen.op.io</code></li> <li>Copy the contents of <code>scim-client/client</code> directory into the newly created <code>janssen.op.io</code> directory</li> </ol> <p>Post this, remove the <code>scim-client</code> directory.</p> <p>Now as the profile is setup, to build the <code>jans-scim</code> module and run tests, use the command below:</p> <pre><code>mvn -Dcfg=janssen.op.io test\n</code></pre>","tags":["development","contribute","vm","integration tests","workspace"]},{"location":"contribute/development/useful-tools/","title":"Useful Tools","text":"<p>While working with Janssen Server, either as developer or administrator, following tools can be helpful.</p> <ol> <li>jsonbin.io</li> <li>jwt.io</li> <li>oidcdebugger.com</li> <li>keytool.online</li> </ol>","tags":["development","contribute","tools"]},{"location":"contribute/implementation-design/","title":"Design And Implementation","text":"<p>This section documents technical design, architecture and interactions of various Janssen modules.</p>"},{"location":"contribute/implementation-design/#design-consideration-and-guidelines","title":"Design Consideration and Guidelines","text":"<p>This section outlines high-level design principles, styles and design choices that Janssen project follow.</p>"},{"location":"contribute/implementation-design/#rest-api-design","title":"REST API Design","text":""},{"location":"contribute/implementation-design/#caching","title":"Caching","text":""},{"location":"contribute/implementation-design/#testing","title":"Testing","text":""},{"location":"contribute/implementation-design/#deployment","title":"Deployment","text":""},{"location":"contribute/implementation-design/#security","title":"Security","text":""},{"location":"contribute/implementation-design/#scalability-and-cloud-infrastructure","title":"Scalability and Cloud Infrastructure","text":""},{"location":"contribute/implementation-design/#technical-documentation-guidelines","title":"Technical Documentation Guidelines","text":"<p>These are high-level guidelines to follow when adding or updating technical documentation for a module</p> <ul> <li>Detailed technical documentation for each module should be placed under directory with module's name. For example, technical documentation for <code>jans-mod</code> should be placed under directory <code>docs/technical/jans-mod</code></li> <li>Each module directory should have a README file that follows Technical Overview Template.</li> <li>Create directories if required under module directory to further arrange documentation</li> <li>Place all the digital assets to support your documentation under assets following these guidelines</li> </ul>"},{"location":"contribute/implementation-design/technical-overview-template/","title":"<p>Contents: - Functional Overview - Design Overview - API and Code Reference - Deployment - Data Reference - How to Run Tests - Logging - Security Considerations</p>","text":""},{"location":"contribute/implementation-design/technical-overview-template/#functional-overview","title":"Functional Overview","text":""},{"location":"contribute/implementation-design/technical-overview-template/#design-overview","title":"Design Overview","text":""},{"location":"contribute/implementation-design/technical-overview-template/#api-and-code-reference","title":"API and Code Reference","text":"<ul> <li>API Reference </li> <li>Code Reference </li> </ul>"},{"location":"contribute/implementation-design/technical-overview-template/#deployment","title":"Deployment","text":""},{"location":"contribute/implementation-design/technical-overview-template/#data-reference","title":"Data Reference","text":""},{"location":"contribute/implementation-design/technical-overview-template/#how-to-run-tests","title":"How to Run Tests","text":""},{"location":"contribute/implementation-design/technical-overview-template/#logging","title":"Logging","text":""},{"location":"contribute/implementation-design/technical-overview-template/#security-considerations","title":"Security Considerations","text":""},{"location":"contribute/implementation-design/agama-design/","title":"Agama","text":""},{"location":"contribute/implementation-design/agama-design/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>"},{"location":"contribute/implementation-design/agama-design/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>"},{"location":"contribute/implementation-design/agama-design/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>"},{"location":"contribute/implementation-design/agama-design/adr/","title":"Architectural Decision Records","text":"<p>This documentation category holds ADRs, discussions and documents that were used to drive design and architecture of the component or at least have had significant impact on the same.</p>","tags":["design","ADR","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-auth-server-design/","title":"Index","text":""},{"location":"contribute/implementation-design/jans-auth-server-design/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>"},{"location":"contribute/implementation-design/jans-auth-server-design/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>"},{"location":"contribute/implementation-design/jans-auth-server-design/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>"},{"location":"contribute/implementation-design/jans-auth-server-design/adr/","title":"Architectural Decision Records","text":"<p>This documentation category holds ADRs, discussions and documents that were used to drive design and architecture of the component or at least have had significant impact on the same.</p>","tags":["design","ADR","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-casa-design/","title":"Index","text":""},{"location":"contribute/implementation-design/jans-casa-design/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>"},{"location":"contribute/implementation-design/jans-casa-design/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>"},{"location":"contribute/implementation-design/jans-casa-design/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>"},{"location":"contribute/implementation-design/jans-casa-design/adr/","title":"Architectural Decision Records","text":"<p>This documentation category holds ADRs, discussions and documents that were used to drive design and architecture of the component or at least have had significant impact on the same.</p>","tags":["design","ADR","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/","title":"Index","text":""},{"location":"contribute/implementation-design/jans-cedarling-design/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>"},{"location":"contribute/implementation-design/jans-cedarling-design/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>"},{"location":"contribute/implementation-design/jans-cedarling-design/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>"},{"location":"contribute/implementation-design/jans-cedarling-design/cedarling-technical-overview/","title":"Cedarling Technical Overview","text":"<p>This document serves as a high-level overview of Cedarling's current internals and should help with onboarding, restructuring, or future feature implementation.</p> <p>For feature-specific plans, refer to the Cedarling Nativity Plan.</p> <p>Powered by the Cedar Rust engine, the Cedarling validates JWTs and maps the JSON payload claims to Cedar entities, enabling authorization via the <code>Cedarling::authorize</code> method. It also offers a secondary method, <code>Cedarling::authorize_unsigned</code>, which accepts pre-constructed Cedar entities.</p> <p>The Cedarling performs other tasks associated with a Policy Decision Point, or \"PDP\", like logging, policy store management, workload identity registration, and communication with enterprise IT infrastructure. In order to perform these services, the Cedarling runs an in-memory KV store with built-in record expiration.</p>","tags":["technical","cedarling","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/cedarling-technical-overview/#key-modules","title":"Key Modules","text":"<ul> <li><code>authz</code>: Policy evaluation logic</li> <li><code>bootstrap_config</code>: Loads config structs via Serde::Deserialize</li> <li><code>common</code>: Shared data structures across the app</li> <li><code>entity_builder</code>: Builds Cedar entities from JWTs or manually for unsigned auth</li> <li><code>http</code>: HTTP helpers (multi-target safe)</li> <li><code>init</code>: Initializes the services using the bootstrap configs</li> <li><code>jwt</code>: JWT parsing and validation</li> <li><code>lock</code>: Background task logic to communicate with the Lock Server</li> <li><code>log</code>: Logger setup</li> <li><code>tests</code>: End-to-end tests</li> </ul> <p>Note</p> <p>The <code>init</code> module may be over-abstracted. Consider simplifying the service factory logic.</p>","tags":["technical","cedarling","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/cedarling-technical-overview/#cedarling-flow","title":"Cedarling Flow","text":"","tags":["technical","cedarling","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/cedarling-technical-overview/#startup-requirements","title":"Startup Requirements","text":"<ol> <li>Bootstrap Properties</li> <li>Policy Store</li> </ol>","tags":["technical","cedarling","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/cedarling-technical-overview/#authorization-flow","title":"Authorization Flow","text":"<ul> <li>Policy</li> <li>Action</li> <li>Resource</li> <li>Context (e.g. headers, timestamps, user posture)</li> </ul> <p>Typical JWT-based flow:</p> <ol> <li>Call <code>Cedarling::authorize</code></li> <li>Validate JWT via <code>JwtService</code></li> <li>Build entities using <code>EntityBuilder</code>.</li> <li>Evaluate entities against policies in <code>authz</code>.</li> <li>Return <code>Ok(AuthorizeResult)</code> or <code>Err(AuthorizeError)</code></li> </ol> <p>Alternative: Use <code>Cedarling::authorize_unsigned</code> for direct entity input.</p>","tags":["technical","cedarling","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/cedarling-technical-overview/#jwt-validation","title":"JWT Validation","text":"<p>Handled via <code>JwtService</code> in the <code>jwt</code> module. JWTs from untrusted issuers are rejected with a warning.</p> <p>Criteria for valid JWT:     * Comes from a trusted issuer:     * Has a defined token metadata</p>","tags":["technical","cedarling","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/cedarling-technical-overview/#entity-mapping","title":"Entity Mapping","text":"<p>Handled via <code>EntityBuilder</code> in the <code>entity_builder</code> module. JWTs from untrusted issuers are rejected with an error.</p> <p>JWT claims are mapped to Cedar attributes (1:1 by default).</p> <p>Mappings are configured via the Token Entity Metadata Schema's <code>claim mapping</code> field in the Policy Store.</p> <p>Note</p> <p>JWTs might contain claims that aren't in the Cedar Entity's Schema. Cedarling should be able to ignore these and not fail immediately.</p> <p>This is probably the slowest step in the authorization procedure since we have to continually re-check the schema against the input. Improvements must be made.</p>","tags":["technical","cedarling","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/cedarling-technical-overview/#multi-target-support","title":"Multi-Target Support","text":"<p>Handled via <code>JwtService</code> in the <code>jwt</code> module. JWTs from untrusted issuers are rejected with a warning.</p> <p>Criteria for a valid JWT:</p> <ul> <li>Comes from a trusted issuer</li> <li>Has a defined token metadata</li> </ul> <p>Refer to wasm-bindgen for bridging native/WASM features.</p> <p>Bindings code is separated by language in <code>jans-cedarling/bindings</code>. They each should have a README.md, which contains setup instructions.</p>","tags":["technical","cedarling","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/cedarling-technical-overview/#lock-server","title":"Lock Server","text":"<p>Cedarling communicates with the Lock Server for:</p> <ul> <li>Logs</li> <li>Health checks (WIP)</li> <li>Telemetry (WIP)</li> <li>Policy updates (WIP)</li> </ul>","tags":["technical","cedarling","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/cedarling-technical-overview/#connecting","title":"Connecting","text":"<p>Uses Dynamic Client Registration (DCR) to obtain access tokens. Logic is in the <code>lock</code> module.</p> <p>Use the <code>CEDARLING_LOCK_SSA_JWT</code> to provide the Software Statement Assertion JWT. This is optional, as stated in the spec, but may be required by the auth server.</p>","tags":["technical","cedarling","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/cedarling-technical-overview/#local-setup-notes","title":"Local Setup Notes","text":"<p>Use the head branch of the Jans server. Earlier versions (e.g. 1.5) had bugs.</p> <p>Download the latest builds from: Dynamic Download.</p> <p>Note that the other installation directions will not give you the latest build even if you're in the <code>head</code> branch of the docs, so make sure to use the dynamic download.</p>","tags":["technical","cedarling","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/cedarling-technical-overview/#authorization-speed","title":"Authorization Speed","text":"<p>The target speed is sub-100 ms per call to <code>Cedarling::authorize</code>.</p> <p>We once tried to implement JWT caching only in the JWT module, but it didn't present any significant gains.</p> <p>After profiling using pprof, we found out that the biggest bottleneck is creating the Cedar entities from the JWTs. Caching the whole request might improve the speed, but just caching the JWTs won't.</p> <p>This should output an SVG named <code>cedarling_profiling_flamegraph</code>.</p> <pre><code>cargo run --example profiling\n</code></pre>","tags":["technical","cedarling","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/cedarling-technical-overview/#known-quirks-things-to-watch-out-for","title":"Known Quirks &amp; Things to Watch Out For","text":"<ul> <li>The <code>entity_builder</code> relies heavily on the structure of the token metadata unexpected schema changes might break parsing silently.</li> <li>WASM build will sometimes fail even if it works on native. One example is you can't just spawn a new task using <code>tokio::spawn</code>. There are some helper functions in the <code>http_utils</code> module to solve the usual tasks.</li> <li>The Lock Server will not recognize the client immediately after DCR. Expect receive some unauthorized responses for the first few seconds if you're testing locally.</li> </ul>","tags":["technical","cedarling","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/cedarling-technical-overview/#relevant-docs-specs","title":"Relevant Docs &amp; Specs","text":"<ul> <li>Cedar Policy</li> <li>OpenID Connect Core</li> <li>OpenID Connect Discovery</li> <li>OIDC Dynamic Client Registration</li> <li>JSON Web Token (RFC 7519)</li> <li>OAuth2 DCR (RFC 7591)</li> </ul>","tags":["technical","cedarling","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/","title":"Architectural Decision Records","text":"<p>This documentation category holds ADRs, discussions and documents that were used to drive design and architecture of the component or at least have had significant impact on the same.</p>","tags":["design","ADR","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/","title":"Cedarling initial design discussion","text":"","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#project-structure","title":"Project Structure","text":"<pre><code>src/\n\u251c\u2500\u2500 lib.rs\n\u251c\u2500\u2500 init/\n\u2502   \u251c\u2500\u2500 mod.rs\n\u2502   \u251c\u2500\u2500 submodule.rs\n\u251c\u2500\u2500 authz/\n\u2502   \u251c\u2500\u2500 mod.rs\n\u2502   \u2514\u2500\u2500 another_submodule.rs\n\u251c\u2500\u2500 jwt/\n\u2502   \u251c\u2500\u2500 mod.rs\n\u2502   \u2514\u2500\u2500 submodule.rs\n\u251c\u2500\u2500 log/\n\u2502   \u251c\u2500\u2500 mod.rs\n\u2502   \u2514\u2500\u2500 submodule.rs\n\u251c\u2500\u2500 lock/\n\u2502    \u251c\u2500\u2500 mod.rs\n\u2502    \u2514\u2500\u2500 submodule.rs\n\u251c\u2500\u2500 model/\n\u2502   \u251c\u2500\u2500 user.rs\n\u2502   \u251c\u2500\u2500 client.rs\n    \u251c\u2500\u2500 id_token.rs\n\u2502   \u2514\u2500\u2500 acess_token.rs\n\u251c\u2500\u2500 test/\n\u2502    \u251c\u2500\u2500 mod.rs\n\u251c\u2500\u2500 services/\n\u2502    \u251c\u2500\u2500 mod.rs\n</code></pre>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#best-practices-for-documentation","title":"Best Practices for Documentation","text":"<p>Proper documentation in a large Rust project is crucial to ensure that the codebase is maintainable, understandable, and usable by other developers. Rust provides several tools and conventions that encourage good documentation practices, including rustdoc for generating API documentation from comments and other markdown-based approaches.</p>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#1-use-rustdoc-for-api-documentation","title":"1. Use Rustdoc for API Documentation","text":"<ul> <li>Document every public item: Use /// comments to generate documentation for all public structs, enums, functions, traits, and modules. These comments are extracted by rustdoc to create comprehensive API documentation.</li> <li>Keep documentation up to date: When code changes, update the associated documentation. Outdated documentation can be worse than no documentation.</li> <li>Add code examples: Include usage examples in the /// comments for functions, structs, and traits. Rustdoc examples can be automatically tested with cargo test, ensuring they remain valid over time.</li> </ul> <p><pre><code>/// A user struct that represents a user in the system.\n///\n/// # Examples\n///\n/// \n/// let user = User::new(1, \"Alice\".to_string());\n/// \npub struct User {\n    pub id: u32,\n    pub name: String,\n}\n\nimpl User {\n    /// Creates a new `User` with the given ID and name.\n    pub fn new(id: u32, name: String) -&gt; Self {\n        User { id, name }\n    }\n}\n</code></pre> Why: This ensures that documentation is closely tied to the code, easy to generate, and always current with the codebase.</p>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#2-module-level-documentation","title":"2. Module-level Documentation","text":"<ul> <li>Provide overviews for each module: In the <code>mod.rs</code> or the top of a module file, use <code>//!</code> comments to document the purpose of the module, its design, and how it interacts with other parts of the project. This is particularly useful for explaining the higher-level organization and structure of your code.</li> </ul> <p>Example:</p> <pre><code>//! This module handles user authentication and authorization.\n//! It includes functions for verifying credentials, managing tokens, and\n//! enforcing access control policies.\n\npub mod auth;\npub mod permissions;\n</code></pre> <p>Why: It gives developers a high-level understanding of what the module is responsible for, making it easier to navigate the code.</p>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#3-crate-level-documentation","title":"3. Crate-level Documentation","text":"<ul> <li>Document the crate root: In the <code>lib.rs</code> or <code>main.rs</code> file, include crate-level documentation using <code>//!</code>. This documentation should provide an overview of the entire project, its goals, its structure, and any important usage notes. For libraries, this is where you document how to use the crate.</li> </ul> <p>Example:</p> <pre><code>//! # MyProject\n//!\n//! `MyProject` is a web application that manages user data securely.\n//! It provides modules for user management, authentication, and database access.\n//!\n//! ## Quick Start\n//!\n//! Here\u2019s an example of how to get started:\n//! \n//! ```\n//! let user = my_project::User::new(1, \"Alice\".to_string());\n//! println!(\"User: {}\", user.name);\n//! ```\n</code></pre> <p>Why: This helps new users or contributors quickly understand the purpose and usage of the entire crate.</p>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#4-consistent-markdown-conventions","title":"4. Consistent Markdown Conventions","text":"<ul> <li>Use markdown for formatting: Rust documentation comments support markdown, so you can use it for headings, lists, bold/italic text, and code blocks. Use markdown to structure documentation clearly and consistently.</li> <li>Use code fences: For code examples, use triple backticks (<code>``) to enclose code snippets. This ensures they are displayed properly when rendered by</code>rustdoc`.</li> </ul>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#5-writing-style","title":"5. Writing Style","text":"<ul> <li>Be concise but descriptive: Documentation should explain what the code does, why it exists, and how to use it, but it doesn\u2019t need to repeat what the code itself makes obvious.</li> <li>Avoid technical jargon: Keep explanations simple and avoid unnecessary jargon. The goal is clarity.</li> <li>Document the why: Beyond describing what a function or module does, document the design decisions and why certain choices were made. This is particularly important in complex systems.</li> </ul>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#6-use-cargo-doc-and-cargo-test-regularly","title":"6. Use <code>cargo doc</code> and <code>cargo test</code> Regularly","text":"<ul> <li>Generate docs: Run <code>cargo doc --open</code> to generate and review your project\u2019s documentation. This ensures that your docs are formatted properly and are complete.</li> <li>Test code examples: Since Rust's doc examples are integrated with the testing framework, run <code>cargo test</code> to ensure that all examples in the documentation are accurate and functioning.</li> </ul>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#7-examples-and-tutorials","title":"7. Examples and Tutorials","text":"<ul> <li>Create an <code>examples/</code> directory: Rust supports the <code>examples/</code> directory, where you can include real-world examples that demonstrate how to use the various parts of your project. This is particularly helpful for large projects.</li> <li>Link to examples in the documentation: When writing the API documentation, link to specific examples for more detailed use cases.</li> </ul> <p>Example project structure:</p> <pre><code>src/\nexamples/\n    basic_usage.rs\n    advanced_features.rs\n</code></pre> <p>Why: It allows users to learn by exploring real examples without cluttering the main codebase.</p>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#8-documentation-for-contributors","title":"8. Documentation for Contributors","text":"<ul> <li>CONTRIBUTING.md: Include a <code>CONTRIBUTING.md</code> file in the root of your project. This should describe the guidelines for contributing to the project, such as how to set up the development environment, coding conventions, and how to write and run tests.</li> <li>Explain the project\u2019s structure: For large projects, it\u2019s helpful to include documentation that explains the project\u2019s overall architecture, key modules, and design patterns. This helps new contributors get up to speed quickly.</li> </ul>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#9-use-doc-comments-for-private-functions","title":"9. Use Doc Comments for Private Functions","text":"<ul> <li>Private functions and internal modules: While <code>rustdoc</code> only generates documentation for public items, it's a good practice to document private functions and modules using <code>//</code> comments. This helps internal developers understand the purpose and usage of private code.</li> </ul> <p>Example:</p> <pre><code>// This function handles the low-level logic for parsing user input.\nfn parse_user_input(input: &amp;str) -&gt; Result&lt;UserInput, ParseError&gt; {\n    // Implementation\n}\n</code></pre> <p>Why: Proper internal documentation ensures that team members can work with the code more effectively and minimizes the learning curve for new developers.</p>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#10-project-level-readme","title":"10. Project-Level README","text":"<ul> <li>README.md: Every large project should have a well-written <code>README.md</code> file that provides an overview of the project, how to install/use it, and key links (like API documentation, tutorials, etc.). This file should be concise but provide enough information for developers to understand the project\u2019s purpose and start using it.</li> </ul>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#11-use-rustdoc-lints-denymissing_docs","title":"11. Use Rustdoc Lints (<code>deny(missing_docs)</code>)","text":"<p>In large Rust projects, it's useful to enforce documentation standards by adding the following at the top of your <code>lib.rs</code> or <code>main.rs</code>:</p> <pre><code>#![deny(missing_docs)]\n</code></pre> <p>This ensures that all public items are documented, and the compiler will emit warnings if you forget to document something.</p>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#multiple-crates","title":"Multiple Crates","text":"<ul> <li>The one thing we may want to split into a different crate is the \"lock\" functionality.</li> <li>A developer who is just using the cedarling for a single application may not care about Lock--which is only needed by an organization who has a few applications.</li> <li>Perhaps this would also give the developer the option to ship a smaller cedarling binary</li> </ul>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#use-traits-for-abstraction-and-extensibility","title":"Use Traits for Abstraction and Extensibility","text":"<p>Trait-based design: Traits allow you to define shared behavior across different types. This is useful for defining abstract interfaces that can be implemented by multiple structs or enums. Trait objects and generics: For large projects, using traits with generics or trait objects (dyn Trait) can help create flexible and extensible codebases. Example:</p> <p><pre><code>pub trait Repository {\n    fn get(&amp;self, id: u32) -&gt; Option&lt;User&gt;;\n    fn save(&amp;self, user: User);\n}\n\npub struct PostgresRepository;\n\nimpl Repository for PostgresRepository {\n    fn get(&amp;self, id: u32) -&gt; Option&lt;User&gt; {\n        // Postgres-specific logic\n    }\n\n    fn save(&amp;self, user: User) {\n        // Postgres-specific logic\n    }\n}\n\npub struct InMemoryRepository;\n\nimpl Repository for InMemoryRepository {\n    fn get(&amp;self, id: u32) -&gt; Option&lt;User&gt; {\n        // In-memory logic\n    }\n\n    fn save(&amp;self, user: User) {\n        // In-memory logic\n    }\n}\n</code></pre> Why: Traits allow for decoupling implementation details from high-level logic. This makes your code more extensible and easier to test by enabling dependency injection and mock implementations.</p>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#clarity-in-error-handling","title":"Clarity in Error Handling","text":"<p>Custom error types: Use custom error types for clear and descriptive error handling. Create a centralized error.rs file to define common error types across the project. Result and Option: Leverage Rust\u2019s Result and Option types extensively to handle potential errors and absence of values in a type-safe way. Error propagation: Use ? for concise error propagation and implement the std::error::Error trait on custom error types.</p> <p>Example custom error type:</p> <pre><code>#[derive(Debug)]\npub enum MyError {\n    NotFound,\n    DatabaseError(String),\n}\n\nimpl std::fmt::Display for MyError {\n    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;'_&gt;) -&gt; std::fmt::Result {\n        match self {\n            MyError::NotFound =&gt; write!(f, \"Item not found\"),\n            MyError::DatabaseError(e) =&gt; write!(f, \"Database error: {}\", e),\n        }\n    }\n}\n</code></pre> <p>impl std::error::Error for MyError {}</p> <p>Why: Well-defined error types and clear handling make it easier to debug, test, and maintain the project.</p>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cedarling-design/adr/adr-cedarling-initial-design-discussion/#organize-tests-effectively","title":"Organize Tests Effectively","text":"<p>Unit tests: Place unit tests inside the same module they are testing using a #[cfg(test)] block. Integration tests: Use the root tests/ directory for integration tests that test the interaction between multiple modules or crates.</p>","tags":["design","ADR","Architectural Decision Records","cedarling"]},{"location":"contribute/implementation-design/jans-cli-design/","title":"Index","text":""},{"location":"contribute/implementation-design/jans-cli-design/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>"},{"location":"contribute/implementation-design/jans-cli-design/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>"},{"location":"contribute/implementation-design/jans-cli-design/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>"},{"location":"contribute/implementation-design/jans-cli-design/adr/","title":"Architectural Decision Records","text":"<p>This documentation category holds ADRs, discussions and documents that were used to drive design and architecture of the component or at least have had significant impact on the same.</p>","tags":["design","ADR","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-config-api-design/","title":"Janssen Config API","text":"<p>Janssen(Jans) Config API is an application programming interface (API) gateway managing configuring of various Janssen modules.</p> <p>Diagram reference</p>","tags":["developer","config-api"]},{"location":"contribute/implementation-design/jans-config-api-design/#jans-config-api-features","title":"Jans Config API features:","text":"<ol> <li>Jans Config API uses REST endpoints to communicate. </li> <li>Jans Config API endpoint are OAuth 2.0 protected. More details here</li> <li>Jans Config API plugin architecture can be used to add new features. More details here.</li> <li>Config API endpoint can be used to create new user, clients, scopes, etc. This data is stores into the same persistence store as the Jans-Auth server.</li> </ol>","tags":["developer","config-api"]},{"location":"contribute/implementation-design/jans-config-api-design/#jans-config-api-flow","title":"Jans Config API Flow","text":"<pre><code>\nsequenceDiagram\ntitle Jans Config API request flow\nautonumber\n\nparticipant Admin\nparticipant Admin UI\nparticipant Config API\nparticipant Auth Server\nparticipant Jans Persistence\n\nAdmin-&gt;&gt;Admin UI: Create Client\nnote over Admin UI: Click on plus sign to Create Client and Save button to create new client\nConfig API-&gt;&gt;Auth Server: Introspect Token\nAuth Server-&gt;&gt;Config API: Returns Introspection Response\nConfig API-&gt;&gt;Config API: Successful validation of token claim with Introspection Response\nConfig API-&gt;&gt;Jans Persistence: Validate and persist client data\nConfig API-&gt;&gt;Admin UI: Returns persistence status</code></pre> <ol> <li>Admin: Administrator of the application. Will use Admin UI to configure application. </li> <li>Admin UI: Gluu graphical user interface for the administrators to manage configuration and other properties of Jans Auth Server via Jans Config API.</li> <li>Config API: Jans API gateway for configuring Janssen modules like Jans Auth Server, fido2, SCIM, etc. </li> <li>Auth Server: Janssen federated identity with comprehensive implementation of OpenID Connect. Used for introspection of access token in this flow.</li> <li>Jans Persistence: Jans Persistence layer to persist data in backend.</li> </ol>","tags":["developer","config-api"]},{"location":"contribute/implementation-design/jans-config-api-design/config-api-swagger-spec-generation/","title":"Config API Swagger Spec generation at build time","text":"<p>What Is OpenAPI? OpenAPI Specification (formerly Swagger Specification) is an API description format for REST APIs. An OpenAPI file allows you to describe your entire API, including:</p> <ul> <li>Available endpoints (/users) and operations on each endpoint (GET /users, POST /users)</li> <li>Operation parameters Input and output for each operation</li> <li>Authentication methods</li> <li>Contact information, license, terms of use, and other information. API specifications  can be written in YAML or JSON. The format is easy to learn and readable to both humans  and machines. The complete OpenAPI Specification can be found on GitHub:  OpenAPI 3.0 Specification</li> </ul>","tags":["developer","config-api"]},{"location":"contribute/implementation-design/jans-config-api-design/config-api-swagger-spec-generation/#openapi-specification-can-be-generated-at","title":"OpenAPI specification can be generated at;","text":"<ul> <li>Runtime</li> <li>Build time</li> </ul> <p>This document is related to build time generation.</p>","tags":["developer","config-api"]},{"location":"contribute/implementation-design/jans-config-api-design/config-api-swagger-spec-generation/#quick-start","title":"Quick start","text":"<p>OpenAPI Specification is generated when pre-processing the API based on the meta-data added against the various resources, methods, and controllers. This is also called the code first approach.</p>","tags":["developer","config-api"]},{"location":"contribute/implementation-design/jans-config-api-design/config-api-swagger-spec-generation/#project-pom-changes","title":"Project POM changes","text":"<ul> <li>Swagger-core is an open-source Java implementation of Swagger/OpenAPI. Its  java-related libraries can be used for creating, consuming, and working with  OpenAPI definitions. It contains a set of modules that enables integration with  a JAX-RS to produce OpenAPI definitions. We use its set of annotations to decorate  code with meta-data information.</li> </ul> <p>Add its dependency to the project POM.</p> <pre><code>  &lt;dependencies&gt;\n  ...\n    &lt;dependency&gt;\n        &lt;groupId&gt;io.swagger.core.v3&lt;/groupId&gt;\n        &lt;artifactId&gt;swagger-core-jakarta&lt;/artifactId&gt;\n        &lt;version&gt;2.2.4&lt;/version&gt;\n    &lt;/dependency&gt;\n  &lt;/dependencies&gt;\n</code></pre> <ul> <li>Swagger Maven Plugin This plugin is intended to use the Swagger Core library to generate  OpenAPI documentation from a JAX-RS based REST service. If you want to learn more about  the plugin and available configuration options, please visit its website: https://github.com/openapi-tools/swagger-maven-plugin </li> </ul> <p>To have Swagger generate the OpenAPI specifications as part of the build, add the plugin to the POM.</p> <pre><code>&lt;build&gt;\n &lt;plugins&gt;\n   ...\n   &lt;plugin&gt;\n    &lt;groupId&gt;io.swagger.core.v3&lt;/groupId&gt;\n    &lt;artifactId&gt;swagger-maven-plugin-jakarta&lt;/artifactId&gt;\n    &lt;version&gt;2.2.2&lt;/version&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;configuration&gt;\n                &lt;outputFormat&gt;YAML&lt;/outputFormat&gt;\n                &lt;outputPath&gt;${project.parent.basedir}/docs&lt;/outputPath&gt;\n                &lt;prettyPrint&gt;true&lt;/prettyPrint&gt;\n                &lt;filterClass&gt;io.jans.configapi.filters.SpecFilter&lt;/filterClass&gt;\n            &lt;/configuration&gt;\n            &lt;phase&gt;compile&lt;/phase&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;resolve&lt;/goal&gt;\n            &lt;/goals&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.swagger.core.v3&lt;/groupId&gt;\n            &lt;artifactId&gt;swagger-models-jakarta&lt;/artifactId&gt;\n            &lt;version&gt;2.2.2&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n  &lt;/plugin&gt;\n   ...\n &lt;/plugins&gt;\n&lt;/build&gt;\n</code></pre> <p>Checkout a sample POM here.</p>","tags":["developer","config-api"]},{"location":"contribute/implementation-design/jans-config-api-design/config-api-swagger-spec-generation/#add-meta-data-in-code","title":"Add meta-data in code","text":"<ul> <li><code>Defining general OpenAPI information</code> @OpenAPIDefinition annotation is used to  populate OpenAPI object fields like - info, tags, servers, security, and externalDocs.  If more than one class is annotated with OpenAPIDefinition, with the same fields  defined, behaviour is inconsistent. Use this is your Application class that extends  javax.ws.rs.core.Application.</li> </ul> <p>Sample code snippet</p> <pre><code>import ...\n...\n@OpenAPIDefinition(info = @Info(title = \"Jans Config API\", version = \"1.0.0\", contact = @Contact(name = \"Gluu Support\", url = \"https://support.gluu.org\", email = \"xxx@gluu.org\"),\n\n        license = @License(name = \"Apache 2.0\", url = \"https://github.com/JanssenProject/jans/blob/main/LICENSE\")),\n\n        tags = { @Tag(name = \"Attribute\"), @Tag(name = \"Default Authentication Method\"),@Tag(name = \"Cache Configuration\"),\n                @Tag(name = \"Cache Configuration \u2013 Memcached\"), @Tag(name = \"Cache Configuration \u2013 Redis\"),\n                @Tag(name = \"Cache Configuration \u2013 in-Memory\"), @Tag(name = \"Cache Configuration \u2013 Native-Persistence\"),\n                @Tag(name = \"Configuration \u2013 Properties\"),\n                @Tag(name = \"Configuration \u2013 SMTP\"), @Tag(name = \"Configuration \u2013 Logging\"),\n                @Tag(name = \"Configuration \u2013 JWK - JSON Web Key (JWK)\"), @Tag(name = \"Custom Scripts\"),\n                @Tag(name = \"Database - LDAP configuration\"),\n                @Tag(name = \"OAuth - OpenID Connect - Clients\"), @Tag(name = \"OAuth - UMA Resources\"),\n                @Tag(name = \"OAuth - Scopes\"), @Tag(name = \"Configuration \u2013 Agama Flow\"),\n                @Tag(name = \"Statistics - User\"), @Tag(name = \"Health - Check\"), @Tag(name = \"Server Stats\"),\n                @Tag(name = \"Auth - Session Management\"),\n                @Tag(name = \"Organization Configuration\"),\n                @Tag(name = \"Auth Server Health - Check\") },\n\n        servers = { @Server(url = \"https://jans.io/\", description = \"The Jans server\") })\n\n@SecurityScheme(name = \"oauth2\", type = SecuritySchemeType.OAUTH2, flows = @OAuthFlows(clientCredentials = @OAuthFlow(tokenUrl = \"https://{op-hostname}/.../token\", scopes = {\n        @OAuthScope(name = \"https://jans.io/oauth/jans-auth-server/config/properties.readonly\", description = \"View Auth Server properties related information\"),\n        @OAuthScope(name = \"https://jans.io/oauth/jans-auth-server/config/properties.write\", description = \"Manage Auth Server properties related information\"),\n        @OAuthScope(name = \"https://jans.io/oauth/config/attributes.readonly\", description = \"View attribute related information\"),\n        @OAuthScope(name = \"https://jans.io/oauth/config/attributes.write\", description = \"Manage attribute related information\"),\n        @OAuthScope(name = \"https://jans.io/oauth/config/attributes.delete\", description = \"Delete attribute related information\"),\n        ...\n       }\n\n)))\npublic class ApiApplication extends Application {\n   ...\n\n}\n</code></pre> <p>Checkout sample code here</p> <p>Sample code snippet</p> <pre><code>import ...\n...\npackage ...;\n...\n\nimport io.swagger.v3.oas.annotations.Operation;\nimport io.swagger.v3.oas.annotations.parameters.RequestBody;\nimport io.swagger.v3.oas.annotations.media.ArraySchema;\nimport io.swagger.v3.oas.annotations.media.Content;\nimport io.swagger.v3.oas.annotations.media.ExampleObject;\nimport io.swagger.v3.oas.annotations.media.Schema;\nimport io.swagger.v3.oas.annotations.responses.ApiResponse;\nimport io.swagger.v3.oas.annotations.responses.ApiResponses;\nimport io.swagger.v3.oas.annotations.security.*;\n\n...\n\n@Path(ApiConstants.ATTRIBUTES)\n@Consumes(MediaType.APPLICATION_JSON)\n@Produces(MediaType.APPLICATION_JSON)\npublic class AttributesResource ... {\n\n    ...\n\n    @Operation(summary = \"Gets a list of Gluu attributes.\", description = \"Gets a list of Gluu attributes.\", operationId = \"get-attributes\", tags = {\n            \"Attribute\" }, security = @SecurityRequirement(name = \"oauth2\", scopes = {\n                    ApiAccessConstants.ATTRIBUTES_READ_ACCESS }))\n    @ApiResponses(value = {\n            @ApiResponse(responseCode = \"200\", description = \"Ok\", content = @Content(mediaType = MediaType.APPLICATION_JSON, schema = @Schema(implementation = PagedResult.class), examples = @ExampleObject(name = \"Response example\" , value = \"example/attribute/attribute-get-all.json\"))),\n            @ApiResponse(responseCode = \"401\", description = \"Unauthorized\"),\n            @ApiResponse(responseCode = \"500\", description = \"InternalServerError\") })\n    @GET\n    @ProtectedApi(scopes = { ApiAccessConstants.ATTRIBUTES_READ_ACCESS })\n    public Response getAttributes(\n            @DefaultValue(ApiConstants.DEFAULT_LIST_SIZE) @QueryParam(value = ApiConstants.LIMIT) int limit,\n            @DefaultValue(\"\") @QueryParam(value = ApiConstants.PATTERN) String pattern,\n            @DefaultValue(ApiConstants.ALL) @QueryParam(value = ApiConstants.STATUS) String status,\n            @DefaultValue(ApiConstants.DEFAULT_LIST_START_INDEX) @QueryParam(value = ApiConstants.START_INDEX) int startIndex,\n            @DefaultValue(ApiConstants.INUM) @QueryParam(value = ApiConstants.SORT_BY) String sortBy,\n            @DefaultValue(ApiConstants.ASCENDING) @QueryParam(value = ApiConstants.SORT_ORDER) String sortOrder) \n            {\n\n        ...\n        return Response.ok(...).build();\n    }\n\n   ...\n\n    @Operation(summary = \"Adds a new attribute\", description = \"Adds a new attribute\", operationId = \"post-attributes\", tags = {\n            \"Attribute\" }, security = @SecurityRequirement(name = \"oauth2\", scopes = {\n                    ApiAccessConstants.ATTRIBUTES_WRITE_ACCESS }))\n    @RequestBody(description = \"GluuAttribute object\", content = @Content(mediaType = MediaType.APPLICATION_JSON, schema = @Schema(implementation = GluuAttribute.class) , examples = @ExampleObject(name = \"Request example\" , value = \"example/attribute/attribute.json\")))\n    @ApiResponses(value = {\n            @ApiResponse(responseCode = \"201\", description = \"Created\", content = @Content(mediaType = MediaType.APPLICATION_JSON, schema = @Schema(implementation = GluuAttribute.class) , examples = @ExampleObject(name = \"Response example\" , value = \"example/attribute/attribute.json\"))),\n            @ApiResponse(responseCode = \"401\", description = \"Unauthorized\"),\n            @ApiResponse(responseCode = \"500\", description = \"InternalServerError\") })\n    @POST\n    @ProtectedApi(scopes = { ApiAccessConstants.ATTRIBUTES_WRITE_ACCESS })\n    public Response createAttribute(@Valid GluuAttribute attribute) {\n        log.debug(\" GluuAttribute details to add - attribute:{}\", attribute);\n        checkNotNull(attribute.getName(), AttributeNames.NAME);\n        checkNotNull(attribute.getDisplayName(), AttributeNames.DISPLAY_NAME);\n        checkResourceNotNull(attribute.getDataType(), AttributeNames.DATA_TYPE);\n        String inum = attributeService.generateInumForNewAttribute();\n        attribute.setInum(inum);\n        attribute.setDn(attributeService.getDnForAttribute(inum));\n        attributeService.addAttribute(attribute);\n        GluuAttribute result = attributeService.getAttributeByInum(inum);\n        return Response.status(Response.Status.CREATED).entity(result).build();\n    }\n\n   ...\n    }\n</code></pre> <p>Checkout a sample code here.</p>","tags":["developer","config-api"]},{"location":"contribute/implementation-design/jans-config-api-design/config-api-swagger-spec-generation/#generate-code-with-maven","title":"Generate code with Maven","text":"<p>The Maven compile command can be used to generate the OpenAPI Swagger Specification. Specification should be generated in <code>outputFormat</code> and <code>outputPath</code> as specified in the <code>swagger-maven-plugin-...</code></p> <pre><code>mvn compile\n</code></pre>","tags":["developer","config-api"]},{"location":"contribute/implementation-design/jans-config-api-design/config-api-swagger-spec-generation/#sample-openapi-swagger-specification","title":"Sample OpenAPI Swagger specification.","text":"<p>Checkout a sample of an autogenerated spec here.</p>","tags":["developer","config-api"]},{"location":"contribute/implementation-design/jans-config-api-design/adr/","title":"Architectural Decision Records","text":"<p>This documentation category holds ADRs, discussions and documents that were used to drive design and architecture of the component or at least have had significant impact on the same.</p>","tags":["design","ADR","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-core-design/","title":"Index","text":""},{"location":"contribute/implementation-design/jans-core-design/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>"},{"location":"contribute/implementation-design/jans-core-design/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>"},{"location":"contribute/implementation-design/jans-core-design/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>"},{"location":"contribute/implementation-design/jans-core-design/adr/","title":"Architectural Decision Records","text":"<p>This documentation category holds ADRs, discussions and documents that were used to drive design and architecture of the component or at least have had significant impact on the same.</p>","tags":["design","ADR","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-fido2-design/","title":"Janssen's FIDO2 server","text":"<p>FIDO2 as an open standard for authentication is based on public key cryptography.</p> <p>Janssen's FIDO2 server - a component inside the Janssen project enables users of RPs to enroll and authenticate themselves using U2F keys, FIDO2 keys or inbuilt platform authenticator. 1. The FIDO2 server uses REST endpoints to communicate with an RP via an https connection. 2. The FIDO2 server implements the FIDO Metadata Service (MDS3) defined by FIDO Alliance. 3. The FIDO2 server stores user data into the same persistence store as the Jans-Auth server. (PostgreSQL, MYSQL etc.)</p>","tags":["developer","fido"]},{"location":"contribute/implementation-design/jans-fido2-design/#components-of-the-fido2-ecosystem-in-janssen","title":"Components of the FIDO2 ecosystem in Janssen","text":"<p>Diagram reference</p> <ol> <li> <p>User: User of an application, the one who possesses the Authenticator and who's role is to pass the Test of User Presence (TUP) (touch device, look, speak etc.).</p> </li> <li> <p>WebAuthn API:</p> <ul> <li>A global web standard for password-less FIDO2 authentication, implemented by most browsers (Google Chrome, Mozilla Firefox, Microsoft Edge, Apple Safari, Opera, Microsoft edge).</li> <li>It provides clients access to the underlying capabilities of the Authenticator.</li> <li>WebAuthn offers a very good user experience, there is no need for any additional browser plugin to be installed.</li> <li>WebAuthn API: enables clients to make requests to authenticators with regards to :</li> <li>creation of a new key-pair</li> <li>provide an assertion about a key</li> <li>report capabilities (capability exists but not offered in Janssen's FIDO2 offering)</li> <li>manage a PIN. (capability exists but not offered in Janssen's FIDO2 offering)</li> </ul> </li> <li> <p>Authenticator: A device which holds the private key. It prompts the user to perform a certain gesture. It can be a platform authenticator that is built into the client device or a roaming authenticator that is connected to the client device through USB, BLE, or NFC.</p> </li> <li> <p>Relying Party: The RP (<code>jans-auth</code> or <code>casa</code>) implements a Javascript Client which makes a registration and authentication request to the WebAuthn API. The Relying Party ID is the DNS domain where the FIDO2 device will be registered and used.</p> </li> <li> <p>CTAP2: Simple and lightweight hardware protocol that enables Authenticators to talk with Supported browsers.</p> </li> <li> <p>FIDO2 Server Janssen's FIDO server is a standalone server communicates with the RP using an API which can be obtained by querying the following URL : <code>https://&lt;myjans-server&gt;/.well-known/fido2-configuration</code> Response:</p> <pre><code>{\n  \"version\": \"1.1\",\n  \"issuer\": \"https://&lt;myjans-server&gt;\",\n  \"attestation\": {\n    \"base_path\": \"https://&lt;myjans-server&gt;/jans-fido2/restv1/attestation\",\n    \"options_enpoint\": \"https://&lt;myjans-server&gt;/jans-fido2/restv1/attestation/options\",\n    \"result_enpoint\": \"https://&lt;myjans-server&gt;/jans-fido2/restv1/attestation/result\"\n  },\n  \"assertion\": {\n    \"base_path\": \"https://&lt;myjans-server&gt;/jans-fido2/restv1/assertion\",\n    \"options_enpoint\": \"https://&lt;myjans-server&gt;/jans-fido2/restv1/assertion/options\",\n    \"result_enpoint\": \"https://&lt;myjans-server&gt;/jans-fido2/restv1/assertion/result\"\n  }\n}\n</code></pre> <p>The two main functionalities are: 1. Attestation 2. Assertion The authenticator credentials obtained after querying the WebAuthn API is forwarded to the FIDO2 server for attestation or assertion.</p> </li> <li> <p>Interception script : In the Janssen ecosystem, the authentication flow that comprises of the calls to WebAuthn API and the FIDO server is achieved using an interception script, details of it can be found here.</p> </li> </ol>","tags":["developer","fido"]},{"location":"contribute/implementation-design/jans-fido2-design/#attestation-formats-supported-by-janssens-fido-server","title":"Attestation formats supported by Janssen's FIDO server","text":"<ul> <li>Packed (FIDO2): The most used attestation format</li> <li>TPM : Attestation for Windows10 devices</li> <li>Android key attestation : Attestation for android devices.</li> <li>Android SafetyNet : Any Android devices running 7+</li> <li>FIDO U2F: Legacy U2F authenticators</li> <li>Apple Anonymous: Apple devices do attestations differently.</li> <li>None</li> </ul>","tags":["developer","fido"]},{"location":"contribute/implementation-design/jans-fido2-design/#backward-compatibility-with-u2f-authenticators","title":"Backward compatibility with U2F authenticators","text":"<p>The FIDO server offers registration and authentication using legacy U2F authenticators.</p>","tags":["developer","fido"]},{"location":"contribute/implementation-design/jans-fido2-design/#references","title":"References","text":"<ol> <li>https://www.w3.org/TR/webauthn-2/</li> <li>http://fidoalliance.org/specs/mds/fido-metadata-statement-v3.0-ps-20210518.html</li> </ol>","tags":["developer","fido"]},{"location":"contribute/implementation-design/jans-fido2-design/#tools","title":"Tools","text":"<ol> <li>https://jwt.io/ \u2013 For JWT decoding and debugging</li> <li>https://www.base64decode.org/ \u2013 For Decoding Base64 to UTF8</li> <li>https://fidoalliance.org/certification/fido-certified-products/ - To browse authenticators listed with FIDO Alliance</li> </ol>","tags":["developer","fido"]},{"location":"contribute/implementation-design/jans-fido2-design/adr/","title":"Architectural Decision Records","text":"<p>This documentation category holds ADRs, discussions and documents that were used to drive design and architecture of the component or at least have had significant impact on the same.</p>","tags":["design","ADR","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-orm-design/","title":"Index","text":""},{"location":"contribute/implementation-design/jans-orm-design/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>"},{"location":"contribute/implementation-design/jans-orm-design/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>"},{"location":"contribute/implementation-design/jans-orm-design/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>"},{"location":"contribute/implementation-design/jans-orm-design/adr/","title":"Architectural Decision Records","text":"<p>This documentation category holds ADRs, discussions and documents that were used to drive design and architecture of the component or at least have had significant impact on the same.</p>","tags":["design","ADR","Architectural Decision Records"]},{"location":"contribute/implementation-design/jans-scim-design/","title":"Index","text":""},{"location":"contribute/implementation-design/jans-scim-design/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>"},{"location":"contribute/implementation-design/jans-scim-design/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>"},{"location":"contribute/implementation-design/jans-scim-design/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>"},{"location":"contribute/implementation-design/jans-scim-design/adr/","title":"Architectural Decision Records","text":"<p>This documentation category holds ADRs, discussions and documents that were used to drive design and architecture of the component or at least have had significant impact on the same.</p>","tags":["design","ADR","Architectural Decision Records"]},{"location":"governance/charter/","title":"Technical Charter (the \u201cCharter\u201d) for Janssen Project a Series of LF Projects, LLC","text":"<p>Adopted December 8, 2020</p> <p>This Charter sets forth the responsibilities and procedures for technical contribution to, and oversight of, the Janssen open source project, which has been established as Janssen Project a Series of LF Projects, LLC (the \u201cProject\u201d).  LF Projects, LLC (\u201cLF Projects\u201d) is a Delaware series limited liability company. All contributors (including committers, maintainers, and other technical positions) and other participants in the Project (collectively, \u201cCollaborators\u201d) must comply with the terms of this Charter.</p> <ol> <li> <p>Mission and Scope of the Project</p> <ol> <li>The mission of the Project is to develop and maintain a cloud native identity and authorization platform that comprehensively implements OAuth, OpenID Connect and the User Managed Access protocol, while maintaining flexibility and horizontal scalability.</li> <li>The scope of the Project includes collaborative development under the Project License (as defined herein) supporting the mission, including documentation, testing, integration and the creation of other artifacts that aid the development, deployment, operation or adoption of the open source project.</li> </ol> </li> <li> <p>Technical Steering Committee</p> <ol> <li>The Technical Steering Committee (the \u201cTSC\u201d) will be responsible for all technical oversight of the open source Project.</li> <li>The TSC voting members are initially the Project\u2019s Committers. At the inception of the project, the Committers of the Project will be as set forth within the \u201cCONTRIBUTING\u201d file within the Project\u2019s code repository. The TSC may choose an alternative approach for determining the voting members of the TSC, and any such alternative approach will be documented in the CONTRIBUTING file.  Any meetings of the Technical Steering Committee are intended to be open to the public, and can be conducted electronically, via teleconference, or in person.</li> <li>TSC projects generally will involve Contributors and Committers. The TSC may adopt or modify roles so long as the roles are documented in the CONTRIBUTING file. Unless otherwise documented:<ol> <li>Contributors include anyone in the technical community that contributes code, documentation, or other technical artifacts to the Project;</li> <li>Committers are Contributors who have earned the ability to modify (\u201ccommit\u201d) source code, documentation or other technical artifacts in a project\u2019s repository; and</li> <li>A Contributor may become a Committer by a majority approval of the existing Committers. A Committer may be removed by a majority approval of the other existing Committers.</li> </ol> </li> <li>Participation in the Project through becoming a Contributor and Committer is open to anyone so long as they abide by the terms of this Charter.</li> <li>The TSC may (1) establish work flow procedures for the submission, approval, and closure/archiving of projects, (2) set requirements for the promotion of Contributors to Committer status, as applicable, and (3) amend, adjust, refine and/or eliminate the roles of Contributors, and Committers, and create new roles, and publicly document any TSC roles, as it sees fit.</li> <li>The TSC may elect a TSC Chair, who will preside over meetings of the TSC and will serve until their resignation or replacement by the TSC.</li> <li>Responsibilities: The TSC will be responsible for all aspects of oversight relating to the Project, which may include:<ol> <li>coordinating the technical direction of the Project;</li> <li>approving project or system proposals (including, but not limited to, incubation, deprecation, and changes to a sub-project\u2019s scope);</li> <li>organizing sub-projects and removing sub-projects;</li> <li>creating sub-committees or working groups to focus on cross-project technical issues and requirements;</li> <li>appointing representatives to work with other open source or open standards communities;</li> <li>establishing community norms, workflows, issuing releases, and security issue reporting policies;</li> <li>approving and implementing policies and processes for contributing (to be published in the CONTRIBUTING file) and coordinating with the series manager of the Project (as provided for in the Series Agreement, the \u201cSeries Manager\u201d) to resolve matters or concerns that may arise as set forth in Section 7 of this Charter;</li> <li>discussions, seeking consensus, and where necessary, voting on technical matters relating to the code base that affect multiple projects; and</li> <li>coordinating any marketing, events, or communications regarding the Project.</li> </ol> </li> </ol> </li> <li> <p>TSC Voting</p> <ol> <li>While the Project aims to operate as a consensus-based community, if any TSC decision requires a vote to move the Project forward, the voting members of the TSC will vote on a one-vote per voting member basis.</li> <li>Quorum for TSC meetings requires at least fifty percent of all voting members of the TSC to be present. The TSC may continue to meet if quorum is not met but will be prevented from making any decisions at the meeting.</li> <li>Except as provided in Section 7.iii. and 8.i, decisions by vote at a meeting require a majority vote of those in attendance, provided quorum is met. Decisions made by electronic vote without a meeting require a majority vote of all voting members of the TSC.</li> <li>In the event a vote cannot be resolved by the TSC, any voting member of the TSC may refer the matter to the Series Manager for assistance in reaching a resolution.</li> </ol> </li> <li> <p>Compliance with Policies</p> <ol> <li>This Charter is subject to the Series Agreement for the Project and the Operating Agreement of LF Projects. Contributors will comply with the policies of LF Projects as may be adopted and amended by LF Projects, including, without limitation the policies listed at https://lfprojects.org/policies/.</li> <li>The TSC may adopt a code of conduct (\u201cCoC\u201d) for the Project, which is subject to approval by the Series Manager.  In the event that a Project-specific CoC has not been approved, the LF Projects Code of Conduct listed at https://lfprojects.org/policies will apply for all Collaborators in the Project.</li> <li>When amending or adopting any policy applicable to the Project, LF Projects will publish such policy, as to be amended or adopted, on its web site at least 30 days prior to such policy taking effect; provided, however, that in the case of any amendment of the Trademark Policy or Terms of Use of LF Projects, any such amendment is effective upon publication on LF Project\u2019s web site.</li> <li>All Collaborators must allow open participation from any individual or organization meeting the requirements for contributing under this Charter and any policies adopted for all Collaborators by the TSC, regardless of competitive interests. Put another way, the Project community must not seek to exclude any participant based on any criteria, requirement, or reason other than those that are reasonable and applied on a non-discriminatory basis to all Collaborators in the Project community.</li> <li>The Project will operate in a transparent, open, collaborative, and ethical manner at all times. The output of all Project discussions, proposals, timelines, decisions, and status should be made open and easily visible to all. Any potential violations of this requirement should be reported immediately to the Series Manager.</li> </ol> </li> <li> <p>Community Assets</p> <ol> <li>LF Projects will hold title to all trade or service marks used by the Project (\u201cProject Trademarks\u201d), whether based on common law or registered rights.  Project Trademarks will be transferred and assigned to LF Projects to hold on behalf of the Project. Any use of any Project Trademarks by Collaborators in the Project will be in accordance with the license from LF Projects and inure to the benefit of LF Projects.  </li> <li>The Project will, as permitted and in accordance with such license from LF Projects, develop and own all Project GitHub and social media accounts, and domain name registrations created by the Project community.</li> <li>Under no circumstances will LF Projects be expected or required to undertake any action on behalf of the Project that is inconsistent with the tax-exempt status or purpose, as applicable, of LFP, Inc. or LF Projects, LLC.</li> </ol> </li> <li> <p>General Rules and Operations.</p> <ol> <li>The Project will:<ol> <li>engage in the work of the Project in a professional manner consistent with maintaining a cohesive community, while also maintaining the goodwill and esteem of LF Projects, LFP, Inc. and other partner organizations in the open source community; and</li> <li>respect the rights of all trademark owners, including any branding and trademark usage guidelines.</li> </ol> </li> </ol> </li> <li> <p>Intellectual Property Policy</p> <ol> <li>Collaborators acknowledge that the copyright in all new contributions will be retained by the copyright holder as independent works of authorship and that no contributor or copyright holder will be required to assign copyrights to the Project.</li> <li>Except as described in Section 7.iii., all contributions to the Project are subject to the following:<ol> <li>All new inbound code contributions to the Project must be made using the Apache License, Version 2.0, available at https://www.apache.org/licenses/LICENSE-2.0 (the \u201cProject License\u201d).</li> <li>All new inbound code contributions must also be accompanied by a Developer Certificate of Origin (http://developercertificate.org) sign-off in the source code system that is submitted through a TSC-approved contribution process which will bind the authorized contributor and, if not self-employed, their employer to the applicable license;</li> <li>All outbound code will be made available under the Project License.</li> <li>Documentation will be received and made available by the Project under the Creative Commons Attribution 4.0 International License (available at http://creativecommons.org/licenses/by/4.0/).</li> <li>The Project may seek to integrate and contribute back to other open source projects (\u201cUpstream Projects\u201d). In such cases, the Project will conform to all license requirements of the Upstream Projects, including dependencies, leveraged by the Project.  Upstream Project code contributions not stored within the Project\u2019s main code repository\u00a0will comply with the contribution process and license terms for the applicable Upstream Project.</li> </ol> </li> <li>The TSC may approve the use of an alternative license or licenses for inbound or outbound contributions on an exception basis. To request an exception, please describe the contribution, the alternative open source license(s), and the justification for using an alternative open source license for the Project. License exceptions must be approved by a two-thirds vote of the entire TSC.</li> <li>Contributed files should contain license information, such as SPDX short form identifiers, indicating the open source license or licenses pertaining to the file.</li> </ol> </li> <li> <p>Amendments</p> <ol> <li>This charter may be amended by a two-thirds vote of the entire TSC and is subject to approval by LF Projects.</li> </ol> </li> </ol>","tags":["governance","charter"]},{"location":"governance/cla/","title":"Janssen Project Contributor License Agreement (CLA)","text":""},{"location":"governance/cla/#1-definitions","title":"1. Definitions","text":"<ol> <li>\"Contribution\" refers to any original work of authorship, including any modifications or    additions to existing work, that is intentionally submitted by you to this project for    inclusion in, or documentation of, any of the repositories managed by the project (the    \"Work\").</li> <li>\"You\" refers to the individual or entity making the Contribution identified by the GitHub    username _____.</li> <li>\"Project\" refers to the open-source project and its maintainers, contributors, and    licensees.</li> </ol>"},{"location":"governance/cla/#2-copyright-ownership","title":"2. Copyright Ownership","text":"<p>You retain ownership of the copyright in your Contribution. This CLA does not transfer ownership of your copyright to the Project or its maintainers.</p>"},{"location":"governance/cla/#3-license-grant","title":"3. License Grant","text":"<p>By submitting your Contribution, you hereby grant the Project and its maintainers a perpetual, worldwide, non-exclusive, royalty-free, irrevocable, sublicensable, and transferable license to:</p> <ol> <li>Use, reproduce, distribute, prepare derivative works of, publicly display, publicly perform,    and otherwise exploit your Contribution as part of the Project.</li> <li>Make, have made, sell, offer for sale, import, and otherwise exploit products or services    derived from or incorporating your Contribution, without any compensation to you.</li> <li>Sublicense these rights to third parties for any purpose, including commercial purposes.</li> <li>This license grant shall survive any change in maintainers, ownership, or governance of the Project.</li> </ol>"},{"location":"governance/cla/#4-patent-license","title":"4. Patent License","text":"<p>You grant to the Project, its maintainers, and its licensees a perpetual, worldwide, non-exclusive, royalty-free, irrevocable license under any patent rights you hold, owned or licensed, to:</p> <ol> <li>Make, have made, use, sell, offer for sale, import, or otherwise exploit the Contribution,    either as part of the Project or any derivative work of the Project.</li> <li>Extend this grant to any necessary claims that would be infringed by the combination of your    Contribution with the Project as a whole.</li> </ol>"},{"location":"governance/cla/#5-moral-rights-waiver","title":"5. Moral Rights Waiver","text":"<p>You waive any and all moral rights, including rights of attribution, integrity, and approval of modifications, to the fullest extent permitted by applicable law.</p>"},{"location":"governance/cla/#6-representation-warranty-and-indemnification","title":"6. Representation, Warranty, and Indemnification","text":"<p>You represent and warrant that:</p> <ol> <li>You are legally entitled to grant the above license.</li> <li>The Contribution is your original creation or, if it is based on prior work, you have the    necessary rights to submit it under the terms of this CLA.</li> <li>Your Contribution does not violate any third-party rights, including intellectual property    rights.</li> <li>If any part of your Contribution was generated using artificial intelligence (AI), you    represent that you have the necessary rights to contribute such work under this agreement.</li> <li>You agree to indemnify, defend, and hold harmless the Project, its maintainers, and its    licensees from any claims, damages, liabilities, costs, and expenses (including legal fees)    arising from your breach of this agreement or any claim that your Contribution infringes on    a third-party\u2019s rights.</li> </ol>"},{"location":"governance/cla/#7-no-obligation-to-use","title":"7. No Obligation to Use","text":"<p>The Project is under no obligation to use, distribute, or incorporate your Contribution in any way.</p>"},{"location":"governance/cla/#8-governing-law-and-dispute-resolution","title":"8. Governing Law and Dispute Resolution","text":"<p>This agreement shall be governed by and interpreted in accordance with the laws of the State of Delaware, United States, without regard to conflict of law principles.</p>"},{"location":"governance/cla/#9-agreement","title":"9. Agreement","text":"<p>By signing this agreement and submitting your Contribution, you indicate your agreement to these terms.</p> <p>Signed: ______</p> <p>Printed Name: ______</p> <p>Date: ______</p> <p>GitHub Username: ______</p> <p>If on behalf of an organization:</p> <p>Title: ______</p> <p>Organization: ______</p>"},{"location":"governance/copyright-notices/","title":"Copyrights","text":"","tags":["governance","copyrights"]},{"location":"governance/copyright-notices/#ownership-of-copyrights-in-janssen-project-contributions","title":"Ownership of Copyrights in Janssen Project Contributions","text":"<p>When source code, documentation and other content is contributed to the Janssen Project, the copyrights in those contributions remain owned by the original copyright holders.</p> <p>The copyrights are not assigned to the Janssen Project. Instead, they are licensed for distribution as part of the project. Whether a project uses a DCO or a CLA, the original copyright holders retain their copyrights.</p>","tags":["governance","copyrights"]},{"location":"governance/copyright-notices/#copyright-notices","title":"Copyright Notices","text":"<p>The Janssen Project does not require or recommend that every contributor include their copyright notice in contributed files. See below for more details on why not.</p> <p>Instead, we recommend using a more general statement in a form similar to the following:</p> <ul> <li>Copyright The Janssen Project Authors.</li> <li>Copyright The Janssen Project Contributors.</li> <li>Copyright Contributors to the Janssen Project.</li> </ul> <p>These statements are intended to communicate the following: - the work is copyrighted; - the contributors of the code licensed it, but retain ownership of their copyrights; and - it was licensed for distribution as part of the named project.</p> <p>By using a common format, the project avoids having to deal with names of copyright holders, years or ranges of years, and variations on the (c) symbol. This aims to minimize the burden on developers and maintainers as well as redistributors of the code.</p>","tags":["governance","copyrights"]},{"location":"governance/copyright-notices/#what-if-i-want-my-copyright-notice-included","title":"What if I want my copyright notice included?","text":"<p>Please note that it is not wrong, and it is acceptable, if a contributor wishes to keep their own copyright notices on their contributions. The above is a recommended format for ease of use, but is not mandated by the Janssen Project.</p> <p>If you are contributing on behalf of your employer, you may wish to discuss with your legal department about whether they will require you to include a copyright notice identifying them as the copyright holder in contributions.</p>","tags":["governance","copyrights"]},{"location":"governance/copyright-notices/#what-about-third-party-code","title":"What about Third Party Code?","text":"<p>If a file only contains code that originates from a third party source who didn't contribute it themselves, then you would not want to add the notices above. (In a similar vein, you wouldn't add a notice identifying you as the copyright holder either, if you didn't own it.) Just preserve the existing copyright and license notices as they are.</p> <p>If, however, you add copyrightable content to a pre-existing file from another project, then at that point you could add a copyright notice similar to the one above.</p>","tags":["governance","copyrights"]},{"location":"governance/copyright-notices/#dont-change-someone-elses-notice-without-their-permission","title":"Don't Change Someone Else's Notice without their Permission","text":"<p>You should not change or remove someone else's copyright notice unless they have expressly permitted you to do so. This includes third parties' notices in pre-existing code.</p>","tags":["governance","copyrights"]},{"location":"governance/copyright-notices/#why-not-list-every-copyright-holder","title":"Why not list every copyright holder?","text":"<p>There are several reasons why the Janssen Project doesn't require or recommend trying to list every copyright holder for contributions to every file:</p> <ul> <li>Copyright notices are not mandatory in order for the contributor to retain   ownership of their copyright.</li> <li>Copyright notices are rarely kept up to date as a file evolves, resulting in   inaccurate statements.</li> <li>Trying to keep notices up to date, or to correct notices that have become   inaccurate, increases the burden on developers without tangible benefit.</li> <li>Developers and maintainers often do not want to have to worry about e.g.   whether a minor contribution (such as a typo fix) means that a new copyright   notice should be added.</li> <li>Adding many different copyright notices may increase the burden on downstream   distributors, if their license compliance processes involve reproducing   notices.</li> <li>The specific individual or legal entity that owns the copyright might not be   known to the contributor; it could be you, your employer, or some other entity.</li> </ul>","tags":["governance","copyrights"]},{"location":"governance/triage/","title":"Janssen Triage Process and labels","text":"<p>Triage process is used to quickly screen and categorise new issues and PRs. Aim is to determine characteristics of new PRs/issues and take quick actions if possible.</p> <p>Triage process is a continuous process. As new issues/PRs come in, the community initiates discussions, adds labels, and asks for more details. This process does not wait for triage call or a meeting to be called. Community holds triage calls at a regular cadence. Triage calls are mainly utilized to discuss issue/PR where consensus is not yet reached and to pick up anything which is not yet triaged. It is encouraged to complete triage outside of triage call to improve velocity.</p>","tags":["governance","triage"]},{"location":"governance/triage/#stages-in-triage-process","title":"Stages in triage process:","text":"Name Description Needs triage When a new issue or PR is created, it is automatically labeled as <code>needs-triage</code>. The label indicates that this issue is missing some of the metadata. Metadata such as the missing owner. Or the owner needs to add metadata labels for <code>effort</code>, <code>priority</code>, <code>kind</code> and component. Once these labels are added, the owner should remove this label and add <code>ready-for-triage</code> label. Ready for triage This label indicates that the issue has enough information and can be triaged. Triaged All issues/PRs with the label <code>ready-for-triage</code> will be reviewed by core members of the community who have permission to add <code>triaged</code> label. Reviewer reviews issue/PR to check if the issue/PR is fully triaged and can be added to backlog without discussion on triage call. At this point, the label <code>triaged</code> is added and the label <code>ready-for-triage</code> is removed. <p>We expect most of the isseus and PRs will be able to follow above path and quickly move out of triage process without waiting for triage call. Issues/PRs which still doesn't have <code>triaged</code> label, or has <code>needs-discussion</code> label, will be discussed during triage call.</p>","tags":["governance","triage"]},{"location":"governance/triage/#labels","title":"Labels","text":"<p>Github labels help us annotate issues/PRs with additional data. Janssen community uses labels, as detailed below, to communicate information and help making decisions about issues/PRs.</p>","tags":["governance","triage"]},{"location":"governance/triage/#communication-labels","title":"Communication labels","text":"<p>These labels communicate status of current triage process for an issue/PR or indicate where community contribution is required. Most of communication labels would be replaced by other labels as triage process progresses and issue enters active development. For example, <code>help wanted</code> label would be removed once issue gets under active development and a community members takes ownership of the issue. Below is the list of labels which fall under this category:</p> Label Indicates That <code>needs-triage</code> issue/PR needs triaging <code>ready-for-triage</code> that sufficient details has been added to the issue/PR in form of labels and is ready for triage review <code>triaged</code> Issue/PR is fully triaged <code>needs-information</code> Indicates that creator needs to add more information to issue/PR in order to be meaningfully triaged. When adding this label, also comment on the issue about what information is needed <code>needs-discussion</code> Indicates that issue needs discussion during triage meeting. When adding this label, also comment on the issue about what is it that demands discussion on this issue <code>good first issue</code> Indicates to the community that this issue suitable for first time contributor <code>help wanted</code> Indicates to the community that this issue has complexity which is suitable for contribution from any external contributor","tags":["governance","triage"]},{"location":"governance/triage/#metadata-labels","title":"Metadata labels","text":"<p>These labels enrich issue/PR with metadata that will help during triage process and active development. These labels may not be removed from issue/PR, though value of labels may change as development progresses. For example, <code>effort</code> label may change from <code>effort-3</code> to <code>effort-8</code> as we understand issue in more detail. Below is the list of labels in this category:</p> Label Indicates That Details <code>comp-&lt;module&gt;</code> Major Janssen components needing change in order to fix this issue/PR. For example, if this issue/PR would require change in files under fido2 module (under jans/fido2) , then apply <code>comp-jans-fido2</code> label e.g <code>comp-jans-auth-server</code>,<code>comp-jans-fido2</code>, <code>area-&lt;concern&gt;</code> Cross-cutting concerns involved in fixing this issue/PR. For example, if changes introduced by this issue/PR will need changes in documentation and need to be mentioned in release notes as well, then apply <code>area-documentation</code>, <code>area-release-notes</code>. <code>area-CI</code> should be applied when changes are required in artifacts relevent to automation, CI build infrastructure or release management process. An example of such artifact would be Github workflow scripts located under <code>.github/workflows</code> Labels available: <code>area-documentation</code>, <code>area-release-notes</code>, <code>area-CI</code> <code>kind-bug</code> Issue/PR is a bug in existing functionality <code>kind-enhancement</code> Issue/PR is an enhancement to an existing functionality <code>kind-feature</code> Issue/PR is new feature request <code>kind-question</code> Issue/PR is a question that can be addressed via pointers to documentation or user education <code>kind-duplicate</code> Issue/PR is a duplicate of existing issue/PR. Original issue should be mentioned in the comments using Duplicate of reply <code>kind-dependencies</code> Fix for Issue/PR pertains to external dependencies <code>effort-1</code> Relative effort required for completion <code>effort-2</code> Relative effort required for completion <code>effort-3</code> Relative effort required for completion <code>effort-5</code> Relative effort required for completion <code>effort-8</code> Relative effort required for completion <code>effort-13</code> Relative effort required for completion <code>effort-21</code> Relative effort required for completion <code>priority-0</code> An issue that causes a full outage, breakage, or major function unavailability for everyone, without any known workaround. The issue must be fixed immediately, taking precedence over all other work. Should receive updates at least once per day. <code>priority-1</code> An issue that significantly impacts a large percentage of users; if there is a workaround it is partial or overly painful. The issue should be resolved before the next release. <code>priority-2</code> The issue is important to a large percentage of users, with a workaround. Issues that are significantly ugly or painful (especially first-use or install-time issues). Issues with workarounds that would otherwise be P0 or P1. <code>priority-3</code> An issue that is relevant to core functions, but does not impede progress. Important, but not urgent. <code>priority-4</code> A relatively minor issue that is not relevant to core functions, or relates only to the attractiveness or pleasantness of use of the system. Good to have but not necessary changes/fixes. <code>priority-5</code> The team acknowledges the request but (due to any number of reasons) does not plan to work on or accept contributions for this request. The issue remains open for discussion.","tags":["governance","triage"]},{"location":"governance/triage/#bot-labeling-methodology","title":"Bot labeling methodology","text":"<p>The following labels are automatically assigned to Issues and PRs in GitHub following the schema provided in this file.</p> Label Method <code>comp-&lt;module&gt;</code> The bot will detect from the title the component between the parentheses. <code>feat(jans-auth-server): detect</code> will result in the label <code>comp-jans-auth-server</code> added to the issue or PR. In a PR these labels are also detected by modified files path <code>area-&lt;concern&gt;</code> The bot will detect from the title the area appropriate. <code>ci: adding something new to our ci</code> will result in the label <code>area-CI</code> added to the issue or PR. In a PR these labels are also detected by modified files path. <code>kind-bug</code> The bot will detect this from the conventional commit written title <code>kind-enhancement</code> The bot will detect this from the conventional commit written title <code>kind-feature</code> The bot will detect this from the conventional commit written title <code>kind-question</code> Issue/PR is a question that can be addressed via pointers to documentation or user education <code>kind-dependencies</code> The bot will detect this from the conventional commit written title","tags":["governance","triage"]},{"location":"includes/cn-system-requirements/","title":"Cn system requirements","text":"<p>The resources may be set minimally to the below:</p> <ul> <li>8-12 GB RAM based on the services deployed</li> <li>8-10 CPU cores based on the services deployed</li> <li>50GB hard-disk</li> </ul> <p>Use the listing below for a detailed estimation of minimum required resources. The table contains the default resources recommendation per service. Depending on the use of each service the resources need may be increased or decreased.</p> Service CPU Unit RAM Disk Space Processor Type Required Auth server 2.5 2.5GB N/A 64 Bit Yes config - job 0.3 0.3GB N/A 64 Bit Yes on fresh installs persistence - job 0.3 0.3GB N/A 64 Bit Yes on fresh installs auth-key-rotation 0.3 0.3GB N/A 64 Bit No [Strongly recommended] cleanup - job 0.3 0.3GB N/A 64 Bit No [Strongly recommended] fido2 0.5 0.5GB N/A 64 Bit No scim 1 1GB N/A 64 Bit No nginx 1 1GB N/A 64 Bit No config-api 1 1GB N/A 64 Bit No casa 0.5 0.5GB N/A 64 Bit No link 0.5 1GB N/A 64 Bit No saml 0.5 1GB N/A 64 Bit No kc-scheduler - job 0.3 0.3GB N/A 64 Bit No <p>Releases of images are in style 0.0.0-nightly or x.y-z-1</p>"},{"location":"janssen-server/","title":"Administration","text":"<p>Welcome Admins! This collection of guides will help you deploy, configure and operate Janssen software. Use the left navigation to dig deeper into each specific area.</p> <ul> <li> <p>Deployment and Planning Guide  High level design concepts and architecture.</p> </li> <li> <p>Installation Howto's for VM and cloud-native deployment</p> </li> <li> <p>Kubernetes Operation Guide Day-to-day administration for cloud-native</p> </li> <li> <p>VM Operation Guide Day-to-day administration if you installed a SUSE, Red Hat, or Ubuntu Linux package.</p> </li> <li> <p>Configuration Guide How to use the various configuration tools: command line, <code>curl</code>, or the text user interface (\"TUI\").</p> </li> <li> <p>Auth Server Admin Guide How to configure OpenID, OAuth, authentication workflows, and other core functional digital identity features.</p> </li> <li> <p>Developer Guide How to write code to customize the Janssen, and introducing Agama, a programming language for web authentication flows.</p> </li> <li> <p>Reference Guide Autogenerated content like JSON properties, OpenAPI docs, database schemas, javadocs.</p> </li> <li> <p>FIDO Admin Guide Operational and functional info for the FIDO service.</p> </li> <li> <p>SCIM Admin Guide Operational and functional info for the SCIM service.</p> </li> <li> <p>Integration Guide A collection of docs about configuring third party software and SaaS providers.</p> </li> <li> <p>Config API Admin Guide This required component is used by all configuration tools to write Janssen software configuration to the database.</p> </li> <li> <p>Janssen Recipes Howto's about various frequently asked topics</p> </li> <li> <p>Upgrade Guide Getting to the latest version of Janssen.</p> </li> <li> <p>Script Catalog Examples of doing useful stuff with the various Janssen interception scripts.</p> </li> <li> <p>User Management How to use <code>jans-link</code> and other available tools for  user management</p> </li> </ul> <p>Contribute</p> <p>If you\u2019d like to contribute to this document, get started with the Contribution Guide</p>","tags":["administration"]},{"location":"janssen-server/architecture/","title":"Architecture &amp; Concepts","text":"<p>This section provides technical documentation about Janssen's architecture, internal components, and development concepts.</p>","tags":["architecture","concepts","reference"]},{"location":"janssen-server/architecture/#what-youll-find-here","title":"What You'll Find Here","text":"<ul> <li>Components Overview - High-level description of Janssen deployment components</li> <li>Auth Server Internals - Detailed documentation of endpoints, cryptography, and internationalization</li> <li>Agama Engine - The authentication flow engine architecture</li> <li>Developer Guide - How to extend and customize Janssen</li> <li>Implementation Design - Architectural Decision Records (ADRs) and design documents</li> <li>Reference - API documentation, JSON configuration, and property references</li> </ul> <p>Use the navigation menu to explore specific topics.</p>","tags":["architecture","concepts","reference"]},{"location":"janssen-server/auth-server/","title":"Auth Server","text":"<p>Auth Server provides the federated identity functionality of the Janssen Platform. The server is a fork of oxAuth, the engine of Gluu Server 4. The design goal of Auth Server was speed, scalability and flexibility for large scale enterprise deployments. It is based on the Java Weld framework, a stable platform that provides many features out of the box.</p> <p>Auth Server is a fairly comprehensive implementation of OpenID Connect, which itself is built on top of OAuth 2.0. See the latest OpenID certifications for OpenID Providers, FAPI OpenID Providers, and FAPI-CIBA OpenID Providers for the latest results.</p>","tags":["administration","auth-server"]},{"location":"janssen-server/auth-server/#supported-standards","title":"Supported Standards","text":"<p>OpenID</p> <ul> <li>OpenID Connect Core 1.0</li> <li>OpenID Connect Discovery 1.0</li> <li>OpenID Connect Dynamic Registration</li> <li>OpenID Connect Client-Initiated Backchannel Authentication Flow - Core 1.0</li> <li>Financial-grade API Security Profile 1.0 - Part 1: Baseline</li> <li>Financial-grade API Security Profile 1.0 - Part 2: Advanced</li> <li>OpenIDConnect Front-Channel Logout 1.0</li> <li>OpenID Connect Back-Channel Logout 1.0</li> <li>OpenID Connect Session Management</li> <li>Draft - JWT Secured Authorization Response Mode for OAuth 2.0 (JARM)</li> <li>Draft - Financial-grade API: Client Initiated Backchannel Authentication Profile</li> <li>Draft -  OpenID Connect Native SSO for Mobile Apps 1.0</li> <li>Initiating User Registration via OpenID Connect 1.0</li> <li>The AuthZEN Authorization API 1.0</li> </ul> <p>** OAuth **</p> <ul> <li>RFC 6749 The OAuth 2.0 Authorization Framework</li> <li>OAuth 2.0 Multiple Response Type Encoding Practices</li> <li>OAuth 2.0 Form Post Response Mode</li> <li>RFC 6750 The OAuth 2.0 Authorization Framework: Bearer Token Usage</li> <li>RFC 7009 OAuth 2.0 Token Revocation</li> <li>RFC 7519 JSON Web Token (JWT)</li> <li>RFC 7591 OAuth 2.0 Dynamic Client Registration Protocol</li> <li>RFC 7592 OAuth 2.0 Dynamic Client Registration Management Protocol</li> <li>RFC 7636 Proof Key for Code Exchange by OAuth Public Clients</li> <li>RFC 7662 OAuth 2.0 Token Introspection</li> <li>RFC 8252 OAuth 2.0 for Native Apps</li> <li>RFC 8414 OAuth 2.0 Authorization Server Metadata</li> <li>RFC 8628 OAuth 2.0 Device Authorization Grant</li> <li>RFC 8693 OAuth 2.0 Token Exchange</li> <li>RFC 8705 OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens</li> <li>RFC 9068 JSON Web Token (JWT) Profile for OAuth 2.0 Access Tokens</li> <li>RFC 9126 OAuth 2.0 Pushed Authorization Requests</li> <li>Draft - OAuth 2.0 Demonstrating Proof-of-Possession at the Application Layer (DPoP)</li> <li>Draft - JWT Response for OAuth Token Introspection</li> <li>OAuth 2.0 Rich Authorization Requests</li> <li>[Token Status List (TSL)] (https://datatracker.ietf.org/doc/html/draft-ietf-oauth-status-list-13)</li> </ul> <p>** User Managed Access (UMA) **</p> <ul> <li>Federated Authorization for User-Managed Access (UMA) 2.0</li> <li>User-Managed Access (UMA) 2.0 Grant for OAuth 2.0 Authorization</li> </ul> <p>For the above specifications, Auth Server implements many features--all of the MUST's, but also many of the SHOULD's and MAY's. If you find any discrepancies, please raise an issue.</p>","tags":["administration","auth-server"]},{"location":"janssen-server/auth-server/config/","title":"Configuration Overview","text":"<p>In some ways, this whole Auth Server admin guide is about configuration. But you have to start somewhere! This page provides a quick overview before you dive in!</p>","tags":["administration","auth-server","configuration"]},{"location":"janssen-server/auth-server/config/#config-server","title":"Config Server","text":"<p>The Configuration Server is a JSON/REST API that writes to the database, generates the keys, and does much of the other work you need to make your Janssen Project infrastructure solve your digital identity challenges. See the Config API Guide for more information.</p>","tags":["administration","auth-server","configuration"]},{"location":"janssen-server/auth-server/config/#tools","title":"Tools","text":"<ol> <li>API - you can call the configuration endpoints with the API tool of your choice, like <code>curl</code>. With this mechanism, you can use client credential grant to obtain an OAuth token--just make sure it has the required scope to call the method / endpoint. See the Curl Guide for more info.</li> <li>CLI - The CLI, or Command Line Interface, calls the API for you. It uses the device flow to authenticate the person who is behind the config changes. See the Configuration CLI Guide for more info.</li> <li>TUI - The TUI, or Text User Interface, is a menu-based interactive tool that provides a more intuitive experience. When you make changes via the TUI, it also creates a log of the equivalent CLI command, in case you want a shortcut next time around. See the TUI Guide for more info.</li> </ol>","tags":["administration","auth-server","configuration"]},{"location":"janssen-server/auth-server/config/#client-versus-server-configuration","title":"Client versus Server Configuration","text":"<p>Some behaviors are controlled at the server level. For example, should your Auth Server allow dynamic client registration? Other features you can configure either at the server or client level. For example, do you want user claims in an <code>id_token</code>? Maybe you always want them (server), or maybe only sometimes (client). See the JSON Configuration/Properties for an overview of the server level configuration options. For client configuration options, see the Client Schema page.</p>","tags":["administration","auth-server","configuration"]},{"location":"janssen-server/auth-server/config/#interception-scripts","title":"Interception Scripts","text":"<p>Janssen is a very flexible platform, that lets you customize many of the flows to meet your exact requirements. The black magic behind this flexibility is interception scripts--these are standard programming interfaces that enable you to add or change the behavior of Jans endpoints. Just to give one example, perhaps you need to add data from an external API into an OAuth access token? In this case, you could use the Update Token interception script. There are around 20 of these scripts. For a full list, see the Scripts Documentation.</p>","tags":["administration","auth-server","configuration"]},{"location":"janssen-server/auth-server/config/#customization","title":"Customization","text":"<p>You don't want out of the box look and feel provided by Janssen. We know we are UX-challenged, backend developer geeks. Check out the Customization Guide for info about how to add adapt the user facing content to achieve your UX dreams.</p>","tags":["administration","auth-server","configuration"]},{"location":"janssen-server/auth-server/config/#operations","title":"Operations","text":"<p>Janssen Project software has to run somewhere, right now... either on VM's or in containers. There are specifics instructions about each contained in these docs.</p>","tags":["administration","auth-server","configuration"]},{"location":"janssen-server/auth-server/config/#database-and-cache","title":"Database and Cache","text":"<p>One of the biggest challenges in running the Janssen Platform is persistence. Make sure you understand how Janssen Project stores your data, or in some cases, caches it.</p>","tags":["administration","auth-server","configuration"]},{"location":"janssen-server/auth-server/authz-details/","title":"Rich Authorization Requests","text":"","tags":["administration","auth-server","scope","authorization-details"]},{"location":"janssen-server/auth-server/authz-details/#oauth-20-rich-authorization-requests","title":"OAuth 2.0 Rich Authorization Requests","text":"<p>Rich Authorization Requests introduces new <code>authorization_details</code> parameter that is used to carry fine-grained authorization data in OAuth messages.</p> <p>While <code>scope</code> is used for coarse-grained access, <code>authorization_details</code> is used for fine-grained access.</p> <p><code>authorization_details</code> are associated with authorization and thus with client to limit what authorization can be granted within given client.</p> <p><code>authorization_details</code> is JSON array, example:</p> <pre><code>[\n   {\n      \"type\": \"demo_authz_detail\",\n      \"actions\": [\n          \"list_accounts\",\n          \"read_balances\"\n      ],\n      \"locations\": [\n          \"https://example.com/accounts\"\n      ],\n      \"ui_representation\": \"Read balances and list accounts at https://example.com/accounts\"\n   },\n   {\n       \"type\":\"financial-transaction\",\n       \"actions\":[\n           \"withdraw\"\n       ],\n       \"identifier\":\"account-14-32-32-3\",\n       \"currency\":\"USD\"\n   }\n]\n</code></pre>","tags":["administration","auth-server","scope","authorization-details"]},{"location":"janssen-server/auth-server/authz-details/#authorization-details-types","title":"Authorization Details Types","text":"<p><code>type</code> - is required element in single authorization detail and specifies the authorization details type as a string. Type defines how single authorization detail is handled by both AS and RS. Because \"shape\" and structure of single authorization detail can vary a lot, validation and representation logic is externalized to <code>AuthzDetailType</code> custom scripts.</p> <p><code>type</code> defines type of authorization detail. Each such type is represented by AS <code>AuthzDetailType</code> custom scripts. It means that for example above administrator must define two <code>AuthzDetailType</code> custom scripts with names: <code>demo_authz_detail</code> and <code>financial-transaction</code>.</p> <p>If <code>authorization_details</code> parameter is absent in request then <code>AuthzDetailType</code> custom scripts are not invoked.</p> <p><code>demo_authz_detail</code> and <code>financial-transaction</code> <code>AuthzDetailType</code> custom scripts must be provided by administrator.</p> <ul> <li><code>demo_authz_detail</code> is called for all authorization details with <code>\"type\": \"demo_authz_detail\"</code></li> <li><code>financial-transaction</code> is called for all authorization details with <code>\"type\": \"financial-transaction\"</code></li> </ul> <p>Sample Authorization Request <pre><code>POST /jans-auth/restv1/authorize HTTP/1.1\nHost: yuriyz-fond-skink.gluu.info\n\nresponse_type=code&amp;client_id=7a29bf35-96ec-4bbd-a05c-15e1ff9f07cc&amp;scope=openid+profile+address+email+phone+user_name&amp;redirect_uri=https%3A%2F%2Fyuriyz-relaxed-jawfish.gluu.info%2Fjans-auth-rp%2Fhome.htm&amp;state=6cdc7701-178c-4653-adac-5c1e9c6c4aba&amp;nonce=b9a1ecc4-548e-475c-8b29-f019417e1aef&amp;prompt=&amp;ui_locales=&amp;claims_locales=&amp;acr_values=&amp;request_session_id=false&amp;authorization_details=%5B%0A++%7B%0A++++%22type%22%3A+%22demo_authz_detail%22%2C%0A++++%22actions%22%3A+%5B%0A++++++%22list_accounts%22%2C%0A++++++%22read_balances%22%0A++++%5D%2C%0A++++%22locations%22%3A+%5B%0A++++++%22https%3A%2F%2Fexample.com%2Faccounts%22%0A++++%5D%2C%0A++++%22ui_representation%22%3A+%22Read+balances+and+list+accounts+at+https%3A%2F%2Fexample.com%2Faccounts%22%0A++%7D%0A%5D\n</code></pre></p> <p>Request is rejected if request's <code>authorization_details</code> has types which does not have corresponding <code>AuthzDetailType</code> custom script.</p> <p>Check more details about <code>AuthzDetailType</code> custom scripts</p>","tags":["administration","auth-server","scope","authorization-details"]},{"location":"janssen-server/auth-server/authz-details/#as-metadata-discovery","title":"AS Metadata (Discovery)","text":"<p>Metadata endpoint has <code>authorization_details_types_supported</code> which shows supported authorization details types. Value for <code>authorization_details_types_supported</code> is populated based on valid and enabled <code>AuthzDetailType</code> insterception scripts.</p> <p>For <code>demo_authz_detail</code> and <code>financial-transaction</code> <code>AuthzDetailType</code> custom scripts enabled discovery response has:</p> <pre><code>{\n    \"authorization_details_types_supported\" : [ \"demo_authz_detail\", \"financial-transaction\" ],\n    ...\n}\n</code></pre>","tags":["administration","auth-server","scope","authorization-details"]},{"location":"janssen-server/auth-server/authz-details/#client-registration","title":"Client Registration","text":"<p>Client registration request has new parameter <code>authorization_details_types</code> to limit authorization details types supported by client. If request is made with <code>authorization_details</code> that has types that are not listed in client's <code>authorization_details_types</code> the request will be rejected.</p> <p>Sample registration request and response <pre><code>-------------------------------------------------------\nREQUEST:\n-------------------------------------------------------\nPOST /jans-auth/restv1/register HTTP/1.1\nHost: yuriyz-relaxed-jawfish.gluu.info\nContent-Type: application/json\nAccept: application/json\n\n{\n  \"grant_types\" : [ \"authorization_code\", \"implicit\" ],\n  \"subject_type\" : \"public\",\n  \"application_type\" : \"web\",\n  \"authorization_details_types\" : [ \"demo_authz_detail\" ],\n  \"scope\" : \"openid profile address email phone user_name\",\n  \"minimum_acr_priority_list\" : [ ],\n  \"redirect_uris\" : [ \"https://yuriyz-relaxed-jawfish.gluu.info/jans-auth-rp/home.htm\", \"https://client.example.com/cb\", \"https://client.example.com/cb1\", \"https://client.example.com/cb2\" ],\n  \"client_name\" : \"jans test app\",\n  \"additional_audience\" : [ ],\n  \"response_types\" : [ \"code\" ]\n}\n\n-------------------------------------------------------\nRESPONSE:\n-------------------------------------------------------\nHTTP/1.1 201\nCache-Control: no-store\nConnection: Keep-Alive\nContent-Length: 1653\nContent-Type: application/json\nDate: Mon, 18 Dec 2023 17:59:13 GMT\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\nKeep-Alive: timeout=5, max=100\nPragma: no-cache\nSet-Cookie: X-Correlation-Id=7b231c8f-5b2e-445d-b5ea-0f693c1cd7f2; Secure; HttpOnly;HttpOnly\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nX-Content-Type-Options: nosniff\nX-Xss-Protection: 1; mode=block\n\n{\n    \"allow_spontaneous_scopes\": false,\n    \"application_type\": \"web\",\n    \"rpt_as_jwt\": false,\n    \"registration_client_uri\": \"https://yuriyz-relaxed-jawfish.gluu.info/jans-auth/restv1/register?client_id=7a29bf35-96ec-4bbd-a05c-15e1ff9f07cc\",\n    \"tls_client_auth_subject_dn\": \"\",\n    \"run_introspection_script_before_jwt_creation\": false,\n    \"registration_access_token\": \"92a40113-b27c-43b9-bf96-a222fcfe1c9c\",\n    \"client_id\": \"7a29bf35-96ec-4bbd-a05c-15e1ff9f07cc\",\n    \"token_endpoint_auth_method\": \"client_secret_basic\",\n    \"scope\": \"openid\",\n    \"client_secret\": \"1af17da1-57a3-416b-a358-c84bb0ef0fad\",\n    \"client_id_issued_at\": 1702922353,\n    \"backchannel_logout_uri\": \"\",\n    \"backchannel_logout_session_required\": false,\n    \"client_name\": \"jans test app\",\n    \"par_lifetime\": 600,\n    \"spontaneous_scopes\": [],\n    \"id_token_signed_response_alg\": \"RS256\",\n    \"access_token_as_jwt\": false,\n    \"grant_types\": [\n        \"authorization_code\",\n        \"implicit\"\n    ],\n    \"subject_type\": \"public\",\n    \"authorization_details_types\": [\"demo_authz_detail\"],\n    \"additional_token_endpoint_auth_methods\": [],\n    \"keep_client_authorization_after_expiration\": false,\n    \"require_par\": false,\n    \"redirect_uris\": [\n        \"https://client.example.com/cb2\",\n        \"https://client.example.com/cb1\",\n        \"https://yuriyz-relaxed-jawfish.gluu.info/jans-auth-rp/home.htm\",\n        \"https://client.example.com/cb\"\n    ],\n    \"redirect_uris_regex\": \"\",\n    \"additional_audience\": [],\n    \"frontchannel_logout_session_required\": false,\n    \"client_secret_expires_at\": 0,\n    \"access_token_signing_alg\": \"RS256\",\n    \"response_types\": [\"code\"]\n}\n</code></pre></p>","tags":["administration","auth-server","scope","authorization-details"]},{"location":"janssen-server/auth-server/client-management/","title":"Client Management","text":"","tags":["administration","client","management"]},{"location":"janssen-server/auth-server/client-management/#background","title":"Background","text":"<p>A \"client\" is a piece of software either acting autonomously or on behalf of a person. The OAuth framework defines the term client here. OpenId Connect clarifies that: <code>OAuth 2.0 Clients using OpenID Connect are also referred to as Relying Parties (RPs)</code></p> <p>Don't confuse a Client with either the Person or the Browser! </p>","tags":["administration","client","management"]},{"location":"janssen-server/auth-server/client-management/#client-security","title":"Client Security","text":"<p>OpenID allows you to use as much security as you need. To a large extent, the security of your implementation depends on what client features you select. For example, let's just consider how the client authenticates itself to Jans Auth Server, which is defined by the <code>token_endpoint_auth_method</code> in OpenID Connect Client Metadata.</p> <p>Obviously, using asynchronous secrets for authentication is more secure. The client configuration also determines what crypto is used for signing and encryption of tokens, what scopes are available to the client (which determines the extent of access to APIs), what grants are available,  what is a valid redirect_uri, timeouts, whether to use a value or reference token, whether to expire the client, and several other options that impact security.</p>","tags":["administration","client","management"]},{"location":"janssen-server/auth-server/client-management/#client-management-tools","title":"Client Management Tools","text":"<p>A client can be created (and managed) by using one of the following tools offered by the Jans Auth server:</p> <ul> <li>Jans Config API</li> <li>Command Line Tool (CLI)</li> <li>Jans Text UI (TUI)</li> <li>OpenID Connect Dynamic Client Registration</li> </ul> <p>The choice of tool should be made based on your business requirement. - For ad hoc creation, the TUI is great.  - If you need to quickly script client creation (e.g. in a bash script) use the CLI  - Use <code>curl</code> to call the Jans Config API.  - To allow apps to register as OIDC clients, without a manual process, the OpenID Connect Dynamic Client Registration (DCR) can be used.</p>","tags":["administration","client","management"]},{"location":"janssen-server/auth-server/client-management/#a-openid-dynamic-client-registration","title":"A. OpenID Dynamic Client Registration","text":"<p>Jans Auth server publishes the <code>registration_endpoint</code> in the OpenID configuration JSON response, which you can find at <code>.well-known/openid-configuration</code> in your specific deployment. Typically, it is <code>https://{hostname}/jans-auth/restv1/register</code></p> <p>The OpenApi specification for /registration documents Jans Auth Server's specific implementation, which aligns with the requirements of OpenID Connect dynamic client registration. Also, check the Registration Endpoint documentation for more details on the steps involved in dynamic client registration.</p>","tags":["administration","client","management"]},{"location":"janssen-server/auth-server/client-management/#b-jans-cli","title":"B. Jans-CLI","text":"<p>Below is a one liner to add a client.</p> <pre><code>./config-cli-tui.pyz --host $FQDN --client-id $MY_CLIENT_ID \\\n--client-secret $MY_CLIENT_SECRET --no-tui \\\n--operation-id=post-oauth-openid-client  --data=my_client.json\n</code></pre> <p>For more information about how to use the Jans-CLI, see the docs</p>","tags":["administration","client","management"]},{"location":"janssen-server/auth-server/client-management/#c-tui","title":"C. TUI","text":"<p>To start registering a new client, navigate to <code>Auth Server</code>-&gt;<code>Clients</code>-&gt;<code>Add Client</code>.  This brings up a screen as shown below with various sections to input client details.</p> <p></p> <p>Refer to complete documentation here</p>","tags":["administration","client","management"]},{"location":"janssen-server/auth-server/client-management/#d-using-curl-commands","title":"D. Using curl commands","text":"<p>To add a client via <code>curl</code>, see the information on the curl documentation page.</p>","tags":["administration","client","management"]},{"location":"janssen-server/auth-server/client-management/client-authn/","title":"Client Authentication","text":"<p>Janssen Server supports authentication at the token endpoint for confidential clients. Confidential clients have to specify a preferred method of authentication during the client registration process. Client authentication is defined by OAuth and OpenID Connect client authentication section and in Metadata section property <code>token_endpoint_auth_method</code></p>","tags":["administration","client","authentication"]},{"location":"janssen-server/auth-server/client-management/client-authn/#supported-authentication-methods","title":"Supported Authentication Methods","text":"<p>List of supported authentication methods are listed in the response of Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p>The <code>token_endpoint_auth_methods_supported</code> claim in the response specifies the list of all the supported methods.</p>","tags":["administration","client","authentication"]},{"location":"janssen-server/auth-server/client-management/client-authn/#authentication-methods","title":"Authentication Methods","text":"<p>Authentication methods can be broadly categorised in two categories:</p> <ol> <li>Shared key based</li> <li>Private( or asymmetric) key based</li> </ol> <p>While shared key based authentication is simpler to implement, it is less secure than a private key based authentication. This is primarily because when using shared key based authentication, the client secret is transmitted between the client and the authorization server. This makes the authentication vulnerable to theft attacks. There are more reasons to prefer private key over shared secret as listed in this section</p> <p>Characteristics table below shows side-by-side comparison of various supported authentication methods.</p> Method Secret Not Sent in Clear Signed Only client has secret Expiry Token Binding <code>client_secret_basic</code> <code>client_secret_post</code> <code>client_secret_jwt</code> <code>private_key_jwt</code> <code>tls_client_auth</code> <code>self_signed_tls_client_auth</code>","tags":["administration","client","authentication"]},{"location":"janssen-server/auth-server/client-management/client-authn/#client_secret_basic","title":"client_secret_basic","text":"<p>Default authentication method for Janssen Server. It authenticates clients using method described in client authentication section of OAuth framework.</p>","tags":["administration","client","authentication"]},{"location":"janssen-server/auth-server/client-management/client-authn/#client_secret_post","title":"client_secret_post","text":"<p><code>client_secret_post</code> method authenticates clients using method described in client authentication section of OAuth framework by adding client credentials in request body.</p>","tags":["administration","client","authentication"]},{"location":"janssen-server/auth-server/client-management/client-authn/#client_secret_jwt","title":"client_secret_jwt","text":"<p>Like <code>client_secret_basic</code> and <code>client_secret_post</code> methods, this method is also based on a shared secret that client receives from Janssen Server. But instead of sending secret back to authorization server everytime, the client creates a JWT using an HMAC SHA algorithm where the shared secret is used as the key. This method is more secure than the <code>client_secret_basic</code> and <code>client_secret_post</code>  due to following reasons:</p> <ul> <li>Secret which is shared once will never be transmitted again</li> <li>JWT can have expiration time, beyond which the same JWT can not be used. This reduces the time window for replay of  the same token in case it is compromised.</li> </ul> <p>This method is further described in OpenId Connect specification, section 9.</p>","tags":["administration","client","authentication"]},{"location":"janssen-server/auth-server/client-management/client-authn/#client-configuration-for-using-client_secret_jwt","title":"Client Configuration For Using client_secret_jwt","text":"<p>Janssen Server clients should specify the preferred algorithm for use with this method during client configuration.</p> <p>Algorithms supported by Janssen Server are listed in the response of Janssen Server's well-known configuration endpoint. From the response, the claim <code>token_endpoint_auth_signing_alg_values_supported</code> lists the supported algorithms.</p> <p>To specify preferred algorithm for a client, using Janssen Text-based UI(TUI), navigate via <code>Auth Server</code> -&gt; Get or add clients -&gt; <code>encryption/signing</code> -&gt; TODO: which exact properties.</p>","tags":["administration","client","authentication"]},{"location":"janssen-server/auth-server/client-management/client-authn/#private_key_jwt","title":"private_key_jwt","text":"<p><code>private_key_jwt</code> is private-key-based method where secret is not shared between client and authorization server. Instead, the client generates an JSON Web Token(JWT) which is shared with the Janssen Server. Upon receiving JWT singned by client's private key, the Janssen Server can validate this JWT using public keys supplied by client at the time of registration.</p> <p>The client can supply public keys in form of JSON Web Key Set(JWKS) or provide a URI where the client publishes its JWKS. Providing JWKS URI is preferred method as it enable easy key rotations without client having to update JWKS manually. Check <code>jwks</code> and <code>jwks_uri</code> elements in OIDC client metadata section for more details.</p> <p>This authentication method is further described in OpenId Connect specification, section 9.</p> <p>Janssen server implements signing and encryption mechanism following the guidelines in section 10 of OpenId Connect specification. Clients should choose the algorithm to sign and encrypt JWT as per their security requirements.</p>","tags":["administration","client","authentication"]},{"location":"janssen-server/auth-server/client-management/client-authn/#security-features-of-private-key-authentication","title":"Security Features Of Private Key Authentication","text":"<p>This method of authentication is more secure than the methods relying on shared key due to following features.</p> <ul> <li>Secure Storage: Hardware Security Module(HSM) or Trusted Platform Module(TPM) can be used to securely store private key    and sign using it at client side. These modules make it impossible to access private key from outside.</li> <li>Smaller footprint: Unlike shared secret, where client secret resides on authorization server as well as client,    the private key only exists on client. This reduced footprint reduces potential risks.</li> <li>Limited Time Validity: JWT can be set to expire after a certain duration. Similarly, client certificates can be    made to expire. This makes it harder to execute replay attacks using a compromised token or certificate.</li> </ul>","tags":["administration","client","authentication"]},{"location":"janssen-server/auth-server/client-management/client-authn/#implementation-steps","title":"Implementation Steps","text":"<p>Below are the high-level steps involved in using <code>private_key_jwt</code> authentication method:</p> <ul> <li>Create JWK private key</li> <li>Derive JWK public key for the private key. Public key JWK should be provided to Janssen Server at the time of registration</li> <li>Create JWT header and payload as described in section 9 of specification</li> <li>Sign JWT with a signing algorithm</li> </ul> <p>Client code that implements above steps should leverage any of the secure and trusted library that implements these functions. A non-exhaustive list of such libraries can be found at jwt.io. Psudocode implementation for Java based client using <code>nimbus-jose-jwt</code> library can be found here</p>","tags":["administration","client","authentication"]},{"location":"janssen-server/auth-server/client-management/client-authn/#client-configuration-for-using-private_key_jwt","title":"Client Configuration For Using private_key_jwt","text":"<p>Janssen Server clients can specify signing and encryption keys using client configuration. Clients can either specify JWKS as value or as reference URI.</p> <p>To specify JWKS values or reference URI, using Janssen Text-based UI(TUI), navigate via <code>Auth Server</code> -&gt; Get or add clients -&gt; <code>encryption/signing</code> -&gt; set value for <code>Client JWKS URI</code> or <code>Client JWKS</code>.</p>","tags":["administration","client","authentication"]},{"location":"janssen-server/auth-server/client-management/client-authn/#tls_client_auth","title":"tls_client_auth","text":"<p>During TLS handshake, the client authenticates with Janssen Server using X.509 certificate that is issued by a Certificate Authority(CA). This is mutual TLS based authentication method. Benefit of using mutual TLS based authentication is that the authorization server binds the token with the certificate. This provides enhanced security where it is possible to check that the token belongs to the intended client.</p> <p>This authentication mechanism is defined in mTLS specification for OAuth2</p>","tags":["administration","client","authentication"]},{"location":"janssen-server/auth-server/client-management/client-authn/#self_signed_tls_client_auth","title":"self_signed_tls_client_auth","text":"<p>Client authenticates with Janssen Server using self signed X.509 certificate during TLS handshake. Use of self-signed certificate removes the dependency of public key infrastructure(PKIX). This is mutual TLS based authentication method. Benefit of using mutual TLS based authentication is that the authorization server binds the token with the certificate. This provides enhanced security where it is possible to check that the token belongs to the intended client.</p> <p>This authentication mechanism is defined in mTLS specification for OAuth2</p>","tags":["administration","client","authentication"]},{"location":"janssen-server/auth-server/client-management/client-authn/#none","title":"none","text":"<p>The Client does not authenticate itself at the Token Endpoint, either because it uses only the Implicit Flow (and so does not use the Token Endpoint) or because it is a Public Client with no Client Secret or other authentication mechanism.</p>","tags":["administration","client","authentication"]},{"location":"janssen-server/auth-server/client-management/client-authn/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","client","authentication"]},{"location":"janssen-server/auth-server/client-management/client-configuration/","title":"Client Configuration","text":"<p>This document covers some important configuration elements of client configuration. How these elements are configured for a client has an impact on aspects like client security.</p>","tags":["administration","client","configuration"]},{"location":"janssen-server/auth-server/client-management/client-configuration/#redirect-uri","title":"Redirect URI","text":"<p>Redirect URI is the most basic and at times the only parameter needed for registering a client. It is defined in OAuth framework and OpenId Connect specification.</p> <p>The client can register a list of URIs as a value for redirect URI parameter. Redirect URI can be any valid URI.</p> <ul> <li>Redirect URI should be an absolute URI. For instance, URI should not have wildcard characters. As recommended   here</li> <li>Redirect Regex: Janssen Server enables clients to allow redirect URIs that conform to a regular expression(regex)   pattern. While validating redirect URIs received in an incoming request, the Janssen Server first looks at the list   of statically registered URI as part of <code>Redirect URIs</code> and then checks if any of the redirect URI from the request   matches with the regex provided by the client. Great care should be exercised when using regex to ensure that it   accurately matches with the intended patterns only. This feature can be turned on or off via   feature flag</li> <li>When using client type as <code>web</code>, the redirect URI generally takes the form of <code>&lt;schema&gt;://&lt;host-name&gt;:&lt;port&gt;/&lt;path&gt;</code>.   It must use <code>https</code> schema. The exception to schema rule is made when <code>localhost</code> or loopback ip <code>127.0.0.1</code> is used as the hostname. </li> <li>Prefer to use the loopback IP instead of <code>localhost</code> as hostname to facilitate local testing as   recommended in OAuth 2.0 native app specification section 8.3</li> <li>Janssen Server supports all methods of redirection used by   native apps. Use of Private-Use URI (or custom URL) is   supported by allowing redirect URI to take the form of reverse DNS name, for example, <code>com.example.app</code>. URLs for   loopback interface redirection are also supported.</li> <li>When the client registers multiple redirect URIs (Janssen Server accepts a list of URIs separated by space), be aware   that Janssen Server will use these, one by one for validation purposes and the validation stops at the first match.</li> <li>If there are multiple registered redirect_uris, and the client is using <code>pairwise</code> subject   identifiers, the Client MUST also register a sector_identifier_uri. This is required to keep the pairwise subject   identifiers consistent across various domains under the same administrative control. Refer to pairwise algorithm   section of OpenId Connect specification for more   details.</li> </ul>","tags":["administration","client","configuration"]},{"location":"janssen-server/auth-server/client-management/client-configuration/#cryptography","title":"Cryptography","text":"<p>Janssen Server allows clients to configure static set of keys using <code>JWKS</code> or specify a URI as <code>JWKS URI</code> where client is exposing its key set. For client who can host keys and expose a URI, it is recommended to use <code>JWKS URI</code> instead of static <code>JWKS</code> key set. Using <code>JWKS URI</code> enables client to rotate its cryptographic keys without having to change the client configuration on Janssen Server.</p>","tags":["administration","client","configuration"]},{"location":"janssen-server/auth-server/client-management/client-configuration/#available-algorithms-for-encryption-and-signing","title":"Available Algorithms for Encryption and Signing","text":"<p>The client can select algorithms for cryptographic and encryption during client configuration. Janssen Server supports a list of algorithms as listed in response of Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p>Claims that list supported algorithms:</p> <ul> <li>id_token_encryption_alg_values_supported</li> <li>id_token_signing_alg_values_supported</li> <li>userinfo_encryption_enc_values_supported</li> <li>userinfo_signing_alg_values_supported</li> <li>userinfo_encryption_alg_values_supported</li> <li>access_token_signing_alg_values_supported</li> <li>request_object_signing_alg_values_supported</li> <li>request_object_encryption_alg_values_supported</li> <li>request_object_encryption_alg_values_supported</li> </ul>","tags":["administration","client","configuration"]},{"location":"janssen-server/auth-server/client-management/client-configuration/#recommendations","title":"Recommendations","text":"<ul> <li>RSA keys with a minimum 2048 bits if using RSA cryptography</li> <li>Elliptic Curve keys with a minimum of 160 bits if using Elliptic Curve cryptography</li> <li>Client secret should have a minimum of 128 bits if using symmetric key cryptography</li> <li>Sign with PS256 (RSASSA-PSS using SHA-256 and MGF1 with SHA-256) or ES256 (ECDSA using P-256 and SHA-256)</li> </ul>","tags":["administration","client","configuration"]},{"location":"janssen-server/auth-server/client-management/client-configuration/#grants","title":"Grants","text":"","tags":["administration","client","configuration"]},{"location":"janssen-server/auth-server/client-management/client-configuration/#supported-grant-types","title":"Supported Grant Types","text":"<p>Grant defines how a client interacts with the token endpoint to get the tokens. Janssen Server supports grant types defined by OAuth 2.0, OAuth 2.1, and extension grants defined by other RFCs. A complete list of supported grant types can be found in the response of the Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p>Claim <code>grant_types_supported</code> lists all the supported grant types in the response.</p>","tags":["administration","client","configuration"]},{"location":"janssen-server/auth-server/client-management/client-configuration/#configuring-grant-type-for-client","title":"Configuring Grant Type For Client","text":"<p>Janssen Server will allow requests from a client with grant types that the client is configured to use. Client can be configured to use or not use certain grant types using CLI or TUI tools.</p>","tags":["administration","client","configuration"]},{"location":"janssen-server/auth-server/client-management/client-configuration/#recommendations-for-using-grant-types-and-flows","title":"Recommendations For Using Grant Types and Flows","text":"<p>Developers should use the grant types based on the ability of the client to protect the client credentials as well as the security profile of the deployment. If the client software is a server-side component that can securely store the client credentials, such a client is called a <code>confidential</code> client. As opposed to that, if the application requesting access token is entirely running on a browser, where it is not possible to store client credentials securely, such a client is called a <code>public</code> client.</p> <p>Along with the grant type to be used, developers also need to choose which flow should be used to get the required tokens. The table below shows grant types and flows that should be used for various use-cases.</p> Client Type Recommended Grant Type Flow Backend App (Example: batch processes) that need to access its own resources <code>client_credentials</code> Client Credentials Server backend of a web-application needs access token <code>authorization_code</code> Authorization Code Web-application that needs user information via id_token on browser and access token on backend <code>authorization_code</code> Hybrid Flow Browser based single page applications or Mobile applications <code>authorization_code</code> Authorization Code with PKCE Browser based single page applications or Mobile applications that only intend to get id_token - Implicit Flow with Form Post Input constrained devices (Example: TV) <code>urn:ietf:params:oauth:grant-type:device_code</code> Device Flow Highly trusted applications where redirect based flows are not feasible to implement <code>password</code> Resource Owner Password Flow <p>Note</p> <p>Certain grant types should not be used together. For example, implicit flow with hybrid flow. Or using authorization code flow with hybrid flow. This allows a downgrade attack from more secure flow to less secure flow.</p>","tags":["administration","client","configuration"]},{"location":"janssen-server/auth-server/client-management/client-configuration/#pre-authorization","title":"Pre-authorization","text":"<p>If the OAuth authorization prompt should not be displayed to end users, set this field to True. This is useful for SSO to internal clients (not a third party) where there is no need to prompt the person to approve the release of information.</p>","tags":["administration","client","configuration"]},{"location":"janssen-server/auth-server/client-management/client-configuration/#response-types","title":"Response Types","text":"<p>Client sends <code>response_type</code> request parameter when sending request to authorization endpoint. Using this parameter, the client informs the authorization server of the desired grant. Response type parameter is defined in the OAuth 2.0 framework.</p> <p>Janssen Server supports response types defined by OAuth 2.0, OAuth 2.1.The complete list of supported response types can be found in the response of the Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p>Claim <code>response_types_supported</code> lists all the supported grant types in the response.</p> <p>When registering client using dynamic client registration, if the <code>response_type</code> parameter is not specified, it'll default to <code>code</code>.</p>","tags":["administration","client","configuration"]},{"location":"janssen-server/auth-server/client-management/client-configuration/#response-type-recommendations","title":"Response Type Recommendations","text":"<ul> <li>Avoid using response type <code>token</code>. This response type is  deprecated by OAuth 2.1. </li> <li>Grant types allowed for a client determines which response types are permitted in authorization requests.  Make sure appropriate grant types are configured in Janssen Server client configuration. Janssen Server will reject  authorization requests containing response types not permitted for respective client.</li> </ul>","tags":["administration","client","configuration"]},{"location":"janssen-server/auth-server/client-management/client-configuration/#client-expiration","title":"Client expiration","text":"<p>Client expiration is set based on <code>dynamicRegistrationExpirationTime</code> AS configuration property or otherwise if <code>dcrForbidExpirationTimeInRequest</code> is <code>false</code> then it is set with Dynamic Client Registration Request via <code>lifetime</code> parameter which expected value in seconds.</p> <p>Client activity time is tracked/recorded each time client is used for authentication or authorization (date is written in <code>jansLastAccessTime</code> client attribute).</p> <p>Contribute</p> <p>If you\u2019d like to contribute to this document, get started with the Contribution Guide</p>","tags":["administration","client","configuration"]},{"location":"janssen-server/auth-server/client-management/client-schema/","title":"Client Schema","text":"","tags":["administration","client","schema"]},{"location":"janssen-server/auth-server/client-management/client-schema/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","client","schema"]},{"location":"janssen-server/auth-server/client-management/client-schema/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","client","schema"]},{"location":"janssen-server/auth-server/client-management/client-schema/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>","tags":["administration","client","schema"]},{"location":"janssen-server/auth-server/client-management/client-scripts/","title":"Client Scripts","text":"","tags":["administration","client","scripts"]},{"location":"janssen-server/auth-server/client-management/client-scripts/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","client","scripts"]},{"location":"janssen-server/auth-server/client-management/client-scripts/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","client","scripts"]},{"location":"janssen-server/auth-server/client-management/client-scripts/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>","tags":["administration","client","scripts"]},{"location":"janssen-server/auth-server/client-management/sector-identifiers/","title":"Sector Identifier","text":"<p>Janssen Server supports sector identifier URI and pairwise subject IDs for OpenId Connect relying party. As defined in OpenId Connect core specification, the sector identifiers value is used to derive pairwise subject IDs. Janssen Server also supports <code>Sector Identifier URI</code> as part of client configuration. <code>Sector Identifier URI</code> when used with <code>pairwise</code> subject type, enables a group of websites under the same administrative control to receive the same subject identifiers. <code>Sector Identifier URI</code> also allows clients to change the host component of the redirect URI and still keep the subject identifiers unchanged.</p>","tags":["administration","client","sector-identifier"]},{"location":"janssen-server/auth-server/client-management/sector-identifiers/#configuring-sector-identifier","title":"Configuring Sector Identifier","text":"<p>Janssen Server runs below mentioned checks on value configured for <code>Sector Identifier URI</code>:</p> <ul> <li>URI should have a <code>https</code> schema</li> <li>URI should be accessible to Janssen Server and the response should be a valid JSON array of redirect URIs</li> <li>All redirect URI received in response must exist in the list of the redirect URI provided by the client at the registration time</li> </ul> <p>Note</p> <p>If the client can not host an endpoint that will be reachable by <code>Sector Identifier URI</code>, then in order to use the <code>pairwise</code> subject IDs, the client must supply a <code>Redirect URI</code> list where URIs have the same host component. The host component value will be used as the sector identifier.</p>","tags":["administration","client","sector-identifier"]},{"location":"janssen-server/auth-server/client-management/sector-identifiers/#configuration-with-pairwise-subject-type","title":"Configuration With Pairwise Subject Type","text":"<p>How sector identifier value is used to derive value for the pairwise subject identifier is detailed in the OIDC core specification.</p> <p>Janssen Server allows clients/RPs to set subject type. The <code>public</code> subject type is the default and the client/RP can choose to use the <code>pairwise</code> type. When using TUI, this can be configured from the client configuration screen below:</p> <p></p> <p>When the <code>pairwise</code> subject type is selected, the value for <code>Sector Identifier URI</code> can be left blank if all redirect URIs have the same host component. If the list of redirect URIs contains multiple host names, providing a <code>Sector Identifier URI</code> is a must. When <code>Sector Identifier URI</code> is provided, the host component of the URI is used as a sector identifier.</p>","tags":["administration","client","sector-identifier"]},{"location":"janssen-server/auth-server/client-management/sector-identifiers/#configuration-properties","title":"Configuration Properties","text":"<p>Janssen Server allows customization concerning sector identifiers using the properties below:</p> <ul> <li>sectorIdentifierCacheLifetimeInMinutes</li> <li>shareSubjectIdBetweenClientsWithSameSectorId</li> </ul>","tags":["administration","client","sector-identifier"]},{"location":"janssen-server/auth-server/client-management/sector-identifiers/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","client","sector-identifier"]},{"location":"janssen-server/auth-server/client-management/software-statements/","title":"Software Statements","text":"<p>Software Statement is defined by OAuth dynamic client registration RFC 7591 as</p> <pre><code>A digitally signed or MACed JSON Web Token (JWT) \nthat asserts metadata values about the client software.\n</code></pre> <p>Janssen Server supports usage of software statements during dynamic client registration.</p>","tags":["administration","client","software statements"]},{"location":"janssen-server/auth-server/client-management/software-statements/#use-during-dynamic-client-registration","title":"Use During Dynamic Client Registration","text":"<p>Janssen Server supports dynamic client registration using software statements. It can be used as software statements or as software statement assertions (SSA) to register client dynamically.</p> <p>Janssen Server also provides SSA endpoint to create and manage SSAs on the server.</p> <p>Please see SSA Creation with TUI at Create SSA with TUI</p>","tags":["administration","client","software statements"]},{"location":"janssen-server/auth-server/client-management/software-statements/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","client","software statements"]},{"location":"janssen-server/auth-server/crypto/","title":"Crypto","text":"","tags":["administration","auth-server","cryptography"]},{"location":"janssen-server/auth-server/crypto/#overview","title":"Overview","text":"<p>Please use the left navigation menu to browse the content of this section while we are still working on developing content for <code>Overview</code> page.</p> <p>Contribute</p> <p>If you'd like to contribute content to this page, get started with the Contribution Guide</p>","tags":["administration","auth-server","cryptography"]},{"location":"janssen-server/auth-server/crypto/key-generation/","title":"Key Generation","text":"","tags":["administration","auth-server","cryptography","key generation"]},{"location":"janssen-server/auth-server/crypto/key-generation/#generating-cryptographic-keys","title":"Generating Cryptographic Keys","text":"<p>The Jans Server is compatible with the Java KeyGenerator to create new cryptographic keys if needed.</p>","tags":["administration","auth-server","cryptography","key generation"]},{"location":"janssen-server/auth-server/crypto/key-generation/#backup","title":"Backup","text":"<ul> <li>Backup <code>jansConfWebKeys</code> attribute data of <code>jansAppConf</code> entity from persistence. Location of this attribute is: <code>o=jans &gt; ou=configuration &gt; ou=jans-auth</code></li> <li>Backup <code>jans-auth-keys.p12</code> from <code>/etc/certs/</code></li> </ul> <p>[N.B] Below if <code>Keystore</code> location is anywhere except <code>/etc/certs/</code> no need to backup.</p>","tags":["administration","auth-server","cryptography","key generation"]},{"location":"janssen-server/auth-server/crypto/key-generation/#key-generate","title":"Key Generate","text":"<p>To get KeyGenerator, run the following command inside the terminal.</p> <p>You can put expiration according to your own policy. For testing purpose we are keeping it 2 days.</p> <pre><code>/opt/jre/bin/java -Dlog4j.defaultInitOverride=true -cp /opt/dist/jans/jans-auth-client-jar-with-dependencies.jar io.jans.as.client.util.KeyGenerator -keystore /etc/certs/jans-auth-keys.p12 -keypasswd &lt;Password&gt; -sig_keys RS256 RS384 -enc_keys RSA1_5 RSA-OAEP -key_ops_type ALL -dnname \"CN=jansAuth CA Certificates\" -expiration 2 &gt; /etc/certs/jans-auth-keys.json\n</code></pre> <p>Note</p> <p><code>-key_ops_type ALL</code> parameter which sets purpose of the keys generated by key generator.</p> <p>Possible values are:</p> <ul> <li>\"connect\" - connect keys (that is what we already have)</li> <li>\"ssa\" - ssa keys which has expiration set to 50 years (it ignores \"expiration\" parameters)</li> <li>\"all\" - generate both \"connect\" and \"ssa\" keys. Usually should be done during initial setup.</li> </ul> <p>Lets see our newly generated crypto keys</p> <pre><code>keytool -list -v -keystore /etc/certs/jans-auth-keys.p12 -storetype pkcs12 -storepass &lt;password&gt;\n</code></pre> <p>The jans implementation of KeyGenerator accepts the following arguments:</p> Argument Description -dnname DN of certificate issuer -key_length Length of hash key -enc_keys Encryption keys to generate (For example: RSA_OAEP, RSA1_5) -expiration Expiration in days -expiration_hours Expiration in hours -h Show help -key_ops_type Purpose of the key, possible values: connect, ssa, all -keypasswd Key Store password -keystore Key Store file (such as /etc/certs/jans-auth-keys.p12) -sig_keys Signature keys to generate. (For example: RS256 RS384 RS512 ES256 ES384 ES512 PS256 PS384 PS512) _keyId Key name suffix -test_prop_file Test property file used for test purpose only","tags":["administration","auth-server","cryptography","key generation"]},{"location":"janssen-server/auth-server/crypto/key-storage/","title":"Janssen Key Storage","text":"<p>A Java KeyStore is a file that contains set of aliases. Every alias can contain private key and public key and certificate (additional property info about owner of they key) or only public key and certificate.</p> <p>KeyStore stores the following type of data:   - Private Keys;   - Public Keys and Certificates;   - Secret Keys.</p> <p>KeyStore are used by follow crypto primitives:   - asymetric encryption;   - digital signature;   - symmetric-key algorithm.</p> <p>Janssen KeyStore files contain:   - Private Keys;   - Public Keys and Certificates.</p>","tags":["administration","auth-server","cryptography","key-storage"]},{"location":"janssen-server/auth-server/crypto/key-storage/#supported-formats-of-key-storages","title":"Supported Formats of Key Storages","text":"<p>There is some set of standardized KeyStore formats. Janssen applications use follow KeyStore formats:   - JKS: Java KeyStore format (proprietary keystore implementation provided by the SUN provider). KeyStore file extensions: .jks, .keystore, .ks;   - PKCS#12: Personal Information Exchange Syntax, developed by RSA Security. PKCS #12 defines an archive file format for storing many cryptography objects as a single file. KeyStore file extensions: .pkcs12, .p12, .pfx;   - BCFKS: Bouncy Castle FIPS Key Store (BCFKS) format supports storage of certificates and private keys using AES-CCM and PBKDF2 algorithms, providing greater security than the standard JKS and PKCS12 implementations. Support for BCFKS format is implemented, using BCFIPS Crypto Provider (https://www.bouncycastle.org/fips_java_roadmap.html). KeyStore file extensions: .bcfks, bcf, bcfips. </p>","tags":["administration","auth-server","cryptography","key-storage"]},{"location":"janssen-server/auth-server/crypto/key-storage/#installed-keystore-files","title":"Installed KeyStore files","text":"<p>Janssen installs KeyStore files in the directory: /etc/certs.</p> <p>Follow Keystore files are used by Janssen:</p> <ul> <li>jans-auth-keys.pkcs12</li> <li>smtp-keys.pkcs12 .</li> </ul>","tags":["administration","auth-server","cryptography","key-storage"]},{"location":"janssen-server/auth-server/crypto/key-storage/#jans-auth-keyspkcs12","title":"jans-auth-keys.pkcs12","text":"<p>Here is the example of the file: /etc/certs/jans-auth-keys.pkcs12 (list of entries/aliases).</p> <pre><code>keytool -list -v -storetype PKCS12 -keystore /etc/certs/jans-auth-keys.pkcs12 -storepass gNzpzYj5h8i1\n</code></pre> <pre><code>Keystore type: PKCS12\nKeystore provider: SUN\n\nYour keystore contains 31 entries\n\nAlias name: connect_3c83ba3a-7a62-49e7-8478-b6d3e242e549_sig_es256\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: a81e8386d6774110b12a292a7185c454359b9b6d67a3f5aef587e9395db04166\nValid from: Thu Aug 17 05:21:05 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: 4F:FD:3A:E6:61:D8:8E:0F:61:A4:AA:DE:D7:E4:F4:28:5E:EE:39:20\n         SHA256: 52:15:67:CE:0B:56:1C:CD:CE:C9:39:4C:11:25:B8:73:13:7F:7F:91:BB:E4:1A:3F:48:8D:B0:DC:01:D0:55:3D\nSignature algorithm name: SHA256withECDSA\nSubject Public Key Algorithm: 256-bit EC (secp256r1) key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_45c2ce16-6d5b-47d4-be40-c4da48ba49d3_enc_ecdh-es+a128kw\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: c6fdff1d75c83e32519a94133f9954de22a2aea4fb20ef669bce2221c08cf21f\nValid from: Thu Aug 17 05:21:17 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: 02:35:E7:FC:50:47:4A:3A:EA:54:EE:92:CA:75:14:D0:A4:E0:0C:45\n         SHA256: 19:18:8F:68:68:A2:FE:E2:03:BC:E6:2E:87:24:D4:E9:B0:64:D8:44:7D:32:A1:DE:1C:1B:8E:9A:96:3F:32:5A\nSignature algorithm name: SHA256withECDSA\nSubject Public Key Algorithm: 256-bit EC (secp256r1) key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_5365f93a-368d-4643-8708-1f4b31b62d47_enc_rsa-oaep\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 4d561c04da6bbe50ea15720e6c6898d35793e711eabc9eaa02ad7ed9dafa148b\nValid from: Thu Aug 17 05:21:14 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: C7:B4:1A:9A:15:59:E6:45:AC:77:C7:1C:E4:7D:F2:01:EC:4B:59:AD\n         SHA256: 75:11:06:F5:74:D7:B4:C4:0A:57:A5:88:AA:91:F9:57:4C:78:BE:D2:68:1F:0E:AF:0B:CA:16:2F:0F:FE:17:EA\nSignature algorithm name: SHA256withRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_5b5da374-2ccb-40ca-8544-9338fe7427ff_sig_rs384\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 235fc012863b7291c3370978761a2df6a14796cc601b0fec801b84aa7281b116\nValid from: Thu Aug 17 05:21:03 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: 17:33:24:FC:C8:F7:0C:10:7B:0A:30:5B:28:6E:30:AC:13:A5:FD:36\n         SHA256: E5:05:5A:7E:00:93:2E:8B:3E:AE:91:D5:B5:B5:1A:A9:51:37:FE:72:29:02:83:20:F7:6F:BC:BE:D9:FF:23:7E\nSignature algorithm name: SHA384withRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_6218efa5-197e-49f5-919f-769e6d0aaaec_sig_es512\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 304513446352446c48e39017e3044545e0e2a4a71c36899eacfac775606e958d\nValid from: Thu Aug 17 05:21:08 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: BE:27:21:18:F4:D4:F6:71:D9:4A:DF:A0:3F:F2:20:76:E1:3E:DD:05\n         SHA256: 39:FB:09:EC:BD:62:CF:B2:8B:6A:7F:D9:AF:34:64:7C:50:53:E9:E1:14:01:FE:35:B3:B6:03:8D:C6:E3:A3:68\nSignature algorithm name: SHA512withECDSA\nSubject Public Key Algorithm: 521-bit EC (secp521r1) key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_6dbf485d-9d78-49d0-b977-72608ca6b727_sig_rs512\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 6310f2b2c5fe5e9354d6352140bedf9efe986ed1c44e68d6dda2ccb46038a14c\nValid from: Thu Aug 17 05:21:04 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: E1:78:BA:84:C1:9A:9F:6D:FF:32:1B:F4:D9:4E:AE:AE:23:A9:7F:52\n         SHA256: EF:C9:B8:40:82:E1:16:B2:7B:2C:E9:E4:47:17:5D:C2:AB:D7:AA:16:EE:11:95:19:F7:52:7C:20:E9:3C:82:91\nSignature algorithm name: SHA512withRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_7325add6-aaa6-4e4c-bfee-968fa7eba793_sig_ps384\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: ea8c7dfe1d28f4ff9f686f0eccd5b3d06c50d80b4751713cce0052997027c90f\nValid from: Thu Aug 17 05:21:10 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: 2D:71:05:C2:5C:5A:50:CD:C7:64:42:69:03:8B:BC:66:6F:F7:E3:2A\n         SHA256: C8:DD:E9:2E:49:91:04:25:29:48:6F:CA:01:0B:6F:17:CA:29:01:C5:4D:2B:AF:3F:A3:25:03:16:12:34:5C:48\nSignature algorithm name: RSASSA-PSS\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_829abf33-03f1-4f35-a42e-bca49f992df4_enc_ecdh-es+a256kw\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 24c62ce19733ddce99573c073bfa890e29d48fbc4a1b4365748fdc0c420b793a\nValid from: Thu Aug 17 05:21:18 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: 66:FC:23:8E:08:80:2A:C8:74:08:A5:37:C2:6D:8F:68:AB:23:7E:D3\n         SHA256: 27:7B:A3:5D:E2:F3:6D:15:52:F8:D0:03:0A:7D:D5:B5:32:B9:4E:93:F1:C3:14:98:CA:98:E9:53:84:45:24:4C\nSignature algorithm name: SHA256withECDSA\nSubject Public Key Algorithm: 256-bit EC (secp256r1) key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_87933d28-0523-4bd2-a078-a94e32887b04_sig_es256k\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 276ab34dca0e41236756ae0863ebd5e16ea0b209645128f54da0c0dc1c12b64c\nValid from: Thu Aug 17 05:21:06 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: 53:23:C9:45:4D:D2:29:70:BA:EB:27:EB:83:66:AB:4C:B9:56:9E:83\n         SHA256: 42:38:33:97:94:ED:58:51:D4:F1:C8:E5:2E:AB:56:05:B0:1D:79:05:33:51:DA:0F:41:E9:E8:59:11:B8:0F:57\nSignature algorithm name: SHA256withECDSA\nSubject Public Key Algorithm: 256-bit EC (secp256k1) key (disabled)\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_8d71b86c-5b81-444c-afdf-bb3da4de11e4_sig_rs256\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: d8344594dfcce15695d56f30178bc2a38bf3d432756bfd15a69242b3348876dd\nValid from: Thu Aug 17 05:21:02 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: 5D:75:82:47:5F:80:F9:2F:41:48:CF:01:9F:EE:66:0E:71:37:FA:83\n         SHA256: D1:92:1C:B1:D0:29:B8:23:73:FA:2E:89:11:2D:F1:8F:5E:2E:FE:B0:80:D1:CC:60:1B:B3:46:82:BA:04:9E:4B\nSignature algorithm name: SHA256withRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_9574dff8-1f98-421d-91bf-a760a18be2d2_sig_ps512\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: a92efd444e5ea4ac9cd573aa66746b3b90adf465d20ad1abb25d903619f30d6c\nValid from: Thu Aug 17 05:21:11 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: 29:CF:94:A6:DF:1E:85:59:A4:C1:62:1F:95:AB:67:31:1B:2D:07:6C\n         SHA256: E5:72:DE:3F:C5:96:63:21:AB:82:B4:64:00:E6:19:9B:2C:B0:6D:7C:C6:8C:3D:5B:21:58:6A:3D:D1:CC:54:0D\nSignature algorithm name: RSASSA-PSS\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_9f70c848-95b6-48fe-a9e9-79b374848e28_enc_rsa1_5\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 46d231ec4e06d52ce1d5a4950f2f91ffc5dd107f5ac7a422225d55fb0004ae26\nValid from: Thu Aug 17 05:21:13 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: A5:82:D0:70:8D:19:A5:5D:DE:4D:CC:52:AE:FB:F4:FF:EF:1A:56:AE\n         SHA256: BB:FA:F0:82:DC:71:84:90:74:C1:33:D9:BC:AE:35:EA:DD:6B:35:95:CE:45:DB:94:E9:9B:E9:39:A4:47:CD:B2\nSignature algorithm name: SHA256withRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_a28e886e-090b-42c3-b437-92c91106c0c1_enc_ecdh-es\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 4f03840af117cdff5a44ae7f12050ead8934d460134a35088ba5cb3782046b9e\nValid from: Thu Aug 17 05:21:16 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: 24:00:50:A1:B6:FD:F3:EC:19:95:CE:0F:BA:4E:AE:C5:64:57:F7:0C\n         SHA256: BC:02:64:A2:1E:B6:B3:BD:BE:15:8E:E6:8B:CA:1E:00:A0:13:D9:40:72:7E:93:0F:40:DB:58:B5:56:1B:08:54\nSignature algorithm name: SHA256withECDSA\nSubject Public Key Algorithm: 256-bit EC (secp256r1) key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_b7920896-d087-4668-9ee5-66fd3cf56694_enc_rsa-oaep-256\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 16d9f709786c58f4343b2fce290cafa4130cb706cae25bcc98970742879d6f1d\nValid from: Thu Aug 17 05:21:15 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: 28:B3:2B:59:0B:BF:DB:F1:05:63:27:C3:9B:CD:35:14:54:A9:A3:16\n         SHA256: D9:55:37:5E:2E:AE:48:3E:72:DF:39:E2:0B:D8:79:4F:A3:21:33:EF:DA:DF:24:22:8B:42:08:61:E5:7F:F8:9F\nSignature algorithm name: SHA256withRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_c50ce977-00c0-4f4a-8594-1a0bc3935f88_sig_ps256\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: c1992dccc3c0635dea6f34ac0f03414cc5f2422883dde72e8c07ea3fba66e865\nValid from: Thu Aug 17 05:21:09 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: 65:CC:C8:CF:EA:54:C8:2C:27:31:59:34:5E:69:41:CE:09:37:EB:6B\n         SHA256: C0:C8:68:75:BE:C1:CC:9F:4B:19:5E:23:9B:F4:3B:E8:E3:CE:B7:84:35:29:C0:8C:12:63:1E:B4:81:6B:23:99\nSignature algorithm name: RSASSA-PSS\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_e99b9f12-cbf5-4d5e-9156-12f112d7b4a3_sig_eddsa\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 523b5a9b1edbb4ac08435f1f86c7d810be34535e0bc02b073baeab6d9f35ca75\nValid from: Thu Aug 17 05:21:12 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: EB:D3:5F:54:76:44:D1:01:5F:39:EA:0B:2A:08:FB:30:39:50:E8:CC\n         SHA256: 5F:99:18:AE:47:58:FD:7E:E3:B7:B4:F8:57:4A:5B:68:94:F8:DD:2A:02:DE:F7:58:8B:6A:06:D6:E2:CE:3E:ED\nSignature algorithm name: 1.3.101.112\nSubject Public Key Algorithm: 1.3.101.112 key of unknown size\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_eb5d1996-197c-4913-9b10-201b4f371ff7_sig_es384\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 613554766f456cae0e968ecf8eaedd5fbb0f04c6ff64202c6b51df34cd7b2a20\nValid from: Thu Aug 17 05:21:07 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: 50:FF:D2:51:CA:F6:35:31:C8:12:14:13:36:0B:A5:05:F4:08:3F:97\n         SHA256: 13:13:32:47:2B:5B:E7:20:EC:4B:77:E8:80:78:E0:84:DB:D9:5E:6D:6C:C6:86:5F:B5:6D:18:99:38:02:B0:32\nSignature algorithm name: SHA384withECDSA\nSubject Public Key Algorithm: 384-bit EC (secp384r1) key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_eddc097c-d9bc-4672-a6ec-2740f8ed99c4_enc_ecdh-es+a192kw\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 9755e3a9d7404f86161bdfd47dc0f57021aa598b6f4bde9b3929a1303d66baef\nValid from: Thu Aug 17 05:21:18 CDT 2023 until: Sat Aug 19 06:21:10 CDT 2023\nCertificate fingerprints:\n         SHA1: 20:1F:EE:29:8F:57:B4:FA:29:E8:3F:D6:DD:60:0C:E7:6C:A6:82:54\n         SHA256: 6A:69:0F:0F:D0:51:5F:83:29:91:BB:E5:A7:63:48:14:F7:D1:C4:18:EE:4D:F2:28:50:63:18:2D:00:94:C7:F4\nSignature algorithm name: SHA256withECDSA\nSubject Public Key Algorithm: 256-bit EC (secp256r1) key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_02674321-5bdc-451e-a8e0-12fbc494ab00_sig_ps512\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: b544920f9433a67816ac7e022649057deeecd012b68344683ca92a680496b3dc\nValid from: Tue Aug 08 06:57:41 CDT 2023 until: Tue Aug 08 06:57:51 CDT 2073\nCertificate fingerprints:\n         SHA1: BC:D6:33:CB:95:28:C1:61:D3:EC:D8:10:79:04:C2:22:B8:AF:93:C3\n         SHA256: 38:0E:40:94:0F:57:1A:B5:9E:AD:A2:7E:B1:AE:ED:42:4C:60:9F:BE:C3:95:51:2A:8B:39:E8:92:90:1C:57:FD\nSignature algorithm name: RSASSA-PSS\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_18c82db5-7b1c-4bd4-bbe9-7a4e65045fb4_sig_es384\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 874585304266014b022a0a321c5d4451bb433305b9137a1ddbdff36504e39d45\nValid from: Tue Aug 08 06:57:38 CDT 2023 until: Tue Aug 08 06:57:48 CDT 2073\nCertificate fingerprints:\n         SHA1: 56:79:CC:8A:CB:CF:74:40:31:D6:C3:1D:D8:DC:9B:03:EA:2A:80:89\n         SHA256: 86:12:AF:78:E6:63:68:B7:9E:B7:70:A3:CF:EF:35:35:FF:46:15:18:97:97:A8:1A:17:79:85:F5:99:9E:61:0A\nSignature algorithm name: SHA384withECDSA\nSubject Public Key Algorithm: 384-bit EC (secp384r1) key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_45aa4647-b976-44b8-a94d-025ecced0fe9_enc_rsa-oaep\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 4c0fc7cf58866f4beee13c4bf8d12bd084b264f6bedfa484b54034a385d563db\nValid from: Tue Aug 08 06:57:45 CDT 2023 until: Tue Aug 08 06:57:55 CDT 2073\nCertificate fingerprints:\n         SHA1: 91:48:30:F4:F6:E8:5D:AF:09:79:C2:EC:F9:C6:20:B0:85:3C:02:7E\n         SHA256: 9A:D9:B9:3A:74:AF:99:A9:B2:44:40:1F:8D:E2:C5:72:6E:E3:AA:43:52:A0:8A:1E:61:5A:48:29:57:7E:92:60\nSignature algorithm name: SHA256withRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_46f71619-57a9-4c3f-bc15-b91872c828cf_sig_es256\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 1187ed8ad9aa4a985c68ba2e0665665a50c970a06e25697360b0c680bda347a3\nValid from: Tue Aug 08 06:57:37 CDT 2023 until: Tue Aug 08 06:57:47 CDT 2073\nCertificate fingerprints:\n         SHA1: 9F:F8:EC:FF:83:8A:35:73:B1:AB:89:FF:39:6C:61:C2:76:24:78:37\n         SHA256: B5:3C:C6:0B:13:D2:C0:E5:3D:E4:7D:66:B4:DA:AA:B1:6E:23:82:07:57:D9:ED:3B:47:28:91:CE:76:EE:62:64\nSignature algorithm name: SHA256withECDSA\nSubject Public Key Algorithm: 256-bit EC (secp256r1) key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_51b7ce59-5b1e-4f24-92d0-57edff831f37_sig_es512\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: e2dd7decf9dd456bddfa2b9800ac47a4e38ac420cf416c0255820851a8041daf\nValid from: Tue Aug 08 06:57:39 CDT 2023 until: Tue Aug 08 06:57:49 CDT 2073\nCertificate fingerprints:\n         SHA1: A0:F0:F1:30:66:6B:35:DB:31:AB:8D:D3:E5:58:F4:31:F9:0B:60:E8\n         SHA256: 5F:CF:BB:E8:6E:FE:A9:F3:D0:09:8E:A5:2A:C7:A8:3B:42:CF:2C:A9:59:D9:A2:86:9B:B2:E3:A1:81:D9:BF:2F\nSignature algorithm name: SHA512withECDSA\nSubject Public Key Algorithm: 521-bit EC (secp521r1) key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_5b5666f0-8c3c-46db-8e10-190263885d01_sig_rs512\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 88d0bbd883c815c46882674a9e0cb82d4c27bc18231177a262aab71b28e1878\nValid from: Tue Aug 08 06:57:37 CDT 2023 until: Tue Aug 08 06:57:47 CDT 2073\nCertificate fingerprints:\n         SHA1: E7:6A:0E:37:85:BD:F9:E2:FD:B2:4B:96:A9:3A:97:91:EE:30:91:53\n         SHA256: 41:AB:78:C1:91:19:BA:03:13:B1:D6:62:27:1D:6E:0B:53:FC:91:AF:DF:E0:6A:17:61:E5:28:D7:AF:26:BA:E1\nSignature algorithm name: SHA512withRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_64a3d3e3-503c-4574-a544-ea63bab7f637_enc_ecdh-es\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 58380f109ee41ec443e0e1655e4009f7c782b4e48203464651b92508e37e8cb1\nValid from: Tue Aug 08 06:57:46 CDT 2023 until: Tue Aug 08 06:57:56 CDT 2073\nCertificate fingerprints:\n         SHA1: DF:F5:B0:63:1B:B4:A1:81:28:FF:FB:0E:97:78:49:B1:0F:A7:9F:CA\n         SHA256: 4E:72:58:BB:D6:8E:D1:D1:C8:33:32:2F:58:FA:66:8A:26:1E:10:4F:C3:7F:DD:33:6E:39:38:1F:11:A6:EF:7F\nSignature algorithm name: SHA256withECDSA\nSubject Public Key Algorithm: 256-bit EC (secp256r1) key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_9b146bc3-5987-414c-9ed6-7ba735b0ab10_sig_rs384\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: d62267e39615f334538d64353a48539673b6c8331f3dbb5bdae6b6897541a631\nValid from: Tue Aug 08 06:57:36 CDT 2023 until: Tue Aug 08 06:57:46 CDT 2073\nCertificate fingerprints:\n         SHA1: 15:16:97:87:F1:EF:56:12:9E:FB:24:A5:8E:EA:CF:B5:14:9F:81:24\n         SHA256: 61:C4:F6:D9:8A:54:A9:31:D6:4D:09:B0:D9:0B:36:01:4F:97:53:B8:0D:09:83:01:E3:1B:67:F6:66:F9:05:0B\nSignature algorithm name: SHA384withRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_b037a3dc-b4a9-46a6-8b45-66df01da4f0a_sig_ps256\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 8decb6c87779103a3915f71963b3c6d6208c7530a6935215b3f7ef6a2832effb\nValid from: Tue Aug 08 06:57:39 CDT 2023 until: Tue Aug 08 06:57:49 CDT 2073\nCertificate fingerprints:\n         SHA1: 74:9C:1C:D1:D0:15:92:A4:35:38:C7:12:FC:89:D8:19:29:B7:77:EE\n         SHA256: AF:39:10:89:1E:0B:08:2F:AF:C1:D4:F9:13:73:1D:72:C9:6B:27:EF:8A:F0:66:D6:89:BA:27:CB:1A:90:16:EA\nSignature algorithm name: RSASSA-PSS\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_b0b8feac-e048-407c-afc8-44008b4e88cb_sig_rs256\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 9a20c156e837e5f7d974e6ec9c3da25f30170e775f789c4836d3a00d919fe5e5\nValid from: Tue Aug 08 06:57:36 CDT 2023 until: Tue Aug 08 06:57:46 CDT 2073\nCertificate fingerprints:\n         SHA1: 3F:8D:06:04:A6:9F:ED:C1:39:FC:86:40:C4:8C:19:6D:C2:E3:A9:5E\n         SHA256: 3A:1D:39:FC:3C:BD:17:A9:19:A8:45:BB:FD:FE:2A:3A:24:BD:CF:A6:0A:07:17:21:BF:D8:75:84:5E:10:50:16\nSignature algorithm name: SHA256withRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_b68c6303-e35e-44f0-b300-e9347e3e3305_sig_ps384\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 9bd61db1532aef6c9efa870ccf8cd39caf227037d82c9c0404ba3c95bff46322\nValid from: Tue Aug 08 06:57:40 CDT 2023 until: Tue Aug 08 06:57:50 CDT 2073\nCertificate fingerprints:\n         SHA1: 34:29:CF:02:EF:D0:C9:CF:A3:6C:79:A8:B9:36:D8:6F:CB:6F:4D:02\n         SHA256: 8B:F9:35:9E:86:1E:0A:1C:BC:2E:7C:BB:C9:50:FD:F3:84:51:F6:E8:92:C6:03:2A:0C:EB:74:0C:7D:93:8C:28\nSignature algorithm name: RSASSA-PSS\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_cef00de1-5a40-444a-94b4-35d7a290efad_enc_rsa1_5\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 845d78edfaf1912519bddcffffa6aaae9253dd1a087c781132686472763314e2\nValid from: Tue Aug 08 06:57:44 CDT 2023 until: Tue Aug 08 06:57:54 CDT 2073\nCertificate fingerprints:\n         SHA1: A4:EC:F5:F6:80:A1:51:FE:DD:65:AC:7E:2E:78:C9:0B:FB:82:33:DC\n         SHA256: C9:62:C8:12:CB:C6:6B:96:C6:D4:E4:9B:1D:0A:8A:E8:47:0E:C6:EA:70:E2:CE:DE:06:C8:77:4D:84:3E:32:33\nSignature algorithm name: SHA256withRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_cef05e47-6622-43e7-b61d-1209f0dcdf99_sig_es256k\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: ee31a06bda23b8f5a042295d851018c3502a7a8bcd22e2367226c9b5014699a8\nValid from: Tue Aug 08 06:57:38 CDT 2023 until: Tue Aug 08 06:57:48 CDT 2073\nCertificate fingerprints:\n         SHA1: 22:EC:A2:90:AA:1C:73:0C:23:B2:AA:F8:B2:CD:35:C2:A4:10:0E:0E\n         SHA256: F2:B4:3B:93:BA:BF:08:E0:58:30:78:03:8F:C0:60:6A:68:E7:68:7D:00:ED:50:B2:9A:8B:21:C3:9F:71:4A:8A\nSignature algorithm name: SHA256withECDSA\nSubject Public Key Algorithm: 256-bit EC (secp256k1) key (disabled)\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.37 Criticality=false\nExtendedKeyUsages [\n  serverAuth\n  clientAuth\n  anyExtendedKeyUsage\n]\n\n\n\n*******************************************\n*******************************************\n</code></pre> <p>All keys are saved in aliases. Every alias has follow format: KeyOpsType + GUID + Use + Algorithm.</p> <p>Where:   - KeyOpsType: values Connect | SSA   - Use: sig (signature) | enc (encryption)    - Algorithm:        if Use == sig follow algorithm values are used: RS256 RS384 RS512 ES256 ES256K ES384 ES512 PS256 PS384 PS512 EdDSA       if Use == enc follow algorithm values are used: RSA1_5 RSA-OAEP RSA-OAEP-256 ECDH-ES ECDH-ES+A128KW ECDH-ES+A192KW ECDH-ES+A256KW .</p> <p>This Key Store is used for keys/certificates keeping, which are used by the OpenID provider (jans-auth-server).</p>","tags":["administration","auth-server","cryptography","key-storage"]},{"location":"janssen-server/auth-server/crypto/key-storage/#smtp-keyspkcs12","title":"smtp-keys.pkcs12","text":"<p>Here is the example of the file: /etc/certs/smtp-keys.pkcs12 (list of entries/aliases).</p> <pre><code>keytool -list -v -storetype PKCS12 -keystore /etc/certs/smtp-keys.pkcs12 -storepass 6VkIGu0DhnrD\n</code></pre> <pre><code>Keystore type: PKCS12\nKeystore provider: SUN\n\nYour keystore contains 1 entry\n\nAlias name: smtp_sig_ec256\nCreation date: Aug 8, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=SMTP CA Certificate\nIssuer: CN=SMTP CA Certificate\nSerial number: 690675c1\nValid from: Tue Aug 08 06:57:12 CDT 2023 until: Fri Aug 05 06:57:12 CDT 2033\nCertificate fingerprints:\n         SHA1: 69:77:F6:3E:44:0C:3A:BE:0D:58:02:71:21:72:39:12:54:DB:D7:88\n         SHA256: E5:E6:CB:BE:76:62:06:2F:A0:C9:49:0F:DD:0D:B1:D1:5B:D6:A2:2C:11:E1:0B:FE:84:67:B0:9D:EB:9B:3A:ED\nSignature algorithm name: SHA256withECDSA\nSubject Public Key Algorithm: 256-bit EC (secp256r1) key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 2.5.29.14 Criticality=false\nSubjectKeyIdentifier [\nKeyIdentifier [\n0000: 94 D2 A8 BC 8C D7 6F E0   EC BF 2D 92 3A 8D E1 CE  ......o...-.:...\n0010: 3D 71 CB B0                                        =q..\n]\n]\n\n\n\n*******************************************\n*******************************************\n</code></pre> <p>This Key Store stores one alias (smtp_sig_ec256) and it is used for keeping of key/certificate, which is used by email sending functionality - signing of emails. Alias smtp_sig_ec256 contains self-signed certificate. User/Admin can update this KeyStore, adding key/certificate signed by trusted certificate authority (CA) (X-509 PKI).</p>","tags":["administration","auth-server","cryptography","key-storage"]},{"location":"janssen-server/auth-server/crypto/key-storage/#bcfks-keystore","title":"BCFKS KeyStore","text":"<p>Janssen also supports BCFKS format of KeyStore. As a rule this format is used on RHEL/DISA-STIG OS. Access to this type of KeyStore is provided by BCFIPS crypto provider. Modules of cryptoprovider can be found (after installing on RHEL/DISA-STIG OS) here:</p> <ul> <li>/var/gluu/dist/app/bc-fips-1.0.2.3.jar</li> <li>/var/gluu/dist/app/bcpkix-fips-1.0.6.jar .</li> </ul> <p>Here is example of the BCFKS KeyStore /etc/certs/jans-auth-keys.bcfks (list of entries/aliases):</p> <pre><code>keytool -list -v -keystore /etc/certs/jans-auth-keys.bcfks -storetype BCFKS -providerpath /var/gluu/dist/app/bc-fips-1.0.2.3.jar:/var/gluu/dist/app/bcpkix-fips-1.0.6.jar -provider org.bouncycastle.jcajce.provider.BouncyCastleFipsProvider -storepass CqE4ApXQxz5y\n</code></pre> <p><pre><code>Keystore type: BCFKS\nKeystore provider: BCFIPS\n\nYour keystore contains 30 entries\n\nAlias name: connect_01906c9d-fed6-48f1-94b8-85446a692f23_enc_rsa1_5\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 3b795840da219a3a7736d0ac0ebc2d632e925dc4b472a02e4b930eb1d5ca278b\nValid from: Thu Aug 17 04:58:51 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: 40:B5:54:85:6B:3B:B1:A9:93:22:6D:91:AA:37:AD:92:A9:B0:5A:A9\n     SHA256: 06:23:28:01:89:6A:96:EA:A6:3E:EA:27:1D:7C:7A:8A:C7:C9:6D:3F:D0:BF:00:69:35:27:CA:CB:54:75:C6:F1\nSignature algorithm name: SHA256WITHRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_03a3687a-9c3c-4026-abfc-cafef6a76f92_enc_rsa-oaep\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: df266f1918ae93954aaad44cdceab2ac89be1c20ad16245f1567d751db5d6d1a\nValid from: Thu Aug 17 04:58:52 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: 12:12:0B:15:47:A4:C9:AB:44:4A:00:5E:B3:3A:8E:EE:56:70:6F:A7\n     SHA256: 11:F8:12:47:17:E6:D1:D4:80:1F:66:72:22:2C:49:93:72:DE:EF:5E:58:40:74:5B:AE:66:C4:96:F5:9C:86:13\nSignature algorithm name: SHA256WITHRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_1b960e55-7b8c-4eeb-9379-b933b8a28fb6_enc_ecdh-es+a128kw\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: ad0cb98a5844cfe6a56c944d269aa3ce6379dc8fea2b0752514753935ae3d821\nValid from: Thu Aug 17 04:58:52 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: 28:8F:83:99:24:8E:97:54:5A:B7:41:BB:28:C5:5E:BE:67:38:AF:F4\n     SHA256: E5:DE:D0:4A:17:5B:F8:5D:32:E4:8B:E2:E6:24:D6:22:50:D6:2E:E1:D4:ED:AB:9A:AB:74:B8:24:8C:16:97:14\nSignature algorithm name: SHA256WITHECDSA\nSubject Public Key Algorithm: 256-bit EC key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_4260d824-790d-440e-b2e0-a1a4ab813169_sig_es512\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 28f4866a894a33bb70dcb33138631be67a3b3b2c2b02c31a24913fde2d6d905d\nValid from: Thu Aug 17 04:58:51 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: CD:2C:FC:D2:81:A7:26:EA:C1:63:66:C4:AF:43:20:F3:E0:10:B7:41\n     SHA256: F5:3F:81:C5:B4:CD:8B:7D:B1:E4:83:54:DE:B9:88:F5:1B:3E:DA:CD:A5:93:86:D5:21:E5:3B:3D:42:5C:56:E3\nSignature algorithm name: SHA512WITHECDSA\nSubject Public Key Algorithm: 521-bit EC key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_464cc164-24ec-43c2-9f13-bca1c7faab11_sig_es256\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: d4786313f02f3444beabbac0ed6c307db4af29e3f044edd047e976efe48c2337\nValid from: Thu Aug 17 04:58:50 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: 8A:37:4D:12:F9:24:93:DF:1B:59:90:26:3B:1A:95:5A:F8:46:1E:CB\n     SHA256: B4:28:C6:BC:3D:AA:7C:52:5C:E4:22:FC:E7:E0:94:BF:22:66:91:0F:D6:CF:37:6E:C5:54:ED:0C:30:A8:24:CF\nSignature algorithm name: SHA256WITHECDSA\nSubject Public Key Algorithm: 256-bit EC key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_53cfa5f1-c227-4843-94d0-e5369cd822b0_sig_rs384\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 321e23c27b9ec8a65e7e8fe0e64f68aa7390d713bebfa78b17f8962bb28c1d4f\nValid from: Thu Aug 17 04:58:50 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: 6F:D2:4A:FC:48:1F:F3:B7:CC:13:4B:41:3A:BC:19:C4:85:A9:E9:7C\n     SHA256: 43:80:83:D8:84:75:87:5A:24:D6:6B:AC:EC:0D:45:2E:8F:4A:FC:B4:47:D4:D7:49:E8:06:12:2F:98:7C:91:8F\nSignature algorithm name: SHA384WITHRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_63e8e482-18ef-410e-bf27-0543a37ac166_sig_ps512\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 5fe30fe9ce2b55b6738ec74e0b711c5aa3052ae200fdb9c39bb1392420087d7c\nValid from: Thu Aug 17 04:58:51 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: 1C:27:A5:78:64:EA:01:13:C8:62:D4:4C:93:7A:95:F5:CC:C0:55:BA\n     SHA256: F6:CB:47:52:9D:10:B6:31:FB:C2:1F:CC:30:DD:91:DD:2D:85:C0:44:BB:AB:CA:05:9D:47:05:00:7E:35:73:8B\nSignature algorithm name: PSS\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_64e35c92-c4f2-4104-81ef-7a366f2dbc38_sig_ps384\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 6742d9b42e180b7f4a1f58121dddb02896ff1638e8254bd74415a90e47718e91\nValid from: Thu Aug 17 04:58:51 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: 75:AB:EA:2C:D7:C8:87:86:7C:FE:0D:23:33:24:CE:FD:75:3E:E5:E0\n     SHA256: EA:7D:7F:F1:51:00:5F:D8:80:A5:AF:67:F4:E1:84:A2:E5:D0:0A:8F:A3:98:81:29:36:9B:14:DA:59:02:76:AA\nSignature algorithm name: PSS\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_71a098e5-0fe0-4946-85f8-adf0d6759413_enc_ecdh-es+a256kw\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 285d3bcd2569a9a0db6091c184e47bf855edf758251749b739267b7f6f9821d3\nValid from: Thu Aug 17 04:58:52 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: D6:D7:0C:33:6E:A8:A4:54:2A:1F:2D:59:7D:2C:26:0A:EB:B8:AE:41\n     SHA256: EC:82:5E:A3:66:99:FB:3E:64:B7:47:27:AA:0D:13:C6:64:E1:42:41:B4:8E:F7:B9:23:20:AA:15:1E:F3:22:F7\nSignature algorithm name: SHA256WITHECDSA\nSubject Public Key Algorithm: 256-bit EC key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_82a7b334-4756-4201-a432-1b181badf695_sig_ps256\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: cce1b501329cff10503a96587042b4f37cc994ac3f98c615bab4c9680a53d769\nValid from: Thu Aug 17 04:58:51 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: 37:1C:A3:F4:A3:04:E4:DC:AA:F3:21:AD:BD:B0:5F:D8:0A:95:7B:29\n     SHA256: D7:CA:AE:57:A3:43:1E:94:93:ED:C8:34:72:29:DD:CE:02:BD:E5:69:6D:34:D3:7D:26:AE:78:19:4C:E9:BF:CE\nSignature algorithm name: PSS\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_a3d528cf-fd43-4015-92be-1e644310bbf0_enc_ecdh-es\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: de13b1e646dd2456c3512de303b2fb272108bcdb40c180717077820c07e32f65\nValid from: Thu Aug 17 04:58:52 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: EF:5E:62:AA:89:31:70:83:35:40:CB:9E:30:23:32:21:12:77:DC:83\n     SHA256: 88:1A:A2:85:DB:27:46:04:EE:E5:DC:8A:5E:A7:77:CC:36:C5:A6:1A:E7:A1:85:44:2E:E4:A0:91:8A:FD:A4:6F\nSignature algorithm name: SHA256WITHECDSA\nSubject Public Key Algorithm: 256-bit EC key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_ab2f67de-14fb-4312-89fa-56b2cd70f616_sig_es256k\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: d36755d2a472837ab9fe1dad688b5a1881bff6073d5a494af0275226f236146c\nValid from: Thu Aug 17 04:58:51 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: 8B:FD:A9:75:7C:33:1E:9D:03:47:58:2E:31:D6:49:30:E6:65:6B:A7\n     SHA256: 5C:E2:28:7B:B0:66:17:A8:14:82:49:14:16:E8:40:B3:B6:C1:5F:90:77:25:A3:C4:A5:25:E6:77:CB:B9:92:91\nSignature algorithm name: SHA256WITHECDSA\nSubject Public Key Algorithm: 256-bit EC key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_ae7adf42-8f9b-4fe0-bbf1-e9e1016904f5_enc_rsa-oaep-256\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 324a9b70a8410e9a02eb596e536cda516f91b250befb22699a909d0b2505e03\nValid from: Thu Aug 17 04:58:52 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: 66:CF:B6:EB:27:10:CC:45:E4:CF:8A:66:71:05:97:22:BA:47:6B:33\n     SHA256: EF:16:46:1F:C5:0B:41:0B:B4:06:A7:9D:7F:EB:81:76:5F:35:B3:E4:09:67:95:D2:2A:10:D3:2F:59:DA:5D:73\nSignature algorithm name: SHA256WITHRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_b52de13d-33fe-446f-b4fa-6b4ce816c18e_sig_rs256\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 4d4b22cacdd15cd7bbf339c18ef14fba4ba7b0f13ad37f9452e00404488a880c\nValid from: Thu Aug 17 04:58:50 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: 47:03:76:16:4B:D9:5C:83:AC:C7:40:10:F3:46:72:86:15:21:6C:CD\n     SHA256: A3:3A:22:75:E2:E5:5B:69:31:FB:E8:59:E0:90:20:60:BC:47:30:9C:5C:5A:B6:97:92:37:71:CD:91:BF:93:78\nSignature algorithm name: SHA256WITHRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_c82cc876-6e92-408c-b519-76d153aad42d_enc_ecdh-es+a192kw\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 586b7dd9cecd3ef8c58b1bac766caec5d4c2ac8097c1cc4a22a20905ce5f9229\nValid from: Thu Aug 17 04:58:52 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: E6:3E:62:82:3C:6F:FE:CF:85:FD:6D:82:A9:7D:68:03:38:F0:AB:63\n     SHA256: 0D:D0:1B:50:02:0B:41:C1:35:CD:A9:7A:E5:10:AA:88:F2:AD:F7:8E:88:C2:3F:68:A9:33:E6:1B:EB:28:71:30\nSignature algorithm name: SHA256WITHECDSA\nSubject Public Key Algorithm: 256-bit EC key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_d1001a39-29a1-45e4-ae0d-2eee86a83ada_sig_rs512\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: ba44ac71c5a340aec0d8e0078b059c36a2819915774e8403e1b589a330570833\nValid from: Thu Aug 17 04:58:50 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: 49:59:6A:9D:D6:E6:98:05:18:BD:25:1A:C5:C0:2B:A6:C3:3E:36:52\n     SHA256: DA:57:65:45:A2:16:76:E0:B7:20:DA:82:BF:77:AF:B9:58:D5:E7:D3:2F:1B:D3:BC:48:51:E2:D1:C2:41:A9:FA\nSignature algorithm name: SHA512WITHRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: connect_f32a5790-4e43-4629-95bd-37b35d7c2e39_sig_es384\nCreation date: Aug 17, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 9f0340f5c5cafc1816d2a31c20846fb24d400b3b5194a629ac5baf6db6d15e60\nValid from: Thu Aug 17 04:58:51 CDT 2023 until: Sat Aug 19 05:58:59 CDT 2023\nCertificate fingerprints:\n     SHA1: 5A:37:CA:6A:27:AB:9F:FC:6B:C3:D3:C6:B4:47:F3:10:F4:C9:F3:B3\n     SHA256: 11:A4:9C:ED:C0:05:B9:27:89:2B:17:52:11:AA:34:B4:E7:81:08:13:44:7D:93:3A:DE:CA:23:A4:22:F7:05:9F\nSignature algorithm name: SHA384WITHECDSA\nSubject Public Key Algorithm: 384-bit EC key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_0639ba94-902c-4ab6-923a-58137554f667_enc_ecdh-es\nCreation date: Aug 10, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 6fac3869f3fc7297470eee65fc4315328edaf475798d5bbc469de652f3088ca3\nValid from: Thu Aug 10 18:20:51 CDT 2023 until: Thu Aug 10 18:21:01 CDT 2073\nCertificate fingerprints:\n     SHA1: 76:B5:F0:B9:1C:88:54:95:5B:11:2A:6A:AE:2E:C3:02:59:1B:07:2C\n     SHA256: 7B:26:2E:36:4B:27:AA:C0:5B:FE:2C:2E:73:B1:75:64:2D:3E:0B:D2:C4:8D:F6:63:12:E8:2E:4C:46:EB:35:4C\nSignature algorithm name: SHA256WITHECDSA\nSubject Public Key Algorithm: 256-bit EC key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_0d94f183-878c-445d-9917-28357b15c4ee_sig_rs256\nCreation date: Aug 10, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 6d76a82ed166e13ecc2fb0742ebc72f619af0b738baf69438d2aba4262cfdbc4\nValid from: Thu Aug 10 18:20:50 CDT 2023 until: Thu Aug 10 18:21:00 CDT 2073\nCertificate fingerprints:\n     SHA1: 14:8E:19:D8:8D:FD:68:14:40:72:35:1F:93:2A:7D:83:81:7E:6C:D8\n     SHA256: CB:69:E0:7C:55:2C:39:56:F8:17:ED:72:96:47:DB:8C:90:1A:1E:2A:E8:33:CA:79:96:DD:44:9F:F7:63:A2:D4\nSignature algorithm name: SHA256WITHRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_1a5ea0d5-0c70-43d2-ab23-e324620b413b_sig_ps512\nCreation date: Aug 10, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 42bd6fbc27749cd6598c54aa0928e93057dc6c6c083c9f73d4e2046c4bac02d0\nValid from: Thu Aug 10 18:20:51 CDT 2023 until: Thu Aug 10 18:21:01 CDT 2073\nCertificate fingerprints:\n     SHA1: D3:D1:31:59:33:D1:A6:86:8F:A5:F8:7F:D6:15:44:53:15:99:6D:DC\n     SHA256: 88:95:8C:89:F3:E7:28:E8:3D:9F:47:39:E2:F8:F5:FC:FA:63:71:B3:81:F0:9C:98:7E:A4:0A:FD:7E:7E:E9:AD\nSignature algorithm name: PSS\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_20d8cce9-0994-4fca-9cfa-f5fbe22eb940_sig_es256k\nCreation date: Aug 10, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: a192c3ca749b78a153cb3134c50fddcdd5dd401dd399b831199ba383eddf355b\nValid from: Thu Aug 10 18:20:50 CDT 2023 until: Thu Aug 10 18:21:00 CDT 2073\nCertificate fingerprints:\n     SHA1: 4E:94:55:21:15:53:1E:3E:3B:6E:85:B9:BF:A7:4B:46:2A:FB:09:4F\n     SHA256: BA:AB:58:DF:29:7C:5A:D5:31:2F:B9:8B:CE:E9:3F:0B:5B:E5:01:94:CC:A8:9B:41:8B:45:9B:30:D2:63:D6:24\nSignature algorithm name: SHA256WITHECDSA\nSubject Public Key Algorithm: 256-bit EC key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_33b1591d-1b79-490f-a980-573486ec620b_sig_es384\nCreation date: Aug 10, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: ba8a0e96843f1a5181a96d2fc1bdae8b6954bb70b2b5c1fad4895438f4079dd0\nValid from: Thu Aug 10 18:20:50 CDT 2023 until: Thu Aug 10 18:21:00 CDT 2073\nCertificate fingerprints:\n     SHA1: B8:97:F4:EA:85:14:41:24:8C:DC:E0:8F:66:18:FD:31:7E:0B:5D:D5\n     SHA256: F3:9E:1F:25:E2:03:3C:7B:69:15:12:01:E2:94:EF:1E:95:43:43:A2:CB:8E:88:88:8A:3D:53:5E:82:E9:0E:9C\nSignature algorithm name: SHA384WITHECDSA\nSubject Public Key Algorithm: 384-bit EC key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_34943497-d9fb-43ca-8ee1-1437e1dcf78e_sig_ps384\nCreation date: Aug 10, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: b45de18f13366f309b100be313770edc6e80942771b08d656e699f7e081e5a69\nValid from: Thu Aug 10 18:20:51 CDT 2023 until: Thu Aug 10 18:21:00 CDT 2073\nCertificate fingerprints:\n     SHA1: C4:2D:DB:4D:06:7F:27:89:9A:C0:84:DB:08:BF:0C:75:3B:5B:74:22\n     SHA256: 77:07:D2:90:7C:AD:7A:F1:D8:EE:C1:84:54:B6:E5:41:7B:BB:C7:8F:64:96:D4:D3:ED:FD:32:F3:6C:10:11:62\nSignature algorithm name: PSS\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_475830af-d019-4e04-9fb9-e68f0491284a_sig_es512\nCreation date: Aug 10, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 69e6093118ce51ec5f21477e2946dd023f3c5b70bbde2922b26139b653eddd62\nValid from: Thu Aug 10 18:20:50 CDT 2023 until: Thu Aug 10 18:21:00 CDT 2073\nCertificate fingerprints:\n     SHA1: 30:9D:95:9C:AE:60:F9:3F:D8:7A:AD:89:9D:AC:5D:7F:05:52:F9:50\n     SHA256: CA:90:7B:75:3C:99:CE:F2:42:DE:55:38:83:CB:C2:EA:F8:E7:0D:2B:00:5F:57:CF:75:D5:33:C4:5E:32:7E:A7\nSignature algorithm name: SHA512WITHECDSA\nSubject Public Key Algorithm: 521-bit EC key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_59bb3fe7-bf2a-4244-85a7-dd18785bcac6_enc_rsa-oaep\nCreation date: Aug 10, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 7f3e4adf1e08994ba83a1a59584c6f402e584baaecf1735ff9e0add33d65a423\nValid from: Thu Aug 10 18:20:51 CDT 2023 until: Thu Aug 10 18:21:01 CDT 2073\nCertificate fingerprints:\n     SHA1: FC:D7:45:92:F4:60:73:C6:7C:19:DA:AB:EC:54:FF:B4:62:C6:AC:CB\n     SHA256: 66:05:C9:4C:3D:CA:EC:9F:29:06:57:00:A8:90:09:24:17:41:71:DC:1F:8E:7F:E7:5B:39:D8:A1:8B:A3:5A:F2\nSignature algorithm name: SHA256WITHRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_5e0f07d5-1e91-4bd3-bf56-6caa8a137ea6_enc_rsa1_5\nCreation date: Aug 10, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 3449c41d6f7c1b5b7f33c7411a81f41883f6f1fccb64d4e2bc22c130d771a26a\nValid from: Thu Aug 10 18:20:51 CDT 2023 until: Thu Aug 10 18:21:01 CDT 2073\nCertificate fingerprints:\n     SHA1: 1F:55:2E:62:3D:7E:FE:92:20:13:0D:FC:33:F8:82:B1:B7:BF:9E:7A\n     SHA256: C9:6E:48:AF:F7:8B:04:30:FB:4B:30:47:A2:83:1E:4C:AF:9E:04:E6:07:8A:B1:AE:3B:CD:92:AE:CB:97:D2:EB\nSignature algorithm name: SHA256WITHRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_7d9cec29-697e-4e3e-9991-eba03394b69c_sig_ps256\nCreation date: Aug 10, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 15e7eed8194a80919e9bd699212efca7e50ec9aa3834c6a8e32a7eeb9d9e1da9\nValid from: Thu Aug 10 18:20:50 CDT 2023 until: Thu Aug 10 18:21:00 CDT 2073\nCertificate fingerprints:\n     SHA1: A5:BE:24:97:EB:F5:0F:18:05:56:02:BF:66:24:98:24:59:82:5A:E6\n     SHA256: 16:EF:DD:45:17:3B:D7:66:36:14:7E:96:03:1F:51:02:6C:86:1E:19:E7:43:C7:DF:E9:A9:D0:86:9C:A6:7C:B8\nSignature algorithm name: PSS\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_96ea824f-f915-4da8-8f76-3b4bf8bdf552_sig_rs384\nCreation date: Aug 10, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 4c79afa5d03e2aaab17c90519d59dec517de004f4c9b62960ebf10276b699105\nValid from: Thu Aug 10 18:20:50 CDT 2023 until: Thu Aug 10 18:21:00 CDT 2073\nCertificate fingerprints:\n     SHA1: E8:F3:5D:16:D0:2C:47:98:D4:F6:98:A1:5F:46:A0:DB:BD:F8:72:30\n     SHA256: 15:42:A4:30:FE:DB:D8:C4:61:11:A6:8D:10:51:02:64:70:C7:EA:BF:F3:C8:F3:42:03:D9:F8:00:19:F9:7C:28\nSignature algorithm name: SHA384WITHRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_b7ee7e46-0a6b-4040-b6b3-a78e9dedc116_sig_rs512\nCreation date: Aug 10, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 82f95026558b89f3ca8c1129d3b79c74ce2ff70bb849991a8305afea974ebe1c\nValid from: Thu Aug 10 18:20:50 CDT 2023 until: Thu Aug 10 18:21:00 CDT 2073\nCertificate fingerprints:\n     SHA1: D8:45:78:27:94:39:93:57:DF:67:56:3B:06:5C:0C:2A:20:93:F6:0F\n     SHA256: 6D:55:8E:F3:5F:6A:EA:6D:37:71:A9:57:1D:32:98:92:04:5E:8B:4A:C4:FC:E1:ED:B1:7A:D4:11:BF:38:02:80\nSignature algorithm name: SHA512WITHRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\n\n*******************************************\n*******************************************\n\n\nAlias name: ssa_b9d65217-ff51-4eab-914f-aeb40eb30bc2_sig_es256\nCreation date: Aug 10, 2023\nEntry type: PrivateKeyEntry\nCertificate chain length: 1\nCertificate[1]:\nOwner: CN=Jans Auth CA Certificates\nIssuer: CN=Jans Auth CA Certificates\nSerial number: 632a5f6e2bf5c5dbabf7376718c35b3101fe8a8065a6bf54db3dde5a1825dbf4\nValid from: Thu Aug 10 18:20:50 CDT 2023 until: Thu Aug 10 18:21:00 CDT 2073\nCertificate fingerprints:\n     SHA1: 7D:51:C1:44:45:EF:6B:71:3D:EF:BC:20:E0:AE:59:4C:3D:16:10:23\n     SHA256: CC:1C:60:5E:E4:6A:B4:C4:7F:3F:2D:1B:2F:12:B4:79:27:94:3D:1D:D5:FA:C4:11:0E:53:76:DA:52:34:B0:62\nSignature algorithm name: SHA256WITHECDSA\nSubject Public Key Algorithm: 256-bit EC key\nVersion: 3\n\n\n*******************************************\n*******************************************\n</code></pre> .</p>","tags":["administration","auth-server","cryptography","key-storage"]},{"location":"janssen-server/auth-server/crypto/keys/","title":"Keys","text":"<p>Janssen uses keys for signing and encryption, primarily concerning JSON documents. Janssen supports several signing and encryption algorithms in salted and unsalted formats to meet different business requirements. If other algorithms are necessary, Janssen supports them via interception scripts.</p> <p>A key is a piece of information, usually a string of numbers or letters that are stored in a file, which, when processed through a cryptographic algorithm, can encode or decode cryptographic data. In Janssen we use keys for creating token like <code>id_token</code>,<code>access_token</code>.</p> <ul> <li> <p>access_token : Access tokens are what the OAuth client uses to make requests to an API. The access token is meant to be read and validated by the API.</p> </li> <li> <p>id_token : An ID token is an artifact that proves that the user has been authenticated. It was introduced by OpenID Connect (OIDC), an open standard for authentication used by Janssen. It contains information about what happened when a user authenticated, and is intended to be read by the OAuth client. The ID token may also contain information about the user such as their name or email address, although that is not a requirement of an ID token.</p> </li> </ul>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#jans-server-json-objects-of-public-key","title":"Jans server JSON objects of public key","text":"<p>Gets list of JSON Web Key (JWK) used by server. JWK is a JSON data structure that represents a set of public keys as a JSON object. Browse below endpoint to know more about public keys used by server.</p> <p><code>https://&lt;your_server&gt;/jans-auth/restv1/jwks</code></p> <p>Let's see some example of JWT public keys used in janssen.</p> <p>When jwk is expired, it is archived and can be access by following url:</p> <p><code>https://&lt;your_server&gt;/jans-auth/restv1/jwks/archived/{kid}</code></p> <p>More info about archived jwks can be found here</p>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#example-1","title":"Example-1","text":"<p>The \"kty\" (Key Type) of this key is RSA. This key is \"use\" (Public Key Use) for \"sig\" (Signature) on data. The \"alg\" (Algorithm) intended with this key is \"RS256\". <pre><code>{\n      \"name\" : \"Connect RS256 Sign Key\"\n      \"descr\" : \"Signature Key: RSA RSASSA-PKCS1-v1_5 using SHA-256\",\n      ...\n}\n</code></pre></p>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#example-2","title":"Example-2","text":"<p>The \"kty\" (Key Type) of this key is RSA. This key is \"use\" (Public Key Use) for \"sig\" (Signature) on data. The \"alg\" (Algorithm) intended with this key is \"RS384\".</p> <pre><code>{\n      \"name\" : \"Connect RS384 Sign Key\",\n      \"descr\" : \"Signature Key: RSA RSASSA-PKCS1-v1_5 using SHA-384\",\n      ...\n}\n</code></pre>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#example-3","title":"Example-3","text":"<p>The \"kty\" (Key Type) of this key is RSA. This key is \"use\" (Public Key Use) for signature (\"sig\") on data. The \"alg\" (Algorithm) intended with this key is \"RS512\".</p> <pre><code>{\n      \"name\" : \"Connect RS512 Sign Key\",\n      \"descr\" : \"Signature Key: RSA RSASSA-PKCS1-v1_5 using SHA-512\",\n      ...\n}\n</code></pre>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#example-4","title":"Example-4","text":"<p>The \"kty\" (Key Type) of this key is \"EC\" (Ellliptic Curve). This key is \"use\" (Public Key Use) for signature (\"sig\") on data. The \"alg\" (Algorithm) intended with this key is \"ES256\".</p> <pre><code>{\n      \"name\" : \"Connect ES256 Sign Key\",\n      \"descr\" : \"Signature Key: ECDSA using P-256 (secp256r1) and SHA-256\",\n      ...\n}\n</code></pre>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#example-5","title":"Example-5","text":"<p>The \"kty\" (Key Type) of this key is \"EC\" (Ellliptic Curve). This key is \"use\" (Public Key Use) for signature (\"sig\") on data. The \"alg\" (Algorithm) intended with this key is \"ES256K\".</p> <pre><code>{\n      \"name\" : \"Connect ES256 Sign Key\",\n      \"descr\" : \"Signature Key: ECDSA using P-256 (secp256r1) and SHA-256\",\n      ...\n}\n</code></pre>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#example-6","title":"Example-6","text":"<p>The \"kty\" (Key Type) of this key is \"EC\" (Ellliptic Curve). This key is \"use\" (Public Key Use) for signature (\"sig\") on data. The \"alg\" (Algorithm) intended with this key is \"ES256K\". <pre><code>{\n      \"name\" : \"Connect ES384 Sign Key\",\n      \"descr\" : \"Signature Key: ECDSA using P-384 (secp384r1) and SHA-384\",\n      ...\n}\n</code></pre></p>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#example-7","title":"Example-7","text":"<p>The \"kty\" (Key Type) of this key is \"EC\" (Ellliptic Curve). This key is \"use\" (Public Key Use) for signature (\"sig\") on data. The \"alg\" (Algorithm) intended with this key is \"ES512\".</p> <pre><code>{\n      \"name\" : \"Connect ES512 Sign Key\",\n      \"descr\" : \"Signature Key: ECDSA using P-521 (secp521r1) and SHA-512\",\n      ...\n}\n</code></pre>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#example-8","title":"Example-8","text":"<p>The \"kty\" (Key Type) of this key is \"RSA\". This key is \"use\" (Public Key Use) for signature (\"sig\") on data. The \"alg\" (Algorithm) intended with this key is \"PS256\".</p> <pre><code>{\n      \"name\" : \"Connect PS256 Sign Key\",\n      \"descr\" : \"Signature Key: RSASSA-PSS using SHA-256 and MGF1 with SHA-256\",\n      ...\n}\n</code></pre>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#example-9","title":"Example-9","text":"<p>The \"kty\" (Key Type) of this key is \"RSA\". This key is \"use\" (Public Key Use) for signature (\"sig\") on data. The \"alg\" (Algorithm) intended with this key is \"PS384\".</p> <pre><code>{\n      \"name\" : \"Connect PS384 Sign Key\",\n      \"descr\" : \"Signature Key: RSASSA-PSS using SHA-384 and MGF1 with SHA-384\",\n      ...\n}\n</code></pre>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#example-10","title":"Example-10","text":"<p>The \"kty\" (Key Type) of this key is \"RSA\". This key is \"use\" (Public Key Use) for signature (\"sig\") on data. The \"alg\" (Algorithm) intended with this key is \"PS512\".</p> <pre><code>{\n      \"name\" : \"Connect PS512 Sign Key\",\n      \"descr\" : \"Signature Key: RSASSA-PSS using SHA-512 and MGF1 with SHA-512\",\n      ...\n}\n</code></pre>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#example-11","title":"Example-11","text":"<p>The \"kty\" (Key Type) of this key is \"RSA\". This key is \"use\" (Public Key Use) for \"enc\" (encryption) on data. The \"alg\" (Algorithm) intended with this key is \"RSA1_5\".</p> <p>``commandLine {       \"name\" : \"Connect RSA1_5 Encryption Key\",       \"descr\" : \"Encryption Key: RSAES-PKCS1-v1_5\",       ... } <pre><code>### Example-12\n\nThe \"kty\" (Key Type) of this key is \"RSA\". This key is \"use\" (Public Key Use) for \"enc\" (encryption) on data. The \"alg\" (Algorithm) intended with this key is \"RSA-OAEP\".\n\n```commandLine\n{\n      \"name\" : \"Connect RSA-OAEP Encryption Key\",\n      \"descr\" : \"Encryption Key: RSAES OAEP using default parameters\",\n      ...\n }\n</code></pre></p>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#crypto-supported","title":"Crypto Supported","text":"<p>Depending on the transport through which the messages are sent, the integrity of the message might not be guaranteed and the originator of the message might not be authenticated. To mitigate these risks, ID Token, UserInfo Response, Request Object, and Client Authentication JWT values can utilize JSON Web Signature (JWS) [JWS] to sign their contents. To achieve message confidentiality, these values can also use JSON Web Encryption (JWE) [JWE] to encrypt their contents.</p>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#signing-algorithms","title":"Signing algorithms","text":"<p>Signing or Signature algorithm is a cryptographic mechanism used to verify the authenticity and integrity of digital data. We may consider it as a digital version of the ordinary handwritten signatures, but with higher levels of complexity and security.</p> <p>Let's see some signing key algorithms</p> Name Kty Use Alg RS256 Sign Key RSA sig RS256 RS384 Sign Key RSA sig RS384 RS512 Sign Key RSA sig RS512 ES256 Sign Key EC sig ES256 ES256 Sign Key EC sig ES256K ES384 Sign Key EC sig ES384 ES512 Sign Key EC sig ES384 PS256 Sign Key RSA sig PS256 PS384 sign Key RSA sig PS384 PS512 sign Key RSA sig PS512","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#encryption-algorithms","title":"Encryption algorithms","text":"<p>In cryptography, encryption is the process of encoding information. This process converts the original representation of the information, known as plaintext, into an alternative form known as ciphertext. Ideally, only authorized parties can decipher a ciphertext back to plaintext and access the original information.</p> <p>Let's see some encryption keys.</p> Name Kty Use Alg RSA1_5 Encryption key RSA enc RSA1_5 RSA-OAEP Encryption Key RSA enc RSA-OAEP ECDH-ES Encryption Key CE enc ECDH-ES","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#rsa-key-formats","title":"RSA Key Formats","text":"<ul> <li>PKCS#8 encrypted private key \"EncryptedPrivateKeyInfo\" (default for private keys)</li> <li>PKCS#1 \"RSAPublicKey\" (default for public keys)</li> <li>PKCS#8 unencrypted \"PrivateKeyInfo\"</li> <li>PKCS#1 unencrypted \"RSAPrivateKey\" (OpenSSL private key file format)</li> <li>X.509 \"SubjectPublicKeyInfo\" (OpenSSL public key file format)</li> </ul> <p>The above key values can be passed as (a) a binary DER-encoded ASN.1 file, (b) a text file in PEM format, (c) a string containing the key in PEM format.</p> <p>Also supported are RSA private and public keys represented in XML format to XKMS 2.0 [XKMS] and JSON Web Key (JWK) format [JWK]. For more details, see Key Storage Format. To know more about RSA keyformat browse here</p>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/crypto/keys/#janssen-keystore-formats","title":"Janssen Keystore Formats","text":"<p>In Janssen we use  keystore formats PKCS12. Which is Encrypted private key formats. In Janssen currently using an extension of <code>p12</code>. We also have <code>pkcs12</code>, <code>pfx</code>. We can store private keys, secret keys and certificates on this type. You can find <code>jans-auth-keys.p12</code> in <code>/etc/certs/</code></p> <p>To see the private key you can use bellow command <pre><code>keytool -list -v -keystore /etc/certs/jans-auth-keys.p12 -storetype pkcs12 -storepass &lt;password&gt;\n</code></pre></p>","tags":["administration","auth-server","cryptography","keys"]},{"location":"janssen-server/auth-server/endpoints/","title":"Janssen Server Endpoints","text":"<p>Authentication and Authorization features of Janssen Server are exposed to the clients using endpoints. Janssen Server supports all the standard endpoints defined by supported standards.</p> <p>This section covers each endpoint in detail in its separate document. Please navigate through the left navigation panel to see all the supported endpoint documentation.</p>","tags":["administration","auth-server","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/","title":"Access Evaluation Endpoint","text":"<p>The Jans-Auth server implements OpenID AuthZEN Authorization API 1.0 (doc published on 11 January 2026). The AuthZEN Authorization API 1.0 specification defines a standardized interface for communication between Policy Enforcement Points (PEPs) and Policy Decision Points (PDPs) to facilitate consistent authorization decisions across diverse systems. It introduces an Access Evaluation API that allows PEPs to query PDPs about specific access requests, enhancing interoperability and scalability in authorization processes. The specification is transport-agnostic, with an initial focus on HTTPS bindings, and emphasizes secure, fine-grained, and dynamic authorization mechanisms.</p> <p>The Access Evaluation Endpoint in the AuthZEN specification serves as a mechanism for Policy Enforcement Points (PEPs) to request access decisions from a Policy Decision Point (PDP) for specific resources and actions. Upon receiving a request, the endpoint evaluates the subject, resource, and action against defined policies to determine if access should be granted, denied, or if additional information is needed. The endpoint's responses are typically concise, aiming to provide a rapid decision that PEPs can enforce in real-time. The goal is to provide a scalable, secure interface for dynamic and fine-grained access control across applications.</p>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#endpoints-overview","title":"Endpoints Overview","text":"<p>Janssen Server implements the following AuthZEN endpoints:</p> Endpoint Path Description Single Evaluation <code>/access/v1/evaluation</code> Evaluate a single access request Batch Evaluations <code>/access/v1/evaluations</code> Evaluate multiple access requests in one call Search Subject <code>/access/v1/search/subject</code> Search for subjects that have access Search Resource <code>/access/v1/search/resource</code> Search for resources a subject can access Search Action <code>/access/v1/search/action</code> Search for actions a subject can perform Discovery <code>/.well-known/authzen-configuration</code> PDP metadata discovery","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#discovery","title":"Discovery","text":"<p>URL to access the access evaluation endpoint on Janssen Server is listed in both:  - the response of Janssen Server's well-known configuration endpoint given below.  - the response of Janssen Server's <code>/.well-known/authzen-configuration</code> endpoint.</p> <p>OpenID Discovery <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre></p> <p>AuthZEN Discovery <pre><code>https://janssen.server.host/jans-auth/.well-known/authzen-configuration\n</code></pre></p> <p><code>/.well-known/authzen-configuration</code> allows publishing data specific to AuthZEN only. Response of AuthZEN discovery endpoint can be changed via <code>AccessEvaluationDiscoveryType</code> custom script.</p> <p>Sample AuthZEN Discovery Response</p> <pre><code>{\n  \"policy_decision_point\": \"https://janssen.server.host\",\n  \"access_evaluation_endpoint\": \"https://janssen.server.host/jans-auth/restv1/access/v1/evaluation\",\n  \"access_evaluations_endpoint\": \"https://janssen.server.host/jans-auth/restv1/access/v1/evaluations\",\n  \"subject_search_endpoint\": \"https://janssen.server.host/jans-auth/restv1/access/v1/search/subject\",\n  \"resource_search_endpoint\": \"https://janssen.server.host/jans-auth/restv1/access/v1/search/resource\",\n  \"action_search_endpoint\": \"https://janssen.server.host/jans-auth/restv1/access/v1/search/action\",\n  \"capabilities\": []\n}\n</code></pre> <p>Snippet of AccessEvaluationDiscoveryType <pre><code>    @Override\n    public boolean modifyResponse(Object responseAsJsonObject, Object context) {\n        scriptLogger.info(\"write to script logger\");\n        JSONObject response = (JSONObject) responseAsJsonObject;\n        response.accumulate(\"key_from_java\", \"value_from_script_on_java\");\n        return true;\n    }\n</code></pre></p>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#authorization","title":"Authorization","text":"<p>To call Access Evaluation endpoints, the client must have <code>access_evaluation</code> scope. If scope is not present, AS rejects the call with a 401 (unauthorized) HTTP status code. Alternatively, it's possible to use <code>Basic</code> token with encoded client credentials if the <code>accessEvaluationAllowBasicClientAuthorization</code> AS configuration property is set to <code>true</code>.</p> <ul> <li>Bearer token : <code>Authorization: Bearer &lt;access_token&gt;</code></li> <li>Basic authorization : <code>Authorization: Basic &lt;encoded client credentials&gt;</code></li> </ul>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#single-evaluation-endpoint","title":"Single Evaluation Endpoint","text":"<p>The single evaluation endpoint (<code>/access/v1/evaluation</code>) evaluates one access request.</p> <p>Endpoint <pre><code>POST https://janssen.server.host/jans-auth/restv1/access/v1/evaluation\n</code></pre></p> <p>Sample Request <pre><code>POST /jans-auth/restv1/access/v1/evaluation HTTP/1.1\nHost: janssen.server.host\nContent-Type: application/json\nAuthorization: Basic M2NjOTdhYWItMDE0Zi00ZWM5LWI4M2EtNTE3MTRlODE3MDMwOmFlYmMwZWFhLWY5N2YtNDU5NS04ZWExLWFlNmU1NDFmNDZjNg==\n\n{\n  \"subject\": {\n    \"type\": \"user\",\n    \"id\": \"alice@acmecorp.com\"\n  },\n  \"resource\": {\n    \"type\": \"account\",\n    \"id\": \"123\"\n  },\n  \"action\": {\n    \"name\": \"can_read\"\n  },\n  \"context\": {\n    \"ip_address\": \"192.168.1.100\",\n    \"time\": \"2024-01-15T10:30:00Z\"\n  }\n}\n</code></pre></p> <p>Sample Successful Response <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n\n{\n  \"decision\": true,\n  \"context\": {\n    \"id\": \"9e04dd22-e980-4e54-bc04-d64a0c2e1afe\",\n    \"reason_admin\": {\"reason\": \"super_admin\"},\n    \"reason_user\": null\n  }\n}\n</code></pre></p>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#request-fields","title":"Request Fields","text":"Field Type Required Description <code>subject</code> Object Yes The entity requesting access <code>subject.type</code> String Yes Type of the subject (e.g., \"user\", \"service\") <code>subject.id</code> String Yes Unique identifier of the subject <code>resource</code> Object Yes The resource being accessed <code>resource.type</code> String Yes Type of the resource (e.g., \"document\", \"api\") <code>resource.id</code> String Yes Unique identifier of the resource <code>action</code> Object Yes The action being performed <code>action.name</code> String Yes Name of the action (e.g., \"read\", \"write\", \"delete\") <code>context</code> Object No Additional context as key-value pairs","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#context-object","title":"Context Object","text":"<p>The <code>context</code> object is fully dynamic and accepts any key-value pairs. This allows passing arbitrary contextual information such as:</p> <ul> <li>IP address</li> <li>Timestamp</li> <li>Device information</li> <li>Geographic location</li> <li>Custom application-specific data</li> </ul> <pre><code>{\n  \"context\": {\n    \"ip_address\": \"192.168.1.100\",\n    \"time\": \"2024-01-15T10:30:00Z\",\n    \"device_type\": \"mobile\",\n    \"region\": \"us-east-1\",\n    \"custom_field\": \"custom_value\"\n  }\n}\n</code></pre>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#batch-evaluations-endpoint","title":"Batch Evaluations Endpoint","text":"<p>The batch evaluations endpoint (<code>/access/v1/evaluations</code>) allows evaluating multiple access requests in a single call. This is useful for performance optimization when checking multiple permissions at once.</p> <p>Endpoint <pre><code>POST https://janssen.server.host/jans-auth/restv1/access/v1/evaluations\n</code></pre></p> <p>Sample Request <pre><code>POST /jans-auth/restv1/access/v1/evaluations HTTP/1.1\nHost: janssen.server.host\nContent-Type: application/json\nAuthorization: Bearer &lt;access_token&gt;\n\n{\n  \"subject\": {\n    \"type\": \"user\",\n    \"id\": \"alice@acmecorp.com\"\n  },\n  \"resource\": {\n    \"type\": \"document\",\n    \"id\": \"doc-456\"\n  },\n  \"evaluations\": [\n    {\n      \"action\": {\"name\": \"read\"}\n    },\n    {\n      \"action\": {\"name\": \"write\"}\n    },\n    {\n      \"action\": {\"name\": \"delete\"},\n      \"resource\": {\"type\": \"document\", \"id\": \"doc-789\"}\n    }\n  ],\n  \"options\": {\n    \"evaluations_semantic\": \"execute_all\"\n  }\n}\n</code></pre></p> <p>Sample Response <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n\n{\n  \"evaluations\": [\n    {\"decision\": true, \"context\": {\"id\": \"eval-1\"}},\n    {\"decision\": true, \"context\": {\"id\": \"eval-2\"}},\n    {\"decision\": false, \"context\": {\"id\": \"eval-3\"}}\n  ]\n}\n</code></pre></p>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#batch-request-fields","title":"Batch Request Fields","text":"<p>The batch request supports default values for <code>subject</code>, <code>resource</code>, <code>action</code>, and <code>context</code> at the top level. Individual evaluations can override these defaults.</p> Field Type Required Description <code>subject</code> Object No Default subject for all evaluations <code>resource</code> Object No Default resource for all evaluations <code>action</code> Object No Default action for all evaluations <code>context</code> Object No Default context for all evaluations <code>evaluations</code> Array Yes Array of individual evaluation requests <code>options</code> Object No Evaluation options","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#evaluation-options","title":"Evaluation Options","text":"<p>The <code>options</code> object controls how batch evaluations are processed:</p> Option Values Description <code>evaluations_semantic</code> <code>execute_all</code> Execute all evaluations regardless of results (default) <code>deny_on_first_deny</code> Stop processing on first deny result <code>permit_on_first_permit</code> Stop processing on first permit result <p>Example with short-circuit evaluation: <pre><code>{\n  \"evaluations\": [...],\n  \"options\": {\n    \"evaluations_semantic\": \"deny_on_first_deny\"\n  }\n}\n</code></pre></p>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#search-endpoints","title":"Search Endpoints","text":"<p>Search endpoints allow discovering which subjects, resources, or actions satisfy given access criteria. These endpoints are useful for building UI components that show available permissions.</p>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#search-subject","title":"Search Subject","text":"<p>Find subjects that have access to a specific resource and action.</p> <p>Endpoint <pre><code>POST https://janssen.server.host/jans-auth/restv1/access/v1/search/subject\n</code></pre></p> <p>Sample Request <pre><code>{\n  \"subject\": {\n    \"type\": \"user\"\n  },\n  \"resource\": {\n    \"type\": \"document\",\n    \"id\": \"doc-123\"\n  },\n  \"action\": {\n    \"name\": \"read\"\n  },\n  \"page\": {\n    \"limit\": 10\n  }\n}\n</code></pre></p>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#search-resource","title":"Search Resource","text":"<p>Find resources that a subject can access with a specific action.</p> <p>Endpoint <pre><code>POST https://janssen.server.host/jans-auth/restv1/access/v1/search/resource\n</code></pre></p> <p>Sample Request <pre><code>{\n  \"subject\": {\n    \"type\": \"user\",\n    \"id\": \"alice@acmecorp.com\"\n  },\n  \"resource\": {\n    \"type\": \"document\"\n  },\n  \"action\": {\n    \"name\": \"read\"\n  },\n  \"page\": {\n    \"limit\": 10\n  }\n}\n</code></pre></p>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#search-action","title":"Search Action","text":"<p>Find actions that a subject can perform on a specific resource.</p> <p>Endpoint <pre><code>POST https://janssen.server.host/jans-auth/restv1/access/v1/search/action\n</code></pre></p> <p>Sample Request <pre><code>{\n  \"subject\": {\n    \"type\": \"user\",\n    \"id\": \"alice@acmecorp.com\"\n  },\n  \"resource\": {\n    \"type\": \"document\",\n    \"id\": \"doc-123\"\n  },\n  \"page\": {\n    \"limit\": 10\n  }\n}\n</code></pre></p>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#search-response","title":"Search Response","text":"<p>All search endpoints return paginated results:</p> <pre><code>{\n  \"results\": [\n    {\"type\": \"user\", \"id\": \"alice\"},\n    {\"type\": \"user\", \"id\": \"bob\"}\n  ],\n  \"page\": {\n    \"next_token\": \"abc123\",\n    \"count\": 2,\n    \"total\": 50\n  }\n}\n</code></pre>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#error-responses","title":"Error Responses","text":"<p>401 Unauthorized <pre><code>{\n  \"error\": \"invalid_token\"\n}\n</code></pre></p> <p>400 Bad Request <pre><code>{\n  \"error\": \"invalid_request\",\n  \"error_description\": \"Subject is required\"\n}\n</code></pre></p>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#configuration-properties","title":"Configuration Properties","text":"<p>Access Evaluation Endpoint AS configuration:</p> <ul> <li>accessEvaluationScriptName - Access evaluation custom script name. If not set AS falls back to first valid script found in database.</li> <li>accessEvaluationAllowBasicClientAuthorization - Allow basic client authorization for access evaluation endpoint.</li> </ul>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#custom-script","title":"Custom Script","text":"<p>AS provides <code>AccessEvaluationType</code> custom script which must be used to control Access Evaluation Endpoint behavior.</p> <p>Use <code>accessEvaluationScriptName</code> configuration property to specify custom script. If not set AS falls back to first valid script found in database.</p> <p>The script interface provides the following methods:</p> Method Description <code>evaluate(request, context)</code> Main evaluation logic for single evaluation <code>searchSubject(request, context)</code> Handle subject search requests <code>searchResource(request, context)</code> Handle resource search requests <code>searchAction(request, context)</code> Handle action search requests","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#sample-evaluation-script","title":"Sample Evaluation Script","text":"<pre><code>@Override\npublic AccessEvaluationResponse evaluate(AccessEvaluationRequest request, Object scriptContext) {\n\n    ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n    // 1. access http request via context.getHttpRequest()\n    // 2. access all access evaluation specific data directly with 'request', e.g. request.getSubject()\n\n    // 3. perform custom validation if needed\n    validateResource(request.getResource());\n\n    // typically some internal validation must be performed here\n    // request data alone must not be trusted, it's just sample to demo script with endpoint\n    if (\"super_admin\".equalsIgnoreCase(request.getSubject().getType())) {\n        final ObjectNode reasonAdmin = objectMapper.createObjectNode();\n        reasonAdmin.put(\"reason\", \"super_admin\");\n\n        final AccessEvaluationResponseContext responseContext = new AccessEvaluationResponseContext();\n        responseContext.setId(UUID.randomUUID().toString());\n        responseContext.setReasonAdmin(reasonAdmin);\n\n        return new AccessEvaluationResponse(true, responseContext);\n    }\n    return AccessEvaluationResponse.FALSE;\n}\n</code></pre> <p>More details in Access Evaluation Custom Script Page.</p> <p>Full sample script can be found here</p>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/access-evaluation/#full-successful-access-evaluation-flow-sample","title":"Full Successful Access Evaluation Flow Sample","text":"<pre><code>#######################################################\nTEST: OpenID Connect Discovery\n#######################################################\n-------------------------------------------------------\nREQUEST:\n-------------------------------------------------------\nGET /.well-known/webfinger HTTP/1.1?resource=acct%3Aadmin%40happy-example.gluu.info&amp;rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer HTTP/1.1\nHost: happy-example.gluu.info\n\n-------------------------------------------------------\nRESPONSE:\n-------------------------------------------------------\nHTTP/1.1 200\nContent-Type: application/jrd+json;charset=iso-8859-1\n\n{\n    \"subject\": \"acct:admin@happy-example.gluu.info\",\n    \"links\": [{\n        \"rel\": \"http://openid.net/specs/connect/1.0/issuer\",\n        \"href\": \"https://happy-example.gluu.info\"\n    }]\n}\n\n\n#######################################################\nTEST: accessEvaluation_whenSubjectTypeIsAcceptedByScript_shouldGrantAccess\n#######################################################\n-------------------------------------------------------\nREQUEST:\n-------------------------------------------------------\nPOST /jans-auth/restv1/access/v1/evaluation HTTP/1.1\nHost: happy-example.gluu.info\nContent-Type: application/json\nAuthorization: Basic M2NjOTdhYWItMDE0Zi00ZWM5LWI4M2EtNTE3MTRlODE3MDMwOmFlYmMwZWFhLWY5N2YtNDU5NS04ZWExLWFlNmU1NDFmNDZjNg==\n\n{\n  \"subject\": {\n    \"type\": \"super_admin\",\n    \"id\": \"alice@acmecorp.com\"\n  },\n  \"resource\": {\n    \"type\": \"account\",\n    \"id\": \"123\"\n  },\n  \"action\": {\n    \"name\": \"can_read\"\n  },\n  \"context\": {\n    \"ip_address\": \"192.168.1.1\"\n  }\n}\n\n-------------------------------------------------------\nRESPONSE:\n-------------------------------------------------------\nHTTP/1.1 200\nContent-Type: application/json\n\n{\n  \"decision\": true,\n  \"context\": {\n    \"id\": \"9e04dd22-e980-4e54-bc04-d64a0c2e1afe\",\n    \"reason_admin\": {\"reason\": \"super_admin\"},\n    \"reason_user\": null\n  }\n}\n</code></pre>","tags":["administration","auth-server","access-evaluation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/archived-jwks-uri/","title":"Archived JWKS URI Endpoint","text":"<p>Janssen Server supports <code>/jwks/archived/{kid}</code> metadata endpoint and publishes its Archived JSON Web Keys (JWKs) at this endpoint. This endpoint publishes expired signing keys as well as expired encryption keys used by Janssen Server. RP can use these keys to validate signatures from Janssen Server, and also to perform encryption and decryption if keys are no longer present in <code>/jwks</code> endpoint. Like other metadata endpoints, this is not a secure endpoint.</p> <p>URL to access archived jwks endpoint on Janssen Server is listed in the response of Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p><code>archived_jwks_uri</code> claim in the response specifies the URL for archived jwks endpoint. By default, the archived jwks endpoint looks like below:</p> <pre><code>https://janssen.server.host/jans-auth/restv1/jwks/archived/{kid}\n</code></pre> <p>This endpoint is always enabled and can not be disabled using feature flags.</p>","tags":["administration","auth-server","jwks","json-web-key-set","endpoint"]},{"location":"janssen-server/auth-server/endpoints/archived-jwks-uri/#configuration-properties","title":"Configuration Properties","text":"<p>Archived JWKs endpoint can be further configured using Janssen Server configuration properties listed below. When using Janssen Text-based UI(TUI) to configure the properties, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>.</p> <ul> <li>archivedJwksUri</li> <li>archivedJwkLifetimeInSeconds</li> </ul> <p>If <code>archivedJwkLifetimeInSeconds</code> is not set then AS falls back to one year expiration. After archived jwk lifetime is passed, jwk is removed from archive.</p>","tags":["administration","auth-server","jwks","json-web-key-set","endpoint"]},{"location":"janssen-server/auth-server/endpoints/archived-jwks-uri/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","jwks","json-web-key-set","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization-challenge/","title":"Authorization Challenge Endpoint","text":"<p>Authorization Challenge Endpoint allows first-party native client obtain authorization code which later can be exchanged on access token. This can provide an entirely browserless OAuth 2.0 experience suited for native applications.</p> <p>This endpoint conforms to OAuth 2.0 for First-Party Applications specifications.</p> <p>URL to access authorization challenge endpoint on Janssen Server is listed in the response of Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p><code>authorization_challenge_endpoint</code> claim in the response specifies the URL for authorization challenge endpoint. By default, authorization challenge endpoint looks like below:</p> <pre><code>https://janssen.server.host/jans-auth/restv1/authorize-challenge\n</code></pre> <p>To call Authorization Challenge Endpoint, client must have <code>authorization_challenge</code> scope. If scope is not present, AS rejects the call with a 401 (unauthorized) HTTP status code.</p> <p>Authorization Challenge Endpoint supports Proof Key for Code Exchange (PKCE).</p> <p>More information about request and response of the authorization challenge endpoint can be found in the OpenAPI specification of jans-auth-server module.</p> <p>Sample request <pre><code>POST /authorize HTTP/1.1\nHost: server.example.com\nContent-Type: application/x-www-form-urlencoded\n\nlogin_hint=%2B1-310-123-4567&amp;scope=profile\n&amp;client_id=bb16c14c73415\n</code></pre></p> <p>Sample successful response with <code>authorization_code</code>. <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json;charset=UTF-8\nCache-Control: no-store\n\n{\n  \"authorization_code\": \"uY29tL2F1dGhlbnRpY\"\n}\n</code></pre></p> <p>Sample error response <pre><code>HTTP/1.1 401 Unauthorized\nContent-Type: application/json\nCache-Control: no-store\n\n{\n  \"error\": \"username_required\"\n}\n</code></pre></p>","tags":["administration","auth-server","authorization-challenge","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization-challenge/#configuration-properties","title":"Configuration Properties","text":"<p>Authorization Challenge Endpoint AS configuration:</p> <ul> <li>authorizationChallengeEndpoint - The authorization challenge endpoint URL</li> <li>authorizationChallengeDefaultAcr - Authorization Challenge Endpoint Default ACR if no value is specified in acr_values request parameter. Default value is <code>default_challenge</code>.</li> <li>authorizationChallengeShouldGenerateSession - Boolean value specifying whether to generate session_id (AS object and cookie) during authorization at Authorization Challenge Endpoint. Default value is <code>false</code>.</li> <li>mtlsAuthorizationChallengeEndpoint - URL for Mutual TLS (mTLS) Client Authentication and Certificate-Bound Access Tokens (MTLS) Authorization Challenge Endpoint.</li> </ul>","tags":["administration","auth-server","authorization-challenge","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization-challenge/#custom-script","title":"Custom script","text":"<p>AS provides <code>AuthorizationChallengeType</code> custom script which must be used to control Authorization Challenge Endpoint behaviour.</p> <p>If request does not have <code>acr_values</code> specified and script name falls back to <code>default_challenge</code> which is available and enabled during installation. Default script name can be changed via <code>authorizationChallengeDefaultAcr</code> configuration property.</p> <p>Main method return true/false which indicates to server whether to issue <code>authorization_code</code> in response or not.</p> <p>If parameters is not present then error has to be created and <code>false</code> returned. If all is good script has to return <code>true</code> and it's strongly recommended to set user <code>context.getExecutionContext().setUser(user);</code> so AS can keep tracking what exactly user is authenticated.</p> <p>Please see following snippet below:</p> <pre><code>    public boolean authorize(Object scriptContext) {\n        ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n\n        // 1. validate all required parameters are present\n        final String username = getParameterOrCreateError(context, USERNAME_PARAMETER);\n        if (StringUtils.isBlank(username)) {\n            return false;\n        }\n\n        final String password = getParameterOrCreateError(context, PASSWORD_PARAMETER);\n        if (StringUtils.isBlank(password)) {\n            return false;\n        }\n\n        scriptLogger.trace(\"All required parameters are present\");\n\n        // 2. main authorization logic, if ok -&gt; set authorized user into \"context.getExecutionContext().setUser(user);\" and return true\n        UserService userService = CdiUtil.bean(UserService.class);\n        PersistenceEntryManager entryManager = CdiUtil.bean(PersistenceEntryManager.class);\n\n        final User user = userService.getUser(username);\n        if (user == null) {\n            scriptLogger.trace(\"User is not found by username {}\", username);\n            createError(context, \"username_invalid\");\n            return false;\n        }\n\n        final boolean ok = entryManager.authenticate(user.getDn(), User.class, password);\n        if (ok) {\n            context.getExecutionContext().setUser(user); // &lt;- IMPORTANT : without user set, user relation will not be associated with token\n            scriptLogger.trace(\"User {} is authenticated successfully.\", username);\n            return true;\n        }\n\n        // 3. not ok -&gt; set error which explains what is wrong and return false\n        scriptLogger.trace(\"Failed to authenticate user {}. Please check username and password.\", username);\n        createError(context, \"username_or_password_invalid\");\n        return false;\n    }\n</code></pre> <p>More details in Authorization Challenge Custom Script Page</p> <p>Full sample script can be found here</p>","tags":["administration","auth-server","authorization-challenge","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization-challenge/#auth-session","title":"Auth session","text":"<p>Auth session is optional. AS does not return it by default. It's possible to pass in request <code>use_auth_session=true</code> which makes AS return it in error response. If it is desired to use <code>auth_session</code> and don't pass <code>client_id</code> (or other parameters) in next request, it should be put in attributes of <code>auth_session</code> object. <code>auth_session</code> object lifetime is set by <code>authorizationChallengeSessionLifetimeInSeconds</code> AS configuration property. If <code>authorizationChallengeSessionLifetimeInSeconds</code> is not set then value falls back to <code>86400</code> seconds.</p> <p>Example</p> <pre><code>String clientId = context.getHttpRequest().getParameter(\"client_id\");\nauthorizationChallengeSessionObject.getAttributes().getAttributes().put(\"client_id\", clientId);\n</code></pre> <p>AS automatically validates DPoP if it is set during auth session creation. Thus it's recommended to set <code>jkt</code> of the auth session if DPoP is used. <pre><code>final String dpop = context.getHttpRequest().getHeader(DpopService.DPOP);\nif (StringUtils.isNotBlank(dpop)) {\n    authorizationChallengeSessionObject.getAttributes().setJkt(getDpopJkt(dpop));\n}\n</code></pre></p> <p>Full sample script can be found here</p>","tags":["administration","auth-server","authorization-challenge","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization-challenge/#web-session","title":"Web session","text":"<p>Authorization challenge script is first-party flow and thus web session is not created by default. However there can be cases when such session has to be created. Please set authorizationChallengeShouldGenerateSession configuration property to true to force session creation.</p> <p>In case it is needed to prepare session with specific data, it is possible to create session in script and set it into context. Example:</p> <pre><code>SessionIdService sessionIdService = CdiUtil.bean(SessionIdService.class);\nIdentity identityService = CdiUtil.bean(Identity.class);\n\nMap&lt;String, String&gt; sessionStore = new HashMap&lt;String, String&gt;();\nsessionStore.put(\"login_id_token\",login_id_token);\nsessionStore.put(\"login_access_token\",login_access_token);\nsessionStore.put(\"transaction_status\",\"PENDING\");\nSessionId sessionId = sessionIdService.generateAuthenticatedSessionId(context.getHttpRequest(), user.getDn(), sessionStore);\n\ncontext.getExecutionContext().setAuthorizationChallengeSessionId(sessionId);\nscriptLogger.trace(\"Created Authorization challenge session successfully\");\n</code></pre>","tags":["administration","auth-server","authorization-challenge","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization-challenge/#multi-step-example","title":"Multi-step example","text":"<p>Sometimes it's required to send data sequentially. Step by step. Calls to Authorization Challenge Endpoint must have <code>use_auth_session=true</code> parameter to force tracking data between request.</p> <p>Lets consider example when RP first sends <code>username</code> and then in next request <code>OTP</code>.</p> <pre><code>POST /jans-auth/restv1/authorize-challenge HTTP/1.1\nHost: server.example.com\nContent-Type: application/x-www-form-urlencoded\n\nusername=alice\n&amp;scope=photos\n&amp;client_id=bb16c14c73415\n</code></pre> <p>AS accepts <code>username</code> and returns back error with <code>auth_session</code>.</p> <pre><code>HTTP/1.1 401 Unauthorized\nContent-Type: application/json\nCache-Control: no-store\n\n{\n  \"error\": \"otp_required\",\n  \"auth_session\": \"ce6772f5e07bc8361572f\"\n}\n</code></pre> <p>In next call RP can send OTP and <code>auth_session</code> (AS matches user from <code>auth_session</code>)</p> <pre><code>POST /jans-auth/restv1/authorize-challenge HTTP/1.1\nHost: server.example.com\nContent-Type: application/x-www-form-urlencoded\n\notp=ccnnju667d&amp;auth_session=ce6772f5e07bc8361572f\n</code></pre> <p>In custom script it's easy to code what data has to be kept in <code>auth_session</code>.</p> <pre><code>    private void createError(ExternalScriptContext context, String errorCode) {\n        String deviceSessionPart = prepareDeviceSessionSubJson(context);\n\n        final String entity = String.format(\"{\\\"error\\\": \\\"%s\\\"%s}\", errorCode, deviceSessionPart);\n        context.createWebApplicationException(401, entity);\n    }\n\n    private String prepareDeviceSessionSubJson(ExternalScriptContext context) {\n        DeviceSession authorizationChallengeSessionObject = context.getAuthzRequest().getDeviceSessionObject();\n        if (authorizationChallengeSessionObject != null) {\n            prepareDeviceSession(context, authorizationChallengeSessionObject);\n            return String.format(\",\\\"auth_session\\\":\\\"%s\\\"\", authorizationChallengeSessionObject.getId());\n        } else if (context.getAuthzRequest().isUseDeviceSession()) {\n            authorizationChallengeSessionObject = prepareDeviceSession(context, null);\n            return String.format(\",\\\"auth_session\\\":\\\"%s\\\"\", authorizationChallengeSessionObject.getId());\n        }\n        return \"\";\n    }\n\n    private DeviceSession prepareDeviceSession(ExternalScriptContext context, DeviceSession authorizationChallengeSessionObject) {\n        DeviceSessionService deviceSessionService = CdiUtil.bean(DeviceSessionService.class);\n        boolean newSave = authorizationChallengeSessionObject == null;\n        if (newSave) {\n            authorizationChallengeSessionObject = deviceSessionService.newDeviceSession();\n        }\n\n        String username = context.getHttpRequest().getParameter(USERNAME_PARAMETER);\n        if (StringUtils.isNotBlank(username)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(USERNAME_PARAMETER, username);\n        }\n\n        String otp = context.getHttpRequest().getParameter(OTP_PARAMETER);\n        if (StringUtils.isNotBlank(otp)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(OTP_PARAMETER, otp);\n        }\n\n        String clientId = context.getHttpRequest().getParameter(\"client_id\");\n        if (StringUtils.isNotBlank(clientId)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(\"client_id\", clientId);\n        }\n\n        String acrValues = context.getHttpRequest().getParameter(\"acr_values\");\n        if (StringUtils.isNotBlank(acrValues)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(\"acr_values\", acrValues);\n        }\n\n        if (newSave) {\n            deviceSessionService.persist(authorizationChallengeSessionObject);\n        } else {\n            deviceSessionService.merge(authorizationChallengeSessionObject);\n        }\n\n        return authorizationChallengeSessionObject;\n    }\n</code></pre> <p>More details in Authorization Challenge Custom Script Page.</p> <p>Full multi-step sample script can be found here</p>","tags":["administration","auth-server","authorization-challenge","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization-challenge/#full-successful-authorization-challenge-flow-sample","title":"Full successful Authorization Challenge Flow sample","text":"<pre><code>OpenID Connect Configuration\n-------------------------------------------------------\nREQUEST:\n-------------------------------------------------------\nGET /.well-known/openid-configuration HTTP/1.1 HTTP/1.1\nHost: yuriyz-fond-skink.gluu.info\n\n-------------------------------------------------------\nRESPONSE:\n-------------------------------------------------------\nHTTP/1.1 200\nConnection: Keep-Alive\nContent-Length: 6244\nContent-Type: application/json\nDate: Thu, 10 Aug 2023 11:53:04 GMT\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\nKeep-Alive: timeout=5, max=100\nServer: Apache/2.4.41 (Ubuntu)\nSet-Cookie: X-Correlation-Id=fa097a44-5568-48aa-9390-1880616e5a69; Secure; HttpOnly;HttpOnly\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nX-Content-Type-Options: nosniff\nX-Xss-Protection: 1; mode=block\n\n{\n  \"request_parameter_supported\" : true,\n  \"pushed_authorization_request_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/par\",\n  \"introspection_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/introspection\",\n  \"claims_parameter_supported\" : false,\n  \"issuer\" : \"https://yuriyz-fond-skink.gluu.info\",\n  \"userinfo_encryption_enc_values_supported\" : [ \"A128CBC+HS256\", \"A256CBC+HS512\", \"A128GCM\", \"A256GCM\" ],\n  \"id_token_encryption_enc_values_supported\" : [ \"A128CBC+HS256\", \"A256CBC+HS512\", \"A128GCM\", \"A256GCM\" ],\n  \"access_token_signing_alg_values_supported\" : [ \"none\", \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"authorization_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/authorize\",\n  \"service_documentation\" : \"http://jans.org/docs\",\n  \"authorization_encryption_alg_values_supported\" : [ \"RSA1_5\", \"RSA-OAEP\", \"A128KW\", \"A256KW\" ],\n  \"claims_supported\" : [ \"street_address\", \"country\", \"zoneinfo\", \"birthdate\", \"role\", \"gender\", \"formatted\", \"user_name\", \"phone_mobile_number\", \"preferred_username\", \"locale\", \"inum\", \"updated_at\", \"post_office_box\", \"nickname\", \"preferred_language\", \"email\", \"website\", \"email_verified\", \"profile\", \"locality\", \"phone_number_verified\", \"room_number\", \"given_name\", \"middle_name\", \"picture\", \"name\", \"phone_number\", \"postal_code\", \"region\", \"family_name\", \"jansAdminUIRole\" ],\n  \"ssa_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/ssa\",\n  \"token_endpoint_auth_methods_supported\" : [ \"client_secret_basic\", \"client_secret_post\", \"client_secret_jwt\", \"private_key_jwt\", \"tls_client_auth\", \"self_signed_tls_client_auth\" ],\n  \"tls_client_certificate_bound_access_tokens\" : true,\n  \"response_modes_supported\" : [ \"query\", \"jwt\", \"query.jwt\", \"form_post.jwt\", \"form_post\", \"fragment\", \"fragment.jwt\" ],\n  \"backchannel_logout_session_supported\" : true,\n  \"token_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/token\",\n  \"response_types_supported\" : [ \"code\", \"code id_token token\", \"id_token\", \"code id_token\", \"token\", \"id_token token\", \"code token\" ],\n  \"authorization_encryption_enc_values_supported\" : [ \"A128CBC+HS256\", \"A256CBC+HS512\", \"A128GCM\", \"A256GCM\" ],\n  \"backchannel_token_delivery_modes_supported\" : [ \"poll\", \"ping\", \"push\" ],\n  \"dpop_signing_alg_values_supported\" : [ \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"request_uri_parameter_supported\" : true,\n  \"backchannel_user_code_parameter_supported\" : false,\n  \"grant_types_supported\" : [ \"client_credentials\", \"urn:ietf:params:oauth:grant-type:uma-ticket\", \"urn:ietf:params:oauth:grant-type:device_code\", \"urn:ietf:params:oauth:grant-type:token-exchange\", \"implicit\", \"authorization_code\", \"password\", \"refresh_token\" ],\n  \"ui_locales_supported\" : [ \"en\", \"bg\", \"de\", \"es\", \"fr\", \"it\", \"ru\", \"tr\" ],\n  \"userinfo_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/userinfo\",\n  \"authorization_challenge_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/authorize-challenge\",\n  \"op_tos_uri\" : \"https://yuriyz-fond-skink.gluu.info/tos\",\n  \"require_request_uri_registration\" : false,\n  \"id_token_encryption_alg_values_supported\" : [ \"RSA1_5\", \"RSA-OAEP\", \"A128KW\", \"A256KW\" ],\n  \"frontchannel_logout_session_supported\" : true,\n  \"authorization_signing_alg_values_supported\" : [ \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"claims_locales_supported\" : [ \"en\" ],\n  \"clientinfo_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/clientinfo\",\n  \"request_object_signing_alg_values_supported\" : [ \"none\", \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"request_object_encryption_alg_values_supported\" : [ \"RSA1_5\", \"RSA-OAEP\", \"A128KW\", \"A256KW\" ],\n  \"key_from_java\" : \"value_from_script_on_java\",\n  \"check_session_iframe\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/opiframe.htm\",\n  \"scopes_supported\" : [ \"address\", \"introspection\", \"https://jans.io/auth/ssa.admin\", \"online_access\", \"openid\", \"user_name\", \"clientinfo\", \"profile\", \"uma_protection\", \"permission\", \"https://jans.io/scim/users.write\", \"revoke_session\", \"https://jans.io/scim/users.read\", \"device_sso\", \"phone\", \"mobile_phone\", \"offline_access\", \"email\" ],\n  \"backchannel_logout_supported\" : true,\n  \"acr_values_supported\" : [ \"simple_password_auth\" ],\n  \"request_object_encryption_enc_values_supported\" : [ \"A128CBC+HS256\", \"A256CBC+HS512\", \"A128GCM\", \"A256GCM\" ],\n  \"device_authorization_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/device_authorization\",\n  \"display_values_supported\" : [ \"page\", \"popup\" ],\n  \"userinfo_signing_alg_values_supported\" : [ \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"require_pushed_authorization_requests\" : false,\n  \"claim_types_supported\" : [ \"normal\" ],\n  \"userinfo_encryption_alg_values_supported\" : [ \"RSA1_5\", \"RSA-OAEP\", \"A128KW\", \"A256KW\" ],\n  \"end_session_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/end_session\",\n  \"revocation_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/revoke\",\n  \"backchannel_authentication_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/bc-authorize\",\n  \"token_endpoint_auth_signing_alg_values_supported\" : [ \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"frontchannel_logout_supported\" : true,\n  \"jwks_uri\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/jwks\",\n  \"subject_types_supported\" : [ \"public\", \"pairwise\" ],\n  \"id_token_signing_alg_values_supported\" : [ \"none\", \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"registration_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/register\",\n  \"id_token_token_binding_cnf_values_supported\" : [ \"tbh\" ]\n}\n\n\n#######################################################\nTEST: authorizationChallengeFlow\n#######################################################\n-------------------------------------------------------\nREQUEST:\n-------------------------------------------------------\nPOST /jans-auth/restv1/register HTTP/1.1\nHost: yuriyz-fond-skink.gluu.info\nContent-Type: application/json\nAccept: application/json\n\n{\n  \"grant_types\" : [ \"authorization_code\", \"refresh_token\" ],\n  \"subject_type\" : \"public\",\n  \"application_type\" : \"web\",\n  \"scope\" : \"openid profile address email phone user_name\",\n  \"minimum_acr_priority_list\" : [ ],\n  \"redirect_uris\" : [ \"https://yuriyz-fond-skink.gluu.info/jans-auth-rp/home.htm\", \"https://client.example.com/cb\", \"https://client.example.com/cb1\", \"https://client.example.com/cb2\" ],\n  \"client_name\" : \"jans test app\",\n  \"additional_audience\" : [ ],\n  \"response_types\" : [ \"code\", \"id_token\" ]\n}\n\n-------------------------------------------------------\nRESPONSE:\n-------------------------------------------------------\nHTTP/1.1 201\nCache-Control: no-store\nConnection: Keep-Alive\nContent-Length: 1633\nContent-Type: application/json\nDate: Thu, 10 Aug 2023 11:53:05 GMT\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\nKeep-Alive: timeout=5, max=100\nPragma: no-cache\nServer: Apache/2.4.41 (Ubuntu)\nSet-Cookie: X-Correlation-Id=81dc6c45-7831-4738-b169-b087ee9a6bd6; Secure; HttpOnly;HttpOnly\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nX-Content-Type-Options: nosniff\nX-Xss-Protection: 1; mode=block\n\n{\n    \"allow_spontaneous_scopes\": false,\n    \"application_type\": \"web\",\n    \"rpt_as_jwt\": false,\n    \"registration_client_uri\": \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/register?client_id=999e13b8-f4a2-4fed-ad3c-6c88bd2c92ea\",\n    \"tls_client_auth_subject_dn\": \"\",\n    \"run_introspection_script_before_jwt_creation\": false,\n    \"registration_access_token\": \"28a50db3-b6d1-4054-a259-ef7168afa760\",\n    \"client_id\": \"999e13b8-f4a2-4fed-ad3c-6c88bd2c92ea\",\n    \"token_endpoint_auth_method\": \"client_secret_basic\",\n    \"scope\": \"openid\",\n    \"client_secret\": \"f6364c5c-295d-4e6e-bb40-6ad3a47b2119\",\n    \"client_id_issued_at\": 1691668385,\n    \"backchannel_logout_uri\": \"\",\n    \"backchannel_logout_session_required\": false,\n    \"client_name\": \"jans test app\",\n    \"par_lifetime\": 600,\n    \"spontaneous_scopes\": [],\n    \"id_token_signed_response_alg\": \"RS256\",\n    \"access_token_as_jwt\": false,\n    \"grant_types\": [\n        \"authorization_code\",\n        \"refresh_token\"\n    ],\n    \"subject_type\": \"public\",\n    \"additional_token_endpoint_auth_methods\": [],\n    \"keep_client_authorization_after_expiration\": false,\n    \"require_par\": false,\n    \"redirect_uris\": [\n        \"https://client.example.com/cb2\",\n        \"https://client.example.com/cb1\",\n        \"https://client.example.com/cb\",\n        \"https://yuriyz-fond-skink.gluu.info/jans-auth-rp/home.htm\"\n    ],\n    \"redirect_uris_regex\": \"\",\n    \"additional_audience\": [],\n    \"frontchannel_logout_session_required\": false,\n    \"client_secret_expires_at\": 1691704385,\n    \"access_token_signing_alg\": \"RS256\",\n    \"response_types\": [\n        \"code\",\n        \"id_token\"\n    ]\n}\n\n-------------------------------------------------------\nREQUEST:\n-------------------------------------------------------\nPOST /jans-auth/restv1/authorize-challenge HTTP/1.1\nHost: yuriyz-fond-skink.gluu.info\n\nclient_id=999e13b8-f4a2-4fed-ad3c-6c88bd2c92ea&amp;scope=openid+profile+address+email+phone+user_name&amp;state=b4a41b29-51c8-4354-9c8c-fda38b4dbd43&amp;nonce=3a56f8d0-f78e-4b15-857c-3e792801be68&amp;prompt=&amp;ui_locales=&amp;claims_locales=&amp;acr_values=&amp;request_session_id=false&amp;password=secret&amp;username=admin\n\n-------------------------------------------------------\nRESPONSE:\n-------------------------------------------------------\nHTTP/1.1 200\nCache-Control: no-transform, no-store\nConnection: Keep-Alive\nContent-Length: 61\nContent-Type: application/json\nDate: Thu, 10 Aug 2023 11:53:06 GMT\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\nKeep-Alive: timeout=5, max=100\nServer: Apache/2.4.41 (Ubuntu)\nSet-Cookie: X-Correlation-Id=3aa95eb7-73e2-40ae-9303-34adf30a1a05; Secure; HttpOnly;HttpOnly\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nX-Content-Type-Options: nosniff\nX-Xss-Protection: 1; mode=block\n\n{\"authorization_code\":\"9e3dc65b-937a-49c2-bdff-41fbc1a352d0\"}\n\nSuccessfully obtained authorization code 9e3dc65b-937a-49c2-bdff-41fbc1a352d0 at Authorization Challenge Endpoint\n-------------------------------------------------------\nREQUEST:\n-------------------------------------------------------\nPOST /jans-auth/restv1/token HTTP/1.1\nHost: yuriyz-fond-skink.gluu.info\nContent-Type: application/x-www-form-urlencoded\nAuthorization: Basic OTk5ZTEzYjgtZjRhMi00ZmVkLWFkM2MtNmM4OGJkMmM5MmVhOmY2MzY0YzVjLTI5NWQtNGU2ZS1iYjQwLTZhZDNhNDdiMjExOQ==\n\ngrant_type=authorization_code&amp;code=9e3dc65b-937a-49c2-bdff-41fbc1a352d0&amp;redirect_uri=https%3A%2F%2Fyuriyz-fond-skink.gluu.info%2Fjans-auth-rp%2Fhome.htm\n\n-------------------------------------------------------\nRESPONSE:\n-------------------------------------------------------\nHTTP/1.1 200\nCache-Control: no-store\nConnection: Keep-Alive\nContent-Length: 1250\nContent-Type: application/json\nDate: Thu, 10 Aug 2023 11:53:06 GMT\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\nKeep-Alive: timeout=5, max=100\nPragma: no-cache\nServer: Apache/2.4.41 (Ubuntu)\nSet-Cookie: X-Correlation-Id=3eb3c205-6206-4a70-98fb-75bf81757976; Secure; HttpOnly;HttpOnly\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nX-Content-Type-Options: nosniff\nX-Xss-Protection: 1; mode=block\n\n{\"access_token\":\"d87aa8d2-fefb-4d16-a775-9b9d27f73bfc\",\"refresh_token\":\"505314a7-05f5-4c9f-8900-ccb0685dea17\",\"id_token\":\"eyJraWQiOiJjb25uZWN0XzI1OGZmMmFiLWE4ODQtNDIxNy1iNmQ4LTJhMGI2NDhmOTcxZF9zaWdfcnMyNTYiLCJ0eXAiOiJqd3QiLCJhbGciOiJSUzI1NiJ9.eyJhdF9oYXNoIjoiUC04RktlejhlNHROTURTbVlGeHV5dyIsInN1YiI6IjI1Nzg0ZDQ5LTg0ZjMtNGIyNi1hZWUyLTEwNDkzMzM5MjMyZCIsImFtciI6W10sImlzcyI6Imh0dHBzOi8veXVyaXl6LWZvbmQtc2tpbmsuZ2x1dS5pbmZvIiwibm9uY2UiOiIzYTU2ZjhkMC1mNzhlLTRiMTUtODU3Yy0zZTc5MjgwMWJlNjgiLCJqYW5zT3BlbklEQ29ubmVjdFZlcnNpb24iOiJvcGVuaWRjb25uZWN0LTEuMCIsImF1ZCI6Ijk5OWUxM2I4LWY0YTItNGZlZC1hZDNjLTZjODhiZDJjOTJlYSIsInJhbmRvbSI6ImJmYmI5OTBmLWNkYTEtNGM3OC1hNjM4LWFhN2NiMjc5MjU3MiIsImFjciI6ImRlZmF1bHRfY2hhbGxlbmdlIiwiY19oYXNoIjoiTnFoSGFIenZZYjYxeDFackQwUEZVdyIsImF1dGhfdGltZSI6MTY5MTY2ODM4NiwiZXhwIjoxNjkxNjcxOTg2LCJncmFudCI6ImF1dGhvcml6YXRpb25fY29kZSIsImlhdCI6MTY5MTY2ODM4Nn0.QTUmzJaHtbPGjrV4E0MUn_fU1On44B6-_7pT0Dz_cY29s_KajGLfin3G_WsYmZA--ysyRLAmdK_X5C3W-wpkpDJ8906vuZST5547lSJGOZ45_VFv7XnTmBip3zRQOmrlxdU6OQ5Vmj3xMON_NQ-ckEUSNr65xWTAPmOQoncGYp8s-TO7ethyx6UyDTnW8d1YiXWCUYfQDQ8d5wCPHnfoYAsZCs_f0xaBUmaiwvUL3ckiXgMr2yHjWKWQuezlbjJk7ODu2cgoAzs3IWMonaixIJeeJJcOvFB4SPTnbToJe7ISvvsZTEwrLWW_E_LgTUEDqHbeWyeQI8WqDa9EOwMEFw\",\"token_type\":\"Bearer\",\"expires_in\":299}\n\n-------------------------------------------------------\nREQUEST:\n-------------------------------------------------------\nPOST /jans-auth/restv1/token HTTP/1.1\nHost: yuriyz-fond-skink.gluu.info\nContent-Type: application/x-www-form-urlencoded\nAuthorization: Basic OTk5ZTEzYjgtZjRhMi00ZmVkLWFkM2MtNmM4OGJkMmM5MmVhOmY2MzY0YzVjLTI5NWQtNGU2ZS1iYjQwLTZhZDNhNDdiMjExOQ==\n\ngrant_type=refresh_token&amp;refresh_token=505314a7-05f5-4c9f-8900-ccb0685dea17\n\n-------------------------------------------------------\nRESPONSE:\n-------------------------------------------------------\nHTTP/1.1 200\nCache-Control: no-store\nConnection: Keep-Alive\nContent-Length: 166\nContent-Type: application/json\nDate: Thu, 10 Aug 2023 11:53:08 GMT\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\nKeep-Alive: timeout=5, max=100\nPragma: no-cache\nServer: Apache/2.4.41 (Ubuntu)\nSet-Cookie: X-Correlation-Id=88a6b7a5-3230-4f0f-b859-09df77a5c67a; Secure; HttpOnly;HttpOnly\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nX-Content-Type-Options: nosniff\nX-Xss-Protection: 1; mode=block\n\n{\"access_token\":\"572f6422-caf9-496a-a6be-4ab39c872816\",\"refresh_token\":\"e93b6576-5297-4d9d-a92b-3276d90a75e4\",\"scope\":\"openid\",\"token_type\":\"Bearer\",\"expires_in\":299}\n\n-------------------------------------------------------\nREQUEST:\n-------------------------------------------------------\nGET /jans-auth/restv1/userinfo HTTP/1.1 HTTP/1.1\nHost: yuriyz-fond-skink.gluu.info\nAuthorization: Bearer 572f6422-caf9-496a-a6be-4ab39c872816\n\n-------------------------------------------------------\nRESPONSE:\n-------------------------------------------------------\nHTTP/1.1 200\nCache-Control: no-store, private\nConnection: Keep-Alive\nContent-Length: 46\nContent-Type: application/json;charset=utf-8\nDate: Thu, 10 Aug 2023 11:53:08 GMT\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\nKeep-Alive: timeout=5, max=100\nPragma: no-cache\nServer: Apache/2.4.41 (Ubuntu)\nSet-Cookie: X-Correlation-Id=390c7a63-fe06-48a5-b3bf-2549267ba9b0; Secure; HttpOnly;HttpOnly\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nX-Content-Type-Options: nosniff\nX-Xss-Protection: 1; mode=block\n\n{\"sub\":\"25784d49-84f3-4b26-aee2-10493339232d\"}\n</code></pre>","tags":["administration","auth-server","authorization-challenge","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization-challenge/#authorization-challenge-flow-sample-with-invalid-user","title":"Authorization Challenge Flow sample with invalid user","text":"<pre><code>OpenID Connect Configuration\n-------------------------------------------------------\nREQUEST:\n-------------------------------------------------------\nGET /.well-known/openid-configuration HTTP/1.1 HTTP/1.1\nHost: yuriyz-fond-skink.gluu.info\n\n-------------------------------------------------------\nRESPONSE:\n-------------------------------------------------------\nHTTP/1.1 200\nConnection: Keep-Alive\nContent-Length: 6244\nContent-Type: application/json\nDate: Thu, 10 Aug 2023 11:57:01 GMT\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\nKeep-Alive: timeout=5, max=100\nServer: Apache/2.4.41 (Ubuntu)\nSet-Cookie: X-Correlation-Id=79c5fed3-d69a-4fdf-af88-fce550cd1819; Secure; HttpOnly;HttpOnly\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nX-Content-Type-Options: nosniff\nX-Xss-Protection: 1; mode=block\n\n{\n  \"request_parameter_supported\" : true,\n  \"pushed_authorization_request_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/par\",\n  \"introspection_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/introspection\",\n  \"claims_parameter_supported\" : false,\n  \"issuer\" : \"https://yuriyz-fond-skink.gluu.info\",\n  \"userinfo_encryption_enc_values_supported\" : [ \"A128CBC+HS256\", \"A256CBC+HS512\", \"A128GCM\", \"A256GCM\" ],\n  \"id_token_encryption_enc_values_supported\" : [ \"A128CBC+HS256\", \"A256CBC+HS512\", \"A128GCM\", \"A256GCM\" ],\n  \"access_token_signing_alg_values_supported\" : [ \"none\", \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"authorization_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/authorize\",\n  \"service_documentation\" : \"http://jans.org/docs\",\n  \"authorization_encryption_alg_values_supported\" : [ \"RSA1_5\", \"RSA-OAEP\", \"A128KW\", \"A256KW\" ],\n  \"claims_supported\" : [ \"street_address\", \"country\", \"zoneinfo\", \"birthdate\", \"role\", \"gender\", \"formatted\", \"user_name\", \"phone_mobile_number\", \"preferred_username\", \"locale\", \"inum\", \"updated_at\", \"post_office_box\", \"nickname\", \"preferred_language\", \"email\", \"website\", \"email_verified\", \"profile\", \"locality\", \"phone_number_verified\", \"room_number\", \"given_name\", \"middle_name\", \"picture\", \"name\", \"phone_number\", \"postal_code\", \"region\", \"family_name\", \"jansAdminUIRole\" ],\n  \"ssa_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/ssa\",\n  \"token_endpoint_auth_methods_supported\" : [ \"client_secret_basic\", \"client_secret_post\", \"client_secret_jwt\", \"private_key_jwt\", \"tls_client_auth\", \"self_signed_tls_client_auth\" ],\n  \"tls_client_certificate_bound_access_tokens\" : true,\n  \"response_modes_supported\" : [ \"query\", \"jwt\", \"query.jwt\", \"form_post.jwt\", \"form_post\", \"fragment\", \"fragment.jwt\" ],\n  \"backchannel_logout_session_supported\" : true,\n  \"token_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/token\",\n  \"response_types_supported\" : [ \"code\", \"code id_token token\", \"id_token\", \"code id_token\", \"token\", \"id_token token\", \"code token\" ],\n  \"authorization_encryption_enc_values_supported\" : [ \"A128CBC+HS256\", \"A256CBC+HS512\", \"A128GCM\", \"A256GCM\" ],\n  \"backchannel_token_delivery_modes_supported\" : [ \"poll\", \"ping\", \"push\" ],\n  \"dpop_signing_alg_values_supported\" : [ \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"request_uri_parameter_supported\" : true,\n  \"backchannel_user_code_parameter_supported\" : false,\n  \"grant_types_supported\" : [ \"client_credentials\", \"urn:ietf:params:oauth:grant-type:uma-ticket\", \"urn:ietf:params:oauth:grant-type:device_code\", \"urn:ietf:params:oauth:grant-type:token-exchange\", \"implicit\", \"authorization_code\", \"password\", \"refresh_token\" ],\n  \"ui_locales_supported\" : [ \"en\", \"bg\", \"de\", \"es\", \"fr\", \"it\", \"ru\", \"tr\" ],\n  \"userinfo_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/userinfo\",\n  \"authorization_challenge_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/authorize-challenge\",\n  \"op_tos_uri\" : \"https://yuriyz-fond-skink.gluu.info/tos\",\n  \"require_request_uri_registration\" : false,\n  \"id_token_encryption_alg_values_supported\" : [ \"RSA1_5\", \"RSA-OAEP\", \"A128KW\", \"A256KW\" ],\n  \"frontchannel_logout_session_supported\" : true,\n  \"authorization_signing_alg_values_supported\" : [ \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"claims_locales_supported\" : [ \"en\" ],\n  \"clientinfo_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/clientinfo\",\n  \"request_object_signing_alg_values_supported\" : [ \"none\", \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"request_object_encryption_alg_values_supported\" : [ \"RSA1_5\", \"RSA-OAEP\", \"A128KW\", \"A256KW\" ],\n  \"key_from_java\" : \"value_from_script_on_java\",\n  \"check_session_iframe\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/opiframe.htm\",\n  \"scopes_supported\" : [ \"address\", \"introspection\", \"https://jans.io/auth/ssa.admin\", \"online_access\", \"openid\", \"user_name\", \"clientinfo\", \"profile\", \"uma_protection\", \"permission\", \"https://jans.io/scim/users.write\", \"revoke_session\", \"https://jans.io/scim/users.read\", \"device_sso\", \"phone\", \"mobile_phone\", \"offline_access\", \"email\" ],\n  \"backchannel_logout_supported\" : true,\n  \"acr_values_supported\" : [ \"simple_password_auth\" ],\n  \"request_object_encryption_enc_values_supported\" : [ \"A128CBC+HS256\", \"A256CBC+HS512\", \"A128GCM\", \"A256GCM\" ],\n  \"device_authorization_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/device_authorization\",\n  \"display_values_supported\" : [ \"page\", \"popup\" ],\n  \"userinfo_signing_alg_values_supported\" : [ \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"require_pushed_authorization_requests\" : false,\n  \"claim_types_supported\" : [ \"normal\" ],\n  \"userinfo_encryption_alg_values_supported\" : [ \"RSA1_5\", \"RSA-OAEP\", \"A128KW\", \"A256KW\" ],\n  \"end_session_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/end_session\",\n  \"revocation_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/revoke\",\n  \"backchannel_authentication_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/bc-authorize\",\n  \"token_endpoint_auth_signing_alg_values_supported\" : [ \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"frontchannel_logout_supported\" : true,\n  \"jwks_uri\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/jwks\",\n  \"subject_types_supported\" : [ \"public\", \"pairwise\" ],\n  \"id_token_signing_alg_values_supported\" : [ \"none\", \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"registration_endpoint\" : \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/register\",\n  \"id_token_token_binding_cnf_values_supported\" : [ \"tbh\" ]\n}\n\n\n#######################################################\nTEST: authorizationChallengeFlow\n#######################################################\n-------------------------------------------------------\nREQUEST:\n-------------------------------------------------------\nPOST /jans-auth/restv1/register HTTP/1.1\nHost: yuriyz-fond-skink.gluu.info\nContent-Type: application/json\nAccept: application/json\n\n{\n  \"grant_types\" : [ \"authorization_code\", \"refresh_token\" ],\n  \"subject_type\" : \"public\",\n  \"application_type\" : \"web\",\n  \"scope\" : \"openid profile address email phone user_name\",\n  \"minimum_acr_priority_list\" : [ ],\n  \"redirect_uris\" : [ \"https://yuriyz-fond-skink.gluu.info/jans-auth-rp/home.htm\", \"https://client.example.com/cb\", \"https://client.example.com/cb1\", \"https://client.example.com/cb2\" ],\n  \"client_name\" : \"jans test app\",\n  \"additional_audience\" : [ ],\n  \"response_types\" : [ \"code\", \"id_token\" ]\n}\n\n-------------------------------------------------------\nRESPONSE:\n-------------------------------------------------------\nHTTP/1.1 201\nCache-Control: no-store\nConnection: Keep-Alive\nContent-Length: 1633\nContent-Type: application/json\nDate: Thu, 10 Aug 2023 11:57:02 GMT\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\nKeep-Alive: timeout=5, max=100\nPragma: no-cache\nServer: Apache/2.4.41 (Ubuntu)\nSet-Cookie: X-Correlation-Id=7045173c-9a96-418a-86ed-47a09749b004; Secure; HttpOnly;HttpOnly\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nX-Content-Type-Options: nosniff\nX-Xss-Protection: 1; mode=block\n\n{\n    \"allow_spontaneous_scopes\": false,\n    \"application_type\": \"web\",\n    \"rpt_as_jwt\": false,\n    \"registration_client_uri\": \"https://yuriyz-fond-skink.gluu.info/jans-auth/restv1/register?client_id=d93a5129-1546-4b9b-bf8c-ea19e36ea2c8\",\n    \"tls_client_auth_subject_dn\": \"\",\n    \"run_introspection_script_before_jwt_creation\": false,\n    \"registration_access_token\": \"67aa99de-e977-4562-955d-6292f2c95df4\",\n    \"client_id\": \"d93a5129-1546-4b9b-bf8c-ea19e36ea2c8\",\n    \"token_endpoint_auth_method\": \"client_secret_basic\",\n    \"scope\": \"openid\",\n    \"client_secret\": \"f921c89c-57f0-4a91-baaa-036a4a22737b\",\n    \"client_id_issued_at\": 1691668622,\n    \"backchannel_logout_uri\": \"\",\n    \"backchannel_logout_session_required\": false,\n    \"client_name\": \"jans test app\",\n    \"par_lifetime\": 600,\n    \"spontaneous_scopes\": [],\n    \"id_token_signed_response_alg\": \"RS256\",\n    \"access_token_as_jwt\": false,\n    \"grant_types\": [\n        \"authorization_code\",\n        \"refresh_token\"\n    ],\n    \"subject_type\": \"public\",\n    \"additional_token_endpoint_auth_methods\": [],\n    \"keep_client_authorization_after_expiration\": false,\n    \"require_par\": false,\n    \"redirect_uris\": [\n        \"https://client.example.com/cb2\",\n        \"https://client.example.com/cb1\",\n        \"https://client.example.com/cb\",\n        \"https://yuriyz-fond-skink.gluu.info/jans-auth-rp/home.htm\"\n    ],\n    \"redirect_uris_regex\": \"\",\n    \"additional_audience\": [],\n    \"frontchannel_logout_session_required\": false,\n    \"client_secret_expires_at\": 1691704622,\n    \"access_token_signing_alg\": \"RS256\",\n    \"response_types\": [\n        \"code\",\n        \"id_token\"\n    ]\n}\n\n-------------------------------------------------------\nREQUEST:\n-------------------------------------------------------\nPOST /jans-auth/restv1/authorize-challenge HTTP/1.1\nHost: yuriyz-fond-skink.gluu.info\n\nclient_id=d93a5129-1546-4b9b-bf8c-ea19e36ea2c8&amp;scope=openid+profile+address+email+phone+user_name&amp;state=4f925a8d-287a-4cba-a174-04d2e56109df&amp;nonce=84c9b6dd-635c-4ca4-bba1-35c53c51a339&amp;prompt=&amp;ui_locales=&amp;claims_locales=&amp;acr_values=&amp;request_session_id=false&amp;password=secret&amp;username=invalidUser\n\n-------------------------------------------------------\nRESPONSE:\n-------------------------------------------------------\nHTTP/1.1 401\nCache-Control: no-transform, no-store\nConnection: Keep-Alive\nContent-Length: 29\nContent-Type: application/json\nDate: Thu, 10 Aug 2023 11:57:02 GMT\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\nKeep-Alive: timeout=5, max=100\nServer: Apache/2.4.41 (Ubuntu)\nSet-Cookie: X-Correlation-Id=4c89e007-6c77-43da-a67f-b7ee1ff0e60a; Secure; HttpOnly;HttpOnly\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nX-Content-Type-Options: nosniff\nX-Xss-Protection: 1; mode=block\n\n{\"error\": \"username_invalid\"}\n</code></pre>","tags":["administration","auth-server","authorization-challenge","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization/","title":"Authorization Endpoint","text":"<p>Janssen Server exposes authorization endpoint compliant with OAuth2 framework. A client uses authorization endpoint to obtain an authorization grant. Based on response type requested by the client, the authorization endpoint issues an authorization code or an access token. Authorization endpoint is a protected endpoint which will require end-user authentication before issuing authorization code or access token.</p> <p>URL to access authorization endpoint on Janssen Server is listed in the response of Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p><code>authorization_endpoint</code> claim in the response specifies the URL for authorization endpoint. By default, authorization endpoint looks like below:</p> <pre><code>https://janssen.server.host/jans-auth/restv1/authorize\n</code></pre> <p>More information about request and response of the authorization endpoint can be found in the OpenAPI specification of jans-auth-server module.</p>","tags":["administration","auth-server","authorization","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization/#configuration-properties","title":"Configuration Properties","text":"<p>Authorization endpoint can be further configured using Janssen Server configuration properties listed below. When using Janssen Text-based UI(TUI) to configure the properties, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>.</p> <ul> <li>issuer</li> <li>requirePkce</li> <li>fapiCompatibility</li> <li>forceSignedRequestObject</li> <li>authorizationCodeLifetime</li> <li>returnDeviceSecretFromAuthzEndpoint</li> <li>requestUriBlockList</li> <li>requireRequestObjectEncryption</li> <li>staticDecryptionKid</li> <li>requestUriHashVerificationEnabled</li> <li>legacyIdTokenClaims</li> <li>customHeadersWithAuthorizationResponse</li> <li>includeSidInResponse</li> <li>sessionIdRequestParameterEnabled</li> <li>returnDeviceSecretFromAuthzEndpoint</li> <li>requirePar</li> <li>cibaMaxExpirationTimeAllowedSec</li> </ul>","tags":["administration","auth-server","authorization","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization/#required-client-configuration","title":"Required Client Configuration","text":"<p>Clients must be registered with Janssen Server as using code and/or implicit grant types in order to use authorization endpoint.</p> <p>Using Janssen Text-based UI(TUI), client can be registered for appropriate grant type by navigating to <code>Auth-Server</code>-&gt;<code>Clients</code>-&gt;<code>Add Client</code></p>","tags":["administration","auth-server","authorization","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization/#using-pkce","title":"Using PKCE","text":"<p>Janssen Server supports PKCE, which recommended and more secure method for using <code>code</code> grant.</p> <p>PKCE can be enabled/disable by setting requirePkce property. Janssen server supports <code>plain</code> as well as <code>s256</code> code challenge methods.</p>","tags":["administration","auth-server","authorization","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization/#using-par","title":"Using PAR","text":"<p>As a separate endpoint, Janssen Server supports PAR(Pushed Authorization Requests) to enable authorization using more complex authorization requests and making it more secure at the same time.</p> <p>Use Janssen Server configuration property requirePar to accept only PAR requests.</p>","tags":["administration","auth-server","authorization","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization/#using-jarm","title":"Using JARM","text":"<p>Authorization endpoint supports JWT Secured Authorization Response Mode, or JARM. Using JARM makes authorization responses more secure and compliant to be used in FAPI deployments.</p> <p>Janssen Server supports all response modes as defined in JARM specification</p>","tags":["administration","auth-server","authorization","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization/#using-prompt-parameter","title":"Using Prompt Parameter","text":"<p><code>prompt</code> request parameter is an ASCII string value that specifies whether the Authorization Server prompts the End-User for re-authentication and consent. Janssen Server supports <code>none</code>, <code>login</code>, <code>consent</code>, <code>create</code> and <code>select_account</code> values for <code>prompt</code> parameter. Multiple values can be specified by separating them with single space. Based on value/s of this request parameter Authorization Server prompts the End-User for re-authentication (<code>login</code>), consent or user registration details (<code>create</code>).</p> <p>Check Prompt page for more details.</p>","tags":["administration","auth-server","authorization","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization/#none","title":"none","text":"<p><code>none</code> value will instruct Janssen Server NOT to display any authentication or consent user interface pages. An error is returned if the End-User is not already authenticated or the Client does not have pre-configured consent for the requested scopes. This can be used as a method to check for existing authentication and/or consent.</p>","tags":["administration","auth-server","authorization","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization/#login","title":"login","text":"<p><code>login</code> value will instruct Janssen Server to prompt the End-User for re-authentication.</p>","tags":["administration","auth-server","authorization","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization/#consent","title":"consent","text":"<p><code>consent</code> value will instruct Janssen Server to prompt the End-User for consent before returning information to the Client.</p>","tags":["administration","auth-server","authorization","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization/#select_account","title":"select_account","text":"<p><code>select_account</code> value will instruct Janssen Server to prompt the End-User to select a user account. This allows a user who has multiple accounts at the Authorization Server to select amongst the multiple accounts that they may have current sessions for.</p>","tags":["administration","auth-server","authorization","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization/#configuring-authentication-methods","title":"Configuring Authentication Methods","text":"<p><code>acr_values</code> request parameter is used to specify authentication methods to be used by Janssen Server to authenticate the end user. Multiple acr values can be specified by separating them with a space.</p> <p>In order to use a particular acr value, the client needs to be authorized to use all the acr values in the list. If no the request doesn't specify any acr value then the default acr value configured for respective client is used by Janssen server for end user authentication.</p>","tags":["administration","auth-server","authorization","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization/#customizing-using-interception-scripts","title":"Customizing using Interception Scripts","text":"<p>Interception scripts allow flexibility to configure and customize multiple aspects in Janssen Server. For example, see this documentation to learn</p> <p>how person authentication and consent gathering can be customized using interception scripts.</p>","tags":["administration","auth-server","authorization","endpoint"]},{"location":"janssen-server/auth-server/endpoints/authorization/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","authorization","endpoint"]},{"location":"janssen-server/auth-server/endpoints/backchannel-authentication/","title":"Backchannel authentication Endpoint","text":"","tags":["administration","auth-server","endpoint"]},{"location":"janssen-server/auth-server/endpoints/backchannel-authentication/#backchannel-authentication-scripts","title":"Backchannel authentication scripts","text":"<p>Janssen server enables domains to render the username/pw login form, avoiding the redirect to the IDP-hosted login page. Many SSO solutions offer a proprietary endpoint to accomplish this. However, in Janssen server, this is accomplished with the OAuth/OpenID framework by using a combination of calling the /token endpoint using the OAuth password flow, and then redirecting to browser to the /authorization endpoint, but auto-submitting the form.</p> <p>This article describes how to process login via backchannel and when browser is processing authorization, AS will recognize automatically the authenticated user, write cookies and then establish the session.</p>","tags":["administration","auth-server","endpoint"]},{"location":"janssen-server/auth-server/endpoints/backchannel-authentication/#design","title":"Design","text":"<p>Source-code for sequence diagram <pre><code>Title password Grant with State\n\nPerson-&gt;Browser: Navigate to website\nBrowser-&gt;Website:\nWebsite-&gt;Browser:Display login page\nPerson-&gt;Browser: Enter Username / PW\nBrowser-&gt;Website: (creds)\nWebsite-&gt;IDP: /token?uid=_&amp;pw=&amp;browser_ip=_\nIDP-&gt;Website: {\"redirect\": \"/authz/state=1F2D41A\", ...}\nWebsite-&gt;Browser:\nBrowser-&gt;IDP: /authz?state=1F2D41A\nIDP-&gt;IDP: check IP address is\\n same as state\nIDP-&gt;Browser: write cookie / send redirect_uri\nBrowser-&gt;Website: redirect_uri\n</code></pre></p>","tags":["administration","auth-server","endpoint"]},{"location":"janssen-server/auth-server/endpoints/backchannel-authentication/#solution","title":"Solution","text":"<p>In order to process the whole authorization, idea is to use resource owner password credentials grant type in the first stage, over there process the authentication as we do today, but also write in cache a short-lived token to recognize such authenticated user, then return to the client such short-lived token. During authorization, browser should send that token as part of the custom params and in the AS we should verify if that user is already authenticated using the short-lived param in the cache, then AS will write cookies, create the session and return to the client information required for this.</p>","tags":["administration","auth-server","endpoint"]},{"location":"janssen-server/auth-server/endpoints/backchannel-authentication/#jans-app-configurations","title":"Jans App Configurations","text":"<p>Above the jans-auth record of the jansAppConf table, enable a new attribute on the jansConfDyn field</p> <p>Example: <pre><code>\"authorizationRequestCustomAllowedParameters\": [\n    {\n        \"paramName\": \"bcAuthnToken\",\n        \"returnInResponse\": true\n    }\n]\n</code></pre> Sample CURL 1. Obtain access token    <pre><code>curl -u \"put_client_id_here:put_config_api_client_secret_here\" https://&lt;your.jans.server&gt;/jans-auth/restv1/token \\\n   -d  \"grant_type=client_credentials&amp;scope=https://jans.io/oauth/jans-auth-server/config/properties.write\"\n</code></pre> 2. Apply patch    <pre><code>curl -X PATCH -k -H 'Content-Type: application/json-patch+json' \\ \n   -i 'jans-config-api/api/v1/jans-auth-server/config' \\ \n   -H \"Authorization: Bearer put_access_token_here\" --data '[\n      {\n       \"op\": \"add\",\n       \"path\": \"authorizationRequestCustomAllowedParameters\",\n       \"value\": [\n                    {\n                     \"paramName\": \"bcAuthnToken\",\n                     \"returnInResponse\": true\n                    }\n                ]\n       }\n      ]'\n</code></pre></p>","tags":["administration","auth-server","endpoint"]},{"location":"janssen-server/auth-server/endpoints/backchannel-authentication/#custom-script-registration","title":"Custom Script Registration","text":"<p>In the table jansCustomScr enable 2 new scripts: 1. Script type resource_owner_password_credentials displayName ropc-backchannel [ropc-backchannel-script.py] See script below. 2. Script type person_autentication displayName backchannel-authentication [backchannel-authentication-script.py] See script below.</p>","tags":["administration","auth-server","endpoint"]},{"location":"janssen-server/auth-server/endpoints/backchannel-authentication/#client-configuration","title":"Client Configuration","text":"<p>Associate script person_authentication on table jansClnt.</p> <p>Modify the jansAttrs field which contains a json and the ropcScripts field and add the dn from the ropc script record in the previous step</p> <p>Example: <pre><code>\"ropcScripts\": [\n    \"inum={SCRIPT_ID},ou=scripts,o=jans\",\n],\n</code></pre></p>","tags":["administration","auth-server","endpoint"]},{"location":"janssen-server/auth-server/endpoints/backchannel-authentication/#flow","title":"Flow","text":"","tags":["administration","auth-server","endpoint"]},{"location":"janssen-server/auth-server/endpoints/backchannel-authentication/#bcauthtoken-request","title":"BcAuthToken request:","text":"<p>Firstly, the /token service is called to generate the <code>bcAuthnToken</code> (get it from the response header with the key Bc-Authn-Token)</p> <p>In this request example, the client's basic credential is being used in order to authenticate the client, however you could use your preferred authn mode.</p> <p>Request <pre><code>curl --location --request POST 'https://jans.localhost/jans-auth/restv1/token' \\\n--header 'Authorization: Basic MzE3MGNiYzUtMDAxOC00OWVmLThiYTYtMjY4MGI2NjhiZjBjOmFmNzk1ZjI1LWQ1MjktNDVlYi1iMTJlLWNjM2ExNTY5OTU1Ng==' \\\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode 'grant_type=password' \\\n--data-urlencode 'username=test_user' \\\n--data-urlencode 'password=test_user_password' \\\n--data-urlencode 'custom1=your custom param 1' \\\n--data-urlencode 'custom2=your custom param 2' \\\n--data-urlencode 'scope=openid'\n</code></pre></p> <p>Response <pre><code>HTTP/1.1 200 OK\nDate: Wed, 29 Jun 2022 14:03:25 GMT\nServer: Apache/2.4.52 (Ubuntu)\nX-Xss-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nBc-Authn-Token: dacfe4fc-d0ce-4673-9370-e66f652c4b7f\nCache-Control: no-store\nContent-Type: application/json\nPragma: no-cache\nContent-Length: 1109\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\n\n{\"access_token\":\"7a024a59-e132-4c05-9126-f4f36b3d3677\",\"refresh_token\":\"184c2b60-b5c7-4250-9850-97b0f531743c\",\"scope\":\"openid\",\"id_token\":\"eyJraWQiOiJmZGJhY2Q2Yi05YTY0LTQ2MWQtOWJlYy1jOTAyMjc5ZGI2ODZfc2lnX3JzMjU2IiwidHlwIjoiand0IiwiYWxnIjoiUlMyNTYifQ.eyJhdWQiOiIzMTcwY2JjNS0wMDE4LTQ5ZWYtOGJhNi0yNjgwYjY2OGJmMGMiLCJhY3IiOiJzaW1wbGVfcGFzc3dvcmRfYXV0aCIsInN1YiI6Il9Fa3p5aXlRdVBzUm1mYjh3WHlmTTB4U0xDckxwTDJGNnA3RWhEeWRBUHciLCJjb2RlIjoiNDY4MzQ2NjktOGQ1Yy00NmQxLTkwNWEtNmMzNDg3YzZlMDg3IiwiYW1yIjpbXSwiaXNzIjoiaHR0cHM6Ly9qYW5zLmxvY2FsaG9zdCIsImV4cCI6MTY1NjUxNTAwNiwiZ3JhbnQiOiJwYXNzd29yZCIsImlhdCI6MTY1NjUxMTQwNiwic2lkIjoiMTg0ZTllOTktNjFmNi00ZWNhLWE0ZmUtMTMwZmFmZDk1MjE1Iiwib3hPcGVuSURDb25uZWN0VmVyc2lvbiI6Im9wZW5pZGNvbm5lY3QtMS4wIn0.hW0vReGYLzC2RyBHztSFbDYoaYHcCYxatX1lpzWqyW5U2S9eNp58mKKmvdZmMc229Sz5VxqfYflpWuI_6aXsLFR_KT9FY3exSRIRtPiD_fUETdhsVuKWavumVnjvwdAM6ytu5ORJx06DCxEgaG1uXmRiE9GoT8F1uqeo4NxURhVNXmMd2fiiUmgm1lt3-kNhlSg6vMDJS1Aq1idm-XhiSVy895BY-JdpLEGJEycPKr1lpsBTcmasbFNBJv6_orKWlvvgFCVxo7XmbH7Xnmqi6UUo30L6sULqmCsTLa6DaWYfGokHz_0xRflw_Ihv9wlVq8gSdOZGoMaVGzDdKlddZw\",\"token_type\":\"Bearer\",\"expires_in\":299}\n</code></pre></p>","tags":["administration","auth-server","endpoint"]},{"location":"janssen-server/auth-server/endpoints/backchannel-authentication/#authorize-request","title":"Authorize request:","text":"<p>Once you have gotten the bcAuthnToken from the previous /token call, you must call authorize attaching the bcAuthnToken as a parameter and in the acr_values param send the name of the backchannel-authentication registered in previous steps.</p> <p>This script will generate cookies and session associated with the browser if the <code>BcAuthToken</code> is valid.</p> <p>Example: <pre><code>https://jans.localhost/jans-auth/restv1/authorize?response_type=code&amp;client_id=3170cbc5-0018-49ef-8ba6-2680b668bf0c&amp;scope=openid+profile+address+email&amp;redirect_uri=https://jans.localhost/jans-auth-rp/home.htm&amp;state=2f78eaf1-d73e-49f2-8f50-e5faef80808a&amp;nonce=92c3a631-db54-4ae9-bd53-caf92a4adbcf&amp;prompt=&amp;ui_locales=&amp;claims_locales=&amp;acr_values=backchannel-authentication&amp;request_session_id=false&amp;bcAuthnToken={your bcAuthnToken}\n</code></pre> This call will redirect to the redirect_uri that you sent as a parameter in the call and will receive a code as well, after that the process is more or less the same than the regular flow.</p>","tags":["administration","auth-server","endpoint"]},{"location":"janssen-server/auth-server/endpoints/backchannel-authentication/#request-token","title":"Request /token:","text":"<p>With the code obtained previously, you must call /token again, adding the parameter code</p> <p>Request: <pre><code>curl --location --request POST 'https://jans.localhost/jans-auth/restv1/token' \\\n--header 'Authorization: Basic MzlhNjlmYzAtNzNmYy00MWJhLWFiMGYtNDJhNWFmYWI2MjllOmJmMDRlZTM4LTM0MTktNGEzNS05YTI5LTcyODlmY2JkNzc2Zg==' \\\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode 'grant_type=authorization_code' \\\n--data-urlencode 'code=d449a7b9-10f6-4320-b257-05fee91d3c16' \\\n--data-urlencode 'redirect_uri=https://jans.localhost/jans-auth-rp/home.htm'\n</code></pre></p> <p>Response: <pre><code>HTTP/1.1 200 OK\nDate: Wed, 29 Jun 2022 15:20:50 GMT\nServer: Apache/2.4.52 (Ubuntu)\nX-Xss-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nCache-Control: no-store\nContent-Type: application/json\nPragma: no-cache\nContent-Length: 1291\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\n{\"access_token\":\"896b04a2-fcbe-4466-89b9-184930b8675b\",\"refresh_token\":\"843995ef-cd0e-4b2c-9b91-7c68081325ab\",\"id_token\":\"eyJraWQiOiJmZGJhY2Q2Yi05YTY0LTQ2MWQtOWJlYy1jOTAyMjc5ZGI2ODZfc2lnX3JzMjU2IiwidHlwIjoiand0IiwiYWxnIjoiUlMyNTYifQ.eyJhdF9oYXNoIjoiMmx5OXh5emthMmc2T09HcVRPTmhqdyIsInN1YiI6Il9Fa3p5aXlRdVBzUm1mYjh3WHlmTTB4U0xDckxwTDJGNnA3RWhEeWRBUHciLCJjb2RlIjoiMjdiNjM0NTItMTE1My00ZDk5LTlkYzQtYzMyNGRmNjIwYWE0IiwiYW1yIjpbIjEwIl0sImlzcyI6Imh0dHBzOi8vamFucy5sb2NhbGhvc3QiLCJub25jZSI6IjkyYzNhNjMxLWRiNTQtNGFlOS1iZDUzLWNhZjkyYTRhZGJjZiIsInNpZCI6ImQzZDFlOWY2LWE1NTMtNDI2ZC04MWQ1LTE0YTFiZjg0MDJhNCIsIm94T3BlbklEQ29ubmVjdFZlcnNpb24iOiJvcGVuaWRjb25uZWN0LTEuMCIsImF1ZCI6IjMxNzBjYmM1LTAwMTgtNDllZi04YmE2LTI2ODBiNjY4YmYwYyIsImFjciI6InJvcGMtYmFja2NoYW5uZWwiLCJjX2hhc2giOiJzZVkxTldwNmN6ZGppUEdTWktqQlZRIiwiYXV0aF90aW1lIjoxNjU2NTE2MDM4LCJleHAiOjE2NTY1MTk2NTAsImdyYW50IjoiYXV0aG9yaXphdGlvbl9jb2RlIiwiaWF0IjoxNjU2NTE2MDUwfQ.giFYGuN-VUNSVMMT4bBkoGsZ-rKlByqe6qv24jzp7pk2eCY4FawiaLHJqH9MzBN7uEauRXYNR2pa_0oGoYnNNg4zbFiSARSKVsajcrPeDUgNs71MjMOYCH5dukXB7X5SEP3Drz5njxuXswI_EjM2Cd0OtJMoHQ0_IP_C3rzwmaQQsgWk81yAXl-eM4zABYV1e9OObGFqPtVjoHmpbFbg-teoRTr_LxYgKPwB1XnRqD4G9No7oV-9q1Bv1ED9AU6zxLWf9aGE2gQIC-jgkr7LZ5pB4zYgU_DwgmpaAuW_AT8ApfnQPqgNy7YouIPWZ8pyoncLjF0SdStVPEoreRx7GA\",\"token_type\":\"Bearer\",\"expires_in\":299}\n</code></pre></p> <p>With info, you could do whatever you want using browser session. NOTE: I added some custom params in case you need to validate something else, for instance browser IP.</p>","tags":["administration","auth-server","endpoint"]},{"location":"janssen-server/auth-server/endpoints/backchannel-authentication/#script-templates","title":"Script templates","text":"<p>These scripts are examples of how it worked, but you could customize them based on your needs, for instance browser validations.</p>","tags":["administration","auth-server","endpoint"]},{"location":"janssen-server/auth-server/endpoints/backchannel-authentication/#backchannel-authentication-script","title":"Backchannel authentication script","text":"<pre><code>from io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.server.security import Identity\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\nfrom io.jans.as.server.service import AuthenticationService\nfrom io.jans.util import StringHelper\nfrom io.jans.as.server.util import ServerUtil\nfrom io.jans.service.cache import CacheProvider\nfrom io.jans.as.server.service import SessionIdService\nfrom io.jans.as.server.service import CookieService\nfrom io.jans.as.server.security import Identity\nfrom io.jans.service.cache import CacheProvider\nimport java\n\nclass PersonAuthentication(PersonAuthenticationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript,  configurationAttributes):\n        print \"Backchannel Authentication. Initialization\"\n        print \"Backchannel Authentication. Initialized successfully\"\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"Backchannel Authentication. Destroy\"\n        print \"Backchannel Authentication. Destroyed successfully\"\n        return True\n\n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n\n    def getApiVersion(self):\n        return 11\n\n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n        return True\n\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n        return None\n\n    def authenticate(self, configurationAttributes, requestParameters, step):\n        print \"Backchannel Authentication. Authenticate\"\n\n        # Get bcAuthnToken from params\n        bcAuthnToken = ServerUtil.getFirstValue(requestParameters, \"bcAuthnToken\")\n        print \"Backchannel Authentication. Get bcAuthnToken from params: '%s'\" % (bcAuthnToken)\n\n        if (bcAuthnToken == None):\n            return False\n\n        # Get sessionDn from cacheProvider\n        cacheProvider = CdiUtil.bean(CacheProvider)\n        sessionCacheDn = cacheProvider.get(bcAuthnToken)\n        print \"Backchannel Authentication. Get sessionCacheDn from cacheProvider: '%s'\" % (sessionCacheDn)\n\n        if (sessionCacheDn == None):\n            return False\n\n        # Get sessionId by sessionDn\n        sessionId = CdiUtil.bean(SessionIdService).getSessionByDn(sessionCacheDn)\n        print \"Backchannel Authentication. Get sessionId from sessionIdService: '%s'\" % ('None' if sessionId == None else sessionId.getId())\n        if (sessionId == None):\n            return False\n\n        # Write sessionId in cookies\n        CdiUtil.bean(CookieService).createSessionIdCookie(sessionId, False)\n        print \"Backchannel Authentication. Set session in Cookie\"\n\n        # Set sessionId in Identity\n        identity = CdiUtil.bean(Identity)\n        identity.setSessionId(sessionId)\n        print \"Backchannel Authentication. Set session in Identity\"\n\n        # Remove bcAuthnToken from cacheProvider\n        cacheProvider.remove(bcAuthnToken)\n        print \"Backchannel Authentication. Removed cacheProvider bcAuthnToken: '%s'\" % bcAuthnToken\n\n        return True\n\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\n        if (step == 1):\n            return True\n        else:\n            return False\n\n    def getExtraParametersForStep(self, configurationAttributes, step):\n        return None\n\n    def getCountAuthenticationSteps(self, configurationAttributes):\n        return 1\n\n    def getPageForStep(self, configurationAttributes, step):\n        return \"postlogin.xhtml\"\n\n    def getNextStep(self, configurationAttributes, requestParameters, step):\n        return -1\n\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n        return None\n\n    def logout(self, configurationAttributes, requestParameters):\n        return True\n</code></pre>","tags":["administration","auth-server","endpoint"]},{"location":"janssen-server/auth-server/endpoints/backchannel-authentication/#ropc-backchannel-script","title":"ROPC backchannel script","text":"<pre><code>from io.jans.model.custom.script.type.owner import ResourceOwnerPasswordCredentialsType\nfrom io.jans.as.server.service import AuthenticationService, SessionIdService\nfrom io.jans.as.server.security import Identity\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.model.authorize import AuthorizeRequestParam\nfrom io.jans.as.server.model.config import Constants\nfrom io.jans.util import StringHelper\nfrom java.lang import String\nfrom java.util import Date, HashMap\nfrom io.jans.service.cache import CacheProvider\nimport uuid\n\nclass ResourceOwnerPasswordCredentials(ResourceOwnerPasswordCredentialsType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"ROPC Backchannel. Initializing ...\"\n        print \"ROPC Backchannel. Initialized successfully\"\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"ROPC Backchannel. Destroying ...\"\n        print \"ROPC Backchannel. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    def authenticate(self, context):\n        print \"ROPC Backchannel. Authenticate\"\n\n        # Do generic authentication\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        username = context.getHttpRequest().getParameter(\"username\")\n        password = context.getHttpRequest().getParameter(\"password\")\n\n        # Add credential validation\n\n        result = authenticationService.authenticate(username, password)\n        if not result:\n            print \"ROPC Backchannel. Authenticate. Could not authenticate user '%s' \" % username\n            return False\n\n        context.setUser(authenticationService.getAuthenticatedUser())\n        print \"ROPC Backchannel. Authenticate. User '%s' authenticated successfully\" % username\n\n        # Get custom parameters from request\n        customParam1Value = context.getHttpRequest().getParameter(\"custom1\")\n        customParam2Value = context.getHttpRequest().getParameter(\"custom2\")\n\n        customParameters = {}\n        customParameters[\"custom1\"] = customParam1Value\n        customParameters[\"custom2\"] = customParam2Value\n        print \"ROPC Backchannel. Authenticate. User '%s'. Creating authenticated session with custom attributes: '%s'\" % (username, customParameters)\n\n        session = self.createNewAuthenticatedSession(context, customParameters)\n\n        # This is needed to allow store in token entry sessionId\n        authenticationService.configureEventUser(session)\n\n        print \"ROPC Backchannel. Authenticate. User '%s'. Created authenticated session: '%s'\" % (username, customParameters)\n\n        return True\n\n    def createNewAuthenticatedSession(self, context, customParameters={}):\n        sessionIdService = CdiUtil.bean(SessionIdService)\n\n        user = context.getUser()\n        client = CdiUtil.bean(Identity).getSessionClient().getClient()\n\n        # Add mandatory session parameters\n        sessionAttributes = HashMap()\n        sessionAttributes.put(Constants.AUTHENTICATED_USER, user.getUserId())\n        sessionAttributes.put(AuthorizeRequestParam.CLIENT_ID, client.getClientId())\n\n        # Add custom session parameters\n        for key, value in customParameters.iteritems():\n            if StringHelper.isNotEmpty(value):\n                sessionAttributes.put(key, value)\n\n        # Generate authenticated session\n        sessionId = sessionIdService.generateAuthenticatedSessionId(context.getHttpRequest(), user.getDn(), sessionAttributes)\n        print \"ROPC Backchannel. Generated session id. DN: '%s'\" % sessionId.getDn()\n\n        # Add state uuid in cache manager and response header\n        bcAuthnToken = str(uuid.uuid4())\n\n        cacheProvider = CdiUtil.bean(CacheProvider)\n        cacheProvider.put(300, bcAuthnToken, sessionId.getDn())\n        print \"ROPC Backchannel. Added cacheProvider id: '%s'\" % bcAuthnToken\n\n        # Add response header Bc-Authn-Token\n        context.getHttpResponse().setHeader(\"Bc-Authn-Token\", bcAuthnToken)\n        print \"ROPC Backchannel. Added header Bc-Authn-Token\"\n\n        return sessionId\n</code></pre>","tags":["administration","auth-server","endpoint"]},{"location":"janssen-server/auth-server/endpoints/client-registration/","title":"Client Registration Endpoint","text":"","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#dynamic-client-registration-dcr","title":"Dynamic Client Registration (DCR)","text":"<p>Dynamic client registration refers to the process by which a client submits a registration request to the Authorization server and how that request is served by the Authorization server. It is explained in the following specifications:</p> <ul> <li>For OpenID Connect relying parties</li> <li>For OAuth 2.0 client (without OpenID Connect features)</li> <li>Client management (CRUD) operations</li> <li>OpenBanking OpenID Dynamic Client Registration </li> </ul>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#client-registration-endpoint_1","title":"Client Registration endpoint","text":"<p>The URI to dynamically register a client to a Janssen Auth Server can be found by checking the <code>registration_endpoint</code> claim of the OpenID Connect configuration response, typically deployed at</p> <pre><code>https://&lt;my.jans.server&gt;/.well-known/openid-configuration\n</code></pre>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#configuring-janssen-as-to-allow-clients-to-dynamically-register","title":"Configuring Janssen AS to allow clients to dynamically register","text":"<p>The Janssen Authorization server will serve a DCR request if the following configuration parameters are set:</p> <ol> <li><code>dynamicRegistrationEnabled</code> : <code>true</code> or <code>false</code></li> <li><code>dynamicRegistrationExpirationTime</code> : Expiration time in seconds for clients created with dynamic registration, 0 or -1 means never expire</li> <li><code>dcrForbidExpirationTimeInRequest</code> : Boolean value specifying whether to allow to set client's expiration time in seconds during dynamic registration.. Default value is <code>false</code>.</li> </ol> <p>Client expiration</p> <p>Client expiration is set based on <code>dynamicRegistrationExpirationTime</code> AS configuration property or otherwise if <code>dcrForbidExpirationTimeInRequest</code> is <code>false</code> then it can be requested in Dynamic Client Registration Request via <code>lifetime</code> parameter which expected value in seconds.</p> <p>Configure the Janssen AS using steps explained in the Configure the Janssen AS</p>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#client-registration-requests","title":"Client registration Requests","text":"<p>Client registration request primarily does two things: Communicate client metadata to the authorization server, and optionally authenticate.</p> <p>There are different ways in which the client metadata is communicated to the authorization server using dynamic client registration requests.</p> <ul> <li>Using request body</li> <li>Using signed request object (JWT)</li> <li>Using software statement</li> </ul>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#using-request-body","title":"Using request body","text":"<p>A minimal DCR request with only mandatory parameters, looks like the one below.</p> <pre><code>curl -X POST -k -H 'Content-Type: application/json' -i 'https://my.jans.server/jans-auth/restv1/register' \\\n             --data '{\"redirect_uris\": [\"https://my.jans.client/page\"]}'\n</code></pre> <p>If the registration is successful, Janssen Server will respond with http response code <code>201</code> with JSON body as shown in example below:</p> <pre><code>{\n    \"allow_spontaneous_scopes\": false,\n    \"application_type\": \"web\",\n    \"rpt_as_jwt\": false,\n    \"registration_client_uri\": \"https://my.jans.server/jans-auth/restv1/register?client_id=85192707-a38c-496c-806c-ef01a6a3ae4a\",\n    \"tls_client_auth_subject_dn\": \"\",\n    \"run_introspection_script_before_jwt_creation\": false,\n    \"registration_access_token\": \"eaee20de-54ce-4217-b960-6b72b55e6cab\",\n    \"client_id\": \"85192707-a38c-496c-806c-ef01a6a3ae4a\",\n    \"token_endpoint_auth_method\": \"client_secret_basic\",\n    \"scope\": \"profile work_phone phone user_name device_sso openid permission uma_protection address email clientinfo org_name offline_access https://jans.io/auth/ssa.portal test https://jans.io/auth/ssa.admin https://jans.io/auth/ssa.developer\",\n    \"client_secret\": \"4148f812-92d6-4245-80e0-243524b3b6a4\",\n    \"client_id_issued_at\": 1678700818,\n    \"backchannel_logout_uri\": \"\",\n    \"backchannel_logout_session_required\": false,\n    \"client_name\": \"my.jans.client\",\n    \"par_lifetime\": 600,\n    \"lifetime\": 3600,\n    \"spontaneous_scopes\": [],\n    \"id_token_signed_response_alg\": \"RS256\",\n    \"access_token_as_jwt\": false,\n    \"grant_types\": [\n        \"authorization_code\",\n        \"refresh_token\"\n    ],\n    \"subject_type\": \"pairwise\",\n    \"keep_client_authorization_after_expiration\": false,\n    \"require_par\": false,\n    \"redirect_uris\": [\"https://my.jans.client/page\"],\n    \"redirect_uris_regex\": \"\",\n    \"additional_audience\": [],\n    \"frontchannel_logout_session_required\": false,\n    \"client_secret_expires_at\": 1678787218,\n    \"access_token_signing_alg\": \"RS256\",\n    \"response_types\": [\"code\"]\n}\n</code></pre> <p>In a typical DCR request the client or developer calls the client registration endpoint with a set of client metadata as specified in RFC7591</p> <pre><code>curl -X POST -k -i 'https://my.jans.server/jans-auth/restv1/register'  \\\n     --data '{ \\\n                   \"redirect_uris\": [\"https://client.example.org/cb\"] \\\n               \"client_id\": \"c3BhdRkqfX\", \\\n               \"client_secret\": \"bd136123eeffeef234235805d\", \\\n               \"grant_types\": [\"authorization_code\", \"refresh_token\"], \\\n               \"token_endpoint_auth_method\": \"client_secret_basic\", \\\n               \"jwks_uri\": \"https://client.example.org/my_public_keys.jwks\", \\\n               \"client_name\": \"My Example\", \\\n               \"client_name#fr\": \"Mon Exemple\" \\\n         }' \n</code></pre>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#using-signed-request-object-jwt","title":"Using signed request object (JWT)","text":"<p>In some use-cases like FAPI implementation, DCR request payload is a JWT.</p> <p>Example:</p> <pre><code>curl -X POST -k -H 'Content-Type: application/jwt' \\\n    -H 'Accept: application/json' \\\n    -i 'https://my-jans-server/jans-auth/restv1/register'  \\\n    --data 'eyJraWQiOiJrWTIyZXBUT......ueOg2HkjpggwAEP84jq9Q'\n</code></pre> <p>When such will be the nature of client registration requests, the following configuration properties should be set in the authorization server:</p> <ul> <li><code>dcrSignatureValidationEnabled</code> - enables DCR signature validation</li> <li><code>dcrSignatureValidationJwksUri</code> - specifies JWKS URI for all DCR's validations.</li> <li><code>dcrSignatureValidationJwks</code> - specifies JWKS for all DCR's validations.</li> </ul> <p>Configure the Janssen AS using steps explained in the link</p>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#using-software-statement","title":"Using software statement","text":"<p>A signed assertion from a trusted party, a Software statement or Software Statement Assertion (SSA), is used to dynamically register clients to an Authorization server.</p> <p>Example:</p> <pre><code>curl -X POST https://my.jans.server/jans-auth/restv1/register \\\n       -H \"Content-Type: application/json\" \\\n   --data-binary @- &lt;&lt;DATA \\\n{ \"redirect_uris\": [ \"https://client.example.org/cab1\" ], \\\n  \"software_statement\":\"eyJ0eXAi........j3ouyeYOv8\", \\\n  \"jwks_uri\":\"https://my.portal/portal/jwks\" \\\n} DATA\n</code></pre> <p>To enable client registrations using Software statements, the AS should be configured using the following configuration parameters:</p> <ul> <li><code>softwareStatementValidationType</code> - The value of this variable is one of the following:<ul> <li>NONE - validation is skipped for software statement</li> <li>SCRIPT - (default), invokes <code>getSoftwareStatementJwks</code> of dynamic registration script which has to return jwks.</li> <li>JWKS - claim name within software statement that has inlined JWKS</li> <li>JWKS_URI - claim name within software statement that points to JWKS URI that should lead to keys.</li> </ul> </li> <li><code>dcrSignatureValidationSoftwareStatementJwksURIClaim</code> - specifies claim name inside software statement that should  point to JWKS URI.</li> <li><code>dcrSignatureValidationSoftwareStatementJwksClaim</code> - specifies claim name inside software statement. Value of claim  should point to inlined JWKS.</li> <li><code>trustedSsaIssuers</code> - map of trusted SSA issuers with configuration (e.g. automatically granted scopes). When empty - no issuers validation is performed. When not empty - AS forces validation and each SSA must match at least one entry from list.</li> <li><code>automaticallyGrantedScopes</code> - automatically granted scopes for trusted issuer     <pre><code>{\n  \"https://trusted.as.com\": {\n    \"automaticallyGrantedScopes\": [\n      \"a\",\n      \"b\"\n    ]\n  },\n  \"https://another-trusted.as.com\": {\n    \"automaticallyGrantedScopes\": [\n      \"d\"\n    ]\n  }\n}\n</code></pre></li> </ul> <p>Configure the AS using steps explained in the link</p>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#special-mention-about-fapi","title":"Special mention about FAPI:","text":"<p>In case of a typical client registration request in FAPI implementation, the request object which is a signed JWT (as seen in point 3) is also called an SSA (Software statement Assertion) or DCR payload. This SSA can contain the software_statement inside it which is also a signed JWT. Each of the JWTs, the outer JWT called the SSA and the inner JWT called the software_statement are signed by different entities - the TPP and OBIE respectively.</p>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#security-pointers","title":"Security Pointers","text":"<p>If <code>dynamicRegistrationEnabled</code> is enabled in the Authorization Server, assess the following points to minimize potential exposure of sensitive personal data:</p> <ol> <li><code>trustedClientEnabled</code> and <code>dynamicRegistrationPersistClientAuthorizations</code> properties determine whether clients  are trusted and if consent should be sought from the user before releasing their personal data to the RP</li> <li><code>dynamicRegistrationScopesParamEnabled</code> controls whether default scopes are globally enabled.  If <code>dynamicRegistrationScopesParamEnabled</code> is <code>true</code> then scopes defined as default will be automatically added to any  dynamically registered client entry without consent of OP's administrator. Therefore, make an informed decision before  setting this field to <code>true</code>.</li> </ol>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#curl-commands-to-configure-jans-auth-server","title":"CURL commands to configure Jans-auth server","text":"<p>Jans-auth server is configured using Jans Config Api :</p>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#obtain-the-access-token","title":"Obtain the access token","text":"<pre><code>curl -u \"put_client_id_here:put_config_api_client_secret_here\" https://&lt;your.jans.server&gt;/jans-auth/restv1/token \\\n     -d  \"grant_type=client_credentials&amp;scope=https://jans.io/oauth/jans-auth-server/config/properties.write\"\n</code></pre>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#patch-jans-auth-server-configurations","title":"Patch jans-auth server configurations","text":"<p>Patch jans-auth server configurations to reflect <code>anExampleConfigField</code> with the value <code>anExampleConfigField_value</code></p> <pre><code>curl -X PATCH -k -H 'Content-Type: application/json-patch+json' \\\n -i 'https://&lt;your.jans.server&gt;/jans-config-api/api/v1/jans-auth-server/config' \\\n -H \"Authorization: Bearer put_access_token_here\" --data '[\n    {\n     \"op\": \"add\",\n     \"path\": \"anExampleConfigField\",\n     \"value\": \"anExampleConfigField_value\"\n     }\n    ]'\n</code></pre> <p>For example, to patch the jans-auth server configurations to reflect <code>dynamicRegistrationEnabled</code> with value as <code>true</code></p> <pre><code>curl -X PATCH -k -H 'Content-Type: application/json-patch+json' \\\n-i 'https://&lt;your.jans.server&gt;/jans-config-api/api/v1/jans-auth-server/config' \\\n-H \"Authorization: Bearer put_access_token_here\" --data '[\n {\n  \"op\": \"add\",\n  \"path\": \"dynamicRegistrationEnabled\",\n  \"value\": \"true\"\n  }\n ]'\n</code></pre>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#client-metadata","title":"Client metadata","text":"<p>Command to obtain metadata schema</p> <pre><code>jans cli --schema /components/schemas/Client\n</code></pre> <p>Output:</p> <pre><code>{\n  \"dn\": \"string\",\n  \"inum\": \"string\",\n  \"displayName\": \"string\",\n  \"clientSecret\": \"string\",\n  \"frontChannelLogoutUri\": \"string\",\n  \"frontChannelLogoutSessionRequired\": true,\n  \"registrationAccessToken\": \"string\",\n  \"clientIdIssuedAt\": \"2022-08-31T10:39:31.385Z\",\n  \"clientSecretExpiresAt\": \"2022-08-31T10:39:31.385Z\",\n  \"redirectUris\": [\n    \"https://client.example.org/cb\"\n  ],\n  \"claimRedirectUris\": [\n    \"string\"\n  ],\n  \"responseTypes\": [\n    \"code\"\n  ],\n  \"grantTypes\": [\n    \"authorization_code\"\n  ],\n  \"applicationType\": \"web\",\n  \"contacts\": [\n    \"string\"\n  ],\n  \"idTokenTokenBindingCnf\": \"string\",\n  \"logoUri\": \"string\",\n  \"clientUri\": \"string\",\n  \"policyUri\": \"string\",\n  \"tosUri\": \"string\",\n  \"jwksUri\": \"string\",\n  \"jwks\": \"{ \\\"keys\\\" : [ { \\\"e\\\" : \\\"AQAB\\\", \\\"n\\\" : \\\"gmlDX_mgMcHX..\\\" ] }\",\n  \"sectorIdentifierUri\": \"string\",\n  \"subjectType\": \"pairwise\",\n  \"idTokenSignedResponseAlg\": \"HS256\",\n  \"idTokenEncryptedResponseAlg\": \"RSA1_5\",\n  \"idTokenEncryptedResponseEnc\": \"A128CBC+HS256\",\n  \"userInfoSignedResponseAlg\": \"HS256\",\n  \"userInfoEncryptedResponseAlg\": \"RSA1_5\",\n  \"userInfoEncryptedResponseEnc\": \"A128CBC+HS256\",\n  \"requestObjectSigningAlg\": \"HS256\",\n  \"requestObjectEncryptionAlg\": \"RSA1_5\",\n  \"requestObjectEncryptionEnc\": \"A128CBC+HS256\",\n  \"tokenEndpointAuthMethod\": \"client_secret_basic\",\n  \"tokenEndpointAuthSigningAlg\": \"HS256\",\n  \"defaultMaxAge\": 1000000,\n  \"requireAuthTime\": true,\n  \"defaultAcrValues\": [\n    \"string\"\n  ],\n  \"initiateLoginUri\": \"string\",\n  \"postLogoutRedirectUris\": [\n    \"https://client.example.org/logout/page1\",\n    \"https://client.example.org/logout/page2\",\n    \"https://client.example.org/logout/page3\"\n  ],\n  \"requestUris\": [\n    \"string\"\n  ],\n  \"scopes\": [\n    \"read write dolphin\"\n  ],\n  \"claims\": [\n    \"string\"\n  ],\n  \"trustedClient\": false,\n  \"lastAccessTime\": \"2022-08-31T10:39:31.385Z\",\n  \"lastLogonTime\": \"2022-08-31T10:39:31.385Z\",\n  \"persistClientAuthorizations\": true,\n  \"includeClaimsInIdToken\": false,\n  \"refreshTokenLifetime\": 100000000,\n  \"accessTokenLifetime\": 100000000,\n  \"customAttributes\": [\n    {\n      \"name\": \"name, displayName, birthdate, email\",\n      \"multiValued\": true,\n      \"values\": [\n        \"string\"\n      ]\n    }\n  ],\n  \"customObjectClasses\": [\n    \"string\"\n  ],\n  \"rptAsJwt\": true,\n  \"accessTokenAsJwt\": true,\n  \"accessTokenSigningAlg\": \"HS256\",\n  \"disabled\": false,\n  \"authorizedOrigins\": [\n    \"string\"\n  ],\n  \"softwareId\": \"4NRB1-0XZABZI9E6-5SM3R\",\n  \"softwareVersion\": \"2.1\",\n  \"softwareStatement\": \"string\",\n  \"attributes\": {\n    \"tlsClientAuthSubjectDn\": \"string\",\n    \"runIntrospectionScriptBeforeAccessTokenAsJwtCreationAndIncludeClaims\": true,\n    \"keepClientAuthorizationAfterExpiration\": true,\n    \"allowSpontaneousScopes\": true,\n    \"spontaneousScopes\": [\n      \"string\"\n    ],\n    \"spontaneousScopeScriptDns\": [\n      \"string\"\n    ],\n    \"updateTokenScriptDns\": [\n      \"string\"\n    ],\n    \"backchannelLogoutUri\": [\n      \"string\"\n    ],\n    \"backchannelLogoutSessionRequired\": true,\n    \"additionalAudience\": [\n      \"string\"\n    ],\n    \"postAuthnScripts\": [\n      \"string\"\n    ],\n    \"consentGatheringScripts\": [\n      \"string\"\n    ],\n    \"introspectionScripts\": [\n      \"string\"\n    ],\n    \"rptClaimsScripts\": [\n      \"string\"\n    ],\n    \"ropcScripts\": [\n      \"string\"\n    ],\n    \"parLifetime\": 0,\n    \"requirePar\": true,\n    \"jansAuthSignedRespAlg\": \"string\",\n    \"jansAuthEncRespAlg\": \"string\",\n    \"jansAuthEncRespEnc\": \"string\",\n    \"jansSubAttr\": \"string\",\n    \"redirectUrisRegex\": \"string\",\n    \"jansAuthorizedAcr\": [\n      \"string\"\n    ],\n    \"jansDefaultPromptLogin\": true\n  },\n  \"backchannelTokenDeliveryMode\": \"poll\",\n  \"backchannelClientNotificationEndpoint\": \"string\",\n  \"backchannelAuthenticationRequestSigningAlg\": \"RS256\",\n  \"backchannelUserCodeParameter\": true,\n  \"expirationDate\": \"2022-08-31T10:39:31.385Z\",\n  \"deletable\": false,\n  \"jansId\": \"string\",\n  \"description\": \"string\"\n}\n</code></pre>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#signed-dcr-and-ssa-validation","title":"Signed DCR and SSA validation","text":"<p>In OpenBanking case DCR (Dynamic Client Request) is signed and must contain SSA (Software Statement Assertion) inside it.</p> <p>Non-Normative Example: <pre><code>POST /register HTTP/1.1\nContent-Type: application/jwt\nAccept: application/json\nHost: auth.bankone.com\n\neyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJJREFtYX...\n</code></pre></p> <p>Decoded DCR Example:</p> <pre><code>{\n    \"typ\": \"JWT\",\n    \"alg\": \"ES256\",\n    \"kid\": \"ABCD1234\"\n}\n{\n    \"iss\": \"Amazon TPPID\",\n    \"iat\": 1492760444,\n    \"exp\": 1524296444,\n    \"aud\": \"https://authn.gluu.org\",\n    \"scope\": \"openid makepayment\",\n    \"token_endpoint_auth_method\": \"private_key_jwt\",\n    \"grant_types\": [\"authorization_code\", \"refresh_token\", \"client_credentials\"],\n    \"response_types\": [\"code\"],\n    \"id_token_signed_response_alg\": \"ES256\",\n    \"request_object_signing_alg\": \"ES256\",\n    \"software_id\": \"65d1f27c-4aea-4549-9c21-60e495a7a86f\",\n    \"software_statement\":  \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJlbXB0eSIsInN1YiI6IjEyMzQ1Njc4OTAiLCJuYW1lIjoiSm9obiBEb2UiLCJhZG1pbiI6dHJ1ZSwic2NvcGUiOiJzY29wZTEgc2NvcGUyIiwiY2xhaW1zIjoiY2xhaW0xIGNsYWltMiIsImlhdCI6MTY2OTgwNjc2MywiZXhwIjoxNjY5ODEwMzYzfQ.db0WQh2lmHkNYCWT8tSW684hqWTPJDTElppy42XM_lc\"\n}\n{\n    Signature\n}\n</code></pre> <p>AS has <code>dcrSsaValidationConfigs</code> configuration value which holds json array. It can be used to validated both DCR and SSA.</p> <p>Single item of this array has following properties:</p> <ul> <li>id - REQUIRED primary key for the entity</li> <li>type - REQUIRED either <code>ssa</code> or <code>dcr</code></li> <li>displayName - Human friendly name in case we build an admin GUI for this  </li> <li>description - Human friendly details </li> <li>scope - For SSA only -- list of allowed scopes the issuer can enable the client to request automatically. If not present, all scopes are allowed.</li> <li>allowed_claims - Any claims not listed in this list will be dropped. If not present, all claims are allowed.</li> <li>jwks - Public key </li> <li>jwks_uri - URI of public key</li> <li>issuers - For MTLS, list of issuers trusted </li> <li>configuration_endpoint - points to discovery page, e.g. <code>https://examle.com/.well-known/openid-configuration</code></li> <li>configuration_endpoint_claim - e.g. <code>ssa_jwks_endpoint</code></li> <li>shared_secret -  for MTLS HMAC</li> </ul> <p>One of <code>jwks</code>, <code>jwks_uri</code> or <code>issuers</code> or <code>configuration_endpoint</code> is required.</p> <p>Non-normative example of <code>dcrSsaValidationConfigs</code></p> <pre><code>[ {\n  \"id\" : \"735ee1c0-895d-4398-9c1b-9ad852257cc0\",\n  \"type\" : \"DCR\",\n  \"scopes\" : [ \"read\", \"write\" ],\n  \"allowedClaims\" : [ \"exp\", \"iat\" ],\n  \"jwks\" : \"{jwks here}\",\n  \"issuers\" : [ \"Acme\" ],\n  \"sharedSecret\" : \"secret\"\n}, {\n  \"id\" : \"7907cd0b-0f9f-4b4f-aaa2-0d0614546246\",\n  \"type\" : \"SSA\",\n  \"scopes\" : [ \"my_read\", \"my_write\" ],\n  \"allowedClaims\" : [ \"test_exp\", \"test_iat\" ],\n  \"jwks\" : \"{jwks here}\",\n  \"issuers\" : [ \"jans-auth\" ],\n  \"sharedSecret\" : \"secret\"\n}, {\n  \"id\" : \"1e95c9b1-04d0-4440-9362-88f4e1e62d76\",\n  \"type\" : \"SSA\",\n  \"jwks\" : \"{jwks here}\",\n  \"issuers\" : [ \"empty\" ],\n  \"sharedSecret\" : \"secret\"\n} ]\n</code></pre>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#signed-dcr-validation","title":"Signed DCR validation","text":"<p>DCR can be validated with two approaches.</p> <p>Via <code>dcrSsaValidationConfigs</code> configuration property - RECOMMENDED</p> <p>When create entry in <code>dcrSsaValidationConfigs</code> configuration property : - <code>type</code> MUST be equal to <code>DCR</code> value - <code>issuers</code> MUST have value which equals to <code>iss</code> claim in DCR.</p> <p>Via other configuration properties</p> <ul> <li>trustedSsaIssuers - map of trusted SSA issuers with configuration (e.g. automatically granted scopes). When empty - no issuers validation is performed. When not empty - AS forces validation and each SSA must match at least one entry from list.</li> <li>automaticallyGrantedScopes - automatically granted scopes for trusted issuer     <pre><code>{\n  \"https://trusted.as.com\": {\n    \"automaticallyGrantedScopes\": [\n      \"a\",\n      \"b\"\n    ]\n  },\n  \"https://another-trusted.as.com\": {\n    \"automaticallyGrantedScopes\": [\n      \"d\"\n    ]\n  }\n}\n</code></pre></li> <li>dcrSignatureValidationJwks - specifies JWKS for DCR's validations</li> <li>dcrSignatureValidationJwksUri - specifies JWKS URI for  DCR's validations</li> <li>dcrSignatureValidationSharedSecret - if HMAC is used, this is the shared secret</li> <li>dcrSignatureValidationEnabled - boolean value enables DCR signature validation. Default is false</li> <li>dcrSignatureValidationSoftwareStatementJwksURIClaim - specifies claim name inside software statement. Value of claim should point to JWKS URI</li> <li>dcrSignatureValidationSoftwareStatementJwksClaim - specifies claim name inside software statement. Value of claim should point to inlined JWKS </li> <li>dcrAuthorizationWithClientCredentials - boolean value indicating if DCR authorization to be performed using client credentials</li> </ul>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#ssa-validation","title":"SSA Validation","text":"<p>SSA is validated based on <code>softwareStatementValidationType</code> which is enum.</p> <ol> <li>softwareStatementValidationType=builtin - validation is performed against <code>dcrSsaValidationConfigs</code> configuration property, where</li> <li><code>type</code> MUST be equal to <code>SSA</code> value</li> <li><code>issuers</code> MUST have value which equals to <code>iss</code> claim in DCR.</li> <li>softwareStatementValidationType=script - jwks and hmac secret are returned by dynamic client registration script</li> <li>softwareStatementValidationType=jwks_uri, allows to specify jwks_uri claim name from software_statement. Claim name specified by <code>softwareStatementValidationClaimName</code> configuration property.</li> <li>softwareStatementValidationType=jwks, allows to specify jwks claim name from software_statement. Claim name specified by <code>softwareStatementValidationClaimName</code> configuration property.</li> <li>softwareStatementValidationType=none, no validation.</li> </ol>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#customizing-the-behavior-of-the-as-using-interception-script","title":"Customizing the behavior of the AS using Interception script","text":"<p>Janssen's allows developers to register a client with the Authorization Server (AS) without any intervention by the administrator. By default, all clients are given the same default scopes and attributes. Through the use of an interception script, this behavior can be modified. These scripts can be used to analyze the registration request and apply customizations to the registered client. For example, a client can be given specific scopes by analyzing the Software Statement that is sent with the registration request.</p> <p>Learn more in the Client Registration Script Guide</p>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#the-use-of-attestation-in-dynamic-client-registration","title":"The Use of Attestation in Dynamic Client Registration","text":"<p>AS supports \"The Use of Attestation in OAuth 2.0 Dynamic Client Registration\" specification draft.</p> <p>Specification draft does not define exact attestation request/response formats. Thus AS supports Attestation calls to Verifier via <code>ClientRegistrationType</code> custom script type.</p> <p>Use <code>createClient</code> method of <code>ClientRegistrationType</code> to prevent client creation if attestation result does not satisfy expectation.</p> <pre><code>    def createClient(self, context):\n        print \"Client registration. CreateClient method\"\n        registerRequest = context.getRegisterRequest()\n        configurationAttributes = context.getConfigurationAttibutes()\n        client = context.getClient()\n\n        # getting evidence as string or as JWT\n        evidenceAsString = registerRequest.getEvidence()\n        evidenceAsJwt = context.getEvidence()\n\n        # following code depends on attestation client used to make calls to Verifier\n        attestationResult = attestationClient.attestation(evidence)\n        if attestationResult.isFail:\n            print \"Attestation result forbids client creation\"\n            return False\n\n        print \"Attestation result is OK\"\n        return True            \n</code></pre> <p>Configuration options - <code>dcrAttestationEvidenceRequired</code> - Boolean value indicating if DCR attestation evidence is required. Default value is <code>false</code>.</p> <p>If <code>evidence</code> request parameter is not present and <code>dcrAttestationEvidenceRequired</code> is <code>true</code> AS returns <code>stale_evidence</code> error:</p> <pre><code>HTTP/1.1 400 Bad Request\nContent-Type: application/json\nCache-Control: no-store\nPragma: no-cache\n\n{\n  \"error\": \"stale_evidence\",\n  \"error_description\": \"The provided evidence is not current.\",\n  \"nonce\": \"lBjvTtuPbpzIaqyiAOOkrIol3WmflPUUepzUXNDFuUgMKUL\"\n}\n</code></pre> <p>It is common to get <code>nonce</code> value from Attestation Server. In this case set <code>dcrAttestationEvidenceRequired=false</code> and throw error from custom script.</p> <pre><code>    def createClient(self, context):\n        evidenceAsString = registerRequest.getEvidence()\n\n        if StringHelper.isEmpty(evidenceAsString)\n            nonceFromVerifier = attestationClient.requestNonce()\n            context.createStaleEvidenceWebApplicationException(nonceFromVerifier)\n            return False\n\n        ...\n\n        print \"Attestation result is OK\"\n        return True            \n</code></pre> <p><code>context.createStaleEvidenceWebApplicationException(nonceFromVerifier)</code> leads to <code>stale_evidence</code> error creation, see example above (<code>nonceFromVerifier</code> must be string value).</p> <p>In case goal is to create own custom error, please use standard <code>context.createWebApplicationException</code> methods and return <code>False</code> from script to prevent client creation.</p> <p>Example <pre><code>    entity = &lt;construct error message&gt;\n    context.createWebApplicationException(400, entity)\n</code></pre></p>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#dynamic-registration-custom-attributes","title":"Dynamic registration custom attributes","text":"","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#crud-operations","title":"CRUD Operations","text":"<p>Janssen Server allows client management through client configuration endpoint (RFC 7592).</p> <p>JSON response to client registration request contains <code>registration_client_uri</code> and <code>registration_access_token</code> data elements. The URI mentioned using <code>registration_client_uri</code> provides functionality to read, update and delete the client. This endpoint is a protected endpoint where request has to be authenticated using access token <code>registration_access_token</code>.</p>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#read-client-metadata","title":"Read client metadata","text":"<p>A read request to the same client that got created in earlier section should be as shown in the example below. HTTP method <code>GET</code> is used to send the request which signifies that it is a request to <code>read</code> client metadata.</p> <pre><code>curl -k -H 'Authorization: Bearer &lt;REDACTED&gt;' \\\ni 'https://my.jans.server/jans-auth/restv1/register?client_id=85192707-a38c-496c-806c-ef01a6a3ae4a'\n</code></pre> <p>JSON response from Janssen Server will contain the current state of client metadata.</p>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#update-client-metadata","title":"Update client metadata","text":"<p>Client metadata can be updated by sending request with <code>PUT</code> HTTP method to <code>registration_client_uri</code>. Janssen Server replaces current metadata with the one sent with update request as outlined in the specification</p>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#delete-client","title":"Delete Client","text":"<p>Client can be deleted by sending a request using <code>DELETE</code> method to <code>registration_client_uri</code>.</p> <p>A successful delete action will invalidate the \"client_id\", \"client_secret\", and \"registration_access_token\" for this client, thereby preventing the \"client_id\" from being used at either the authorization endpoint or token endpoint of the authorization server.</p>","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/client-registration/#internationalization-for-client-metadata","title":"Internationalization for Client metadata","text":"","tags":["administration","auth-server","endpoint","DCR","dynamic client registration"]},{"location":"janssen-server/auth-server/endpoints/clientinfo/","title":"Clientinfo Endpoint","text":"<p><code>/clientinfo</code> endpoint is an OAuth2 protected endpoint that is used to retrieve claims about registered client.</p> <p>URL to access clientinfo endpoint on Janssen Server is listed in the response of Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p><code>clientinfo_endpoint</code> claim in the response specifies the URL for clientinfo endpoint. By default, clientinfo endpoint looks like below:</p> <pre><code>https://janssen.server.host/jans-auth/restv1/clientinfo\n</code></pre> <p>Since clientinfo endpoint is an OAuth2 protected resource, a valid access token with appropriate scope is required to access the endpoint. More information about request and response of the clientinfo endpoint can be found in the OpenAPI specification of jans-auth-server module.</p>","tags":["administration","auth-server","clientinfo","endpoint"]},{"location":"janssen-server/auth-server/endpoints/clientinfo/#disabling-the-endpoint-using-feature-flag","title":"Disabling The Endpoint Using Feature Flag","text":"<p><code>/clientinfo</code> endpoint can be enabled or disable using clientinfo feature flag. Use Janssen Text-based UI(TUI) or Janssen command-line interface to perform this task.</p> <p>When using TUI, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>-&gt;<code>enabledFeatureFlags</code> to screen below. From here, enable or disable <code>clientinfo</code> flag as required.</p> <p></p>","tags":["administration","auth-server","clientinfo","endpoint"]},{"location":"janssen-server/auth-server/endpoints/clientinfo/#configuration-properties","title":"Configuration Properties","text":"<p>Clientinfo endpoint can be further configured using Janssen Server configuration properties listed below. When using Janssen Text-based UI(TUI) to configure the properties, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>.</p> <ul> <li>clientInfoEndpoint</li> <li>mtlsClientInfoEndpoint</li> </ul>","tags":["administration","auth-server","clientinfo","endpoint"]},{"location":"janssen-server/auth-server/endpoints/clientinfo/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","clientinfo","endpoint"]},{"location":"janssen-server/auth-server/endpoints/configuration/","title":"OpenID Configuration Endpoint","text":"","tags":["administration","auth-server","well-known","configuration","endpoint"]},{"location":"janssen-server/auth-server/endpoints/configuration/#openid-configuration-endpoint-aka-well-knownopenid-configuration","title":"OpenID Configuration Endpoint aka <code>.well-known/openid-configuration</code>","text":"<p>The Configuration Endpoint returns both the OP server metadata, and OAuth AS metdata, most of which is defined in the OpenID Discovery Spec, although other configuration metadata is defined in other OpenID specifications, or in OAuth specifications.</p> <p>If you want to customize the configuration response, you can use the OpenID Config Interception Script, which enables you to filter the results, modify claim values, or add claims.</p> <p>If you want to explicitly allow only certain OpenID Metadata claims, you can supply a list of the claims in the <code>opConfigMetadataAllowList</code> Auth Server Property.</p> <p>Below is a list of all the current available claims, and where they are specified.</p> Claim Origin access_token_signing_alg_values_supported ? acr_values_supported OpenID authorization_encryption_alg_values_supported ? authorization_encryption_enc_values_supported ? authorization_endpoint OpenID authorization_signing_alg_values_supported ? backchannel_authentication_endpoint ? backchannel_logout_session_supported ? backchannel_logout_supported ? backchannel_token_delivery_modes_supported ? backchannel_user_code_parameter_supported ? check_session_iframe ? claim_types_supported ? claims_locales_supported ? claims_parameter_supported ? claims_supported OpenID clientinfo_endpoint ? device_authorization_endpoint ? display_values_supported ? dpop_signing_alg_values_supported ? end_session_endpoint ? frontchannel_logout_session_supported ? frontchannel_logout_supported ? grant_types_supported ? id_token_encryption_alg_values_supported ? id_token_encryption_enc_values_supported ? id_token_signing_alg_values_supported ? id_token_token_binding_cnf_values_supported ? introspection_endpoint ? issuer OpenID jwks_uri OpenID op_tos_uri OpenID pushed_authorization_request_endpoint ? registration_endpoint OpenID request_object_encryption_alg_values_supported OpenID request_object_encryption_enc_values_supported OpenID request_object_signing_alg_values_supported OpenID request_parameter_supported OpenID request_uri_parameter_supported OpenID require_pushed_authorization_requests ? require_request_uri_registration ? response_modes_supported OpenID response_types_supported OpenID revocation_endpoint ? scopes_supported ? service_documentation ? session_revocation_endpoint ? ssa_endpoint Janssen subject_types_supported OpenID tls_client_certificate_bound_access_tokens ? token_endpoint OpenID token_endpoint_auth_methods_supported OpenID token_endpoint_auth_signing_alg_values_supported OpenID ui_locales_supported OpenID userinfo_encryption_alg_values_supported OpenID userinfo_encryption_enc_values_supported OpenID userinfo_endpoint OpenID userinfo_signing_alg_values_supported OpenID","tags":["administration","auth-server","well-known","configuration","endpoint"]},{"location":"janssen-server/auth-server/endpoints/configuration/#notes-on-specific-op-server-metadata-claims","title":"Notes on specific OP Server Metadata claims","text":"<ul> <li> <p>claims_supported Each user claim (in Jans jargon, \"Attribute\") has a property called <code>jansHideOnDiscovery</code>--if you don't want a claim to appear in <code>.well-known/openid-configuration</code>, set this to <code>true</code> for the Attribute entity.</p> </li> <li> <p>ssa_endpoint This is the endpoint which issues Software Statement Assertions JWT's. It is an OAuth protected endpoint.</p> </li> </ul>","tags":["administration","auth-server","well-known","configuration","endpoint"]},{"location":"janssen-server/auth-server/endpoints/device-authorization/","title":"Device Authorization Endpoint","text":"","tags":["administration","auth-server","endpoint","device authorization","RFC 8628"]},{"location":"janssen-server/auth-server/endpoints/device-authorization/#device-authorization-endpoint_1","title":"Device Authorization endpoint","text":"<p>The URI to invoke the Device Authorization Endpoint in Janssen Auth Server can be found by checking the introspection_endpoint claim of the OpenID Connect configuration response, typically deployed at <code>https://&lt;my.jans.server&gt;/.well-known/openid-configuration</code></p> <p><code>\"device_authorization_endpoint\" : \"https://&lt;my.jans.server&gt;/jans-auth/restv1/device_authorization\"</code></p>","tags":["administration","auth-server","endpoint","device authorization","RFC 8628"]},{"location":"janssen-server/auth-server/endpoints/device-authorization/#invoking-the-endpoint-in-device-authorization-flow","title":"Invoking the endpoint in Device Authorization Flow","text":"<p>The Device Authorization Grant defined by RFC 8628 contains a call to the Device Authorization endpoint in Step 2 of the diagram below. The details of the entire flow can be found in this article</p> <pre><code>sequenceDiagram\nautonumber 1\n    title Oauth2.0 Device Authorization flow\n\n    participant User\n    participant Browser on Computer / Smartphone\n    participant Device App\n    participant Jans AS\n    participant Third Party App\n\n    User-&gt;&gt;Device App:Opens an app on device\n    Device App-&gt;&gt;Jans AS:Sends authorization request \\n\"jans-server.com/jans-auth/restv1/device_authorization\"\n    Jans AS-&gt;&gt;Device App:Response - \\nuser_code, device_code, verification_url, interval, expiration\n    Device App -&gt;&gt;User: Instructs the user to access Verification URL \\nand enter user_code\n    note over Device App:Device App will keep polling AS for Access Token \\nuntil device authorization is completed\n    loop till Device App recieves Access Token:\n    Device App-&gt;&gt;Jans AS:request Access Token\n    Jans AS-&gt;&gt;Device App:Response - \\naccess_denied \\nOR expired_token \\nOR authorization_pending \\nOR Access token\n    end\n    User-&gt;&gt;Browser on Computer / Smartphone:Opens a browser \\nand access verification URL\n    Browser on Computer / Smartphone-&gt;&gt;Jans AS:send user_code to verification URL\n    Jans AS --&gt;&gt; Browser on Computer / Smartphone :Login and authorization prompt\n    Browser on Computer / Smartphone-&gt;&gt;Jans AS:Authentication and consent\n    Jans AS-&gt;&gt;Jans AS: Mark device as Authorized\n    note over Jans AS:Subsequent polling by the Device App \\nwill return an Access Token as indicated \\nby the loop above\n    Device App-&gt;&gt;Third Party App:Invoke API with Access Token\n    Third Party App-&gt;&gt;Device App: return Response</code></pre> <p>Request: <pre><code>POST /restv1/device_authorization HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nHost: test.jans.org\nAuthorization: Basic MTIzLTEyMy0xMjM6WkE1aWxpTFFDYUR4\n\nclient_id=123-123-123&amp;scope=openid+profile+address+email+phone\n</code></pre> Response: <pre><code>HTTP/1.1 200\nContent-Length: 307\nContent-Type: application/json\nServer: Jetty(9.4.19.v20190610)\n\n{\n    \"user_code\": \"SJFP-DTPL\",\n    \"device_code\": \"aeb28bdc90d806ac58d4b0f832f06c3ac9c4bd03292f0c09\",\n    \"interval\": 5,\n    \"verification_uri_complete\": \"https://test.jans.io:8443/device-code?user_code=SJFP-DTPL\",\n    \"verification_uri\": \"https://test.jans.io:8443/device-code\",\n    \"expires_in\": 1800\n}\n</code></pre></p>","tags":["administration","auth-server","endpoint","device authorization","RFC 8628"]},{"location":"janssen-server/auth-server/endpoints/end-session/","title":"End Session Endpoint","text":"<p>Janssen Server's <code>/end_session</code> endpoint supports logout using OpenId Connect RP-initiated Logout mechanism. When using OpenID Connect Logout, it is recommended to use Front-Channel Logout. In Front-Channel Logout the browser receives a page with a list of application logout urls within an iframe. This prompts the browser to call each application logout individually and the OpenID Connect end-session endpoint via Javascript.</p> <p>URL to access end session endpoint on Janssen Server is listed in the response of Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p><code>end_session_endpoint</code> claim in the response specifies the URL for end session endpoint. By default, end session endpoint looks like below:</p> <pre><code>https://janssen.server.host/jans-auth/restv1/end_session\n</code></pre> <p>Refer to this article from Gluu Server documentation to understand how end session endpoint works in Janssen Server.</p> <p>More information about request and response of the end session endpoint can be found in the OpenAPI specification of jans-auth-server module.</p>","tags":["administration","auth-server","end-session","endpoint"]},{"location":"janssen-server/auth-server/endpoints/end-session/#disabling-the-endpoint-using-feature-flag","title":"Disabling The Endpoint Using Feature Flag","text":"<p><code>/end_session</code> endpoint can be enabled or disable using END_SESSION feature flag. Use Janssen Text-based UI(TUI) or Janssen command-line interface to perform this task.</p> <p>When using TUI, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>-&gt;<code>enabledFeatureFlags</code> to screen below. From here, enable or disable <code>END_SESSION</code> flag as required.</p> <p></p>","tags":["administration","auth-server","end-session","endpoint"]},{"location":"janssen-server/auth-server/endpoints/end-session/#configuration-properties","title":"Configuration Properties","text":"<p>End session endpoint can be further configured using Janssen Server configuration properties listed below. When using Janssen Text-based UI(TUI) to configure the properties, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>.</p> <ul> <li>allowEndSessionWithUnmatchedSid</li> <li>endSessionEndpoint</li> <li>endSessionWithAccessToken</li> <li>mtlsEndSessionEndpoint</li> <li>rejectEndSessionIfIdTokenExpired</li> <li>allowPostLogoutRedirectWithoutValidation</li> <li>forceIdTokenHintPresence</li> </ul> <p>Apart from the above-mentioned server properties, the properties relevant to individual clients can be configured during client registration or can be edited later. When using Janssen Text-based UI(TUI) to configure the properties, navigate via <code>Auth Server</code>-&gt; <code>Clients</code>-&gt;<code>logout</code> as show in image below:</p> <p></p>","tags":["administration","auth-server","end-session","endpoint"]},{"location":"janssen-server/auth-server/endpoints/end-session/#interception-scripts","title":"Interception Scripts","text":"<p>Response from end session endpoint can be further customized using end session interception script.</p> <p>This script can be used to customize the HTML response generated from end session endpoint.</p>","tags":["administration","auth-server","end-session","endpoint"]},{"location":"janssen-server/auth-server/endpoints/end-session/#difference-with-global-token-revocation","title":"Difference with Global Token Revocation","text":"<p>The End Session endpoint is used to terminate a user's session from a single application (log out), while the Global Token Revocation endpoint (<code>/global-token-revocation</code>) is used to invalidate all of a user's sessions and tokens across all applications. This is a more forceful measure that ensures all access is revoked, which is useful in situations where a user's account may have been compromised.</p> <p>For more details, see Global Token Revocation.</p>","tags":["administration","auth-server","end-session","endpoint"]},{"location":"janssen-server/auth-server/endpoints/end-session/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","end-session","endpoint"]},{"location":"janssen-server/auth-server/endpoints/global-token-revocation/","title":"Global Token Revocation Endpoint","text":"<p>The Global Token Revocation endpoint is a critical security feature that allows for the immediate invalidation of all tokens and sessions associated with a user. This is particularly useful in scenarios where a user's account may have been compromised, as it ensures that all active sessions are terminated and all tokens are revoked, preventing any further unauthorized access.</p> <p>Janssen Server provides this endpoint implementation to allow greater control and better management of sessions on OP.</p> <p>The URL for the Global Token Revocation endpoint is specified in the Janssen Server's well-known configuration endpoint response:</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p>The <code>global_token_revocation_endpoint</code> claim in the response specifies the URL for the endpoint, which by default is:</p> <pre><code>https://janssen.server.host/jans-auth/restv1/global-token-revocation\n</code></pre> <p>More information about request and response of the global token revocation endpoint can be found in the OpenAPI specification of jans-auth-server module.</p>","tags":["administration","auth-server","session-revocation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/global-token-revocation/#usage","title":"Usage","text":"<p>A request to this endpoint can revoke all tokens and sessions of one particular user. Use the request parameters to specify criteria to select the user. If there are multiple users matching the given criteria, the first found user will be affected.</p> <p>Sample request <pre><code>POST /global-token-revocation\nHost: example.com\nContent-Type: application/json\nAuthorization: Bearer f5641763544a7b24b08e4f74045\n\n{\n  \"sub_id\": {\n    \"format\": \"uid\",\n    \"id\": \"breakfast\"\n  }\n}\n</code></pre></p> <ul> <li><code>format</code> - specifies user attribute name</li> <li><code>id</code> - specifies user attribute value</li> </ul> <p>In sample above it identifies user by <code>uid=breakfast</code>.</p> <p>Sample response</p> <pre><code>HTTP/1.1 204\n</code></pre> <ul> <li>View full sample execution log here</li> </ul>","tags":["administration","auth-server","session-revocation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/global-token-revocation/#disabling-the-endpoint-using-feature-flag","title":"Disabling The Endpoint Using Feature Flag","text":"<p><code>Global Token Revocation</code> endpoint can be enabled or disable using GLOBAL_TOKEN_REVOCATION feature flag. Use Janssen Text-based UI(TUI) or Janssen command-line interface to perform this task.</p> <p>When using TUI, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>-&gt;<code>enabledFeatureFlags</code> to screen below. From here, enable or disable <code>GLOBAL_TOKEN_REVOCATION</code> flag as required.</p> <p></p>","tags":["administration","auth-server","session-revocation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/global-token-revocation/#required-scope","title":"Required Scope","text":"<p>A client must have the following scope to use this endpoint:</p> <ul> <li><code>global_token_revocation</code></li> </ul>","tags":["administration","auth-server","session-revocation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/global-token-revocation/#difference-with-front-channel-end-session","title":"Difference with Front-Channel End Session","text":"<p>The Global Token Revocation endpoint provides a comprehensive approach to session termination by revoking all tokens and sessions associated with a user across all applications. This is a \"back-end\" operation that ensures all access is immediately cut off.</p> <p>In contrast, the Front-Channel End Session (<code>/end_session</code>) is a \"front-end\" mechanism that logs a user out of a single application. It relies on the user's browser to clear the session cookie and does not guarantee that all tokens and sessions are invalidated across all applications.</p> <p>For more details, see End Session.</p>","tags":["administration","auth-server","session-revocation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/introspection/","title":"Introspection Endpoint","text":"<p>Introspection endpoint allows a protected resource to determine the active state of an OAuth 2.0 token and to determine meta-information about this token. This endpoint can be used to introspect both opaque token (i.e. reference tokens) and structured tokens(i.e. value tokens). This endpoint conforms to OAuth2 token introspection specifications.</p> <p>The URI to invoke the introspection endpoint in Janssen Server can be found by checking the <code>introspection_endpoint</code> claim of the OpenID Connect configuration response, typically deployed at <code>https://janssen.server.host/.well-known/openid-configuration</code></p> <p>\"introspection_endpoint\" : \"https://janssen.server.host/jans-auth/restv1/introspection\" `</p> <p>More information about request and response of the Introspection endpoint can be found in the OpenAPI specification of jans-auth-server module.</p> <p>Request parameters</p> <ul> <li><code>token</code> - REQUIRED.  The string value of the token.  For access tokens, this is the \"access_token\" value returned from the token endpoint</li> <li><code>token_type_hint</code> - OPTIONAL.  A hint about the type of the token submitted for introspection. Not used in current implementation of the AS. </li> <li><code>response_as_jwt</code> - OPTIONAL. Boolean value with default value false. If true, returns introspection response as JWT (signed based on client configuration used for authentication to Introspection Endpoint).</li> </ul>","tags":["administration","auth-server","endpoint","introspection","accessTokenAsJwt","introspectionScriptBackwardCompatibility"]},{"location":"janssen-server/auth-server/endpoints/introspection/#sample-get-request","title":"Sample GET Request","text":"","tags":["administration","auth-server","endpoint","introspection","accessTokenAsJwt","introspectionScriptBackwardCompatibility"]},{"location":"janssen-server/auth-server/endpoints/introspection/#request","title":"Request","text":"<pre><code>curl -X 'GET'   'https://janssen.server.host/jans-auth/restv1/introspection?token=368fea2b-be14-4d30-bd57-bcc4cde2033c&amp;response_as_jwt=false'   -H 'accept: application/json' -H   \"Authorization: Bearer 111d51a4-2828-4b47-abce-77034cddcfb5\"\n</code></pre>","tags":["administration","auth-server","endpoint","introspection","accessTokenAsJwt","introspectionScriptBackwardCompatibility"]},{"location":"janssen-server/auth-server/endpoints/introspection/#response","title":"Response","text":"<pre><code>{\n    \"sub\": \"\",\n    \"iss\": \"https://janssen.server.host\",\n    \"active\": true,\n    \"token_type\": \"Bearer\",\n    \"client_id\": \"1800.df1bb233-10b8-40ed-bbb9-07da50892a35\",\n    \"aud\": \"1800.df1bb233-10b8-40ed-bbb9-07da50892a35\",\n    \"nbf\": null,\n    \"scope\": \"https://jans.io/oauth/config/scripts.write\",\n    \"acr_values\": null,\n    \"cnf\": null,\n    \"exp\": 1668705523,\n    \"iat\": 1668705223,\n    \"jti\": null,\n    \"username\": null\n}\n</code></pre>","tags":["administration","auth-server","endpoint","introspection","accessTokenAsJwt","introspectionScriptBackwardCompatibility"]},{"location":"janssen-server/auth-server/endpoints/introspection/#sample-post-request","title":"Sample POST Request","text":"","tags":["administration","auth-server","endpoint","introspection","accessTokenAsJwt","introspectionScriptBackwardCompatibility"]},{"location":"janssen-server/auth-server/endpoints/introspection/#request_1","title":"Request","text":"<pre><code>curl -X 'POST' \\\n  'https://janssen.server.host/jans-auth/restv1/introspection' \\\n  -H 'accept: application/json' \\\n  -H 'Content-Type: application/x-www-form-urlencoded' \\\n  -d 'token=eyJra....3ZkB-Ajwg'  \n  -H \"Authorization: Bearer eyJra...BpKo7g\"\n</code></pre>","tags":["administration","auth-server","endpoint","introspection","accessTokenAsJwt","introspectionScriptBackwardCompatibility"]},{"location":"janssen-server/auth-server/endpoints/introspection/#response_1","title":"Response","text":"<pre><code>{\n    \"sub\": \"\",\n    \"iss\": \"https://janssen.server.host\",\n    \"active\": true,\n    \"token_type\": \"Bearer\",\n    \"client_id\": \"3000.5829c1f8-7554-41ab-a7d6-3513a5e9c4ad\",\n    \"aud\": \"3000.5829c1f8-7554-41ab-a7d6-3513a5e9c4ad\",\n    \"nbf\": null,\n    \"scope\": \"\",\n    \"acr_values\": null,\n    \"cnf\": null,\n    \"exp\": 1668941216,\n    \"iat\": 1668781885,\n    \"jti\": null,\n    \"username\": null\n}\n</code></pre>","tags":["administration","auth-server","endpoint","introspection","accessTokenAsJwt","introspectionScriptBackwardCompatibility"]},{"location":"janssen-server/auth-server/endpoints/introspection/#response-as-jwt","title":"Response as JWT","text":"<p>Response is returned as JWT if <code>Accept</code> header has value <code>application/token-introspection+jwt</code> or otherwise if explicit endpoint parameter <code>response_as_jwt</code> is set to <code>true</code>.</p> <pre><code>POST /introspect HTTP/1.1\nHost: as.example.com\nAccept: application/token-introspection+jwt\n</code></pre> <p>Sample decoded JWT payload</p> <pre><code>{\n  \"iss\":\"https://as.example.com/\",\n  \"aud\":\"https://rs.example.com/resource\",\n  \"iat\":1514797892,\n  \"token_introspection\":\n     {\n        \"active\":true,\n        \"iss\":\"https://as.example.com/\",\n        \"aud\":\"https://rs.example.com/resource\",\n        \"iat\":1514797822,\n        \"exp\":1514797942,\n        \"client_id\":\"paiB2goo0a\",\n        \"scope\":\"read write dolphin\",\n        \"sub\":\"Z5O3upPC88QrAjx00dis\",\n        \"birthdate\":\"1982-02-01\",\n        \"given_name\":\"John\",\n        \"family_name\":\"Doe\",\n        \"jti\":\"t1FoCCaZd4Xv4ORJUWVUeTZfsKhW30CQCrWDDjwXy6w\"\n     }\n} \n</code></pre> <p>Sample response (line breaks in payload is for convenience)</p> <pre><code>HTTP/1.1 200 OK\nContent-Type: application/token-introspection+jwt\n\neyJraWQiOiJ3RzZEIiwidHlwIjoidG9rZW4taW50cm9zcGVjdGlvbitqd3QiLCJhbGc\niOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL2FzLmV4YW1wbGUuY29tLyIsImF1ZCI6I\nmh0dHBzOi8vcnMuZXhhbXBsZS5jb20vcmVzb3VyY2UiLCJpYXQiOjE1MTQ3OTc4OTIs\nInRva2VuX2ludHJvc3BlY3Rpb24iOnsiYWN0aXZlIjp0cnVlLCJpc3MiOiJodHRwczo\nvL2FzLmV4YW1wbGUuY29tLyIsImF1ZCI6Imh0dHBzOi8vcnMuZXhhbXBsZS5jb20vcm\nVzb3VyY2UiLCJpYXQiOjE1MTQ3OTc4MjIsImV4cCI6MTUxNDc5Nzk0MiwiY2xpZW50X\n2lkIjoicGFpQjJnb28wYSIsInNjb3BlIjoicmVhZCB3cml0ZSBkb2xwaGluIiwic3Vi\nIjoiWjVPM3VwUEM4OFFyQWp4MDBkaXMiLCJiaXJ0aGRhdGUiOiIxOTgyLTAyLTAxIiw\niZ2l2ZW5fbmFtZSI6IkpvaG4iLCJmYW1pbHlfbmFtZSI6IkRvZSIsImp0aSI6InQxRm\n9DQ2FaZDRYdjRPUkpVV1ZVZVRaZnNLaFczMENRQ3JXRERqd1h5NncifX0.przJMU5Gh\nmNzvwtt1Sr-xa9xTkpiAg5IshbQsRiRVP_7eGR1GHYrNwQh84kxOkHCyje2g5WSRcYo\nsGEVIiC-eoPJJ-qBwqwSlgx9JEeCDw2W5DjrblOI_N0Jvsq_dUeOyoWVMqlOydOBhKN\nY0smBrI4NZvEExucOm9WUJXMuJtvq1gBes-0go5j4TEv9sOP9uu81gqWTr_LOo6pgT0\ntFFyZfWC4kbXPXiQ2YT6mxCiQRRNM-l9cBdF6Jx6IOrsfFhBuYdYQ_mlL19HgDDOFal\neyqmru6lKlASOsaE8dmLSeKcX91FbG79FKN8un24iwIDCbKT9xlUFl54xWVShNDFA\n</code></pre>","tags":["administration","auth-server","endpoint","introspection","accessTokenAsJwt","introspectionScriptBackwardCompatibility"]},{"location":"janssen-server/auth-server/endpoints/introspection/#disabling-the-endpoint-using-feature-flag","title":"Disabling The Endpoint Using Feature Flag","text":"<p><code>/introspection</code> endpoint can be enabled or disable using END_SESSION feature flag. Use Janssen Text-based UI(TUI) or Janssen command-line interface to perform this task.</p> <p>When using TUI, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>-&gt;<code>enabledFeatureFlags</code> to screen below. From here, enable or disable <code>INTROSPECTION</code> flag as required.</p> <p></p>","tags":["administration","auth-server","endpoint","introspection","accessTokenAsJwt","introspectionScriptBackwardCompatibility"]},{"location":"janssen-server/auth-server/endpoints/introspection/#configuration-properties","title":"Configuration Properties","text":"<p>Introspection endpoint can be further configured using Janssen Server configuration properties listed below. When using Janssen Text-based UI(TUI) to configure the properties, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>.</p> <ul> <li>introspectionEndpoint</li> <li>mtlsIntrospectionEndpoint</li> <li>introspectionSkipAuthorization</li> <li>introspectionScriptBackwardCompatibility</li> <li>introspectionAccessTokenMustHaveUmaProtectionScope</li> <li>introspectionAccessTokenMustHaveIntrospectionScope</li> <li>introspectionResponseScopesBackwardCompatibility</li> </ul> <p>There difference between <code>introspectionAccessTokenMustHaveUmaProtectionScope</code> and <code>introspectionAccessTokenMustHaveIntrospectionScope</code> is that <code>uma_protection</code> scope is enabled for Dynamic Client Registration while <code>introspection</code> scope is not. Thus if set <code>introspectionAccessTokenMustHaveIntrospectionScope</code> to <code>true</code> value allows disable access to Introspection Endpoint to all clients which does not have explicitly granted <code>introspection</code> scope.</p>","tags":["administration","auth-server","endpoint","introspection","accessTokenAsJwt","introspectionScriptBackwardCompatibility"]},{"location":"janssen-server/auth-server/endpoints/introspection/#customising-introspection-endpoint-behaviour-using-custom-script","title":"Customising Introspection Endpoint Behaviour using Custom script:","text":"<p>Customizing certain aspects of endpoint behaviour, for example, one can modify claims of an access token as JWT, using introspection scripts. Use update token introspection script for transformation of claims and values in id-token and access-token.</p> <p>Configure below-mentioned client properties to enable usage of introspection scripts. When using Janssen Text-based UI(TUI) to configure these client properties, navigate to</p> <ul> <li>accessTokenAsJwt:</li> </ul> <p><code>Auth Server</code>-&gt;<code>Clients</code>-&gt;select the client-&gt;<code>Tokens</code>-&gt;<code>Access Token Type</code>-&gt;Select JWT</p> <ul> <li>runIntrospectionScriptBeforeJwtCreation:</li> </ul> <p><code>Auth Server</code>-&gt;<code>Clients</code>-&gt;select the client-&gt;<code>Tokens</code>-&gt;enable <code>Run Introspection Script before JWT access token creation</code></p> <p></p>","tags":["administration","auth-server","endpoint","introspection","accessTokenAsJwt","introspectionScriptBackwardCompatibility"]},{"location":"janssen-server/auth-server/endpoints/introspection/#references-for-custom-scripts","title":"References for custom scripts","text":"<ol> <li>Interface - IntrospectionType</li> <li>Introspection scripts</li> <li>Introspection script vs Update Token Script</li> </ol>","tags":["administration","auth-server","endpoint","introspection","accessTokenAsJwt","introspectionScriptBackwardCompatibility"]},{"location":"janssen-server/auth-server/endpoints/jwks-uri/","title":"JWKS URI Endpoint","text":"<p>Janssen Server supports <code>/jwks</code> metadata endpoint and publishes its JSON Web Key Set (JWKS) at this endpoint. This endpoint publishes signing keys as well as encryption keys used by Janssen Server. RP can use these keys to validate signatures from Janssen Server, and also to perform encryption and decryption.  Like other metadata endpoints, this is not a secure endpoint. Further details on this endpoint and JWKs can be found in OpenID Connect Discovery specification.</p> <p>URL to access jwks endpoint on Janssen Server is listed in the response of Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p><code>jwks_uri</code> claim in the response specifies the URL for jwks endpoint. By default, the jwks endpoint looks like below:</p> <pre><code>https://janssen.server.host/jans-auth/restv1/jwks\n</code></pre> <p>This endpoint is always enabled and can not be disabled using feature flags.</p>","tags":["administration","auth-server","jwks","json-web-key-set","endpoint"]},{"location":"janssen-server/auth-server/endpoints/jwks-uri/#configuration-properties","title":"Configuration Properties","text":"<p>End session endpoint can be further configured using Janssen Server configuration properties listed below. When using Janssen Text-based UI(TUI) to configure the properties, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>.</p> <ul> <li>jwksUri</li> <li>jwksAlgorithmsSupported</li> <li>mtlsJwksUri</li> </ul>","tags":["administration","auth-server","jwks","json-web-key-set","endpoint"]},{"location":"janssen-server/auth-server/endpoints/jwks-uri/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","jwks","json-web-key-set","endpoint"]},{"location":"janssen-server/auth-server/endpoints/par/","title":"Pushed Authorization Request (PAR) Endpoint","text":"<p>PAR endpoint is used by client to send authorization request directly to the Janssen Server without using the usual redirection mechanism via user agent. When PAR endpoint receives a valid request, it responds with a request URI. The request URI is a reference created and stored by Janssen Server. It is a reference to  authorization request and the metadata sent with it by the client. Client can send this request uri to the Janssen Server in a authorization request using user agent redirect mechanism. There are multiple benefits of using this flow which are described along with other details in PAR specification. Janssen Server PAR implementation conforms to PAR specification.</p> <p>URL to access PAR endpoint on Janssen Server is listed in the response of Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p><code>pushed_authorization_request_endpoint</code> claim in the response specifies the URL for the PAR endpoint. By default, PAR endpoint looks like below:</p> <pre><code>https://jans-dynamic-mysql/jans-auth/restv1/par\n</code></pre> <p>In response to a valid request, the PAR endpoint returns <code>request_uri</code> in response similar to below:</p> <pre><code> HTTP/1.1 201 Created\n Content-Type: application/json\n Cache-Control: no-cache, no-store\n\n {\n  \"request_uri\":\n    \"urn:ietf:params:oauth:request_uri:6esc_11ACC5bwc014ltc14eY22c\",\n  \"expires_in\": 60\n }\n</code></pre> <p>Since PAR endpoint is a protected resource. The client has to authenticate itself to the endpoint. Authentication methods used are same as the ones used for client authentication at token endpoint.</p> <p>More information about request and response of the PAR endpoint can be found in the OpenAPI specification of jans-auth-server module.</p>","tags":["administration","auth-server","par","pushed authorization requests","endpoint"]},{"location":"janssen-server/auth-server/endpoints/par/#disabling-the-endpoint-using-feature-flag","title":"Disabling The Endpoint Using Feature Flag","text":"<p><code>PAR</code> endpoint can be enabled or disabled using PAR feature flag. Use Janssen Text-based UI(TUI) or Janssen command-line interface to perform this task.</p> <p>When using TUI, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>-&gt;<code>enabledFeatureFlags</code> to screen below. From here, enable or disable <code>PAR</code> flag as required.</p> <p></p>","tags":["administration","auth-server","par","pushed authorization requests","endpoint"]},{"location":"janssen-server/auth-server/endpoints/par/#configuration-properties","title":"Configuration Properties","text":"","tags":["administration","auth-server","par","pushed authorization requests","endpoint"]},{"location":"janssen-server/auth-server/endpoints/par/#global-janssen-server-configuration-properties","title":"Global Janssen Server configuration properties","text":"<p>PAR endpoint can be further configured using Janssen Server configuration properties listed below. It can be configured via Janssen Text-based UI(TUI) (navigate to <code>Auth Server</code>-&gt;<code>Properties</code>), admin UI or directly in persistence layer.</p> <ul> <li>mtlsParEndpoint - Mutual TLS (mTLS) Pushed Authorization Requests (PAR) endpoint URL</li> <li>parEndpoint - Pushed Authorization Requests (PAR) Endpoint location</li> <li>requirePar - Boolean value to indicate whether Pushed Authorisation Request (PAR) endpoint is required</li> <li>requestUriParameterSupported - Boolean value specifying whether the OP supports use of the request_uri parameter</li> </ul>","tags":["administration","auth-server","par","pushed authorization requests","endpoint"]},{"location":"janssen-server/auth-server/endpoints/par/#client-specific-par-related-configuration-properties","title":"Client specific PAR related configuration properties","text":"<p>Some configuration properties are configured on client level to allow more granular configuration which depends on client.</p> <ul> <li><code>par_lifetime</code> - PAR object lifetime in seconds. If value is not specified then defaults to <code>600</code> value.</li> <li><code>require_par</code>  - specified whether all authorization requests made by this client to Authorization Endpoint must be PAR. If <code>true</code> and authorization request is not PAR then error is returned back by Authorization Server. </li> </ul>","tags":["administration","auth-server","par","pushed authorization requests","endpoint"]},{"location":"janssen-server/auth-server/endpoints/par/#par-custom-script","title":"PAR Custom script","text":"<p>The ParType interception script has the following method(s):</p> Method Method description <code>def createPar(self, par, context)</code> Used to modify PAR object before it is persisted. <code>par</code> is <code>io.jans.as.persistence.model.Par</code> <code>context</code> is <code>io.jans.as.server.service.external.context.ExternalScriptContext</code> <code>def modifyParResponse(self, response, context)</code> Used to modify response from <code>/par</code> endpoint. <code>response</code> is <code>org.json.JSONObject</code> <code>context</code> is <code>io.jans.as.server.service.external.context.ExternalScriptContext</code>","tags":["administration","auth-server","par","pushed authorization requests","endpoint"]},{"location":"janssen-server/auth-server/endpoints/par/#script-type-java","title":"Script Type: Java","text":"<pre><code>import io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.par.ParType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport jakarta.ws.rs.core.Response;\nimport org.jboss.resteasy.spi.NoLogWebApplicationException;\nimport org.json.JSONObject;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\n\n/**\n * @author Yuriy Z\n */\npublic class Par implements ParType {\n\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    @Override\n    public boolean createPar(Object par, Object context) {\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n\n        io.jans.as.persistence.model.Par parObject = (io.jans.as.persistence.model.Par) par;\n        parObject.getAttributes().setScope(\"openid profile\");\n\n        if (\"bad\".equalsIgnoreCase(scriptContext.getExecutionContext().getClient().getClientId())) {\n            scriptContext.setWebApplicationException(\n                    new NoLogWebApplicationException(Response\n                            .status(Response.Status.FORBIDDEN)\n                            .entity(\"Forbidden by custom script.\")\n                            .build()));\n        }\n\n        return true;\n    }\n\n    @Override\n    public boolean modifyParResponse(Object responseAsJsonObject, Object context) {\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n\n        JSONObject json = (JSONObject) responseAsJsonObject;\n        json.accumulate(\"custom_key\", \"custom_value\");\n        return true;\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized PAR Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized PAR Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed PAR Java custom script.\");\n        return false;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n}\n</code></pre>","tags":["administration","auth-server","par","pushed authorization requests","endpoint"]},{"location":"janssen-server/auth-server/endpoints/par/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>You can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","par","pushed authorization requests","endpoint"]},{"location":"janssen-server/auth-server/endpoints/par/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","par","pushed authorization requests","endpoint"]},{"location":"janssen-server/auth-server/endpoints/session-revocation/","title":"Session Revocation Endpoint","text":"<p>Note: Endpoint is deprecated in favor of Global Token Revocation</p> <p>Janssen Server provides session revocation endpoint to enable the client to revoke all sessions of a users. Though not being part of any industry standard/specification, Janssen Server provides this endpoint to allow greater control and better management of sessions on OP.</p> <p>URL to access revocation endpoint on Janssen Server is listed in the response of Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p><code>session_revocation_endpoint</code> claim in the response specifies the URL for revocation endpoint. By default, revocation endpoint looks like below:</p> <pre><code>https://janssen.server.host/jans-auth/restv1/revoke_session\n</code></pre> <p>More information about request and response of the revocation endpoint can be found in the OpenAPI specification of jans-auth-server module.</p>","tags":["administration","auth-server","session-revocation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/session-revocation/#usage","title":"Usage","text":"<p>A request to this endpoint can revoke all sessions of one particular user. Use the request parameters to specify criteria to select the user. If there are multiple users matching the given criteria, the first found user will be affected.</p>","tags":["administration","auth-server","session-revocation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/session-revocation/#disabling-the-endpoint-using-feature-flag","title":"Disabling The Endpoint Using Feature Flag","text":"<p><code>Session revocation</code> endpoint can be enabled or disable using REVOKE_SESSION feature flag. Use Janssen Text-based UI(TUI) or Janssen command-line interface to perform this task.</p> <p>When using TUI, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>-&gt;<code>enabledFeatureFlags</code> to screen below. From here, enable or disable <code>REVOKE_SESSION</code> flag as required.</p> <p></p>","tags":["administration","auth-server","session-revocation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/session-revocation/#required-scopes","title":"Required Scopes","text":"<p>A client must have the following scope in order to use this endpoint:</p> <ul> <li><code>revoke_session</code></li> </ul>","tags":["administration","auth-server","session-revocation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/","title":"Software Statement Assertion (SSA) Endpoint","text":"<p>Janssen Server provides SSA endpoint that enables management of SSAs. The SSA is a JSON Web Token (JWT) containing client metadata and some custom attributes. Specification for SSAs has been outlined as part of Dynamic Client Registration Protocol.</p> <p>URL to access revocation endpoint on Janssen Server is listed in the response of Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p><code>ssa_endpoint</code> claim in the response specifies the URL for revocation endpoint. By default, revocation endpoint looks like below:</p> <pre><code>https://janssen.server.host/jans-auth/restv1/ssa\n</code></pre> <p>More information about request and response of the revocation endpoint can be found in the OpenAPI specification of jans-auth-server module.</p>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#disabling-the-endpoint-using-feature-flag","title":"Disabling The Endpoint Using Feature Flag","text":"<p><code>/ssa</code> endpoint can be enabled or disable using SSA feature flag. Use Janssen Text-based UI(TUI) or Janssen command-line interface to perform this task.</p> <p>When using TUI, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>-&gt;<code>enabledFeatureFlags</code> to screen below. From here, enable or disable <code>SSA</code> flag as required.</p> <p></p>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#configuration-properties","title":"Configuration Properties","text":"<p>SSA endpoint can be further configured using Janssen Server configuration property <code>ssaConfiguration</code>. When using Janssen Text-based UI(TUI) to configure the properties, navigate via <code>Auth Server</code>-&gt;<code>Properties</code> to update value for this property. This property take JSON configuration with parameters as described below:</p> <pre><code>\"ssaConfiguration\": {\n    \"ssaEndpoint\": \"{{your-url}}/ssa\",\n    \"ssaCustomAttributes\": [\n        \"myCustomAttr1\",\n        \"myCustomAttr2\",\n        ...\n    ],\n    \"ssaSigningAlg\": \"RS512\",\n    \"ssaExpirationInDays\": 30,\n    \"ssaMapSoftwareRolesToScopes\": {\n        \"admin\": [\"read\", \"write\", \"delete\"],\n        \"user\": [\"read\"]\n    }\n}\n</code></pre> <ul> <li><code>ssaEndpoint</code> \u2014 Base endpoint for SSA.</li> <li><code>ssaCustomAttributes</code> \u2014 List of custom attributes, which are received in the request when creating an SSA.</li> <li><code>ssaSigningAlg</code> \u2014 Algorithm to sign the JWT that is returned after creating an SSA.</li> <li><code>ssaExpirationInDays</code> \u2014 Expiration expressed in days, when an SSA is created and the expiration is not sent.</li> <li><code>ssaMapSoftwareRolesToScopes</code> - mapping between software roles of SSA and scopes. When SSA is created it will try to set scopes based on software roles.</li> </ul>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#ssa-security","title":"SSA Security","text":"<p>To call SSA services, a token of type <code>client_credentials</code> must be generated with the following scopes enabled:</p> <ul> <li><code>https://jans.io/auth/ssa.admin</code> \u2014 Allows calling all SSA services.</li> <li><code>https://jans.io/auth/ssa.portal</code> \u2014 Allows only call <code>Get SSA</code> service.</li> <li><code>https://jans.io/auth/ssa.developer</code> \u2014 Allows only call <code>Get SSA</code>, but you can only filter ssa that have been created   by the same client.</li> </ul>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#create-a-new-ssa","title":"Create a new SSA","text":"<p>Create <code>SSA</code> for the organization with <code>expiration</code> (optional). If <code>expiration</code> is not set take expiration from <code>ssaConfiguration.ssaExpirationInDays</code> AS configuration property.</p>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#request-body-description","title":"Request body description","text":"Field Detail Optional org_id The \"org_id\" is used for organization identification. false description Describe SSA false software_id The \"software_id\" is used for software identification. If not set, generates random UUID. false software_roles List of string values, fixed value <code>[\"password\", \"notify\"]</code>. false grant_types Fixed value Fixed value <code>[\"client_credentials\"]</code>. false expiration Expiration date. <code>(Default value: calculated based on global SSA settings)</code> false one_time_use Defined whether the SSA will be used only once or can be used multiple times. <code>(Default value: true)</code> false rotate_ssa TODO - Will be used to rotate expiration of the SSA, currently is only saved as part of the SSA. <code>(Default value: true)</code> false lifetime SSA Lifetime in seconds. If not set calculates lifetime, <code>lifetime = expiration - now</code> false <p>Note: You can add more <code>custom attributes</code> in the request, (you must have previously configured in the SSA global configuration). It should be clarified that these values are persisted in the database and are not returned in the SSA JWT.</p> <p>Example:</p> <pre><code>{\n  \"org_id\": \"your-org-id\",\n  \"description\": \"your description\",\n  ...,\n  \"myCustomAttr1\": \"Your value custom attr 1\", \n  \"myCustomAttr2\": \"Your value custom attr 2\"\n} \n</code></pre>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#response-description","title":"Response description","text":"<p>Returned SSA is a JWT, containing the following structure:</p> <pre><code>{\n    \"ssa\": \"eyJraWQiOiI1NTk3MGFkZS00M2MwLTQ4YWMtODEyZi0yZTY1MzhjMTEyN2Zfc2lnX3JzNTEyIiwidHlwIjoiand0IiwiYWxnIjoiUlM1MTIifQ.eyJzb2Z0d2FyZV9pZCI6ImdsdXUtc2Nhbi1hcGkiLCJncmFudF90eXBlcyI6WyJjbGllbnRfY3JlZGVudGlhbHMiXSwib3JnX2lkIjoxLCJpc3MiOiJodHRwczovL2phbnMubG9jYWxob3N0Iiwic29mdHdhcmVfcm9sZXMiOlsicGFzc3d1cmQiXSwiZXhwIjoxNjY4NjA5MDA1LCJpYXQiOjE2Njg2NDE5NjcsImp0aSI6ImU4OWVjYTQxLTM0ODUtNDUxNi1hMTYyLWZiODYyNjJhYmFjMyJ9.jRgh8_aiwMTJxeT9cwfup9QP9LBc6gQstvabCzUOJvELnzosxiNJHeU2mrvavaNK6BGvs_lbNjODVDeetGCD48_F2ay9r8qmo-f3GPzdzcJozKgfzonSkAE5Ran9LKcQQJpVc1rDYcV2xYiJLJ6FSuvnoClkDEE1tXysxshLPs-GXOZE7rD8XUXzezuxZWUE1jXwA-EFajoat8CP6QulHGxlcn_sKIhawhGODxJPz4Pf3jgeZVLG_7HfRJgxNiKcdzQIxnkbdpuS-0Q4-oc5yntsXhFhn31Pa3vGsiPPH9f3ndL2ZZKk3xCgyImLDJuGaxXg-qEVoIG4zNWNHMUNUQ\"\n}\n</code></pre> <p>Header</p> <ul> <li><code>alg</code> \u2014 The signature algorithm which used <code>RS256</code>.</li> <li><code>typ</code> \u2014 The type which used.</li> <li><code>kid</code> \u2014 The key identification <code>gluu-scan-api-rs256-ssa-signature-key</code>.</li> </ul> <p>Payload</p> <ul> <li><code>iat</code> \u2014 The time the JWT was created.</li> <li><code>iss</code> \u2014 The \"iss\" (issuer) claim identifies the principal that issued the JWT.</li> <li><code>jti</code> \u2014 The \"jti\" (JWT ID) claim provides a unique identifier for the JWT.</li> <li><code>software_id</code> \u2014 The \"software_id\" is used for software identification.</li> <li><code>org_id</code> \u2014 The \"org_id\" is used for organization identification.</li> <li><code>software_roles</code> \u2014 List of string values, fixed value <code>[\"password\", \"notify\"]</code>.</li> <li><code>grant_types</code> \u2014 Fixed value <code>[\"client_credentials\"]</code>.</li> <li><code>lifetime</code> \u2014 SSA lifetime in seconds.</li> <li><code>exp</code> \u2014 Expiration Time.</li> <li><code>myCustom1, myCustom2, ...</code>: if you have custom attributes, they will be displayed here.</li> </ul>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#example","title":"Example:","text":"<p>Request:</p> <pre><code>POST {{your-url}}/ssa\nContent-Type: application/json\nAuthorization: Bearer {{your-token}}\n\n{\n    \"org_id\": \"your-org-id\",\n    \"description\": \"This is test description\",\n    \"software_id\": \"gluu-scan-api\",\n    \"software_roles\": [\n        \"passwurd\"\n    ],\n    \"grant_types\": [\n        \"client_credentials\"\n    ],\n    \"expiration\": \"1696799089\",\n    \"one_time_use\": false,\n    \"rotate_ssa\": false,\n    \"lifetime\": 86400\n}\n</code></pre> <p>Response:</p> <pre><code>HTTP/1.1 201 Created\nServer: Apache/2.4.52 (Ubuntu)\nX-Xss-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nCache-Control: no-store\nContent-Type: application/json\nPragma: no-cache\nContent-Length: 757\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\n\n{\n    \"ssa\": \"eyJraWQiOiJzc2FfNjY1MTQ5ODMtNzI0YS00OGQ2LWIzYzItODEyMGM1OTgyOGU2X3NpZ19yczI1NiIsInR5cCI6Imp3dCIsImFsZyI6IlJTMjU2In0.eyJzb2Z0d2FyZV9pZCI6ImdsdXUtc2Nhbi1hcGkiLCJncmFudF90eXBlcyI6WyJjbGllbnRfY3JlZGVudGlhbHMiXSwib3JnX2lkIjoieW91ci1vcmctaWQiLCJpc3MiOiJodHRwczovL2phbnMubG9jYWwuaW8iLCJsaWZldGltZSI6ODY0MDAsInNvZnR3YXJlX3JvbGVzIjpbInBhc3N3dXJkIl0sImV4cCI6MTY5Njc5OTA4OSwiaWF0IjoxNjk2NzEyNjg5LCJqdGkiOiJmNTRiYWFmZC02M2JmLTQ2NGEtYmJkZS00OTM3MDQ3NTBiMzUifQ.XTHzRrvrzQ5S_zEXjAWkXLegVIGK47zOa3eZuECO8xXQ2kOh0KXYGQ4TT3tPTFX19XQv30CLKqH97UPm-hkAMVL10NGUw_ernfoX1Z9-lTEdECPaqZ6UCiG1X8WRgJ0s4nUgE_PP9Isoyxnfk5bYlQwotf50KreTwDYUbwHRJZGdVPRjnLGeJpWhFblF4J5HNj_vU7wk7bdkaIDRArqK753mlCejXlkqTF97NzaL0bhP0yaoNK5jlscVPALQr2-FcoUl9rTfArSYXF1GuP3fhDN2BLrnB51M_8v7r0YkPF5B73ag82Aa8HSgYE6bmAB6D_M8W4v85idcyp0xQRPcIg\"\n}\n</code></pre>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#get-ssa","title":"Get SSA","text":"<p>Get existing active SSA based on <code>jti</code> or <code>org_id</code>.</p>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#query-parameters","title":"Query Parameters","text":"<ul> <li><code>jti</code> \u2014 Unique identifier</li> <li><code>org_id</code> \u2014 Organization ID</li> </ul>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#response-description_1","title":"Response description","text":"<pre><code>[\n    {\n        \"ssa\": {\n            \"jti\": \"c3eb1c16-be9b-4e96-974e-aea5e3cf95b0\",\n            \"org_id\": 1,\n            \"software_id\": \"gluu-scan-api\",\n            \"software_roles\": [\n                \"password\"\n            ],\n            \"grant_types\": [\n                \"client_credentials\"\n            ],\n            \"iss\": \"https://jans.localhost\",\n            \"exp\": 1668608852,\n            \"iat\": 1668608851,\n            \"description: \"test description\",\n            \"one_time_use\": true,\n            \"rotate_ssa\": false,\n            \"lifetime\": 86400\n        },\n        \"iss\": \"ed4d5f74-ce41-4180-aed4-54cffa974630\",\n        \"created_at\": 1668608851,\n        \"expiration\": 1668608852,\n        \"status\": \"ACTIVE\"\n    }\n]\n</code></pre> <ul> <li>SSA<ul> <li><code>jti</code> \u2014 The \"jti\" (JWT ID) claim provides a unique identifier for the JWT.</li> <li><code>org_id</code> \u2014 The \"org_id\" is used for organization identification.</li> <li><code>software_id</code> \u2014 The \"software_id\" is used for software identification.</li> <li><code>software_roles</code> \u2014 List of string values, fixed value <code>[\"password\", \"notify\"]</code>.</li> <li><code>grant_types</code> \u2014 Fixed value <code>[\"client_credentials\"]</code>.</li> <li><code>iss</code> \u2014 The \"iss\" (issuer) claim identifies the principal that issued the JWT.</li> <li><code>exp</code> \u2014 Expiration time.</li> <li><code>iat</code> \u2014 Creation time.</li> <li><code>description</code> \u2014 Describe SSA.</li> <li><code>one_time_use</code> \u2014 Defined whether the SSA will be used only once or can be used multiple times.</li> <li><code>rotate_ssa</code> \u2014 TODO - Will be used to rotate expiration of the SSA, currently is only saved as part of the SSA.</li> <li><code>lifetime</code> \u2014 SSA lifetime in seconds.</li> <li><code>myCustom1, myCustom2, ...</code> \u2014 if you have custom attributes, they will be displayed here.</li> </ul> </li> <li><code>iss</code> \u2014 The \"iss\" is related to the client that created this SSA.</li> <li><code>created_at</code> \u2014 Creation time.</li> <li><code>expiration</code> \u2014 Expiration time.</li> <li><code>status</code> \u2014 SSA status (<code>ACTIVE</code>, <code>USED</code>, <code>EXPIRED</code> or <code>REVOKED</code>).</li> </ul>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#example_1","title":"Example:","text":"<p>Request:</p> <p>Get SSA using <code>jti</code>.</p> <pre><code>GET {{your-url}}/ssa?jti={{your-jti}}\nContent-Type: application/json\nAuthorization: Bearer {{your-token}}\n</code></pre> <p>Get SSA using <code>org_id</code>.</p> <pre><code>GET {{your-url}}/ssa?org_id={{your-org_id}}\nContent-Type: application/json\nAuthorization: Bearer {{your-token}}\n</code></pre> <p>Response:</p> <pre><code>HTTP/1.1 200 OK\nServer: Apache/2.4.52 (Ubuntu)\nX-Xss-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nCache-Control: no-store\nContent-Type: application/json\nPragma: no-cache\nContent-Length: 432\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\n\n[\n  {\n    \"ssa\": {\n      \"software_id\": \"gluu-scan-api\",\n      \"grant_types\": [\n        \"client_credentials\"\n      ],\n      \"org_id\": 1,\n      \"iss\": \"https://jans.localhost\",\n      \"software_roles\": [\n        \"passwurd\"\n      ],\n      \"exp\": 1668608852,\n      \"iat\": 1668608851,\n      \"jti\": \"c3eb1c16-be9b-4e96-974e-aea5e3cf95b0\",\n      \"description: \"test description\",\n      \"one_time_use\": true,\n      \"rotate_ssa\": false\n    },\n    \"iss\": \"ed4d5f74-ce41-4180-aed4-54cffa974630\",\n    \"created_at\": 1668608851,\n    \"expiration\": 1668608852,\n    \"status\": \"ACTIVE\"\n  }\n]\n</code></pre>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#get-jwt-ssa","title":"Get JWT SSA","text":"<p>Get existing active SSA based on <code>jti</code>.</p>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#query-parameters_1","title":"Query Parameters","text":"<ul> <li><code>jti</code> \u2014 Unique identifier</li> </ul>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#response-description_2","title":"Response description","text":"<p>Returned SSA is a JWT, containing the following structure:</p> <pre><code>{\n    \"ssa\": \"eyJraWQiOiJzc2FfNjY1MTQ5ODMtNzI0YS00OGQ2LWIzYzItODEyMGM1OTgyOGU2X3NpZ19yczI1NiIsInR5cCI6Imp3dCIsImFsZyI6IlJTMjU2In0.eyJzb2Z0d2FyZV9pZCI6ImdsdXUtc2Nhbi1hcGkiLCJncmFudF90eXBlcyI6WyJjbGllbnRfY3JlZGVudGlhbHMiXSwib3JnX2lkIjoieW91ci1vcmctaWQiLCJpc3MiOiJodHRwczovL2phbnMubG9jYWwuaW8iLCJsaWZldGltZSI6ODY0MDAsInNvZnR3YXJlX3JvbGVzIjpbInBhc3N3dXJkIl0sImV4cCI6MTY5Njc5OTA4OSwiaWF0IjoxNjk2NzEyNjg5LCJqdGkiOiJmNTRiYWFmZC02M2JmLTQ2NGEtYmJkZS00OTM3MDQ3NTBiMzUifQ.XTHzRrvrzQ5S_zEXjAWkXLegVIGK47zOa3eZuECO8xXQ2kOh0KXYGQ4TT3tPTFX19XQv30CLKqH97UPm-hkAMVL10NGUw_ernfoX1Z9-lTEdECPaqZ6UCiG1X8WRgJ0s4nUgE_PP9Isoyxnfk5bYlQwotf50KreTwDYUbwHRJZGdVPRjnLGeJpWhFblF4J5HNj_vU7wk7bdkaIDRArqK753mlCejXlkqTF97NzaL0bhP0yaoNK5jlscVPALQr2-FcoUl9rTfArSYXF1GuP3fhDN2BLrnB51M_8v7r0YkPF5B73ag82Aa8HSgYE6bmAB6D_M8W4v85idcyp0xQRPcIg\"\n}\n</code></pre> <p>Header</p> <ul> <li><code>alg</code> \u2014 The signature algorithm which used <code>RS256</code>.</li> <li><code>typ</code> \u2014 The type which used.</li> <li><code>kid</code> \u2014 The key identification <code>gluu-scan-api-rs256-ssa-signature-key</code>.</li> </ul> <p>Payload</p> <ul> <li><code>iat</code> \u2014 The time the JWT was created.</li> <li><code>iss</code> \u2014 The \"iss\" (issuer) claim identifies the principal that issued the JWT.</li> <li><code>jti</code> \u2014 The \"jti\" (JWT ID) claim provides a unique identifier for the JWT.</li> <li><code>software_id</code> \u2014 The \"software_id\" is used for software identification.</li> <li><code>org_id</code> \u2014 The \"org_id\" is used for organization identification.</li> <li><code>software_roles</code> \u2014 List of string values, fixed value <code>[\"password\", \"notify\"]</code>.</li> <li><code>grant_types</code> \u2014 Fixed value <code>[\"client_credentials\"]</code>.</li> <li><code>exp</code> \u2014 Expiration Time.</li> <li><code>myCustom1, myCustom2, ...</code>: if you have custom attributes, they will be displayed here.</li> </ul>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#example_2","title":"Example:","text":"<p>Request:</p> <pre><code>GET {{your-url}}/ssa/jwt?jti={{your-jti}}\nContent-Type: application/json\nAuthorization: Bearer {{your-token}}\n</code></pre> <p>Response:</p> <pre><code>HTTP/1.1 201 Created\nServer: Apache/2.4.52 (Ubuntu)\nX-Xss-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nCache-Control: no-store\nContent-Type: application/json\nPragma: no-cache\nContent-Length: 757\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\n\n{\n    \"ssa\": \"eyJraWQiOiJzc2FfNjY1MTQ5ODMtNzI0YS00OGQ2LWIzYzItODEyMGM1OTgyOGU2X3NpZ19yczI1NiIsInR5cCI6Imp3dCIsImFsZyI6IlJTMjU2In0.eyJzb2Z0d2FyZV9pZCI6ImdsdXUtc2Nhbi1hcGkiLCJncmFudF90eXBlcyI6WyJjbGllbnRfY3JlZGVudGlhbHMiXSwib3JnX2lkIjoieW91ci1vcmctaWQiLCJpc3MiOiJodHRwczovL2phbnMubG9jYWwuaW8iLCJsaWZldGltZSI6ODY0MDAsInNvZnR3YXJlX3JvbGVzIjpbInBhc3N3dXJkIl0sImV4cCI6MTY5Njc5OTA4OSwiaWF0IjoxNjk2NzEyNjg5LCJqdGkiOiJmNTRiYWFmZC02M2JmLTQ2NGEtYmJkZS00OTM3MDQ3NTBiMzUifQ.XTHzRrvrzQ5S_zEXjAWkXLegVIGK47zOa3eZuECO8xXQ2kOh0KXYGQ4TT3tPTFX19XQv30CLKqH97UPm-hkAMVL10NGUw_ernfoX1Z9-lTEdECPaqZ6UCiG1X8WRgJ0s4nUgE_PP9Isoyxnfk5bYlQwotf50KreTwDYUbwHRJZGdVPRjnLGeJpWhFblF4J5HNj_vU7wk7bdkaIDRArqK753mlCejXlkqTF97NzaL0bhP0yaoNK5jlscVPALQr2-FcoUl9rTfArSYXF1GuP3fhDN2BLrnB51M_8v7r0YkPF5B73ag82Aa8HSgYE6bmAB6D_M8W4v85idcyp0xQRPcIg\"\n}\n</code></pre>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#validate-ssa","title":"Validate SSA","text":"<p>Validate existing active SSA based on <code>jti</code></p>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#header-parameters","title":"Header Parameters","text":"<ul> <li>jti \u2014 Unique identifier</li> </ul>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#response-description_3","title":"Response description","text":"<p>Method returns status 200 with an empty body if the corresponding SSA exists and is active.</p>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#example_3","title":"Example:","text":"<pre><code>POST {{your-url}}/ssa/validation\njti: {{your-jti}}\n</code></pre> <pre><code>HTTP/1.1 200 OK\nServer: Apache/2.4.52 (Ubuntu)\nX-Xss-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nCache-Control: no-store\nContent-Type: application/json\nPragma: no-cache\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\n\n&lt;Response body is empty&gt;\n</code></pre>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#revoke-ssa","title":"Revoke SSA","text":"<p>Revoke existing active SSA based on <code>jti</code> or <code>org_id</code>. On SSA revoke expiration date is set to <code>now</code> which makes it eligible for clean up.</p>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#query-parameters_2","title":"Query Parameters","text":"<ul> <li><code>jti</code> \u2014 for revoke only one SSA, the specified by jti</li> <li><code>org_id</code> \u2014 for revoke all SSA of the specified organization.</li> </ul>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#response-description_4","title":"Response description","text":"<p>Method returns status 200 with an empty body if all required SSAs were revoked correctly.</p>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#example_4","title":"Example:","text":"<p>Request:</p> <p>Revoke using <code>jti</code>.</p> <pre><code>DELETE {{your-url}}/ssa?jti={{your-jti}}\nAuthorization: Bearer {{your-token}}\n</code></pre> <p>Revoke using <code>org_id</code>.</p> <pre><code>DELETE {{your-url}}/ssa?org_id={{your-org_id}}\nAuthorization: Bearer {{your-token}}\n</code></pre> <p>Response:</p> <pre><code>HTTP/1.1 200 OK\nServer: Apache/2.4.52 (Ubuntu)\nX-Xss-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nCache-Control: no-store\nContent-Type: application/json\nPragma: no-cache\nContent-Length: 0\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\n\n&lt;Response body is empty&gt;\n</code></pre>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#ssa-custom-script","title":"SSA Custom Script","text":"<p>The custom script will allow us to modify the SSA process. SSA Custom Script</p> <ul> <li>Modify the JWT returned by the creation SSA web service.</li> <li>Modify the list returned by the get SSA web service.</li> <li>Run a process after revoking an SSA.</li> </ul>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#create-method","title":"Create method","text":"<p>This method is executed after having generated the jwt that the service will return.</p> <p>In the following example, new fields is added to the header and payload of the JWT.</p> <pre><code>def create(self, jsonWebResponse, context):\n    print \"Modify ssa response script. Modify idToken: %s\" % jsonWebResponse\n\n    jsonWebResponse.getHeader().setClaim(\"custom_header_name\", \"custom_header_value\")\n    jsonWebResponse.getClaims().setClaim(\"custom_claim_name\", \"custom_claim_value\")\n\n    print \"Modify ssa response script. After modify idToken: %s\" % jsonWebResponse\n    return True\n</code></pre>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#parameters","title":"Parameters","text":"<ul> <li><code>jsonWebResponse</code> \u2014 JWT with SSA structure using <code>io.jans.as.model.jwt.Jwt</code> class</li> <li><code>context</code> \u2014 Contains, SSA global configuration class, client, execution context, etc.</li> </ul>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#get-method","title":"Get method","text":"<p>This method is executed after having generated the SSA list that will be returned by the service.</p> <pre><code>def get(self, jsonArray, context):\n    print \"Modify ssa response script. Modify get ssa list: %s\" % jsonArray\n    return True\n</code></pre>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#parameters_1","title":"Parameters","text":"<ul> <li><code>jsonArray</code> \u2014 Contains SSA list using <code>org.json.JSONArray</code> class</li> <li><code>context</code> \u2014 Contains, SSA global configuration class, client, execution context, etc.</li> </ul>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#revoke-method","title":"Revoke method","text":"<p>This method is executed after the SSA list has been revoked. On SSA revoke expiration date is set to <code>now</code> which makes it eligible for clean up.</p> <pre><code>def revoke(self, ssaList, context):\n    print \"Modify ssa response script. Modify revoke ssaList: %s\" % ssaList\n    return True\n</code></pre>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#parameters_2","title":"Parameters","text":"<ul> <li><code>ssaList</code> \u2014 SSA revoked list.</li> <li><code>context</code> \u2014 Contains, SSA global configuration class, client, execution context, etc.</li> </ul>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/ssa/#ssa-class-structure","title":"SSA Class structure","text":"<p>The SSA entity contains the following fields:</p> <ul> <li><code>id</code> type <code>String</code> \u2014 Unique class identifier, and is used as the <code>jti</code> identifier for the <code>JWT</code>.</li> <li><code>orgId</code> type <code>String</code> \u2014 Organization ID.</li> <li><code>description</code> type <code>String</code> \u2014 SSA Description.</li> <li><code>state</code> type enum <code>SsaState</code> \u2014 Contains the following SSA status values (<code>ACTIVE</code>, <code>EXPIRED</code>, <code>REVOKED</code>, <code>USED</code>).</li> <li><code>creationDate</code> type <code>Date</code> \u2014 SSA Creation date.</li> <li><code>creatorId</code> type <code>String</code> \u2014 Client that created SSA.</li> <li><code>creatorType</code> type enum <code>CreatorType</code> \u2014 Contains the following CreatorType values (<code>NONE</code>, <code>CLIENT</code>, <code>USER</code>, <code>AUTO</code>).</li> <li><code>ttl</code> type <code>Integer</code> \u2014 SSA lifetime in seconds.</li> <li><code>atributes</code> type class <code>SsaAtributes</code><ul> <li><code>oneTimeUse</code> type <code>Boolean</code> \u2014 Whether the SSA will be single use.</li> <li><code>lifetime</code> type <code>Integer</code> \u2014 SSA lifetime in seconds.</li> <li><code>rotateSsa</code> type <code>Boolean</code> \u2014 TODO - Will be used to rotate expiration of the SSA, currently is only saved as part   of the SSA.</li> <li><code>clientDn</code> type <code>String</code> \u2014 Client's DN.</li> <li><code>customAttributes</code> type <code>Map&lt;String, String&gt;</code> \u2014 Contain additional fields, previously configured in the SSA global   configuration.</li> <li><code>softwareId</code> type <code>String</code> \u2014 Is used for software identification.</li> <li><code>softwareRoles</code> type <code>List&lt;String&gt;</code> \u2014 List of string values, fixed value <code>[\"password\", \"notify\"]</code>.</li> <li><code>grantTypes</code> type <code>List&lt;String&gt;</code> \u2014 Fixed value <code>[\"client_credentials\"]</code>.</li> </ul> </li> </ul>","tags":["administration","auth-server","SSA","endpoint"]},{"location":"janssen-server/auth-server/endpoints/token-revocation/","title":"Token Revocation Endpoint","text":"<p>Janssen Server supports token revocation endpoint enables a client to notify the server that previously obtained refresh or access token is no longer needed, allowing the server to clean up security credentials. Implementation conforms with token revocation specification.</p> <p>Since a token is part of a grant, when the token is invalidated, all other token within the same grant are also revoked. i.e when a refresh token related to a grant is invalidated, all access tokens from the same grant are also invalidated and vice-versa.</p> <p>URL to access revocation endpoint on Janssen Server is listed in the response of Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://&lt;jans-server-host&gt;/jans-auth/.well-known/openid-configuration\n</code></pre> <p><code>revocation_endpoint</code> claim in the response specifies the URL for revocation endpoint. By default, revocation endpoint looks like below:</p> <pre><code>https://jans-dynamic-mysql/jans-auth/restv1/revoke\n</code></pre> <p>More information about request and response of the revocation endpoint can be found in the OpenAPI specification of jans-auth-server module.</p>","tags":["administration","auth-server","token-revocation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/token-revocation/#disabling-the-endpoint-using-feature-flag","title":"Disabling The Endpoint Using Feature Flag","text":"<p><code>Token revocation</code> endpoint can be enabled or disable using REVOKE_TOKEN feature flag. Use Janssen Text-based UI(TUI) or Janssen command-line interface to perform this task.</p> <p>When using TUI, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>-&gt;<code>enabledFeatureFlags</code> to screen below. From here, enable or disable <code>REVOKE_TOKEN</code> flag as required.</p> <p></p>","tags":["administration","auth-server","token-revocation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/token-revocation/#configuration-properties","title":"Configuration Properties","text":"<p>Token revocation endpoint can be further configured using Janssen Server configuration properties listed below. When using Janssen Text-based UI(TUI) to configure the properties, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>.</p> <ul> <li>mtlstokenrevocationendpoint</li> <li>tokenRevocationEndpoint</li> <li>allowRevokeForOtherClients</li> </ul>","tags":["administration","auth-server","token-revocation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/token-revocation/#revoke-all-tokens-by-client_id","title":"Revoke all tokens by <code>client_id</code>","text":"<p>To remove all tokens for given <code>client_id</code> it's required: - set <code>allowAllValueForRevokeEndpoint</code> AS configuration property to <code>true</code> - pass in request parameter <code>token_type_hint=all</code></p> <p><code>client</code> is identified by Client Authentication performed by AS to grant access to <code>/revoke</code> endpoint.</p>","tags":["administration","auth-server","token-revocation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/token-revocation/#revoke-tokens-of-other-clients","title":"Revoke tokens of other clients","text":"<p>By default, the Revoke Endpoint allows only revoking of own client's tokens. However it is possible to allow revoking of any token (which is issued with other client).</p> <p>For this it is required: - set global AS configuration property <code>allowRevokeForOtherClients</code> to <code>true</code> - add <code>revoke_any_token</code> scope to <code>client</code> which performs revoke call  </p>","tags":["administration","auth-server","token-revocation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/token-revocation/#revoke-interception-script","title":"Revoke Interception Script","text":"<p>Endpoint can provide custom behavior via implementing Revoke Token interception script .</p>","tags":["administration","auth-server","token-revocation","endpoint"]},{"location":"janssen-server/auth-server/endpoints/token/","title":"Token Endpoint","text":"<p>Token endpoint is an OAuth2 protected endpoint that is used to grant tokens to client in response to valid request. Token endpoint is defined in the OAuth 2.0 framework, OpenID Connect specification and other specifications relevant to them.</p> <p>Tokens granted by this endpoint depends on grant type and scopes that are specified in the token request. The token endpoint is used with every authorization grant type except for the implicit grant type (since an access token is issued directly).</p> <p>Based on request, this endpoint can grant following types of tokens:</p> <ul> <li>Access Token</li> <li>Refresh Token</li> <li>ID Token</li> </ul> <p>URL to access token endpoint on Janssen Server is listed in the response of Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p><code>token_endpoint</code> claim in the response specifies the URL for userinfo endpoint. By default, userinfo endpoint looks like below:</p> <pre><code>https://janssen.server.host/jans-auth/restv1/token\n</code></pre> <p>In response to a valid request, the token endpoint returns token/s in JSON format similar to below. This is just a sample response. Actual response can greatly vary in its contents based on request:</p> <pre><code>  HTTP/1.1 200 OK\n  Content-Type: application/json\n  Cache-Control: no-store\n  Pragma: no-cache\n\n  {\n   \"access_token\": \"SlAV32hkKG\",\n   \"token_type\": \"Bearer\",\n   \"refresh_token\": \"8xLOxBtZp8\",\n   \"expires_in\": 3600,\n   \"id_token\": \"eyJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWdkazcifQ.ewogImlzc\n     yI6ICJodHRwOi8vc2VydmVyLmV4YW1wbGUuY29tIiwKICJzdWIiOiAiMjQ4Mjg5\n     NzYxMDAxIiwKICJhdWQiOiAiczZCaGRSa3F0MyIsCiAibm9uY2UiOiAibi0wUzZ\n     fV3pBMk1qIiwKICJleHAiOiAxMzExMjgxOTcwLAogImlhdCI6IDEzMTEyODA5Nz\n     AKfQ.ggW8hZ1EuVLuxNuuIJKX_V8a_OMXzR0EHR9R6jgdqrOOF4daGU96Sr_P6q\n     Jp6IcmD3HP99Obi1PRs-cwh3LO-p146waJ8IhehcwL7F09JdijmBqkvPeB2T9CJ\n     NqeGpe-gccMg4vfKjkM8FcGvnzZUN4_KSP0aAp1tOJ1zZwgjxqGByKHiOtX7Tpd\n     QyHE5lcMiKPXfEIQILVq0pc_E2DzL7emopWoaoZTF_m0_N0YzFC6g6EJbOEoRoS\n     K5hoDalrcvRYLSrQAZZKflyuVCyixEoV9GfNQC3_osjzw2PAithfubEEBLuVVk4\n     XUVrWOLrLl0nx7RkKU8NXNHq-rvKMzqg\"\n  }\n</code></pre> <p>More information about request and response of the token endpoint can be found in the OpenAPI specification of jans-auth-server module.</p>","tags":["administration","auth-server","token","endpoint"]},{"location":"janssen-server/auth-server/endpoints/token/#configuration-properties","title":"Configuration Properties","text":"<p>Token endpoint and tokens issued by token endpoint can be further configured using Janssen Server configuration properties listed below. When using Janssen Text-based UI(TUI) to configure the properties, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>.</p> <ul> <li>tokenEndpoint</li> <li>tokenEndpointAuthMethodsSupported</li> <li>tokenEndpointAuthSigningAlgValuesSupported</li> <li>accessTokenLifetime</li> <li>checkUserPresenceOnRefreshToken</li> <li>defaultSignatureAlgorithm</li> <li>forceOfflineAccessScopeToEnableRefreshToken</li> <li>grantTypesSupported</li> <li>accessTokenSigningAlgValuesSupported</li> <li>idTokenEncryptionAlgValuesSupported</li> <li>idTokenEncryptionEncValuesSupported</li> <li>idTokenFilterClaimsBasedOnAccessToken</li> <li>idTokenLifetime</li> <li>idTokenSigningAlgValuesSupported</li> <li>accessTokenSigningAlgValuesSupported</li> <li>legacyIdTokenClaims</li> <li>mtlsTokenEndpoint</li> <li>openidScopeBackwardCompatibility</li> <li>persistIdToken</li> <li>persistRefreshToken</li> <li>refreshTokenExtendLifetimeOnRotation</li> <li>refreshTokenLifetime</li> <li>responseTypesSupported</li> <li>skipRefreshTokenDuringRefreshing</li> <li>refreshTokenLifetime</li> </ul>","tags":["administration","auth-server","token","endpoint"]},{"location":"janssen-server/auth-server/endpoints/token/#client-authentication","title":"Client Authentication","text":"<p>Janssen Server Token Endpoint requires confidential clients to authenticate using one of the supported client authentication method listed below:</p> <ul> <li>client_secret_basic</li> <li>client_secret_post</li> <li>client_secret_jwt</li> <li>private_key_jwt</li> </ul> <p>Refer to Client Authentication section of OpenID Connect core specification for more details on these authentication methods.</p> <p>AS provides ability to customize Client Authentication behavior via Client Authentication custom script</p> <p>Client can specify the default authentication method. To set default authentication method using Janssen Text-based UI(TUI), navigate via <code>Auth Server</code>-&gt;<code>Clients</code>-&gt;<code>Add Client</code>-&gt;<code>Basic</code>-&gt; <code>Authn Method Token Endpoint</code>.</p> <p></p>","tags":["administration","auth-server","token","endpoint"]},{"location":"janssen-server/auth-server/endpoints/token/#supported-grant-types","title":"Supported Grant Types","text":"<p>Token endpoint supports below mentioned grant types.</p> <ul> <li>Authorization Code</li> <li>Implicit</li> <li>Refresh Token</li> <li>Client Credentials</li> <li>Password</li> <li>Token Exchange</li> <li>Transaction Tokens</li> <li>Device Grant</li> <li>JWT Grant</li> <li>CIBA</li> </ul> <p>Client can configure all the possible grant types it can request from token endpoint during client configuration. To select the available grant types using Janssen Text-based UI(TUI), navigate via <code>Auth Server</code>-&gt;<code>Clients</code>-&gt;<code>Add Client</code>/<code>search client</code>-&gt;<code>Basic</code>-&gt; <code>Grant</code>.</p> <p></p>","tags":["administration","auth-server","token","endpoint"]},{"location":"janssen-server/auth-server/endpoints/token/#interception-scripts","title":"Interception Scripts","text":"<p>Token endpoint response can be further customized using interception scripts. Following interception scripts are relevant to token endpoint:</p> <ul> <li>Update Token</li> </ul> <p>Client can configure a particular script to be executed using client configuration. To update configuration using Janssen Text-based UI(TUI) navigate via <code>Auth Server</code>-&gt;<code>Clients</code>-&gt;<code>Add Client</code>/<code>search</code>-&gt; <code>Client Scripts</code></p> <p></p>","tags":["administration","auth-server","token","endpoint"]},{"location":"janssen-server/auth-server/endpoints/userinfo/","title":"Userinfo Endpoint","text":"<p>Userinfo endpoint is an OAuth2 protected endpoint that is used to retrieve claims about an authenticated end-user. Userinfo endpoint is defined in the OpenID Connect specification.</p> <p>URL to access userinfo endpoint on Janssen Server is listed in the response of Janssen Server's well-known configuration endpoint given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p><code>userinfo_endpoint</code> claim in the response specifies the URL for userinfo endpoint. By default, userinfo endpoint looks like below:</p> <pre><code>https://janssen.server.host/jans-auth/restv1/userinfo\n</code></pre> <p>In response to a valid request, the userinfo endpoint returns user information in JSON format similar to below:</p> <pre><code>  HTTP/1.1 200 OK\n  Content-Type: application/json\n\n  {\n   \"sub\": \"3482897610054\",\n   \"jti\": \"sdu28g9c761g0y0g5\",\n   \"client_id\": \"db6daf8c-ab1b-4010-9fb0\",\n   \"name\": \"Chad Wick\",\n   \"given_name\": \"Chad\",\n   \"family_name\": \"Wick\",\n   \"preferred_username\": \"c.wick\",\n   \"email\": \"cwick@jans.com\",\n   \"picture\": \"http://mysite.com/mypic.jpg\"\n  }\n</code></pre> <p>User Info response should contain: <code>sub</code>, <code>jti</code> and <code>client_id</code> claims.</p> <p>Since userinfo endpoint is an OAuth2-protected resource, a valid access token with appropriate scope is required to access the endpoint. More information about request and response of the userinfo endpoint can be found in the OpenAPI specification of jans-auth-server module.</p>","tags":["administration","auth-server","userinfo","endpoint"]},{"location":"janssen-server/auth-server/endpoints/userinfo/#disabling-the-endpoint-using-feature-flag","title":"Disabling The Endpoint Using Feature Flag","text":"<p><code>userinfo</code> endpoint can be enabled or disable using USERINFO feature flag. Use Janssen Text-based UI(TUI) or Janssen command-line interface to perform this task.</p> <p>When using TUI, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>-&gt;<code>enabledFeatureFlags</code> to screen below. From here, enable or disable <code>USERINFO</code> flag as required.</p> <p></p>","tags":["administration","auth-server","userinfo","endpoint"]},{"location":"janssen-server/auth-server/endpoints/userinfo/#configuration-properties","title":"Configuration Properties","text":"<p>Userinfo endpoint can be further configured using Janssen Server configuration properties listed below. When using Janssen Text-based UI(TUI) to configure the properties, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>.</p> <ul> <li>mtlsUserInfoEndpoint</li> <li>userInfoEncryptionAlgValuesSupported</li> <li>userInfoEncryptionEncValuesSupported</li> <li>userInfoEndpoint</li> <li>userInfoSigningAlgValuesSupported</li> </ul>","tags":["administration","auth-server","userinfo","endpoint"]},{"location":"janssen-server/auth-server/endpoints/userinfo/#using-scopes-to-control-claim-release","title":"Using Scopes To Control Claim Release","text":"","tags":["administration","auth-server","userinfo","endpoint"]},{"location":"janssen-server/auth-server/endpoints/userinfo/#standard-scopes","title":"Standard Scopes","text":"<p>In context of OpenID Connect specification, claim information released by userinfo endpoint can be controlled using scopes. Janssen Server supports all standard scopes and releases corresponding claims as per OpenID Connect specification. Administrator can customise standard scopes and define claims to be linked to each standard scope.</p> <p>When using Janssen Text-based UI(TUI) to configure the scopes, navigate via <code>Auth Server</code>-&gt;<code>Scopes</code>-&gt;<code>Add Scopes</code>-&gt;<code>Scope Type</code> as <code>OpenID</code>-&gt;search for a standard scope like <code>address</code></p>","tags":["administration","auth-server","userinfo","endpoint"]},{"location":"janssen-server/auth-server/endpoints/userinfo/#dynamic-scopes","title":"Dynamic Scopes","text":"<p>In addition to standard scopes, Janssen server allows defining custom scopes which can be associated to user-defined list of claims. This allows administrators to create custom groupings of claims.</p> <p>When using Janssen Text-based UI(TUI), navigate via <code>Auth Server</code>-&gt;<code>Scopes</code>-&gt;<code>Add Scopes</code>-&gt;<code>Scope Type</code> as <code>Dynamic</code></p>","tags":["administration","auth-server","userinfo","endpoint"]},{"location":"janssen-server/auth-server/endpoints/userinfo/#interception-scripts","title":"Interception Scripts","text":"<p>Response from userinfo can be further customized using dynamic scope interception script.</p> <p>Administrator can attach a dynamic scope script to a dynamic scope using Janssen Text-based UI(TUI). Navigate to <code>Auth Server</code>-&gt;<code>Scopes</code>-&gt;<code>Add Scopes</code>-&gt;<code>Scope Type</code> as <code>Dynamic</code>-&gt;<code>Dynamic Scope Script</code></p>","tags":["administration","auth-server","userinfo","endpoint"]},{"location":"janssen-server/auth-server/endpoints/userinfo/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","userinfo","endpoint"]},{"location":"janssen-server/auth-server/international/","title":"Internationalization","text":"<p>Please use the left navigation menu to browse the content of this section while we are still working on developing content for <code>Overview</code> page.</p> <p>Contribute</p> <p>If you'd like to contribute content to this page, get started with the Contribution Guide</p>","tags":["administration","auth-server","i18n"]},{"location":"janssen-server/auth-server/international/client-config/","title":"Client Configuration","text":"","tags":["administration","auth-server","i18n"]},{"location":"janssen-server/auth-server/international/client-config/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","auth-server","i18n"]},{"location":"janssen-server/auth-server/international/client-config/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","i18n"]},{"location":"janssen-server/auth-server/international/client-config/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","i18n"]},{"location":"janssen-server/auth-server/international/scope-descriptions/","title":"Scope Description","text":"","tags":["administration","auth-server","i18n"]},{"location":"janssen-server/auth-server/international/scope-descriptions/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","auth-server","i18n"]},{"location":"janssen-server/auth-server/international/scope-descriptions/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","i18n"]},{"location":"janssen-server/auth-server/international/scope-descriptions/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","i18n"]},{"location":"janssen-server/auth-server/international/web-pages/","title":"Internationalization for Web Pages","text":"","tags":["administration","auth-server","i18n","internationalization"]},{"location":"janssen-server/auth-server/international/web-pages/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","auth-server","i18n","internationalization"]},{"location":"janssen-server/auth-server/international/web-pages/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","i18n","internationalization"]},{"location":"janssen-server/auth-server/international/web-pages/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","i18n","internationalization"]},{"location":"janssen-server/auth-server/logging/","title":"Logging Overview","text":"<p>All <code>jans-auth-server</code> log files are located in <code>/opt/jans/jetty/jans-auth/logs/</code>.</p> <p>Use log levels to control noise of logs in standard logs.</p> <p>Following AS configuration properties can be used to customize AS logging:</p> <ul> <li><code>loggingLevel</code> - Specify the log levels of loggers</li> <li><code>loggingLayout</code> - Logging layout used for Jans Authorization Server loggers</li> <li><code>httpLoggingEnabled</code> - Enable/disable request/response logging filter. Disabled by default.</li> <li><code>disableJdkLogger</code> - Choose whether to disable JDK loggers</li> <li><code>enabledOAuthAuditLogging</code> - enable OAuth Audit Logging</li> <li><code>externalLoggerConfiguration</code> - The path to the external log4j2 logging configuration</li> <li><code>httpLoggingExcludePaths</code> - This list details the base URIs for which the request/response logging filter will not record activity</li> </ul> <p>AS has pre-defined set of standard logs which can be overwritten by own log4j2 xml.</p> <p>AS under the hood is using <code>log4j2</code> and <code>slf4j</code> thus please reference log4j configuration for available logging options.</p> <p>AS support audit logs.</p>","tags":["administration","auth-server","logging"]},{"location":"janssen-server/auth-server/logging/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>You can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","logging"]},{"location":"janssen-server/auth-server/logging/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","logging"]},{"location":"janssen-server/auth-server/logging/audit-logs/","title":"Audit Logs","text":"<p>Audit logs are located in <code>jans-auth_audit.log</code> log file. All <code>jans-auth-server</code> log files are located in <code>/opt/jans/jetty/jans-auth/logs/</code>.</p> <p>Audit is disabled by default on AS and can be enabled via <code>enabledOAuthAuditLogging</code> AS configuration property.</p> <p>Audit logs are logged to file when enabled, however if JMS configuration is specified it will be logged to JMS as well.</p> <p>JMS Configuration must be set inside AS global configuration</p> Name Description jmsBrokerURISet JMS Broker URI Set jmsUserName JMS UserName jmsPassword JMS Password. <p>Audit events: - CLIENT_REGISTRATION - CLIENT_UPDATE - CLIENT_READ - CLIENT_DELETE - USER_AUTHORIZATION - BACKCHANNEL_AUTHENTICATION - BACKCHANNEL_DEVICE_REGISTRATION - USER_INFO - TOKEN_REQUEST - TOKEN_VALIDATE - TOKEN_REVOCATION - SESSION_UNAUTHENTICATED - SESSION_AUTHENTICATED - SESSION_DESTROYED - DEVICE_CODE_AUTHORIZATION - SSA_CREATE - SSA_READ </p>","tags":["administration","auth-server","logging"]},{"location":"janssen-server/auth-server/logging/audit-logs/#enabledisable-audit-logs-on-jans-tui","title":"Enable/Disable Audit Logs on Jans TUI","text":"<p>Using Jans TUI we can easily <code>Enable</code> or <code>Disable</code> Audit Logs. Go to <code>jans tui</code> select <code>Auth Server</code> tab then <code>Properties</code> tab. Now set the value of  <code>enabledOAuthAuditLogging</code> pressing Enter button on your keyboard. Save it and let's see below image</p> <p></p>","tags":["administration","auth-server","logging"]},{"location":"janssen-server/auth-server/logging/audit-logs/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>You can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","logging"]},{"location":"janssen-server/auth-server/logging/audit-logs/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","logging"]},{"location":"janssen-server/auth-server/logging/custom-logs/","title":"Customize logs","text":"<p>Sometimes it can be useful to customize logging behavior or override AS loggers. It is possible to fully override AS logging configuration by specifying own <code>log4j2.xml</code> file in <code>externalLoggerConfiguration</code> AS configuration property. It must point to valid <code>log4j2.xml</code> file.</p> <p>Note: invalid external <code>log4j2.xml</code> can lead to AS start up issues and no logs in standard log files or otherwise in other log files if such are defined by <code>log4j2.xml</code>.</p>","tags":["administration","auth-server","logging","custom-logs"]},{"location":"janssen-server/auth-server/logging/custom-logs/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>You can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","logging","custom-logs"]},{"location":"janssen-server/auth-server/logging/custom-logs/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","logging","custom-logs"]},{"location":"janssen-server/auth-server/logging/log-levels/","title":"Log Levels","text":"<p>Log level for AS can be set in <code>loggingLevel</code> AS configuration property. AS under the hood is using <code>log4j2</code> and <code>slf4j</code>. Thus logging levels in <code>loggingLevel</code> stick to <code>log4j2</code> and are following:</p> Log Level Description OFF No events will be logged. FATAL A fatal event that will prevent the application from continuing. ERROR An error in the application, possibly recoverable. WARN An event that might possible lead to an error. INFO An event for informational purposes. DEBUG A general debugging event. TRACE A fine-grained debug message, typically capturing the flow through the application. ALL All events should be logged.","tags":["administration","auth-server","logging-levels"]},{"location":"janssen-server/auth-server/logging/log-levels/#select-log-levels-on-tui","title":"Select Log Levels on TUI","text":"<p>Go to Jans TUI  <code>jans tui</code>. Select <code>Auth Server</code> tab then select <code>Logging</code> tab after that select Auth Server <code>Log Level</code> finally <code>save logging</code> and exit from TUI.</p> <p></p>","tags":["administration","auth-server","logging-levels"]},{"location":"janssen-server/auth-server/logging/log-levels/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>You can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","logging-levels"]},{"location":"janssen-server/auth-server/logging/log-levels/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","logging-levels"]},{"location":"janssen-server/auth-server/logging/log4j2/","title":"log4j2","text":"<p>AS under the hood is using <code>log4j2</code> and <code>slf4j</code>. AS is configured by log4j2.xml</p> <p>Main structure of which defines standard logs and which can be overwritten by specifying own custom log4j2.xml.</p> <p>Please reference log4j configuration for available logging options.</p> <p>Sample <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n\n&lt;Configuration packages=\"io.jans.log\"&gt;\n    &lt;Appenders&gt;\n        &lt;Console name=\"STDOUT\" target=\"SYSTEM_OUT\"&gt;\n            &lt;PatternLayout pattern=\"%d %-5p [%t] [%C{6}] (%F:%L) - %m%n\" /&gt;\n        &lt;/Console&gt;\n\n        &lt;RollingFile name=\"JANS_AUTH_HTTP_REQUEST_RESPONSE_FILE\" fileName=\"${sys:log.base}/logs/http_request_response.log\" filePattern=\"${sys:log.base}/logs/http_request_response-%d{yyyy-MM-dd}-%i.log\"&gt;\n\n            &lt;PatternLayout pattern=\"%d %-5p [%t] [%C{6}] (%F:%L) - %m%n\" /&gt;\n\n            &lt;Policies&gt;\n                &lt;TimeBasedTriggeringPolicy interval=\"1\" modulate=\"true\" /&gt;\n                &lt;SizeBasedTriggeringPolicy size=\"250 MB\" /&gt;\n            &lt;/Policies&gt;\n            &lt;DefaultRolloverStrategy max=\"30\" /&gt;\n        &lt;/RollingFile&gt;\n\n        &lt;RollingFile name=\"FILE\" fileName=\"${sys:log.base}/logs/jans-auth.log\" filePattern=\"${sys:log.base}/logs/jans-auth-%d{yyyy-MM-dd}-%i.log\"&gt;\n\n            &lt;PatternLayout pattern=\"%d %-5p [%t] %X{X-Correlation-Id} [%C{6}] (%F:%L) - %m%n\" /&gt;\n\n            &lt;Policies&gt;\n                &lt;TimeBasedTriggeringPolicy interval=\"1\" modulate=\"true\" /&gt;\n                &lt;SizeBasedTriggeringPolicy size=\"250 MB\" /&gt;\n            &lt;/Policies&gt;\n            &lt;DefaultRolloverStrategy max=\"30\" /&gt;\n        &lt;/RollingFile&gt;\n\n        &lt;RollingFile name=\"JANS_AUTH_PERSISTENCE_FILE\" fileName=\"${sys:log.base}/logs/jans-auth_persistence.log\" filePattern=\"${sys:log.base}/logs/jans-auth_persistence-%d{yyyy-MM-dd}-%i.log\"&gt;\n\n            &lt;PatternLayout pattern=\"%d %-5p [%t] %X{X-Correlation-Id} [%C{6}] (%F:%L) - %m%n\" /&gt;\n\n            &lt;Policies&gt;\n                &lt;TimeBasedTriggeringPolicy interval=\"1\" modulate=\"true\" /&gt;\n                &lt;SizeBasedTriggeringPolicy size=\"250 MB\" /&gt;\n            &lt;/Policies&gt;\n            &lt;DefaultRolloverStrategy max=\"30\" /&gt;\n        &lt;/RollingFile&gt;\n\n        &lt;RollingFile name=\"JANS_AUTH_PERSISTENCE_DURATION_FILE\" fileName=\"${sys:log.base}/logs/jans-auth_persistence_duration.log\" filePattern=\"${sys:log.base}/logs/jans-auth_persistence_duration-%d{yyyy-MM-dd}-%i.log\"&gt;\n\n            &lt;PatternLayout pattern=\"%d %-5p [%t] %X{X-Correlation-Id} [%C{6}] (%F:%L) - %m%n\" /&gt;\n\n            &lt;Policies&gt;\n                &lt;TimeBasedTriggeringPolicy interval=\"1\" modulate=\"true\" /&gt;\n                &lt;SizeBasedTriggeringPolicy size=\"250 MB\" /&gt;\n            &lt;/Policies&gt;\n            &lt;DefaultRolloverStrategy max=\"30\" /&gt;\n        &lt;/RollingFile&gt;\n\n\n\n        &lt;RollingFile name=\"JANS_AUTH_SCRIPT_LOG_FILE\" fileName=\"${sys:log.base}/logs/jans-auth_script.log\" filePattern=\"${sys:log.base}/logs/jans-auth_script-%d{yyyy-MM-dd}-%i.log\"&gt;\n\n            &lt;PatternLayout pattern=\"%d %-5p [%t] %X{X-Correlation-Id} [%C{6}] (%F:%L) - %m%n\" /&gt;\n\n            &lt;Policies&gt;\n                &lt;TimeBasedTriggeringPolicy interval=\"1\" modulate=\"true\" /&gt;\n                &lt;SizeBasedTriggeringPolicy size=\"250 MB\" /&gt;\n            &lt;/Policies&gt;\n            &lt;DefaultRolloverStrategy max=\"30\" /&gt;\n        &lt;/RollingFile&gt;\n\n        &lt;RollingFile name=\"JANS_AUTH_AUDIT_LOG_FILE\" fileName=\"${sys:log.base}/logs/jans-auth_audit.log\" filePattern=\"${sys:log.base}/logs/jans-auth_audit-%d{yyyy-MM-dd}-%i.log\"&gt;\n\n            &lt;PatternLayout pattern=\"%d %-5p [%macAddr] [%t] %X{X-Correlation-Id} [%C{6}] (%F:%L) - %m%n\" /&gt;\n\n            &lt;Policies&gt;\n                &lt;TimeBasedTriggeringPolicy interval=\"1\" modulate=\"true\" /&gt;\n                &lt;SizeBasedTriggeringPolicy size=\"250 MB\" /&gt;\n            &lt;/Policies&gt;\n            &lt;DefaultRolloverStrategy max=\"30\" /&gt;\n        &lt;/RollingFile&gt;\n    &lt;/Appenders&gt;\n\n    &lt;Loggers&gt;\n        &lt;!-- ############### Gluu ################# --&gt;\n        &lt;Logger name=\"io.jans\" level=\"${log4j.default.log.level}\" /&gt;\n\n        &lt;!-- EMB-6, JMS activation throws an error due to deployment ordering, but as there is a timeout and retry the tests pass. Hide the error message --&gt;\n        &lt;Logger name=\"jboss.resource.adapter.jms.inflow.JmsActivation\" level=\"error\" /&gt;\n\n        &lt;Logger name=\"com.ocpsoft\" level=\"info\" /&gt;\n\n        &lt;!-- ############### Hibernate logging ################# --&gt;\n        &lt;Logger name=\"org.hibernate\" level=\"error\" /&gt;\n\n        &lt;Logger name=\"io.jans.as.server.audit.debug\" level=\"${log4j.default.log.level}\" additivity=\"false\"&gt;\n            &lt;AppenderRef ref=\"JANS_AUTH_HTTP_REQUEST_RESPONSE_FILE\" /&gt;\n        &lt;/Logger&gt;\n\n        &lt;Logger name=\"io.jans.orm\" level=\"${log4j.default.log.level}\" additivity=\"false\"&gt;\n            &lt;AppenderRef ref=\"JANS_AUTH_PERSISTENCE_FILE\" /&gt;\n        &lt;/Logger&gt;\n\n\n        &lt;logger name=\"com.couchbase.client\" level=\"${log4j.default.log.level}\" additivity=\"false\"&gt;\n            &lt;AppenderRef ref=\"JANS_AUTH_PERSISTENCE_FILE\" /&gt;\n        &lt;/logger&gt;\n\n\n\n        &lt;Logger name=\"io.jans.orm.couchbase.operation.watch\" level=\"${log4j.default.log.level}\" additivity=\"false\"&gt;\n            &lt;AppenderRef ref=\"JANS_AUTH_PERSISTENCE_DURATION_FILE\" /&gt;\n        &lt;/Logger&gt;\n\n        &lt;Logger name=\"io.jans.orm.watch\" level=\"${log4j.default.log.level}\" additivity=\"false\"&gt;\n            &lt;AppenderRef ref=\"JANS_AUTH_PERSISTENCE_DURATION_FILE\" /&gt;\n        &lt;/Logger&gt;\n\n\n\n        &lt;Logger name=\"io.jans.service.PythonService\" level=\"${log4j.default.log.level}\" additivity=\"false\"&gt;\n            &lt;AppenderRef ref=\"JANS_AUTH_SCRIPT_LOG_FILE\" /&gt;\n        &lt;/Logger&gt;\n\n        &lt;Logger name=\"io.jans.service.custom.script\" level=\"${log4j.default.log.level}\" additivity=\"false\"&gt;\n            &lt;AppenderRef ref=\"JANS_AUTH_SCRIPT_LOG_FILE\" /&gt;\n        &lt;/Logger&gt;\n\n        &lt;Logger name=\"io.jans.as.server.service.custom\" level=\"${log4j.default.log.level}\" additivity=\"false\"&gt;\n            &lt;AppenderRef ref=\"JANS_AUTH_SCRIPT_LOG_FILE\" /&gt;\n        &lt;/Logger&gt;\n\n        &lt;Logger name=\"io.jans.agama.engine.script.LogUtils\" level=\"${log4j.default.log.level}\" additivity=\"false\"&gt;\n            &lt;AppenderRef ref=\"JANS_AUTH_SCRIPT_LOG_FILE\" /&gt;\n        &lt;/Logger&gt;\n\n        &lt;Logger name=\"io.jans.as.server.audit.ApplicationAuditLogger\" level=\"${log4j.default.log.level}\" additivity=\"false\"&gt;\n            &lt;AppenderRef ref=\"JANS_AUTH_AUDIT_LOG_FILE\" /&gt;\n        &lt;/Logger&gt;\n\n        &lt;Root level=\"info\"&gt;\n            &lt;AppenderRef ref=\"FILE\" /&gt;\n            &lt;AppenderRef ref=\"STDOUT\" /&gt;\n        &lt;/Root&gt;\n    &lt;/Loggers&gt;\n&lt;/Configuration&gt;\n</code></pre></p>","tags":["administration","auth-server","logging"]},{"location":"janssen-server/auth-server/logging/log4j2/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>You can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","logging"]},{"location":"janssen-server/auth-server/logging/log4j2/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","logging"]},{"location":"janssen-server/auth-server/logging/standard-logs/","title":"Standard Logs","text":"<p>All <code>jans-auth-server</code> log files are located in <code>/opt/jans/jetty/jans-auth/logs/</code>.</p> <ol> <li><code>jans-auth.log</code> - main AS log file. All logs during execution goes here.</li> <li><code>jans-auth_script.log</code>: - contains custom interception scripts related log messages. Use <code>scriptLogger</code> inside custom script to log messages to this log file.</li> <li><code>jans-auth_persistence.log</code> - log which contains entries from AS persistance layer </li> <li><code>jans-auth_persistence_duration.log</code> - log which contains duration of query execution. It can be useful during performance issues investigation </li> <li><code>app_persistence_orm_statistics.log</code> - contains statistics about persistence layer activities</li> <li><code>jans-auth_audit.log</code> - contains audit log information (audit is disabled by default and can be enabled via <code>enabledOAuthAuditLogging</code> AS configuration property) </li> <li><code>http_request_response.log</code> - contains http request/response data. It can be enabled via <code>httpLoggingEnabled</code> AS configuration property.</li> </ol>","tags":["administration","auth-server","logging"]},{"location":"janssen-server/auth-server/logging/standard-logs/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>You can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","logging"]},{"location":"janssen-server/auth-server/logging/standard-logs/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","logging"]},{"location":"janssen-server/auth-server/oauth-features/","title":"OpenID Connect Provider (OP)","text":"<p>The Janssen Authentication Server has core OAuth 2.0 support as well as many other related specs:</p> <ul> <li>The OAuth 2.0 Authorization Framework (spec)</li> <li>The OAuth 2.0 Authorization Framework: Bearer Token Usage (spec)</li> <li>JSON Web Token (JWT) Profile for OAuth 2.0 Access Tokens (spec)</li> <li>JSON Web Token (JWT) (spec)</li> <li>OAuth 2.0 Token Introspection (spec)</li> <li>OAuth 2.0 Device Authorization Grant (spec)</li> <li>OAuth 2.0 Token Revocation (spec)</li> <li>Proof Key for Code Exchange by OAuth Public Clients (PKCE) (spec)</li> <li>OAuth 2.0 for Native Apps (spec)</li> <li>OAuth 2.0 Token Exchange (spec)</li> <li>OAuth 2.0 Authorization Server Metadata (spec)</li> <li>OAuth 2.0 Dynamic Client Registration Protocol (spec)</li> <li>OAuth 2.0 Pushed Authorization Requests (spec)</li> <li>OAuth 2.0 Demonstrating Proof-of-Possession at the Application Layer (DPoP) (spec)</li> <li>OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens (spec)</li> <li>Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants (spec)</li> <li>JWT Secured Authorization Response Mode for OAuth 2.0 (JARM) (spec)</li> <li>OAuth 2.0 for First-Party Applications (spec draft)</li> <li>The Use of Attestation in OAuth 2.0 Dynamic Client Registration (spec draft)</li> <li>OpenID Connect Core Error Code unmet_authentication_requirements (spec)</li> <li>Transaction Tokens (spec)</li> <li>Global Token Revocation (spec)</li> <li>JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants (spec)</li> </ul>","tags":["administration","auth-server","oauth","feature"]},{"location":"janssen-server/auth-server/oauth-features/#protocol-overview","title":"Protocol Overview","text":"<p>OAuth 2.0 is the industry-standard protocol for authorization. OAuth 2.0 focuses on client developer simplicity providing specific authorization flows for different applications (e.g. web applications, desktop applications, mobile phones, and other devices).</p> <p>It's handy to know some OAuth 2.0 terminology:</p> <ul> <li> <p>resource owner - An entity capable of granting access to a protected resource.                        When the resource owner is a person, it is referred to as an end-user.</p> </li> <li> <p>resource server - The server hosting the protected resources, capable of accepting                         and responding to protected resource requests using access tokens.</p> </li> <li> <p>client - An application making protected resource requests on behalf of the                resource owner and with its authorization.  The term \"client\" does                not imply any particular implementation characteristics (e.g.,                whether the application executes on a server, a desktop, or other devices).</p> </li> <li> <p>authorization server - The server issuing access tokens to the client after successfully                              authenticating the resource owner and obtaining authorization.</p> </li> </ul>","tags":["administration","auth-server","oauth","feature"]},{"location":"janssen-server/auth-server/oauth-features/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>You can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","oauth","feature"]},{"location":"janssen-server/auth-server/oauth-features/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","oauth","feature"]},{"location":"janssen-server/auth-server/oauth-features/auth-code-grant/","title":"OAuth 2.0 Authorization Code Grant","text":"<p>The Authorization Code grant type is used by confidential and public clients to exchange an authorization code for an access token. After the user returns to the client via the redirect URL, the application will get the authorization code from the URL and use it to request an access token.</p>","tags":["administration","auth-server","oauth","feature","grant","code"]},{"location":"janssen-server/auth-server/oauth-features/auth-code-grant/#sequence-diagram","title":"Sequence Diagram","text":"<pre><code>\nsequenceDiagram\ntitle Authorization code flow\nautonumber 1\n\nparticipant Resource owner User \nactivate Resource owner User\nClient-&gt;&gt;Jans AS:Authorization Request\nactivate Client \nactivate Jans AS\nResource owner User -&gt;&gt;Jans AS:User login and consent\nJans AS--&gt;&gt;Client:Authorization code response\ndeactivate Client\ndeactivate Jans AS\n\nClient-&gt;&gt;Jans AS: Exchange code for Access Token\nactivate Client\nactivate Jans AS\nJans AS--&gt;&gt;Client: Access Token with optional Refresh Token\ndeactivate Client\ndeactivate Jans AS\n\nloop \n    Client-&gt;&gt;Resource Server: Call API with Access Token\n    activate Client\n    activate Resource Server\n    Resource Server--&gt;&gt;Client: Protected Resource\n    deactivate Client\n    deactivate Resource Server\nend\n\n\nClient-&gt;&gt;Resource Server: Call API with expired Access Token\nactivate Client\nactivate Resource Server\nResource Server--&gt;&gt;Client: Invalid token error\ndeactivate Client\ndeactivate Resource Server\n\n\nClient-&gt;&gt;Jans AS: Resource Token\nactivate Client\nactivate Jans AS\nJans AS--&gt;&gt;Client: Access Token with optional Refresh Token\ndeactivate Client\ndeactivate Jans AS\ndeactivate Resource owner User</code></pre>","tags":["administration","auth-server","oauth","feature","grant","code"]},{"location":"janssen-server/auth-server/oauth-features/auth-code-grant/#testing","title":"Testing","text":"<ol> <li> <p>https://github.com/JanssenProject/jans/blob/main/jans-auth-server/client/src/test/java/io/jans/as/client/ws/rs/AuthorizationCodeFlowHttpTest.java</p> </li> <li> <p>On a browser access  <code>https://my.jans.server/jans-auth/restv1/authorize?redirect_uri=https://my-redirect-app:8080&amp;client_id=Put_client_id_here&amp;scope=username+openid&amp;response_type=code</code> Based on the default authentication method set (acr), the user will be presented with credentials for login. The OpenID Provider (Gluu Server) verifies the user\u2019s identity and authenticates the user. In the back channel the following steps take place :</p> </li> <li>The OpenID Provider (Gluu Server) sends the user back to the application with an authorization code.</li> <li>The application sends the code to the Token Endpoint to receive an Access Token and ID Token in the response.</li> <li>The application uses the ID Token to authorize the user. At this point the application/RP can access the UserInfo endpoint for claims.</li> </ol>","tags":["administration","auth-server","oauth","feature","grant","code"]},{"location":"janssen-server/auth-server/oauth-features/client-credential-grant/","title":"OAuth 2.0 client credentials Grant","text":"","tags":["administration","auth-server","oauth","feature","grant","client-credentials"]},{"location":"janssen-server/auth-server/oauth-features/client-credential-grant/#sequence-diagram","title":"Sequence Diagram","text":"<pre><code>sequenceDiagram\ntitle Client credentials flow\nautonumber 1\n\nactivate Resource owner Client\nResource owner Client-&gt;&gt;Jans AS:Client Authentication\nactivate Jans AS\nJans AS--&gt;&gt;Resource owner Client:Access Token\ndeactivate Jans AS</code></pre>","tags":["administration","auth-server","oauth","feature","grant","client-credentials"]},{"location":"janssen-server/auth-server/oauth-features/client-credential-grant/#testing","title":"Testing","text":"<ol> <li> <p>https://github.com/JanssenProject/jans/blob/main/jans-auth-server/client/src/test/java/io/jans/as/client/ws/rs/ClientCredentialsGrantHttpTest.java</p> </li> <li> <p>CURL Command: <pre><code>curl -k -u \"put_client_id:put_client_secret\" https://jans-ui.jans.io/jans-auth/restv1/token \\ \n      -d  \"grant_type=client_credentials&amp;scope=put_scope_name_here\" \n</code></pre></p> </li> </ol>","tags":["administration","auth-server","oauth","feature","grant","client-credentials"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/","title":"OAuth 2.0 Device Authorization Grant","text":"<p>This OAuth 2.0 protocol extension enables OAuth clients to request user authorization from applications on devices (e.g. smart TVs, media consoles, printers) that  are input-constrained or browser-less . The authorization flow defined by this RFC 8628, sometimes referred to as the \"device flow\", instructs the user to review the authorization request on a secondary device, such as a smartphone or a personal computer, which has the requisite input and browser capabilities to complete the user interaction.</p>","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/#sequence-diagram","title":"Sequence Diagram","text":"<p>Paste the following source text of the sequence diagram on sequencediagram.org <pre><code>title Oauth2.0 Device Authorization flow\n\nparticipant User\nparticipant Browser on Computer / Smartphone\nparticipant Device App\nparticipant Jans AS\nparticipant Third Party App\n\nUser-&gt;Device App:Opens an app on device\nDevice App-&gt;Jans AS:Sends authorization request \\n\"jans-server.com/jans-auth/restv1/device_authorization\"\nJans AS-&gt;Device App:Response - \\nuser_code, device_code, verification_url, interval, expiration\nDevice App -&gt;User: Instructs the user to access Verification URL \\nand enter user_code\nnote over Device App:Device App will keep polling AS for Access Token \\nuntil device authorization is completed\nloop till Device App recieves Access Token:\nDevice App-&gt;Jans AS:request Access Token\nJans AS-&gt;Device App:Response - \\naccess_denied \\nOR expired_token \\nOR authorization_pending \\nOR Access token\nend \nUser-&gt;Browser on Computer / Smartphone:Opens a browser \\nand access verification URL\nBrowser on Computer / Smartphone-&gt;Jans AS:send user_code to verification URL\nBrowser on Computer / Smartphone &lt;-Jans AS:Login and authorization prompt\nBrowser on Computer / Smartphone-&gt;Jans AS:Authentication and consent\nJans AS-&gt;Jans AS: Mark device as Authorized\nnote over Jans AS:Subsequent polling by the Device App \\nwill return an Access Token as indicated \\nby the loop above\nDevice App-&gt;Third Party App:Invoke API with Access Token\nThird Party App-&gt;Device App: return Response\n</code></pre></p>","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/#user-experience","title":"User Experience","text":"<ol> <li>First, the user requests authorization from the device:</li> </ol> <ol> <li>At the URL displayed on the screen, the user can input the displayed code in the device.</li> </ol> <ol> <li>After that, user could need to authenticate, then decide whether permissions will be granted.</li> </ol> <p><code>acr</code> value can be specified in <code>deviceAuthzAcr</code> AS configuration property.</p> <p></p> <ol> <li>Finally, the confirmation screen will be shown.</li> </ol> <p></p>","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/#acr-value-during-device-authorization","title":"ACR value during Device Authorization","text":"<p>User is required to authenticate if not authenticated yet. By default <code>acr_values</code> is not set in authorization request, which means it relies on default AS handling. However it's possible explicitly set <code>acr</code> value during Device Authorization by setting <code>deviceAuthzAcr</code> AS configuration property.</p>","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/#request-user-and-device-codes","title":"Request user and device codes","text":"<p>This first step, device sends an HTTP POST request to Jans authorization server, at <code>/jans-auth/restv1/device_authorization</code> which is also presented in the <code>Discovery url</code> published by Jans Server, this endpoint could process a common authentication method or it could also not do any authentication, depending on the configuration for the client in Jans Server.</p>","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/#parameters","title":"Parameters","text":"Parameter Description client_id Required The client ID for your application. scope Required A space separated list of scopes that identify the resources that the device could access on the user's behalf. These values inform the consent screen that Jans server displays to the user.","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/#example","title":"Example","text":"<pre><code>POST /restv1/device_authorization HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nHost: test.jans.org\nAuthorization: Basic MTIzLTEyMy0xMjM6WkE1aWxpTFFDYUR4\n\nclient_id=123-123-123&amp;scope=openid+profile+address+email+phone\n</code></pre>","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/#device-request-response","title":"Device Request response","text":"<p>In response, the Jans authorization server generates a unique device verification code and an end-user code that are valid for a limited time and includes them in the HTTP response body using the \"application/json\" format with a 200 (OK) status code.  The response contains the following parameters:</p> Parameter Description user_code Required The end-user verification code device_code Required The device verification code verification_uri Required The end-user verification URI on the authorization server. This should be shown to the end-user because he should open this url in the rich user-agent. verification_uri_complete Optional This is similar than <code>verification_uri</code>, however it also includes <code>user_code</code> as a query param in the url. It's issued if the device wants to use QR mode for example. expires_in Required The lifetime in seconds of the <code>device_code</code> and <code>user_code</code>. interval Required The minimum amount of time in seconds that the client should wait between polling requests to the token endpoint.","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/#example_1","title":"Example:","text":"<pre><code>HTTP/1.1 200\nContent-Length: 307\nContent-Type: application/json\nServer: Jetty(9.4.19.v20190610)\n\n{\n    \"user_code\": \"SJFP-DTPL\",\n    \"device_code\": \"aeb28bdc90d806ac58d4b0f832f06c3ac9c4bd03292f0c09\",\n    \"interval\": 5,\n    \"verification_uri_complete\": \"https://test.jans.io:8443/device-code?user_code=SJFP-DTPL\",\n    \"verification_uri\": \"https://test.jans.io:8443/device-code\",\n    \"expires_in\": 1800\n}\n</code></pre>","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/#device-display","title":"Device Display","text":"<p>Common flow, the device should display <code>verification_url</code> and <code>user_code</code> received from Jans server. The content that the device displays to the user should instruct the user to navigate to the <code>verification_url</code> on a separate device and enter the <code>user_code</code>.</p> <p>Design device interface following these rules:</p> <ol> <li> <p><code>user_code</code> has the following format: XXXX-XXXX where Xs represent to any ASCII character, for example: RTXD-HTLK. The length of the <code>user_code</code> will be always the same, therefore it's highly recommended to show it as clear and big that the user can read it easly.</p> </li> <li> <p><code>verification_url</code> should be displayed also in a way that the user can read it easily. The normal length should be around 40 characters, however it could depends also on the domain used for the server. Remember that the user will need to write the whole URL manually in the web browser, therefore it's recommended to use a short URL.</p> </li> <li> <p><code>verification_url_complete</code> will be used for those cases where device can show QR (Quick Response) codes or NFC (Near Field Communication) to save the user from typing the whole URI. Interaction between device and Jans server will be the same, however user can process the authorization faster. For example:</p> </li> </ol>","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/#user-login-authorization","title":"User Login &amp; Authorization","text":"<p>The user will need to put <code>user_code</code> value in the browser and after that, he will be redirected to the common authorization flow, it requires login whether there is no session between the user-agent and the Jans server and grant the permissions based on the device request.</p>","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/#poll-token","title":"Poll Token","text":"<p>Since the user will be using a separate device to navigate to the <code>verification_url</code> and grant or deny access, the requesting device is not automatically notified when the user responds to the access request. For that reason, the requesting device needs to poll the Jans Server to determine when the user has responded to the request.</p> <p>The requesting device should continue sending polling requests until it receives a response indicating that the user has responded to the access request or until the <code>device_code</code> expires. The parameter <code>interval</code> returned in step 2 specifies the amount of time, in seconds, to wait between requests.</p> <p>The URL of the endpoint to poll is <code>/jans-auth/restv1/token</code>. The polling request contains the following parameters:</p>","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/#parameters_1","title":"Parameters","text":"Parameter Description client_id Required The client ID for your application. grant_type Required Must be <code>urn:ietf:params:oauth:grant-type:device_code</code>. device_code Required The device verification code which is returned by Jans server in Step 2. <p>Authentication can be done using any of those authentication methods for this token endpoint.</p>","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/#example_2","title":"Example:","text":"<pre><code>POST /restv1/token HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nHost: test.jans.io\nAuthorization: Basic MTIzLTEyMy0xMjM6WkE1aWxpTFFDYUR4\n\ngrant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Adevice_code&amp;device_code=0bd7068e7fdab4bb91b313296a96462256a7370d12f073f0\n</code></pre>","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/#token-response","title":"Token Response","text":"<p>The Jans authorization server responds to each polling request with one of the following responses:</p> <p>Access granted</p> <p>If the user granted access to the device (by clicking <code>Allow</code> on the consent screen), then the response contains an access token and a refresh token. The tokens enable the device to access to the resource server on the user's behalf.</p> <p>In this case, the server responds with all tokens required and allowed to be issued depending on the configuration in the server.</p> <p>Example:</p> <pre><code>HTTP/1.1 200\nContent-Length: 858\nContent-Type: application/json\nServer: Jetty(9.4.19.v20190610)\n\n{\"access_token\":\"c31fc092-453b-4275-a36f-b2740c3eb1a6\",\"id_token\":\"eyJraWQiOiJlY4.2Tc4NDgxYy05OTJkLTRmN2UtYTkzMS03NjM2NTYyMzgwZjVfc2lnX3JzMjU2IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJhdF9oYXNoIjoidWdMSnAzMkxXdnI4QUdlbmdNTlF3QSIsImF1ZCI6IjEyMy0xMjMtMTIzIiwic3ViIjoiM2M2M25HdWZnWFNkMWFwNU81NFZkVjlUUDdmdjJHc0YtLWl0eVBHeFJBTSIsImlzcyI6Imh0dHBzOi8vdGVzdC5nbHV1Lm9yZzo4NDQzIiwiZXhwIjoxNTk1NjQzOTg0LCJpYXQiOjE1OTU2NDAzODQsIm94T3BlbklEQ29ubmVjdFZlcnNpb24iOiJvcGVuaWRjb25uZWN0LTEuMCJ9.fElZtuUslhSSuqTOuvGeafG4QuQoHKLpya25RHWkC5V9Xf9ODYa6tD_Tdav2D9Gff2Zz7pt8WKso-WYOqmJ3NrgMoVU7d1SMj6pYGilTL1JokjB18Yw1TI6oR6Z4wegy8_ajftLLhqosI5-ZE36TzPwoAKzjPl-iZEpV2U1OPHWZrdwc9N3YOyO0I_IJGQmFnXC_oacitMV2VZaTxfuCew5cPwNp5durooFNvv3DPzc9JYEctmaLsiRtfqN7pCaV30B3hnYTYZ4p2HNsUbOewBI8_Brm1v1CByitQPUFqETgmPGbf4HCTEoaH-7DfaXnAsePt73blNwJrlTlUBieew\",\"token_type\":\"bearer\",\"expires_in\":299}\n</code></pre> <p>Access denied</p> <p>If the user refuses to grant access to the device, then the server response has a <code>400</code> HTTP response status code. The response contains the following error:</p> <pre><code>HTTP/1.1 400\nCache-Control: no-store\nContent-Length: 74\nContent-Type: application/json\nPragma: no-cache\nServer: Jetty(9.4.19.v20190610)\n\n{\n    \"error_description\": \"access_denied\",\n    \"error\": \"access_denied\"\n}\n</code></pre> <p>Authorization pending It means that the request hasn't been processed by the end-user yet, therefore the request is still in process.</p> <p>Example:</p> <pre><code>HTTP/1.1 400\nCache-Control: no-store\nContent-Length: 90\nContent-Type: application/json\nPragma: no-cache\nServer: Jetty(9.4.19.v20190610)\n\n{\n    \"error_description\": \"authorization_pending\",\n    \"error\": \"authorization_pending\"\n}\n</code></pre> <p>Polling too frequently If the device sends polling requests too frequently, then the server returns a <code>400</code> HTTP response status code. Then the device should increase the time interval between requests.</p> <p>Example:</p> <pre><code>HTTP/1.1 400\nCache-Control: no-store\nContent-Length: 66\nContent-Type: application/json\nPragma: no-cache\nServer: Jetty(9.4.19.v20190610)\n\n{\n    \"error_description\": \"slow_down\",\n    \"error\": \"slow_down\"\n}\n</code></pre> <p>Other errors This token endpoint can return any error code already defined, for example whether client can't be authenticated or the grant type sent is invalid. Some of them could be: <code>invalid_client</code>, <code>invalid_grant</code>, <code>invalid_request</code> and others.</p>","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/device-grant/#customizing-device-grant-page","title":"Customizing Device Grant page","text":"<p>More about customising this page  to include your organization's stylesheets, images and content in this article</p>","tags":["administration","auth-server","oauth","feature","device","grant"]},{"location":"janssen-server/auth-server/oauth-features/dpop/","title":"DPoP (Demonstrating Proof-of-Possession at the Application Layer)","text":"<p>Janssen Server supports <code>DPoP</code> (Demonstrating Proof-of-Possession) at the Application Layer, which is OAuth 2.0 feature to enhance the security of resources protected by access tokens.</p> <p>When DPoP is being used, the Janssen Server checks whether the presenter of the access token is the one to whom the access token was issued. Hence, making sure that a stolen access token is not being used by someone else to access the protected resource. OAuth 2.0 DPoP specification is available here</p> <p>Janssen Server also supports OAuth MTLS(Mutual TLS) as a mechanism to ensure that the token presenting party is legitimate. While MTLS should be preferred whenever it is possible to use it, for other cases like single page application(SPA), DPoP can be used.</p>","tags":["administration","auth-server","oauth","feature","dpop"]},{"location":"janssen-server/auth-server/oauth-features/dpop/#using-dpop","title":"Using DPoP","text":"","tags":["administration","auth-server","oauth","feature","dpop"]},{"location":"janssen-server/auth-server/oauth-features/dpop/#using-dpop-proof-jwt","title":"Using DPoP Proof JWT","text":"<p>To use DPoP protection, the client needs to create DPoP Proof JWT (or DPoP Proof) and send it using <code>DPoP</code> request header to Janssen Server when:</p> <ol> <li>Requesting for a new access token</li> <li>Accessing a protected resource using the access token</li> </ol> <p>DPoP proofs are created differently for the cases listed above. DPoP specification describes how.</p> <p>When an access token is requested with the DPoP header (1 above), the Janssen Server returns an access token (or refresh token) that is bound(mapped) to the public key attached with the DPoP proof.</p> <p>Subsequently, when the client uses the access token to access the protected resource (2 above), it again creates and attaches the DPoP Proof with the request. The resource server checks the validity of the request by ensuring that the access token used is bound to the same public key which is presented in the DPoP proof in the request. The resource server uses steps laid out in the specification to ascertain this.</p> <pre><code>\nsequenceDiagram\n\ntitle DPoP sender-constraint access_token and refresh_token\n\nautonumber\n\nnote right of RP: Authorization Code Flow\nRP-&gt;AS: Request authorization with dpop_jtk\nAS-&gt;AS: dpop_jkt saved for authorization code\nAS-&gt;RP: Return authorization code\n\nnote right of RP: Token Request\nRP-&gt;AS: Request token with DPoP JWT\nAS-&gt;AS: Validates DPoP JWT\nAS-&gt;AS: Validates dpop_jkt against DPoP JWT if it's authz code\n\nAS-&gt;AS: Creates access_token bound to public key cnf/jkt\nnote right of AS: if AT is bearer cnf/jkt is available via introspection\nAS-&gt;RP: Returns DPoP-bound access_token with cnf/jkt (response token_type=DPoP)\nRP-&gt;RS: Request resource with access_token and DPoP JWT (with \"ath\" - AT hash)\nRS-&gt;RS: Validates access_token against DPoP (public key match cnf/jkt)\nRS-&gt;RS: Validates DPoP against access_token (access_token hash in DPoP \"ath\")\nRS-&gt;RP: Return protected resource\n</code></pre>","tags":["administration","auth-server","oauth","feature","dpop"]},{"location":"janssen-server/auth-server/oauth-features/dpop/#authorization-code-binding-to-dpop-key","title":"Authorization Code Binding to DPoP Key","text":"<p>Authorization Endpoint supports <code>dpop_jkt</code> parameter for DPoP binding of authorization code.</p> <pre><code> GET /authorize?response_type=code&amp;client_id=s6BhdRkqt3&amp;state=xyz\\\n     &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb\\\n     &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM\\\n     &amp;code_challenge_method=S256\\\n     &amp;dpop_jkt=NzbLsXh8uDCcd-6MNwXF4W_7noWXFZAfHkxZsRGC9Xs HTTP/1.1\n Host: server.example.com\n</code></pre> <p>For PAR, both ways of binging are supported:</p> <ul> <li>Via <code>dpop_jkt</code></li> <li>Via <code>DPoP</code> header where <code>dpop_jkt</code> is calculated out of <code>DPoP</code> header value</li> </ul>","tags":["administration","auth-server","oauth","feature","dpop"]},{"location":"janssen-server/auth-server/oauth-features/dpop/#using-introspection-endpoint","title":"Using Introspection Endpoint","text":"<p>Janssen Server introspection endpoint supports the JWK thumbprint confirmation method. Using this, the resource server can introspect an access token and obtain the hash of the public key associated with the access token. Response from the introspection endpoint will share this information in the format recommended in the specificaiton</p>","tags":["administration","auth-server","oauth","feature","dpop"]},{"location":"janssen-server/auth-server/oauth-features/dpop/#janssen-server-configuration-for-dpop","title":"Janssen Server Configuration for DPoP","text":"<p>Following properties of the Janssen Server can be used to tailor the behavior concerning DPoP.</p> <ul> <li>dpopJtiCacheTime</li> <li>dpopSigningAlgValuesSupported</li> <li>dpopTimeframe</li> <li>dpopUseNonce</li> <li>dpopNonceCacheTime</li> <li>dpopJktForceForAuthorizationCode</li> </ul>","tags":["administration","auth-server","oauth","feature","dpop"]},{"location":"janssen-server/auth-server/oauth-features/dpop/#dpop-proof-replay-mitigations-with-dpop-nonce","title":"DPoP Proof Replay mitigation(s) (with DPoP-Nonce)","text":"<p>When a server requires stricter proof, it can issue a nonce (a one-time-use value) that the client must include in its next DPoP proof. This ensures that proofs cannot be replayed across multiple requests or sessions.</p> <p>How It Works</p> <ol> <li>Client sends a request with a DPoP proof to the resource server or authorization server.</li> <li>Server responds with a <code>DPoP-Nonce</code> HTTP header if it requires the client to include a nonce in subsequent requests.</li> <li>Example:      <pre><code>HTTP/1.1 401 Unauthorized\nDPoP-Nonce: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n</code></pre></li> <li>Client regenerates the DPoP proof, embedding the nonce into the JWT (<code>nonce</code> claim).</li> <li>Client resends the request, this time including the updated proof with the nonce.</li> <li>Server validates the proof, checking:</li> <li>The signature matches the client\u2019s public key.</li> <li>The <code>nonce</code> claim matches the server-issued nonce.</li> <li>The nonce has not been reused.</li> </ol> <p>Nonce Claim in DPoP Proof</p> <p>When a nonce is required, the DPoP proof JWT must include:</p> <ul> <li><code>nonce</code> \u2192 the exact value from the server\u2019s <code>DPoP-Nonce</code> header.</li> </ul> <p>Example DPoP JWT payload with nonce:</p> <pre><code>{\n  \"htu\": \"https://api.example.com/resource/123\",\n  \"htm\": \"GET\",\n  \"iat\": 1696200992,\n  \"jti\": \"dbe457f3-8bde-4fc2-8e17-5c94f1a91e32\",\n  \"nonce\": \"eyJhbGciOiJIUzI1NiIs...\"\n}\n</code></pre>","tags":["administration","auth-server","oauth","feature","dpop"]},{"location":"janssen-server/auth-server/oauth-features/dpop/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","oauth","feature","dpop"]},{"location":"janssen-server/auth-server/oauth-features/dpop/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","oauth","feature","dpop"]},{"location":"janssen-server/auth-server/oauth-features/implicit-grant/","title":"OAuth 2.0 Implicit Grant","text":"<p>The Implicit Grant :</p> <p>!!! OAuth 2.0 Security Best Current Practice absolutely discourages the use of Implicit flow. Instead, use Authorization code flow with PKCE -OAuth 2.0 for Browser-Based Apps. Further reading</p>","tags":["administration","auth-server","oauth","feature","grant","implicit"]},{"location":"janssen-server/auth-server/oauth-features/implicit-grant/#sequence-diagram","title":"Sequence Diagram","text":"<pre><code>sequenceDiagram\n\ntitle Implicit flow\nautonumber 1\n\nparticipant Resource owner User\nClient-&gt;&gt;Jans AS:Authorization Request\nactivate Client\nactivate Jans AS\nResource owner User -&gt;&gt;Jans AS:User login and consent\nJans AS--&gt;&gt;Client:Access Token in the URI fragment\ndeactivate Client\ndeactivate Jans AS\n\nClient -&gt;&gt;Jans AS:Validate Access Token\nactivate Client\nactivate Jans AS\nJans AS--&gt;&gt;Client:Validate response\ndeactivate Client\ndeactivate Jans AS\n\nClient -&gt;&gt;Web - Hosted client resource:Call API with Access Token\nactivate Client\nactivate Jans AS\nJans AS--&gt;&gt;Client:Protected resource\ndeactivate Client\ndeactivate Jans AS\n</code></pre>","tags":["administration","auth-server","oauth","feature","grant","implicit"]},{"location":"janssen-server/auth-server/oauth-features/jwt-grant/","title":"OAuth 2.0 JWT Grant","text":"<p>The JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants spec.</p> <p>JWT Grant is identified by <code>grant_type=urn:ietf:params:oauth:grant-type:jwt-bearer</code> at Token Endpoint.</p> <p>AS requires client authentication during JWT Grant usage.</p> <p>Assertion validation 1. Client's <code>jwks</code> or <code>jwks_uri</code> is used to get keys for <code>assertion</code> signature validation 2. <code>aud</code> claim of <code>assertion</code> must contain AS <code>issuer</code> or otherwise any <code>aud</code> claim value must starts from AS <code>issuer</code> (for example if Token Endpoint address is set in <code>aud</code> claim value) 3. <code>iss</code> must not be blank. If AS <code>trustedSsaIssuers</code> configuration property is set then AS will validate <code>iss</code> value against <code>trustedSsaIssuers</code> configuration property. 4. AS validates <code>exp</code> on expiration 5. AS validates <code>nbf</code> if it's present 6. <code>sub</code> value must be not empty and not blank </p> <p>Sample of decoded assertion payload</p> <pre><code>{\n  \"iss\":\"https://jwt-idp.example.com\",\n  \"sub\":\"mailto:mike@example.com\",\n  \"aud\":\"https://jwt-as.example.net\",\n  \"nbf\":1300815780,\n  \"exp\":1300819380,\n  \"http://claims.example.com/member\":true\n}\n</code></pre> <p>User identification in JWT Grant</p> <p>By default there is no user in assertion and thus no user in JWT Grant. It means that User Info Endpoint can't be called with access token obtains with JWT Grant.</p> <p>However it's possible to associate user with JWT Grant for this two things has to be done: 1. explicitly allow it by setting <code>jwtGrantAllowUserByUidInAssertion</code> AS configuration property to <code>true</code> 2. add <code>uid</code> claim to <code>assertion</code> payload. </p> <p>If <code>jwtGrantAllowUserByUidInAssertion</code> is <code>true</code> and <code>uid</code> claim value points to valid user AS will associate JWT Grant with this user.</p> <p>Sample request to Token Endpoint</p> <pre><code>POST /token HTTP/1.1\nHost: authz.example.net\nContent-Type: application/x-www-form-urlencoded\n\ngrant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer\n&amp;assertion=eyJhbGciOiJFUzI1NiIsImtpZCI6IjE2In0.\neyJpc3Mi[...omitted for brevity...].J9l-ZhwP[...omitted for brevity...]\n</code></pre> <p>Full sample request and response to Token Endpoint</p> <pre><code>POST /jans-auth/restv1/token HTTP/1.1\nHost: authz.example.net\nContent-Type: application/x-www-form-urlencoded\nAuthorization: Basic MmExY2UzZjMtOTM0ZS00ZGJkLThkNDEtNzdjOTU5N2IxOTM5OjNmYzI1ZGFjLTRjMjgtNDAzZS04MTA0LWY4ZGQwYmZkMDFlYg==\n\ngrant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer&amp;redirect_uri=https%3A%2F%2Fauthz.example.net%2Fjans-auth-rp%2Fhome.htm&amp;scope=openid+profile+address+email+phone+user_name&amp;assertion=eyJraWQiOiI4Mzk0ODg0ZS02ZGMwLTQxYWUtOWU3YS0yOWY1NDEzMGY2NTRfc2lnX3JzMjU2IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiIyYTFjZTNmMy05MzRlLTRkYmQtOGQ0MS03N2M5NTk3YjE5MzkiLCJhdWQiOiJodHRwczovL3l1cml5ei1sZWdpYmxlLWJ1bm55LmdsdXUuaW5mbyIsImlzcyI6IjJhMWNlM2YzLTkzNGUtNGRiZC04ZDQxLTc3Yzk1OTdiMTkzOSIsImV4cCI6MTc1NzU5MzEwMCwiaWF0IjoxNzU3NTkyODAwLCJqdGkiOiIyZmYxY2M1YS1mYWRjLTQ1MDgtOTkxMi1hZmE1Y2MyNjY1ODEifQ.t0bQW6olusFFcV3WVM08pTdqSH-tk_BuTSx6XROfSn72nboCAGcPxv0ow1FWYcwX05polAbFzcGLFRdSaZvunJ-OiQrHENlJxZUJNuou58bbg4mj08o9UnVMrXaEnIW19QQJC17G3b5R-y-_nKtC3P-hV1AJPxAChr0YQErAXZDoapmANKos6IbmoSQ03J2AmvzFvnpm8vFUKhpnyGyXbMPWViqojWfqMRaDgDDRyVQl1qzK4sBSTGj0CbTHN-xptNHgOBkl3fnBGYZMixw4kz50mjGHnP2r0MOfxrLvEwpuwy1FNxTSxxHjV_8d_h_HLLnqGyO4U7QaFVyC6j_2Bg\n\n\nHTTP/1.1 200\nCache-Control: no-store\nConnection: Keep-Alive\nContent-Length: 179\nContent-Type: application/json\nPragma: no-cache\n\n{\"access_token\":\"f7da6d49-08b4-4027-97c9-182a4ce6d6a5\",\"issued_token_type\":\"urn:ietf:params:oauth:token-type:access_token\",\"scope\":\"openid\",\"token_type\":\"Bearer\",\"expires_in\":300}\n</code></pre>","tags":["administration","auth-server","oauth","feature","grant","jwt-grant"]},{"location":"janssen-server/auth-server/oauth-features/mtls/","title":"mTLS (Mutual Transport Layer Security)","text":"","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#what-is-mtls","title":"What Is mTLS?","text":"<p>mTLS is a process that establishes an encrypted TLS connection in which both parties use X.509 digital certificates to authenticate each other. mTLS can help mitigate the risk of moving services to the cloud and can help prevent malicious third parties from imitating genuine apps.</p>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#where-is-mtls-useful","title":"Where Is mTLS Useful?","text":"<p>Mutual client certificate authentication can be used any time the server needs to ensure the authenticity and validity of either a specific user or a specific device. For example, a client certificate can be issued to a company-owned laptop to identify and authorize it on a corporate network. Alternatively, a client certificate could be issued to an employee and stored on a smart card, which then allows the employee to gain access to applications or restricted areas of a building.</p> <p>In practice, mTLS can identify and authorize the following:</p> <ul> <li>Devices onto a corporate network.</li> <li>Users into applications.</li> <li>Content delivery network (CDNs) or cloud security services to back-end web servers.</li> <li>Business-to-business (B2B) data exchanges that use APIs.</li> <li>Internet of Things (IoT) sensors, such as remote traffic cameras.</li> <li>Microservice architectures in which each microservice must ensure that each component it communicates with is valid   and not tampered with.</li> </ul> <p></p>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#mtls-in-jans-auth","title":"mTLS in Jans Auth","text":"<p>Jans Auth supports mTLS, and to configure it we must take these considerations into account:</p> <ul> <li>During DCR client registration, the <code>token_endpoint_auth_method</code> field can receive 2 new values:<ol> <li><code>tls_client_auth</code>: indicates that client authentication to the authorization server will occur with mutual TLS    utilizing the PKI method of associating a certificate to a client.</li> <li><code>self_signed_tls_client_auth</code>: Indicates that client authentication to the authorization server will occur using    mutual TLS with the client utilizing a self-signed certificate.</li> </ol> </li> <li>There is new client property <code>tls_client_auth_subject_dn</code> used to compare Subject DN of the certificate with   configured value of client entry when authentication method is set to <code>tls_client_auth</code> (saved in   tls_client_auth_subject_dn or oxAttributes on persistence layer).</li> <li>If MTLS Authentication is used then <code>access_token</code> automatically saves certificate <code>S256</code> hash of certificates which   can be validated by RP. If <code>access_token</code> is JWT then <code>x5t#S256</code> claim is added to payload of the token. Otherwise,   token can be introspected.</li> </ul> <pre><code>{\n  \"active\": true,\n  \"iss\": \"https://server.example.com\",\n  \"sub\": \"ty.webb@example.com\",\n  \"exp\": 1493726400,\n  \"nbf\": 1493722800,\n  \"cnf\": {\n    \"x5t#S256\": \"bwcK0esc3ACC3DB2Y5_lESsXE8o9ltc05O89jdN-dg2\"\n  },\n  ...,\n  ...\n}\n</code></pre>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#configuring-apache-for-mtls","title":"Configuring Apache for mTLS","text":"<p>The information below belongs to <code>apache</code> and web client (usually web browser) mutual authentication setup method. This also includes basic checks to be performed for the setup.</p> <p>Is <code>mod_ssl</code> installed: Run below command to confirm if the ssl module is installed.</p> <pre><code>apachectl -M | grep ssl\n</code></pre> <p>If we get <code>ssl_module</code> related output, then we're good to proceed. The output could look like:</p> <pre><code>root@jans:~# apachectl -M | grep ssl\nssl_module (shared)\n</code></pre> <p>Usually third party or Certbot SSL certs are used for web server ssl connections. In that case no extra configuration is necessary. But if we want to use self-signed certs, then follow on.</p>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#self-signed-ssl-certs","title":"Self-Signed SSL Certs","text":"","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#server-side-mtls-setup","title":"Server-Side mTLS setup","text":"<p>Now, we're covering the case if you want to deploy your own CA Cert.</p>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#1-open-terminal","title":"1. Open Terminal.","text":"","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#2-create-a-new-directory-to-generate-certificates","title":"2. Create a new directory to generate certificates.","text":"<pre><code>mkdir /etc/certs/mtlscert\n</code></pre> <p>Change to the directory created.</p> <pre><code>cd /etc/certs/mtlscert\n</code></pre>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#3-generate-self-signed-ca-cert","title":"3. Generate Self-Signed CA Cert.","text":"<p>Run below command:</p> <pre><code>openssl req -newkey rsa:2048 -nodes -keyform PEM -keyout example-ca.key -x509 -days 3650 -outform PEM -out example-ca.crt\n</code></pre> <p>Below is a sample run of the command.</p> <pre><code>root@jans:/etc/certs/mtlscert# openssl req -newkey rsa:2048 -nodes -keyform PEM -keyout example-ca.key -x509 -days 3650 -outform PEM -out example-ca.crt\nGenerating a RSA private key\n.........................................+++++\n.........................................+++++\nwriting new private key to 'example-ca.key'\n-----\nYou are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter '.', the field will be left blank.\n-----\nCountry Name (2 letter code) [AU]:US\nState or Province Name (full name) [Some-State]:Austin\nLocality Name (eg, city) []:TX\nOrganization Name (eg, company) [Internet Widgits Pty Ltd]:Janssen Org.\nOrganizational Unit Name (eg, section) []:IT\nCommon Name (e.g. server FQDN or YOUR name) []:yourdomain.com\nEmail Address []:youremail@yourdomain.com\n</code></pre> <p>Above command will create two files: <code>example-ca.key</code> and <code>example-ca.crt</code>.</p> <pre><code>root@jans:/etc/certs/mtlscert# ls\nexample-ca.crt  example-ca.key\n</code></pre>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#4-generate-private-key","title":"4. Generate private key.","text":"<p>Run below command:</p> <pre><code>openssl genrsa -out example.key 2048\n</code></pre> <p>Below is a sample run of the command.</p> <pre><code>root@jans:/etc/certs/mtlscert# openssl genrsa -out example.key 2048\nGenerating RSA private key, 2048 bit long modulus (2 primes)\n......................................+++++\n..........................................................................................................+++++\ne is 65537 (0x010001)\n</code></pre> <p>Above command creates: <code>example.key</code>.</p> <pre><code>root@jans:/etc/certs/mtlscert# ls\nexample-ca.crt  example-ca.key  example.key\n</code></pre>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#5-generate-a-server-csr-certificate-signing-request","title":"5. Generate a server CSR (Certificate Signing Request):","text":"<p>Run below command:</p> <pre><code>openssl req -new -key example.key -out example.csr\n</code></pre> <p>Below is a sample run of the command.</p> <pre><code>root@jans:/etc/certs/mtlscert# openssl req -new -key example.key -out example.csr\nYou are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter '.', the field will be left blank.\n-----\nCountry Name (2 letter code) [AU]:US\nState or Province Name (full name) [Some-State]:Austin\nLocality Name (eg, city) []:TX\nOrganization Name (eg, company) [Internet Widgits Pty Ltd]:Janssen Org.\nOrganizational Unit Name (eg, section) []:IT\nCommon Name (e.g. server FQDN or YOUR name) []:yourdomain.com\nEmail Address []:youremail@yourdomain.com\n\nPlease enter the following 'extra' attributes\nto be sent with your certificate request\nA challenge password []:\nAn optional company name []:\n</code></pre> <p>Above command will create the file: <code>example.csr</code>.</p> <pre><code>root@jans:/etc/certs/mtlscert# ls\nexample-ca.crt  example-ca.key  example.csr  example.key\n</code></pre>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#6-sign-the-csr-examplecsr-we-just-generated","title":"6. Sign the CSR <code>example.csr</code> we just generated.","text":"<p>Run below command:</p> <pre><code>openssl x509 -req -in example.csr -CA example-ca.crt -CAkey example-ca.key -set_serial 100 -days 365 -outform PEM -out example.crt\n</code></pre> <p>Below is a sample run of the command.</p> <pre><code>root@jans:/etc/certs/mtlscert# openssl x509 -req -in example.csr -CA example-ca.crt -CAkey example-ca.key -set_serial 100 -days 365 -outform PEM -out example.crt\nSignature ok\nsubject=C = US, ST = Austin, L = TX, O = Janssen Org., OU = IT, CN = yourdomain.com, emailAddress = youremail@yourdomain.com\nGetting CA Private Key\n</code></pre> <p>Above command will create the file: <code>example.crt</code> for 365 days.</p> <pre><code>root@jans:/etc/certs/mtlscert# ls\nexample-ca.crt  example-ca.key  example.crt  example.csr  example.key\n</code></pre>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#7-configure-apache2","title":"7. Configure Apache2.","text":"<p>Add the following lines in the <code>/etc/apache2/sites-available/https_jans.conf</code> file.</p> <pre><code>SSLEngine On\nSSLCertificateFile /etc/certs/mtlscert/example.crt\nSSLCertificateKeyFile /etc/certs/mtlscert/example.key\nSSLCACertificateFile /etc/certs/mtlscert/example-ca.crt\n</code></pre> <p>It is critical to configure certificates validation on Apache 2 correctly, since actual validation of the certificates is performed by Apache 2. After Apache certificate validation is configured correctly, make sure there is client certificate forward to <code>jans-auth</code> application. <code>jans-auth</code> (AS) expects certificate in <code>X-ClientCert</code> header.</p> <pre><code>&lt;LocationMatch /jans-auth&gt;\n    SSLVerifyClient require\n    SSLVerifyDepth 10\n    SSLOptions -StdEnvVars +ExportCertData\n\n    # Forward certificate to destination server (oxauth)\n    RequestHeader set X-ClientCert %{SSL_CLIENT_CERT}s\n&lt;/LocationMatch&gt;\n</code></pre> <p>Now we must restart the Apache2 server.</p> <pre><code>service apache2 restart\n</code></pre> <p>To check if SSL cert on apache works:</p> <pre><code>openssl s_client -connect yourdomain.com:443\n</code></pre>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#client-side-mtls-setup","title":"Client-Side mTLS setup","text":"","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#1-generate-private-key","title":"1. Generate private key.","text":"<p>Run below command:</p> <pre><code>openssl genrsa -out example-cli.key 2048\n</code></pre> <p>Below is a sample run of the command.</p> <pre><code>root@jans:/etc/certs/mtlscert# openssl genrsa -out example-cli.key 2048\nGenerating RSA private key, 2048 bit long modulus (2 primes)\n...........................................+++++\n.............................................+++++\ne is 65537 (0x010001)\n</code></pre> <p>Above command will create the file: <code>example-cli.key</code>.</p> <pre><code>root@jans:/etc/certs/mtlscert# ls\nexample-ca.crt  example-ca.key  example-cli.key  example.crt  example.csr  example.key\n</code></pre>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#2-generate-a-client-csr-certificate-signing-request","title":"2. Generate a client CSR (Certificate Signing Request).","text":"<p>Run below command:</p> <pre><code>openssl req -new -key example-cli.key -out example-cli.csr\n</code></pre> <p>Below is a sample run of the command.</p> <pre><code>root@jans:/etc/certs/mtlscert# openssl req -new -key example-cli.key -out example-cli.csr\nYou are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter '.', the field will be left blank.\n-----\nCountry Name (2 letter code) [AU]:US\nState or Province Name (full name) [Some-State]:Austin\nLocality Name (eg, city) []:TX\nOrganization Name (eg, company) [Internet Widgits Pty Ltd]:Janssen Client Org.\nOrganizational Unit Name (eg, section) []:IT\nCommon Name (e.g. server FQDN or YOUR name) []:yourdomain.com\nEmail Address []:youremail@yourdomain.com\n\nPlease enter the following 'extra' attributes\nto be sent with your certificate request\nA challenge password []:\nAn optional company name []:\n</code></pre> <p>Above command will create the file: <code>example-cli.csr</code>.</p> <pre><code>root@jans:/etc/certs/mtlscert# ls\nexample-ca.crt  example-ca.key  example-cli.csr  example-cli.key  example.crt  example.csr  example.key\n</code></pre>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#3-sign-the-csr-example-clicsr-we-just-generated","title":"3. Sign the CSR <code>example-cli.csr</code> we just generated.","text":"<p>Run below command:</p> <pre><code>openssl x509 -req -in example-cli.csr -CA example-ca.crt -CAkey example-ca.key -set_serial 101 -days 365 -outform PEM -out example-cli.crt\n</code></pre> <p>Below is a sample run of the command.</p> <pre><code>root@jans:/etc/certs/mtlscert# openssl x509 -req -in example-cli.csr -CA example-ca.crt -CAkey example-ca.key -set_serial 101 -days 365 -outform PEM -out example-cli.crt\nSignature ok\nsubject=C = US, ST = Austin, L = TX, O = Janssen Client Org., OU = IT, CN = yourdomain.com, emailAddress = youremail@yourdomain.com\nGetting CA Private Key\n</code></pre> <p>Above command will create the file: <code>example-cli.crt</code> for 365 days.</p> <pre><code>root@jans:/etc/certs/mtlscert# ls\nexample-ca.crt  example-ca.key  example-cli.crt  example-cli.csr  example-cli.key  example.crt  example.csr  example.key\n</code></pre>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#4-generate-pkcs12-cert","title":"4. Generate PKCS12 cert","text":"<p>Some browsers need client certs to be in the format <code>pkcs12</code>.</p> <p>Run below command:</p> <pre><code>openssl pkcs12 -export -inkey example-cli.key -in example-cli.crt -out example-cli.p12\n</code></pre> <p>Below is a sample run of the command.</p> <pre><code>root@jans:/etc/certs/mtlscert# openssl pkcs12 -export -inkey example-cli.key -in example-cli.crt -out example-cli.p12\nEnter Export Password:\nVerifying - Enter Export Password:\n</code></pre> <p>Above command will create the file: <code>example-cli.p12</code>.</p> <pre><code>root@jans:/etc/certs/mtlscert# ls\nexample-ca.crt  example-ca.key  example-cli.crt  example-cli.csr  example-cli.key  example-cli.p12  example.crt  example.csr  example.key\n</code></pre>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#mtls-testing","title":"mTLS testing","text":"<p>We are going to run an mTLS example where we will perform the following flow:</p> <ol> <li>Register new client.</li> <li>Call <code>authorize</code> endpoint.</li> <li>Call <code>token</code> endpoint.</li> <li>Call <code>introspection</code> endpoint.</li> </ol> <p>Previously we need to configure the client's certificate in the browser of your choice.</p>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#google-chrome-settings","title":"Google Chrome Settings","text":"<ul> <li>In the search bar go to <code>chrome://settings/certificates</code>.</li> <li>In the <code>Your Certificates</code> section, click on <code>Import</code> button.</li> <li>Select the certificate <code>example-cli.p12</code> and enter the password you set when generating it.</li> </ul>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#firefox-settings","title":"Firefox Settings","text":"<ul> <li>In the search bar go to <code>about:preferences#privacy</code>.</li> <li>Click on <code>View Certificates</code>.</li> <li>In the <code>Your Certificates</code> section, click on <code>Import</code> button.</li> <li>Select the certificate <code>example-cli.p12</code> and enter the password you set when generating it.</li> </ul>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#solving-the-curl-problem","title":"Solving the <code>curl</code> problem","text":"<p>If you have <code>openssl</code> version <code>3.x.x</code>, most likely when you are trying to consume the <code>/.well-known/openid-configuration</code> endpoint.</p> <pre><code>curl --insecure --cert-type P12 --cert example-cli.p12:&lt;YOUR_PASSWORD&gt; --location 'https://&lt;YOUR_DOMAIN&gt;/.well-known/openid-configuration'\n</code></pre> <p>You will get the following error:</p> <pre><code>root@jans~# curl --insecure --cert-type P12 --cert example-cli.p12:&lt;YOUR_PASSWORD&gt; --location 'https://&lt;YOUR_DOMAIN&gt;/.well-known/openid-configuration'\ncurl: (58) could not parse PKCS12 file, check password, OpenSSL error error:0308010C:digital envelope routines::unsupported\n</code></pre> <p>To fix this error, edit the file <code>/etc/ssl/openssl.cnf</code> and make sure that these lines are uncommented and if they are not, add them:</p> <pre><code>openssl_conf = openssl_init\n\n[openssl_init]\nproviders = provider_sect\n\n[provider_sect]\ndefault = default_sect\nlegacy = legacy_sect\n\n[default_sect]\nactivate = 1\n\n[legacy_sect]\nactivate = 1\n</code></pre> <p>Once this change is done, you should be able to consume the <code>/.well-known/openid-configuration</code> endpoint without any problems</p> <pre><code>root@jans~# curl --insecure --cert-type P12 --cert example-cli.p12:&lt;YOUR_PASSWORD&gt; --location 'https://&lt;YOUR_DOMAIN&gt;/.well-known/openid-configuration'\n{\n  \"request_parameter_supported\" : true,\n  \"pushed_authorization_request_endpoint\" : \"https://&lt;YOUR_DOMAIN&gt;/jans-auth/restv1/par\",\n  \"introspection_endpoint\" : \"https://&lt;YOUR_DOMAIN&gt;/jans-auth/restv1/introspection\",\n  \"claims_parameter_supported\" : true,\n  \"issuer\" : \"https://&lt;YOUR_DOMAIN&gt;\",\n  \"userinfo_encryption_enc_values_supported\" : [ \"A128CBC+HS256\", \"A256CBC+HS512\", \"A128GCM\", \"A256GCM\" ],\n  \"id_token_encryption_enc_values_supported\" : [ \"A128CBC+HS256\", \"A256CBC+HS512\", \"A128GCM\", \"A256GCM\" ],\n  \"access_token_signing_alg_values_supported\" : [ \"none\", \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"authorization_endpoint\" : \"https://&lt;YOUR_DOMAIN&gt;/jans-auth/restv1/authorize\",\n  ...,\n  ...,\n  ...\n}\n</code></pre>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#1-register-new-client","title":"1. Register new client","text":"<p>Run below command:</p> <pre><code>curl --insecure --cert-type P12 --cert example-cli.p12:&lt;YOUR_PASSWORD&gt; --location 'https://&lt;YOUR_DOMAIN&gt;/jans-auth/restv1/register' \\\n--header 'Content-Type: application/json' \\\n--data '{\n  \"client_name\": \"Test Client mTLS\",\n  \"application_type\": \"web\",\n  \"access_token_as_jwt\": true,\n  \"token_endpoint_auth_method\": \"self_signed_tls_client_auth\",\n  \"jwks\": {\n    \"keys\": [\n      {\n        \"kid\": \"YOUR_KID\",\n        \"kty\": \"RSA\",\n        \"alg\": \"RS256\",\n        \"use\": \"sig\",\n        \"e\": \"AQAB\",\n        \"n\": \"5elNNA2wYlUpEK2JxOqIgFe3JmHBs63M7wvKM_cbzXjMpLXn7UqAbIN7drDgLIvsIwSo9DAuWvFV3mLqApFYlL1qQCEveULbh6LorqPUzl2UjHwDDFlM1Hj6JpJ_GbacX5-YnRgXC7k_p4ZIf0GOkQxIo0WVNhulku3z84Ko8Efk5BeV7ImFyXWLoO-ru8h3Yvq2h1LRVYX02LZlG6Mv8dqCJsWHIbnmaB16TSe_HCA3qEA4k9La2fl4R7fPlq1u89LN3kz2M0cm1M8aTTquLHP0tv5EpeqX1pG4VjwurssevguRM9QqrGkPktAw_uzIKfO7s5_j3AD3teYdVQFryQ\"\n      }\n    ]\n  },\n  \"scope\": [\n    \"openid\",\n    \"profile\",\n    \"email\"\n  ],\n  \"grant_types\": [\n    \"authorization_code\"\n  ],\n  \"response_types\": [\n    \"code\",\n    \"token\",\n    \"id_token\"\n  ],\n  \"redirect_uris\": [\n    https://&lt;YOUR_DOMAIN&gt;/jans-auth-rp/home.htm\n  ]\n}'\n</code></pre> <p>Response:</p> <pre><code>{\n  \"allow_spontaneous_scopes\": false,\n  \"jwks\": {\n    \"keys\": [\n      {\n        \"kty\": \"RSA\",\n        \"e\": \"AQAB\",\n        \"use\": \"sig\",\n        \"kid\": \"your-kid\",\n        \"alg\": \"RS256\",\n        \"n\": \"5elNNA2wYlUpEK2JxOqIgFe3JmHBs63M7wvKM_cbzXjMpLXn7UqAbIN7drDgLIvsIwSo9DAuWvFV3mLqApFYlL1qQCEveULbh6LorqPUzl2UjHwDDFlM1Hj6JpJ_GbacX5-YnRgXC7k_p4ZIf0GOkQxIo0WVNhulku3z84Ko8Efk5BeV7ImFyXWLoO-ru8h3Yvq2h1LRVYX02LZlG6Mv8dqCJsWHIbnmaB16TSe_HCA3qEA4k9La2fl4R7fPlq1u89LN3kz2M0cm1M8aTTquLHP0tv5EpeqX1pG4VjwurssevguRM9QqrGkPktAw_uzIKfO7s5_j3AD3teYdVQFryQ\"\n      }\n    ]\n  },\n  \"application_type\": \"web\",\n  \"rpt_as_jwt\": false,\n  \"registration_client_uri\": \"https://&lt;YOUR_DOMAIN&gt;/jans-auth/restv1/register?client_id=d16994c2-313c-4440-9713-25290fbb89a9\",\n  \"tls_client_auth_subject_dn\": \"\",\n  \"run_introspection_script_before_jwt_creation\": false,\n  \"registration_access_token\": \"93a52334-bf79-4414-bc9a-983b6921597c\",\n  \"client_id\": \"d16994c2-313c-4440-9713-25290fbb89a9\",\n  \"token_endpoint_auth_method\": \"self_signed_tls_client_auth\",\n  \"scope\": \"email openid profile\",\n  \"client_secret\": \"e1c9e9df-e542-4225-adb4-d0590f85d97d\",\n  \"client_id_issued_at\": 1698114939,\n  \"backchannel_logout_uri\": \"\",\n  \"backchannel_logout_session_required\": false,\n  \"client_name\": \"Test Client mTLS\",\n  \"par_lifetime\": 600,\n  \"spontaneous_scopes\": [],\n  \"id_token_signed_response_alg\": \"RS256\",\n  \"access_token_as_jwt\": true,\n  \"grant_types\": [\n    \"implicit\",\n    \"refresh_token\",\n    \"authorization_code\"\n  ],\n  \"subject_type\": \"pairwise\",\n  \"additional_token_endpoint_auth_methods\": [],\n  \"keep_client_authorization_after_expiration\": false,\n  \"require_par\": false,\n  \"redirect_uris\": [\n    \"https://&lt;YOUR_DOMAIN&gt;/jans-auth-rp/home.htm\"\n  ],\n  \"redirect_uris_regex\": \"\",\n  \"additional_audience\": [],\n  \"frontchannel_logout_session_required\": false,\n  \"client_secret_expires_at\": 1698201339,\n  \"access_token_signing_alg\": \"RS256\",\n  \"response_types\": [\n    \"code\",\n    \"id_token\",\n    \"token\"\n  ]\n}\n</code></pre> <p>NOTE: To obtain the <code>jwks</code> field data, follow the next step.</p>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#p12-to-jwks","title":"P12 to JWKS","text":"<p>To get the fields from <code>jwks</code> you can use the following command:</p> <pre><code>openssl x509 -in example-cli.p12 -pubkey -noout | pem-jwk | jq '{kid: \"your-kid\", kty: .kty , alg: \"RS256\" , use: \"sig\", e: .e, n: .n }'\n</code></pre> <p>Make sure you have <code>pem-jwk</code> installed, use the command: <code>npm install -g pem-jwk</code> or <code>yarn global add pem-jwk</code>.</p> <p>Below is a sample run of the command.</p> <pre><code>root@jans:~# openssl x509 -in example-cli.p12 -pubkey -noout | pem-jwk | jq '{kid: \"your-kid\", kty: .kty , alg: \"RS256\" , use: \"sig\", e: .e, n: .n }'\nEnter pass phrase for PKCS12 import pass phrase:\n{\n  \"kid\": \"your-kid\",\n  \"kty\": \"RSA\",\n  \"alg\": \"RS256\",\n  \"use\": \"sig\",\n  \"e\": \"AQAB\",\n  \"n\": \"5elNNA2wYlUpEK2JxOqIgFe3JmHBs63M7wvKM_cbzXjMpLXn7UqAbIN7drDgLIvsIwSo9DAuWvFV3mLqApFYlL1qQCEveULbh6LorqPUzl2UjHwDDFlM1Hj6JpJ_GbacX5-YnRgXC7k_p4ZIf0GOkQxIo0WVNhulku3z84Ko8Efk5BeV7ImFyXWLoO-ru8h3Yvq2h1LRVYX02LZlG6Mv8dqCJsWHIbnmaB16TSe_HCA3qEA4k9La2fl4R7fPlq1u89LN3kz2M0cm1M8aTTquLHP0tv5EpeqX1pG4VjwurssevguRM9QqrGkPktAw_uzIKfO7s5_j3AD3teYdVQFryQ\"\n}\n</code></pre>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#2-call-authorize-endpoint","title":"2. Call <code>authorize</code> endpoint","text":"<p>From your browser of choice call the following url:</p> <pre><code>https://&lt;YOUR_DOMAIN&gt;/jans-auth/restv1/authorize?response_type=code&amp;client_id=d16994c2-313c-4440-9713-25290fbb89a9&amp;scope=openid+profil+email&amp;redirect_uri=https://&lt;YOUR_DOMAIN&gt;/jans-auth-rp/home.htm&amp;state=f9bb35cb-3485-4ae4-aa8e-63e9a97b6e5d&amp;nonce=4a2f07cb-521b-465c-8b06-0c17711a96a7\n</code></pre> <p>URL parameters:</p> <ul> <li><code>response_type=code</code></li> <li><code>client_id=d16994c2-313c-4440-9713-25290fbb89a9</code></li> <li><code>scope=openid+profil+email</code></li> <li><code>redirect_uri=https://&lt;YOUR_DOMAIN&gt;/jans-auth-rp/home.htm</code></li> <li><code>state=f9bb35cb-3485-4ae4-aa8e-63e9a97b6e5d</code></li> <li><code>nonce=4a2f07cb-521b-465c-8b06-0c17711a96a7</code></li> </ul> <p>The field we need to obtain is the <code>code</code>.</p> <p></p>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#3-call-token-endpoint","title":"3. Call <code>token</code> endpoint","text":"<p>Previously we have obtained the <code>code</code> field, we will use this value to call the endpoint <code>token</code>.</p> <pre><code>curl --insecure --cert-type P12 --cert example-cli.p12:&lt;YOUR_PASSWORD&gt; --location 'https://&lt;YOUR_DOMAIN&gt;/jans-auth/restv1/token' \\\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode 'grant_type=authorization_code' \\\n--data-urlencode 'redirect_uri=https://&lt;YOUR_DOMAIN&gt;/jans-auth-rp/home.htm' \\\n--data-urlencode 'client_id=d16994c2-313c-4440-9713-25290fbb89a9' \\\n--data-urlencode 'client_secret=&lt;YOUR_CLIENT_SECRET&gt;' \\\n--data-urlencode 'code=&lt;YOUR_CODE&gt;'\n</code></pre> <p>Response:</p> <pre><code>{\n  \"access_token\": \"eyJraWQiOiJjb25uZWN0X2NmNjBiZWZmLTU1MzUtNDllNS04MWQ5LTM5ZDM4ZmNlMWNhMF9zaWdfcnMyNTYiLCJ0eXAiOiJqd3QiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJNSGdqa2hnTktmZWF4ZUVEY0wycEt5c1EwVUQ4RDk1QUd5NFBGXzI2cmlnIiwiY29kZSI6ImE0NWE5ODI5LTFkMDQtNGQxNS05NjllLWRiMjk3Mzk4ZTdjMyIsImlzcyI6Imh0dHBzOi8vbWlsdG9uLWNoLWhhcmR5LW1pdGUuZ2x1dS5pbmZvIiwidG9rZW5fdHlwZSI6IkJlYXJlciIsImNsaWVudF9pZCI6IjVkODM1NDA3LTFlZjMtNDQxZC04YWU2LTZiYmRkNTcyNzZjYyIsImF1ZCI6IjVkODM1NDA3LTFlZjMtNDQxZC04YWU2LTZiYmRkNTcyNzZjYyIsImFjciI6ImJhc2ljIiwieDV0I1MyNTYiOiJPeHRJQXRBMEMwTkwteTR2UmZLeDd6TExFZXhfWG1DelduUWJ4ejZUem5ZIiwic2NvcGUiOlsib3BlbmlkIiwicHJvZmlsZSIsImVtYWlsIl0sImF1dGhfdGltZSI6MTY5ODE5NDczNiwiZXhwIjoxNjk4Mjc4MDQzLCJpYXQiOjE2OTgxOTY4MzIsInVzZXJuYW1lIjoiRGVmYXVsdCBBZG1pbiBVc2VyIn0.JpK7JYy6Avui3LNbxTKBYJW9fqjEIqijCXPw9fvqEO1kqO7AUozOEof00hPKzJo1Dh7VgGpY89MiAduDUoU3QCemtFsNSd1DCyExl2s3w5OF2mUm6nMzjaS377ZQQ39DAq91OGFFq_ISt4JIhWRf7_xUEvlLRAttTqxE5qp1ZYvgAYu07jbVJX8WqJvxYz3rZ3J-4kq2FLREunRf5KxYaHO-oKzrmhRVPTc_cj1vqwSfu8vRjLmx4P-eN7SgVNa0XmZ8WClLnmchucGBH6rYq3bXZWsOKixwLhno_2vPe1MmbK3XnNNBu_fm_bL2N5kgAwr9b-upoBJc08IyCje1vA\",\n  \"refresh_token\": \"1e58e2c9-4175-4b3f-8170-65544b1a7c48\",\n  \"id_token\": \"eyJraWQiOiJjb25uZWN0X2NmNjBiZWZmLTU1MzUtNDllNS04MWQ5LTM5ZDM4ZmNlMWNhMF9zaWdfcnMyNTYiLCJ0eXAiOiJqd3QiLCJhbGciOiJSUzI1NiJ9.eyJhdF9oYXNoIjoib1NoVDE4YUdRVHdtNXBjT255dkNMUSIsInN1YiI6Ik1IZ2praGdOS2ZlYXhlRURjTDJwS3lzUTBVRDhEOTVBR3k0UEZfMjZyaWciLCJhbXIiOlsiMTAiXSwiaXNzIjoiaHR0cHM6Ly9taWx0b24tY2gtaGFyZHktbWl0ZS5nbHV1LmluZm8iLCJub25jZSI6ImMxNGQ2Y2RlLWQ5NTYtNDM4Zi04Mzk5LTQ3MzdkNWZlOTkyOSIsInNpZCI6IjI2ZTM4YTJmLTEzZTktNGY4Yi05MzdjLTQ3M2ViMjdlNzFkNiIsImphbnNPcGVuSURDb25uZWN0VmVyc2lvbiI6Im9wZW5pZGNvbm5lY3QtMS4wIiwiYXVkIjoiNWQ4MzU0MDctMWVmMy00NDFkLThhZTYtNmJiZGQ1NzI3NmNjIiwicmFuZG9tIjoiMjVhZDViMmUtMGNkMi00Mjg3LTg1M2ItZWY3NWRhZjMzNWMwIiwiYWNyIjoiYmFzaWMiLCJjX2hhc2giOiJwM2ZJVHlGT09fd0tRZW9QT1VkWWF3IiwiYXV0aF90aW1lIjoxNjk4MTk0NzM2LCJleHAiOjE2OTgyMDA0MzIsImdyYW50IjoiYXV0aG9yaXphdGlvbl9jb2RlIiwiaWF0IjoxNjk4MTk2ODMyfQ.GMXkiFGcCy6dXI8gPPuCLd977Gs_rkG1w3FrNx_HlSnmcDUSsEQHvPxpA99Y3L8Z82uLHYCbP5Vga6iCEOmBBHnu9jEsmYgp-TSrB31HV-5g7-o4ZWJG05SdL9KgSP3PyDXRqcE0VFxBJ-uJSyvI-htQ4GUXMIhqVhbJJynPNosXtZvvDVIw1NBThupmqx58cozf5tIdnwaeiuN_Ce2XQrjZBiachI6KWFa-Mstrsdw1E6Ny_4bP-1UmeNgScd6pmIUemGsfclxIAgO0lACqgbGh7wo0PljbhEkGU_i9kP--0KJHkBkUxflULW3aAqdYtG9hEr_JEIddHVxXbi1c_w\",\n  \"token_type\": \"Bearer\",\n  \"expires_in\": 81210\n}\n</code></pre> <p>Once we have obtained the <code>access_token</code> in <code>jwt(json web token)</code> format, we will do the last step.</p>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#4-call-introspection-endpoint","title":"4. Call <code>introspection</code> endpoint","text":"<p>Run below command:</p> <pre><code>curl --insecure --cert-type P12 --cert example-cli.p12:&lt;YOUR_PASSWORD&gt; --location 'https://&lt;YOUR_DOMAIN&gt;/jans-auth/restv1/introspection' \\\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--header 'Authorization: Bearer &lt;ACCESS_TOKEN&gt;' \\\n--data-urlencode 'token=&lt;ACCESS_TOKEN&gt;' \\\n--data-urlencode 'response_as_jwt=false'\n</code></pre> <p>Response:</p> <pre><code>{\n  \"sub\": \"MHgjkhgNKfeaxeEDcL2pKysQ0UD8D95AGy4PF_26rig\",\n  \"iss\": \"https://&lt;YOUR_DOMAIN&gt;\",\n  \"active\": true,\n  \"token_type\": \"Bearer\",\n  \"client_id\": \"d16994c2-313c-4440-9713-25290fbb89a9\",\n  \"aud\": \"5d835407-1ef3-441d-8ae6-6bbdd57276cc\",\n  \"acr\": \"basic\",\n  \"nbf\": null,\n  \"scope\": \"openid profile email\",\n  \"auth_time\": 1698194736,\n  \"cnf\": {\n    \"x5t#S256\": \"OxtIAtA0C0NL-y4vRfKx7zLLEex_XmCzWnQbxz6TznY\"\n  },\n  \"exp\": 1698278043,\n  \"iat\": 1698201265,\n  \"jti\": null,\n  \"username\": \"admin\"\n}\n</code></pre>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/mtls/#specification-document","title":"Specification document","text":"<p>For more details of the specification, you can have a look at the following link OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens</p>","tags":["administration","auth-server","oauth","feature","mtls","mutual TLS"]},{"location":"janssen-server/auth-server/oauth-features/par/","title":"Pushed Authorization Request (PAR)","text":"<p>Pushed Authorization Request (PAR) allows to push the payload of an OAuth 2.0 authorization request to the authorization server via a direct request and provides back with a request URI that is used as reference to the data in a subsequent call to the authorization endpoint.</p> <p>For more information and implementation details please check PAR Endpoint documentation</p> <p>PAR specification</p>","tags":["administration","auth-server","oauth","feature","par"]},{"location":"janssen-server/auth-server/oauth-features/par/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>You can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","oauth","feature","par"]},{"location":"janssen-server/auth-server/oauth-features/par/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","oauth","feature","par"]},{"location":"janssen-server/auth-server/oauth-features/password-grant/","title":"Password Grant","text":"<p>Janssen Server supports the password grant. At the same time, inline with OAuth 2.0 security best practices, this password grant should never be used in practice. OAuth 2.1 has removed this grant type.</p>","tags":["administration","auth-server","oauth","feature","grant","password"]},{"location":"janssen-server/auth-server/oauth-features/password-grant/#configuration","title":"Configuration","text":"<p>A client can use the password grant if it is enabled in the configuration. An administrator can use TUI to enable password grant for a client.</p> <p></p>","tags":["administration","auth-server","oauth","feature","grant","password"]},{"location":"janssen-server/auth-server/oauth-features/password-grant/#usage","title":"Usage","text":"<p>Using the password grant involves sharing user credentials with a third-party application. This third-party app which has registered with Janssen Server as a client, will then use user-id/password credentials from the user to obtain an access token from Janssen Server.</p> <p>Janssen Server also requires the client to authenticate itself based on the client configuration.</p> <p>Since sharing user credentials with a third-party app is a security risk and against the basic purpose of OAuth, this grant type shall not be used.</p>","tags":["administration","auth-server","oauth","feature","grant","password"]},{"location":"janssen-server/auth-server/oauth-features/password-grant/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","oauth","feature","grant","password"]},{"location":"janssen-server/auth-server/oauth-features/pkce/","title":"PKCE (Proof Key for Code Exchange)","text":"<p>PKCE(Proof Key for Code Exchange) is an extension to the Authorization on Code flow to prevent <code>CSRF</code> and authorization code injection attacks. Authorization code flow with PKCE is defined in this specification.</p> <p>Public clients (Single Page Apps (SPA) or Mobile Apps), have a serious problem obtaining access tokens. In the case of <code>SPA</code> you cannot securely store a secret key, because its source is available in the browser. The same will happen with Mobile Apps, since decompiling the application will reveal the secret keys.</p> <p>This is where <code>PKCE</code> comes in to solve the problem.</p> <p>The authorization code flow with PKCE is considered as best practice when using Single Page Apps (SPA) or Mobile Apps.</p> <p>Let's see in the following diagram how it works:</p> <p></p> <p>Source</p>","tags":["administration","auth-server","oauth","feature","pkce"]},{"location":"janssen-server/auth-server/oauth-features/pkce/#pkce-configuration","title":"PKCE Configuration","text":"<p>For this flow to work, we must make the following configuration in Janssen Server.</p> <p>We need to set the <code>clientAuthenticationFiltersEnabled</code> property to <code>false</code>, it defaults to <code>true</code>. We can use TUI to change this configuration as shown below:</p> <p></p> <p>AS requires PKCE if <code>requirePkce</code> global AS configuration property is set to <code>true</code> or otherwise if client involved in request has <code>requirePkce</code> set to <code>true</code> in client attributes (inside <code>jansAttrs</code> json).</p>","tags":["administration","auth-server","oauth","feature","pkce"]},{"location":"janssen-server/auth-server/oauth-features/pkce/#authorization-code-flow-pkce","title":"Authorization Code Flow + PKCE","text":"<p>In this flow, we will execute the following steps:</p> <ol> <li>Generate Code Verifier and Code Challenge</li> <li>Register new client</li> <li>Call <code>authorize</code> endpoint</li> <li>Call <code>token</code> endpoint</li> </ol>","tags":["administration","auth-server","oauth","feature","pkce"]},{"location":"janssen-server/auth-server/oauth-features/pkce/#1-generate-code-verifier-and-code-challenge","title":"1. Generate Code Verifier and Code Challenge","text":"<p>It is necessary to generate these codes for this flow, since this data will be sent in the <code>authorize</code> and <code>token</code> endpoints.</p>","tags":["administration","auth-server","oauth","feature","pkce"]},{"location":"janssen-server/auth-server/oauth-features/pkce/#code-verifier","title":"Code Verifier","text":"<p>It is a random string of length <code>N</code>, and is denoted by the field <code>code_verifier</code>.</p> <p>The following command generates a <code>code_verifier</code> of length <code>128</code>.</p> <pre><code>tr -dc 'A-Za-z0-9-._' &lt;/dev/urandom | head -c 128; echo\n</code></pre> <p>Output example:</p> <pre><code>root@jans:~# tr -dc 'A-Za-z0-9-._' &lt;/dev/urandom | head -c 128; echo\nMW54l5Ma7i8n6QsetI_dnJhfMQ6gIfBNJiWFINu6rtD0zvZUXG3STWoolT5HFatjWu2Vj1L-Au4PtRzkear088FJLzq.6tAg10wikJrIqn75HCJ7V1b_p8io_ugkPkkr\n</code></pre>","tags":["administration","auth-server","oauth","feature","pkce"]},{"location":"janssen-server/auth-server/oauth-features/pkce/#code-challenge","title":"Code Challenge","text":"<p>To generate the <code>code_challenge</code> we need to know what type of method we will be using, so this field is accompanied by the <code>code_challenge_method</code> field.</p> <p>Janssen Server supports two methods of <code>code_challenge_method</code>:</p> <ul> <li><code>plain</code>: When using this method, the <code>code_challenge</code> is the same as the <code>code_verifier</code>.</li> <li><code>s256</code>: When using this method, <code>code_challenge</code> must be encoded using the <code>code_verifier</code> with sha256 and *   base64Url*.</li> </ul> <p>The following command generates the <code>code_challenge</code> using <code>s256</code>.</p> <p>Note</p> <p>To execute command the command below, you need to have <code>openssl</code>, <code>basenc</code></p> <p>and <code>tr</code> installed.</p> <pre><code>echo -n \"MW54l5Ma7i8n6QsetI_dnJhfMQ6gIfBNJiWFINu6rtD0zvZUXG3STWoolT5HFatjWu2Vj1L-Au4PtRzkear088FJLzq.6tAg10wikJrIqn75HCJ7V1b_p8io_ugkPkkr\" | openssl dgst -binary -sha256 | basenc --base64url | tr -d '='\n</code></pre> <p>Output example:</p> <pre><code>root@jans:~# echo -n \"MW54l5Ma7i8n6QsetI_dnJhfMQ6gIfBNJiWFINu6rtD0zvZUXG3STWoolT5HFatjWu2Vj1L-Au4PtRzkear088FJLzq.6tAg10wikJrIqn75HCJ7V1b_p8io_ugkPkkr\" | openssl dgst -binary -sha256 | basenc --base64url | tr -d '='\nzyI60XbvMetJJuAzyRR_jnxoJkyfxXSqY-mTG4FtBtg\n</code></pre>","tags":["administration","auth-server","oauth","feature","pkce"]},{"location":"janssen-server/auth-server/oauth-features/pkce/#2-register-new-client","title":"2. Register new client","text":"Request<pre><code>POST &lt;YOUR_DOMAIN&gt;/jans-auth/restv1/register HTTP/1.1\nContent-Type: application/json\n\n{\n  \"client_name\": \"PKCE Test Client\",\n  \"application_type\": \"web\",\n  \"token_endpoint_auth_method\": \"none\",\n  \"scope\": [\n    \"openid\",\n    \"profile\",\n    \"email\"\n  ],\n  \"grant_types\": [\n    \"authorization_code\"\n  ],\n  \"response_types\": [\n    \"code\",\n    \"token\",\n    \"id_token\"\n  ],\n  \"redirect_uris\": [\n    \"https://&lt;YOUR_DOMAIN&gt;/jans-auth-rp/home.htm\"\n  ]\n}\n</code></pre> <p>Note</p> <p>Notee that the <code>token_endpoint_auth_method</code> field is <code>none</code>.</p> Response<pre><code>HTTP/1.1 201 Created\nDate: Fri, 17 Nov 2023 22:51:13 GMT\nServer: Apache/2.4.41 (Ubuntu)\nX-Xss-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\nCache-Control: no-store\nContent-Type: application/json\nPragma: no-cache\nContent-Length: 1541\nSet-Cookie: X-Correlation-Id=d92eddf5-ab08-4b4f-a8f1-10af67e83dbd; Secure; HttpOnly;HttpOnly\nConnection: close\n\n{\n  \"allow_spontaneous_scopes\": false,\n  \"application_type\": \"web\",\n  \"rpt_as_jwt\": false,\n  \"registration_client_uri\": \"https://&lt;YOUR_DOMAIN&gt;/jans-auth/restv1/register?client_id=057c3abf-a1a7-49cc-9e4e-8737e898ac72\",\n  \"tls_client_auth_subject_dn\": \"\",\n  \"run_introspection_script_before_jwt_creation\": false,\n  \"registration_access_token\": \"659ccbf9-ac98-437a-b952-33bfc0366fc2\",\n  \"client_id\": \"f48fbdfa-4c07-49e5-938b-10463980e145\",\n  \"token_endpoint_auth_method\": \"none\",\n  \"scope\": \"email openid profile\",\n  \"client_secret\": \"a656a654-c930-4b52-9edb-68ead50d046e\",\n  \"client_id_issued_at\": 1700261473,\n  \"backchannel_logout_uri\": \"\",\n  \"backchannel_logout_session_required\": false,\n  \"client_name\": \"PKCE Test Client\",\n  \"par_lifetime\": 600,\n  \"spontaneous_scopes\": [],\n  \"id_token_signed_response_alg\": \"RS256\",\n  \"access_token_as_jwt\": false,\n  \"grant_types\": [\n    \"implicit\",\n    \"refresh_token\",\n    \"authorization_code\"\n  ],\n  \"subject_type\": \"pairwise\",\n  \"additional_token_endpoint_auth_methods\": [],\n  \"keep_client_authorization_after_expiration\": false,\n  \"require_par\": false,\n  \"redirect_uris\": [\n    \"https://&lt;YOUR_DOMAIN&gt;/jans-auth-rp/home.htm\"\n  ],\n  \"redirect_uris_regex\": \"\",\n  \"additional_audience\": [],\n  \"frontchannel_logout_session_required\": false,\n  \"client_secret_expires_at\": 1700347873,\n  \"access_token_signing_alg\": \"RS256\",\n  \"response_types\": [\n    \"code\",\n    \"token\",\n    \"id_token\"\n  ]\n}\n</code></pre>","tags":["administration","auth-server","oauth","feature","pkce"]},{"location":"janssen-server/auth-server/oauth-features/pkce/#3-call-authorize-endpoint","title":"3. Call <code>authorize</code> endpoint","text":"<p>From your browser of choice call the following url:</p> Request<pre><code>https://&lt;YOUR_DOMAIN&gt;/jans-auth/restv1/authorize?\nresponse_type=code&amp;\nclient_id=f48fbdfa-4c07-49e5-938b-10463980e145&amp;\nscope=openid+profile+email&amp;\nredirect_uri=https://&lt;YOUR_DOMAIN&gt;/jans-auth-rp/home.htm&amp;\nstate=bf1af4a1-8713-49c6-b229-537bf4cf712d&amp;\nnonce=f2265e46-6d93-4d36-850b-8fd990cccd04&amp;\ncode_challenge=&lt;YOUR_CODE_CHALLENGE&gt;&amp;\ncode_challenge_method=&lt;YOUR_CODE_CHALLENGE_METHOD&gt;\n</code></pre> <p>Note</p> <p>Remember that this endpoint is where you must send the <code>code_challenge</code> and <code>code_challenge_method</code></p> <p>parameters.</p> <p>The field we need to obtain is the <code>code</code>.</p> <p></p>","tags":["administration","auth-server","oauth","feature","pkce"]},{"location":"janssen-server/auth-server/oauth-features/pkce/#4-call-token-endpoint","title":"4. Call <code>token</code> endpoint","text":"<p>Previously we have obtained the <code>code</code> field, we will use this value to call the endpoint <code>token</code>.</p> Request<pre><code>POST &lt;YOUR_DOMAIN&gt;/jans-auth/restv1/token HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\n\ngrant_type=authorization_code&amp;\nredirect_uri=https://&lt;YOUR_DOMAIN&gt;/jans-auth-rp/home.htm&amp;\nclient_id=f48fbdfa-4c07-49e5-938b-10463980e145&amp;\ncode_verifier=&lt;YOUR_CODE_VERIFIER&gt;&amp;\ncode=&lt;YOUR_CODE&gt;\n</code></pre> Response<pre><code>{\n  \"access_token\": \"38abc903-9a68-48f9-9ccc-bf1b50fe8152\",\n  \"refresh_token\": \"e945e8ab-19c1-4073-b3c1-913bb090459a\",\n  \"id_token\": \"eyJraWQiOiJjb25uZWN0XzZmZmJkZTQ3LTU5MDgtNDljMy04MGVkLTFjODNhNGEyNWJmOF9zaWdfcnMyNTYiLCJ0eXAiOiJqd3QiLCJhbGciOiJSUzI1NiJ9.eyJhdF9oYXNoIjoiTndiVXg2NlFaUzFvMG1SMmdyRGxKZyIsInN1YiI6IkcxM2ZtQ3RDQkJ0VDN5TzBMWUY0eng3X1ROUktZeGhGNUd6cGFYOUFiZlkiLCJhbXIiOlsiMTAiXSwiaXNzIjoiaHR0cHM6Ly9taWx0b24tY2gtaGFyZHktbWl0ZS5nbHV1LmluZm8iLCJub25jZSI6IjRlOWVhZjdjLWZlMjUtNDlkMC05OGU1LTM2ZTNjYzJhMWNiZCIsInNpZCI6IjIwZThmNTAzLWZmN2EtNGU3OS05OTY3LTUxMTU5NTk1N2JhYiIsImphbnNPcGVuSURDb25uZWN0VmVyc2lvbiI6Im9wZW5pZGNvbm5lY3QtMS4wIiwiYXVkIjoiN2M3OGE0MmUtNTc4YS00OWE2LWExNzAtZTg1N2E0NWYzNTBjIiwicmFuZG9tIjoiZGU0NjE5NDEtNzIzOC00YjZjLWI2NTQtNjg2OTU0MmZlZjc3IiwiYWNyIjoiYmFzaWMiLCJjX2hhc2giOiJ1eFlZWDc5a3c2S2llX0NvaTZERi1RIiwiYXV0aF90aW1lIjoxNzAwMzYxMzA1LCJleHAiOjE3MDAzNjY5MjIsImdyYW50IjoiYXV0aG9yaXphdGlvbl9jb2RlIiwiaWF0IjoxNzAwMzYzMzIyfQ.IRgf6L4HsTHwgIGY_i3Af1dUnS-fLkMz8ND2r6Fgux-W7lkfQYXrpAqyEn-bUZ-L47PhaNWaLIV2bCl8Bxtbk1RhOS0-Sq8YnATkCgsSTCC5gtcZx42N67oQahoInSA4QuySdz1OAChZhlgUHRWn2bnAm07gCf7jfBdqRwCY11GcJrkR4n714tKcr5olxSDok2MJKmkbTi4VPfQXKfTYb7p-mMoqg3cr7w53IrEvQrOM94tYVJs1sUX_HGLwD99d1kRZN8SW2fMUxDsXw4hcDtnL4ktVp1rzc9tseGeu8tWzbNqQHESodOSPYqsl_SaPhuLip2FNFbStqJDc1vjnlg\",\n  \"token_type\": \"Bearer\",\n  \"expires_in\": 299\n}\n</code></pre>","tags":["administration","auth-server","oauth","feature","pkce"]},{"location":"janssen-server/auth-server/oauth-features/token-exchange/","title":"OAuth 2.0 Token Exchange (RFC 8693)","text":"<p>Token Exchange  is an extension to OAuth 2.0 for implementing use cases when one token needs to be exchanged for another token. The exchange occurs at the Token Endpoint of an authorization server, with a special <code>grant_type=urn:ietf:params:oauth:grant-type:token-exchange</code>.</p> <p>The client makes a token exchange request to the Token Endpoint with an extension grant type using the HTTP POST method. HTTP request entity-body should be <code>application/x-www-form-urlencoded</code> with a character encoding of UTF-8.</p> <p><code>subject_token_type</code> parameter must have <code>urn:ietf:params:oauth:token-type:id_token</code> value. It means that <code>subject_token</code> must be valid <code>id_token</code> issued by this AS.</p> <p>\"Token Exchange\" interception script allows to customize logic including <code>subject_token_type</code>, <code>subject_token</code> parameters validation and  response of token exchange.</p> <p>Sample request</p> <pre><code>POST /as/token.oauth2 HTTP/1.1\nHost: as.example.com\nAuthorization: Basic cnMwODpsb25nLXNlY3VyZS1yYW5kb20tc2VjcmV0\nContent-Type: application/x-www-form-urlencoded\n\ngrant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Atoken-exchange\n &amp;resource=https%3A%2F%2Fbackend.example.com%2Fapi\n &amp;subject_token=accVkjcJyb4BWCxGsndESCJQbdFMogUC5PbRDqceLTC\n &amp;subject_token_type=urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token\n</code></pre> <p>Sample response <pre><code>HTTP/1.1 200 OK\n Content-Type: application/json\n Cache-Control: no-cache, no-store\n\n {\n  \"access_token\":\"eyJhbGciOiJFUzI1NiIsImtpZCI6IjllciJ9.eyJhdWQiOiJo\n    dHRwczovL2JhY2tlbmQuZXhhbXBsZS5jb20iLCJpc3MiOiJodHRwczovL2FzLmV\n    4YW1wbGUuY29tIiwiZXhwIjoxNDQxOTE3NTkzLCJpYXQiOjE0NDE5MTc1MzMsIn\n    N1YiI6ImJkY0BleGFtcGxlLmNvbSIsInNjb3BlIjoiYXBpIn0.40y3ZgQedw6rx\n    f59WlwHDD9jryFOr0_Wh3CGozQBihNBhnXEQgU85AI9x3KmsPottVMLPIWvmDCM\n    y5-kdXjwhw\",\n  \"issued_token_type\":\n      \"urn:ietf:params:oauth:token-type:access_token\",\n  \"token_type\":\"Bearer\",\n  \"expires_in\":60\n }\n</code></pre></p> <p>AS supports following token types in response:</p> <ul> <li>urn:ietf:params:oauth:token-type:access_token</li> <li>urn:ietf:params:oauth:token-type:refresh_token</li> <li>urn:ietf:params:oauth:token-type:id_token</li> </ul>","tags":["administration","auth-server","oauth","token","toke-exchange"]},{"location":"janssen-server/auth-server/oauth-features/token-exchange/#references","title":"References","text":"<ul> <li>RFC 8693 OAuth 2.0 Token Exchange</li> </ul>","tags":["administration","auth-server","oauth","token","toke-exchange"]},{"location":"janssen-server/auth-server/openid-features/","title":"OpenID Connect Provider (OP)","text":"<p>The Janssen Authentication Server is a fully certified OpenID Provider (OP) that supports the following OpenID Connect specifications:</p> <ul> <li>Core (spec)</li> <li>Dynamic Client Registration (spec)</li> <li>Discovery (spec)</li> <li>Form Post Response Mode (spec)</li> <li>Session Management (spec)</li> <li>Front Channel Logout (draft)</li> </ul>","tags":["administration","auth-server","openidc","feature"]},{"location":"janssen-server/auth-server/openid-features/#protocol-overview","title":"Protocol Overview","text":"<p>OpenID Connect is an identity layer that profiles OAuth 2.0 to define a sign-in flow for applications (clients) to authenticate a person and obtain authorization to gather information (or \"claims\") about that person. For more information, see OpenID Connect</p> <p>It's handy to know some OpenID Connect terminology:</p> <ul> <li> <p>The end user or subject is the person being authenticated.</p> </li> <li> <p>The OpenID Provider (OP) is the equivalent of a SAML Identity Provider (IDP). It holds end user credentials (like a username/ password) and personally identifiable information. During a single sign-on (SSO) login flow, end users are redirected to the OP for authentication. </p> </li> <li> <p>The Relying Party or  RP  or client is software, like a mobile application or website, which needs to authenticate the subject. The RP is an OAuth client.</p> </li> </ul>","tags":["administration","auth-server","openidc","feature"]},{"location":"janssen-server/auth-server/openid-features/acrs/","title":"ACR","text":"<p>ACR(Authentication Context Class Reference) is defined by   OpenId Connect Specification.</p> <p>Using ACRs and ACR configuration, the client application can define end-user authentication experience while ensuring required level of security for the application.</p>","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/acrs/#supported-acrs","title":"Supported ACRs","text":"<p>Janssen Server lists supported ACRs in the response from Janssen Server's well-known configuration endpoint given below. Only ACRs that are supported and enabled by configuration will be part of the list.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p>The <code>acr_values_supported</code> claim in the response shows the list of supported and enabled ACRs for particular Janssen Server deployment.</p>","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/acrs/#acr-categories","title":"ACR categories:","text":"<p>ACRs available in Janssen Server can be broadly put into three categories. These categories are just for ease of understanding.</p>","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/acrs/#1-internal-janssen-server-acr","title":"1. Internal Janssen Server ACR","text":"<p>Janssen server will use internal ACR only if no other authentication method is set or could be invoked. This internal ACR, <code>simple_password_auth</code>, is set to level -1. This means that it has lower priority than any other script. This ACR is always available and enabled on any Janssen Server deployment.</p> <p>This ACR is a simple user-id and password-based authentication mechanism. It authenticates the end-user against the backend datastore.</p>","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/acrs/#2-pre-packaged-acr-for-authenticating-using-external-ldap-or-active-directory","title":"2. Pre-packaged ACR for authenticating using external LDAP or Active Directory","text":"<p>All Janssen Server deployments have <code>default_ldap_server</code> ACR which can be enabled to perform authentication against a remote LDAP-based IDP (e.g. ActiveDirectory). By default, this ACR is disabled. This ACR can only authenticate against LDAP-based IDP.</p> <p>Use the instructions provided in jans-cli LDAP configuration options documentation to learn how to enable and configure ACRs that use external LDAP as IDP.</p>","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/acrs/#3-script-based-acrs","title":"3. Script-based ACRs","text":"<p>To offer highly flexible and pluggable authentication flows, Janssen Server uses script-based ACRs. These ACRs are associated with a corresponding person authentication script. To use these ACRs in the authentication flow, the associated script should be enabled.</p>","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/acrs/#4-agama-acrs","title":"4. Agama ACRs","text":"<p>Agama acrs starts from <code>agama_</code> prefix. All of them invoke underlying agama bridge script called <code>agama</code>. General pattern is <code>agama_&lt;flow name&gt;</code>.</p>","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/acrs/#configuring-acrs-in-the-jans-as","title":"Configuring ACRs in the JANS AS:","text":"<p>ACRs can be configured on two levels:</p>","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/acrs/#1-client-level-acr","title":"1. Client Level ACR","text":"<p>The client can configure a specific ACR that should be used if the authentication request is missing <code>acr_values</code> parameter. This can be configured using <code>Default ACR</code> attribute of the client configuration.</p> <p>Also, the client can restrict ACR values that authentication requests can have as part of <code>acr_values</code> parameter. This can be configured using <code>Allowed ACRs</code>.</p> <p>Using the Janssen Text base UI (TUI) configuration tool, these values can be configured by navigating to <code>Auth Server</code>-&gt;<code>clients</code>-&gt;<code>get clients</code>-&gt;<code>choose a client and press enter</code>-&gt;<code>Advanced Client Prop</code>. On this screen populate ACR values in <code>Default ACR</code> and <code>Allowed ACRs</code>:</p> <p></p>","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/acrs/#2-server-level-acr","title":"2. Server Level ACR","text":"<p>Janssen Server administrator can configure an ACR that should be invoked if ACR for incoming requests can not be determined using client-level configuration. This is the default authentication mechanism exposed to all the clients that send end-users to the Janssen Server for sign-in.</p> <p>To configure this parameter using Janssen Text base UI (TUI) configuration tool, navigate to <code>Auth Server</code>-&gt;<code>Authn</code>-&gt;<code>Default ACR</code> as shown below:</p> <p></p>","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/acrs/#acr-precedence-levels","title":"ACR Precedence Levels","text":"<p>Each authentication mechanism (script) has a \"Level\" assigned to it which describes how secure and reliable it is. The higher the \"Level\" represents higher reliability. Though several mechanisms(ACRs) can be enabled for the same Janssen server deployment at the same time, for any specific user's session only one of them can be set as the current ACR (and will be returned as <code>acr</code> claim of id_token).</p> <p>After the creation of the initial session, if RP sends a new request with a different ACR, then ACR's \"Level\" will be compared to that of the method associated with the current session. If the requested method's \"Level\" is lower or equal to current ACR's level, nothing is changed and the usual SSO behavior is observed. If the new level is higher (i.e. a more secure method is requested), and it's not possible to serve such a request using the existing session's context, then the user must re-authenticate to continue. If the user succeeds, a new session with a new ACR gets associated.</p>","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/acrs/#acr-mappings-aliases","title":"ACR mappings (aliases)","text":"<p>There is <code>acrMappings</code> AS configuration property which allows to specify aliases for acrs. <code>acrMappings</code> contains simple map in key-value form.</p> <p>Lets say RP sends request with <code>acr_values=loginWithOtpCheck</code>. If <code>acrMappings</code> contains mapping \"loginWithOtpCheck\":\"otp\" then AS will map <code>loginWithOtpCheck</code> to <code>otp</code> and will use <code>acr_values=otp</code> for actual processing on server side. It means that custom script must be called <code>otp</code> in this case on AS side and not <code>loginWithOtpCheck</code> (because <code>loginWithOtpCheck</code> is alias to <code>otp</code>).</p> <p>ACR mappings are published on discovery page <code>GET /.well-known/openid-configuration HTTP/1.1</code></p> <pre><code>{\n  ...\n  \"acr_mappings\":{\"alias1\":\"acr1\", \"loginWithOtpCheck\": \"otp\"}\n  ...\n}\n</code></pre>","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/acrs/#flowchart-how-the-jans-as-derives-an-acr-value-for-a-user-session","title":"Flowchart : How the Jans AS derives an ACR value for a user session","text":"<pre><code>flowchart TD\n    A[RP send authentication request] --&gt; B{Request contains &lt;br /&gt;&lt;code&gt;acr_values&lt;/code&gt; parameter?}\n    B --&gt;|Yes| C[Perform Authentication]\n    B --&gt;|No| D{&lt;code&gt;Default ACR&lt;/code&gt; &lt;br /&gt;configured for &lt;br /&gt;client?}\n    D --&gt;|Yes| C\n    D --&gt;|No| E{&lt;code&gt;Default ACR&lt;/code&gt; value &lt;br /&gt;configured for &lt;br /&gt;Janssen Server?}\n    E --&gt; |Yes| C\n    E --&gt; |No| F[Select &lt;br /&gt;internal ACR as&lt;br /&gt; Authentication method] --&gt; C</code></pre> <ul> <li>When authentication request is received from a client(RP), the Janssen Server looks for <code>acr_values</code> parameter in   the request. This parameter is defined in the OpenId Connect core specification,   section 3.1.2.1.</li> <li>If the <code>acr_values</code> parameter is not received with the request, then Janssen Server uses the   value from the <code>Default ACR</code> configuration from the client</li> <li>If Janssen Server doesn't find <code>acr_values</code> request parameter nor does it find the <code>Default ACR</code> configured for the   client, then the Janssen Server checks the server configuration property   useHighestLevelScriptIfAcrScriptNotFound.   If this property is set to true, then Janssen Server invokes the authentication mechanism for which the corresponding   person authentication script is enabled. Choosing the script with the highest   level.</li> <li>If no script can be invoked or the <code>useHighestLevelScriptIfAcrScriptNotFound</code> property is set to false,   then the Janssen Server authenticates using the default ACR for the server.</li> <li>If the default ACR for the server is not configured by the Janssen Server administrator, or it can not be invoked due   to any reason, then the Janssen Server uses the internal server ACR to authenticate   the end-user.</li> </ul>","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/acrs/#errors","title":"Errors","text":"","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/acrs/#unmet_authentication_requirements","title":"unmet_authentication_requirements","text":"<p>If authorization request is sent to Authorization Endpoint with <code>acr_values</code> for which AS it not able to find \"Person Authentication\" custom script, it returns \"unmet_authentication_requirements\" with detail log in <code>jans-auth.log</code>.</p>","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/acrs/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","openidc","feature","acr"]},{"location":"janssen-server/auth-server/openid-features/ciba/","title":"CIBA","text":"","tags":["administration","auth-server","openidc","feature"]},{"location":"janssen-server/auth-server/openid-features/ciba/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","auth-server","openidc","feature"]},{"location":"janssen-server/auth-server/openid-features/ciba/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","openidc","feature"]},{"location":"janssen-server/auth-server/openid-features/ciba/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","openidc","feature"]},{"location":"janssen-server/auth-server/openid-features/id-token/","title":"ID Token","text":"<p>Janssen Server is an OpenID Connect Provider(OP). OpenID Connect extends OAuth 2.0 and adds user authentication capabilities using ID token.</p> <p>To add end-user authentication capabilities to an OAuth flow, it is important to use <code>openid</code> scope in the request as specified here. In absence of <code>openid</code> scope, the Janssen Server will not treat the incoming request as OpenID Connect request.</p> <p>For further information on how to configure and customize OpenID Connect using ID Token read here</p>","tags":["administration","auth-server","openidc","feature","ID Token"]},{"location":"janssen-server/auth-server/openid-features/id-token/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","openidc","feature","ID Token"]},{"location":"janssen-server/auth-server/openid-features/jarm/","title":"JARM","text":"","tags":["administration","auth-server","openidc","feature"]},{"location":"janssen-server/auth-server/openid-features/jarm/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","auth-server","openidc","feature"]},{"location":"janssen-server/auth-server/openid-features/jarm/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","openidc","feature"]},{"location":"janssen-server/auth-server/openid-features/jarm/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","openidc","feature"]},{"location":"janssen-server/auth-server/openid-features/native-sso/","title":"Native Single Sign-On","text":"<p>An increasing number of mobile phone users are using multiple mobile applications from the same software vendor. For instance, it is fairly common to see people using multiple mobile apps from software vendors like Google and Microsoft, etc.</p> <p>Software vendors need a way to allow users to sign-in to one of the apps provided by the software vendor and users should be able to use all other apps from the same vendor without having to sign-in again. In short, single sign-on for applications belonging to the same vendor.</p> <p>Janssen Server supports OpenID Connect native SSO mechanism to enable SSO for mobile applications.</p>","tags":["administration","auth-server","openidc","feature","native sso","mobile","single sign-on"]},{"location":"janssen-server/auth-server/openid-features/native-sso/#scope-support","title":"Scope Support","text":"<p>Janssen Server supports the <code>device_sso</code> scope as defined by the specification. Software vendor wanting to leverage native SSO feature should build the apps so during initial user authentication, the app would send <code>device_sso</code> scope in the authorization request.</p> <p>The presence of the <code>device_sso</code> scope in the authorization request would enable AS to return <code>device_secret</code> in the token response from the token endpoint.</p>","tags":["administration","auth-server","openidc","feature","native sso","mobile","single sign-on"]},{"location":"janssen-server/auth-server/openid-features/native-sso/#device-secret","title":"Device Secret","text":"<p><code>device_secret</code> is an opaque value returned to the application from the token endpoint as a response to a token exchange request. Janssen Server will return <code>device_secret</code> only if the code provided by the application in token exchange request has <code>device_sso</code> scope.</p> <p>Janssen Server also checks if the client has the token exchange grant type enabled. To enable the grant type, use Janssen Text-based UI(TUI) and enable token exchange grant (<code>urn:ietf:params:oauth:grant-type:token-exchange</code>).</p> <p>The <code>device_token</code> claim in the returned token response contains the device secret. Janssen Server stores the device secretes issued to a client in the corresponding session-id.</p>","tags":["administration","auth-server","openidc","feature","native sso","mobile","single sign-on"]},{"location":"janssen-server/auth-server/openid-features/native-sso/#processing-token-exchange-request","title":"Processing Token Exchange Request","text":"<p>Janssen Server carries out the processing of token requests as per rules and checks defined in the specification.</p>","tags":["administration","auth-server","openidc","feature","native sso","mobile","single sign-on"]},{"location":"janssen-server/auth-server/openid-features/native-sso/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","openidc","feature","native sso","mobile","single sign-on"]},{"location":"janssen-server/auth-server/openid-features/prompt-parameter/","title":"Prompt CREATE","text":"<p><code>prompt=create</code> value indicates to the AS that the client desires that the user be shown  the account creation page rather than the login flow.</p> <p>It is enabled by default. However <code>prompt=create</code> can be entirely disabled if set AS configuration property <code>disablePromptCreate</code> to <code>true</code>.</p> <p>By default for <code>prompt=create</code> <code>createUser</code> page is shown which allows to enter basic information: - display name - email - login - password</p> <p>On \"Create User\" button click user is created and redirected Authorization Endpoint of AS.</p> <p></p> <p>If more or custom fields have to be shown then custom page should be added and \"CreateUser\" custom script should redirect to that custom page.</p> <pre><code>public String getCreateUserPage(Object context) {\n    return \"/customCreateUser\";\n}\n</code></pre> <ul> <li>\"CreateUser\" custom script</li> </ul>","tags":["administration","auth-server","openidc","feature","prompt"]},{"location":"janssen-server/auth-server/openid-features/prompt-parameter/#prompt-none","title":"Prompt NONE","text":"<p>The OpenID Connect protocol supports a prompt=none parameter on the authentication request that allows applications to indicate that the authorization server must not display any user interaction (such as authentication, consent, or MFA). Janssen will either return the requested response back to the application, or return an error if the user is not already authenticated or if some type of consent or prompt is required before proceeding.</p> <p>Initiate Silent Authentication requests To initiate a silent authentication request, add the prompt=none parameter when you redirect a user to the /authorize endpoint of Janssen authentication API. (The individual parameters on the authentication request will vary depending on the specific needs of your app.)</p> <p>For example:</p> <pre><code>GET https://YOUR_DOMAIN//authorize?\nresponse_type={response_type}&amp;\nclient_id={client_id}&amp;\nscope={scope}&amp;\nstate={state}&amp;\nui_locales=&amp;\nclaims_locales=&amp;\nacr_values=&amp;\nredirect_uri={redirect_uri}&amp;\nprompt=none\n\nBasic credential user\n</code></pre> <p>The prompt=none parameter causes Jannsen to immediately send a result to the specified redirect_uri (callback URL) using the specified response_mode with one of two possible responses: success or error.</p> <p>Note: Any applicable rules will be executed as part of the silent authentication process.</p> <p>Successful authentication responses If the user was already logged in to Janssen and no other interactive prompts are required, Janssen will respond exactly as if the user had authenticated manually through the login page.</p> <p>This response is indistinguishable from a login performed directly without the prompt=none parameter.</p> <p>Example 1: Prompt None (Without credentials in Header) <pre><code>title Prompt None (Without credentials in Header)\n\nparticipant Browser\nparticipant IDP\nparticipant Identity\nparticipant SessionIdService\nparticipant AuthorizeRestWebServiceValidator\nparticipant AuthenticationFilterService\n\nBrowser-&gt;IDP: /authorize?\\nresponse_type=... &amp;\\nclient_id=... &amp;\\nscope=... &amp;\\nstate=... &amp;\\nui_locales=... &amp;\\nclaims_locales=... &amp;\\nacr_values=... &amp;\\nredirect_uri=... &amp;\\n**prompt=none**\n\nIDP-&gt;Identity: getSessionId()\nIdentity-&gt;IDP: return: null\n\nIDP-&gt;SessionIdService: getUser(): from sessionId\nSessionIdService-&gt;IDP: return: null\n\ngroup Client validation\nIDP-&gt;AuthorizeRestWebServiceValidator: validateClient(): if it's par, disabled or not found?\nAuthorizeRestWebServiceValidator-&gt;Browser: throw WebApplicationException\nend\n\ngroup User is null\nIDP-&gt;IDP: ifUserIsNull()\nIDP-&gt;AuthenticationFilterService: processAuthenticationFilters()\nAuthenticationFilterService-&gt;Browser: WebApplicationException (LOGIN_REQUIRED)\nend\n</code></pre> </p> <p>Example 2: Prompt None (Without credentials in Header) <pre><code>title Prompt None (With credentials in Header)\n\nparticipant Browser\nparticipant Janssen\nparticipant Identity\nparticipant SessionIdService\nparticipant AuthorizeRestWebServiceValidator\nparticipant ScopeChecker\nparticipant ExternalPostAuthnService\nparticipant ResponseParameters\nparticipant ExternalUpdateTokenService\nparticipant ClientService\n\nBrowser-&gt;Janssen: /authorize?\\nresponse_type=... &amp;\\nclient_id=... &amp;\\nscope=... &amp;\\nstate=... &amp;\\nui_locales=... &amp;\\nclaims_locales=... &amp;\\nacr_values=... &amp;\\nredirect_uri=... &amp;\\n**prompt=none**\\n\\n**Basic credentials (user)** in Headers\n\nJanssen-&gt;Identity: getSessionId()\nIdentity-&gt;Janssen: return: sessionId\n\nJanssen-&gt;SessionIdService: getUser(): from sessionId\nSessionIdService-&gt;Janssen: return: User\n\ngroup Update Session For ROPC: If exists session attribute grant_type ROPC\nJanssen-&gt;Janssen: updateSessionForROPC()\nJanssen-&gt;SessionIdService: updateSessionId()\nSessionIdService-&gt;Janssen: session attributes updated\nend\n\ngroup Client validation\nJanssen-&gt;AuthorizeRestWebServiceValidator: validateClient(): if it's par, disabled or not found?\nAuthorizeRestWebServiceValidator-&gt;Browser: throw WebApplicationException (INVALID_REQUEST, UNAUTHORIZED_CLIENT, DISABLED_CLIENT)\nend\n\ngroup ACR validation\nJanssen-&gt;AuthorizeRestWebServiceValidator: validateAcrs(): If the request acr list does not exist in the session attribute? or\\n Acr Changed?\nAuthorizeRestWebServiceValidator-&gt;Browser: throw WebApplicationException (INVALID_REQUEST)\nend\n\ngroup Max Age Validation\nJanssen-&gt;Janssen: validateMaxAge()\nJanssen-&gt;AuthorizeRestWebServiceValidator: isAuthnMaxAgeValid()\nAuthorizeRestWebServiceValidator-&gt;Janssen: throw new WebApplicationException(): redirectToAuthorizationPage(): if it's not valid\nend\n\nJanssen-&gt;ScopeChecker: checkScopesPolicy()\nScopeChecker-&gt;Janssen: return: scopes\n\ngroup Post Authn Custom Script\nJanssen-&gt;ExternalPostAuthnService: checkForceReAuthentication()\nJanssen-&gt;ExternalPostAuthnService: checkForceAuthorization()\nend\n\ngroup if ResponseType CODE\nJanssen-&gt;ResponseParameters: put code\nend\n\ngroup if ResponseType TOKEN\nJanssen-&gt;ResponseParameters: put access_token, token_type and expires_in\nJanssen-&gt;ExternalUpdateTokenService: modifyAccessToken()\nExternalUpdateTokenService-&gt;Janssen: return true or false\n\nend\n\ngroup if ResponseType ID_TOKEN\nJanssen-&gt;ResponseParameters: put id_token\nJanssen-&gt;ExternalUpdateTokenService: modifyIdToken()\nExternalUpdateTokenService-&gt;Janssen: return true or false\nend\n\nJanssen-&gt;SessionIdService: generateAuthenticatedSessionId(): if exists sessionId\nSessionIdService-&gt;Janssen: return: newSessionUser\n\nJanssen-&gt;ResponseParameters: addRespnseParameterSessionId(): if enabled appConfiguration.getSessionIdRequestParameterEnabled()\n\nJanssen-&gt;ResponseParameters: addResponseParameterSid(): if enabled appConfiguration.getIncludeSidInResponse()\n\nJanssen-&gt;ResponseParameters: put session_state and state\n\nJanssen-&gt;ClientService: updateAccessTime()\n\nJanssen-&gt;Browser: /redirect_uri?with_param=...\n</code></pre> </p>","tags":["administration","auth-server","openidc","feature","prompt"]},{"location":"janssen-server/auth-server/openid-features/request-objects/","title":"Request Objects","text":"","tags":["administration","auth-server","openidc","feature"]},{"location":"janssen-server/auth-server/openid-features/request-objects/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","auth-server","openidc","feature"]},{"location":"janssen-server/auth-server/openid-features/request-objects/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","openidc","feature"]},{"location":"janssen-server/auth-server/openid-features/request-objects/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","openidc","feature"]},{"location":"janssen-server/auth-server/openid-features/subject-identifiers/","title":"Subject identifiers","text":"<p>Subject identifiers(defined in OpenID Connect Core SPEC) are unique identifiers generated by Janssen Server(i.e. OpenId Provider) for an end-user. Subject identifiers are unique per Janssen Server instance and it is shared with the client (or clients) via ID token or access token. Whether the same subject identifier is used for the same end-user across multiple clients depends on the kind of subject identifier configured for a particular client.</p>","tags":["administration","auth-server","openidc","feature","subject identifier"]},{"location":"janssen-server/auth-server/openid-features/subject-identifiers/#types-of-subject-identifiers","title":"Types of Subject Identifiers","text":"<p>Janssen Server supports both subject identifier types, <code>public</code> and <code>pairwise</code>, as specified in OpenID Connect specification. For a particular Janssen Server deployment, the supported types are listed in the response of Janssen Server's well-known configuration endpoint is given below.</p> <pre><code>https://janssen.server.host/jans-auth/.well-known/openid-configuration\n</code></pre> <p>The <code>subject_types_supported</code> claim in the response specifies the list of all the supported types.</p> <p>More details about both types are given in this section of specification.</p>","tags":["administration","auth-server","openidc","feature","subject identifier"]},{"location":"janssen-server/auth-server/openid-features/subject-identifiers/#public-subject-identifiers","title":"Public Subject Identifiers","text":"<p>Public subject identifiers are identifiers that the server generates and assigns to each subject. These identifiers are unique for each server deployment. All the clients that are configured to use a <code>public</code> type subject identifier will be supplied this same identifier for a given subject by the Janssen Server.</p> <p>Sharing common subject identifiers across multiple clients may enable clients to correlate data about a particular subject. If this is an unwanted situation, then the client should use pairwise subject identifiers.</p> <p>By default, the Janssen Server uses the subject attribute <code>inum</code> as the subject identifier.</p>","tags":["administration","auth-server","openidc","feature","subject identifier"]},{"location":"janssen-server/auth-server/openid-features/subject-identifiers/#customizing-subject-identifier-attribute","title":"Customizing Subject Identifier Attribute","text":"<p>At the server level, the administrator specifies which subject attribute should be used as subject identifiers. This can be done by updating the value of openidSubAttribute Janssen Server property.</p> <p>At the client level, this can be further customized. If a client uses <code>public</code> type subject identifier, the client can configure the subject attribute that should be used as a subject identifier. This should be done at the client registration time.</p> <p>To enable client level customization, the Janssen Server property publicSubjectIdentifierPerClientEnabled should be set to <code>true</code> and also the desired attribute should be part of the list defined by the Janssen Server property subjectIdentifiersPerClientSupported. Both these properties can be set by the administrator using TUI.</p>","tags":["administration","auth-server","openidc","feature","subject identifier"]},{"location":"janssen-server/auth-server/openid-features/subject-identifiers/#pairwise-subject-identifiers","title":"Pairwise Subject Identifiers","text":"<p>When a client chooses to use <code>pairwise</code> subject identifier, the Janssen Server generates and attaches a new identifier to all the subjects requested by the client. This identifier is consistently used for the subject-client pair and never used for any other clients configured on the Janssen Server. If multiple clients are using <code>pairwise</code> type subject identifiers, then the same subject will have different identifiers for each subject.</p> <p>Since every client has a different identifier for the same subject, the clients can't match identifiers and correlate information about a subject out of the band.</p>","tags":["administration","auth-server","openidc","feature","subject identifier"]},{"location":"janssen-server/auth-server/openid-features/subject-identifiers/#pairwise-identifier-generation","title":"Pairwise Identifier Generation","text":"<p>Janssen Server uses host name string from redirect URI or sector identifier, local user ID, and a salt string as initial inputs to generate pairwise identifiers. This input is then signed with the HS256 signing algorithm to generate a pairwise identifier.</p> <p>Sector identifier configuration influences how pairwise identifiers are calculated. See this document for more details.</p>","tags":["administration","auth-server","openidc","feature","subject identifier"]},{"location":"janssen-server/auth-server/openid-features/subject-identifiers/#properties","title":"Properties","text":"<p>Janssen Server allows customization concerning subject identifiers using the properties below:</p> <ul> <li>subjectTypesSupported</li> <li>defaultSubjectType</li> <li>shareSubjectIdBetweenClientsWithSameSectorId</li> <li>openidSubAttribute</li> <li>publicSubjectIdentifierPerClientEnabled</li> <li>subjectIdentifiersPerClientSupported</li> <li>skipAuthorizationForOpenIdScopeAndPairwiseId</li> <li>pairwiseCalculationKey</li> <li>pairwiseCalculationSalt</li> <li>pairwiseIdType</li> </ul>","tags":["administration","auth-server","openidc","feature","subject identifier"]},{"location":"janssen-server/auth-server/openid-features/subject-identifiers/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","openidc","feature","subject identifier"]},{"location":"janssen-server/auth-server/openid-features/consent/","title":"Consent","text":"<p>Please use the left navigation menu to browse the content of this section while we are still working on developing content for <code>Overview</code> page.</p> <p>Contribute</p> <p>If you\u2019d like to contribute to this document, get started with the Contribution Guide</p>","tags":["administration","auth-server","openidc","feature","consent"]},{"location":"janssen-server/auth-server/openid-features/consent/customize/","title":"Customize","text":"","tags":["administration","auth-server","openidc","feature","consent"]},{"location":"janssen-server/auth-server/openid-features/consent/customize/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","auth-server","openidc","feature","consent"]},{"location":"janssen-server/auth-server/openid-features/consent/customize/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","openidc","feature","consent"]},{"location":"janssen-server/auth-server/openid-features/consent/customize/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","openidc","feature","consent"]},{"location":"janssen-server/auth-server/openid-features/consent/list-delete/","title":"List/Delete Consent","text":"","tags":["administration","auth-server","openidc","feature","consent"]},{"location":"janssen-server/auth-server/openid-features/consent/list-delete/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","auth-server","openidc","feature","consent"]},{"location":"janssen-server/auth-server/openid-features/consent/list-delete/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","openidc","feature","consent"]},{"location":"janssen-server/auth-server/openid-features/consent/list-delete/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","openidc","feature","consent"]},{"location":"janssen-server/auth-server/openid-features/logout/","title":"Logout","text":"<p>Janssen Server supports various end-user logout mechanisms by implementing OpenID Connect specifications. OpenID Connect specifications for RP-Initiated Logout, Front-Channel Logout and Back-Channel Logout can be leveraged by applications(RPs) to implement end-user logout. Simpler logout scenarios can be fulfilled by using features of one of the specifications (just using RP-initiated logout for example), but for more complex scenarios like single sign-out, features from multiple specifications may have to be used in combination.</p> <p>To understand how various logout mechanisms work, it is important to first understand</p> <ul> <li>How Janssen Server manages sessions?</li> <li>OpenID Connect Session management specification</li> </ul> <p>User logout can be initiated either at RP (application) first or at the OpenID Provider (OP) first. Whichever party (RP or OP) gets the logout request first, and has to inform the other party about the event so that both the RP and OP sessions get properly terminated. RP-initiated logout is RP's method to let OP know about the event while Front-channel logout or back-channel logouts are the mechanisms used by OP to initiate logout and let RP know.</p>","tags":["administration","auth-server","openidc","feature","logout","front channel logout","back channel logout","RP initiated logout"]},{"location":"janssen-server/auth-server/openid-features/logout/#client-configuration","title":"Client Configuration","text":"<p>Which kind of logout mechanism is used by the client(RP) is dictated by the client's configuration on Janssen Server.</p> <p>When using Janssen Text-based UI(TUI) to configure the client, navigate via <code>Auth Server</code>-&gt; <code>Clients</code>-&gt;<code>logout</code> as shown in the image below:</p> <p></p>","tags":["administration","auth-server","openidc","feature","logout","front channel logout","back channel logout","RP initiated logout"]},{"location":"janssen-server/auth-server/openid-features/logout/#janssen-server-configuration-properties","title":"Janssen Server Configuration Properties","text":"<p>Following properties drive how Janssen Server as OpenID Connect Provider (OP) will execute logout.</p> <ul> <li>allowPostLogoutRedirectWithoutValidation</li> <li>frontChannelLogoutSessionSupported</li> <li>removeRefreshTokensForClientOnLogout</li> </ul>","tags":["administration","auth-server","openidc","feature","logout","front channel logout","back channel logout","RP initiated logout"]},{"location":"janssen-server/auth-server/openid-features/logout/#rp-initiated-logout","title":"RP-Initiated Logout","text":"<p>RP can initiate logout for a user by redirecting the user-agent to Janssen Server's <code>end_session_endpoint</code>. This URL can be obtained as the value of the <code>end_session_endpoint</code> claim in the OpenID Connect .well-known metadata endpoint response. Please read about <code>end_session_endpoint</code> in more details here</p> <p>A request to the <code>end_session_endpoint</code> endpoint of OP will clear the user session on OP. Along with this, it is important that RP also removes the local user session. RP can do this before redirecting the user agent to <code>end_session_endpoint</code>. In case RP is configured to receive an intimation from the OP about user logouts (either via front or backchannel logout mechanisms), then RP may choose to remove the local session after OP informs the RP about the successful logout.</p>","tags":["administration","auth-server","openidc","feature","logout","front channel logout","back channel logout","RP initiated logout"]},{"location":"janssen-server/auth-server/openid-features/logout/#configuration-properties","title":"Configuration Properties","text":"<p>Client configuration property of <code>Post Logout Redirection URIs</code> plays an important role when using RP-initiated logout. After successful logout from Janssen Server, the server will redirect the user-agent to the URI specified in this property.</p>","tags":["administration","auth-server","openidc","feature","logout","front channel logout","back channel logout","RP initiated logout"]},{"location":"janssen-server/auth-server/openid-features/logout/#front-channel-logout","title":"Front-Channel Logout","text":"<p>Although Jans Auth Server has a <code>session_id</code> for each person who has authenticated, applications generally have their own sessions. Upon logout from an OpenID Provider, ideally, all RPs are notified, so they can also remove their local sessions. The OpenID solution to implement logout is currently described in the OpenID Connect Front Channel Logout specification.</p> <p>In practice, here's how it works:</p> <ul> <li>From the user-agent when the end-user initiates logout, the Janssen Server <code>end_session</code> endpoint is called.</li> <li><code>end_session</code> endpoint returns an HTML page, which contains an iFrame for each application to   which the user has authenticated.</li> <li>The iFrame contains a link to each application's respective logout URL.</li> <li>The special HTML page should be loaded in the background and not displayed to the user.</li> <li>The iFrame URLs should be loaded by the browser.</li> <li>Now, upon logout, the user is calling the logout page of each application, the local cookies are cleared,   and the user is signed out of all applications.</li> </ul>","tags":["administration","auth-server","openidc","feature","logout","front channel logout","back channel logout","RP initiated logout"]},{"location":"janssen-server/auth-server/openid-features/logout/#configuration-properties_1","title":"Configuration Properties","text":"<p>A client can use configuration values of <code>Front Channel Logout URI</code> to specify URI to be used by Janssen Server to render in the iFrame at the time of logout. These configuration values can be updated using TUI as shown here</p> <p>Janssen Server also provides a feature flag END_SESSION that enables or disables this endpoint. If this flag is enabled, it has the same effect as having <code>frontchannel_logout_supported</code> and <code>frontchannel_logout_session_supported</code> metadata values set to <code>true</code>. These metadata values are defined here in <code>OpenID Connect Front-Channel Logout 1.0</code> specification.</p>","tags":["administration","auth-server","openidc","feature","logout","front channel logout","back channel logout","RP initiated logout"]},{"location":"janssen-server/auth-server/openid-features/logout/#back-channel-logout","title":"Back-Channel Logout","text":"<p>Janssen Server supports back-channel logout as a mechanism for OP to intimate the RP about user logout. As against front-channel logout, where OP intimates RP about user logout using user-agent, the back-channel logout uses direct message communication over HTTP with RP to convey the logout.</p> <p>Since this approach doesn't depend on the user-agent, it is more reliable. At the same time, it is more complex to implement since clearing the user-agent state has to be taken care of separately by RP.</p> <p>Central to the back-channel logout approach is the <code>logout token</code>. This token along with claims like <code>sid</code>, <code>sub</code>, and <code>iss</code> are sent by OP to RP to indicate that the subject or the session identified in the logout token has been logged out. Janssen Server follows recommendations published in the specification in order to construct the logout token.</p> <p>Upon receipt of the logout token, the RP should validate the token and perform appropriate actions. It should also send an appropriate response to OP informing the OP that logout has been successfully executed by RP.</p>","tags":["administration","auth-server","openidc","feature","logout","front channel logout","back channel logout","RP initiated logout"]},{"location":"janssen-server/auth-server/openid-features/logout/#configuration-properties_2","title":"Configuration Properties","text":"<p>If an RP has specified <code>Back channel logout URL</code> as part of its client configuration then Janssen Server uses this URI to send the HTTP logout request. The client can also enable <code>backchannel_logout_session_required</code> as specified here by using client configuration.</p> <p>Janssen Server also provides a feature flag END_SESSION that enables or disables this endpoint. If this flag is enabled, it has the same effect as having <code>backchannel_logout_supported</code> and <code>backchannel_logout_session_supported</code> metadata values set to <code>true</code>. These metadata values are defined here in <code>OpenID Connect Back-Channel Logout 1.0</code> specification.</p>","tags":["administration","auth-server","openidc","feature","logout","front channel logout","back channel logout","RP initiated logout"]},{"location":"janssen-server/auth-server/openid-features/logout/back-channel/","title":"Back Channel","text":"","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/logout/back-channel/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/logout/back-channel/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/logout/back-channel/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/logout/customizing-logout/","title":"Customizing Logout","text":"","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/logout/customizing-logout/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/logout/customizing-logout/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/logout/customizing-logout/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/logout/forcing-logout/","title":"Forcing Logout on Browser Exit","text":"","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/logout/forcing-logout/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/logout/forcing-logout/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/logout/forcing-logout/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/logout/front-channel/","title":"Front Channel","text":"","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/logout/front-channel/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/logout/front-channel/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/logout/front-channel/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","openidc","feature","logout"]},{"location":"janssen-server/auth-server/openid-features/user-claims/","title":"User Claims","text":"<p>Claim is a piece of information asserted about an Entity. User claims refer to pieces of information about the authenticated user, such as their name, email address, date of birth, and more. These claims provide the RP with specific attributes or characteristics associated with the user. The claims are issued by the IDP after successful authentication and are included in the ID Token (which is a JSON Web Token (JWT) that contains user-related information) and are also available through the <code>/userinfo</code> endpoint.</p> <p>Note</p> <p><code>Attribute</code> and <code>User Claims</code> refer to the same user data fields in the Janssen Server.</p>","tags":["administration","auth-server","openidc","feature","claims","attributes","custom claims","user claims"]},{"location":"janssen-server/auth-server/openid-features/user-claims/#types-of-user-claims","title":"Types of User Claims","text":"","tags":["administration","auth-server","openidc","feature","claims","attributes","custom claims","user claims"]},{"location":"janssen-server/auth-server/openid-features/user-claims/#standard-claims","title":"Standard Claims","text":"<p>The Janssen Server includes all standard claims defined in OpenID Connect specifications. Built-in claims defines a standard set of pre-defined claims available to use after installation for sharing of user attributes between identity providers and relying parties.</p> <p>The built-in user claims in Janssen are listed in below table</p> Display Name Claim Name Description sub sub Subject - Identifier for the End-User at the Issuer.The authorization server will always send this claim. Username user_name Username of user Password user_password Password of user First Name given_name First name of user Middle Name middle_name Middle name of user Last Name family_name Last name of user Display Name name Display name of user Email email Email address of user Nickname nickname Nickname used for user CIBA Device Registration Token jans_backchannel_device_registration_tkn CIBA Device Registration Token CIBA User code jans_backchannel_usr_code CIBA User code Locale locale End-User's locale, represented as a BCP47 (RFC5646) language tag Website URL website URL of the End-User's Web page or blog IMAP Data imap_data IMAP data jansAdminUIRole jansAdminUIRole Gluu Flex Admin UI role Enrollment code jans_enrollment_code Enrollment code Preferred Language preferred_language Preferred language Profile URL profile Profile URL Secret Question secret_question Secret question used to verify user identity Email Verified email_verified Is user's email verified? Birthdate birthdate Baithdate of user Time zone info zoneinfo The End-User's time zone Phone Number verified phone_number_verified Is user's phone number verified? Home Telephone Number phone_number User's phone number Preferred Username preferred_username A domain issued and managed identifier for the person TransientId transient_id ... PersistentId persistent_id ... Country country User's country Secret Answer secret_answer Secret answer used to verify user identity OpenID Connect JSON formatted address address End-User's preferred postal address. The value of the address member is a JSON structure containing some or all of the members defined in OpenID Connect 1.0 Core Standard Section 5.1.1 User certificate user_certificate User certificate Organization o Organization Picture URL picture User's picture url gender, male or female gender End-User's gender. Values defined by this specification are female and male. Other values MAY be used when neither of the defined values are applicable. Last Updated updated_at Time the End-User's information was last updated. Its value is a JSON number representing the number of seconds from 1970-01-01T00:00:00Z as measured in UTC until the date/time.","tags":["administration","auth-server","openidc","feature","claims","attributes","custom claims","user claims"]},{"location":"janssen-server/auth-server/openid-features/user-claims/#custom-claims","title":"Custom Claims","text":"<p>In addition to standard claims, custom claims are also allowed to be defined by the Janssen Server. These claims provide flexibility to include application-specific  user attributes that are not covered by the standard claims.  Custom claims can provide additional context or information needed by the RP.</p> <p>Refer to claims configuration document for more details on custom claims configuration.</p>","tags":["administration","auth-server","openidc","feature","claims","attributes","custom claims","user claims"]},{"location":"janssen-server/auth-server/reporting-metrics/","title":"Reporting and Metrics","text":"<p>Authorization Server (AS) supports different metric data:</p> <ul> <li>Monthly Active Users (MAU)</li> <li>Health Check</li> <li>Token Issued</li> <li>Audit Logs</li> </ul>","tags":["administration","auth-server","reporting","metric"]},{"location":"janssen-server/auth-server/reporting-metrics/#statistic-endpoint","title":"Statistic Endpoint","text":"<p>Statistic data (MAU, Token Issued) is returned from <code>/jans-auth/restv1/internal/stat</code> protected endpoint.</p> <p>Endpoint is protected by authorization token which must contain configurable scope (via <code>statAuthorizationScope</code> AS configuration property). Default scope value of <code>statAuthorizationScope</code>  is <code>jans_stat</code> which means that token must contain this scope or otherwise <code>UNAUTHORIZED</code> 401 response is returned.</p> <p>Parameters - <code>month</code> - specify month in YYYYMM format (e.g. <code>January 2022</code> is <code>202201</code>) - <code>start-month</code> - start month for range request - <code>end-month</code> - end month for range request - <code>format</code> - if no value is specified than json value is returns. Possible explicit values are <code>openmetrics</code> (open metrics format) and <code>jsonmonth</code> (all data are flattened for given month) </p> <p>Example: Request single month data (recommended) <pre><code>GET /jans-auth/restv1/internal/stat?month=202101\nAuthorization: Bearer czZCaGRSa3F0MzpnWDFmQmF0M2JW\n</code></pre></p> <p>Example: request multiple months data <pre><code>GET /jans-auth/restv1/internal/stat?month=202012%20202101\nAuthorization: Bearer czZCaGRSa3F0MzpnWDFmQmF0M2JW\n</code></pre></p> <p>It is also possible to request data by specifying month ranges via <code>start-month</code> and <code>end-month</code> parameters.</p> <p>Example: request multiple months by specifying month range (all months from February 2021 till February 2022) <pre><code>GET /jans-auth/restv1/internal/stat?start-month=202102&amp;end-month=202202\nAuthorization: Bearer czZCaGRSa3F0MzpnWDFmQmF0M2JW\n</code></pre></p> <p>If both month range parameters (<code>start-month</code> or <code>end-month</code> ) and <code>month</code> parameter are used at the same time AS will return 400 Bad Request error.</p> <p>Note that data returned by endpoint is calculated and depending on request can be expensive to recalculate each time. Thus data (response) is cached during one hour and is not refreshed during this period.</p> <p>Example: response when <code>format=jsonmonth</code></p> <pre><code>[ \n  {\n    \"month\": \"202108\",\n    \"montly_active_users\": 5,\n    \"token_count_per_granttype\": {\n       ...\n    }\n  },\n  {\n    \"month\": \"202109\",\n    \"montly_active_users\": 7,\n    \"token_count_per_granttype\": {\n       ...\n    }\n  }\n  ...\n]\n</code></pre>","tags":["administration","auth-server","reporting","metric"]},{"location":"janssen-server/auth-server/reporting-metrics/#monthly-active-users","title":"Monthly Active Users","text":"<p>Server uses algorithmic HLL approach of tracking active users. Means it is not exact number but approximation. MAU can be requested at <code>/jans-auth/restv1/internal/stat</code> protected endpoint and is returned per month in <code>YYYYMM</code> format for month.</p> <p>Example: 10 servers with 1000000 unique users with 10M total logins. log2m=15, regwidth = 5 <pre><code>server0 - size: 20483bytes, cardinality: 996522\nserver1 - size: 20483bytes, cardinality: 998560\nserver2 - size: 20483bytes, cardinality: 1001721\nserver3 - size: 20483bytes, cardinality: 988345\nserver4 - size: 20483bytes, cardinality: 998151\nserver5 - size: 20483bytes, cardinality: 1005606\nserver6 - size: 20483bytes, cardinality: 993774\nserver7 - size: 20483bytes, cardinality: 992465\nserver8 - size: 20483bytes, cardinality: 988403\nserver9 - size: 20483bytes, cardinality: 1002353\nUNION - size: 20483bytes, cardinality: 10010897\n</code></pre></p> <p>Example: MAU with no <code>format</code> parameter in request <pre><code>{\n  \"response\": {\n    \"202101\": {       \n      \"monthly_active_users\": 1939497078,\n      ...\n    },\n    \"202102\": {       \n          \"monthly_active_users\": 1939497078,\n          ...\n    },\n  }\n}      \n</code></pre></p>","tags":["administration","auth-server","reporting","metric"]},{"location":"janssen-server/auth-server/reporting-metrics/#health-check","title":"Health Check","text":"<p>AS provides <code>/sys/health-check</code> endpoint which can be used to perform health check.</p> <p>Sample reply <pre><code>{\n  \"status\": \"running\", \n  \"db_status\":\"online\"\n}\n</code></pre></p> <p>Sample curl <pre><code>curl -k https://janssen-host-name/jans-auth/sys/health-check\n</code></pre></p>","tags":["administration","auth-server","reporting","metric"]},{"location":"janssen-server/auth-server/reporting-metrics/#token-issued","title":"Token Issued","text":"<p>Token Issued report shows how many tokens were issued per grant type.</p> <p>Sample response from <code>/jans-auth/restv1/internal/stat</code> protected endpoint.</p> <pre><code>{\n  \"response\": {\n    \"202101\": {\n      \"monthly_active_users\": 1939497078,\n      \"token_count_per_granttype\": {\n        \"implicit\": {\n          \"access_token\": 8843443,\n          \"refresh_token\": 361678620,\n          \"uma_token\": 257653798,\n          \"id_token\": 1196937417\n        },\n        \"refresh_token\": {\n          \"access_token\": 198484847,\n          \"refresh_token\": 527458534,\n          \"uma_token\": 1552211159,\n          \"id_token\": 2077968838\n        },\n        \"password\": {\n          \"access_token\": 21293868,\n          \"refresh_token\": 2003904704,\n          \"uma_token\": 44144850,\n          \"id_token\": 1713870170\n        },\n        \"client_credentials\": {\n          \"access_token\": 1656091541,\n          \"refresh_token\": 875245682,\n          \"uma_token\": 1920358732,\n          \"id_token\": 2029924857\n        },\n        \"urn:ietf:params:oauth:grant-type:device_code\": {\n          \"access_token\": 871050693,\n          \"refresh_token\": 735390384,\n          \"uma_token\": 902227655,\n          \"id_token\": 572398177\n        },\n        \"authorization_code\": {\n          \"access_token\": 1468057290,\n          \"refresh_token\": 1576996227,\n          \"uma_token\": 1755565333,\n          \"id_token\": 944346498\n        },\n        \"urn:openid:params:grant-type:ciba\": {\n          \"access_token\": 1187334485,\n          \"refresh_token\": 1043290537,\n          \"uma_token\": 206572517,\n          \"id_token\": 1850166398\n        },\n        \"urn:ietf:params:oauth:grant-type:uma-ticket\": {\n          \"access_token\": 933970698,\n          \"refresh_token\": 1089756841,\n          \"uma_token\": 352343374,\n          \"id_token\": 645686974\n        }\n      }\n    },\n    \"202012\": {\n      \"monthly_active_users\": 1620607010,\n      \"token_count_per_granttype\": {\n        \"implicit\": {\n          \"access_token\": 20676511,\n          \"refresh_token\": 960308503,\n          \"uma_token\": 703633153,\n          \"id_token\": 573544490\n        },\n        \"refresh_token\": {\n          \"access_token\": 526463917,\n          \"refresh_token\": 483679318,\n          \"uma_token\": 545888615,\n          \"id_token\": 951286042\n        },\n        \"password\": {\n          \"access_token\": 1883167951,\n          \"refresh_token\": 1636169697,\n          \"uma_token\": 1753544837,\n          \"id_token\": 1675535757\n        },\n        \"client_credentials\": {\n          \"access_token\": 290209545,\n          \"refresh_token\": 1635984977,\n          \"uma_token\": 1066472511,\n          \"id_token\": 463520941\n        },\n        \"urn:ietf:params:oauth:grant-type:device_code\": {\n          \"access_token\": 84124820,\n          \"refresh_token\": 1705729386,\n          \"uma_token\": 2070635541,\n          \"id_token\": 970034925\n        },\n        \"authorization_code\": {\n          \"access_token\": 387026047,\n          \"refresh_token\": 907425179,\n          \"uma_token\": 370523863,\n          \"id_token\": 1807260512\n        },\n        \"urn:openid:params:grant-type:ciba\": {\n          \"access_token\": 1408098991,\n          \"refresh_token\": 819153423,\n          \"uma_token\": 936295536,\n          \"id_token\": 378210748\n        },\n        \"urn:ietf:params:oauth:grant-type:uma-ticket\": {\n          \"access_token\": 381038617,\n          \"refresh_token\": 828068056,\n          \"uma_token\": 448746427,\n          \"id_token\": 650520169\n        }\n      }\n    }\n  }\n}\n</code></pre>","tags":["administration","auth-server","reporting","metric"]},{"location":"janssen-server/auth-server/reporting-metrics/#audit-logs","title":"Audit logs","text":"<p>AS supports audit logs. Please check audit logs page</p> <p>It can help answer on questions like: - successful (<code>USER_AUTHORIZATION</code> with <code>isSuccess=true</code>) vs failed authentication (<code>USER_AUTHORIZATION</code> with <code>isSuccess=false</code>)  - client registration and update, etc. </p> <p>which can help track successful vs failed authenticatio Success vs Failed authentications</p>","tags":["administration","auth-server","reporting","metric"]},{"location":"janssen-server/auth-server/reporting-metrics/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>You can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","reporting","metric"]},{"location":"janssen-server/auth-server/reporting-metrics/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","reporting","metric"]},{"location":"janssen-server/auth-server/scopes/","title":"Scopes","text":"","tags":["administration","auth-server","scope"]},{"location":"janssen-server/auth-server/scopes/#scopes","title":"Scopes","text":"<p>Scopes defines width of authorization access. Scopes are associated with authorization and thus with client to limit what scopes can be granted within given client.</p> <p>Scopes are represented in AS persistence with <code>jansScope</code> object and can have following attributes:</p> <ul> <li><code>jansDefScope</code> - boolean value, specifies whether scope can be associated with client via Dynamic Client Registration (DCR) or not</li> <li><code>description</code> - string value, text description of the scope</li> <li><code>displayName</code> - string value, display name of the scope</li> <li><code>inum</code> - inum identified (which takes part in <code>dn</code> key)</li> <li><code>dn</code> - distinguished name (inum takes part in <code>dn</code>), unique identifier of the entry within persistence</li> <li><code>jansScopeTyp</code> - specified type of the scope and can have following values:</li> <li><code>oauth</code> - OAuth 2.0 Scopes for any of their API's. This scope type would only have a description, but no claims. Once a client obtains this token, it may be passed to the backend API (let's say the calendar API).</li> <li><code>openid</code> - Specify what access privileges are being requested for Access Tokens.  The scopes associated with Access Tokens determine what resources will be available when they are used to access OAuth 2.0 protected endpoints. For OpenID Connect, scopes can be used to request that specific sets of information be made available as Claim Values. OpenID Connect defines the following scope values that are used to request Claims:<ul> <li><code>profile</code> - This scope value requests access to the End-User's default profile Claims, which are: <code>name</code>, <code>family_name</code>, <code>given_name</code>, <code>middle_name</code>, <code>nickname</code>, <code>preferred_username</code>, <code>profile</code>, <code>picture</code>, <code>website</code>, <code>gender</code>, <code>birthdate</code>, <code>zoneinfo</code>, <code>locale</code>, and <code>updated_at</code>.</li> <li><code>email</code> - This scope value requests access to the <code>email</code> and <code>email_verified</code> Claims.</li> <li><code>address</code> - This scope value requests access to the address Claim.</li> <li><code>phone</code> - This scope value requests access to the <code>phone_number</code> and <code>phone_number_verified</code> Claims.   The Claims requested by the <code>profile</code>, <code>email</code>, <code>address</code>, and <code>phone</code> scope values are returned from the UserInfo Endpoint.</li> </ul> </li> <li><code>dynamic</code> - Dynamic scope calls scripts which add claims dynamically.</li> <li><code>uma</code> - UMA scopes</li> <li><code>spontaneous</code> - spontaneous scopes, scopes which are created temporary and match to some <code>regexp</code> pattern </li> <li><code>creatorId</code> - string value, specified creator id </li> <li><code>creatorTyp</code> - enum value, specifies type of the creator and can have following values: </li> <li><code>none</code> - creator type is unknown</li> <li><code>client</code> - scope created by client (e.g. spontaneous scope)</li> <li><code>user</code> - scope created by user</li> <li><code>auto</code> - scope automatically created by AS if it does not exist in persistence (currently used only in UMA case)</li> <li><code>creatorAttrs</code> - map which can hold creator attributes</li> <li><code>creationDate</code> - date value, specified creation date of the scope</li> <li><code>jansClaim</code> - string array, specified id of claims that belongs to this scope</li> <li><code>jansScrDn</code> - string array, specified dynamic scope scripts <code>dn</code>s. </li> <li><code>jansGrpClaims</code> - boolean value, specifies whether to group claims. </li> <li><code>jansId</code> - string value, id of the claims (used during authorization requests or elsewhere in request/response)</li> <li><code>jansIconUrl</code> - string values, specified icon url  </li> <li><code>jansUmaPolicyScrDn</code> - string array, specifies UMA policy scripts <code>dn</code>s  </li> <li><code>exp</code> - date value, specifies expired date</li> <li><code>del</code> - boolean value, specified whether scope is deletable and has to be cleaned up by AS. <code>false</code> by default, it is <code>true</code> for spontaneous scopes which has expiration time and has to be cleaned up.  </li> <li><code>jansAttrs</code> - other attributes of the scopes  </li> <li><code>spontaneousClientScopes</code> - string array, specifies client spontaneous scopes which allowed creation of this scope</li> <li><code>showInConfigurationEndpoint</code> - boolean values, specified whether to show scope in discovery page or not </li> </ul> <p>In AS code, scope object is represented with following java class</p>","tags":["administration","auth-server","scope"]},{"location":"janssen-server/auth-server/scopes/#dynamic-client-registration","title":"Dynamic Client Registration","text":"<p>To enabled scope for DCR please set <code>jansDefScope</code> to <code>true</code> value.</p> <p>Global AS Configuration for DCR - <code>dynamicRegistrationScopesParamEnabled</code> - boolean value specifying whether to enable scopes parameter in dynamic registration. - <code>dynamicRegistrationPasswordGrantTypeEnabled</code> - boolean value specifying whether to enable Password Grant Type during Dynamic Registration. Default value is <code>false</code>. - <code>dynamicRegistrationAllowedPasswordGrantScopes</code> - string array, list of grant scopes for dynamic registration</p>","tags":["administration","auth-server","scope"]},{"location":"janssen-server/auth-server/scopes/#customizing-scopes","title":"Customizing scopes","text":"<p>Similar to client registration, scopes can be customized using interception scripts.</p> <p>The sample dynamic scope script is available here.</p>","tags":["administration","auth-server","scope"]},{"location":"janssen-server/auth-server/scopes/#global-as-configuration","title":"Global AS Configuration","text":"<p>Global AS Configurations related to scopes.</p> <ul> <li><code>forceOfflineAccessScopeToEnableRefreshToken</code> - boolean value specifying whether force offline_access scope to enable refresh_token grant type. Default value is <code>true</code></li> <li><code>introspectionResponseScopesBackwardCompatibility</code> - boolean value specifying introspection response backward compatibility mode. Default value is <code>false</code>.</li> <li><code>introspectionAccessTokenMustHaveIntrospectionScope</code> - if True, rejects introspection requests if access_token does not have the 'introspection' scope in its authorization header. Comparing to 'uma_protection', 'introspection' scope is not allowed for dynamic registration'. Default value is <code>false</code>.</li> <li><code>umaAddScopesAutomatically</code> - add UMA scopes automatically if it is not registered yet</li> <li><code>umaGrantAccessIfNoPolicies</code> - specify whether to grant access to resources if there is no any policies associated with scopes. Default value is <code>false</code>.</li> <li><code>skipAuthorizationForOpenIdScopeAndPairwiseId</code> - choose whether to skip authorization if a client has an OpenId scope and a pairwise ID, Default value is <code>false</code>.</li> <li><code>activeSessionAuthorizationScope</code> - string value, specified authorization Scope for active session</li> <li><code>introspectionAccessTokenMustHaveUmaProtectionScope</code> - boolean value, if True, rejects introspection requests if access_token does not have the uma_protection scope in its authorization header. Default value is <code>false</code>.</li> <li><code>introspectionAccessTokenMustHaveIntrospectionScope</code> - boolean value, if True, rejects introspection requests if access_token does not have the 'introspection' scope in its authorization header. Comparing to 'uma_protection', 'introspection' scope is not allowed for dynamic registration'. Default value is <code>false</code>.</li> <li><code>openidScopeBackwardCompatibility</code> - boolean value, set to false to only allow token endpoint request for openid scope with grant type equals to authorization_code, restrict access to userinfo to scope openid and only return id_token if scope contains openid. Default value is <code>false</code>.</li> </ul>","tags":["administration","auth-server","scope"]},{"location":"janssen-server/auth-server/scopes/#spontaneous-scopes","title":"Spontaneous scopes","text":"<p>Spontaneous scopes are scopes with random part. AS supports both OpenID Connect and UMA Spontaneous scopes.</p> <p>Global AS Configuration for spontaneous scopes.</p> <ul> <li><code>allowSpontaneousScopes</code> - boolean value, specifies whether to allow spontaneous scopes</li> <li><code>spontaneousScopeLifetime</code> - the lifetime of spontaneous scope in seconds </li> </ul>","tags":["administration","auth-server","scope"]},{"location":"janssen-server/auth-server/scopes/#openid-connect-spontaneous-scopes","title":"OpenID Connect Spontaneous scopes","text":"<p>Spontaneous scopes are scopes with random part in it which are not known in advance. For example: <code>transaction:4685456787</code>, <code>pis-552fds</code> where <code>4685456787</code> or <code>552fds</code> are generated part of the scope.</p> <p>Spontaneous scopes are disabled by default and can be enabled per client. There are following client properties available during dynamic registration of the client related to spontaneous scopes:</p> <ul> <li><code>allow_spontaneous_scopes</code> - OPTIONAL, boolean, false by default. Whether spontaneous scopes are allowed for given client </li> <li><code>spontaneous_scopes</code> - OPTIONAL, array of strings. Regular expressions which should match to scope. If matched scope is allowed. Example: <code>[\"^transaction:.+$\"]</code>. It matches <code>transaction:245</code> but not <code>transaction:</code>.</li> </ul> <p>Dynamic registration example: <pre><code>...\n\"allow_spontaneous_scopes\": true,\n\"spontaneous_scopes\": [\"^transaction:.+$\"]\n...\n</code></pre></p> <p>Authorization request example (note <code>transaction:245</code> and <code>transaction:8645</code> scopes in request) <pre><code>https://example.gluu.org/oxauth/restv1/authorize?response_type=code&amp;scope=openid+profile+transaction%3A245+transaction%3A8645&amp;client_id=c8592b26-8984-484d-8aba-9f475be73af0&amp;redirect_uri=https%3A%2F%2Fexample.gluu.org%2Foxauth-rp%2Fhome.htm&amp;state=2dccaf64-c0b9-4c35-8008-f754ad964c3b&amp;nonce=9cf5c813-578b-44e5-a353-b7446c1b9358\n</code></pre></p> <p>If <code>allow_spontaneous_scopes=true</code> and <code>spontaneous_scopes</code> regular expression has match then spontaneous scope is persisted and allowed to be handled as usual scope. Spontaneous scope has lifetime and is cleaned up from persistence when expired (and thus not available anymore). Configuration property <code>spontaneousScopeLifetime</code> specifies lifetime in seconds.</p> <p>In addition there is spontaneous scope interception scripts which give additional flexibility. The sample spontaneous scope script is available here.</p>","tags":["administration","auth-server","scope"]},{"location":"janssen-server/auth-server/scopes/#uma-spontaneous-scopes","title":"UMA Spontaneous scopes","text":"<p>Sometimes it's required to handle scope by pattern. For example we wish to grant access for particular user based on path <pre><code>/user/1\n...\n/user/n\n</code></pre> In this case we can't register resources for each user since it is dynamic. If lets say we have 1 million users we don't want to register 1 million resources. It can be handled with spontaneous scopes which works via regular expressions.</p> <ol> <li>Allow spontaneous scopes for client via <code>allow_spontaneous_scopes</code> client property.</li> <li>Register resource with scope <code>^/user/.+$</code></li> <li>Register and assign UMA RPT Authorization Policies to <code>^/user/.+$</code> </li> <li>RS should sent explicit scope in permission during ticket registration, e.g. <code>/user/1</code> (AS validates whether <code>/user/1</code> matches regexp <code>^/user/.+$</code>). After validation AS persists <code>/user/1</code> scope and during RPT creation puts permission with explicit scope.</li> </ol> <p>In this way AS can validate and persist scopes dynamically. Spontaneous scopes have lifetime which is controlled by <code>spontaneousScopeLifetime</code> global oxauth configuration property.</p> <p>Ticket registration</p> <p>RS registers tickets with all scopes mentioned in \"data\" (we need all scopes in order to evaluate expression, all or nothing principle)</p> <pre><code>{  \n   \"resource_id\":\"112210f47de98100\",\n   \"resource_scopes\":[  \n       \"http://photoz.example.com/dev/actions/all\",\n       \"http://photoz.example.com/dev/actions/add\",\n       \"http://photoz.example.com/dev/actions/internalClient\"\n   ]\n}\n</code></pre>","tags":["administration","auth-server","scope"]},{"location":"janssen-server/auth-server/scopes/#uma-scopes","title":"UMA Scopes","text":"<p>UMA 2 scopes are used to grant a client permission to do an action on a protected resource. Different scopes can grant access to the same action. For example, a \"read\" action can be allowed with scope \"read\" or \"all\".</p> <p>Some actions require the Resource Server (RS) to request multiple scopes simultaneously. For instance, a \"read\" action should only be allowed if the authorization request includes the \"read\" and \"all\" scopes. UMA 2 scopes are bound to resources and are used to fetch policies that check whether the specified user or client should have access to the resource.</p> <p>The scopes are described in JSON and have the following properties:</p> <ul> <li>name</li> <li>icon_uri</li> </ul> <p>An example of the scope JSON is given below:</p> <pre><code>{\n  \"name\": \"Add photo\",\n  \"icon_uri\": \"https://&lt;hostname&gt;/icons/add_photo_scope.png\"\n}\n</code></pre> <p>Note</p> <p>The scope JSON may contain custom properties.</p> <p>The following is an example what an UMA 2 Scope URL may look like:</p> <pre><code>https://&lt;hostname&gt;/uma/scopes/view\n</code></pre> <p>Note</p> <p>The scope endpoint has to be present in UMA configuration to make it discoverable.</p> <p>The <code>ldif</code> for both an internal and external scope is given below:</p> <p>Sample ldif <pre><code>dn: inum=@!1111!8990!BF80,ou=scopes,ou=uma,o=@!1111,o=gluu\ndisplayName: View\ninum: @!1111!8990!BF80\nobjectClass: oxAuthUmaScopeDescription\nobjectClass: top\noxId: View\noxIconUrl: http://&lt;hostname&gt;/uma/icons/view_scope.png\n</code></pre></p>","tags":["administration","auth-server","scope"]},{"location":"janssen-server/auth-server/scopes/#uma-scope-expressions","title":"UMA Scope Expressions","text":"<p>UMA 2 Scope expressions is Gluu invented extension of UMA 2 which gives flexible way to combine scopes and thus propose more robust way to grant access.</p> <p>Register resource with <code>scope_expression</code></p> <p>RS registers resource</p> <p>Note</p> <pre><code>new `scope_expression` field, `resource_scopes` is ignored in this case\n</code></pre> <pre><code>{  \n   \"resource_scopes\":[],\n   \"description\":\"Collection of digital photographs\",\n   \"icon_uri\":\"http://www.example.com/icons/flower.png\",\n   \"name\":\"Photo Album\",\n   \"type\":\"http://www.example.com/rsrcs/photoalbum\",\n   \"scope_expression\": {\n      \"rule\": {\n         \"and\": [\n            {\n               \"or\": [\n                   {\"var\": 0},\n                   {\"var\": 1}\n               ]\n            },\n            {\"var\": 2}\n         ]\n      },\n      \"data\": [\n         \"http://photoz.example.com/dev/actions/all\",\n         \"http://photoz.example.com/dev/actions/add\",\n         \"http://photoz.example.com/dev/actions/internalClient\"\n      ]\n   }\n}\n</code></pre>","tags":["administration","auth-server","scope"]},{"location":"janssen-server/auth-server/scopes/#statistic-endpoint","title":"Statistic Endpoint","text":"<p>Global AS Configuration for statistic endpoint</p> <ul> <li><code>statAuthorizationScope</code> - scope required for Statistical Authorization. Default value is <code>jans_stat</code></li> </ul>","tags":["administration","auth-server","scope"]},{"location":"janssen-server/auth-server/scopes/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>You can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","scope"]},{"location":"janssen-server/auth-server/scopes/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","scope"]},{"location":"janssen-server/auth-server/session-management/","title":"Session Management","text":"<p>A session is a reference identifier on the Jans Auth Server that connects to a person's authentication state. During an authentication workflow, Auth Server writes a cookie with the <code>session_id</code> in the person's browser. OpenID Native SSO defines a way for mobile apps from the same vendor to use the iOS or Android protected secret storage to store the <code>session_id</code>. By correlating the session, the IDP can return an identity assertion (id_token) to a client without needing to re-authenticate the person. SSO ensues.</p> <p>For example, let's say a person uses a browser to navigate to the website of Relying Party (RP1), which redirects to Jans Auth Server for authentication. Once the person is authenticated, the OP creates a <code>session_id</code> cookie, sets the state to <code>authenticated</code>, and places it in the cache. If the person mavigates their browser to the website of RP2, it redirects to the OP for authentication; since the <code>session_id</code> detected via the cookie is already authenticated, the OP authenticates the person automatically for RP2 (without an authentication prompt).</p> <p>Jans Auth Server stores user session data in its cache. Auth Server performance retrieving the session will vary depending on whether the session is stored in memory, Redis, Memcached or the database, as controlled by the <code>cacheProviderType</code> Auth Server configuration property.</p> <p>The Auth Server session can have one of two states:</p> <ul> <li><code>unauthenticated</code> - a browser that has started, but not completed an authentication workflow.</li> <li><code>authenticated</code> - when a person has successfully authenticated</li> </ul> <p>The following Auth Server configuration properties are related to sessions:</p> <ul> <li>sessionIdCookieLifetime - The lifetime of <code>session_id</code> cookie in seconds. If 0 or -1 then expiration is not set. session_id cookie expires when browser session ends. Default value is <code>86400</code>.</li> <li>sessionIdLifetime - lifetime of the OP session in seconds (server side object). If not set, falls back to <code>session_id</code> cookie expiration set by <code>sessionIdCookieLifetime</code> configuration property.</li> <li>sessionIdUnusedLifetime - unused OP session lifetime in seconds. If an OP session is not used for a given amount of time, the OP session is removed. Default value is <code>86400</code>.</li> <li>sessionIdUnauthenticatedUnusedLifetime - lifetime in seconds of <code>unauthenticated</code> OP session. This determines how long the user can be on the login page while unauthenticated. Default value is <code>120</code>.</li> <li>sessionIdRequestParameterEnabled - Boolean value specifying whether to enable <code>session_id</code> HTTP request parameter. Default value is <code>False</code>.</li> <li>sessionIdPersistOnPromptNone - specifies whether to persist or update the session object with data if <code>prompt=none</code>. Default value is <code>True</code>.</li> <li>invalidateSessionCookiesAfterAuthorizationFlow - this is special property which specifies whether to invalidate <code>session_id</code> and <code>consent_session_id</code> cookies right after successful or unsuccessful authorization.</li> <li>changeSessionIdOnAuthentication - Using a different session after the user authenticates improves security. The default value is <code>True</code>.</li> <li>sessionIdPersistInCache - If True, sessions are stored according to <code>cacheProviderType</code>. Otherwise, sessions are persisted in the database.  Default value is <code>False</code>.</li> <li>sessionIdPersistInCache Default value is <code>False</code>.</li> </ul> <p>For both <code>unused</code> properties, Jans Auth Server calculates this period as <code>currentUnusedPeriod = now - session.lastUsedAt</code>. So for OP session with states:</p> <ul> <li><code>unauthenticated</code> - if <code>currentUnusedPeriod</code> &gt;= <code>sessionIdUnauthenticatedUnusedLifetime</code>, then the session object is removed.</li> <li><code>authenticated</code> - if <code>currentUnusedPeriod</code> &gt;= <code>sessionIdUnusedLifetime</code>, then the session object is removed.</li> </ul> <p>Jans Auth Server updates <code>lastUsedAt</code> property of the session object:</p> <ul> <li>During creation</li> <li>For each Auth Server authentication attempt (regardless of success)</li> </ul>","tags":["administration","auth-server","session"]},{"location":"janssen-server/auth-server/session-management/#killing-sessions","title":"Killing Sessions","text":"<p>The End Session endpoint (<code>/end_session</code>) is where the user can end their own session. See OpenID Logout for more information.</p> <p>To end another person's session, Jans Auth Server supports Global Token Revocation Endpoint (<code>/global-token-revocation</code>').</p>","tags":["administration","auth-server","session"]},{"location":"janssen-server/auth-server/session-management/#session-event-interception-scripts","title":"Session Event Interception Scripts","text":"<p>It is possible to add custom business logic as Jans Auth Server detects session events, see:</p> <ul> <li>Application Session</li> <li>End Session</li> </ul>","tags":["administration","auth-server","session"]},{"location":"janssen-server/auth-server/session-management/#session-data-structure-in-persistence","title":"Session data structure in Persistence","text":"","tags":["administration","auth-server","session"]},{"location":"janssen-server/auth-server/session-management/#mysql","title":"MySQL","text":"<p>All session information is saved in this table : https://github.com/JanssenProject/jans/blob/main/docs/admin/reference/database/mysql-schema.md#janssessid</p> <p>Follow this link for session management with configuration tools.</p>","tags":["administration","auth-server","session"]},{"location":"janssen-server/auth-server/session-management/#faq","title":"FAQ","text":"","tags":["administration","auth-server","session"]},{"location":"janssen-server/auth-server/session-management/#how-can-we-force-the-user-to-log-out-if-the-user-is-idle-on-the-rp-for-4-hours","title":"How can we force the user to log out if the user is idle on the RP for 4 hours?","text":"<p>The OP doesn't know anything about end-user activity on the RP. Therefore, the RP has to track activity internally, and when the inactivity period is reached (in this case, 4 hours) the RP should perform front-channel logout.</p>","tags":["administration","auth-server","session"]},{"location":"janssen-server/auth-server/session-management/#how-can-we-force-the-user-to-log-out-if-the-browser-is-closed","title":"How can we force the user to log out if the browser is closed?","text":"<p>Setting <code>sessionIdLifetime</code> to <code>-1</code> value sets the <code>session_id</code> cookie value to <code>expires=session</code>, and sets the OP session object to not have an expiration time. Most browsers clear cookies with <code>expires=session</code> when the browser is closed, removing the session object at that time. Javascript may be necessary to override undesirable default browser behavior.</p>","tags":["administration","auth-server","session"]},{"location":"janssen-server/auth-server/session-management/#can-we-have-a-single-session-across-multiple-browsers","title":"Can we have a single session across multiple browsers?","text":"<p>Unfortunately, each browser has its own session cookies, and therefore its own sessions.</p>","tags":["administration","auth-server","session"]},{"location":"janssen-server/auth-server/session-management/idp-v-rp/","title":"IDP versus RP session","text":"<p>Applications generally have their own session cookie (the \"RP Session\"). This makes sense, because the RP only redirects to the IDP for authentication if it cannot find its own local cookie. If a user has a session with many RP's, achieving simultaneous logout across all sites is a challenge--something which your business leaders may not appreciate. While OpenID proposes several solutions to logout, none are ideal. Fundamentally, logout is an asynchronous challenge. A given RP may be disconnected from the network. Thus logout messages sent to RP's that are not received must be replayed. The IETF Sec Events Workgroup has been working on standards to handle logout (and other asynchronous requirements). But adoption of this architecture is not common.</p> <p>Another challenge of RP sessions is that they may have a different timeout for inactivity. See the Janssen Planning Guide page on Timeout Management for more details.</p>","tags":["administration","auth-server","session"]},{"location":"janssen-server/auth-server/session-management/multiple-sessions-one-browser/","title":"Multiple Sessions","text":"","tags":["administration","auth-server","session","Account Chooser"]},{"location":"janssen-server/auth-server/session-management/multiple-sessions-one-browser/#select-account","title":"Select Account","text":"<p>A person may have several accounts on a single Jans Auth Server instance. For example, it is common to have several Gmail accounts. Jans Auth Server uses two cookies to track which accounts are associated with a browser: <code>session_id</code> and <code>current_sessions</code>.</p> <p>Below is an example or a person with two authenticated sessions:</p> <pre><code>session_id: de510ab6-b06c-4393-86d8-12a7c501aafe\ncurrent_sessions: [\"de510ab6-b06c-4393-86d8-12a7c501aafe\", \"c691e83d-eb1b-41f0-b453-fab905681b5b\"]\n</code></pre> <p>An RP can trigger Auth Server's built in Account Chooser feature by sending an OpenID Authentication Request with the parameter <code>prompt=select_account</code>. In this case, Auth Server renders the default page: <code>/opt/jans/jetty/jans-auth/custom/pages/selectAccount.xhtml</code></p> <p>This page iterates <code>current_sessions</code> and enables the person to login as a different account, for example:</p> <p></p> <p>You can override this page if you place a <code>selectAccount.xhtml</code> in <code>custom/pages</code>.</p>","tags":["administration","auth-server","session","Account Chooser"]},{"location":"janssen-server/auth-server/tokens/","title":"Tokens","text":"<p>Please use the left navigation menu to browse the content of this section while we are still working on developing content for <code>Overview</code> page.</p> <p>Contribute</p> <p>If you\u2019d like to contribute to this document, get started with the Contribution Guide</p>","tags":["administration","auth-server","token"]},{"location":"janssen-server/auth-server/tokens/logout-status-jwt/","title":"Logout Status JWT","text":"","tags":["administration","auth-server","logout-status-jwt"]},{"location":"janssen-server/auth-server/tokens/logout-status-jwt/#overview","title":"Overview","text":"<p>The Logout Status JWT is a compact, self-contained, purpose-built token that represents the state and validity of a user \"logged-in\" state.</p> <p>Logout Status JWT is returned from Authorization Endpoint and Authorization Challenge Endpoint by sending <code>logout_status_jwt=true</code> parameter in request. It is returned back upon successful authn&amp;authz (when <code>code</code> is returned).</p> <p>Janssen Server provides Token Status List endpoint to enable the client to query token status. Logout Status JWT state can be queries via Token Status List endpoint.</p>","tags":["administration","auth-server","logout-status-jwt"]},{"location":"janssen-server/auth-server/tokens/logout-status-jwt/#usage","title":"Usage","text":"<p>Logout Status JWT can be requested at Authorization Endpoint or Authorization Challenge Endpoint by providing additional parameter <code>logout_status_jwt=true</code>.</p> <p>Sample request (that requests Logout Status JWT)</p> <pre><code>https://janssen.server.host/jans-auth/restv1/authorize?response_type=code&amp;client_id=435636e1-c8cf-4b27-8ee3-d6121286f3dc&amp;scope=openid+profile+address+email+phone+user_name+revoke_any_token+global_token_revocation&amp;redirect_uri=https%3A%2F%2Fjanssen.server.host%2Fjans-auth-rp%2Fhome.htm&amp;state=172645ff-4887-4e97-9152-197efb1591d0&amp;nonce=85b2161e-7502-4619-8eaf-1caa4cf7bec0&amp;prompt=&amp;ui_locales=&amp;claims_locales=&amp;acr_values=&amp;request_session_id=false&amp;logout_status_jwt=true\n</code></pre> <p>After successful authentication and authorization AS returns back also Logout Status JWT.</p> <p>Sample response <pre><code>HTTP/1.1 302 Found\nLocation: https://janssen.server.host/jans-auth-rp/home.htm?code=03cb499b-a6fb-4ac1-b406-051baf7278cc&amp;scope=openid+revoke_any_token+global_token_revocation&amp;logout_status_jwt=eyJraWQiOiJjb25uZWN0XzA3ZjQ3ZmRkLTg0NTYtNDMzOC1iYTRmLWNhNmU0NDBmYjljOV9zaWdfcnMyNTYiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiI0MzU2MzZlMS1jOGNmLTRiMjctOGVlMy1kNjEyMTI4NmYzZGMiLCJuYmYiOjE3NDkyMjUwMzgsInN0YXR1c19saXN0Ijp7ImlkeCI6ODEsInVyaSI6Imh0dHBzOi8veXVyaXl6LWludGVybmFsLWphZ3Vhci5nbHV1LmluZm8vamFucy1hdXRoL3Jlc3R2MS9zdGF0dXNfbGlzdCJ9LCJpc3MiOiJodHRwczovL3l1cml5ei1pbnRlcm5hbC1qYWd1YXIuZ2x1dS5pbmZvIiwiZXhwIjoxNzQ5MzExNDM4LCJpYXQiOjE3NDkyMjUwMzgsImp0aSI6ImZmOWFkMzEyLWRmODgtNGJkOS04ODhlLWJhNTk1NDNlNmE4MCJ9.eIHpiFoc7tp4Yin52cje7u8vNsnojcpurKWel2pGOKcWkjZw2f3Ioyhpe0nacNiA8tJDV11B6i_S49q4X4TTFjoY-oR7bfbXMhKe64L1Km71qP240rfsppcxbpVccRjvwFpX3ZSrvq1yWaxY4E8UoiRS168JtXGBlvZ1Hr89GoUVEdsTmowITRbSCQK2s7ENsD53P9M0--mag3YFAA9LTvQqfWtD1fhqoqpC9Hm4rEnO6VgTbI0tCuKIB1ncnMU30gH_PrKY53Z_n3NEYF_BdwkejcHE6mGybAtlTEXGqVSt5FQFUKIvsJM8kW6mK_XGsIhFNu49T70oPEs5ZSD2Zg&amp;state=172645ff-4887-4e97-9152-197efb1591d0&amp;session_state=f71764d3f7f2280ecbfe170a5c0dd51b3e20769c7deadaee1bda8eb8d2df0f8f.3281229a-0118-4037-895b-43aed75ad2f8\n</code></pre></p> <p>Encoded Logout Status JWT example <pre><code>eyJraWQiOiJjb25uZWN0XzA3ZjQ3ZmRkLTg0NTYtNDMzOC1iYTRmLWNhNmU0NDBmYjljOV9zaWdfcnMyNTYiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiI0MzU2MzZlMS1jOGNmLTRiMjctOGVlMy1kNjEyMTI4NmYzZGMiLCJuYmYiOjE3NDkyMjUwMzgsInN0YXR1c19saXN0Ijp7ImlkeCI6ODEsInVyaSI6Imh0dHBzOi8veXVyaXl6LWludGVybmFsLWphZ3Vhci5nbHV1LmluZm8vamFucy1hdXRoL3Jlc3R2MS9zdGF0dXNfbGlzdCJ9LCJpc3MiOiJodHRwczovL3l1cml5ei1pbnRlcm5hbC1qYWd1YXIuZ2x1dS5pbmZvIiwiZXhwIjoxNzQ5MzExNDM4LCJpYXQiOjE3NDkyMjUwMzgsImp0aSI6ImZmOWFkMzEyLWRmODgtNGJkOS04ODhlLWJhNTk1NDNlNmE4MCJ9.eIHpiFoc7tp4Yin52cje7u8vNsnojcpurKWel2pGOKcWkjZw2f3Ioyhpe0nacNiA8tJDV11B6i_S49q4X4TTFjoY-oR7bfbXMhKe64L1Km71qP240rfsppcxbpVccRjvwFpX3ZSrvq1yWaxY4E8UoiRS168JtXGBlvZ1Hr89GoUVEdsTmowITRbSCQK2s7ENsD53P9M0--mag3YFAA9LTvQqfWtD1fhqoqpC9Hm4rEnO6VgTbI0tCuKIB1ncnMU30gH_PrKY53Z_n3NEYF_BdwkejcHE6mGybAtlTEXGqVSt5FQFUKIvsJM8kW6mK_XGsIhFNu49T70oPEs5ZSD2Zg\n</code></pre></p> <p>Decoded payload of Logout Status JWT</p> <pre><code>{\n  \"aud\": \"435636e1-c8cf-4b27-8ee3-d6121286f3dc\",\n  \"nbf\": 1749225038,\n  \"status_list\": {\n    \"idx\": 81,\n    \"uri\": \"https://janssen.server.host/jans-auth/restv1/status_list\"\n  },\n  \"iss\": \"https://janssen.server.host\",\n  \"exp\": 1749311438,\n  \"iat\": 1749225038,\n  \"jti\": \"ff9ad312-df88-4bd9-888e-ba59543e6a80\"\n}\n</code></pre> <p>Claims - idx - index in token status list - exp - expiration date of the Logout Status Token</p> <p>When RP receives Logout Status JWT and it can query Token Status List to get Logout Status JWT status at any time.</p> <p>Sample status list request <pre><code>POST /jans-auth/restv1/status_list\nAccept: application/statuslist+json\n</code></pre></p> <p>Sample status list response <pre><code>{\n  \"sub\": \"https://janssen.server.host/jans-auth/restv1/status_list\",\n  \"nbf\": 1747049562,\n  \"status_list\": {\n    \"bits\": 2,\n    \"lst\": \"eNpjZRipgBEABeMABw\"\n  },\n  \"iss\": \"https://janssen.server.host\",\n  \"exp\": 1747050162,\n  \"iat\": 1747049562,\n  \"ttl\": 600\n}\n</code></pre></p> <p>lst contains encoded status list. Status list has encoded statuses based on Token Status List spec.</p> <p>Important Logout Status JWT specifies <code>exp</code> which means that token must be considered expired when this time is reached independently from Token Status List response. If Token Status List has <code>INVALID</code> (<code>1</code> - at <code>idx</code> index for 2 bits) then RP must consider Logout Status JWT as invalid.</p>","tags":["administration","auth-server","logout-status-jwt"]},{"location":"janssen-server/auth-server/tokens/logout-status-jwt/#disabling-logout-status-jwt-using-feature-flag","title":"Disabling Logout Status JWT Using Feature Flag","text":"<p><code>Logout Status JWT</code> can be enabled or disable using logout_status_jwt feature flag. Use Janssen Text-based UI(TUI) or Janssen command-line interface to perform this task.</p> <p>When using TUI, navigate via <code>Auth Server</code>-&gt;<code>Properties</code>-&gt;<code>enabledFeatureFlags</code> to screen below. From here, enable or disable <code>logout_status_jwt</code> flag as required.</p> <p></p>","tags":["administration","auth-server","logout-status-jwt"]},{"location":"janssen-server/auth-server/tokens/logout-status-jwt/#revoking","title":"Revoking","text":"<p>Logout Status JWT can be revoked: - via standard Revocation Endpoint by providing full token (<code>/revoke</code> and form parameters <code>token_type_hint=logout_status_jwt&amp;token=&lt;logout status jwt&gt;</code>) - via standard Revocation Endpoint by providing jti (<code>/revoke</code> and form parameters <code>token_type_hint=jti&amp;token=&lt;jti from logout status jwt&gt;</code>) - via Global Token Revocation Endpoint</p> <p>After revocation token status is changed in Token Status List (<code>VALID</code> -&gt; <code>INVALID</code>)</p>","tags":["administration","auth-server","logout-status-jwt"]},{"location":"janssen-server/auth-server/tokens/logout-status-jwt/#configuration","title":"Configuration","text":"<ul> <li><code>logoutStatusJwtLifetime</code> - The lifetime of Logout Status JWT. If not set falls back to 1 day</li> <li><code>logoutStatusJwtSigningAlgValuesSupported</code> - This JSON Array lists which JWS signing algorithms (alg values) [JWA] can be used by for the Logout Status JWT at Authorization Endpoint to encode the claims in a JWT </li> <li><code>logout_status_jwt</code> value within <code>featureFlags</code> to enable/disable Logout Status JWT.</li> </ul>","tags":["administration","auth-server","logout-status-jwt"]},{"location":"janssen-server/auth-server/tokens/logout-status-jwt/#references","title":"References","text":"<ul> <li>Token Status List spec</li> </ul>","tags":["administration","auth-server","logout-status-jwt"]},{"location":"janssen-server/auth-server/tokens/oauth-access-tokens/","title":"Access Tokens","text":"","tags":["administration","auth-server","oauth","access-token"]},{"location":"janssen-server/auth-server/tokens/oauth-access-tokens/#oauth-access-token","title":"OAuth Access Token","text":"","tags":["administration","auth-server","oauth","access-token"]},{"location":"janssen-server/auth-server/tokens/oauth-access-tokens/#background","title":"Background","text":"<p>When a software client calls an OAuth protected API, an access token is presented in the HTTP Authorization header of the request. Following is an example of a bearer token:</p> <pre><code>Authorization: Bearer 8pkjyj0gxhwh6ux2\n</code></pre> <p>OAuth access tokens come in two main types: bearer tokens and MAC tokens.</p> <p>Bearer tokens are the most commonly used type of access token. They are simply a string that is included in the Authorization header of an HTTP request. The client presents the token to the resource server, which can trust the token, by validating it was issued by a trusted authorization server. Bearer tokens can be sent either by value or reference. A value token is a JWT, signed by the authorization server. By calling Auth Server's [introspection endpoint], the client can trade the reference token for the plain JSON object.</p> <p>MAC tokens, are cryptographically signed tokens that include a nonce, timestamp, and other information to prevent replay attacks. They are typically used in situations where the client and the resource server are not able to securely share a secret. They are not commonly used and Janssen Auth Server does not support MAC tokens.</p> <p>There are several security considerations that both mobile developers and API developers should be aware of when working with OAuth access tokens. For mobile developers, it is important to ensure that the access token is stored securely on the device, and that it is not exposed to other apps or processes. API developers should ensure that their API is only accessible to clients that have a valid access token, and that the API properly validates the token before allowing access to the protected resource.</p> <p>Scopes are used in OAuth access tokens to limit the extent of access of a token, i.e. the specific resources and actions that the token is valid for. Scopes are typically defined by the API developer, and the client can request a specific scope when requesting an access token from the authorization server. This allows the API developer to fine-tune the level of access that different clients have to the API.</p> <p>Other security considerations for OAuth access tokens include the need to protect against replay attacks by including a nonce and timestamp in the token and using TLS for all communication between the client, the authorization server and the resource server.</p> <p>It is also important to rotate the access token. This can be done by using short lived tokens and refresh tokens which will allow the client to obtain a new access token without re-prompting the user for their credentials. By default, Jans Auth Server access tokens expire after 5 minutes.</p>","tags":["administration","auth-server","oauth","access-token"]},{"location":"janssen-server/auth-server/tokens/oauth-access-tokens/#access-token-schema","title":"Access Token Schema","text":"claim Description <code>active</code> <code>true</code> or <code>false</code>. <code>iss</code> The URI of the issuer authorization server <code>aud</code> The audience, used by the client to verify it is the correct recipient. During registration, the client can specify <code>additional_audience</code> values <code>iat</code> When the client was issued, in seconds, e.g. 1514797822 <code>exp</code> When the token expires, in seconds, e.g. 1514797942 <code>scope</code> A space delimited list of scopes <code>client_id</code> Recipient of the token <code>nbf</code> Not before, which insures the token is only valid within a certain time window <code>cnf</code> Confirmation, used for TLS client certificate bound tokens <p>It is possible to add additional claims to an access token via the Auth Server interception scripts. The preferred script is the update token script. You can also use the introspection script.</p>","tags":["administration","auth-server","oauth","access-token"]},{"location":"janssen-server/auth-server/tokens/oauth-access-tokens/#access-token-crypto-jwt","title":"Access Token Crypto (JWT)","text":"<p>JWT access tokens are signed by Jans Auth Server using algorithms specified in the <code>access_token_signing_alg_values_supported</code> claim of the OpenID configuration endpoint response. Access tokens are signed with the standard OpenID signing key.</p> <p>Jans Auth Server supports TLS client certificate bound access tokens. After a successful mutual TLS client authentication, Jans Auth Server encodes the client certificate thumbprint (hash) in <code>x5t#S256</code> confirmation method of the JWT or introspection JSON. Assuming the client uses the same certificate to establish a mutual TLS session with the API, the thumbprint in the access token can verify that this is the same client that obtained the access token. This feature is typically used in high security environments, as the operational cost of mutual TLS is material.</p> <p>Decoded JWT example <pre><code>{\n  \"iss\": \"https://server.example.com\",\n  \"sub\": \"ty.webb@example.com\",\n  \"exp\": 1493726400,\n  \"nbf\": 1493722800,\n  \"cnf\":{\n    \"x5t#S256\": \"bwcK0esc3ACC3DB2Y5_lESsXE8o9ltc05O89jdN-dg2\"\n  }\n}\n</code></pre></p> <p>Sample introspection response <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n\n{\n  \"active\": true,\n  \"iss\": \"https://server.example.com\",\n  \"sub\": \"ty.webb@example.com\",\n  \"exp\": 1493726400,\n  \"nbf\": 1493722800,\n  \"cnf\":{\n    \"x5t#S256\": \"bwcK0esc3ACC3DB2Y5_lESsXE8o9ltc05O89jdN-dg2\"\n  }\n}\n</code></pre></p>","tags":["administration","auth-server","oauth","access-token"]},{"location":"janssen-server/auth-server/tokens/oauth-access-tokens/#server-and-client-configurations","title":"Server and Client configurations","text":"<p>Access token lifetime is configurable at the server level via the <code>accessTokenLifetime</code> property. However, a client can override this value during client registration with the <code>access_token_lifetime</code> request parameter.</p>","tags":["administration","auth-server","oauth","access-token"]},{"location":"janssen-server/auth-server/tokens/oauth-access-tokens/#revoke-access-token","title":"Revoke Access Token","text":"<p>Access token can be revoked via Revoke Endpoint</p>","tags":["administration","auth-server","oauth","access-token"]},{"location":"janssen-server/auth-server/tokens/oauth-refresh-tokens/","title":"OAuth Refresh Token","text":"","tags":["administration","auth-server","oauth","refresh-token"]},{"location":"janssen-server/auth-server/tokens/oauth-refresh-tokens/#background","title":"Background","text":"<p>Refresh tokens are an optimization that allows a client to renew an access token without having to re-authenticate. You should not issue a refresh token to untrusted clients, i.e. public clients.</p>","tags":["administration","auth-server","oauth","refresh-token"]},{"location":"janssen-server/auth-server/tokens/oauth-refresh-tokens/#server-properties","title":"Server properties.","text":"<p><code>refreshTokenLifetime</code> : Default: 14400 minutes - With this property, you can specify a longer lifetime then 5 days. Using the Jans Config API, you can set a client-specific refresh token lifetime.</p> <p><code>forceOfflineAccessScopeToEnableRefreshToken</code> : Default: True - A good practice is for Auth Server to explicitly ask the subject to consent to the use of refresh tokens. To encourage this practice, by default, Auth Server requires that the client have the <code>offline_access</code> scope to issue a refresh token.</p> <p><code>persistRefreshToken</code> : Default: True - Otherwise they are written to the cache</p> <p><code>clientRegDefaultToCodeFlowWithRefresh</code> : Default: True - Set to False if you don't want web clients to get a refresh token.</p> <p><code>removeRefreshTokensForClientOnLogout</code> : Default: True - Boolean value specifying whether to remove Refresh Tokens on logout. However if intention is to leave Refresh Token after logout, it's required to set it to <code>false</code>.</p> <p><code>skipRefreshTokenDuringRefreshing</code> : Default: False - Boolean value specifying whether to skip refreshing tokens on refreshing. By default AS always creates new Refresh Token on refresh call to Token Endpoint. This property allows to avoid (skip) new Refresh Token creation.</p> <p><code>refreshTokenExtendLifetimeOnRotation</code> : Default: False - Boolean value specifying whether to extend refresh tokens on rotation. By default lifetime is not extended, expiration date is set to date of previous Refresh Token. With this property it's possible to have all further Refresh Token have fixed (extended in relation to previous Refresh Token) lifetime.</p> <p><code>checkUserPresenceOnRefreshToken</code> : Default: False - Check whether user exists and is active before creating RefreshToken. Set it to true if check is needed(Default value is false - don't check.</p>","tags":["administration","auth-server","oauth","refresh-token"]},{"location":"janssen-server/auth-server/tokens/oauth-refresh-tokens/#refresh-token-management","title":"Refresh Token Management","text":"<p>To revoke a token, a client can do so via the revocation endpoint (including revocation of all tokens by <code>client_id</code>).</p>","tags":["administration","auth-server","oauth","refresh-token"]},{"location":"janssen-server/auth-server/tokens/oauth-refresh-tokens/#online_access-scope","title":"online_access scope","text":"<p>If <code>online_access</code> scope is present then refresh token expires when the session ends (for example via front channel logout).</p>","tags":["administration","auth-server","oauth","refresh-token"]},{"location":"janssen-server/auth-server/tokens/oauth-tx-tokens/","title":"OAuth Transaction Token","text":"","tags":["administration","auth-server","oauth","access-token","tx-token"]},{"location":"janssen-server/auth-server/tokens/oauth-tx-tokens/#background","title":"Background","text":"<p>Transaction Tokens (Txn-Tokens) enable workloads in a trusted domain to ensure that user identity and authorization context of an external programmatic request, such as an API invocation, are preserved and available to all workloads that are invoked as part of processing such a request.  Txn-Tokens also enable workloads within the trusted domain to optionally immutably assert to downstream workloads that they were invoked in the call chain of the request.</p> <p>Txn-Tokens are short-lived, signed JWTs that assert the identity of a user or a workload and assert an authorization context. The authorization context provides information expected to remain constant during the execution of a call as it passes through multiple workloads.</p> <p>Transaction Tokens spec</p>","tags":["administration","auth-server","oauth","access-token","tx-token"]},{"location":"janssen-server/auth-server/tokens/oauth-tx-tokens/#transaction-token-jwt","title":"Transaction Token JWT","text":"<p>Sample header</p> <pre><code>{\n   \"typ\": \"N_A\",\n   \"alg\": \"RS256\",\n   \"kid\": \"identifier-to-key\"\n}\n</code></pre> <p>Sample payload</p> <ul> <li>iss - a URN [RFC8141] that uniquely       identifies the workload or the Txn-Token Service that created the       Txn-Token.      </li> <li>iat - the time at which the Txn-Token was created.</li> <li>aud - a URN [RFC8141] that uniquely       identifies the audience of the Txn-Token.  This MUST identify the       trust domain in which the Txn-Token is used.</li> <li>exp - the time at which the Txn-Token expires.</li> <li>txn - the unique transaction identifier as       defined in Section 2.2 of [RFC8417].  When used in the transaction       token, it identifies the entire call chain.</li> <li>purp - a string defining the purpose or intent of this transaction      </li> <li>sub - the unique identifier of the user       or workload on whose behalf the call chain is being executed.  The       format of this claim MAY be a Subject Identifier.</li> <li>azd - a JSON object that contains values that remain constant in the call chain.</li> <li>rctx - a JSON object that describes the environmental context of the requested transaction.</li> </ul> <pre><code>{\n  \"aud\": [\n    \"d60f21b7-b6dd-4140-b228-e6be099bc3ce\",\n    \"http://trusted.com\"\n  ],\n  \"rctx\": {\n    \"req_ip\": \"69.151.72.123\"\n  },\n  \"purp\": \"tx_token\",\n  \"sub\": \"3245675432\",\n  \"iss\": \"https://yuriyz-adjusted-coyote.gluu.info\",\n  \"azd\": {\n    \"client_id\": \"d60f21b7-b6dd-4140-b228-e6be099bc3ce\"\n  },\n  \"txn\": \"080c8f19-d9ee-4a26-852d-32e4fdc6ff6c\",\n  \"exp\": 1705054542,\n  \"iat\": 1705054362\n}\n</code></pre>","tags":["administration","auth-server","oauth","access-token","tx-token"]},{"location":"janssen-server/auth-server/tokens/oauth-tx-tokens/#transaction-token-obtainreplace","title":"Transaction Token Obtain/Replace","text":"<p>Transaction Tokens can be obtained at Token Endpoint</p> <p>Sample request</p> <pre><code>POST /jans-auth/restv1/token HTTP/1.1\nHost: yuriyz-adjusted-coyote.gluu.info\nContent-Type: application/x-www-form-urlencoded\n\ngrant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Atoken-exchange&amp;audience=http%3A%2F%2Ftrusted.com&amp;subject_token=5fb696ac-638a-4dbf-81cd-27daeb61caf9&amp;subject_token_type=urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token&amp;requested_token_type=urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Atxn_token&amp;rctx=%7B%22req_ip%22%3A%2269.151.72.123%22%7D\n</code></pre> <p>Sample response <pre><code>HTTP/1.1 200\nCache-Control: no-store\nConnection: Keep-Alive\nContent-Length: 980\nContent-Type: application/json\nDate: Fri, 12 Jan 2024 10:12:40 GMT\nKeep-Alive: timeout=5, max=100\nPragma: no-cache\nSet-Cookie: X-Correlation-Id=a348acce-d9c1-424a-af83-e4d75f7f3368; Secure; HttpOnly;HttpOnly\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nX-Content-Type-Options: nosniff\nX-Xss-Protection: 1; mode=block\n\n{\"access_token\":\"eyJraWQiOiJjb25uZWN0XzBlZGMxOTIyLTk1MjAtNDFkNi1iZGMyLTk3ZjdmYWMwMzRkMl9zaWdfcnMyNTYiLCJ0eXAiOiJqd3QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOlsiZDYwZjIxYjctYjZkZC00MTQwLWIyMjgtZTZiZTA5OWJjM2NlIiwiaHR0cDovL3RydXN0ZWQuY29tIl0sInJlcV9jdHgiOnsicmVxX2lwIjoiNjkuMTUxLjcyLjEyMyJ9LCJzdWJfaWQiOiIiLCJpc3MiOiJodHRwczovL3l1cml5ei1hZGp1c3RlZC1jb3lvdGUuZ2x1dS5pbmZvIiwiYXpkIjp7ImNsaWVudF9pZCI6ImQ2MGYyMWI3LWI2ZGQtNDE0MC1iMjI4LWU2YmUwOTliYzNjZSJ9LCJ0eG4iOiIwODBjOGYxOS1kOWVlLTRhMjYtODUyZC0zMmU0ZmRjNmZmNmMiLCJleHAiOjE3MDUwNTQ1NDIsImlhdCI6MTcwNTA1NDM2Mn0.fpPFZpzxitbLw71RgO3O8uSOHJARp16H2THO4YAimJKWiczSE8-DvUAqulEW2nCNN3PRdojXWCe4ipxPSr_0ugLSFWhFKdpLmQqec_udhcV-UWiuGPLfq0XeKte60ESSvj5jgpaBNaaGS2vmFeSLdGrAx1CY2EH06OYrttOrgFFGqMhLJJ1Cpacqa0vmXnHi9gbrS-FIf2_4nNkQKMitQ-m-ec-0J02RjgkEL9zrzFwYNAoE1HEIZNFBhh7GqBejH0cXnR2tBOOz66z83SLqMTAZ-WyaMxmITHGLGLmHZOGyHdiIYME1rLXalrK58XHesMFtB-gae10Ey6w1OIgiAg\",\"issued_token_type\":\"urn:ietf:params:oauth:token-type:txn_token\",\"token_type\":\"N_A\"}\n</code></pre></p> <p>Decoded transaction token JWT <pre><code>{\n  \"aud\": [\n    \"d60f21b7-b6dd-4140-b228-e6be099bc3ce\",\n    \"http://trusted.com\"\n  ],\n  \"rctx\": {\n    \"req_ip\": \"69.151.72.123\"\n  },\n  \"purp\": \"tx_token\",\n  \"sub_id\": \"\",\n  \"iss\": \"https://yuriyz-adjusted-coyote.gluu.info\",\n  \"azd\": {\n    \"client_id\": \"d60f21b7-b6dd-4140-b228-e6be099bc3ce\"\n  },\n  \"txn\": \"080c8f19-d9ee-4a26-852d-32e4fdc6ff6c\",\n  \"exp\": 1705054542,\n  \"iat\": 1705054362\n}\n</code></pre></p> <p>Replacement looks exactly the same with one different that <code>subject_token</code> must have previously obtained transaction token (not regular <code>access_token</code>).</p> <ul> <li>View full obtain execution log here</li> <li>View full replace execution log here</li> </ul>","tags":["administration","auth-server","oauth","access-token","tx-token"]},{"location":"janssen-server/auth-server/tokens/oauth-tx-tokens/#txtoken-custom-script","title":"TxToken custom script","text":"<p>Custom script allows to modify TxToken JWT payload claim, response or lifetime.</p> <p>The TxTokenType interception script extends the base script type with the <code>init</code>, <code>destroy</code> and <code>getApiVersion</code> methods:</p> Inherited Methods Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10 <p>The <code>configurationAttributes</code> parameter is <code>java.util.Map&lt;String, SimpleCustomProperty&gt;</code>.</p> <p>The TxTokenType interception script also adds the following method(s):</p> Method Method description <code>def getTxTokenLifetimeInSeconds(self, context)</code> Used to modify Tx Token lifetime in seconds.  <code>context</code> is <code>io.jans.as.server.service.external.context.ExternalScriptContext</code> <code>def modifyTokenPayload(self, jsonWebResponse, context)</code> Used to modify TxToken object before it is persisted.  <code>jsonWebResponse</code> is <code>io.jans.as.model.token.JsonWebResponse</code> <code>context</code> is <code>io.jans.as.server.service.external.context.ExternalScriptContext</code> <code>def modifyResponse(self, response, context)</code> Used to modify response from <code>/token</code> endpoint for transaction tokens.   <code>response</code> is <code>org.json.JSONObject</code> <code>context</code> is <code>io.jans.as.server.service.external.context.ExternalScriptContext</code> <pre><code>import io.jans.as.model.token.JsonWebResponse;\nimport io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.token.TxTokenType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.json.JSONObject;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\n\npublic class TxToken implements TxTokenType {\n\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    /**\n     *\n     * @param context context refers to io.jans.as.server.service.external.context.ExternalScriptContext\n     * @return lifetime of tx_token in seconds. It must be more than 0 or otherwise it will be ignored by server.\n     */\n    @Override\n    public int getTxTokenLifetimeInSeconds(Object context) {\n        boolean condition = false; // under some condition return 1 day lifetime\n        if (condition) {\n            return 86400;\n        }\n        return 0;\n    }\n\n    /**\n     *\n     * @param jsonWebResponse refers to io.jans.as.model.token.JsonWebResponse\n     * @param context refers to io.jans.as.server.service.external.context.ExternalScriptContext\n     * @return true if tx_token should be created or false to forbid tx_token creation.\n     */\n    @Override\n    public boolean modifyTokenPayload(Object jsonWebResponse, Object context) {\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n        JsonWebResponse jwr = (JsonWebResponse) jsonWebResponse;\n        jwr.getClaims().setClaim(\"custom_claim\", \"custom_value\");\n\n        return true;\n    }\n\n    /**\n     * @param responseAsJsonObject - response represented by org.json.JSONObject\n     * @param context              - script context represented by io.jans.as.server.service.external.context.ExternalScriptContext\n     * @return true if changes must be applied to final response or false if whatever made in this method has to be cancelled\n     */\n    @Override\n    public boolean modifyResponse(Object responseAsJsonObject, Object context) {\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n\n        JSONObject json = (JSONObject) responseAsJsonObject;\n        json.accumulate(\"custom_key\", \"custom_value\");\n        return true;\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized TxToken Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized TxToken Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed TxToken Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n}\n</code></pre>","tags":["administration","auth-server","oauth","access-token","tx-token"]},{"location":"janssen-server/auth-server/tokens/oauth-tx-tokens/#references","title":"References","text":"<ul> <li>Transaction Tokens spec</li> </ul>","tags":["administration","auth-server","oauth","access-token","tx-token"]},{"location":"janssen-server/auth-server/tokens/openid-id-token/","title":"OpenID id_token","text":"","tags":["administration","auth-server","token","id token","customize id_token"]},{"location":"janssen-server/auth-server/tokens/openid-id-token/#openid-connect-id-token","title":"OpenID Connect ID Token","text":"<p>Defined in Section 2 of <code>OpenID Connect Core 1.0</code>:</p> <p>The primary extension that OpenID Connect makes to OAuth 2.0 to enable End-Users to be Authenticated is the ID Token data structure. The ID Token is a security token that contains Claims about the Authentication of an End-User by an Authorization Server when using a Client, and potentially other requested Claims. The ID Token is represented as a JSON Web Token (JWT) [JWT].</p> <p>The ID Token is similar to a SAML 2.0 Assertion, which must contain an Authentication statement, and may optionally contain an Attribute statement, defined in the spec as:</p> <ul> <li> <p>Authentication statements: These are created by the party that successfully authenticated a user. At a minimum, they describe the particular means used to authenticate the user and the specific time at which the authentication took place.</p> </li> <li> <p>Attribute statements: These contain specific identifying attributes about the subject (for example, that user \u201cJohn Doe\u201d has \u201cGold\u201d card status).</p> </li> </ul> <p>The ID Token is a standard JWT, and can use signing and encryption depending on the configuration preferences of the client. A sample payload for a Jans Auth Server <code>id_token</code> is below:</p> <pre><code>{\n  \"iss\": \"https://idp.example.tld\",                 &lt;-- OP hostname\n  \"aud\": \"bd0469f7-f80a-4595-bd52-df9826f0a2f4\",    &lt;-- client_id  \n  \"sub\": \"0a9ca356-6130-4032-91c6-a2dfe4e19804\",    &lt;-- in this case, a pairwise identifer\n  \"iat\": 1672373703,                                &lt;-- issued at\n  \"auth_time\": 1672373700,                          &lt;-- when user authenticated\n  \"acr\": \"basic\",                                   &lt;-- how user authenticated\n  \"amr\": [\"10\"],                                    &lt;-- Extra authn details\n  \"nonce\": \"1u0y3ii\",                               &lt;-- client should verify\n  \"sid\": \"5f01565c-f2dc-4b4b-af8a-ab1578a5dbe3\",    &lt;-- session id handle\n  \"jansOpenIDConnectVersion\": \"openidconnect-1.0\"   &lt;-- OpenID version\n}\n</code></pre> <p>A great tool if you want to decode a JWT is Auth0's https://jwt.io/.</p> <p>Notice that a basic ID Token, like the one above, contains details about the authentication event, not user claims. You can configure the client to \"include claims in id_token\", or you can set a Auth Server configuration property, <code>legacyIdTokenClaims</code> to <code>True</code> to set the behavior for all clients.</p>","tags":["administration","auth-server","token","id token","customize id_token"]},{"location":"janssen-server/auth-server/tokens/openid-id-token/#obtaining-an-id-token","title":"Obtaining an ID Token","text":"<p>The client may obtain an ID Token in the authorization response, from the token endpoint, or both. Note, if you intend to use the Code Flow, and you don't intend to validate the <code>c_hash</code> or <code>s_hash</code> values in the ID Token returned from the authorization endpoint, don't check <code>id_token</code> in the response_type for the authorization endpoint, as it will waste compute and storage generating a token you don't need.</p>","tags":["administration","auth-server","token","id token","customize id_token"]},{"location":"janssen-server/auth-server/tokens/openid-id-token/#validating-an-id-token","title":"Validating an ID Token","text":"<p>At a minimum, client developers should always validate the following:</p> <ul> <li>Signature of the ID token</li> <li><code>iss</code> make sure the ID Token was issued by the OP you trust</li> <li><code>aud</code> make sure the ID Token was issued to your <code>client_id</code></li> <li><code>exp</code> make sure the token is not expired</li> <li><code>nonce</code> make sure the id_token correlates to your original authn request</li> </ul>","tags":["administration","auth-server","token","id token","customize id_token"]},{"location":"janssen-server/auth-server/tokens/openid-id-token/#using-the-id-token-as-an-access-token-for-apis","title":"Using the ID Token as an access token for API's","text":"<p>Don't do this. The ID Token is an identity assertion, not an access token. It may be passed in the payload to an API, but it should not be used in lieu of an OAuth access token! Fundamentally, the <code>id_token</code> details how a person was authenticated, not which API's a client is authorized to call. Also, OAuth access tokens are short lived, while the expiration of an identity assertion is much longer.</p>","tags":["administration","auth-server","token","id token","customize id_token"]},{"location":"janssen-server/auth-server/tokens/openid-id-token/#customizing-claims-in-an-id_token","title":"Customizing claims in an id_token","text":"<p>The UpdateTokenType can be used in the following scenarios:</p> <ol> <li>In addition to the default claims in an ID token (<code>iss</code>, <code>aud</code>, <code>exp</code> etc), additional custom claims can be added to an ID token.</li> <li>You can also change the default value of a claim </li> </ol>","tags":["administration","auth-server","token","id token","customize id_token"]},{"location":"janssen-server/auth-server/tokens/openid-userinfo-token/","title":"OpenID Userinfo Token","text":"","tags":["administration","auth-server","token","userinfo-token"]},{"location":"janssen-server/auth-server/tokens/openid-userinfo-token/#userinfo-jwt","title":"<code>Userinfo</code> JWT","text":"<p>An OpenID Connect client, after obtaining an access token, can present it at the Userinfo endpoint to obtain the Userinfo JWT token. The Userinfo response is is described in OpenID Core 5.4.3, and directs the developer to:</p> <ul> <li> <p>Verify that the OP that responded was the intended OP through a TLS server certificate check</p> </li> <li> <p>If the Client has provided a <code>userinfo_encrypted_response_alg</code> parameter during Registration, decrypt the UserInfo Response using the keys specified during Registration.</p> </li> <li> <p>If the response was signed, the Client SHOULD validate the signature.</p> </li> </ul> <p>Below is an example of the Userinfo claims for the default Jans Admin user:</p> <pre><code>{\n  \"sub\": \"e25c4146-ce9d-465e-9b59-b9d959bdfe3a\",\n  \"email\": \"admin@issuer.tld\",\n  \"given_name\": \"Admin\",\n  \"family_name\": \"User\",\n  \"name\": \"Default Admin User\",\n  \"middle_name\": \"Admin\",\n  \"nickname\": \"Admin\",\n  \"email_verified\": true,\n  \"inum\": \"e25c4146-ce9d-465e-9b59-b9d959bdfe3a\",\n  \"jansAdminUIRole\": [\"api-admin\"]\n}\n</code></pre>","tags":["administration","auth-server","token","userinfo-token"]},{"location":"janssen-server/auth-server/tokens/openid-userinfo-token/#selective-disclosure","title":"Selective disclosure","text":"<p>Domains can limit the claims released to a client from the Userinfo endpoint by associating only the OpenID scopes required by that client. You can also define new scopes, and associate any user claims with them. Note, clients still must request the scopes they need for an access token. For example, a client may be authorize</p>","tags":["administration","auth-server","token","userinfo-token"]},{"location":"janssen-server/auth-server/tokens/openid-userinfo-token/#requesting-individual-claims","title":"Requesting individual claims","text":"<p>If you want to use the <code>claims</code> parameter, you will have to first enable this feature in the Auth Server properties: set <code>claimsParameterSupported=True</code>. This is not a recommended configuration, because the claims parameter bypasses the privacy protection of the OpenID scopes construct.</p>","tags":["administration","auth-server","token","userinfo-token"]},{"location":"janssen-server/auth-server/tokens/openid-userinfo-token/#dynamic-scopes-interception-script","title":"Dynamic Scopes / Interception Script","text":"<p>If you need to call an API to render scopes or scope values on the fly, you should see the Dynamic Scopes interception script.</p>","tags":["administration","auth-server","token","userinfo-token"]},{"location":"janssen-server/auth-server/tokens/openid-userinfo-token/#userinfo-formatter","title":"Userinfo formatter","text":"<p>There is a configuration property <code>dateFormatterPatterns</code> which can be used for format date claims. Example: <code>{'dateFormatterPatterns': {'userinfo':'yyyy-MM-dd'}}</code>.</p>","tags":["administration","auth-server","token","userinfo-token"]},{"location":"janssen-server/auth-server/tokens/openid-userinfo-token/#language-support","title":"Language support","text":"<p>The default value for the configuration parameter <code>claimsLocalesSupported</code> is <code>['en']</code>. Currently, only the name and description supports localization. You will also need to make a proper request and provide the associated values for the claim in the database.</p>","tags":["administration","auth-server","token","userinfo-token"]},{"location":"janssen-server/auth-server/tokens/uma-rpt-token/","title":"UMA RPT Token","text":"","tags":["administration","auth-server","token","rpt-token"]},{"location":"janssen-server/auth-server/tokens/uma-rpt-token/#background","title":"Background","text":"<p>The UMA requesting party token (RPT) is an OAuth access token associated with the UMA grant. An RPT is unique to a requesting party, client, authorization server, resource server, and resource owner.</p> <p>The client uses the RPT in the Authorization header of an API request. The RPT bearer token conveys that  UMA policy evaluation was successful on Auth Server.</p> <p>The Client may also present the RPT token while making a request to Auth Server for a new RPT, for example to up-scope or down-scope a token.</p> <p>For more information on UMA, see the specifications: * User-Managed Access (UMA) 2.0 Grant for OAuth 2.0 Authorization * Federated Authorization for User-Managed Access (UMA) 2.0</p>","tags":["administration","auth-server","token","rpt-token"]},{"location":"janssen-server/auth-server/tokens/uma-rpt-token/#server-properties","title":"Server properties","text":"<p><code>umaRptAsJwt</code> Default: False - : Reference token is the default</p> <p><code>umaRptLifetime</code> Default: 3600 seconds - : 60 minutes</p> <p><code>introspectionAccessTokenMustHaveUmaProtectionScope</code> Default: False - :</p> <p><code>umaGrantAccessIfNoPolicies</code> Default: False - :</p> <p><code>umaTicketLifetime</code> Default: 3600 seconds - : 60 minutes - Returned by the Resource Server to the Client for presentation at the UMA token endpoint. The ticket is the equivalent of the code in the OAuth code flow.</p> <p><code>umaAddScopesAutomatically</code> Default: True - :</p> <p><code>umaPctLifetime</code> Default: 1728000 seconds - : The PCT is a pushed claim token that references a previous claims gathering flow, so you don't have to bother the subject again for this information.</p> <p><code>umaValidateClaimToken</code> Default: False - :</p> <p><code>umaRestrictResourceToAssociatedClient</code> Default: False - :</p>","tags":["administration","auth-server","token","rpt-token"]},{"location":"janssen-server/auth-server/uma-features/","title":"UMA Features","text":"<p>As a profile of OAuth 2.0 that is complementary to OpenID Connect, UMA 2 defines RESTful, JSON-based, standardized flows and constructs for coordinating the protection of APIs and web resources.</p> <p>UMA 2 defines interfaces between authorization servers (AS), like Gluu, and resource servers (RS) that enable centralized policy decision-making for improved service delivery, auditing, policy administration, and accountability, even in a very loosely coupled \"public API\" environment.</p> <p>UMA 2 does not standardize a policy expression language, enabling flexibility in policy expression and evaluation through XACML, other declarative policy languages, or procedural code as warranted by conditions.</p> <p>UMA 2 inherits authentication agnosticism from OAuth. It concentrates on authorization, not authentication. It has been profiled to work with OpenID Connect to gather identity claims from whoever is attempting access, and enables attribute-based (\"claims\" in OAuth2) authorization (with group-based or role-based policies a natural subset).</p>","tags":["administration","auth-server","uma"]},{"location":"janssen-server/auth-server/uma-features/#terminology","title":"Terminology","text":"<p>UMA 2 introduces new terms and enhancements of OAuth term definitions. A few important terms include:</p> <p>Resource Owner (RO): An entity capable of granting access to a protected resource--the \"user\" in User-Managed Access. This is typically an end-user, but it can also be non-human entity that is treated as a person for limited legal purposes, such as a corporation.</p> <p>Resource Server (RS): A server that hosts resources on a resource owner's behalf, registers resources for protection at an authorization server, and is capable of accepting and responding to requests for protected resources.</p> <p>Authorization Server (AS)*: A server that protects, on a resource owner's behalf, resources managed at a resource server.</p> <p>* The Janssen Authentication Server acts as an UMA AS.</p> <p>Learn more in the UMA 2 Core, Federated Authorization and Grant specifications.</p>","tags":["administration","auth-server","uma"]},{"location":"janssen-server/auth-server/uma-features/claims-gathering-endpoint/","title":"Claims Gathering Endpoint","text":"","tags":["administration","auth-server","uma","feature","endpoint"]},{"location":"janssen-server/auth-server/uma-features/claims-gathering-endpoint/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","auth-server","uma","feature","endpoint"]},{"location":"janssen-server/auth-server/uma-features/claims-gathering-endpoint/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","uma","feature","endpoint"]},{"location":"janssen-server/auth-server/uma-features/claims-gathering-endpoint/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","uma","feature","endpoint"]},{"location":"janssen-server/auth-server/uma-features/rpt-endpoint/","title":"RPT Endpoint","text":"","tags":["administration","auth-server","uma","feature","endpoint"]},{"location":"janssen-server/auth-server/uma-features/rpt-endpoint/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","auth-server","uma","feature","endpoint"]},{"location":"janssen-server/auth-server/uma-features/rpt-endpoint/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","auth-server","uma","feature","endpoint"]},{"location":"janssen-server/auth-server/uma-features/rpt-endpoint/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","auth-server","uma","feature","endpoint"]},{"location":"janssen-server/config-guide/","title":"Configure Identity &amp; Policies","text":"<p>This section covers configuring your Janssen deployment, including identity management, access policies, and customization options.</p>","tags":["administration","configuration"]},{"location":"janssen-server/config-guide/#configuration-tools","title":"Configuration Tools","text":"<p>Janssen provides multiple tools for configuration:</p> <ul> <li>TUI (Text-Based UI) - Interactive terminal interface for configuration</li> <li>CLI (Command Line) - Scriptable command-line configuration tool</li> <li>REST API (Config API) - Programmatic configuration via REST endpoints</li> </ul>","tags":["administration","configuration"]},{"location":"janssen-server/config-guide/#key-configuration-areas","title":"Key Configuration Areas","text":"<ul> <li>Clients - OAuth 2.0/OpenID Connect client registration and management</li> <li>Scopes - Define and manage permission scopes</li> <li>Users &amp; Groups - User identity and group management</li> <li>Custom Scripts - Extend functionality with custom authentication and authorization scripts</li> <li>Sessions - Session management and policies</li> <li>Casa - Self-service credential management portal</li> </ul> <p>Use the navigation menu to explore specific configuration topics.</p>","tags":["administration","configuration"]},{"location":"janssen-server/config-guide/custom-assets-configuration/","title":"Custom Assets Configuration","text":"<p>The Janssen Server provides multiple configuration tools to configure custom assets.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal.  Learn how to use Jans Text-based UI (TUI)  here or jump straight to the Using Text-based UI</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here or Jump straight to the Using Configuration REST API</p>","tags":["administration","configuration","custom assets"]},{"location":"janssen-server/config-guide/custom-assets-configuration/#using-the-command-line","title":"Using The Command Line","text":"<p>In the Janssen Server, you can deploy custom assets using the command line. To get the details of Janssen command line operations relevant to the custom assets, check the operations under the <code>JansAssets</code> task using the command below.</p> Command<pre><code>jans cli --info JansAssets\n</code></pre> Sample Output<pre><code>Operation ID: get-asset-by-inum\n Description: Gets an asset by inum - unique identifier\n Parameters:\n inum: Asset Inum [string]\nOperation ID: delete-asset\n Description: Delete an asset\n Parameters:\n inum: Asset identifier [string]\nOperation ID: get-asset-by-name\n Description: Fetch asset by name.\n Parameters:\n name: Asset Name [string]\nOperation ID: get-all-assets\n Description: Gets all Jans assets.\n Parameters:\n limit: Search size - max size of the results to return [integer]\n pattern: Search pattern [string]\n status: Status of the attribute [string]\n startIndex: The 1-based index of the first query result [integer]\n sortBy: Attribute whose value will be used to order the returned response [string]\n sortOrder: Order in which the sortBy param is applied. Allowed values are \"ascending\" and \"descending\" [string]\n fieldValuePair: Field and value pair for searching [string]\nOperation ID: get-asset-services\n Description: Gets asset services\nOperation ID: get-asset-types\n Description: Get valid asset types\nOperation ID: put-asset\n Description: Update existing asset\n Schema: AssetForm\nOperation ID: post-new-asset\n Description: Upload new asset\n Schema: AssetForm\n\nTo get sample schema type jans cli --schema-sample &lt;schema&gt;, for example jans cli --schema-sample AssetForm\n</code></pre>","tags":["administration","configuration","custom assets"]},{"location":"janssen-server/config-guide/custom-assets-configuration/#get-all-current-custom-assets","title":"Get All Current Custom Assets","text":"<p>Use the operation ID <code>get-all-assets</code> to get all the currently configured custom assets on the Janssen Server.</p> <p>Command<pre><code>jans cli --operation-id get-all-assets\n</code></pre> Sample Output<pre><code>{\n  \"start\": 0,\n  \"totalEntriesCount\": 3,\n  \"entriesCount\": 3,\n  \"entries\": [\n    {\n      \"dn\": \"inum=61edc29d-45f8-4ab9-8c9a-7b39e4cbe440,ou=document,o=jans\",\n      \"inum\": \"61edc29d-45f8-4ab9-8c9a-7b39e4cbe440\",\n      \"fileName\": \"p2.properties\",\n      \"description\": \"Valid text description\",\n      \"document\": \"cHJvcGVydGllcyBoZXJlLiAK\\r\\n\",\n      \"creationDate\": \"2024-07-31T07:36:08\",\n      \"jansService\": [\n        \"jans-auth\"\n      ],\n      \"jansLevel\": 142,\n      \"jansEnabled\": true,\n      \"baseDn\": \"inum=61edc29d-45f8-4ab9-8c9a-7b39e4cbe440,ou=document,o=jans\"\n    },\n    {\n      \"dn\": \"inum=835c7a68-57b1-4e39-8d2a-2a3963f2a92f,ou=document,o=jans\",\n      \"inum\": \"835c7a68-57b1-4e39-8d2a-2a3963f2a92f\",\n      \"fileName\": \"p1.properties\",\n      \"description\": \"updated thrice Valid text description\",\n      \"document\": \"cHJvcGVydGllcwo=\\r\\n\",\n      \"jansService\": [\n        \"jans-auth\"\n      ],\n      \"jansEnabled\": false,\n      \"baseDn\": \"inum=835c7a68-57b1-4e39-8d2a-2a3963f2a92f,ou=document,o=jans\"\n    },\n    {\n      \"dn\": \"inum=fd67d07b-c874-4bc1-a9f0-860fc4f7a091,ou=document,o=jans\",\n      \"inum\": \"fd67d07b-c874-4bc1-a9f0-860fc4f7a091\",\n      \"fileName\": \"p.properties\",\n      \"description\": \"Valid text description\",\n      \"document\": \"cHJvcGVydGllcyBoZXJlLiAK\\r\\n\",\n      \"creationDate\": \"2024-07-31T07:40:03\",\n      \"jansService\": [\n        \"jans-auth\"\n      ],\n      \"jansLevel\": 142,\n      \"jansEnabled\": true,\n      \"baseDn\": \"inum=fd67d07b-c874-4bc1-a9f0-860fc4f7a091,ou=document,o=jans\"\n    }\n  ]\n}\n</code></pre></p>","tags":["administration","configuration","custom assets"]},{"location":"janssen-server/config-guide/custom-assets-configuration/#get-custom-asset-by-inum","title":"Get Custom Asset By inum","text":"<p>With <code>get-asset-by-inum</code> operation-id, we can get any specific asset matched with <code>inum</code>. If we know the <code>inum</code>, we can simply use the below command:</p> <p>Command<pre><code>jans cli --operation-id get-asset-by-inum \\\n--url-suffix inum:61edc29d-45f8-4ab9-8c9a-7b39e4cbe440\n</code></pre> It returns the details as below:</p> Sample Output<pre><code>{\n  \"dn\": \"inum=61edc29d-45f8-4ab9-8c9a-7b39e4cbe440,ou=document,o=jans\",\n  \"inum\": \"61edc29d-45f8-4ab9-8c9a-7b39e4cbe440\",\n  \"fileName\": \"p2.properties\",\n  \"description\": \"Valid text description\",\n  \"document\": \"cHJvcGVydGllcyBoZXJlLiAK\\r\\n\",\n  \"creationDate\": \"2024-07-31T07:36:08\",\n  \"jansService\": [\n    \"jans-auth\"\n  ],\n  \"jansLevel\": 142,\n  \"jansEnabled\": true,\n  \"baseDn\": \"inum=61edc29d-45f8-4ab9-8c9a-7b39e4cbe440,ou=document,o=jans\"\n}\n</code></pre>","tags":["administration","configuration","custom assets"]},{"location":"janssen-server/config-guide/custom-assets-configuration/#get-custom-asset-by-name","title":"Get Custom Asset By Name","text":"<p>With <code>get-asset-by-name</code> operation-id, we can get any specific asset matched with <code>name</code>.  If we know the <code>name</code>, we can simply use the below command:</p> <p>Command<pre><code>jans cli --operation-id get-asset-by-name \\\n--url-suffix name:p1.properties\n</code></pre> It returns the details as below:</p> Sample Output<pre><code>{\n  \"start\": 0,\n  \"totalEntriesCount\": 1,\n  \"entriesCount\": 1,\n  \"entries\": [\n    {\n      \"dn\": \"inum=835c7a68-57b1-4e39-8d2a-2a3963f2a92f,ou=document,o=jans\",\n      \"inum\": \"835c7a68-57b1-4e39-8d2a-2a3963f2a92f\",\n      \"fileName\": \"p1.properties\",\n      \"description\": \"updated thrice Valid text description\",\n      \"document\": \"cHJvcGVydGllcwo=\\r\\n\",\n      \"jansService\": [\n        \"jans-auth\"\n      ],\n      \"jansEnabled\": false,\n      \"baseDn\": \"inum=835c7a68-57b1-4e39-8d2a-2a3963f2a92f,ou=document,o=jans\"\n    }\n  ]\n}\n</code></pre>","tags":["administration","configuration","custom assets"]},{"location":"janssen-server/config-guide/custom-assets-configuration/#get-services","title":"Get Services","text":"<p>Get the list of Janssen Server services that support custom assets by performing <code>get-asset-services</code> operation.</p> Command<pre><code>jans cli --operation-id get-asset-services\n</code></pre> Sample Output<pre><code>[\n \"jans-auth\",\n \"jans-casa\",\n \"jans-config-api\",\n \"jans-fido2\",\n \"jans-link\",\n \"jans-lock\",\n \"jans-scim\",\n \"jans-keycloak-link\"\n]\n</code></pre>","tags":["administration","configuration","custom assets"]},{"location":"janssen-server/config-guide/custom-assets-configuration/#get-valid-asset-types","title":"Get Valid Asset Types","text":"<p>Get the asset types of your Janssen Server by performing <code>get-asset-types</code> operation.</p> Command<pre><code>jans cli --operation-id get-asset-types\n</code></pre> Sample Output<pre><code>[\n \"properties\",\n \"jar\",\n \"xhtml\",\n \"js\",\n \"css\",\n \"png\",\n \"gif\",\n \"jpg\",\n \"jpeg\"\n]\n</code></pre>","tags":["administration","configuration","custom assets"]},{"location":"janssen-server/config-guide/custom-assets-configuration/#add-new-custom-asset","title":"Add New Custom Asset","text":"<p>To create a new asset, we can use <code>post-new-asset</code> operation id. As shown in the output for <code>--info</code> command, the <code>post-new-asset</code> operation requires data to be sent according to <code>AssetForm</code> schema.</p> <p>To see the schema, use the command below:</p> Command<pre><code>jans cli --schema AssetForm\n</code></pre> <p>For better understanding, the Janssen Server also provides a sample of data to be sent to the server. This sample conforms to the schema above. Use the command below to get the sample.</p> Command<pre><code>jans cli --schema-sample AssetForm\n</code></pre> <p>Using the schema and the example above, we have added below data to the file <code>/tmp/add-asset.json</code>. Example below will load <code>p3.properties</code> file as a custom asset to the <code>jans-auth</code> service.</p> <p>Input<pre><code>{\n  \"document\": {\n    \"fileName\": \"p3.properties\",\n    \"description\": \"text description\",\n    \"jansService\": [\n      \"jans-auth\"\n    ],\n    \"jansLevel\": 144,\n    \"jansEnabled\": true\n  },\n  \"assetFile\": \"/tmp/p3.properties\"\n}\n</code></pre> Now let's post this Assert to the Janssen Server to be added to the existing set:</p> Command<pre><code> jans cli --operation-id post-new-asset \\\n --data /tmp/add-asset.json\n</code></pre>","tags":["administration","configuration","custom assets"]},{"location":"janssen-server/config-guide/custom-assets-configuration/#update-existing-custom-assets","title":"Update Existing Custom Assets","text":"<p>Use the <code>put-asset</code> operation to update an existing asset. This operation uses same schema as add new asset operation. For example, assuming that there is an existing asset as show below:</p> Existing Asset<pre><code>{\n  \"dn\": \"inum=fd67d07b-c874-4bc1-a9f0-860fc4f7a091,ou=document,o=jans\",\n  \"inum\": \"fd67d07b-c874-4bc1-a9f0-860fc4f7a091\",\n  \"fileName\": \"p.properties\",\n  \"description\": \"Valid text description\",\n  \"document\": \"cHJvcGVydGllcyBoZXJlLiAK\\r\\n\",\n  \"creationDate\": \"2024-07-31T07:40:03\",\n  \"jansService\": [\n    \"jans-auth\"\n  ],\n  \"jansLevel\": 142,\n  \"jansEnabled\": true,\n  \"baseDn\": \"inum=fd67d07b-c874-4bc1-a9f0-860fc4f7a091,ou=document,o=jans\"\n}\n</code></pre> <p>Note</p> <p><code>assetFile</code> attribute is optional for update operation as there may be scenario where only metadata of an asset is to be updated.</p> <p>Now to update level of this asset to 6, create a text file with following content in it. Let's name this text file as <code>/tmp/update-asset.json</code></p> Input<pre><code>{\n  \"document\": {\n      \"dn\": \"inum=fd67d07b-c874-4bc1-a9f0-860fc4f7a091,ou=document,o=jans\",\n      \"inum\": \"fd67d07b-c874-4bc1-a9f0-860fc4f7a091\",\n      \"fileName\": \"p.properties\",\n      \"description\": \"Valid text description\",\n      \"document\": \"cHJvcGVydGllcyBoZXJlLiAK\\r\\n\",\n      \"creationDate\": \"2024-07-31T07:40:03\",\n      \"jansService\": [\n        \"jans-auth\"\n      ],\n      \"jansLevel\": 6,\n      \"jansEnabled\": true,\n   },\n  \"assetFile\": \"/tmp/p.properties\"\n}\n</code></pre> <p>Now use the command below to update the asset with new value for level.</p> Sample Command<pre><code>jans cli --operation-id put-asset \\\n--data /tmp/update-asset.json\n</code></pre> <p>Upon successful execution, this command will return with updated asset values.</p> Return values<pre><code>{\n  \"dn\": \"inum=fd67d07b-c874-4bc1-a9f0-860fc4f7a091,ou=document,o=jans\",\n  \"inum\": \"fd67d07b-c874-4bc1-a9f0-860fc4f7a091\",\n  \"fileName\": \"p.properties\",\n  \"description\": \"Valid text description\",\n  \"document\": \"cHJvcGVydGllcyBoZXJlLiAK\\r\\n\",\n  \"creationDate\": \"2024-07-31T07:40:03\",\n  \"jansService\": [\n    \"jans-auth\"\n  ],\n  \"jansLevel\": 6,\n  \"jansEnabled\": true,\n  \"baseDn\": \"inum=fd67d07b-c874-4bc1-a9f0-860fc4f7a091,ou=document,o=jans\"\n}\n</code></pre>","tags":["administration","configuration","custom assets"]},{"location":"janssen-server/config-guide/custom-assets-configuration/#delete-custom-asset","title":"Delete Custom Asset","text":"<p>You can delete any custom asset by its <code>inum</code> value.</p> Command<pre><code>jans cli --operation-id delete-asset \\\n--url-suffix inum:61edc29d-45f8-4ab9-8c9a-7b39e4cbe440\n</code></pre>","tags":["administration","configuration","custom assets"]},{"location":"janssen-server/config-guide/custom-assets-configuration/#using-text-based-ui","title":"Using Text-based UI","text":"<p>In Janssen, You can deploy custom asset using the Text-Based UI also.</p> <p>You can start TUI using the command below:</p> Command<pre><code>jans tui\n</code></pre>","tags":["administration","configuration","custom assets"]},{"location":"janssen-server/config-guide/custom-assets-configuration/#asset-screen","title":"Asset Screen","text":"<p>Navigate to <code>Assets</code> tab to open the Assets screen as shown in the image below.</p> <ul> <li>To get the list of currently added Assets, bring the control to the Search  box (using the tab key), and press Enter. Type the search string to search  for Asset with matching <code>inum</code>, or <code>File Name</code> or <code>Description</code></li> </ul> <p></p> <ul> <li>Use the <code>Add Asset</code> button to create a new asset. </li> <li>From the screen below, select the custom asset that needs to be uploaded and select the Janssen Server service to which the asset will be uploaded.</li> </ul> <p></p>","tags":["administration","configuration","custom assets"]},{"location":"janssen-server/config-guide/custom-assets-configuration/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring the custom assets. Endpoint details are published in the Swagger document.</p>","tags":["administration","configuration","custom assets"]},{"location":"janssen-server/config-guide/custom-scripts-config/","title":"Custom Scripts","text":"<p>Prerequisite: Know how to use the Janssen CLI in command-line mode</p> <p>Interception scripts can be used to implement custom business logic for authentication, authorization, and more in a way that is upgrade-proof and doesn't require forking the Gluu Server code. Using Janssen CLI, we can manage custom scripts as well.</p> <p>Let's get the task information using below command:</p> <pre><code>jans cli --info CustomScripts\n</code></pre> <p>In return we gets each of the sub-task details:</p> <pre><code>Operation ID: get-config-scripts\n  Description: Gets a list of custom scripts.\nOperation ID: post-config-scripts\n  Description: Adds a new custom script.\n  Schema: /components/schemas/CustomScript\nOperation ID: put-config-scripts\n  Description: Updates a custom script.\n  Schema: /components/schemas/CustomScript\nOperation ID: get-config-scripts-by-type\n  Description: Gets list of scripts by type.\n  url-suffix: type\nOperation ID: get-config-scripts-by-inum\n  Description: Gets a script by Inum.\n  url-suffix: inum\nOperation ID: delete-config-scripts-by-inum\n  Description: Deletes a custom script.\n  url-suffix: inum\n\nTo get sample schema type jans cli --schema &lt;schma&gt;, for example jans cli --schema CustomScript\n</code></pre> <p>Let's perform each of this operation.</p>","tags":["administration","configuration","custom-scripts"]},{"location":"janssen-server/config-guide/custom-scripts-config/#find-list-of-custom-scripts","title":"Find list of Custom scripts","text":"<p><code>get-config-scripts</code> operation id can be used to get a list of custom scripts of the Janssen Server.</p> <p>The command line is:</p> <pre><code>jans cli --operation-id get-config-scripts\n</code></pre> <p>It returns all the custom scripts of the Janssen Server.</p>","tags":["administration","configuration","custom-scripts"]},{"location":"janssen-server/config-guide/custom-scripts-config/#adds-a-new-custom-script","title":"Adds a New Custom Script","text":"<p>If we look at the description of this operation we see it supports schema:</p> <pre><code>Operation ID: post-config-scripts\n  Description: Adds a new custom script.\n  Schema: /components/schemas/CustomScript\n</code></pre> <p>So, let's get the schema first:</p> <pre><code>jans cli CustomScript &gt; /tmp/cs.json\n</code></pre> <pre><code>{\n  \"dn\": null,\n  \"inum\": null,\n  \"name\": \"string\",\n  \"aliases\": [],\n  \"description\": null,\n  \"script\": \"_file /root/script.py\",\n  \"scriptType\": \"INTROSPECTION\",\n  \"programmingLanguage\": \"PYTHON\",\n  \"moduleProperties\": {\n    \"value1\": null,\n    \"value2\": null,\n    \"description\": null\n  },\n  \"configurationProperties\": {\n    \"value1\": null,\n    \"value2\": null,\n    \"description\": null,\n    \"hide\": true\n  },\n  \"level\": \"integer\",\n  \"revision\": 0,\n  \"enabled\": false,\n  \"scriptError\": {\n    \"raisedAt\": null,\n    \"stackTrace\": null\n  },\n  \"modified\": false,\n  \"internal\": false\n}\n</code></pre> <p>We need to fill some of these properties with valid data to add this new script.</p> <p><pre><code>{\n  \"name\": \"custom_script_client\",\n  \"aliases\": null,\n  \"description\": \"Testing custom script addition\",\n  \"script\": \"_file /root/client_registration.py\",\n  \"scriptType\": \"CLIENT_REGISTRATION\",\n  \"programmingLanguage\": \"PYTHON\",\n  \"moduleProperties\": [{\n    \"value1\": \"myvalue1\",\n    \"value2\": \"myvalue2\",\n    \"description\": \"description for this property\"\n  }],\n  \"configurationProperties\": null,\n  \"level\": 100,\n  \"revision\": 0,\n  \"enabled\": false,\n  \"scriptError\": null,\n  \"modified\": false,\n  \"internal\": false\n}\n</code></pre> We can remove <code>dn</code>, <code>inum</code>. As because these two items are auto generated with random value. Also we see <code>aliases</code>, <code>moduleproperties</code> and <code>configurationProperties</code> are the array type <code>keys</code>. So we need to put data into <code>[]</code> otherwise it will raise an error. We can also use <code>null</code> value if we need to skip any of them. For <code>scriptType</code> we can choose only selected type of script from the below list.</p>","tags":["administration","configuration","custom-scripts"]},{"location":"janssen-server/config-guide/custom-scripts-config/#name-of-the-type-of-scripts","title":"Name of the type of scripts","text":"<pre><code>PERSON_AUTHENTICATION, INTROSPECTION, RESOURCE_OWNER_PASSWORD_CREDENTIALS, APPLICATION_SESSION, CACHE_REFRESH, CLIENT_REGISTRATION, ID_GENERATOR, UMA_RPT_POLICY, UMA_RPT_CLAIMS, UMA_CLAIMS_GATHERING, CONSENT_GATHERING, DYNAMIC_SCOPE, SPONTANEOUS_SCOPE, END_SESSION, POST_AUTHN, SCIM, CIBA_END_USER_NOTIFICATION, PERSISTENCE_EXTENSION, IDP, UPDATE_TOKEN\n</code></pre>","tags":["administration","configuration","custom-scripts"]},{"location":"janssen-server/config-guide/custom-scripts-config/#programming-language","title":"Programming Language","text":"<p>Two types of programming language available there. Those are <code>Python</code> and <code>JavaScript</code>. We can choose any of them regarding the script we need to add.</p> <p>Alright, let's add the script using the command line we have:</p> <pre><code>jans cli --operation-id post-config-scripts --data /tmp/cs.json\n</code></pre> <pre><code>Getting access token for scope https://jans.io/oauth/config/scripts.write\nServer Response:\n{\n  \"dn\": \"inum=61aef81b-b22d-42c0-89d5-b098c976a2b7,ou=scripts,o=jans\",\n  \"inum\": \"61aef81b-b22d-42c0-89d5-b098c976a2b7\",\n  \"name\": \"custom_script_client\",\n  \"aliases\": null,\n  \"description\": \"Testing custom script addition\",\n  \"script\": \"...\",\n  \"scriptType\": \"CLIENT_REGISTRATION\",\n  \"programmingLanguage\": \"PYTHON\",\n  \"moduleProperties\": [\n    {\n      \"value1\": \"myvalue1\",\n      \"value2\": \"myvalue2\",\n      \"description\": \"description for this property\"\n    }\n  ],\n  \"configurationProperties\": null,\n  \"level\": 100,\n  \"revision\": 0,\n  \"enabled\": false,\n  \"scriptError\": null,\n  \"modified\": false,\n  \"internal\": false\n}\n</code></pre>","tags":["administration","configuration","custom-scripts"]},{"location":"janssen-server/config-guide/custom-scripts-config/#update-an-existing-custom-script","title":"Update an existing Custom Script","text":"<p><code>put-config-scripts</code> operation-id can be used to update any existing script on the Janssen server.</p> <p><pre><code>Operation ID: put-config-scripts\n  Description: Updates a custom script.\n  Schema: /components/schemas/CustomScript\n</code></pre> As we created a custom script in the above, let's update that one. So we know the <code>dn:inum=61aef81b-b22d-42c0-89d5-b098c976a2b7,ou=scripts,o=jans</code> and <code>inum:61aef81b-b22d-42c0-89d5-b098c976a2b7</code> here. In this case, I have modified as below:</p> <pre><code>{\n  \"dn\": \"inum=61aef81b-b22d-42c0-89d5-b098c976a2b7,ou=scripts,o=jans\",\n  \"inum\": \"61aef81b-b22d-42c0-89d5-b098c976a2b7\",\n  \"name\": \"custom_script_client\",\n  \"aliases\": null,\n  \"description\": \"Testing custom script addition\",\n  \"script\": \"_file /root/client_registrationj.py\",\n  \"scriptType\": \"CLIENT_REGISTRATION\",\n  \"programmingLanguage\": \"PYTHON\",\n  \"moduleProperties\": [{\n    \"value1\": \"myvalue1\",\n    \"value2\": \"myvalue2\",\n    \"description\": \"description for this property\"\n  }],\n  \"configurationProperties\": [{\n    \"value1\": \"testconfigvalue1\",\n    \"value2\": \"testconfigvalue2\",\n    \"description\": \"description for configuration property\",\n    \"hide\": true\n  }],\n  \"level\": 100,\n  \"revision\": 0,\n  \"enabled\": false,\n  \"scriptError\": null,\n  \"modified\": false,\n  \"internal\": false\n}\n</code></pre> <p>You can see, I have added <code>configurationProperties</code> for testing purpose only. In case you need to change the script, you can do that by changing the <code>script</code> path as well.</p> <pre><code>jans cli --operation-id put-config-scripts --data /tmp/cs.json\n</code></pre> <pre><code>Getting access token for scope https://jans.io/oauth/config/scripts.write\nServer Response:\n{\n  \"dn\": \"inum=61aef81b-b22d-42c0-89d5-b098c976a2b7,ou=scripts,o=jans\",\n  \"inum\": \"61aef81b-b22d-42c0-89d5-b098c976a2b7\",\n  \"name\": \"custom_script_client\",\n  \"aliases\": null,\n  \"description\": \"Testing custom script addition\",\n  \"script\": \"...\",\n  \"scriptType\": \"CLIENT_REGISTRATION\",\n  \"programmingLanguage\": \"PYTHON\",\n  \"moduleProperties\": [\n    {\n      \"value1\": \"myvalue1\",\n      \"value2\": \"myvalue2\",\n      \"description\": \"description for this property\"\n    }\n  ],\n  \"configurationProperties\": [\n    {\n      \"value1\": \"testconfigvalue1\",\n      \"value2\": \"testconfigvalue2\",\n      \"description\": \"description for configuration property\",\n      \"hide\": true\n    }\n  ],\n  \"level\": 100,\n  \"revision\": 0,\n  \"enabled\": false,\n  \"scriptError\": null,\n  \"modified\": false,\n  \"internal\": false\n}\n</code></pre>","tags":["administration","configuration","custom-scripts"]},{"location":"janssen-server/config-guide/custom-scripts-config/#get-custom-script-by-type","title":"Get Custom Script by type","text":"<p>With this operation-id, we can find a specific type of scripts. It uses <code>url-suffix</code> to get the list of a single type scripts.</p> <pre><code>Operation ID: get-config-scripts-by-type\n  Description: Gets list of scripts by type.\n  url-suffix: type\n</code></pre> <p>The command line is: <pre><code>jans cli --operation-id get-config-scripts-by-type --url-suffix type:script-type-name\n</code></pre></p> <p>For an example, let's find all the scripts of <code>CLIENT_REGISTRATION</code> type. So, the command line is:</p> <pre><code>jans cli --operation-id get-config-scripts-by-type --url-suffix type:CLIENT_REGISTRATION\n</code></pre> <p>It returns all the custom scripts that are related to the <code>CLIENT_REGISTRATION</code> type available in the Janssen Server. You will find the name of all the types here</p>","tags":["administration","configuration","custom-scripts"]},{"location":"janssen-server/config-guide/custom-scripts-config/#get-custom-scripts-by-its-inum","title":"Get Custom Scripts by it's <code>inum</code>","text":"<p>In case we need to find out details configuration of any custom script, we can search by its unique <code>inum</code> value.</p> <pre><code>Operation ID: get-config-scripts-by-inum\n  Description: Gets a script by Inum.\n  url-suffix: inum\n</code></pre> <p>command line:</p> <pre><code>jans cli --operation-id get-config-scripts-by-inum --url-suffix inum:inum_value\n</code></pre> <p>For example, we can show details here that we already added in the Janssen Server and we know it's <code>inum</code> value is <code>61aef81b-b22d-42c0-89d5-b098c976a2b7</code>.</p> <p>In our case, the command line is:</p> <pre><code>jans cli --operation-id get-config-scripts-by-inum --url-suffix inum:61aef81b-b22d-42c0-89d5-b098c976a2b7\n</code></pre> <p>It returns the configuration of the custom script matched with the given <code>inum</code> value.</p> <pre><code>Getting access token for scope https://jans.io/oauth/config/scripts.readonly\n{\n  \"dn\": \"inum=61aef81b-b22d-42c0-89d5-b098c976a2b7,ou=scripts,o=jans\",\n  \"inum\": \"61aef81b-b22d-42c0-89d5-b098c976a2b7\",\n  \"name\": \"custom_script_client\",\n  \"aliases\": null,\n  \"description\": \"Testing custom script addition\",\n  \"script\": \"...\",\n  \"scriptType\": \"CLIENT_REGISTRATION\",\n  \"programmingLanguage\": \"PYTHON\",\n  \"moduleProperties\": [\n    {\n      \"value1\": \"myvalue1\",\n      \"value2\": \"myvalue2\",\n      \"description\": \"description for this property\"\n    }\n  ],\n  \"configurationProperties\": [\n    {\n      \"value1\": \"testconfigvalue1\",\n      \"value2\": \"testconfigvalue2\",\n      \"description\": \"description for configuration property\",\n      \"hide\": true\n    }\n  ],\n  \"level\": 100,\n  \"revision\": 0,\n  \"enabled\": false,\n  \"scriptError\": null,\n  \"modified\": false,\n  \"internal\": false\n}\n</code></pre>","tags":["administration","configuration","custom-scripts"]},{"location":"janssen-server/config-guide/custom-scripts-config/#how-to-delete-custom-script","title":"How to delete Custom Script?","text":"<p>Well, we can delete any custom script also in deed. In that case, we need to remember the <code>inum</code> value of the custom script we want to delete. In the above we added, updated a custom script. We know the <code>inum</code> value, so let's delete this one.</p> <p>Command line:</p> <pre><code>jans cli --operation-id delete-config-scripts-by-inum --url-suffix inum:inum_value\n</code></pre> <p>For example, in our case; the command line is:</p> <pre><code>jans cli --operation-id delete-config-scripts-by-inum --url-suffix inum:61aef81b-b22d-42c0-89d5-b098c976a2b7\n</code></pre> <p>That's all for <code>Custom Script</code> management with <code>CLI</code> feature.</p> <p>Note</p> <p>If a custom script that is set as Default authentication method is disabled or deleted then the default authentication value will be removed.</p>","tags":["administration","configuration","custom-scripts"]},{"location":"janssen-server/config-guide/hash-password/","title":"Hash Passwords","text":"","tags":["administration","developer","configuration","Hashed Passwords","Entry manager"]},{"location":"janssen-server/config-guide/hash-password/#hashed-passwords","title":"Hashed Passwords","text":"<p>ORM stores users password in DB in hashing form. It supports next hash methods:  SHA, SSHA, SHA-256, SSHA-256, SHA-384, SSHA-384, SHA-512, SSHA-512 MD5, SMD5, CRYPT, CRYPT-MD5, CRYPT-SHA-256, CRYPT-SHA-512, CRYPT-BCRYPT $2a$, CRYPT-BCRYPT $2b$, PKCS5S2, ARGON2</p> <p>Support additional hashing methods can be added with Persistence Extension script.</p>","tags":["administration","developer","configuration","Hashed Passwords","Entry manager"]},{"location":"janssen-server/config-guide/hash-password/#hash-password-properties","title":"Hash Password properties","text":"<p>New hash methods like Argon2 supports default hash properties override. This is supported list of properties from <code>/etc/jans/conf/jans-sql.properties</code>:</p> <pre><code># Argon 2 parameters\n# 0 - ARGON2_d, 1 - ARGON2_i, 2 - ARGON2_id\npassword.method.argon2.type=2\n# 1.0 - 16, 1.3 - 19\npassword.method.argon2.version=19\npassword.method.argon2.salt-length=16\npassword.method.argon2.memory=7168\npassword.method.argon2.iterations=5\npassword.method.argon2.parallelism=1\npassword.method.argon2.hash-length=32\n</code></pre> <p>After thess properties update <code>jans-auth</code> requires restart.</p>","tags":["administration","developer","configuration","Hashed Passwords","Entry manager"]},{"location":"janssen-server/config-guide/hash-password/#hash-password-format","title":"Hash Password format","text":"<p>User password value in DB has format {TYPE}{BASE64 encoded hash}</p> <p>Argon2 hashed passwords in DB has similar format. Each password starts from<code>{ARGON2}</code> which follows Base64 encoded argon2 password hash with properties.</p> <p>Argon2 encoded format contains next parts: $type$v=version$m=memory,t=iterations,p=parallelism$Base64WithoutPadding(salt)$Base64WithoutPadding(password_hash)</p> <p>Here are samples of <code>secret</code> encoded passwords:</p> <ol> <li> <p>With default values: <pre><code>{ARGON2}JGFyZ29uMmkkdj0xOSRtPTcxNjgsdD01LHA9MSRuSGZnL2JBZTRybEtNWS90ck9WNGdnJGJvWmgvcG9tVDJyR1dPV0pNRVp4KzlGa0dJWTVVbjhwTVk0Syt6L28rME0=\n-&gt;\n$argon2i$v=19$m=7168,t=5,p=1$nHfg/bAe4rlKMY/trOV4gg$boZh/pomT2rGWOWJMEZx+9FkGIY5Un8pMY4K+z/o+0M\n</code></pre></p> </li> <li> <p>Override default setting with file <code>/etc/jans/conf/jans-sql.properties</code> <pre><code># Argon 2 parameters\npassword.method.argon2.type=2\npassword.method.argon2.version=19\npassword.method.argon2.salt-length=16\npassword.method.argon2.memory=32768\npassword.method.argon2.iterations=10\npassword.method.argon2.parallelism=1\npassword.method.argon2.hash-length=32\n</code></pre></p> </li> </ol> <pre><code>{ARGON2}JGFyZ29uMmlkJHY9MTkkbT0zMjc2OCx0PTEwLHA9MSRXMnQyRjVEWVNRYWtUOFZaUEJlTHRRJGMrb0RTdThiWG4zemQ2Q3NyM2RnN2huY3RqemEyUXFVMnladlZyL2w3YlU=\n$argon2id$v=19$m=32768,t=10,p=1$W2t2F5DYSQakT8VZPBeLtQ$c+oDSu8bXn3zd6Csr3dg7hnctjza2QqU2yZvVr/l7bU\n</code></pre>","tags":["administration","developer","configuration","Hashed Passwords","Entry manager"]},{"location":"janssen-server/config-guide/link-configuration/","title":"Jans Link Configuration","text":"<p>Details of how to configure Jans Link have been covered under Jans Link section.</p>","tags":["administration","configuration","link"]},{"location":"janssen-server/config-guide/session/","title":"Session","text":"<p>The Janssen Server provides multiple configuration tools to manage the session.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to use Jans CLI here or jump straight to the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal. Learn how to use Jans Text-based UI (TUI) here or jump straight to the Using Text-based UI</p> <p>Use REST API for programmatic access or invoke it via tools like CURL or Postman. Learn how to use Janssen Server Config API here or jump straight to the Using Configuration REST API</p>","tags":["administration","configuration","session"]},{"location":"janssen-server/config-guide/session/#using-the-command-line","title":"Using The Command Line","text":"<p>In the Janssen Server, you can get session detail using the command line. To get the details of Janssen command line operations relevant to the session, check the operations under the <code>AuthSessionManagement</code> task using the command below.</p> Command<pre><code>jans cli --info AuthSessionManagement\n</code></pre> Sample Output<pre><code>Operation ID: get-session-by-id\n  Description: Get session by id.\n  Parameters:\n  sid: Session identifier. [string]\nOperation ID: delete-session\n  Description: Delete a session.\n  Parameters:\n  sid: Session identifier. [string]\nOperation ID: revoke-user-session\n  Description: Revoke all sessions by userDn\n  Parameters:\n  userDn: User domain name [string]\nOperation ID: get-sessions\n  Description: Return all session\nOperation ID: search-session\n  Description: Search session\n  Parameters:\n  limit: Search size - max size of the results to return [integer]\n  pattern: Search pattern [string]\n  startIndex: The 1-based index of the first query result [integer]\n  sortBy: Attribute whose value will be used to order the returned response [string]\n  sortOrder: Order in which the sortBy param is applied. Allowed values are \"ascending\" and \"descending\" [string]\n  fieldValuePair: Field and value pair for seraching [string]\n</code></pre>","tags":["administration","configuration","session"]},{"location":"janssen-server/config-guide/session/#get-all-sessions","title":"Get All Sessions","text":"<p>Use the operation ID get-sessions to get all the sessions on the Janssen Server.</p> Command<pre><code>jans cli --operation-id get-sessions\n</code></pre> Sample Output<pre><code>{\n  \"start\": 0,\n  \"totalEntriesCount\": 57,\n  \"entriesCount\": 50,\n  \"entries\": [\n    {\n      \"outsideSid\": \"52aaa70c-f526-43fb-bf0d-3fb86fbd171c\",\n      \"lastUsedAt\": \"2025-01-22T09:11:35\",\n      \"authenticationTime\": \"2025-01-22T09:11:35\",\n      \"state\": \"unauthenticated\",\n      \"sessionState\": \"752d881d793fa7ee8c0e93d55d64ea091783dd0aa34087dd35eeb15d85e356dc.01d7ca76-a5fa-4fa0-b8a4-40ea6506f596\",\n      \"permissionGrantedMap\": {\n        \"permissionGranted\": {\n          \"6d5d9076-848c-46fb-ade4-8cc45939490f\": false\n        }\n      },\n      \"sessionAttributes\": {\n        \"acr\": \"agama_co.acme.password\",\n        \"opbs\": \"3e2343ab-f53f-462a-85c1-54ee2fab282d\",\n        \"scope\": \"openid\",\n        \"auth_step\": \"1\",\n        \"client_id\": \"6d5d9076-848c-46fb-ade4-8cc45939490f\",\n        \"remote_ip\": \"103.54.21.218\",\n        \"acr_values\": \"agama_co.acme.password\",\n        \"redirect_uri\": \"https://ossdhaval-hardy-tortoise.gluu.info\",\n        \"response_type\": \"code\"\n      },\n      \"expirationDate\": \"2025-01-22T11:11:35\",\n      \"deletable\": true,\n      \"creationDate\": \"2025-01-22T09:11:35\",\n      \"persisted\": false,\n      \"ttl\": 0,\n      \"opbrowserState\": \"3e2343ab-f53f-462a-85c1-54ee2fab282d\"\n    },\n    {\n      \"outsideSid\": \"b5673b54-3e9a-4546-8084-1293a13f2135\",\n      \"lastUsedAt\": \"2025-01-23T07:26:58\",\n      \"userDn\": \"inum=b1175c2c-78c7-4361-8f8e-a90bbf164d28,ou=people,o=jans\",\n      \"authenticationTime\": \"2025-01-23T07:26:58\",\n      \"state\": \"authenticated\",\n      \"sessionState\": \"217fe1b3e88065f5807ac5edf7a67e90b9396931d7530f1d86abb81c0f2e321b.7e677df9-2037-4a60-bc89-c44a7b954c82\",\n      \"permissionGrantedMap\": {\n        \"permissionGranted\": {\n          \"8af59ff6-7e38-4e9b-a92e-62d730cdd856\": true\n        }\n      },\n    }\n.....\n.....\n.....\n</code></pre>","tags":["administration","configuration","session"]},{"location":"janssen-server/config-guide/session/#get-session-by-id","title":"Get Session by ID","text":"<p>We can view the specific session details through its <code>sid</code> using <code>get-session-by-id</code> operation. For example, we can use <code>sid:bdb46abb-06e6-453e-9251-b0b697070d6a</code> with <code>--url-suffix</code> to retrieve the session details.</p> <p>The following command is below:</p> Command<pre><code>jans cli --operation-id get-session-by-id \\\n--url-suffix=\"sid:bdb46abb-06e6-453e-9251-b0b697070d6a\"\n</code></pre> Command Output<pre><code>{\n  \"outsideSid\": \"bdb46abb-06e6-453e-9251-b0b697070d6a\",\n  \"lastUsedAt\": \"2025-01-17T06:05:59\",\n  \"userDn\": \"inum=b1175c2c-78c7-4361-8f8e-a90bbf164d28,ou=people,o=jans\",\n  \"authenticationTime\": \"2025-01-17T06:05:59\",\n  \"state\": \"authenticated\",\n  \"sessionState\": \"b74bda0d78e525b5066b73dc6421247a27902490193b2729b037c09b5da82151.07f309ef-413f-46e1-9a14-c571d3d3117f\",\n  \"permissionGrantedMap\": {\n    \"permissionGranted\": {\n      \"61589e3d-bed3-42b2-8153-06a93e851644\": true\n    }\n  },\n  \"sessionAttributes\": {\n    \"acr\": \"agama_org.gluu.agama.pw.main\",\n    \"sid\": \"bdb46abb-06e6-453e-9251-b0b697070d6a\",\n    \"opbs\": \"870cd8ae-80da-40b5-b739-443f013285b9\",\n    \"scope\": \"openid\",\n    \"agamaData\": \"{\\\"userId\\\":\\\"admin\\\",\\\"_encInum\\\":\\\"jgVQd77oPq50rexblyE9tgmPgwgpZt1u4OWRFCYHFaKx99r/aU6HWQ==\\\"}\",\n    \"auth_step\": \"1\",\n    \"auth_user\": \"admin\",\n    \"client_id\": \"61589e3d-bed3-42b2-8153-06a93e851644\",\n    \"remote_ip\": \"103.54.21.218\",\n    \"acr_values\": \"agama_org.gluu.agama.pw.main\",\n    \"redirect_uri\": \"https://ossdhaval-hardy-tortoise.gluu.info\",\n    \"response_type\": \"code\",\n    \"auth_external_attributes\": \"[{\\\"agamaData\\\":\\\"java.lang.String\\\"}]\",\n    \"successful_rp_redirect_count\": \"1\",\n    \"61589e3d-bed3-42b2-8153-06a93e851644_authz_scopes\": \"openid\"\n  },\n  \"expirationDate\": \"2025-01-18T06:05:28\",\n  \"deletable\": true,\n  \"creationDate\": \"2025-01-17T06:05:28\",\n  \"persisted\": false,\n  \"ttl\": 0,\n  \"opbrowserState\": \"870cd8ae-80da-40b5-b739-443f013285b9\"\n}\n</code></pre>","tags":["administration","configuration","session"]},{"location":"janssen-server/config-guide/session/#search-session","title":"Search session","text":"<p>We can search the session based on the <code>limit</code> using the <code>search-session</code> operation. For example, if we set the limit to 2, we will receive the details of two sessions.</p> Command<pre><code>jans cli --operation-id search-session \\\n--endpoint-args limit:2\n</code></pre> Command Output<pre><code>{\n  \"start\": 0,\n  \"totalEntriesCount\": 57,\n  \"entriesCount\": 2,\n  \"entries\": [\n    {\n      \"outsideSid\": \"52aaa70c-f526-43fb-bf0d-3fb86fbd171c\",\n      \"lastUsedAt\": \"2025-01-22T09:11:35\",\n      \"authenticationTime\": \"2025-01-22T09:11:35\",\n      \"state\": \"unauthenticated\",\n      \"sessionState\": \"752d881d793fa7ee8c0e93d55d64ea091783dd0aa34087dd35eeb15d85e356dc.01d7ca76-a5fa-4fa0-b8a4-40ea6506f596\",\n      \"permissionGrantedMap\": {\n        \"permissionGranted\": {\n          \"6d5d9076-848c-46fb-ade4-8cc45939490f\": false\n        }\n      },\n      \"sessionAttributes\": {\n        \"acr\": \"agama_co.acme.password\",\n        \"opbs\": \"3e2343ab-f53f-462a-85c1-54ee2fab282d\",\n        \"scope\": \"openid\",\n        \"auth_step\": \"1\",\n        \"client_id\": \"6d5d9076-848c-46fb-ade4-8cc45939490f\",\n        \"remote_ip\": \"103.54.21.218\",\n        \"acr_values\": \"agama_co.acme.password\",\n        \"redirect_uri\": \"https://ossdhaval-hardy-tortoise.gluu.info\",\n        \"response_type\": \"code\"\n      },\n      \"expirationDate\": \"2025-01-22T11:11:35\",\n      \"deletable\": true,\n      \"creationDate\": \"2025-01-22T09:11:35\",\n      \"persisted\": false,\n      \"ttl\": 0,\n      \"opbrowserState\": \"3e2343ab-f53f-462a-85c1-54ee2fab282d\"\n    },\n    {\n      \"outsideSid\": \"b5673b54-3e9a-4546-8084-1293a13f2135\",\n      \"lastUsedAt\": \"2025-01-23T07:26:58\",\n      \"userDn\": \"inum=b1175c2c-78c7-4361-8f8e-a90bbf164d28,ou=people,o=jans\",\n      \"authenticationTime\": \"2025-01-23T07:26:58\",\n      \"state\": \"authenticated\",\n      \"sessionState\": \"217fe1b3e88065f5807ac5edf7a67e90b9396931d7530f1d86abb81c0f2e321b.7e677df9-2037-4a60-bc89-c44a7b954c82\",\n      \"permissionGrantedMap\": {\n        \"permissionGranted\": {\n          \"8af59ff6-7e38-4e9b-a92e-62d730cdd856\": true\n        }\n      },\n      \"sessionAttributes\": {\n        \"acr\": \"agama_co.acme.password\",\n        \"sid\": \"b5673b54-3e9a-4546-8084-1293a13f2135\",\n        \"opbs\": \"9f2d7434-7018-4bc0-9634-e8efc442c3e8\",\n        \"nonce\": \"bd524096-0e47-45ba-8912-e7c0e3813116\",\n        \"scope\": \"openid\",\n        \"state\": \"d8tg4smk0p\",\n        \"agamaData\": \"{\\\"userId\\\":\\\"admin\\\",\\\"_encInum\\\":\\\"jgVQd77oPq50rexblyE9tgmPgwgpZt1u4OWRFCYHFaKx99r/aU6HWQ==\\\"}\",\n        \"auth_step\": \"1\",\n        \"auth_user\": \"admin\",\n        \"client_id\": \"8af59ff6-7e38-4e9b-a92e-62d730cdd856\",\n        \"remote_ip\": \"103.54.21.218\",\n        \"acr_values\": \"agama_co.acme.password\",\n        \"redirect_uri\": \"https://ossdhaval-hardy-tortoise.gluu.info\",\n        \"response_type\": \"code\",\n        \"code_challenge\": \"9mfiZGOOF3KmtfpBI7SY_g5wVTslqkvMQGNAxrfeEso\",\n        \"code_challenge_method\": \"S256\",\n        \"auth_external_attributes\": \"[{\\\"agamaData\\\":\\\"java.lang.String\\\"}]\",\n        \"successful_rp_redirect_count\": \"1\",\n        \"8af59ff6-7e38-4e9b-a92e-62d730cdd856_authz_scopes\": \"openid\"\n      },\n      \"expirationDate\": \"2025-01-24T07:26:51\",\n      \"deletable\": true,\n      \"creationDate\": \"2025-01-23T07:26:51\",\n      \"persisted\": false,\n      \"ttl\": 0,\n      \"opbrowserState\": \"9f2d7434-7018-4bc0-9634-e8efc442c3e8\"\n    }\n  ]\n}\n</code></pre>","tags":["administration","configuration","session"]},{"location":"janssen-server/config-guide/session/#delete-a-session","title":"Delete a session","text":"<p>We can delete the specific session through its <code>sid</code> using delete-session<code>operation. For example, We can use</code>sid:bdb46abb-06e6-453e-9251-b0b697070d6a<code>with</code>--url-suffix` to delete the session. The following command is below:</p> Command<pre><code>jans cli --operation-id delete-session /\n--url-suffix=\"sid:bdb46abb-06e6-453e-9251-b0b697070d6a\"\n</code></pre> <p>This message will be displayed:</p> <pre><code>Object was successfully deleted.\n</code></pre>","tags":["administration","configuration","session"]},{"location":"janssen-server/config-guide/session/#revoke-all-sessions-by-userdn","title":"Revoke all sessions by userDn","text":"<p>We can revoke the session for the user through its <code>userDn</code> using <code>revoke-user-session</code> operation. For example, We can use <code>userDn:inum=b1175c2c-78c7-4361-8f8e-a90bbf164d28,ou=people,o=jans</code> with <code>--url-suffix</code> to revoke the session. The following command is below:</p> Command<pre><code>jans cli --operation-id revoke-user-session /\n--url-suffix=\"userDn:inum=b1175c2c-78c7-4361-8f8e-a90bbf164d28,ou=people,o=jans\"\n</code></pre> <p>This message will be displayed:</p> <pre><code>Object was successfully deleted.\n</code></pre>","tags":["administration","configuration","session"]},{"location":"janssen-server/config-guide/session/#using-text-based-ui","title":"Using Text-based UI","text":"<p>Start TUI using the command below:</p> Command<pre><code>jans tui\n</code></pre>","tags":["administration","configuration","session"]},{"location":"janssen-server/config-guide/session/#session-screen","title":"Session screen","text":"<p>Navigate to <code>Auth Server</code> -&gt; <code>Session</code> to open the Session screen as shown in the image below. This screen provides the available search session functionality. where we can search sessions by user with filters for <code>expires after</code> and <code>expires before</code> dates.</p> <p></p> <p>To get the detail of any session, bring the control on that session (using the tab key), and press <code>v</code> key. You can also <code>export</code> the details.</p> <p>To delete a session, bring the control on that session (using the tab key), and press <code>Delete</code> key.</p> <p></p>","tags":["administration","configuration","session"]},{"location":"janssen-server/config-guide/session/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring the session. Endpoint details are published in the Swagger document.</p>","tags":["administration","configuration","session"]},{"location":"janssen-server/config-guide/smtp-configuration/","title":"SMTP Configuration","text":"<p>The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal.  Learn how to use Jans Text-based UI (TUI)  here or jump straight to the Using Text-based UI</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here or Jump straight to the Using Configuration REST API</p>","tags":["administration","configuration","smtp"]},{"location":"janssen-server/config-guide/smtp-configuration/#using-command-line","title":"Using Command Line","text":"<p>In the Janssen Server, you can deploy and customize the SMTP using the command line. To get the details of Janssen command line operations relevant to SMTP Configuration, you can check the operations under <code>ConfigurationSmtp</code> task using the command below:</p> Command<pre><code>jans cli --info ConfigurationSmtp\n</code></pre> Sample Output<pre><code>Operation ID: get-config-smtp\n Description: Returns SMTP server configuration\nOperation ID: put-config-smtp\n Description: Updates SMTP server configuration\n Schema: SmtpConfiguration\nOperation ID: post-config-smtp\n Description: Adds SMTP server configuration\n Schema: SmtpConfiguration\nOperation ID: delete-config-smtp\n Description: Deletes SMTP server configuration\nOperation ID: test-config-smtp\n Description: Signing Test SMTP server configuration\n Schema: SmtpTest\n</code></pre>","tags":["administration","configuration","smtp"]},{"location":"janssen-server/config-guide/smtp-configuration/#find-smtp-server-configuration","title":"Find SMTP Server Configuration","text":"<p>To view the current SMTP server configuration, run the following command line:</p> Command<pre><code>jans cli --operation-id get-config-smtp\n</code></pre> <p>It will show the SMTP server configuration as below:</p> Sample Output<pre><code>{\n  \"valid\": false,\n  \"port\": 0,\n  \"trust_host\": false,\n  \"requires_authentication\": false,\n  \"key_store\": \"/etc/certs/smtp-keys.pkcs12\",\n  \"key_store_password\": \"kb5JITTrmCyX1LNEp8uorA==\",\n  \"key_store_alias\": \"smtp_sig_ec256\",\n  \"signing_algorithm\": \"SHA256withECDSA\"\n}\n</code></pre>","tags":["administration","configuration","smtp"]},{"location":"janssen-server/config-guide/smtp-configuration/#setup-new-smtp-server-configuration","title":"Setup New SMTP Server Configuration","text":"<p>To add a new SMTP Server, we can use <code>post-config-smtp</code> operation id. As shown in the output for <code>--info</code> command, the <code>post-config-smtp</code> operation requires data to be sent according to the <code>SmtpConfiguration</code> schema.</p> <p>To see the schema, use the command below: Command<pre><code>jans cli --schema SmtpConfiguration \n</code></pre></p> <p>The Janssen Server also provides an example of data that adheres to the above schema. To fetch the example, use the command below.</p> Command<pre><code>jans cli --schema-sample SmtpConfiguration \n</code></pre> <p>Using the schema and the example above, we have added below data to the file <code>/tmp/smtp.json</code>.</p> Input<pre><code>{\n  \"valid\": true,\n  \"host\": \"string\",\n  \"port\": 5,\n  \"connect_protection\": \"StartTls\",\n  \"trust_host\": false,\n  \"from_name\": \"jans\",\n  \"from_email_address\": \"string\",\n  \"requires_authentication\": false,\n  \"smtp_authentication_account_username\": \"string\",\n  \"smtp_authentication_account_password\": \"string\",\n  \"key_store\": \"string\",\n  \"key_store_password\": \"string\",\n  \"key_store_alias\": \"string\",\n  \"signing_algorithm\": \"string\"\n}\n</code></pre> <p>To setup a new SMTP server configuration, run the following command:</p> Command<pre><code>jans cli --operation-id post-config-smtp \\\n--data /tmp/smtp.json\n</code></pre> Sample Output<pre><code>{\n  \"valid\": true,\n  \"host\": \"string\",\n  \"port\": 5,\n  \"connect_protection\": \"StartTls\",\n  \"trust_host\": false,\n  \"from_name\": \"jans\",\n  \"from_email_address\": \"string\",\n  \"requires_authentication\": false,\n  \"smtp_authentication_account_username\": \"string\",\n  \"smtp_authentication_account_password\": \"CGmVqM6v4Hs=\",\n  \"key_store\": \"string\",\n  \"key_store_password\": \"CGmVqM6v4Hs=\",\n  \"key_store_alias\": \"string\",\n  \"signing_algorithm\": \"string\"\n}\n</code></pre>","tags":["administration","configuration","smtp"]},{"location":"janssen-server/config-guide/smtp-configuration/#update-smtp-server-configuration","title":"Update SMTP Server Configuration","text":"<p>To update the SMTP server, we can use the <code>put-config-smtp</code> operation id. Simply change any information on <code>/tmp/smtp.json</code> file and run the following command:</p> <p>In that file, update the value <code>false</code> to <code>true</code> of the <code>trust_host</code> field.</p> <p>Command<pre><code>jans cli --operation-id put-config-smtp \\\n--data /tmp/smtp.json\n</code></pre> It will update the information.</p>","tags":["administration","configuration","smtp"]},{"location":"janssen-server/config-guide/smtp-configuration/#delete-smtp-sever-configuration","title":"Delete SMTP Sever Configuration","text":"<p>To delete the SMTP Sever, we can use the <code>delete-config-smtp</code> operation id. run the following command</p> Command<pre><code>jans cli --operation-id delete-config-smtp\n</code></pre>","tags":["administration","configuration","smtp"]},{"location":"janssen-server/config-guide/smtp-configuration/#test-smtp-server-configuration","title":"Test SMTP Server Configuration","text":"<p>Testing SMTP Server configuration token with <code>https://jans.io/oauth/config/smtp.write</code> scope is required. To test the SMTP server configuration update, change any information on the <code>/tmp/smtp.json</code> file with test data and run the following command:</p> <p>Command<pre><code>jans cli --operation-id test-config-smtp \\\n--data /tmp/smtp.json\n</code></pre> This will return status code 200 with a response as true or false based on the SMTP test result. Note:  <code>SMTP Password</code> should be an App password and not a web login password.</p>","tags":["administration","configuration","smtp"]},{"location":"janssen-server/config-guide/smtp-configuration/#using-text-based-ui","title":"Using Text-based UI","text":"<p>Start TUI using the command below:</p> Command<pre><code>jans tui\n</code></pre>","tags":["administration","configuration","smtp"]},{"location":"janssen-server/config-guide/smtp-configuration/#smpt-screen","title":"SMPT Screen","text":"<p>Navigate to <code>Auth Server</code> -&gt; <code>SMPT</code> to open the SMPT screen.</p> <p>The SMTP screen displays the input fields. Please enter the following data in these fields.</p> <ul> <li>SMTP Host: <code>smtp.gmail.com</code></li> <li>SMTP Port: <code>587</code></li> <li>StartTls: <code>true</code></li> <li>From Name: Enter the sender\u2019s name</li> <li>From Email Address: Enter the sender\u2019s email address</li> <li>SMTP User name: Your full Gmail address</li> <li>Requires Authentication: <code>true</code></li> <li>SMTP password: Add <code>App Password</code> form gmail account <ul> <li>Since you are using Gmail, an <code>App Password</code> is required for authentication. To create an App Password, follow the instructions in the Gmail Support documentation.</li> </ul> </li> <li>Trust Server: <code>true</code></li> <li> <p>After changing the SMPT data, update the SMPT server using the <code>Save</code> button.</p> <p></p> </li> <li> <p>Test the SMTP server using the <code>Test</code> button, and the result will be displayed as shown below.</p> <p></p> </li> </ul>","tags":["administration","configuration","smtp"]},{"location":"janssen-server/config-guide/smtp-configuration/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring the SMTP. Endpoint details are published in the Swagger document.</p>","tags":["administration","configuration","smtp"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/","title":"Agama project configuration","text":"<p>Agama project configuration involves adding and removing Agama projects to Janssen Server along with configuring and troubleshooting these project deployments.</p> <p>The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the configuration steps</p> <p>Use a fully functional text-based user interface from the terminal.  Learn how to use Jans Text-based UI (TUI)  here or jump straight to the configuration steps</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here or Jump straight to the configuration steps</p>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#using-command-line","title":"Using Command Line","text":"<p>In the Janssen Server, you can deploy and customize the Agama project using the command line. To get the details of Janssen command line operations relevant to Agama projects, you can check the operations under <code>Agama</code> task using the command below:</p> Command<pre><code>jans cli --info Agama\n</code></pre> <p>It will show the details of the available operation-ids for Agama.</p> <pre><code>Operation ID: get-agama-prj-by-name\n  Description: Fetches deployed the Agama project based on the name.\n  Parameters:\n  name: Agama project name [string]\nOperation ID: post-agama-prj\n  Description: Deploy an Agama project.\n  Parameters:\n  name: Agama project name [string]\nOperation ID: delete-agama-prj\n  Description: Delete a deployed Agama project.\n  Parameters:\n  name: Agama project name [string]\nOperation ID: get-agama-prj-configs\n  Description: Retrieve the list of configs based on name.\n  Parameters:\n  name: Agama project name [string]\nOperation ID: put-agama-prj\n  Description: Update an Agama project.\n  Parameters:\n  name: Agama project name [string]\n  Parameters:\n    type: Description not found for this property\n    additionalProperties: Description not found for this property\nOperation ID: get-agama-prj\n  Description: Retrieve the list of projects deployed currently.\n  Parameters:\n  start: No description is provided for this parameter [integer]\n  count: No description is provided for this parameter [integer]\n</code></pre> <p>In the sections below, we will see how to configure and manage Agama projects via the command line using the above operations.</p>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#list-deployed-projects","title":"List Deployed Projects","text":"<p>Use the <code>get-agama-prj</code> operation to retrieve the list of deployed Agama projects:</p> Command<pre><code>jans cli --operation-id get-agama-prj\n</code></pre> <p>The output will list Agama projects that are added to this Janssen Server deployment.</p> Sample Output<pre><code>{\n  \"start\": 0,\n  \"totalEntriesCount\": 1,\n  \"entriesCount\": 1,\n  \"entries\": [\n    {\n      \"dn\": \"jansId=46546e9a-fed6-34d0-ba63-b615233b2115,ou=deployments,ou=agama,o=jans\",\n      \"id\": \"46546e9a-fed6-34d0-ba63-b615233b2115\",\n      \"createdAt\": \"2023-08-13T14:45:27\",\n      \"taskActive\": false,\n      \"finishedAt\": \"2023-08-13T14:45:43\",\n      \"details\": {\n        \"error\": \"There were problems processing one or more flows\",\n        \"flowsError\": {\n          \"mmrraju.np.test.me\": null,\n          \"mmrraju.test2.agama\": null,\n          \"mmrraju.u2f.me\": \"Syntax error: mismatched input '&lt;EOF&gt;' expecting {'|', 'Log', 'Trigger', 'Call', 'RRF', 'When', 'Repeat', 'Iterate over', 'Match', 'Finish', 'RFAC', ALPHANUM, QNAME, DOTEXPR, DOTIDXEXPR, WS}\\nSymbol: [@9,43:42='&lt;EOF&gt;',&lt;-1&gt;,2:23]\\nLine: 2\\nColumn: 24\"\n        },\n        \"projectMetadata\": {\n          \"projectName\": \"user_pass_auth\",\n          \"author\": \"mmrraju\",\n          \"type\": \"community\",\n          \"description\": \"This is password based authentication\",\n          \"version\": \"1.0.34\",\n          \"configs\": null\n        }\n      },\n      \"baseDn\": \"jansId=46546e9a-fed6-34d0-ba63-b615233b2115,ou=deployments,ou=agama,o=jans\"\n    }\n  ]\n}\n</code></pre>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#endpoint-arguments","title":"Endpoint Arguments","text":"<p>Endpoint arguments are parameters passed to an API or function to specify how and what data to retrieve or process.</p> <p>There are two endpoint arguments available to the <code>get-agama-prj</code> operation.</p> <ul> <li> <p><code>start</code>: Should be an integer value. It's an index value of the starting point    of the list.</p> </li> <li> <p><code>count</code>: Should be an integer value. Total entries number you want to display.</p> </li> </ul> <p>For example, to fetch details of the project at index 1 only, use the command below.</p> Command<pre><code>jans cli --operation-id get-agama-prj --endpoint-args start:1,count:1\n</code></pre> Sample Output<pre><code>{\n  \"start\": 1,\n  \"totalEntriesCount\": 3,\n  \"entriesCount\": 1,\n  \"entries\": [\n    {\n      \"dn\": \"jansId=3a0e91a4-b79b-37c2-9df7-122247e8ed9c,ou=deployments,ou=agama,o=jans\",\n      \"id\": \"3a0e91a4-b79b-37c2-9df7-122247e8ed9c\",\n      \"createdAt\": \"2023-08-15T05:56:19\",\n      \"taskActive\": false,\n      \"finishedAt\": \"2023-08-15T05:56:42\",\n      \"details\": {\n        \"error\": \"Archive missing web and/or code subdirectories\",\n        \"flowsError\": null,\n        \"projectMetadata\": {\n          \"projectName\": \"testAuth\",\n          \"configs\": null\n        }\n      },\n      \"baseDn\": \"jansId=3a0e91a4-b79b-37c2-9df7-122247e8ed9c,ou=deployments,ou=agama,o=jans\"\n    }\n  ]\n}\n</code></pre>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#view-agama-project-by-name","title":"View Agama Project By Name","text":"<p>You can get the details of an Agama project deployed in the Janssen Server by the project name. The command line for this operation is as below:</p> Sample Command<pre><code>jans cli --operation-id get-agama-prj-by-name --url-suffix=\"agama-project-name\"\n</code></pre> <p>Example: Sample Command<pre><code>jans cli --operation-id get-agama-prj-by-name --url-suffix=\"testAuth\"\n</code></pre></p> Sample Output<pre><code>{\n  \"dn\": \"jansId=3a0e91a4-b79b-37c2-9df7-122247e8ed9c,ou=deployments,ou=agama,o=jans\",\n  \"id\": \"3a0e91a4-b79b-37c2-9df7-122247e8ed9c\",\n  \"createdAt\": 1687247278717,\n  \"taskActive\": false,\n  \"finishedAt\": 1687247288646,\n  \"assets\": null,\n  \"details\": {\n    \"folders\": null,\n    \"libs\": [],\n    \"flowsError\": {\n      \"imShakil.co.basicAuth\": null\n    },\n    \"error\": null,\n    \"projectMetadata\": {\n      \"projectName\": \"testAuth\",\n      \"author\": \"imShakil\",\n      \"type\": \"community\",\n      \"description\": \"testing authentication with janssen server\",\n      \"version\": \"1.0.0\",\n      \"configs\": null\n    }\n  },\n  \"baseDn\": \"jansId=3a0e91a4-b79b-37c2-9df7-122247e8ed9c,ou=deployments,ou=agama,o=jans\"\n}\n</code></pre>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#post-agama-project-in-janssen","title":"Post Agama Project in Janssen","text":"<p>You can deploy the Agama project in the Janssen Server through the command line using the <code>post-agama-prj</code> operation. Here the <code>agama-project-file</code> is an archive file that holds the bundled Agama project and follows the .gama specification.</p> Sample Command<pre><code>jans cli --operation-id post-agama-prj \\\n--url-suffix=\"name:project-name\" --data agama-project-file\n</code></pre> <p>Example:</p> <p>Let's upload a test project Zip file. This zip file contains the artifacts of an Agama project and follows the <code>.gama</code> specification. Assuming that the zip file has been downloaded in the folder at path <code>/tmp/journey.zip</code>, the command below will upload a new Agama project with specified name in the Janssen Server.</p> Sample Command<pre><code>jans cli --operation-id=post-agama-prj \\\n--url-suffix=\"name:Agama Lab Journey\" --data /tmp/journey.zip\n</code></pre> Sample Output<pre><code>{\n  \"message\": \"A deployment task for project Agama Lab Journey has been queued. Use the GET endpoint to poll status\"\n}\n</code></pre> <p>Now the project should be available in the list of deployed projects.</p>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#retrieve-agama-project-configuration","title":"Retrieve Agama Project Configuration","text":"<p>To retrieve the Agama project configuration, use the <code>get-agama-prj-configs</code> operation.</p> Sample Command<pre><code>jans cli --operation-id get-agama-prj-configs \\\n--url-suffix=\"name:agama-project-name\"\n</code></pre>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#update-agama-project","title":"Update Agama Project","text":"<p>Let's update the configuration for project that we uploaded in the section above:</p> <p>Take the sample project configuration and keep it under <code>/tmp/journey-configs.json</code>.</p> <p>Make a few test changes to the configuration and run the command below to update the configuration:</p> Command<pre><code>jans cli --operation-id=put-agama-prj \\\n--url-suffix \"name:Agama Lab Journey\" --data /tmp/journey-configs.json \n</code></pre> Sample Output<pre><code>{\n  \"io.jans.agamaLab.registration\": true,\n  \"io.jans.agamaLab.main\": true,\n  \"io.jans.agamaLab.credsEnrollment.otp\": true,\n  \"io.jans.agamaLab.authenticator.super_gluu\": true,\n  \"io.jans.agamaLab.credsEnrollment.super_gluu\": true,\n  \"io.jans.agamaLab.githubAuthn\": true\n}\n</code></pre>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#delete-agama-project","title":"Delete Agama Project","text":"<p>To delete an Agama project by its name, use the <code>delete-agama-prj</code> operation.</p> Sample Command<pre><code>jans cli --operation-id delete-agama-prj --url-suffix=\"agama-project-name\"\n</code></pre>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#agama-flow-configuration","title":"Agama Flow Configuration","text":"<p><code>AgamaConfiguration</code> task groups operations that help understand the correctness of the deployed Agama project configuration.</p> Command<pre><code>jans cli --info AgamaConfiguration\n</code></pre> Sample Output<pre><code>Operation ID: agama-syntax-check\n  Description: Determine if the text passed is valid Agama code\n  Parameters:\n  qname: Agama Flow name [string]\n</code></pre>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#agama-flow-dsl-syntax","title":"Agama Flow DSL Syntax","text":"<p>To check if a deployed Agama project is running into Agama DSL related errors, use the <code>agama-syntax-check</code> operation as below:</p> Sample Command<pre><code>jans cli --operation-id agama-syntax-check \\\n--url-suffix qname:\"fully-qualified-flow-name\"\n</code></pre> <p>Example:</p> Command<pre><code>jans cli --operation-id agama-syntax-check --url-suffix qname:\"imShakil.co.test\"\n</code></pre> Sample Output<pre><code>{\n  \"error\": \"mismatched input 'newline' expecting 'Flow'\",\n  \"symbol\": \"[@0,0:-1='newline',&lt;9&gt;,1:0]\",\n  \"line\": 1,\n  \"column\": 0,\n  \"message\": \"Syntax error: mismatched input 'newline' expecting 'Flow'\\nSymbol: [@0,0:-1='newline',&lt;9&gt;,1:0]\\nLine: 1\\nColumn: 1\"\n}\n</code></pre>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#using-text-based-ui","title":"Using Text-based UI","text":"<p>In Janssen, You can deploy and customize an Agama project using the Text-Based UI also.</p> <p>You can start TUI using the command below:</p> Command<pre><code>jans tui\n</code></pre>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#agama-project-screen","title":"Agama Project Screen","text":"<p>Navigate to <code>Auth Server</code> -&gt; <code>Agama</code> to open the Agama projects screen as shown in the image below.</p> <p></p> <ul> <li> <p>To get the list of currently added projects, bring the control to <code>Search</code> box   (using the tab key), and press <code>Enter</code>. Type the search string to search for   projects with matching names.</p> </li> <li> <p>Add a new project using <code>Add a New Project</code> button. It will open a dialogue where   you can either deploy a local project or deploy an Agama Lab community project   as shown in the image below.</p> </li> </ul> <p></p> <ol> <li> <p>If you select the first option, it'll open the explore     dialogue. Using this dialogue, navigate the file system and select     the <code>.gama</code> archive for the new project.</p> </li> <li> <p>If you select the second option, it'ill collect a list of Agama Lab     community projects from GitHub and display a selection list as shown in     the image below.</p> <p></p> </li> </ol>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#agama-project-help-menu","title":"Agama Project Help Menu","text":"<p>TUI provides key-press commands to open various dialogues that help manage and configure Agama projects. All the key-press commands are listed in the help menu. Press <code>F1</code> to bring up the help menu as shown in the screen below.</p> <p></p>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#agama-project-detail-screen","title":"Agama Project Detail Screen","text":"<p>Use the appropriate key-press command from help screen to bring up the project detail screen which is shown in the image below.</p> <p></p> <p>The project details screen shows important details about the Agama project. In case the project deployment is facing an error, this screen also shows these errors and the corresponding flows.</p> <p>All the flows in the project are also listed by their fully qualified names. Fully qualified names are useful when invoking flows.</p> <p>The project details screen also shows the JSON configuration by navigating to and pressing the <code>View Configuration</code> button.</p> <p></p>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#agama-project-configuration-screen","title":"Agama Project Configuration Screen","text":"<p>Use the appropriate key-press command from help screen to bring up the Agama project configuration screen which is shown in the image below.</p> <ul> <li>The screen allows the export and import of the configuration.</li> <li>The sample configuration can serve as a template. Export it into a file, then   make the necessary changes to it and import it back to correctly   configure the project.</li> </ul> <p></p>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/agama-project-configuration/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring Agama projects. Endpoint details are published in the Swagger document.</p>","tags":["administration","configuration","agama project"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/","title":"Attributes","text":"<p>Note</p> <p><code>Attribute</code> and <code>User Claims</code> refer to the same user data fields in the Janssen Server.</p>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/#attribute","title":"Attribute","text":"<p>User claims are individual pieces of user data, like <code>uid</code> or <code>email</code>, that are required by applications to identify a user and grant access to protect resources.</p> <p>Janssen server's default configuration comes with certain user claims already configured. In addition to these, custom user claims can be added as required. The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal.  Learn how to use Jans Text-based UI (TUI) here or jump straight to the Using Text-based UI</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here  or Jump straight to the Using Configuration REST API</p>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/#using-command-line","title":"Using Command Line","text":"<p>To get the details of Janssen command line operations relevant to user claims configuration, you can check the operations under <code>Attribute</code> task using the command below:</p> <p>First thing, let's get the information for <code>Attribute</code>: Command<pre><code>jans cli --info Attribute\n</code></pre> In return, we get a list of operations IDs as below:</p> Sample Output<pre><code>Operation ID: get-attributes\n  Description: Gets a list of Gluu attributes.\n  Parameters:\n  limit: Search size - max size of the results to return [integer]\n  pattern: Search pattern [string]\n  status: Status of the attribute [string]\n  startIndex: The 1-based index of the first query result [integer]\n  sortBy: Attribute whose value will be used to order the returned response [string]\n  sortOrder: Order in which the sortBy param is applied. Allowed values are \"ascending\" and \"descending\" [string]\n  fieldValuePair: Field and value pair for seraching [string]\nOperation ID: put-attributes\n  Description: Updates an existing attribute\n  Schema: JansAttribute\nOperation ID: post-attributes\n  Description: Adds a new attribute\n  Schema: JansAttribute\nOperation ID: get-attributes-by-inum\n  Description: Gets an attribute based on inum\n  Parameters:\n  inum: Attribute Id [string]\nOperation ID: delete-attributes-by-inum\n  Description: Deletes an attribute based on inum\n  Parameters:\n  inum: Attribute Id [string]\nOperation ID: patch-attributes-by-inum\n  Description: Partially modify a JansAttribute\n  Parameters:\n  inum: Attribute Id [string]\n  Schema: Array of PatchRequest\n\nTo get sample schema type jans cli --schema &lt;schma&gt;, for example jans cli --schema PatchRequest\n</code></pre>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/#get-custom-user-claims","title":"Get Custom User Claims","text":"<p>The user claims that are available in your Janssen Server can be found by using this operation-ID. If we look at the description below:</p> <pre><code>Operation ID: get-attributes\n  Description: Gets a list of Gluu attributes.\n  Parameters:\n  limit: Search size - max size of the results to return [integer]\n  pattern: Search pattern [string]\n  status: Status of the attribute [string]\n  startIndex: The 1-based index of the first query result [integer]\n  sortBy: Attribute whose value will be used to order the returned response [string]\n  sortOrder: Order in which the sortBy param is applied. Allowed values are \"ascending\" and \"descending\" [string]\n  fieldValuePair: Field and value pair for seraching [string]\n</code></pre> <p>To get all the user claims without any arguments, run the following command: Command<pre><code>jans cli --operation-id get-attributes\n</code></pre></p> <p>To get user claims with passing the arguments, let's retrieve randomly limit:1:</p> Command<pre><code>jans cli --operation-id get-attributes --endpoint-args limit:1\n</code></pre> <p>It will return only one user claim details randomly: Sample Output<pre><code>{\n  \"start\": 0,\n  \"totalEntriesCount\": 72,\n  \"entriesCount\": 1,\n  \"entries\": [\n    {\n      \"dn\": \"inum=002A,ou=attributes,o=jans\",\n      \"selected\": false,\n      \"inum\": \"002A\",\n      \"name\": \"eduPersonScopedAffiliation\",\n      \"displayName\": \"eduPersonScopedAffiliation\",\n      \"description\": \"Specifies the person's affiliation within a particular security domainin broad categories such as student, faculty, staff, alum, etc. Thevalues consistof a left and right component separated by an \\\"@\\\" sign. The left component is one ofthe values from the eduPersonAffiliation controlledvocabulary.This right-hand side syntaxof eduPersonScopedAffiliation intentionally matches that used for the right-hand sidevalues for eduPersonPrincipalName since both identify a security domain. Multiple \\\"@\\\" signsare not recommended, but in any case, the first occurrence of the \\\"@\\\" sign starting from theleft is to be taken as the delimiter between components. Thus, user identifier is to the left,security domain to the right of the first \\\"@\\\".\",\n      \"origin\": \"eduPerson\",\n      \"dataType\": \"string\",\n      \"editType\": [\n        \"admin\"\n      ],\n      \"viewType\": [\n        \"admin\"\n      ],\n      \"claimName\": \"edu_person_scoped_affiliation\",\n      \"status\": \"inactive\",\n      \"saml1Uri\": \"urn:mace:dir:attribute-def:eduPersonScopedAffiliation\",\n      \"saml2Uri\": \"urn:oid:1.3.6.1.4.1.5923.1.1.1.9\",\n      \"urn\": \"oid:1.3.6.1.4.1.5923.1.1.1.9\",\n      \"oxMultiValuedAttribute\": false,\n      \"custom\": false,\n      \"adminCanView\": true,\n      \"adminCanEdit\": true,\n      \"userCanView\": false,\n      \"userCanEdit\": false,\n      \"adminCanAccess\": true,\n      \"userCanAccess\": false,\n      \"whitePagesCanView\": false,\n      \"baseDn\": \"inum=002A,ou=attributes,o=jans\"\n    }\n  ]\n}\n</code></pre></p> <p>To get user claim with <code>pattern &amp; status</code>:</p> <p>Command<pre><code>jans cli --operation-id get-attributes \\\n--endpoint-args limit:3,pattern:profile,status:ACTIVE\n</code></pre> In return, we get a list of claims that are matched with the given <code>pattern</code> and <code>status</code>:</p> Sample Output<pre><code>{\n  \"start\": 0,\n  \"totalEntriesCount\": 2,\n  \"entriesCount\": 2,\n  \"entries\": [\n    {\n      \"dn\": \"inum=64A0,ou=attributes,o=jans\",\n      \"selected\": false,\n      \"inum\": \"64A0\",\n      \"name\": \"profile\",\n      \"displayName\": \"Profile URL\",\n      \"description\": \"URL of the End-User's profile page. The contents of this Web page SHOULD be about the End-User.\",\n      \"origin\": \"jansPerson\",\n      \"dataType\": \"string\",\n      \"editType\": [\n        \"user\",\n        \"admin\"\n      ],\n      \"viewType\": [\n        \"user\",\n        \"admin\"\n      ],\n      \"claimName\": \"profile\",\n      \"status\": \"active\",\n      \"saml1Uri\": \"urn:mace:dir:attribute-def:profile\",\n      \"saml2Uri\": \"urn:oid:1.3.6.1.4.1.48710.1.3.321\",\n      \"urn\": \"http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/profile\",\n      \"oxMultiValuedAttribute\": false,\n      \"custom\": false,\n      \"adminCanView\": true,\n      \"adminCanEdit\": true,\n      \"userCanView\": true,\n      \"userCanEdit\": true,\n      \"adminCanAccess\": true,\n      \"userCanAccess\": true,\n      \"whitePagesCanView\": false,\n      \"baseDn\": \"inum=64A0,ou=attributes,o=jans\"\n    },\n    {\n      \"dn\": \"inum=EC3A,ou=attributes,o=jans\",\n      \"selected\": false,\n      \"inum\": \"EC3A\",\n      \"name\": \"picture\",\n      \"displayName\": \"Picture URL\",\n      \"description\": \"URL of the End-User's profile picture\",\n      \"origin\": \"jansPerson\",\n      \"dataType\": \"string\",\n      \"editType\": [\n        \"user\",\n        \"admin\"\n      ],\n      \"viewType\": [\n        \"user\",\n        \"admin\"\n      ],\n      \"claimName\": \"picture\",\n      \"status\": \"active\",\n      \"saml1Uri\": \"urn:mace:dir:attribute-def:picture\",\n      \"saml2Uri\": \"urn:oid:1.3.6.1.4.1.48710.1.3.322\",\n      \"urn\": \"http://openid.net/specs/openid-connect-core-1_0.html/StandardClaims/picture\",\n      \"oxMultiValuedAttribute\": false,\n      \"custom\": false,\n      \"adminCanView\": true,\n      \"adminCanEdit\": true,\n      \"userCanView\": true,\n      \"userCanEdit\": true,\n      \"adminCanAccess\": true,\n      \"userCanAccess\": true,\n      \"whitePagesCanView\": false,\n      \"baseDn\": \"inum=EC3A,ou=attributes,o=jans\"\n    }\n  ]\n}\n</code></pre>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/#creating-a-custom-user-claims","title":"Creating a Custom User Claims","text":"<p>While standard claims provide basic user information, custom user claims allow for the inclusion of domain-specific attributes or application-specific data that might be required for user personalization, authorization, or other business logic. A user claim should be unique and non-null or empty. Follow the steps below to add a custom user claim to the Janssen Server.</p>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/#add-entry-into-persistence","title":"Add entry into persistence","text":"<p>To support the new custom claim, add a column to table <code>jansPerson</code> in the persistence backend.</p> <p>Command will be similar to the one below:</p> MySQL<pre><code>ALTER TABLE  jansPerson  ADD COLUMN &lt;claimName&gt; &lt;dataType&gt;\n</code></pre> <p>Restart the Janssen services below in order to make this change effective:</p> <pre><code>jans-auth.service\n</code></pre> <pre><code>jans-config-api.service\n</code></pre>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/#configure-custom-user-claim-in-the-janssen-server","title":"Configure custom user claim in the Janssen Server","text":"<p>Add and configure the custom claim using <code>post-attributes</code> operation-ID. As shown in the output for the <code>--info</code> command, the <code>post-attributes</code> operation requires data to be sent according to the <code>JansAttribute</code> schema.</p> <p>To see the schema, use the command below:</p> Command<pre><code>jans cli --schema JansAttribute\n</code></pre> <p>The Janssen Server also provides an example of data that adheres to the above schema. To fetch the example, use the command below.</p> Command<pre><code>jans cli --schema-sample JansAttribute\n</code></pre> <p>Using the schema and the example above, add the below data to the file /tmp/custom-claim.json.</p> About datatypes <p><code>JansAttribute</code> schema requires to specify a datatype. This datatype should map correctly to the datatype of the persistence column added above. </p> <p>Use the mapping table to below to correctly specify the datatype in the  Janssen Server configuration. </p> Janssen dataType SQL dataType Text VARCHAR() string value to be kept, SIZE is an integer for max string size Numeric INT Boolean SMALLINT Binary BINARY Certificate TEXT Date DATETIME(3) Numeric INT Multivalued JSON <p>Example:</p> Input<pre><code>{\n  \"dn\": \"string\",\n  \"inum\": \"string\",\n  \"sourceAttribute\": \"string\",\n  \"nameIdType\": \"string\",\n  \"name\": \"newClaim\",\n  \"displayName\": \"New Claim\",\n  \"description\": \"string\",\n  \"origin\": \"string\",\n  \"dataType\": \"json\",\n  \"editType\": [\n    \"whitePages\"\n  ],\n  \"viewType\": [\n    \"user\"\n  ],\n  \"usageType\": [\n    \"openid\"\n  ],\n  \"claimName\": \"string\",\n  \"seeAlso\": \"string\",\n  \"status\": \"active\",\n  \"saml1Uri\": \"string\",\n  \"saml2Uri\": \"string\",\n  \"urn\": \"string\",\n  \"scimCustomAttr\": false,\n  \"oxMultiValuedAttribute\": false,\n  \"jansHideOnDiscovery\": false,\n  \"custom\": true,\n  \"attributeValidation\": {\n    \"minLength\": 85,\n    \"maxLength\": 20,\n    \"regexp\": \"string\"\n  },\n  \"tooltip\": \"string\",\n  \"selected\": true,\n  \"adminCanView\": true,\n  \"adminCanEdit\": false,\n  \"userCanView\": true,\n  \"userCanEdit\": true,\n  \"userCanAccess\": false,\n  \"adminCanAccess\": true,\n  \"whitePagesCanView\": true,\n  \"baseDn\": \"string\"\n}\n</code></pre> <p>Run the following command to add the custom claim:</p> Command<pre><code>jans cli --operation-id post-attributes --data /tmp/custom-claim.json\n</code></pre> Sample Output<pre><code>{\n  \"dn\": \"inum=bc50c4c4-64c8-45b3-9f38-e8527ddbf833,ou=attributes,o=jans\",\n  \"selected\": false,\n  \"inum\": \"bc50c4c4-64c8-45b3-9f38-e8527ddbf833\",\n  \"sourceAttribute\": \"string\",\n  \"nameIdType\": \"string\",\n  \"name\": \"newClaim\",\n  \"displayName\": \"New Claim\",\n  \"description\": \"string\",\n  \"origin\": \"string\",\n  \"dataType\": \"json\",\n  \"editType\": [\n    \"whitePages\"\n  ],\n  \"viewType\": [\n    \"user\"\n  ],\n  \"usageType\": [\n    null\n  ],\n  \"claimName\": \"string\",\n  \"seeAlso\": \"string\",\n  \"status\": \"active\",\n  \"saml1Uri\": \"string\",\n  \"saml2Uri\": \"string\",\n  \"urn\": \"string\",\n  \"scimCustomAttr\": false,\n  \"oxMultiValuedAttribute\": false,\n  \"jansHideOnDiscovery\": false,\n  \"custom\": false,\n  \"attributeValidation\": {\n    \"minLength\": 85,\n    \"maxLength\": 20,\n    \"regexp\": \"string\"\n  },\n  \"tooltip\": \"string\",\n  \"adminCanView\": false,\n  \"adminCanEdit\": false,\n  \"userCanView\": true,\n  \"userCanEdit\": false,\n  \"adminCanAccess\": false,\n  \"userCanAccess\": true,\n  \"whitePagesCanView\": false,\n  \"baseDn\": \"inum=bc50c4c4-64c8-45b3-9f38-e8527ddbf833,ou=attributes,o=jans\"\n}\n</code></pre>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/#updating-a-user-claim","title":"Updating a User Claim","text":"<p>To update the configuration, follow the steps below.</p> <ol> <li>Get the user claim and store it into a file for editing.  The following command will retrieve the existing user claim in the required schema file.   command<pre><code> jans cli -no-color --operation-id get-attributes-by-inum \\\n --url-suffix inum:bc50c4c4-64c8-45b3-9f38-e8527ddbf833  \\\n &gt; /tmp/update-claim.json\n</code></pre></li> <li>Update values as desired. Updates must adhere to the <code>JansAttribute</code> schema as mentioned here.</li> <li>Use the updated file to send the update to the Janssen Server using the command below. Command<pre><code>jans cli --operation-id put-attributes --data /tmp/update-claim.json\n</code></pre> Upon successful execution of the update, the Janssen Server responds with updated configuration.</li> </ol>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/#get-user-claim-by-inum","title":"Get User Claim by <code>inum</code>","text":"<p>With the <code>get-attributes-by-inum</code> operation-id, we can get any specific user claim matched with <code>Inum</code>. If we know the <code>inum</code>, we can use the below command:</p> Command<pre><code>jans cli --operation-id get-attributes-by-inum \\\n--url-suffix inum:bc50c4c4-64c8-45b3-9f38-e8527ddbf833\n</code></pre>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/#delete-custom-claim","title":"Delete Custom Claim","text":"<p>Delete a user claim using its <code>inum</code>.</p> Command<pre><code>jans cli --operation-id delete-attributes-by-inum --url-suffix inum:EC3A \n</code></pre>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/#patch-custom-claim","title":"Patch Custom Claim","text":"<p>Using <code>operation-id patch-attributes-by-inum</code>, we can modify a custom user claim partially for its properties.</p> <p>To use this operation, specify the <code>inum</code> of the claim that needs to be updated using the <code>--url-suffix</code> and the property and the new value using the JSON Patch. Refer here to know more about schema.</p> <p>In this example, we will add the <code>jansHideOnDiscovery</code> and its value is <code>true</code>.</p> Input<pre><code>[\n  {\n    \"op\": \"add\",\n    \"path\": \"jansHideOnDiscovery\",\n    \"value\": true\n  }\n]\n</code></pre> <p>Now let's do the operation with the command line.</p> Command<pre><code>jans cli --operation-id patch-attributes-by-inum \\\n--url-suffix inum:bc50c4c4-64c8-45b3-9f38-e8527ddbf833 \\\n--data /tmp/patch.json\n</code></pre>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/#using-text-based-ui","title":"Using Text Based UI","text":"<p>Start TUI using the command below:</p> Command<pre><code>jans tui\n</code></pre>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/#attributeuser-claims-screen","title":"Attribute/User Claims Screen","text":"<p>Navigate to <code>Auth Server</code> -&gt; <code>Attributes</code> to open the client screen as shown in the image below.</p> <p></p> <p>To get the list of currently added user claims, bring the control to the <code>Search</code> box (using the tab key), and press the <code>Enter</code> key. Type the search string to search for the user claim with the matching claim name.</p>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/#add-update-attributeuser-claims-screen","title":"Add-Update Attribute/User Claims screen","text":"<ul> <li>Add a new column in the persistence</li> <li>Use the <code>Add Attributes</code> button to create a new user claim.</li> <li>After adding the valid data using the <code>Save</code> button, add a new user claim.</li> <li>Update the user claim as well.</li> <li>To update the user claim, bring the control to the specific <code>User Claim</code> row and press the  Enter key, then it will show the edit screen. </li> </ul> <p>Warning</p> <p>If the attribute is <code>Multivalued</code> enabled in TUI, datatype should be JSON.</p> <p></p> <p>Close and reopen the TUI. The new custom user claim can now be added to any user from user management.</p> <p></p>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/#delete-screen","title":"Delete Screen","text":"<ul> <li>To delete the user claim, bring the control to the specific <code>Claim</code> row and press the  <code>Delete</code> key. Then it will show the Delete confirmation box.</li> </ul> <p>Close and reopen TUI before proceeding with further configuration.</p>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/attribute-configuration/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring the user claim. Endpoint details are published in the Swagger document.</p>","tags":["administration","configuration","attributes","custom user claims"]},{"location":"janssen-server/config-guide/auth-server-config/authentication-method-config/","title":"Authentication Method Configuration","text":"<p>The Janssen Server allows administrators to set and manage the default authentication method for the authentication server. The Janssen Server provides multiple configuration tools to perform these tasks.</p> <p>Note</p> <p>Only one of the available authentication methods can be set as the default. While setting the Default authentication method, the Janssen Server checks if the same authentication is available and active.</p> <p>See  script documentation  to know how to enable/disable authentication methods using custom scripts.</p> <p>If the script is not active then the following error notification is  returned by API.  <code>{  \"code\": \"400\",  \"message\": \"INVALID_ACR\",  \"description\": \"Authentication script {acr} is not active\"  }</code></p> <p>Also, to understand how Janssen Server picks the authentication method in the absence of the default authentication method, refer to  ACR documentation</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to   use Jans CLI here or jump straight to   the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal.   Learn how to use Jans Text-based UI (TUI)   here or jump straight to the   Using Text-based UI</p> <p>Use REST API for programmatic access or invoke via tools like CURL or    Postman. Learn how to use Janssen Server Config API    here or Jump straight to the   Using Configuration REST API</p>","tags":["administration","configuration","default authentication","ACR","authentication method"]},{"location":"janssen-server/config-guide/auth-server-config/authentication-method-config/#using-command-line","title":"Using Command Line","text":"<p>Operations to manage the default authentication method are grouped under the <code>DefaultAuthenticationMethod</code> task. To get information about those operations use the command below.</p> <p>Command<pre><code>jans cli --info DefaultAuthenticationMethod\n</code></pre> Output<pre><code>Operation ID: get-acrs\n Description: Gets default authentication method.\nOperation ID: put-acrs\n Description: Updates default authentication method.\n Schema: AuthenticationMethod\n\nTo get sample schema type jans cli --schema &lt;schma&gt;, for example jans cli --schema /components/schemas/AuthenticationMethod\n</code></pre></p>","tags":["administration","configuration","default authentication","ACR","authentication method"]},{"location":"janssen-server/config-guide/auth-server-config/authentication-method-config/#find-current-authentication-method","title":"Find Current Authentication Method","text":"<p>To get the current default authentication method use the command below. Command<pre><code>jans cli --operation-id get-acrs\n</code></pre> Sample Output<pre><code>{\n  \"defaultAcr\": \"simple_password_auth\"\n}\n</code></pre></p>","tags":["administration","configuration","default authentication","ACR","authentication method"]},{"location":"janssen-server/config-guide/auth-server-config/authentication-method-config/#update-default-authentication-method","title":"Update Default Authentication Method","text":"<p>Let's update the Default Authentication Method using the Janssen CLI command line. To perform the put-acrs operation, we have to use its schema. To get its schema:</p> <p>Command<pre><code>jans cli --schema AuthenticationMethod &gt; /tmp/patch-default-auth.json\n</code></pre> The schema can now be found in the patch-default-auth.json file.</p> <p>For your information, you can obtain the format of the <code>AuthenticationMethod</code> schema by running the aforementioned command without a file.</p> <p>Schema Format<pre><code>defaultAcr   string\n</code></pre> you can also use the following command for <code>AuthenticationMethod</code> schema example.</p> <p>Command<pre><code>jans cli --schema-sample AuthenticationMethod\n</code></pre> Schema Example<pre><code>{\n\"defaultAcr\": \"string\"\n}\n</code></pre></p> <p>We need to modify the patch-default-auth.json file. We have seen that our default authentication method is <code>simple_password_auth</code>. We are going to update it with <code>passport_saml</code> authentication method.</p> input<pre><code>{\n  \"defaultAcr\": \"passport_saml\"\n}\n</code></pre> <p>Now let's trigger the operation using the above file.</p> Command<pre><code>jans cli --operation-id put-acrs --data /tmp/patch-default-auth.json\n</code></pre> <p>It will show the updated result.</p> Sample Output<pre><code>{\n  \"defaultAcr\": \"passport_saml\"\n}\n</code></pre>","tags":["administration","configuration","default authentication","ACR","authentication method"]},{"location":"janssen-server/config-guide/auth-server-config/authentication-method-config/#using-text-based-ui","title":"Using Text-based UI","text":"<p>In Janssen, You can manage the default authentication method using the Text-Based UI also.</p> <p>You can start TUI using the command below:</p> Command<pre><code>jans tui\n</code></pre>","tags":["administration","configuration","default authentication","ACR","authentication method"]},{"location":"janssen-server/config-guide/auth-server-config/authentication-method-config/#find-current-default-authentication-method","title":"Find Current Default Authentication Method","text":"<p>Navigate to <code>Auth Server</code> -&gt; <code>Authn</code> to open the <code>Authn</code> screen as shown in the image below. In Default ACR sub-tab, available authentication methods are listed as radio buttons.</p> <p></p> <p>To update the default authentication method, bring the tab focus to the authentication method, and navigate to the new default method with Up and Down keys. To choose hit Space key. Navigate to Save button and hit Enter key</p>","tags":["administration","configuration","default authentication","ACR","authentication method"]},{"location":"janssen-server/config-guide/auth-server-config/authentication-method-config/#basic-authentication-method","title":"Basic Authentication Method","text":"<p>This tab displays the basic, builtin, authentication method as shown in the image below.</p> <p></p> <p>You can set basic as the default authentication method by selecting Default Authn Method, navigate to Save button and hit Enter key</p>","tags":["administration","configuration","default authentication","ACR","authentication method"]},{"location":"janssen-server/config-guide/auth-server-config/authentication-method-config/#ldap-servers-as-authentication-method","title":"LDAP Servers As Authentication Method","text":"<p>In this tab you can add and modify LDAP Servers are to be used as the default authentication method. See below image</p> <p></p> <p>To add a new LDAP server, navigate to Add Source LDAP Server button and hit Enter. A popup screen will be displayed as shown in the image below.</p> <p></p> <p>Fill in the fields provided in the popup. Before saving LDAP server, it is recommended to test it by navigating Test button and hitting Enter. If the test is successful, choose Save button and hit Enter. If you want the current edited LDAP server as the default authentication method, select Default Authn Method before saving.</p>","tags":["administration","configuration","default authentication","ACR","authentication method"]},{"location":"janssen-server/config-guide/auth-server-config/authentication-method-config/#authentication-methods-enabled-by-scripts","title":"Authentication Methods Enabled By Scripts","text":"<p>All enabled Person Authentication scripts are listed in this tab as below</p> <p></p> <p>To edit Level and/or Properties of the authentication script, navigate to the script in the list by hitting tab key and hit Enter. You will see a popup like in the image below</p> <p></p> <p>If the script you want to use as the default authentication method is not in the list, you should enable the script by navigating Scripts in the main tab. Find the script you want to enable and hit Enter, you will get a popup where you can select Enabled checkbox and Save it as shown in the image below:</p> <p></p>","tags":["administration","configuration","default authentication","ACR","authentication method"]},{"location":"janssen-server/config-guide/auth-server-config/authentication-method-config/#configure-aliases-for-authencation-methods","title":"Configure Aliases For Authencation Methods","text":"<p>Authentication aliases are listed in this tab. You can modify aliases by navigating to the list and hitting Enter. If you want to add a new alias, choose Add Alias button and hit Enter</p>","tags":["administration","configuration","default authentication","ACR","authentication method"]},{"location":"janssen-server/config-guide/auth-server-config/authentication-method-config/#authentication-methods-enabled-by-agama-flows","title":"Authentication Methods Enabled by Agama Flows","text":"<p>If you deployed an Agama project, ACR values for the project are displayed in this tab as shown below:</p> <p></p>","tags":["administration","configuration","default authentication","ACR","authentication method"]},{"location":"janssen-server/config-guide/auth-server-config/authentication-method-config/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring the Default Authentication Method. Endpoint details are published in the Swagger document.</p>","tags":["administration","configuration","default authentication","ACR","authentication method"]},{"location":"janssen-server/config-guide/auth-server-config/cache-configuration/","title":"Cache Configuration","text":"<p>The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Cache configuration is not possible in Text-based UI.</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here or Jump straight to the Using Configuration REST API</p>","tags":["administration","configuration","cache"]},{"location":"janssen-server/config-guide/auth-server-config/cache-configuration/#using-command-line","title":"Using Command Line","text":"<p>To get the details of Janssen command line operations relevant to the cache configuration, you can check the operations under <code>CacheConfiguration</code> using the command below:</p> Command<pre><code>jans cli --info CacheConfiguration\n</code></pre> <p>It prints below two operations: Output<pre><code>Operation ID: get-config-cache\n  Description: Returns cache configuration.\nOperation ID: patch-config-cache\n  Description: Patch cache configuration\n  Schema: Array of JsonPatch\n\nTo get sample schema type jans cli --schema &lt;schema&gt;, for example jans cli --schema JsonPatch\n</code></pre></p>","tags":["administration","configuration","cache"]},{"location":"janssen-server/config-guide/auth-server-config/cache-configuration/#get-cache-configuration","title":"Get Cache Configuration","text":"<p>You can get the current Cache Configuration of your Janssen Server by performing this operation.</p> Command<pre><code>jans cli --operation-id get-config-cache\n</code></pre> <p>It will show the Cache configuration details.</p> Sample Output<pre><code>{\n  \"cacheProviderType\": \"NATIVE_PERSISTENCE\",\n  \"memcachedConfiguration\": {\n    \"servers\": \"localhost:11211\",\n    \"maxOperationQueueLength\": 100000,\n    \"bufferSize\": 32768,\n    \"defaultPutExpiration\": 60,\n    \"connectionFactoryType\": \"DEFAULT\"\n  },\n  \"inMemoryConfiguration\": {\n    \"defaultPutExpiration\": 60\n  },\n  \"redisConfiguration\": {\n    \"redisProviderType\": \"STANDALONE\",\n    \"servers\": \"localhost:6379\",\n    \"defaultPutExpiration\": 60,\n    \"useSSL\": false,\n    \"maxIdleConnections\": 10,\n    \"maxTotalConnections\": 500,\n    \"connectionTimeout\": 3000,\n    \"soTimeout\": 3000,\n    \"maxRetryAttempts\": 5\n  },\n  \"nativePersistenceConfiguration\": {\n    \"defaultPutExpiration\": 60,\n    \"defaultCleanupBatchSize\": 10000,\n    \"deleteExpiredOnGetRequest\": false,\n    \"disableAttemptUpdateBeforeInsert\": false\n  }\n}\n</code></pre>","tags":["administration","configuration","cache"]},{"location":"janssen-server/config-guide/auth-server-config/cache-configuration/#patch-cache-configuration","title":"Patch Cache Configuration","text":"<p>You may need to update Cache configuration, In that case <code>patch-config-cache</code> can be used to modify the cache configuration.</p> <pre><code>Operation ID: patch-config-cache\n  Description: Patch cache configuration\n  Schema: Array of JsonPatch\n\nTo get sample schema type jans cli --schema &lt;schema&gt;, for example jans cli --schema JsonPatch\n</code></pre> <p>The <code>patch-config-cache</code> operation uses the JSON Patch schema to describe the configuration change. Refer here to know more about schema.</p> <p>For instance, to perform a <code>replace</code> operation at <code>memcachedConfiguration/bufferSize</code> and change it from <code>32768</code> to <code>32788</code>, the JSON Patch data would look like below:</p> Input<pre><code>[\n  {\n  \"op\": \"replace\",\n  \"path\": \"memcachedConfiguration/bufferSize\",\n  \"value\": \"32788\"\n  }\n]\n</code></pre> <p>Store the above JSON Patch data in a file, for instance, <code>/tmp/patch-cache.json</code></p> <p>Using the above file, perform the operation as below:</p> Sample Command<pre><code>jans cli --operation-id patch-config-cache --data /tmp/patch-cache.json\n</code></pre> Sample Output<pre><code>{\n  \"cacheProviderType\": \"NATIVE_PERSISTENCE\",\n  \"memcachedConfiguration\": {\n    \"servers\": \"localhost:11211\",\n    \"maxOperationQueueLength\": 100000,\n    \"bufferSize\": 32788,\n    \"defaultPutExpiration\": 60,\n    \"connectionFactoryType\": \"DEFAULT\"\n  },\n  \"inMemoryConfiguration\": {\n    \"defaultPutExpiration\": 60\n  },\n  \"redisConfiguration\": {\n    \"redisProviderType\": \"STANDALONE\",\n    \"servers\": \"localhost:6379\",\n    \"defaultPutExpiration\": 60,\n    \"useSSL\": false,\n    \"maxIdleConnections\": 10,\n    \"maxTotalConnections\": 500,\n    \"connectionTimeout\": 3000,\n    \"soTimeout\": 3000,\n    \"maxRetryAttempts\": 5\n  },\n  \"nativePersistenceConfiguration\": {\n    \"defaultPutExpiration\": 60,\n    \"defaultCleanupBatchSize\": 10000,\n    \"deleteExpiredOnGetRequest\": false,\n    \"disableAttemptUpdateBeforeInsert\": false\n  }\n}\n</code></pre>","tags":["administration","configuration","cache"]},{"location":"janssen-server/config-guide/auth-server-config/cache-configuration/#quick-patch-operation","title":"Quick Patch Operation","text":"<p>In case you need to do a quick patch operation, you can do that also. For example, let's say we would like to replace <code>defaultPutExpiration</code> value from <code>nativePersistenceConfiguration</code>. We can do that simply by the following command line:</p> Command<pre><code>jans cli --operation-id patch-config-cache \\\n--patch-replace nativePersistenceConfiguration/defaultPutExpiration:90\n</code></pre> <p>It will change the value with the given one. There are few options to do such quick patch operations. Please check them out from here.</p>","tags":["administration","configuration","cache"]},{"location":"janssen-server/config-guide/auth-server-config/cache-configuration/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring Cache. Endpoint details are published in the Swagger document.</p>","tags":["administration","configuration","cache"]},{"location":"janssen-server/config-guide/auth-server-config/jans-authorization-server-config/","title":"Janssen Authorization Server","text":"<p>Prerequisite: Know how to use the Janssen CLI in command-line mode</p> <p>To get info about Jans Authorization Server operations:</p> <pre><code>jans cli --info ConfigurationProperties\n\n\nOperation ID: get-properties\n  Description: Gets all Jans authorization server configuration properties.\nOperation ID: patch-properties\n  Description: Partially modifies Jans authorization server AppConfiguration properties.\n  Schema: Array of JsonPatch\nOperation ID: get-properties-persistence\n  Description: Returns persistence type configured for Jans authorization server.\n\nTo get sample schema type jans cli --schema &lt;schma&gt;, for example jans cli --schema JsonPatch\n</code></pre> <p>Jans Authorization server has two operations <code>id</code> to <code>get/modify</code> its properties.</p>","tags":["administration","configuration","jans-auth-server"]},{"location":"janssen-server/config-guide/auth-server-config/jans-authorization-server-config/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Janssen Authorization Server</li> <li>Table of Contents</li> <li>Get All Jans Auth Server Configuration Properties</li> <li>Partially Modify Jans Auth Server Configuration Properties</li> <li>Get Persistence type for Jans Auth</li> </ul>","tags":["administration","configuration","jans-auth-server"]},{"location":"janssen-server/config-guide/auth-server-config/jans-authorization-server-config/#get-all-jans-auth-server-configuration-properties","title":"Get All Jans Auth Server Configuration Properties","text":"<p>It returns all the information of the Jans Authorization server.</p> <pre><code> jans cli --operation-id get-properties\n ```\n\n You will get output like below\n```json\n{\n  \"issuer\": \"https://example.jans.io\",\n  \"baseEndpoint\": \"https://example.jans.io/jans-auth/restv1\",\n  \"authorizationEndpoint\": \"https://example.jans.io/jans-auth/restv1/authorize\",\n  \"authorizationChallengeEndpoint\":\"https://example.jans.io/jans-auth/restv1/authorize-challenge\",\n  \"tokenEndpoint\": \"https://example.jans.io/jans-auth/restv1/token\",\n  \"tokenRevocationEndpoint\": \"https://example.jans.io/jans-auth/restv1/revoke\",\n  \"userInfoEndpoint\": \"https://example.jans.io/jans-auth/restv1/userinfo\",\n  \"clientInfoEndpoint\": \"https://example.jans.io/jans-auth/restv1/clientinfo\",\n  \"checkSessionIFrame\": \"https://example.jans.io/jans-auth/opiframe.htm\",\n  \"endSessionEndpoint\": \"https://example.jans.io/jans-auth/restv1/end_session\",\n  \"jwksUri\": \"https://example.jans.io/jans-auth/restv1/jwks\",\n  \"registrationEndpoint\": \"https://example.jans.io/jans-auth/restv1/register\",\n  \"openIdDiscoveryEndpoint\": \"https://example.jans.io/.well-known/webfinger\",\n  \"openIdConfigurationEndpoint\": \"https://example.jans.io/.well-known/openid-configuration\",\n  \"idGenerationEndpoint\": \"https://example.jans.io/jans-auth/restv1/id\",\n  \"introspectionEndpoint\": \"https://example.jans.io/jans-auth/restv1/introspection\",\n  \"parEndpoint\": \"https://example.jans.io/jans-auth/restv1/par\",\n  \"requirePar\": false,\n  \"deviceAuthzEndpoint\": \"https://example.jans.io/jans-auth/restv1/device_authorization\",\n  \"requireRequestObjectEncryption\": false,\n  \"requirePkce\": false,\n  \"allowAllValueForRevokeEndpoint\": false,\n  \"sectorIdentifierCacheLifetimeInMinutes\": 1440,\n  \"umaConfigurationEndpoint\": \"https://example.jans.io/jans-auth/restv1/uma2-configuration\",\n  \"umaRptAsJwt\": false,\n  \"umaRptLifetime\": 3600,\n  \"umaTicketLifetime\": 3600,\n  \"umaPctLifetime\": 1728000,\n  \"umaResourceLifetime\": 1728000,\n  \"umaAddScopesAutomatically\": true,\n  \"umaValidateClaimToken\": false,\n  \"umaGrantAccessIfNoPolicies\": false,\n  \"umaRestrictResourceToAssociatedClient\": false,\n  \"statTimerIntervalInSeconds\": 0,\n  \"statAuthorizationScope\": \"jans_stat\",\n  \"allowSpontaneousScopes\": false,\n  \"spontaneousScopeLifetime\": 86400,\n  \"openidSubAttribute\": \"inum\",\n  \"publicSubjectIdentifierPerClientEnabled\": true,\n  \"subjectIdentifiersPerClientSupported\": [\n    \"mail\",\n    \"uid\"\n  ],\n  \"responseTypesSupported\": [\n    [\n      \"code\",\n      \"id_token\"\n    ],\n    [\n      \"code\",\n      \"token\"\n    ],\n    [\n      \"code\"\n    ],\n    [\n      \"token\",\n      \"id_token\"\n    ],\n    [\n      \"token\"\n    ],\n    [\n      \"code\",\n      \"token\",\n      \"id_token\"\n    ],\n    [\n      \"id_token\"\n    ]\n  ],\n  \"responseModesSupported\": [\n    \"form_post.jwt\",\n    \"form_post\",\n    \"fragment\",\n    \"query.jwt\",\n    \"fragment.jwt\",\n    \"jwt\",\n    \"query\"\n  ],\n  \"grantTypesSupported\": [\n    \"urn:ietf:params:oauth:grant-type:uma-ticket\",\n    \"implicit\",\n    \"urn:ietf:params:oauth:grant-type:token-exchange\",\n    \"urn:ietf:params:oauth:grant-type:device_code\",\n    \"urn:ietf:params:oauth:grant-type:jwt-bearer\",\n    \"client_credentials\",\n    \"refresh_token\",\n    \"authorization_code\",\n    \"password\",\n    \"tx_token\"\n  ],\n  \"subjectTypesSupported\": [\n    \"public\",\n    \"pairwise\"\n  ],\n  \"defaultSubjectType\": \"pairwise\",\n  \"authorizationSigningAlgValuesSupported\": [\n    \"HS256\",\n    \"HS384\",\n    \"HS512\",\n    \"RS256\",\n    \"RS384\",\n    \"RS512\",\n    \"ES256\",\n    \"ES384\",\n    \"ES512\",\n    \"ES512\",\n    \"PS256\",\n    \"PS384\",\n    \"PS512\"\n  ],\n  \"authorizationEncryptionAlgValuesSupported\": [\n    \"RSA1_5\",\n    \"RSA-OAEP\",\n    \"A128KW\",\n    \"A256KW\"\n  ],\n  \"authorizationEncryptionEncValuesSupported\": [\n    \"A128CBC+HS256\",\n    \"A256CBC+HS512\",\n    \"A128GCM\",\n    \"A256GCM\"\n  ],\n  \"userInfoSigningAlgValuesSupported\": [\n    \"HS256\",\n    \"HS384\",\n    \"HS512\",\n    \"RS256\",\n    \"RS384\",\n    \"RS512\",\n    \"ES256\",\n    \"ES384\",\n    \"ES512\",\n    \"ES512\",\n    \"PS256\",\n    \"PS384\",\n    \"PS512\"\n  ],\n  \"userInfoEncryptionAlgValuesSupported\": [\n    \"RSA1_5\",\n    \"RSA-OAEP\",\n    \"A128KW\",\n    \"A256KW\"\n  ],\n  \"userInfoEncryptionEncValuesSupported\": [\n    \"A128CBC+HS256\",\n    \"A256CBC+HS512\",\n    \"A128GCM\",\n    \"A256GCM\"\n  ],\n  \"idTokenSigningAlgValuesSupported\": [\n    \"none\",\n    \"HS256\",\n    \"HS384\",\n    \"HS512\",\n    \"RS256\",\n    \"RS384\",\n    \"RS512\",\n    \"ES256\",\n    \"ES384\",\n    \"ES512\",\n    \"ES512\",\n    \"PS256\",\n    \"PS384\",\n    \"PS512\"\n  ],\n  \"idTokenEncryptionAlgValuesSupported\": [\n    \"RSA1_5\",\n    \"RSA-OAEP\",\n    \"A128KW\",\n    \"A256KW\"\n  ],\n  \"idTokenEncryptionEncValuesSupported\": [\n    \"A128CBC+HS256\",\n    \"A256CBC+HS512\",\n    \"A128GCM\",\n    \"A256GCM\"\n  ],\n  \"accessTokenSigningAlgValuesSupported\": [\n    \"none\",\n    \"HS256\",\n    \"HS384\",\n    \"HS512\",\n    \"RS256\",\n    \"RS384\",\n    \"RS512\",\n    \"ES256\",\n    \"ES384\",\n    \"ES512\",\n    \"ES512\",\n    \"PS256\",\n    \"PS384\",\n    \"PS512\"\n  ],\n  \"forceSignedRequestObject\": false,\n  \"requestObjectSigningAlgValuesSupported\": [\n    \"none\",\n    \"HS256\",\n    \"HS384\",\n    \"HS512\",\n    \"RS256\",\n    \"RS384\",\n    \"RS512\",\n    \"ES256\",\n    \"ES384\",\n    \"ES512\",\n    \"ES512\",\n    \"PS256\",\n    \"PS384\",\n    \"PS512\"\n  ],\n  \"requestObjectEncryptionAlgValuesSupported\": [\n    \"RSA1_5\",\n    \"RSA-OAEP\",\n    \"A128KW\",\n    \"A256KW\"\n  ],\n  \"requestObjectEncryptionEncValuesSupported\": [\n    \"A128CBC+HS256\",\n    \"A256CBC+HS512\",\n    \"A128GCM\",\n    \"A256GCM\"\n  ],\n  \"tokenEndpointAuthMethodsSupported\": [\n    \"client_secret_basic\",\n    \"client_secret_post\",\n    \"client_secret_jwt\",\n    \"private_key_jwt\",\n    \"tls_client_auth\",\n    \"self_signed_tls_client_auth\"\n  ],\n  \"tokenEndpointAuthSigningAlgValuesSupported\": [\n    \"HS256\",\n    \"HS384\",\n    \"HS512\",\n    \"RS256\",\n    \"RS384\",\n    \"RS512\",\n    \"ES256\",\n    \"ES384\",\n    \"ES512\",\n    \"ES512\",\n    \"PS256\",\n    \"PS384\",\n    \"PS512\"\n  ],\n  \"displayValuesSupported\": [\n    \"page\",\n    \"popup\"\n  ],\n  \"claimTypesSupported\": [\n    \"normal\"\n  ],\n  \"jwksAlgorithmsSupported\": [\n    \"RS256\",\n    \"RS384\",\n    \"RS512\",\n    \"ES256\",\n    \"ES384\",\n    \"ES512\",\n    \"PS256\",\n    \"PS384\",\n    \"PS512\",\n    \"RSA1_5\",\n    \"RSA-OAEP\"\n  ],\n  \"serviceDocumentation\": \"http://jans.org/docs\",\n  \"claimsLocalesSupported\": [\n    \"en\"\n  ],\n  \"idTokenTokenBindingCnfValuesSupported\": [\n    \"tbh\"\n  ],\n  \"uiLocalesSupported\": [\n    \"en\",\n    \"bg\",\n    \"de\",\n    \"es\",\n    \"fr\",\n    \"it\",\n    \"ru\",\n    \"tr\"\n  ],\n  \"claimsParameterSupported\": false,\n  \"requestParameterSupported\": true,\n  \"requestUriParameterSupported\": true,\n  \"requestUriHashVerificationEnabled\": false,\n  \"requireRequestUriRegistration\": false,\n  \"requestUriBlockList\": [\n    \"localhost\",\n    \"127.0.0.1\"\n  ],\n  \"opPolicyUri\": \"https://example.jans.io/opPolicy\",\n  \"opTosUri\": \"https://example.jans.io/tos\",\n  \"authorizationCodeLifetime\": 60,\n  \"refreshTokenLifetime\": 14400,\n  \"txTokenLifetime\": 180,\n  \"idTokenLifetime\": 3600,\n  \"idTokenFilterClaimsBasedOnAccessToken\": false,\n  \"accessTokenLifetime\": 300,\n  \"cleanServiceInterval\": 60,\n  \"cleanServiceBatchChunkSize\": 10000,\n  \"keyRegenerationEnabled\": true,\n  \"keyRegenerationInterval\": 48,\n  \"defaultSignatureAlgorithm\": \"RS256\",\n  \"jansOpenIdConnectVersion\": \"openidconnect-1.0\",\n  \"jansId\": \"https://example.jans.io/oxid/service/jans/inum\",\n  \"dynamicRegistrationExpirationTime\": -1,\n  \"dynamicRegistrationPersistClientAuthorizations\": true,\n  \"trustedClientEnabled\": true,\n  \"skipAuthorizationForOpenIdScopeAndPairwiseId\": false,\n  \"dynamicRegistrationScopesParamEnabled\": true,\n  \"dynamicRegistrationPasswordGrantTypeEnabled\": false,\n  \"personCustomObjectClassList\": [\n    \"jansCustomPerson\",\n    \"jansPerson\"\n  ],\n  \"persistIdToken\": false,\n  \"persistRefreshToken\": true,\n  \"allowPostLogoutRedirectWithoutValidation\": false,\n  \"invalidateSessionCookiesAfterAuthorizationFlow\": false,\n  \"returnClientSecretOnRead\": true,\n  \"rotateClientRegistrationAccessTokenOnUsage\": false,\n  \"rejectJwtWithNoneAlg\": true,\n  \"expirationNotificatorEnabled\": false,\n  \"useNestedJwtDuringEncryption\": true,\n  \"expirationNotificatorMapSizeLimit\": 100000,\n  \"expirationNotificatorIntervalInSeconds\": 600,\n  \"redirectUrisRegexEnabled\": true,\n  \"useHighestLevelScriptIfAcrScriptNotFound\": false,\n  \"authenticationFiltersEnabled\": false,\n  \"clientAuthenticationFiltersEnabled\": false,\n  \"clientRegDefaultToCodeFlowWithRefresh\": true,\n  \"grantTypesAndResponseTypesAutofixEnabled\": false,\n  \"authenticationFilters\": [\n    {\n      \"filter\": \"(&amp;(mail=*{0}*)(inum={1}))\",\n      \"bind\": false,\n      \"baseDn\": \"ou=people,o=jans\"\n    },\n    {\n      \"filter\": \"uid={0}\",\n      \"bind\": true,\n      \"bindPasswordAttribute\": \"pwd\",\n      \"baseDn\": \"ou=people,o=jans\"\n    }\n  ],\n  \"clientAuthenticationFilters\": [\n    {\n      \"filter\": \"myCustomAttr1={0}\",\n      \"baseDn\": \"ou=clients,o=jans\"\n    }\n  ],\n  \"corsConfigurationFilters\": [\n    {\n      \"filterName\": \"CorsFilter\",\n      \"corsEnabled\": true,\n      \"corsAllowedOrigins\": \"*\",\n      \"corsAllowedMethods\": \"GET,POST,HEAD,OPTIONS\",\n      \"corsAllowedHeaders\": \"Origin,Authorization,Accept,X-Requested-With,Content-Type,Access-Control-Request-Method,Access-Control-Request-Headers\",\n      \"corsSupportCredentials\": true,\n      \"corsLoggingEnabled\": false,\n      \"corsPreflightMaxAge\": 1800,\n      \"corsRequestDecorate\": true\n    }\n  ],\n  \"sessionIdUnusedLifetime\": 86400,\n  \"sessionIdUnauthenticatedUnusedLifetime\": 7200,\n  \"sessionIdPersistOnPromptNone\": true,\n  \"sessionIdRequestParameterEnabled\": false,\n  \"changeSessionIdOnAuthentication\": true,\n  \"sessionIdPersistInCache\": false,\n  \"includeSidInResponse\": false,\n  \"disablePromptLogin\": false,\n  \"disablePromptConsent\": false,\n  \"sessionIdLifetime\": 86400,\n  \"sessionIdCookieLifetime\": 86400,\n  \"configurationUpdateInterval\": 3600,\n  \"enableClientGrantTypeUpdate\": true,\n  \"grantTypesSupportedByDynamicRegistration\": [\n    \"urn:ietf:params:oauth:grant-type:uma-ticket\",\n    \"implicit\",\n    \"urn:ietf:params:oauth:grant-type:token-exchange\",\n    \"urn:ietf:params:oauth:grant-type:device_code\",\n    \"client_credentials\",\n    \"refresh_token\",\n    \"authorization_code\",\n    \"tx_token\"\n  ],\n  \"metricReporterInterval\": 300,\n  \"metricReporterKeepDataDays\": 15,\n  \"pairwiseIdType\": \"algorithmic\",\n  \"pairwiseCalculationKey\": \"9jwJNNXd9mMua666QDhfEKGcR\",\n  \"pairwiseCalculationSalt\": \"aUn2q1HDtsUXtmTNovNeN1QTk\",\n  \"shareSubjectIdBetweenClientsWithSameSectorId\": true,\n  \"webKeysStorage\": \"keystore\",\n  \"dnName\": \"CN=Jans Auth CA Certificates\",\n  \"keyStoreFile\": \"/etc/certs/jans-auth-keys.pkcs12\",\n  \"keyStoreSecret\": \"S63ogThoRsEf\",\n  \"keySelectionStrategy\": \"OLDER\",\n  \"keySignWithSameKeyButDiffAlg\": false,\n  \"introspectionAccessTokenMustHaveUmaProtectionScope\": false,\n  \"introspectionAccessTokenMustHaveIntrospectionScope\": false,\n  \"introspectionSkipAuthorization\": false,\n  \"endSessionWithAccessToken\": false,\n  \"clientWhiteList\": [\n    \"*\"\n  ],\n  \"clientBlackList\": [\n    \"*.attacker.com/*\"\n  ],\n  \"legacyIdTokenClaims\": false,\n  \"customHeadersWithAuthorizationResponse\": true,\n  \"frontChannelLogoutSessionSupported\": true,\n  \"loggingLevel\": \"INFO\",\n  \"loggingLayout\": \"text\",\n  \"updateUserLastLogonTime\": false,\n  \"updateClientAccessTime\": false,\n  \"logClientIdOnClientAuthentication\": true,\n  \"logClientNameOnClientAuthentication\": false,\n  \"disableJdkLogger\": true,\n  \"authorizationRequestCustomAllowedParameters\": [\n    {\n      \"paramName\": \"customParam3\",\n      \"returnInResponse\": false\n    },\n    {\n      \"paramName\": \"customParam4\",\n      \"returnInResponse\": true\n    },\n    {\n      \"paramName\": \"customParam5\",\n      \"returnInResponse\": true\n    },\n    {\n      \"paramName\": \"customParam1\",\n      \"returnInResponse\": false\n    },\n    {\n      \"paramName\": \"customParam2\",\n      \"returnInResponse\": false\n    }\n  ],\n  \"openidScopeBackwardCompatibility\": false,\n  \"disableU2fEndpoint\": false,\n  \"rotateDeviceSecret\": false,\n  \"returnDeviceSecretFromAuthzEndpoint\": false,\n  \"dcrSignatureValidationEnabled\": false,\n  \"dcrAuthorizationWithClientCredentials\": false,\n  \"dcrAuthorizationWithMTLS\": false,\n  \"useLocalCache\": true,\n  \"fapiCompatibility\": false,\n  \"forceIdTokenHintPresence\": false,\n  \"rejectEndSessionIfIdTokenExpired\": false,\n  \"allowEndSessionWithUnmatchedSid\": false,\n  \"forceOfflineAccessScopeToEnableRefreshToken\": true,\n  \"errorReasonEnabled\": false,\n  \"removeRefreshTokensForClientOnLogout\": true,\n  \"skipRefreshTokenDuringRefreshing\": false,\n  \"refreshTokenExtendLifetimeOnRotation\": false,\n  \"checkUserPresenceOnRefreshToken\": false,\n  \"consentGatheringScriptBackwardCompatibility\": false,\n  \"introspectionScriptBackwardCompatibility\": false,\n  \"introspectionResponseScopesBackwardCompatibility\": false,\n  \"softwareStatementValidationType\": \"script\",\n  \"authenticationProtectionConfiguration\": {\n    \"attemptExpiration\": 15,\n    \"maximumAllowedAttemptsWithoutDelay\": 4,\n    \"delayTime\": 2,\n    \"bruteForceProtectionEnabled\": false\n  },\n  \"errorHandlingMethod\": \"remote\",\n  \"keepAuthenticatorAttributesOnAcrChange\": false,\n  \"deviceAuthzRequestExpiresIn\": 1800,\n  \"deviceAuthzTokenPollInterval\": 5,\n  \"deviceAuthzResponseTypeToProcessAuthz\": \"code\",\n  \"backchannelRedirectUri\": \"https://example.jans.io/jans-auth/ciba/home.htm\",\n  \"backchannelAuthenticationEndpoint\": \"https://example.jans.io/jans-auth/restv1/bc-authorize\",\n  \"backchannelDeviceRegistrationEndpoint\": \"https://example.jans.io/jans-auth/restv1/bc-deviceRegistration\",\n  \"backchannelTokenDeliveryModesSupported\": [\n    \"poll\",\n    \"ping\",\n    \"push\"\n  ],\n  \"backchannelUserCodeParameterSupported\": false,\n  \"backchannelBindingMessagePattern\": \"^[a-zA-Z0-9]{4,8}$\",\n  \"backchannelAuthenticationResponseExpiresIn\": 3600,\n  \"backchannelAuthenticationResponseInterval\": 2,\n  \"backchannelLoginHintClaims\": [\n    \"inum\",\n    \"uid\",\n    \"mail\"\n  ],\n  \"cibaEndUserNotificationConfig\": {},\n  \"backchannelRequestsProcessorJobIntervalSec\": 5,\n  \"backchannelRequestsProcessorJobChunkSize\": 100,\n  \"cibaGrantLifeExtraTimeSec\": 180,\n  \"cibaMaxExpirationTimeAllowedSec\": 1800,\n  \"dpopSigningAlgValuesSupported\": [\n    \"RS256\",\n    \"RS384\",\n    \"RS512\",\n    \"ES256\",\n    \"ES384\",\n    \"ES512\",\n    \"ES512\",\n    \"PS256\",\n    \"PS384\",\n    \"PS512\"\n  ],\n  \"dpopTimeframe\": 5,\n  \"dpopJtiCacheTime\": 3600,\n  \"allowIdTokenWithoutImplicitGrantType\": false,\n  \"discoveryCacheLifetimeInMinutes\": 60,\n  \"discoveryDenyKeys\": [\n    \"id_generation_endpoint\",\n    \"auth_level_mapping\",\n    \"scope_to_claims_mapping\",\n    \"op_policy_uri\"\n  ],\n  \"httpLoggingEnabled\": false,\n  \"agamaConfiguration\": {\n    \"enabled\": false,\n    \"rootDir\": \"/opt/jans/jetty/jans-auth/agama\",\n    \"templatesPath\": \"/ftl\",\n    \"scriptsPath\": \"/scripts\",\n    \"serializerType\": \"KRYO\",\n    \"maxItemsLoggedInCollections\": 9,\n    \"pageMismatchErrorPage\": \"mismatch.ftlh\",\n    \"interruptionErrorPage\": \"timeout.ftlh\",\n    \"crashErrorPage\": \"crash.ftlh\",\n    \"finishedFlowPage\": \"finished.ftlh\",\n    \"bridgeScriptPage\": \"agama.xhtml\",\n    \"defaultResponseHeaders\": {\n      \"Cache-Control\": \"max-age=0, no-store\"\n    }\n  },\n  \"ssaConfiguration\": {\n    \"ssaEndpoint\": \"https://example.jans.io/jans-auth/restv1/ssa\",\n    \"ssaSigningAlg\": \"RS256\",\n    \"ssaExpirationInDays\": 30\n  },\n  \"blockWebviewAuthorizationEnabled\": false,\n  \"dateFormatterPatterns\": {\n    \"birthdate\": \"yyyy-MM-dd\"\n  },\n  \"httpLoggingResponseBodyContent\": false,\n  \"fapi\": false,\n  \"allResponseTypesSupported\": [\n    \"code\",\n    \"id_token\",\n    \"token\"\n  ],\n  \"connectionServiceConfiguration\": {\n    \"maxTotal\": 200,\n    \"maxPerRoute\": 50,\n    \"validateAfterInactivity\": 0\n  }  \n}\n</code></pre>","tags":["administration","configuration","jans-auth-server"]},{"location":"janssen-server/config-guide/auth-server-config/jans-authorization-server-config/#partially-modify-jans-auth-server-configuration-properties","title":"Partially Modify Jans Auth Server Configuration Properties","text":"<p><pre><code>Operation ID: patch-properties\n  Description: Partially modifies Jans authorization server AppConfiguration properties.\n  Schema: Array of /components/schemas/PatchRequest\n\nTo get sample shema type jans cli --schema &lt;schma&gt;, for example jans cli --schema /components/schemas/PatchRequest\n</code></pre> Let's look at the schema first:</p> <pre><code>jans cli --schema /components/schemas/PatchRequest &gt; /tmp/patch-jans-auth.json\n</code></pre> <p>It will create a <code>.json</code> file in <code>/tmp</code> with schema.</p> <p>Let's modify this schema: <code>nano /tmp/patch-jans-auth.json</code></p> <p></p> <p>This schema has three properties; <code>op</code>, <code>path</code> &amp; <code>value</code>. Let's perform a <code>replace</code> operation at <code>cibaEnabled</code> to change it from <code>false</code> to <code>true</code>. So, the <code>.json</code> file will look like this:</p> <pre><code>[\n  {\n    \"op\": \"replace\",\n    \"path\": \"cibaEnabled\",\n    \"value\": true\n  }\n]\n</code></pre> <p>Don't forget to use square brackets (<code>[]</code>). Otherwise, it won't work.</p> <p>Now, let's do the operation.</p> <pre><code>jans cli --operation-id patch-properties --data /tmp/patch-jans-auth.json\n</code></pre> <p>If you run the following command line, you must see that <code>cibaEnabled</code> is <code>true</code>:</p> <p></p>","tags":["administration","configuration","jans-auth-server"]},{"location":"janssen-server/config-guide/auth-server-config/jans-authorization-server-config/#get-persistence-type-for-jans-auth-configuration","title":"Get Persistence type for Jans Auth Configuration","text":"<p>You can get the persistence details for jans auth server. <pre><code>jans cli --operation-id get-properties-persistence\n</code></pre></p> <p>Default persistence type is <code>MySQL</code>. <pre><code>Please wait while retrieving data ...\n{\n  \"persistenceType\": \"sql\"\n}\n</code></pre></p>","tags":["administration","configuration","jans-auth-server"]},{"location":"janssen-server/config-guide/auth-server-config/json-web-key-config/","title":"JSON Web Key (JWK)","text":"<p>The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal.  Learn how to use Jans Text-based UI (TUI)  here or jump straight to the Using Text-based UI</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here or Jump straight to the Using Configuration REST API</p>","tags":["administration","configuration","JWK","json web keys","JWKS"]},{"location":"janssen-server/config-guide/auth-server-config/json-web-key-config/#using-command-line","title":"Using Command Line","text":"<p>In the Janssen Server, you can deploy and manage the JSON Web keys using the command Line. To get the details of Janssen command line operations relevant to JSON Web Key, you can check the operations under <code>ConfigurationJwkJsonWebKeyJwk</code> task using the command below:</p> Command<pre><code>jans cli --info ConfigurationJwkJsonWebKeyJwk\n</code></pre> Sample Output<pre><code>Operation ID: get-jwk-by-kid\n Description: Get a JSON Web Key based on kid\n Parameters:\n kid: The unique identifier for the key [string]\nOperation ID: delete-config-jwk-kid\n Description: Delete a JSON Web Key based on kid\n Parameters:\n kid: The unique identifier for the key [string]\nOperation ID: patch-config-jwk-kid\n Description: Patch a specific JSON Web Key based on kid\n Parameters:\n kid: The unique identifier for the key [string]\n Schema: Array of JsonPatch\nOperation ID: get-config-jwks\n Description: Gets list of JSON Web Key (JWK) used by server\nOperation ID: put-config-jwks\n Description: Replaces JSON Web Keys\n Schema: WebKeysConfiguration\nOperation ID: patch-config-jwks\n Description: Patches JSON Web Keys\n Schema: Array of JsonPatch\nOperation ID: post-config-jwks-key\n Description: Configuration \u2013 JWK - JSON Web Key (JWK)\n Schema: JSONWebKey\n\nTo get sample schema type jans cli --schema &lt;schema&gt;, for example jans cli --schema JSONWebKey\n</code></pre>","tags":["administration","configuration","JWK","json web keys","JWKS"]},{"location":"janssen-server/config-guide/auth-server-config/json-web-key-config/#get-configurations-list-of-jwks","title":"Get Configurations list of JWKs","text":"<p>We can get list of all configurations of the jwk configuration using a command like this:</p> <p>Command<pre><code>jans cli --operation-id get-config-jwks\n</code></pre> It will return all the jwk configuration information as below:</p> Sample Output<pre><code>{\n  \"keys\": [\n    {\n      \"descr\": \"Signature Key: RSA RSASSA-PKCS1-v1_5 using SHA-256\",\n      \"kty\": \"RSA\",\n      \"e\": \"AQAB\",\n      \"use\": \"sig\",\n      \"key_ops_type\": [\n        \"connect\"\n      ],\n      \"kid\": \"connect_e47fd367-51d6-4d17-811d-adb1f1a0b723_sig_rs256\",\n      \"x5c\": [\n        \"MIIDCjCCAfKgAwIBAgIhAInuAAbxL2O7H+/V0lm3bbEdCmdPdgJh+OqljtWpwi7wMA0GCSqGSIb3DQEBCwUAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjQwNjIxMDg0ODE5WhcNMjQwNjIzMDg0ODI4WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA1RCY0ZfJ/SHZ+jojCyStBjIh4upkLXuMgZLi6b7k0fQ8/oNmCBEsOKMPUubHFEHrDHZLbXj7w5gEdMPZOiLaBP8Pv0JD8IbOUtoSXEawE33LRldKiof296nlBJFsX00ipiLq3ANXuTDXtP4+pd+lvIufv1nBXpqqrN4MOsSsKuvKvxRPCg6JusHVU5hsiqbwh9y3X7sPFwqw4LJFa0U3Z4RoX7vCsS/axPPSyUi9x0zsF4S7ZGHclBReC6IipOnGyGeSEQdpuchhoZs382md+wejIf4hVtusRbEHz+wwZFhnrfh/nvHCvrWCcxBgeEntAin+ig1RlR8N4x9Ox9K01wIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwDQYJKoZIhvcNAQELBQADggEBACkrKROjAIf6n1PKpXFTRQVov32EFcwhi1YSao/MZHURV2ruYXjh/S6HuvHWWofV8R6muLnD938GytS2mRjr+X7DOZj/bsDT7amd810SDvFUCh6IoPt46FeXFZMV4XyL4DQKoNxOEGGDVnD41NVC6k5GLzPwcVBwX11+b7wRfy/KoPP9aoSXjyWnNbhwClFQ9oTJYkNtaNeh2kJZ2j1UIqO51vyhUjpSM9awqV2u+ouxDKCT4h9xRcDwkOUlVXtBwn+dfJHnG6riLzT59MiPtWeo037hESUxIvJxLQP6jV97eEi/CMhSb1y6YJPFjnTBmCpzeHRp5+DNu65KPaGntB8=\"\n      ],\n      \"name\": \"Connect RS256 Sign Key\",\n      \"exp\": 1719132508905,\n      \"alg\": \"RS256\",\n      \"n\": \"1RCY0ZfJ_SHZ-jojCyStBjIh4upkLXuMgZLi6b7k0fQ8_oNmCBEsOKMPUubHFEHrDHZLbXj7w5gEdMPZOiLaBP8Pv0JD8IbOUtoSXEawE33LRldKiof296nlBJFsX00ipiLq3ANXuTDXtP4-pd-lvIufv1nBXpqqrN4MOsSsKuvKvxRPCg6JusHVU5hsiqbwh9y3X7sPFwqw4LJFa0U3Z4RoX7vCsS_axPPSyUi9x0zsF4S7ZGHclBReC6IipOnGyGeSEQdpuchhoZs382md-wejIf4hVtusRbEHz-wwZFhnrfh_nvHCvrWCcxBgeEntAin-ig1RlR8N4x9Ox9K01w\"\n    },\n    {\n      \"descr\": \"Signature Key: RSA RSASSA-PKCS1-v1_5 using SHA-384\",\n      \"kty\": \"RSA\",\n      \"e\": \"AQAB\",\n      \"use\": \"sig\",\n      \"key_ops_type\": [\n        \"connect\"\n      ],\n      \"kid\": \"connect_fed19dd0-7139-4ed8-ad43-43322b7eeaea_sig_rs384\",\n      \"x5c\": [\n        \"MIIDCjCCAfKgAwIBAgIhAKLBm5p06uGv/lXT4tKLgjsS5kosfHb1rgO50fdLAFRoMA0GCSqGSIb3DQEBDAUAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjQwNjIxMDg0ODE5WhcNMjQwNjIzMDg0ODI4WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAkIt6G/MDIyfp1uTERxFYoY1nGuq3FhZG7xdPYi7eHoyM+PAbq+8rKeIRcJWJi37TazbqqLViGbejaD6rRxOihzoMPo1LtBuqGGw8m6fI1UJlvnt1NHd+du3Q6065WufL+nXn2Osmg962TF+gSvExgxr+HFeAgjP/kyG99dzSv4mUFbikegK8Dql1K36fZ427vDQ7mGRrR1vBsbMPqW5d9huXhl+iy11AOtYNNcfRDu47Hzae5Srzp32si36+Da/dEwntuMXnK7BwxDp/BGoOuWLPFoVctH6PDoIYzXUiTbj+XiQ8zFgPydt+x/2ZEGyq61Ewebjkpj9b0g+yHk/2aQIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwDQYJKoZIhvcNAQEMBQADggEBAHnfO3jItuXdSr5Js3kj/7kI1OElwcU4fco53ThSilbtq6FBOk5GzonaZOHFQayzjo3Qp5qe/uShSknFQ+sjEmhGTVPiQFssNTXxEnEw1WrTvEc/09I9oTNg9jitppn1z4/QT/wP0X3erRIjBQvFe4ov1wL/atjs5Mg8KRHqGttze5xN1pY3r0hrUiIxYiA7F5DUigGD4hYGGXKXymr0SgEoMZQx9Duxn8wxtX5l3fcC0FA53vn/4ZDd/ikhQRqTyz/C7ffHsVcOxnlWd3pm37+W9swGhkb9EaKRg2gJOdA5+Vw62tJA4Gp8WOIeMrRiXvtn2AVks5nyG7oiWt0ldYk=\"\n      ],\n      \"name\": \"Connect RS384 Sign Key\",\n      \"exp\": 1719132508905,\n      \"alg\": \"RS384\",\n      \"n\": \"kIt6G_MDIyfp1uTERxFYoY1nGuq3FhZG7xdPYi7eHoyM-PAbq-8rKeIRcJWJi37TazbqqLViGbejaD6rRxOihzoMPo1LtBuqGGw8m6fI1UJlvnt1NHd-du3Q6065WufL-nXn2Osmg962TF-gSvExgxr-HFeAgjP_kyG99dzSv4mUFbikegK8Dql1K36fZ427vDQ7mGRrR1vBsbMPqW5d9huXhl-iy11AOtYNNcfRDu47Hzae5Srzp32si36-Da_dEwntuMXnK7BwxDp_BGoOuWLPFoVctH6PDoIYzXUiTbj-XiQ8zFgPydt-x_2ZEGyq61Ewebjkpj9b0g-yHk_2aQ\"\n    }\n  ]\n</code></pre>","tags":["administration","configuration","JWK","json web keys","JWKS"]},{"location":"janssen-server/config-guide/auth-server-config/json-web-key-config/#adds-new-json-web-key-jwk","title":"Adds new JSON Web key (JWK)","text":"<p>To add a new key, we can use <code>post-config-jwks-key</code> operation id. As shown in the output for <code>--info</code> command, the  <code>post-config-jwks-key</code> operation requires data to be sent  according to <code>JSONWebKey</code> schema.</p> <p>To see the schema, use the command below:</p> <p>Command<pre><code>jans cli --schema JSONWebKey\n</code></pre> The Janssen Server also provides an example of data that adheres to the above schema. To fetch the example, use the command below.</p> <p>Command<pre><code>jans cli --schema-sample JSONWebKey\n</code></pre> Using the schema and the example above, we have added below key data to the file <code>/tmp/jwk.json</code>.</p> Input<pre><code>\"name\": \"Connect RSA-OAEP Encryption Key 2\",\n\"descr\": \"Encryption Key 2: Elliptic Curve Diffie-Hellman Ephemeral Static key agreement using Concat KDF\",\n\"kid\": \"dd550214-7969-41b9-b919-2a0cfa36047b_enc_rsa1_5\",\n\"kty\": \"RSA\",\n\"use\": \"enc\",\n\"alg\": \"RSA-OAEP\",\n\"crv\": \"\",\n\"exp\": 1622245655163,\n\"x5c\": [\n  \"MIIDCjCCAfKgAwIBAgIhANYLiviUTmgOsf9Bf+6N/pr6H4Mis5ku1VXNj7VW/CMbMA0GCSqGSIb3DQEBCwUAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNTI2MjM0NzI5WhcNMjEwNTI4MjM0NzM1WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArlD19ib3J2bKYr2iap1d/gCmbXocMJTk5o7o3h9jJKXbh9pdf2gd3ZOE6wc5XwGx/CfHSgdEmACCXMiG7sQt80DPM67dlbtv/pEnWrHk4fwwst83OF+HXTSi4Sd9QWhDtBvaUu8Rp8ir+x2D0RK8YNGs0prA+qGR8O/h6Y+ascz4VNbbDlbJ+w7DJYeWU1HVp/5Lt8O5i4Q6I8KZEAytwvspF5y8m8DCrfYXF6Kz14vXgqr08hj0l0Aj4O3y/9i8kf2pmznpu5QEDimj1yxEB+G5WEYuHD/+qRTV85OXDIQJz6fgNM4kEimv7pmspcDfk/KKB7/KT0rEOn7T2rXW9QIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwDQYJKoZIhvcNAQELBQADggEBAKrtlIPhvDBxBfcqS9Xy39QqE1WOPiNQooa/FVVOsCROdRZrHhFcP27HpxO9e6genQSJ6nBRaJ4ykEf0oM535Ker5jZcDWzCwPIyt+5Kc6qeacZI5FxEHRldYkSd4lF1OTzQNvGLOPKnNWnYnXwj48ZxO50lJUsRFspVbP79E6llVNOPexrZ2GOzWghyY1E74f4uGr6fzcXQk2aFaIfLusoJlvbROPTnDu68Jt+IW4WZcO4F0tl0JIcuaqSmLS6McJW0Mpmu4wqEPV6E45zRAuX0kJUkKDMzM/lYW1MZ8QaSTt/pCmlknX1+KTgb6Sf9zZJEya8AyKML/NCpc4sfn8g=\"\n],\n\"n\": \"rlD19ib3J2bKYr2iap1d_gCmbXocMJTk5o7o3h9jJKXbh9pdf2gd3ZOE6wc5XwGx_CfHSgdEmACCXMiG7sQt80DPM67dlbtv_pEnWrHk4fwwst83OF-HXTSi4Sd9QWhDtBvaUu8Rp8ir-x2D0RK8YNGs0prA-qGR8O_h6Y-ascz4VNbbDlbJ-w7DJYeWU1HVp_5Lt8O5i4Q6I8KZEAytwvspF5y8m8DCrfYXF6Kz14vXgqr08hj0l0Aj4O3y_9i8kf2pmznpu5QEDimj1yxEB-G5WEYuHD_-qRTV85OXDIQJz6fgNM4kEimv7pmspcDfk_KKB7_KT0rEOn7T2rXW9Q\",\n\"e\": \"AQAB\",\n\"x\": null,\n\"y\": null\n</code></pre> <p>Now let's post this key to the Janssen Server to be added to the existing set:</p> Command<pre><code>jans cli --operation-id post-config-jwks-key --data /tmp/jwk.json\n</code></pre>","tags":["administration","configuration","JWK","json web keys","JWKS"]},{"location":"janssen-server/config-guide/auth-server-config/json-web-key-config/#replace-json-web-key-set","title":"Replace JSON Web Key Set","text":"<p>To replace the current JWKS configuration, use the <code>put-config-jwks</code> operation. This operation replaces the current set of JWK with the provided set.</p> <pre><code> Operation ID: put-config-jwks\n Description: Replaces JSON Web Keys\n Schema: WebKeysConfiguration\n</code></pre> <p>To get the schema file:</p> Command<pre><code> jans cli --schema WebKeysConfiguration\n</code></pre> <p>As suggested in the schema, we have to provide an array of keys in a json file containing <code>key-value</code> pairs. The properties in the key are defined by the JWK specification RFC 7517, and for algorithm-specific properties, in RFC 7518.</p>","tags":["administration","configuration","JWK","json web keys","JWKS"]},{"location":"janssen-server/config-guide/auth-server-config/json-web-key-config/#properties","title":"Properties","text":"name Description <code>kid</code> It's a unique identifier for the key configuration. <code>kty</code> It's used to define the type of the specific cryptographic algorithms <code>use</code> This parameter identifies the intended use of the public key. <code>sig</code> for signature and <code>enc</code> for encryption <code>alg</code> The specific algorithm used with the key <code>crv</code> <code>exp</code> The exponent for the RSA public key. <code>x5c</code> The <code>x5c</code> parameter contains a chain of one or more PKIX certificates RFC5280 <code>n</code> The modulus for the RSA public key. <code>e</code> The \"e\" (exponent) parameter contains the exponent value for the RSA public key.  It is represented as a Base64urlUInt-encoded value. <code>x</code> The \"x\" (x coordinate) parameter contains the x coordinate for the Elliptic Curve point. <code>y</code> The \"y\" (y coordinate) parameter contains the y coordinate for the Elliptic Curve point. <p>Let's update the json file to create a new key configuration.</p> Input Key<pre><code>{\n   \"keys\":\n   [{\n      \"kid\": \"dd550214-7969-41b9-b919-2a0cfa36047b_enc_rsa1_5\",\n      \"kty\": \"RSA\",\n      \"use\": \"enc\",\n      \"alg\": \"RSA-OAEP\",\n      \"crv\": \"\",\n      \"exp\": 1622245655163,\n      \"x5c\": [\n        \"MIIDCjCCAfKgAwIBAgIhANYLiviUTmgOsf9Bf+6N/pr6H4Mis5ku1VXNj7VW/CMbMA0GCSqGSIb3DQEBCwUAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNTI2MjM0NzI5WhcNMjEwNTI4MjM0NzM1WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArlD19ib3J2bKYr2iap1d/gCmbXocMJTk5o7o3h9jJKXbh9pdf2gd3ZOE6wc5XwGx/CfHSgdEmACCXMiG7sQt80DPM67dlbtv/pEnWrHk4fwwst83OF+HXTSi4Sd9QWhDtBvaUu8Rp8ir+x2D0RK8YNGs0prA+qGR8O/h6Y+ascz4VNbbDlbJ+w7DJYeWU1HVp/5Lt8O5i4Q6I8KZEAytwvspF5y8m8DCrfYXF6Kz14vXgqr08hj0l0Aj4O3y/9i8kf2pmznpu5QEDimj1yxEB+G5WEYuHD/+qRTV85OXDIQJz6fgNM4kEimv7pmspcDfk/KKB7/KT0rEOn7T2rXW9QIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwDQYJKoZIhvcNAQELBQADggEBAKrtlIPhvDBxBfcqS9Xy39QqE1WOPiNQooa/FVVOsCROdRZrHhFcP27HpxO9e6genQSJ6nBRaJ4ykEf0oM535Ker5jZcDWzCwPIyt+5Kc6qeacZI5FxEHRldYkSd4lF1OTzQNvGLOPKnNWnYnXwj48ZxO50lJUsRFspVbP79E6llVNOPexrZ2GOzWghyY1E74f4uGr6fzcXQk2aFaIfLusoJlvbROPTnDu68Jt+IW4WZcO4F0tl0JIcuaqSmLS6McJW0Mpmu4wqEPV6E45zRAuX0kJUkKDMzM/lYW1MZ8QaSTt/pCmlknX1+KTgb6Sf9zZJEya8AyKML/NCpc4sfn8g=\"\n      ],\n      \"n\": \"rlD19ib3J2bKYr2iap1d_gCmbXocMJTk5o7o3h9jJKXbh9pdf2gd3ZOE6wc5XwGx_CfHSgdEmACCXMiG7sQt80DPM67dlbtv_pEnWrHk4fwwst83OF-HXTSi4Sd9QWhDtBvaUu8Rp8ir-x2D0RK8YNGs0prA-qGR8O_h6Y-ascz4VNbbDlbJ-w7DJYeWU1HVp_5Lt8O5i4Q6I8KZEAytwvspF5y8m8DCrfYXF6Kz14vXgqr08hj0l0Aj4O3y_9i8kf2pmznpu5QEDimj1yxEB-G5WEYuHD_-qRTV85OXDIQJz6fgNM4kEimv7pmspcDfk_KKB7_KT0rEOn7T2rXW9Q\",\n      \"e\": \"AQAB\",\n      \"x\": null,\n      \"y\": null\n  }, \n  {\n     \"descr\": \"Signature Key: RSA RSASSA-PKCS1-v1_5 using SHA-256\",\n     \"kty\": \"RSA\",\n     \"e\": \"AQAB\",\n     \"use\": \"sig\",\n     \"key_ops_type\": [\n       \"connect\"\n       ],\n     \"kid\": \"connect_e47fd367-51d6-4d17-811d-adb1f1a0b723_sig_rs256\",\n     \"x5c\": [/janssen-server/config-guide/auth-server-config/json-web-key-config\n         \"MIIDCjCCAfKgAwIBAgIhAInuAAbxL2O7H+/V0lm3bbEdCmdPdgJh+OqljtWpwi7wMA0GCSqGSIb3DQEBCwUAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjQwNjIxMDg0ODE5WhcNMjQwNjIzMDg0ODI4WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA1RCY0ZfJ/SHZ+jojCyStBjIh4upkLXuMgZLi6b7k0fQ8/oNmCBEsOKMPUubHFEHrDHZLbXj7w5gEdMPZOiLaBP8Pv0JD8IbOUtoSXEawE33LRldKiof296nlBJFsX00ipiLq3ANXuTDXtP4+pd+lvIufv1nBXpqqrN4MOsSsKuvKvxRPCg6JusHVU5hsiqbwh9y3X7sPFwqw4LJFa0U3Z4RoX7vCsS/axPPSyUi9x0zsF4S7ZGHclBReC6IipOnGyGeSEQdpuchhoZs382md+wejIf4hVtusRbEHz+wwZFhnrfh/nvHCvrWCcxBgeEntAin+ig1RlR8N4x9Ox9K01wIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwDQYJKoZIhvcNAQELBQADggEBACkrKROjAIf6n1PKpXFTRQVov32EFcwhi1YSao/MZHURV2ruYXjh/S6HuvHWWofV8R6muLnD938GytS2mRjr+X7DOZj/bsDT7amd810SDvFUCh6IoPt46FeXFZMV4XyL4DQKoNxOEGGDVnD41NVC6k5GLzPwcVBwX11+b7wRfy/KoPP9aoSXjyWnNbhwClFQ9oTJYkNtaNeh2kJZ2j1UIqO51vyhUjpSM9awqV2u+ouxDKCT4h9xRcDwkOUlVXtBwn+dfJHnG6riLzT59MiPtWeo037hESUxIvJxLQP6jV97eEi/CMhSb1y6YJPFjnTBmCpzeHRp5+DNu65KPaGntB8=\"\n         ],\n     \"name\": \"Connect RS256 Sign Key\",\n     \"exp\": 1719132508905,\n     \"alg\": \"RS256\",\n     \"n\": \"1RCY0ZfJ_SHZ-jojCyStBjIh4upkLXuMgZLi6b7k0fQ8_oNmCBEsOKMPUubHFEHrDHZLbXj7w5gEdMPZOiLaBP8Pv0JD8IbOUtoSXEawE33LRldKiof296nlBJFsX00ipiLq3ANXuTDXtP4-pd-lvIufv1nBXpqqrN4MOsSsKuvKvxRPCg6JusHVU5hsiqbwh9y3X7sPFwqw4LJFa0U3Z4RoX7vCsS_axPPSyUi9x0zsF4S7ZGHclBReC6IipOnGyGeSEQdpuchhoZs382md-wejIf4hVtusRbEHz-wwZFhnrfh_nvHCvrWCcxBgeEntAin-ig1RlR8N4x9Ox9K01w\"\n     }\n\n\n   ]\n}\n</code></pre> <p>Now let's put the new keys into the Janssen server.</p> Command<pre><code> jans cli --operation-id put-config-jwks --data /tmp/path-jwk.json\n</code></pre> <p>Please remember that this operation replaces all JWKs in the Janssen server with new ones. So, in this case, if you want to keep old JWKs, you have to put them as well in the input file.</p> <p>Output Sample<pre><code>{\n  \"keys\": [\n    {\n      \"kty\": \"RSA\",\n      \"e\": \"AQAB\",\n      \"use\": \"enc\",\n      \"key_ops_type\": [],\n      \"kid\": \"dd550214-7969-41b9-b919-2a0cfa36047b_enc_rsa1_5\",\n      \"x5c\": [\n        \"MIIDCjCCAfKgAwIBAgIhANYLiviUTmgOsf9Bf+6N/pr6H4Mis5ku1VXNj7VW/CMbMA0GCSqGSIb3DQEBCwUAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNTI2MjM0NzI5WhcNMjEwNTI4MjM0NzM1WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArlD19ib3J2bKYr2iap1d/gCmbXocMJTk5o7o3h9jJKXbh9pdf2gd3ZOE6wc5XwGx/CfHSgdEmACCXMiG7sQt80DPM67dlbtv/pEnWrHk4fwwst83OF+HXTSi4Sd9QWhDtBvaUu8Rp8ir+x2D0RK8YNGs0prA+qGR8O/h6Y+ascz4VNbbDlbJ+w7DJYeWU1HVp/5Lt8O5i4Q6I8KZEAytwvspF5y8m8DCrfYXF6Kz14vXgqr08hj0l0Aj4O3y/9i8kf2pmznpu5QEDimj1yxEB+G5WEYuHD/+qRTV85OXDIQJz6fgNM4kEimv7pmspcDfk/KKB7/KT0rEOn7T2rXW9QIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwDQYJKoZIhvcNAQELBQADggEBAKrtlIPhvDBxBfcqS9Xy39QqE1WOPiNQooa/FVVOsCROdRZrHhFcP27HpxO9e6genQSJ6nBRaJ4ykEf0oM535Ker5jZcDWzCwPIyt+5Kc6qeacZI5FxEHRldYkSd4lF1OTzQNvGLOPKnNWnYnXwj48ZxO50lJUsRFspVbP79E6llVNOPexrZ2GOzWghyY1E74f4uGr6fzcXQk2aFaIfLusoJlvbROPTnDu68Jt+IW4WZcO4F0tl0JIcuaqSmLS6McJW0Mpmu4wqEPV6E45zRAuX0kJUkKDMzM/lYW1MZ8QaSTt/pCmlknX1+KTgb6Sf9zZJEya8AyKML/NCpc4sfn8g=\"\n      ],\n      \"exp\": 1622245655163,\n      \"alg\": \"RSA-OAEP\",\n      \"n\": \"rlD19ib3J2bKYr2iap1d_gCmbXocMJTk5o7o3h9jJKXbh9pdf2gd3ZOE6wc5XwGx_CfHSgdEmACCXMiG7sQt80DPM67dlbtv_pEnWrHk4fwwst83OF-HXTSi4Sd9QWhDtBvaUu8Rp8ir-x2D0RK8YNGs0prA-qGR8O_h6Y-ascz4VNbbDlbJ-w7DJYeWU1HVp_5Lt8O5i4Q6I8KZEAytwvspF5y8m8DCrfYXF6Kz14vXgqr08hj0l0Aj4O3y_9i8kf2pmznpu5QEDimj1yxEB-G5WEYuHD_-qRTV85OXDIQJz6fgNM4kEimv7pmspcDfk_KKB7_KT0rEOn7T2rXW9Q\"\n    },\n    {\n      \"descr\": \"Signature Key: RSA RSASSA-PKCS1-v1_5 using SHA-256\",\n      \"kty\": \"RSA\",\n      \"e\": \"AQAB\",\n      \"use\": \"sig\",\n      \"key_ops_type\": [\n        \"connect\"\n      ],\n      \"kid\": \"connect_e47fd367-51d6-4d17-811d-adb1f1a0b723_sig_rs256\",\n      \"x5c\": [\n        \"MIIDCjCCAfKgAwIBAgIhAInuAAbxL2O7H+/V0lm3bbEdCmdPdgJh+OqljtWpwi7wMA0GCSqGSIb3DQEBCwUAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjQwNjIxMDg0ODE5WhcNMjQwNjIzMDg0ODI4WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA1RCY0ZfJ/SHZ+jojCyStBjIh4upkLXuMgZLi6b7k0fQ8/oNmCBEsOKMPUubHFEHrDHZLbXj7w5gEdMPZOiLaBP8Pv0JD8IbOUtoSXEawE33LRldKiof296nlBJFsX00ipiLq3ANXuTDXtP4+pd+lvIufv1nBXpqqrN4MOsSsKuvKvxRPCg6JusHVU5hsiqbwh9y3X7sPFwqw4LJFa0U3Z4RoX7vCsS/axPPSyUi9x0zsF4S7ZGHclBReC6IipOnGyGeSEQdpuchhoZs382md+wejIf4hVtusRbEHz+wwZFhnrfh/nvHCvrWCcxBgeEntAin+ig1RlR8N4x9Ox9K01wIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwDQYJKoZIhvcNAQELBQADggEBACkrKROjAIf6n1PKpXFTRQVov32EFcwhi1YSao/MZHURV2ruYXjh/S6HuvHWWofV8R6muLnD938GytS2mRjr+X7DOZj/bsDT7amd810SDvFUCh6IoPt46FeXFZMV4XyL4DQKoNxOEGGDVnD41NVC6k5GLzPwcVBwX11+b7wRfy/KoPP9aoSXjyWnNbhwClFQ9oTJYkNtaNeh2kJZ2j1UIqO51vyhUjpSM9awqV2u+ouxDKCT4h9xRcDwkOUlVXtBwn+dfJHnG6riLzT59MiPtWeo037hESUxIvJxLQP6jV97eEi/CMhSb1y6YJPFjnTBmCpzeHRp5+DNu65KPaGntB8=\"\n      ],\n      \"name\": \"Connect RS256 Sign Key\",\n      \"exp\": 1719132508905,\n      \"alg\": \"RS256\",\n      \"n\": \"1RCY0ZfJ_SHZ-jojCyStBjIh4upkLXuMgZLi6b7k0fQ8_oNmCBEsOKMPUubHFEHrDHZLbXj7w5gEdMPZOiLaBP8Pv0JD8IbOUtoSXEawE33LRldKiof296nlBJFsX00ipiLq3ANXuTDXtP4-pd-lvIufv1nBXpqqrN4MOsSsKuvKvxRPCg6JusHVU5hsiqbwh9y3X7sPFwqw4LJFa0U3Z4RoX7vCsS_axPPSyUi9x0zsF4S7ZGHclBReC6IipOnGyGeSEQdpuchhoZs382md-wejIf4hVtusRbEHz-wwZFhnrfh_nvHCvrWCcxBgeEntAin-ig1RlR8N4x9Ox9K01w\"\n    }\n  ]\n}\n</code></pre> Now use the Get Configurations list of JWKs to confirm the replacement.</p>","tags":["administration","configuration","JWK","json web keys","JWKS"]},{"location":"janssen-server/config-guide/auth-server-config/json-web-key-config/#get-a-json-web-key-based-on-kid","title":"Get a JSON Web Key Based on kid","text":"<p>With <code>get-jwk-by-kid</code> operation-id, we can get any specific jwk matched with <code>kid</code>. If we know the <code>kid</code>, we can simply use the below command:</p> Command<pre><code>jans cli --operation-id get-jwk/janssen-server/config-guide/auth-server-config/json-web-key-config-by-kid \\\n--url-suffix kid:dd550214-7969-41b9-b919-2a0cfa36047b_enc_rsa1_5\n</code></pre> <p>It returns the details as below:</p> Sample Output<pre><code>{\n  \"kid\": \"dd550214-7969-41b9-b919-2a0cfa36047b_enc_rsa1_5\",\n  \"kty\": \"RSA\",\n  \"use\": \"enc\",\n  \"alg\": \"RSA-OAEP\",\n  \"exp\": 1622245655163,\n  \"x5c\": [\n    \"MIIDCjCCAfKgAwIBAgIhANYLiviUTmgOsf9Bf+6N/pr6H4Mis5ku1VXNj7VW/CMbMA0GCSqGSIb3DQEBCwUAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNTI2MjM0NzI5WhcNMjEwNTI4MjM0NzM1WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArlD19ib3J2bKYr2iap1d/gCmbXocMJTk5o7o3h9jJKXbh9pdf2gd3ZOE6wc5XwGx/CfHSgdEmACCXMiG7sQt80DPM67dlbtv/pEnWrHk4fwwst83OF+HXTSi4Sd9QWhDtBvaUu8Rp8ir+x2D0RK8YNGs0prA+qGR8O/h6Y+ascz4VNbbDlbJ+w7DJYeWU1HVp/5Lt8O5i4Q6I8KZEAytwvspF5y8m8DCrfYXF6Kz14vXgqr08hj0l0Aj4O3y/9i8kf2pmznpu5QEDimj1yxEB+G5WEYuHD/+qRTV85OXDIQJz6fgNM4kEimv7pmspcDfk/KKB7/KT0rEOn7T2rXW9QIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwDQYJKoZIhvcNAQELBQADggEBAKrtlIPhvDBxBfcqS9Xy39QqE1WOPiNQooa/FVVOsCROdRZrHhFcP27HpxO9e6genQSJ6nBRaJ4ykEf0oM535Ker5jZcDWzCwPIyt+5Kc6qeacZI5FxEHRldYkSd4lF1OTzQNvGLOPKnNWnYnXwj48ZxO50lJUsRFspVbP79E6llVNOPexrZ2GOzWghyY1E74f4uGr6fzcXQk2aFaIfLusoJlvbROPTnDu68Jt+IW4WZcO4F0tl0JIcuaqSmLS6McJW0Mpmu4wqEPV6E45zRAuX0kJUkKDMzM/lYW1MZ8QaSTt/pCmlknX1+KTgb6Sf9zZJEya8AyKML/NCpc4sfn8g=\"\n  ],\n  \"n\": \"rlD19ib3J2bKYr2iap1d_gCmbXocMJTk5o7o3h9jJKXbh9pdf2gd3ZOE6wc5XwGx_CfHSgdEmACCXMiG7sQt80DPM67dlbtv_pEnWrHk4fwwst83OF-HXTSi4Sd9QWhDtBvaUu8Rp8ir-x2D0RK8YNGs0prA-qGR8O_h6Y-ascz4VNbbDlbJ-w7DJYeWU1HVp_5Lt8O5i4Q6I8KZEAytwvspF5y8m8DCrfYXF6Kz14vXgqr08hj0l0Aj4O3y_9i8kf2pmznpu5QEDimj1yxEB-G5WEYuHD_-qRTV85OXDIQJz6fgNM4kEimv7pmspcDfk_KKB7_KT0rEOn7T2rXW9Q\",\n  \"e\": \"AQAB\"\n}\n</code></pre>","tags":["administration","configuration","JWK","json web keys","JWKS"]},{"location":"janssen-server/config-guide/auth-server-config/json-web-key-config/#patch-json-web-key-jwk-by-kid","title":"Patch JSON Web Key (JWK) by kid","text":"<p>Using <code>patch-config-jwks</code> operation, we can modify JSON Web Keys partially for its properties.</p> <pre><code>Operation ID: patch-config-jwks\n Description: Patches JSON Web Keys\n Schema: Array of JsonPatch\n</code></pre> <p>To use this operation, specify the id of the key that needs to be updated using the <code>--url-suffix</code> and the property and the new value using the JSON Patch . Refer here to know more about schema.</p> <p>In this example; We will change the value of the property <code>use</code> from <code>enc</code> to <code>sig</code>.</p> Input<pre><code>[\n{\n  \"op\": \"replace\",\n  \"path\": \"use\",\n  \"value\": \"sig\"\n}\n]\n</code></pre> <p>Now let's do the operation with the command line.</p> Command<pre><code>jans cli --operation-id patch-config-jwk-kid \\\n--url-suffix kid:dd550214-7969-41b9-b919-2a0cfa36047b_enc_rsa1_5 --data /tmp/schema.json\n</code></pre> <p>Updated Json Web Key:</p> Key<pre><code>{\n  \"kid\": \"dd550214-7969-41b9-b919-2a0cfa36047b_enc_rsa1_5\",\n  \"kty\": \"RSA\",\n  \"use\": \"sig\",\n  \"alg\": \"RSA-OAEP\",\n  \"exp\": 1622245655163,\n  \"x5c\": [\n    \"MIIDCjCCAfKgAwIBAgIhANYLiviUTmgOsf9Bf+6N/pr6H4Mis5ku1VXNj7VW/CMbMA0GCSqGSIb3DQEBCwUAMCQxIjAgBgNVBAMMGUphbnMgQXV0aCBDQSBDZXJ0aWZpY2F0ZXMwHhcNMjEwNTI2MjM0NzI5WhcNMjEwNTI4MjM0NzM1WjAkMSIwIAYDVQQDDBlKYW5zIEF1dGggQ0EgQ2VydGlmaWNhdGVzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArlD19ib3J2bKYr2iap1d/gCmbXocMJTk5o7o3h9jJKXbh9pdf2gd3ZOE6wc5XwGx/CfHSgdEmACCXMiG7sQt80DPM67dlbtv/pEnWrHk4fwwst83OF+HXTSi4Sd9QWhDtBvaUu8Rp8ir+x2D0RK8YNGs0prA+qGR8O/h6Y+ascz4VNbbDlbJ+w7DJYeWU1HVp/5Lt8O5i4Q6I8KZEAytwvspF5y8m8DCrfYXF6Kz14vXgqr08hj0l0Aj4O3y/9i8kf2pmznpu5QEDimj1yxEB+G5WEYuHD/+qRTV85OXDIQJz6fgNM4kEimv7pmspcDfk/KKB7/KT0rEOn7T2rXW9QIDAQABoycwJTAjBgNVHSUEHDAaBggrBgEFBQcDAQYIKwYBBQUHAwIGBFUdJQAwDQYJKoZIhvcNAQELBQADggEBAKrtlIPhvDBxBfcqS9Xy39QqE1WOPiNQooa/FVVOsCROdRZrHhFcP27HpxO9e6genQSJ6nBRaJ4ykEf0oM535Ker5jZcDWzCwPIyt+5Kc6qeacZI5FxEHRldYkSd4lF1OTzQNvGLOPKnNWnYnXwj48ZxO50lJUsRFspVbP79E6llVNOPexrZ2GOzWghyY1E74f4uGr6fzcXQk2aFaIfLusoJlvbROPTnDu68Jt+IW4WZcO4F0tl0JIcuaqSmLS6McJW0Mpmu4wqEPV6E45zRAuX0kJUkKDMzM/lYW1MZ8QaSTt/pCmlknX1+KTgb6Sf9zZJEya8AyKML/NCpc4sfn8g=\"\n  ],\n  \"n\": \"rlD19ib3J2bKYr2iap1d_gCmbXocMJTk5o7o3h9jJKXbh9pdf2gd3ZOE6wc5XwGx_CfHSgdEmACCXMiG7sQt80DPM67dlbtv_pEnWrHk4fwwst83OF-HXTSi4Sd9QWhDtBvaUu8Rp8ir-x2D0RK8YNGs0prA-qGR8O_h6Y-ascz4VNbbDlbJ-w7DJYeWU1HVp_5Lt8O5i4Q6I8KZEAytwvspF5y8m8DCrfYXF6Kz14vXgqr08hj0l0Aj4O3y_9i8kf2pmznpu5QEDimj1yxEB-G5WEYuHD_-qRTV85OXDIQJz6fgNM4kEimv7pmspcDfk_KKB7_KT0rEOn7T2rXW9Q\",\n  \"e\": \"AQAB\"\n}\n</code></pre> <p>We see it has replaced the value of the <code>use</code> property from <code>enc</code> to <code>sig</code>.</p> <p>Please read about patch method, You can get some idea of how this patch method works to modify particular properties of any task.</p>","tags":["administration","configuration","JWK","json web keys","JWKS"]},{"location":"janssen-server/config-guide/auth-server-config/json-web-key-config/#delete-json-web-key-using-kid","title":"Delete Json Web Key using kid","text":"<p>It's pretty simple to delete json web key using its <code>kid</code>. The command line is:</p> Command<pre><code>jans cli --operation-id delete-config-jwk-kid \\\n--url-suffix kid:dd550214-7969-41b9-b919-2a0cfa36047b_enc_rsa1_5\n</code></pre> <p>It will delete the jwk if it matches with the given <code>kid</code>.</p>","tags":["administration","configuration","JWK","json web keys","JWKS"]},{"location":"janssen-server/config-guide/auth-server-config/json-web-key-config/#using-text-based-ui","title":"Using Text-based UI","text":"<p>In Janssen, you can view the JSON web keys using the Text-Based UI also.</p> <p>You can start TUI using the command below:</p> Command<pre><code>jans tui\n</code></pre>","tags":["administration","configuration","JWK","json web keys","JWKS"]},{"location":"janssen-server/config-guide/auth-server-config/json-web-key-config/#json-web-key-jwk-screen","title":"JSON Web Key (JWK) Screen","text":"<p>Navigate to <code>Auth Server</code> -&gt; <code>Keys</code> to open the JSON Web Key screen as shown in the image below.</p> <ul> <li> <p>After clicking on <code>Get keys</code>, You can view Key's list on this page. You cannot perform any operations in text-based UI.</p> </li> <li> <p>Only you can perform operations using the command line.</p> </li> </ul> <p></p>","tags":["administration","configuration","JWK","json web keys","JWKS"]},{"location":"janssen-server/config-guide/auth-server-config/json-web-key-config/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring the Json Web key. Endpoint details are published in the Swagger document.</p>","tags":["administration","configuration","JWK","json web keys","JWKS"]},{"location":"janssen-server/config-guide/auth-server-config/logging-configuration/","title":"Log Management","text":"<p>Logging for Janssen Server modules is managed at the individual module level. Meaning there is no single switch or configuration that will enable or disable logs for all modules. Each module can be individually configured and can be configured differently when it comes to logging.</p>","tags":["administration","configuration","logging"]},{"location":"janssen-server/config-guide/auth-server-config/logging-configuration/#log-configuration-for-jans-auth","title":"Log Configuration For jans-auth","text":"Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal.  Learn how to use Jans Text-based UI (TUI)  here or jump straight to the Using-text-based-ui</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here or Jump straight to the Using Configuration REST API</p>","tags":["administration","configuration","logging"]},{"location":"janssen-server/config-guide/auth-server-config/logging-configuration/#using-command-line","title":"Using Command Line","text":"<p>In the Janssen Server, you can deploy and customize the Logging Configuration using the command line. To get the details of Janssen command line operations relevant to Logging configuration, you can check the operations under <code>ConfigurationLogging</code> task using the command below:</p> Command<pre><code>jans cli --info ConfigurationLogging\n</code></pre> Sample Output<pre><code>Operation ID: get-config-logging\n  Description: Returns Jans Authorization Server logging settings\nOperation ID: put-config-logging\n  Description: Updates Jans Authorization Server logging settings\n  Schema: Logging\n\nTo get sample schema type jans cli --schema &lt;schema&gt;, for example jans cli --schema Logging\n</code></pre>","tags":["administration","configuration","logging"]},{"location":"janssen-server/config-guide/auth-server-config/logging-configuration/#find-logging-configuration","title":"Find Logging Configuration","text":"Command<pre><code>jans cli --operation-id get-config-logging\n</code></pre> Sample Output<pre><code>{\n  \"loggingLevel\": \"DEBUG\",\n  \"loggingLayout\": \"string\",\n  \"httpLoggingEnabled\": true,\n  \"disableJdkLogger\": true,\n  \"enabledOAuthAuditLogging\": true,\n  \"externalLoggerConfiguration\": \"string\",\n  \"httpLoggingExcludePaths\": [\n    \"string\"\n  ]\n}\n</code></pre>","tags":["administration","configuration","logging"]},{"location":"janssen-server/config-guide/auth-server-config/logging-configuration/#update-logging-configuration","title":"Update Logging Configuration","text":"<p>To update the configuration follow the steps below.</p> <ol> <li>Get the current logging configuration and store it in a file for editing.    The following command will retrieve the current logging configuration and     store it in a file.    Command<pre><code>jans cli -no-color --operation-id get-config-logging &gt; /tmp/log-config.json\n</code></pre></li> <li>Update the configuration with desired value in the file while        keeping other properties and values unchanged. Updates must adhere to the       <code>Logging</code> schema as mentioned here.       The schema details can be retrieved using the command below.       The schema defines what values and datatypes are acceptable for each        property value.    Command<pre><code>jans cli --schema Logging \n</code></pre></li> <li>Use the updated file to send the update to the Janssen Server using the      command below    Command<pre><code>jans cli --operation-id put-config-logging --data /tmp/log-config.json\n</code></pre>    Upon successful execution of the update, the Janssen Server responds with     updated configuration.</li> </ol>","tags":["administration","configuration","logging"]},{"location":"janssen-server/config-guide/auth-server-config/logging-configuration/#using-text-based-ui","title":"Using-text-based-ui","text":"<p>Start TUI using the command below:</p> Command<pre><code>jans tui\n</code></pre>","tags":["administration","configuration","logging"]},{"location":"janssen-server/config-guide/auth-server-config/logging-configuration/#logging-configuration-for-auth-server","title":"Logging Configuration for Auth Server","text":"<ul> <li>Navigate to <code>Auth Server</code> -&gt; <code>Logging</code> to open the Logging screen as shown in the image below to change the logging properties configuration.</li> </ul>","tags":["administration","configuration","logging"]},{"location":"janssen-server/config-guide/auth-server-config/logging-configuration/#logging-configuration-for-fido","title":"Logging Configuration for FIDO","text":"<ul> <li>Navigate to <code>FIDO</code> to open the Logging screen as shown in the image below to change the logging properties configuration.</li> </ul>","tags":["administration","configuration","logging"]},{"location":"janssen-server/config-guide/auth-server-config/logging-configuration/#logging-configuration-for-scim","title":"Logging Configuration for SCIM","text":"<ul> <li>Navigate to <code>SCIM</code> to open the Logging screen as shown in the image below to change the logging properties configuration.</li> </ul>","tags":["administration","configuration","logging"]},{"location":"janssen-server/config-guide/auth-server-config/logging-configuration/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring logging. Endpoint details are published in the Swagger document.</p>","tags":["administration","configuration","logging"]},{"location":"janssen-server/config-guide/auth-server-config/logging-configuration/#default-log-location","title":"Default Log Location","text":"<p>On a VM installation, logs for <code>jans-auth</code> module are generated at <code>/opt/jans/jetty/jans-auth/logs/</code>. Similarly, logs for FIDO2 and SCIM modules are generated under <code>/opt/jans/jetty/jans-fido2/logs/</code> and <code>/opt/jans/jetty/jans-scim/logs/</code> respectively.</p>","tags":["administration","configuration","logging"]},{"location":"janssen-server/config-guide/auth-server-config/logging-configuration/#cloud-native-deployments","title":"Cloud-Native Deployments","text":"<p>Logging configuration for a cloud-native deployment is detailed here</p>","tags":["administration","configuration","logging"]},{"location":"janssen-server/config-guide/auth-server-config/messaging-config/","title":"Messaging Configuration","text":"<p>The Janssen server provides messaging infrastructure for publish-subscribe message flows. Messaging infrastructure is configurable to the level where it can be enabled or disabled. When enabled, the configuration also allows a choice of providers and supplying configuration for those providers.</p> <p>The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal.  Learn how to use Jans Text-based UI (TUI)  here or jump straight to the configuration steps</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here or Jump straight to the configuration steps</p>","tags":["administration","configuration","messaging"]},{"location":"janssen-server/config-guide/auth-server-config/messaging-config/#using-command-line","title":"Using Command Line","text":"<p>To get the details of Janssen command line operations relevant to the messaging configuration, you can check the operations under <code>MessageConfiguration</code> using the command below:</p> <p>Command<pre><code>/opt/jans/jans-cli/config-cli.py --info MessageConfiguration\n</code></pre> It prints below two operations:</p> Output<pre><code>Operation ID: get-config-message\n Description: Returns message configuration.\nOperation ID: patch-config-message\n Description: Patch message configuration\n Schema: Array of JsonPatch\n\nTo get sample schema type /opt/jans/jans-cli/config-cli.py --schema-sample &lt;schema&gt;, for example /opt/jans/jans-cli/config-cli.py --schema-sample JsonPatch\n</code></pre>","tags":["administration","configuration","messaging"]},{"location":"janssen-server/config-guide/auth-server-config/messaging-config/#get-messaging-configuration","title":"Get Messaging Configuration","text":"<p>You can get the Messaging Configuration of the Janssen Server by performing this operation.</p> Command<pre><code>/opt/jans/jans-cli/config-cli.py --operation-id get-config-message\n</code></pre> Sample Output<pre><code>{\n  \"messageProviderType\": \"DISABLED\",\n  \"nullConfiguration\": {},\n  \"redisConfiguration\": {\n    \"redisProviderType\": \"STANDALONE\",\n    \"servers\": \"localhost:6379\",\n    \"defaultPutExpiration\": 60,\n    \"useSSL\": false,\n    \"maxIdleConnections\": 10,\n    \"maxTotalConnections\": 500,\n    \"connectionTimeout\": 3000,\n    \"soTimeout\": 3000,\n    \"maxRetryAttempts\": 5\n  },\n  \"postgresConfiguration\": {\n    \"dbSchemaName\": \"public\",\n    \"connectionUri\": \"jdbc:postgresql://localhost:5432/jansdb\",\n    \"authUserName\": \"jans\",\n    \"authUserPassword\": \"U45+dbPl4eRjH1yXkp5NlQ==\",\n    \"messageWaitMillis\": 100,\n    \"messageSleepThreadTime\": 200\n  }\n}\n</code></pre>","tags":["administration","configuration","messaging"]},{"location":"janssen-server/config-guide/auth-server-config/messaging-config/#patch-messaging-configuration","title":"Patch Messaging Configuration","text":"<p>To patch update the messaging configuration, use the <code>patch-config-message</code> operation.</p> <p>The <code>patch-config-message</code> operation uses the JSON Patch schema to describe the configuration change. Refer here to know more about schema.</p> <p>For instance, to perform a <code>replace</code> operation and change the <code>messageProviderType</code> from <code>DISABLED</code> to <code>REDIS</code>, the JSON Patch data would be like below:</p> Input<pre><code>[\n  {\n  \"op\": \"replace\",\n  \"path\": \"messageProviderType\",\n  \"value\": \"REDIS\"\n  }\n]\n</code></pre> <p>Store the above JSON Patch data in a file, for instance, <code>/tmp/message-patch.json</code></p> <p>Using the above file, perform the operation as below:</p> Sample Command<pre><code>/opt/jans/jans-cli/config-cli.py --operation-id patch-config-message \\\n--data /tmp/message-patch.json\n</code></pre> Sample Output<pre><code>{\n  \"messageProviderType\": \"REDIS\",\n  \"nullConfiguration\": {},\n  \"redisConfiguration\": {\n    \"redisProviderType\": \"STANDALONE\",\n    \"servers\": \"localhost:6379\",\n    \"defaultPutExpiration\": 60,\n    \"useSSL\": false,\n    \"maxIdleConnections\": 10,\n    \"maxTotalConnections\": 500,\n    \"connectionTimeout\": 3000,\n    \"soTimeout\": 3000,\n    \"maxRetryAttempts\": 5\n },\n  \"postgresConfiguration\": {\n    \"dbSchemaName\": \"public\",\n    \"connectionUri\": \"jdbc:postgresql://localhost:5432/jansdb\",\n    \"authUserName\": \"jans\",\n    \"authUserPassword\": \"U45+dbPl4eRjH1yXkp5NlQ==\",\n    \"messageWaitMillis\": 100,\n    \"messageSleepThreadTime\": 200\n }\n}\n</code></pre>","tags":["administration","configuration","messaging"]},{"location":"janssen-server/config-guide/auth-server-config/messaging-config/#messaging-configuration-for-postgres","title":"Messaging Configuration For Postgres","text":"<p>When <code>Postgres</code> is being used as a messaging provider, use the operations under the task <code>MessageConfigurationPostgres</code> to configure and manage the provider.</p> Command<pre><code>/opt/jans/jans-cli/config-cli.py --info MessageConfigurationPostgres\n</code></pre> Output<pre><code>Operation ID: get-config-message-postgres\n Description: Returns Postgres message configuration.\nOperation ID: put-config-message-postgres\n Description: Updates Postgres message configuration\n Schema: PostgresMessageConfiguration\nOperation ID: patch-config-message-postgres\n Description: Patch Postgres message configuration\n Schema: Array of JsonPatch\n</code></pre>","tags":["administration","configuration","messaging"]},{"location":"janssen-server/config-guide/auth-server-config/messaging-config/#get-postgres-messaging-configuration","title":"Get Postgres Messaging Configuration","text":"<p>You can get the Postgres messaging configuration of the Janssen Server by performing this operation.</p> Command<pre><code>/opt/jans/jans-cli/config-cli.py --operation-id get-config-message-postgres\n</code></pre> <p>It will show the configuration details as below.</p> Sample Output<pre><code>{\n  \"dbSchemaName\": \"public\",\n  \"connectionUri\": \"jdbc:postgresql://localhost:5432/jansdb\",\n  \"authUserName\": \"jans\",\n  \"authUserPassword\": \"U45+dbPl4eRjH1yXkp5NlQ==\",\n  \"messageWaitMillis\": 100,\n  \"messageSleepThreadTime\": 200\n}\n</code></pre>","tags":["administration","configuration","messaging"]},{"location":"janssen-server/config-guide/auth-server-config/messaging-config/#update-postgres-messaging-configuration","title":"Update Postgres Messaging Configuration","text":"<p>To update the configuration follow the steps below.</p> <ol> <li>Get the current Postgres messaging configuration  and store it in a file for editing using the command [below].    <pre><code>/opt/jans/jans-cli/config-cli.py -no-color --operation-id get-config-message-postgres &gt;\\\n /tmp/postgres.json\n</code></pre></li> <li>Edit and update the desired configuration values in the file while  keeping other properties and values unchanged.Updates must adhere   to the <code>PostgresMessageConfiguration</code> schema as mentioned   here.   The schema details can be retrieved using the command below.   The schema defines what values and datatypes are acceptable for each property   value.    <code>text title=\"Command\"  /opt/jans/jans-cli/config-cli.py --schema PostgresMessageConfiguration</code></li> <li> <p>The Janssen Server also provides an example of data that adheres to the above  schema.  To fetch the example, use the command below.    Command<pre><code>/opt/jans/jans-cli/config-cli.py --schema-sample PostgresMessageConfiguration\n</code></pre></p> </li> <li> <p>Use the updated file to send the update to the Janssen Server using the command below  Command<pre><code> /opt/jans/jans-cli/config-cli.py --operation-id put-config-message-postgres \\\n--data /tmp/postgres.json\n</code></pre></p> </li> </ol>","tags":["administration","configuration","messaging"]},{"location":"janssen-server/config-guide/auth-server-config/messaging-config/#patch-postgres-message-configuration","title":"Patch Postgres Message Configuration","text":"<p>To update the messaging configuration use the <code>patch-config-message-postgres</code> operation.</p> <p>The <code>patch-config-message-postgres</code> operation uses the JSON Patch schema to describe the configuration change. Refer here to know more about schema.</p> <p>For instance, to perform a <code>replace</code> operation at <code>messageWaitMillis</code> and change it from <code>100</code> to <code>1000</code>, the JSON Patch data would look like below:</p> Input<pre><code>[\n  {\n  \"op\": \"replace\",\n  \"path\": \"messageWaitMillis\",\n  \"value\": \"1000\"\n  }\n]\n</code></pre> <p>Store the above JSON Patch data in a file, for instance, <code>/tmp/patch-postgres.json</code></p> <p>Using the above file, perform the operation as below:</p> Sample Command<pre><code>/opt/jans/jans-cli/config-cli.py --operation-id patch-config-message-postgres \\\n--data /tmp/patch-postgres.json\n</code></pre> Sample Output<pre><code>{\n  \"dbSchemaName\": \"public\",\n  \"connectionUri\": \"jdbc:postgresql://localhost:5432/jansdb\",\n  \"authUserName\": \"jans-postgres\",\n  \"authUserPassword\": \"U45+dbPl4eRjH1yXkp5NlQ==\",\n  \"messageWaitMillis\": 1000,\n  \"messageSleepThreadTime\": 200\n}\n</code></pre>","tags":["administration","configuration","messaging"]},{"location":"janssen-server/config-guide/auth-server-config/messaging-config/#messaging-configuration-for-redis","title":"Messaging Configuration For Redis","text":"<p>To manage the Redis messaging configuratio, check the operations under the task <code>MessageConfigurationRedis</code> using the command below:</p> Command<pre><code>/opt/jans/jans-cli/config-cli.py --info MessageConfigurationRedis\n</code></pre> Output<pre><code>Operation ID: get-config-message-redis\n Description: Returns Redis message configuration\nOperation ID: put-config-message-redis\n Description: Updates Redis message configuration\n Schema: RedisMessageConfiguration\nOperation ID: patch-config-message-redis\n Description: Patch Redis message configuration\n Schema: Array of JsonPatch\n\nTo get sample schema type /opt/jans/jans-cli/config-cli.py --schema-sample &lt;schema&gt;, for example /opt/jans/jans-cli/config-cli.py --schema-sample JsonPatch\n</code></pre>","tags":["administration","configuration","messaging"]},{"location":"janssen-server/config-guide/auth-server-config/messaging-config/#get-redis-messaging-configuration","title":"Get Redis Messaging Configuration","text":"<p>You can get the Redis message configuration of your Janssen Server by performing this operation.</p> <p>Command<pre><code>/opt/jans/jans-cli/config-cli.py --operation-id get-config-message-redis\n</code></pre> It will show the configuration details.</p> Sample Output<pre><code>{\n  \"redisProviderType\": \"STANDALONE\",\n  \"servers\": \"localhost:6379\",\n  \"defaultPutExpiration\": 60,\n  \"useSSL\": false,\n  \"maxIdleConnections\": 10,\n  \"maxTotalConnections\": 500,\n  \"connectionTimeout\": 3000,\n  \"soTimeout\": 3000,\n  \"maxRetryAttempts\": 5\n}\n</code></pre>","tags":["administration","configuration","messaging"]},{"location":"janssen-server/config-guide/auth-server-config/messaging-config/#update-redis-message-configuration","title":"Update Redis Message Configuration","text":"<p>To update the configuration follow the steps below.</p> <ol> <li>Get the current Redis Message configuration   and store it into a file for editing    <pre><code>/opt/jans/jans-cli/config-cli.py -no-color --operation-id get-config-message-redis &gt;\\\n /tmp/redis.json\n</code></pre></li> <li>Edit and update the desired configuration values in the file while keeping   other properties and values unchanged. Updates must adhere to   the <code>RedisMessageConfiguration</code> schema as mentioned here.  The schema details can be retrieved using the command below.   The schema defines what values and datatypes are acceptable for each property value.    <code>text title=\"Command\"  /opt/jans/jans-cli/config-cli.py --schema RedisMessageConfiguration</code></li> <li> <p>The Janssen Server also provides an example of data that   adheres to the above schema.To fetch the example, use the command below.    Command<pre><code>/opt/jans/jans-cli/config-cli.py --schema-sample RedisMessageConfiguration\n</code></pre></p> </li> <li> <p>Use the updated file to send the update to the Janssen   Server using the command below  Command<pre><code> /opt/jans/jans-cli/config-cli.py --operation-id put-config-message-redis \\\n--data /tmp/redis.json\n</code></pre></p> </li> </ol>","tags":["administration","configuration","messaging"]},{"location":"janssen-server/config-guide/auth-server-config/messaging-config/#patch-redis-message-configuration","title":"Patch Redis Message Configuration","text":"<p>You may need to update the messaging configuration, In that case <code>patch-config-message-redis</code> can be used to modify the configuration.</p> <p>The <code>patch-config-message-redis</code> operation uses the JSON Patch schema to describe the configuration change. Refer here to know more about schema.</p> <p>For instance, to perform a <code>replace</code> operation at <code>maxTotalConnections</code> and change it from <code>500</code> to <code>600</code>, the JSON Patch data would look like below:</p> Input<pre><code>[\n  {\n  \"op\": \"replace\",\n  \"path\": \"maxTotalConnections\",\n  \"value\": \"600\"\n  }\n]\n</code></pre> <p>Store the above JSON Patch data in a file, for instance, <code>/tmp/patch-redis.json</code></p> <p>Using the above file, perform the operation as below:</p> Sample Command<pre><code>/opt/jans/jans-cli/config-cli.py --operation-id patch-config-message-redis \\\n--data /tmp/patch-redis.json\n</code></pre> Sample Output<pre><code>{\n   \"redisProviderType\": \"STANDALONE\",\n   \"servers\": \"localhost:6379\",\n   \"defaultPutExpiration\": 60,\n   \"useSSL\": false,\n   \"maxIdleConnections\": 10,\n   \"maxTotalConnections\": 600,\n   \"connectionTimeout\": 3000,\n   \"soTimeout\": 3000,\n   \"maxRetryAttempts\": 5\n}\n</code></pre>","tags":["administration","configuration","messaging"]},{"location":"janssen-server/config-guide/auth-server-config/messaging-config/#using-text-based-ui","title":"Using Text-based UI","text":"<p>In the Janssen Server, You can manage Message Configuration using the Text-Based UI also.</p> <p>You can start TUI using the command below:</p> Command<pre><code>sudo /opt/jans/jans-cli/jans_cli_tui.py\n</code></pre> <p>Navigate to <code>Auth Server</code> -&gt; <code>Messages</code> to open the Message screen as shown in the image below. There are three different message configuration options accessible on this screen. You can update the details of these messages.</p> <p></p>","tags":["administration","configuration","messaging"]},{"location":"janssen-server/config-guide/auth-server-config/messaging-config/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring the Messages Configuration. Endpoint details are published in the Swagger document.</p>","tags":["administration","configuration","messaging"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-scopes-config/","title":"OAuth Scopes","text":"<p>The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal.  Learn how to use Jans Text-based UI (TUI)  here or jump straight to the configuration steps</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here or Jump straight to the Using Configuration REST API</p>","tags":["administration","configuration","scopes"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-scopes-config/#using-command-line","title":"Using Command Line","text":"<p>In the Janssen Server, you can deploy and customize the OAuth scopes using the command line. To get the details of Janssen command line operations relevant to OAuth Scope, you can check the operations under the <code>OauthScopes</code> task using the command below.</p> <p>Command<pre><code>jans cli --info OauthScopes\n</code></pre> Sample Output<pre><code>Operation ID: get-oauth-scopes\n  Description: Gets list of Scopes\n  Parameters:\n  type: Scope type [string]\n  limit: Search size - max size of the results to return [integer]\n  pattern: Search pattern [string]\n  startIndex: The 1-based index of the first query result [integer]\n  sortBy: Attribute whose value will be used to order the returned response [string]\n  sortOrder: Order in which the sortBy param is applied. Allowed values are \"ascending\" and \"descending\" [string]\n  withAssociatedClients: Boolean fag to indicate if clients associated with the scope are to be returned [boolean]\n  fieldValuePair: Field and value pair for seraching [string]\nOperation ID: put-oauth-scopes\n  Description: Update Scope\n  Schema: Scope\nOperation ID: post-oauth-scopes\n  Description: Create Scope\n  Schema: Scope\nOperation ID: get-oauth-scopes-by-inum\n  Description: Get Scope by Inum\n  Parameters:\n  inum: Scope identifier [string]\n  withAssociatedClients: No description is provided for this parameter [boolean]\nOperation ID: delete-oauth-scopes-by-inum\n  Description: Delete Scope\n  Parameters:\n  inum: Scope identifier [string]\nOperation ID: patch-oauth-scopes-by-id\n  Description: Patch Scope\n  Parameters:\n  inum: Scope identifier [string]\n  Schema: Array of JsonPatch\nOperation ID: get-scope-by-creator\n  Description: Get Scope by creatorId\n  Parameters:\n  creatorId: Id of the scope creator. If creator is client then client_id if user then user_id [string]\nOperation ID: get-scope-by-type\n  Description: Get Scope by type\n  Parameters:\n  type: Type of the scope [string]\n\nTo get sample schema type jans cli --schema-sample &lt;schema&gt;, for example jans cli --schema-sample JsonPatch\n</code></pre></p>","tags":["administration","configuration","scopes"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-scopes-config/#findview-oauth-scopes","title":"Find/View OAuth Scopes","text":"<p>Use the operation ID <code>get-oauth-scopes</code> to find and view the current scopes. Let's retrieve 3 scopes that contain <code>view</code> in the description and <code>openid</code> as the Type.</p> Command<pre><code> jans cli --operation-id get-oauth-scopes \\\n --endpoint-args limit:3,pattern:view,type:openid\n</code></pre> Sample Output<pre><code> {\n  \"start\": 0,\n  \"totalEntriesCount\": 7,\n  \"entriesCount\": 3,\n  \"entries\": [\n    {\n      \"dn\": \"inum=10B2,ou=scopes,o=jans\",\n      \"inum\": \"10B2\",\n      \"displayName\": \"view_username\",\n      \"id\": \"user_name\",\n      \"description\": \"View your local username in the Janssen Server.\",\n      \"scopeType\": \"openid\",\n      \"claims\": [\n        \"inum=42E0,ou=attributes,o=jans\"\n      ],\n      \"defaultScope\": false,\n      \"attributes\": {\n        \"showInConfigurationEndpoint\": true\n      },\n      \"creationDate\": \"2024-06-25T09:02:25\",\n      \"umaType\": false,\n      \"baseDn\": \"inum=10B2,ou=scopes,o=jans\"\n    },\n    {\n      \"dn\": \"inum=341A,ou=scopes,o=jans\",\n      \"inum\": \"341A\",\n      \"displayName\": \"view_client\",\n      \"id\": \"clientinfo\",\n      \"description\": \"View the client info.\",\n      \"scopeType\": \"openid\",\n      \"claims\": [\n        \"inum=2B29,ou=attributes,o=jans\",\n        \"inum=29DA,ou=attributes,o=jans\"\n      ],\n      \"defaultScope\": false,\n      \"attributes\": {\n        \"showInConfigurationEndpoint\": true\n      },\n      \"creationDate\": \"2024-06-25T09:02:25\",\n      \"umaType\": false,\n      \"baseDn\": \"inum=341A,ou=scopes,o=jans\"\n    },\n    {\n      \"dn\": \"inum=43F1,ou=scopes,o=jans\",\n      \"inum\": \"43F1\",\n      \"displayName\": \"view_profile\",\n      \"id\": \"profile\",\n      \"description\": \"View your basic profile info.\",\n      \"scopeType\": \"openid\",\n      \"claims\": [\n        \"inum=2B29,ou=attributes,o=jans\",\n        \"inum=0C85,ou=attributes,o=jans\",\n        \"inum=B4B0,ou=attributes,o=jans\",\n        \"inum=A0E8,ou=attributes,o=jans\",\n        \"inum=5EC6,ou=attributes,o=jans\",\n        \"inum=B52A,ou=attributes,o=jans\",\n        \"inum=64A0,ou=attributes,o=jans\",\n        \"inum=EC3A,ou=attributes,o=jans\",\n        \"inum=3B47,ou=attributes,o=jans\",\n        \"inum=3692,ou=attributes,o=jans\",\n        \"inum=98FC,ou=attributes,o=jans\",\n        \"inum=A901,ou=attributes,o=jans\",\n        \"inum=36D9,ou=attributes,o=jans\",\n        \"inum=BE64,ou=attributes,o=jans\",\n        \"inum=6493,ou=attributes,o=jans\",\n        \"inum=4CF1,ou=attributes,o=jans\",\n        \"inum=29DA,ou=attributes,o=jans\"\n      ],\n      \"defaultScope\": false,\n      \"attributes\": {\n        \"showInConfigurationEndpoint\": true\n      },\n      \"creationDate\": \"2024-06-25T09:02:25\",\n      \"umaType\": false,\n      \"baseDn\": \"inum=43F1,ou=scopes,o=jans\"\n    }\n  ]\n}\n</code></pre>","tags":["administration","configuration","scopes"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-scopes-config/#create-an-oauth-scope","title":"Create an OAuth Scope","text":"<p>To create a new scope, we can use <code>post-oauth-scopes</code> operation id. As shown in the output for <code>--info</code> command, the <code>post-oauth-scopes</code> operation requires data to be sent according to <code>Scope</code> schema.</p> <p>To see the schema, use the command below:</p> Command<pre><code>jans cli --schema Scope\n</code></pre> <p>For better understanding, the Janssen Server also provides a sample of data to be sent to the server. This sample conforms to the schema above. Use the command below to get the sample.</p> Command<pre><code>jans cli --schema-sample Scope\n</code></pre> <p>Using the schema and the example above, we have added below key data to the file <code>/tmp/scope.json</code></p> Input<pre><code>{\n  \"dn\": null,\n  \"id\": \"TestScopeID\",\n  \"inum\":null,\n  \"displayName\": \"TestScope\",\n  \"description\": \"Test Scope created by jans-cli\",\n  \"iconUrl\": null,\n  \"authorizationPolicies\": [],\n  \"defaultScope\": true,\n  \"scopeType\": \"openid\",\n  \"claims\": [],\n  \"umaType\": false,\n  \"umaAuthorizationPolicies\": [],\n  \"attributes\": {\n    \"spontaneousClientId\": null,\n    \"spontaneousClientScopes\": [],\n    \"showInConfigurationEndpoint\": true\n  }\n}\n</code></pre> <p>Now let's post this scope to the Janssen Server to be added to the existing set:</p> Command<pre><code> jans cli --operation-id post-oauth-scopes \\\n --data /tmp/scope.json \n</code></pre>","tags":["administration","configuration","scopes"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-scopes-config/#update-existing-oauth-scopes","title":"Update Existing OAuth Scopes","text":"<p>To update the configuration follow the steps below.</p> <ol> <li> <p>Get the existing OAuth Scope and store it into a file for editing.   The following command will retrieve the existing OAuth Scope in the schema file.   Sample Command<pre><code>jans cli -no-color --operation-id get-oauth-scopes-by-inum \\\n--url-suffix inum:8eb2b0c0-d1d9-453d-8364-e2809ce857f2 &gt; /tmp/scopdata.json\n</code></pre></p> </li> <li> <p>Edit and update the desired configuration values in the file while keeping other    properties and values unchanged. Updates must adhere to the <code>Scope</code>    schema as mentioned here.</p> </li> <li> <p>We have changed only the <code>scopeType</code> to <code>dynamic</code> in existing OAuth Scope.    Use the updated file to send the update to the Janssen Server using the command below    Command<pre><code>jans cli --operation-id put-oauth-scopes --data /tmp/scope.json\n</code></pre> This will updated the existing oauth scopes matched with inum value.</p> </li> </ol>","tags":["administration","configuration","scopes"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-scopes-config/#patch-oauth-scopes-by-inum","title":"Patch OAuth Scopes by <code>inum</code>","text":"<p>Let's update <code>iconUrl</code> with patch method. So we need a schema for the patch method. Remember when we queried info for the task OAuthScopes it printed:</p> <p><pre><code>Operation ID: patch-oauth-scopes-by-id\n  Description: Patch Scope\n  Parameters:\n  inum: Scope identifier [string]\n  Schema: Array of JsonPatch\n</code></pre> The <code>patch-oauth-scopes-by-id</code> operation uses the JSON Patch schema to describe the configuration change. Refer Jans CLI README to know more about schema.</p> Command<pre><code>jans cli --schema JsonPatch &gt; /tmp/patch.json\n</code></pre> <p>For instance, to perform a <code>replace</code> operation at <code>iconUrl</code> and change it from <code>null</code> to <code>https://www.jans.io/icon.png</code>, the JSON Patch data would look like below:</p> <p>Input<pre><code>[\n  {\n  \"op\": \"replace\",\n  \"path\": \"iconUrl\",\n  \"value\": \"https://www.jans.io/icon.png\"\n  }\n]\n</code></pre> Store the above JSON Patch data in a file, for instance, <code>/tmp/patch.json</code></p> <p>Let's do the operation: Command<pre><code>jans cli --operation-id patch-oauth-scopes-by-id \\\n--url-suffix inum:8eb2b0c0-d1d9-453d-8364-e2809ce857f2 --data /tmp/patch.json \n</code></pre></p> Sample Output<pre><code>{\n  \"dn\": \"inum=8eb2b0c0-d1d9-453d-8364-e2809ce857f2,ou=scopes,o=jans\",\n  \"inum\": \"8eb2b0c0-d1d9-453d-8364-e2809ce857f2\",\n  \"displayName\": \"TestScope\",\n  \"id\": \"TestScopeID\",\n  \"iconUrl\": \"https://www.jans.io/icon.png\",\n  \"description\": \"Test Scope created by jans-cli\",\n  \"scopeType\": \"dynamic\",\n  \"defaultScope\": true,\n  \"attributes\": {\n    \"showInConfigurationEndpoint\": true\n  },\n  \"creationDate\": \"2024-06-25T08:44:08\",\n  \"umaType\": false,\n  \"baseDn\": \"inum=8eb2b0c0-d1d9-453d-8364-e2809ce857f2,ou=scopes,o=jans\"\n}\n</code></pre>","tags":["administration","configuration","scopes"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-scopes-config/#find-oauth-scopes-by-inum","title":"Find OAuth Scopes by <code>inum</code>","text":"<p>In case We know the <code>inum</code> value of an OAuth Scope, We can get the details of that scope.</p> <pre><code>Operation ID: get-oauth-scopes-by-inum\n  Description: Get Scope by Inum\n  Parameters:\n  inum: Scope identifier [string]\n  withAssociatedClients: No description is provided for this parameter [boolean]\n</code></pre> <p>We can use the <code>url-suffix</code> for the <code>inum</code> value. Sample Command<pre><code>jans cli --operation-id get-oauth-scopes-by-inum --url-suffix inum:value\n</code></pre></p> <p>For example:</p> <p>Command<pre><code>jans cli --operation-id get-oauth-scopes-by-inum \\\n--url-suffix inum:8eb2b0c0-d1d9-453d-8364-e2809ce857f2\n</code></pre> It returns the details of the scope matched with the <code>inum</code> value.</p> Sample Output<pre><code>{\n  \"dn\": \"inum=8eb2b0c0-d1d9-453d-8364-e2809ce857f2,ou=scopes,o=jans\",\n  \"inum\": \"8eb2b0c0-d1d9-453d-8364-e2809ce857f2\",\n  \"displayName\": \"TestScope\",\n  \"id\": \"TestScopeID\",\n  \"iconUrl\": \"https://www.jans.io/icon.png\",\n  \"description\": \"Test Scope created by jans-cli\",\n  \"scopeType\": \"dynamic\",\n  \"defaultScope\": true,\n  \"attributes\": {\n    \"showInConfigurationEndpoint\": true\n  },\n  \"creationDate\": \"2024-06-25T08:44:08\",\n  \"umaType\": false,\n  \"baseDn\": \"inum=8eb2b0c0-d1d9-453d-8364-e2809ce857f2,ou=scopes,o=jans\"\n}\n</code></pre>","tags":["administration","configuration","scopes"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-scopes-config/#delete-oauth-scopes-by-inum","title":"Delete OAuth Scopes by <code>inum</code>","text":"<p>You can delete any OAuth Scopes by its <code>inum</code> value.</p> Command<pre><code>jans cli --operation-id delete-oauth-scopes-by-inum \\\n--url-suffix inum:8eb2b0c0-d1d9-453d-8364-e2809ce857f2\n</code></pre> <p>Just change the <code>inum</code> value to your own according to which one you want to delete.</p>","tags":["administration","configuration","scopes"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-scopes-config/#using-text-based-ui","title":"Using Text-based UI","text":"<p>You can start TUI using the command below:</p> Command<pre><code>jans tui\n</code></pre>","tags":["administration","configuration","scopes"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-scopes-config/#scope-screen","title":"Scope Screen","text":"<p>Navigate to <code>Auth Server</code> -&gt; <code>Scopes</code> to open the scope screen as shown in the image below.</p> <ul> <li>To get the list of currently added Scope, bring the control to Search box (using the tab key), and press Enter. Type the search string to search for Scope with matching <code>id</code> and <code>inum</code>.</li> </ul> <p></p>","tags":["administration","configuration","scopes"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-scopes-config/#add-scope-screen","title":"Add Scope screen","text":"<ul> <li>Use the <code>Add Scope</code> button to create a new scope. </li> <li>You can create several types of scopes in the screen below,  such as <code>oauth</code>, <code>OpenID</code>, <code>dynamic</code>, and <code>uma</code>, with the correct data.</li> <li>For example, below is the picture availability scope data.</li> </ul>","tags":["administration","configuration","scopes"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-scopes-config/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring the OAuth Scope. Endpoint details are published in the Swagger document.</p>","tags":["administration","configuration","scopes"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-umaresources-config/","title":"UMA Resources","text":"<p>The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>UMA Resource is not possible in Text-based UI.</p> <p>The UMA Resource does not have a REST API.</p>","tags":["administration","configuration","uma"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-umaresources-config/#using-command-line","title":"Using Command Line","text":"<p>In the Janssen Server, you can deploy and customize the UMA Resources using the command line. To get the details of Janssen command line operations relevant to UMA Resource, you can check the operations under the <code>OauthUmaResources</code> task using the command below.</p> Command<pre><code>jans cli --info OauthUmaResources\n</code></pre> Sample Output<pre><code>Operation ID: get-oauth-uma-resources\n  Description: Gets list of UMA resources\n  Parameters:\n  limit: Search size - max size of the results to return [integer]\n  pattern: Search pattern [string]\n  startIndex: The 1-based index of the first query result [integer]\n  sortBy: Attribute whose value will be used to order the returned response [string]\n  sortOrder: Order in which the sortBy param is applied. Allowed values are \"ascending\" and \"descending\" [string]\n  fieldValuePair: Field and value pair for seraching [string]\nOperation ID: put-oauth-uma-resources\n  Description: Updates an UMA resource\n  Schema: UmaResource\nOperation ID: post-oauth-uma-resources\n  Description: Creates an UMA resource\n  Schema: UmaResource\nOperation ID: get-oauth-uma-resources-by-id\n  Description: Gets an UMA resource by ID\n  Parameters:\n  id: Resource description ID [string]\nOperation ID: delete-oauth-uma-resources-by-id\n  Description: Deletes an UMA resource\n  Parameters:\n  id: Resource description ID [string]\nOperation ID: patch-oauth-uma-resources-by-id\n  Description: Patch UMA resource\n  Parameters:\n  id: Resource description ID [string]\n  Schema: Array of JsonPatch\nOperation ID: get-oauth-uma-resources-by-clientid\n  Description: Fetch uma resources by client id\n  Parameters:\n  clientId: Client ID [string]\n\nTo get sample schema type jans cli --schema-sample &lt;schema&gt;, for example jans cli --schema-sample JsonPatch\n</code></pre>","tags":["administration","configuration","uma"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-umaresources-config/#get-list-of-uma-resources","title":"Get List of UMA Resources","text":"<p>To find the existing UMA Resources, let's run the following command:</p> <p><code>get-oauth-uma-resources</code> operation is used to search UMA Resources.</p> <p>To get a list of UMA resources: Command<pre><code>jans cli --operation-id get-oauth-uma-resources\n</code></pre> Sample Output<pre><code>{\n  \"start\": 0,\n  \"totalEntriesCount\": 2,\n  \"entriesCount\": 2,\n  \"entries\": [\n    {\n      \"dn\": \"jansId=361e1db0-19b4-4d83-9cb8-616dda8292b7,ou=resources,ou=uma,o=jans\",\n      \"id\": \"361e1db0-19b4-4d83-9cb8-616dda8292b7\",\n      \"name\": \"Jans Cofig Api Uma Resource /jans-config-api/api/v1/attributes\",\n      \"iconUri\": \"http://www.jans.io/img/scim_logo.png\",\n      \"scopes\": [\n        \"[\\\"inum=CACA-0B30,ou=scopes,o=jans\\\"]\"\n      ],\n      \"clients\": [\n        \"inum=1801.6e8351d4-5d3f-4773-b632-6c84bf8207cd,ou=clients,o=jans\"\n      ],\n      \"resources\": [\n        \"[\\\"https://testjans.gluu.com/jans-config-api/api/v1/attributes\\\"]\"\n      ],\n      \"creator\": \"inum=d206dd87-3a22-465d-bd25-bec9313cd42d,ou=people,o=json\",\n      \"description\": \"uma\",\n      \"deletable\": true\n    },\n    {\n      \"dn\": \"jansId=c0204b2a-4047-4c2b-86a8-a088e2ee54de,ou=resources,ou=uma,o=jans\",\n      \"id\": \"c0204b2a-4047-4c2b-86a8-a088e2ee54de\",\n      \"name\": \"Jans Cofig Api Uma Resource\",\n      \"iconUri\": \"http://www.jans.io/img/scim_logo.png\",\n      \"clients\": [\n        \"inum=1801.6e8351d4-5d3f-4773-b632-6c84bf8207cd,ou=clients,o=jans\"\n      ],\n      \"resources\": [\n        \"[\\\"https://testjans.gluu.com/jans-config-api/api/v1/config/cache/native-persistence\\\"]\"\n      ],\n      \"creator\": \"inum=d206dd87-3a22-465d-bd25-bec9313cd42d,ou=people,o=json\",\n      \"description\": \"uma resource\",\n      \"deletable\": true\n    }\n  ]\n}\n</code></pre></p> <p>To search using multiple arguments, you can change pattern that you want to find:</p> Command<pre><code>jans cli --operation-id get-oauth-uma-resources \\\n--endpoint-args limit:1,pattern:\"Jans Cofig Api Uma Resource /jans-config-api/api/v1/attributes\"\n</code></pre> <pre><code>{\n  \"start\": 0,\n  \"totalEntriesCount\": 1,\n  \"entriesCount\": 1,\n  \"entries\": [\n    {\n      \"dn\": \"jansId=361e1db0-19b4-4d83-9cb8-616dda8292b7,ou=resources,ou=uma,o=jans\",\n      \"id\": \"361e1db0-19b4-4d83-9cb8-616dda8292b7\",\n      \"name\": \"Jans Cofig Api Uma Resource /jans-config-api/api/v1/attributes\",\n      \"iconUri\": \"http://www.jans.io/img/scim_logo.png\",\n      \"scopes\": [\n        \"[\\\"inum=CACA-0B30,ou=scopes,o=jans\\\"]\"\n      ],\n      \"clients\": [\n        \"inum=1801.6e8351d4-5d3f-4773-b632-6c84bf8207cd,ou=clients,o=jans\"\n      ],\n      \"resources\": [\n        \"[\\\"https://testjans.gluu.com/jans-config-api/api/v1/attributes\\\"]\"\n      ],\n      \"creator\": \"inum=d206dd87-3a22-465d-bd25-bec9313cd42d,ou=people,o=json\",\n      \"description\": \"uma\",\n      \"deletable\": true\n    }\n  ]\n}\n</code></pre>","tags":["administration","configuration","uma"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-umaresources-config/#get-oauth-uma-resource-by-id","title":"Get Oauth UMA Resource by ID","text":"<p>With <code>get-oauth-uma-resources-by-id</code> operation-id, we can get any specific uma Resource matched with <code>ID</code>. If we know the <code>ID</code>, we can simply use the below command:</p> Command<pre><code>jans cli --operation-id get-oauth-uma-resources-by-id \\\n--url-suffix id:361e1db0-19b4-4d83-9cb8-616dda8292b7\n</code></pre> Sample Output<pre><code>{\n  \"dn\": \"jansId=361e1db0-19b4-4d83-9cb8-616dda8292b7,ou=resources,ou=uma,o=jans\",\n  \"id\": \"361e1db0-19b4-4d83-9cb8-616dda8292b7\",\n  \"name\": \"Jans Cofig Api Uma Resource /jans-config-api/api/v1/attributes\",\n  \"iconUri\": \"http://www.jans.io/img/scim_logo.png\",\n  \"scopes\": [\n    \"[\\\"inum=CACA-0B30,ou=scopes,o=jans\\\"]\"\n  ],\n  \"clients\": [\n    \"inum=1801.6e8351d4-5d3f-4773-b632-6c84bf8207cd,ou=clients,o=jans\"\n  ],\n  \"resources\": [\n    \"[\\\"https://testjans.gluu.com/jans-config-api/api/v1/attributes\\\"]\"\n  ],\n  \"creator\": \"inum=d206dd87-3a22-465d-bd25-bec9313cd42d,ou=people,o=json\",\n  \"description\": \"uma\",\n  \"deletable\": true\n}\n</code></pre>","tags":["administration","configuration","uma"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-umaresources-config/#patch-oauth-uma-resource-by-id","title":"Patch OAuth UMA Resource by ID","text":"<p>Using <code>patch-oauth-uma-resources-by-id</code> operation, we can modify <code>UMA Resource</code> partially for its properties.</p> <pre><code>Operation ID: patch-oauth-uma-resources-by-id\n  Description: Patch UMA resource\n  Parameters:\n  id: Resource description ID [string]\n  Schema: Array of JsonPatch\n</code></pre> <p>To use this operation, specify the id of the Uma that needs to be updated using the <code>--url-suffix</code> and the property and the new value using the JSON Patch . Refer here to know more about schema.</p> <p>In this example; We will change the value of the property <code>name</code> from <code>uma resource</code> to <code>UMA</code>.</p> Input<pre><code>[\n{\n  \"op\": \"replace\",\n  \"path\": \"name\",\n  \"value\": \"UMA\"\n}\n]\n</code></pre> <p>Now let's do the operation with the command line.</p> <p>Command<pre><code>jans cli --operation-id patch-oauth-uma-resources-by-id \\\n--url-suffix id:c0204b2a-4047-4c2b-86a8-a088e2ee54de --data /tmp/patch-uma.json\n</code></pre> Sample Output<pre><code>{\n  \"dn\": \"jansId=c0204b2a-4047-4c2b-86a8-a088e2ee54de,ou=resources,ou=uma,o=jans\",\n  \"id\": \"c0204b2a-4047-4c2b-86a8-a088e2ee54de\",\n  \"name\": \"UMA\",\n  \"iconUri\": \"http://www.jans.io/img/scim_logo.png\",\n  \"clients\": [\n    \"inum=1801.6e8351d4-5d3f-4773-b632-6c84bf8207cd,ou=clients,o=jans\"\n  ],\n  \"resources\": [\n    \"[\\\"https://testjans.gluu.com/jans-config-api/api/v1/config/cache/native-persistence\\\"]\"\n  ],\n  \"creator\": \"inum=d206dd87-3a22-465d-bd25-bec9313cd42d,ou=people,o=json\",\n  \"description\": \"uma resource\",\n  \"deletable\": true\n}\n</code></pre></p> <p>We see it has replaced the value of the <code>name</code> property from <code>Jans Cofig Api Uma Resource</code> to <code>UMA</code>.</p> <p>Please read about patch method, You can get some idea of how this patch method works to modify particular properties of any task.</p>","tags":["administration","configuration","uma"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-umaresources-config/#adds-new-uma-resource","title":"Adds new Uma Resource","text":"<p>To add a new Uma Resource, we can use <code>post-oauth-uma-resources</code> operation id. As shown in the output for <code>--info</code> command, the <code>post-oauth-uma-resources</code> operation requires data to be sent according to <code>UmaResource</code> schema.</p> <p>To see the schema, use the command below:</p> Command<pre><code>jans cli --schema UmaResource\n</code></pre> <p>The Janssen Server also provides an example of data that adheres to the above schema. To fetch the example, use the command below.</p> Command<pre><code>jans cli --schema-sample UmaResource\n</code></pre> <p>Using the schema and the example above, we have added below data to the file <code>/tmp/uma.json</code>.</p> <p>Input<pre><code>{\n    \"name\": \"Jans Cofig Api Uma\",\n    \"iconUri\": \"http://www.jans.io/img/scim_logo.png\",\n    \"scopes\": null,\n    \"scopeExpression\": null,\n    \"clients\": [\n      \"inum=b294adfd-b825-4e7f-9815-55d744002315,ou=clients,o=jans\"\n    ],\n    \"resources\": [\n      \"https://testjans.gluu.com/jans-config-api/api/v1/config/cache/native-persistence\"\n    ],\n    \"rev\": \"1\",\n    \"creator\": \"inum=d206dd87-3a22-465d-bd25-bec9313cd42d,ou=people,o=json\",\n    \"description\": \"uma resource\",\n    \"type\": null,\n    \"creationDate\": null,\n    \"expirationDate\": null,\n    \"deletable\": true\n}\n</code></pre> Now let's post this uma to the Janssen Server to be added to the existing set:</p> Command<pre><code>jans cli --operation-id post-oauth-uma-resources --data /tmp/uma.json\n</code></pre>","tags":["administration","configuration","uma"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-umaresources-config/#updates-an-uma-resource","title":"Updates an UMA resource","text":"<p>To update the uma resource follow the steps below.</p> <ol> <li>Get Oauth UMA Resource by ID and store it into a file for editing.    The following command will retrieve the existing Uma resource in the schema file.   Sample Command<pre><code>jans cli -no-color --operation-id get-oauth-uma-resources-by-id \\\n--url-suffix id:c70c3b5c-d543-4dec-923c-4035bdce52bb &gt; /tmp/update-uma.json\n</code></pre></li> <li>Edit and update the desired configuration values in the file while keeping other    properties and values unchanged. Updates must adhere to the <code>UmaResource</code>    schema as mentioned here.</li> <li>We have changed only the <code>true</code> to <code>false</code> for <code>deletable</code> in existing uma resource.    Use the updated file to send the update to the Janssen Server using the command below    Command<pre><code>jans cli --operation-id put-oauth-uma-resources --data /tmp/update-uma.json\n</code></pre> This will updated the existing uma resource matched with id.</li> </ol>","tags":["administration","configuration","uma"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-umaresources-config/#get-oauth-uma-resource-by-client-id","title":"Get Oauth UMA Resource by Client id","text":"<p>With <code>get-oauth-uma-resources-by-clientid</code> operation-id, we can get any specific uma Resource matched with <code>clientid</code>. If we know the <code>clientid</code>, we can simply use the below command:</p> Command<pre><code>jans cli --operation-id get-oauth-uma-resources-by-clientid \\\n--url-suffix client id:361e1db0-19b4-4d83-9cb8-616dda8292b7\n</code></pre> Sample Output<pre><code>{\n  \"dn\": \"jansId=361e1db0-19b4-4d83-9cb8-616dda8292b7,ou=resources,ou=uma,o=jans\",\n  \"id\": \"361e1db0-19b4-4d83-9cb8-616dda8292b7\",\n  \"name\": \"Jans Cofig Api Uma Resource /jans-config-api/api/v1/attributes\",\n  \"iconUri\": \"http://www.jans.io/img/scim_logo.png\",\n  \"scopes\": [\n    \"[\\\"inum=CACA-0B30,ou=scopes,o=jans\\\"]\"\n  ],\n  \"clients\": [\n    \"inum=1801.6e8351d4-5d3f-4773-b632-6c84bf8207cd,ou=clients,o=jans\"\n  ],\n  \"resources\": [\n    \"[\\\"https://testjans.gluu.com/jans-config-api/api/v1/attributes\\\"]\"\n  ],\n  \"creator\": \"inum=d206dd87-3a22-465d-bd25-bec9313cd42d,ou=people,o=json\",\n  \"description\": \"uma\",\n  \"deletable\": true\n}\n</code></pre>","tags":["administration","configuration","uma"]},{"location":"janssen-server/config-guide/auth-server-config/oauth-umaresources-config/#delete-uma-resource-by-id","title":"Delete Uma Resource by <code>id</code>","text":"<p>You can delete any Uma Resource by its <code>id</code> value.</p> Command<pre><code>jans cli --operation-id delete-oauth-uma-resources-by-id \\\n--url-suffix id:c0204b2a-4047-4c2b-86a8-a088e2ee54de\n</code></pre> <p>Just change the <code>id</code> to your own according to which one you want to delete.</p>","tags":["administration","configuration","uma"]},{"location":"janssen-server/config-guide/auth-server-config/openid-connect-client-configuration/","title":"OpenID Connect Configuration","text":"<p>The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal.  Learn how to use Jans Text-based UI (TUI)  here or jump straight to the Using Text-based UI</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here or Jump straight to the Using Configuration REST API</p>","tags":["administration","configuration","openid-connect"]},{"location":"janssen-server/config-guide/auth-server-config/openid-connect-client-configuration/#using-command-line","title":"Using Command Line","text":"<p>In the Janssen Server, you can deploy and manage the OpenID Connect Client using the command Line. To get the details of Janssen command line operations relevant to OpenID Connect Client, you can check the operations under <code>OauthOpenidConnectClients</code> task using the command below:</p> <p>Let's get the information about OpenID Connect Client Configuration: Command<pre><code>jans cli --info OauthOpenidConnectClients\n</code></pre> Sample Output<pre><code>Operation ID: get-oauth-openid-clients\n Description: Gets list of OpenID Connect clients\n Parameters:\n limit: Search size - max size of the results to return [integer]\n pattern: Search pattern [string]\n startIndex: The 1-based index of the first query result [integer]\n sortBy: Attribute whose value will be used to order the returned response [string]\n sortOrder: Order in which the sortBy param is applied. Allowed values are \"ascending\" and \"descending\" [string]\n fieldValuePair: Field and value pair for seraching [string]\nOperation ID: put-oauth-openid-client\n Description: Update OpenId Connect client\n Schema: Client\nOperation ID: post-oauth-openid-client\n Description: Create new OpenId Connect client\n Schema: Client\nOperation ID: get-oauth-openid-clients-by-inum\n Description: Get OpenId Connect Client by Inum\n Parameters:\n inum: Client identifier [string]\nOperation ID: delete-oauth-openid-client-by-inum\n Description: Delete OpenId Connect client\n Parameters:\n inum: Client identifier [string]\nOperation ID: patch-oauth-openid-client-by-inum\n Description: Patch OpenId Connect client\n Parameters:\n inum: Client identifier [string]\n Schema: Array of JsonPatch\n\nTo get sample schema type jans cli --schema-sample &lt;schema&gt;, for example jans cli --schema-sample JsonPatch\n</code></pre></p>","tags":["administration","configuration","openid-connect"]},{"location":"janssen-server/config-guide/auth-server-config/openid-connect-client-configuration/#get-list-of-openid-connect-clients","title":"Get List of OpenID Connect Clients","text":"<p>To get the list of OpenID Connect clients, run the following command:</p> Command<pre><code>jans cli --operation-id get-oauth-openid-clients\n</code></pre> Sample Output<pre><code>{\n  {\n  \"start\": 0,\n  \"totalEntriesCount\": 3,\n  \"entriesCount\": 3,\n  \"entries\": [\n {\n      \"dn\": \"inum=1800.ca57f8f8-e163-4cdc-96f2-e2760e627bfe,ou=clients,o=jans\",\n      \"deletable\": false,\n      \"clientSecret\": \"qAnnHv5Yxw6I+xHXJI6kj6f4pogINrnw7Z/sDPXSW10=\",\n      \"frontChannelLogoutUri\": \"null\",\n      \"frontChannelLogoutSessionRequired\": false,\n      \"redirectUris\": [\n        \"https://www.google.com/\"\n ],\n      \"claimRedirectUris\": [],\n      \"responseTypes\": [\n        \"code\"\n ],\n      \"grantTypes\": [\n        \"authorization_code\",\n        \"refresh_token\",\n        \"client_credentials\"\n ],\n      \"applicationType\": \"web\",\n      \"contacts\": [],\n      \"clientName\": \"Jans Config Api Client\",\n      \"clientNameLocalized\": {},\n      \"logoUriLocalized\": {},\n      \"clientUriLocalized\": {},\n      \"policyUriLocalized\": {},\n      \"tosUriLocalized\": {},\n      \"subjectType\": \"pairwise\",\n      \"idTokenSignedResponseAlg\": \"RS256\",\n      \"tokenEndpointAuthMethod\": \"client_secret_basic\",\n      \"defaultAcrValues\": [],\n      \"postLogoutRedirectUris\": [],\n      \"requestUris\": [],\n      \"scopes\": [\n        \"inum=1800.01.75,ou=scopes,o=jans\",\n        \"inum=1800.01.76,ou=scopes,o=jans\",\n        \"inum=1800.01.77,ou=scopes,o=jans\",\n        \"inum=1800.01.78,ou=scopes,o=jans\",\n        \"inum=1800.01.71,ou=scopes,o=jans\",\n        \"inum=1800.01.72,ou=scopes,o=jans\",\n ],\n      \"claims\": [],\n      \"trustedClient\": false,\n   ....\n   ....\n   ....\n\n      \"baseDn\": \"inum=1800.ca57f8f8-e163-4cdc-96f2-e2760e627bfe,ou=clients,o=jans\",\n      \"inum\": \"1800.ca57f8f8-e163-4cdc-96f2-e2760e627bfe\"\n },\n {\n      \"dn\": \"inum=478049e2-210d-4b64-bc16-10440c973f65,ou=clients,o=jans\",\n      \"deletable\": false,\n      \"clientSecret\": \"37983639-0586-4ed3-8644-b5bc41c4ce49\",\n      \"frontChannelLogoutSessionRequired\": false,\n      \"redirectUris\": [\n        \"https://www.google.com/\"\n ],\n      \"grantTypes\": [],\n      \"applicationType\": \"web\",\n      \"clientNameLocalized\": {},\n      \"logoUriLocalized\": {},\n      \"clientUriLocalized\": {},\n      \"policyUriLocalized\": {},\n      \"tosUriLocalized\": {},\n      \"subjectType\": \"public\",\n      \"tokenEndpointAuthMethod\": \"client_secret_basic\",\n      \"trustedClient\": false,\n     .....\n     .....\n     .....\n      ],\n      \"baseDn\": \"inum=478049e2-210d-4b64-bc16-10440c973f65,ou=clients,o=jans\",\n      \"inum\": \"478049e2-210d-4b64-bc16-10440c973f65\"\n },\n {\n      \"dn\": \"inum=ec53d411-5243-4c76-b91c-661b35853cd0,ou=clients,o=jans\",\n      \"deletable\": false,\n      \"clientSecret\": \"456e1c1e-796d-4dc0-9f16-7b54c9e4eb5b\",\n      \"frontChannelLogoutSessionRequired\": false,\n      \"redirectUris\": [\n        \"https://docs.jans.io/\"\n ],\n      \"grantTypes\": [],\n      \"applicationType\": \"web\",\n      \"clientNameLocalized\": {},\n      \"logoUriLocalized\": {},\n      \"clientUriLocalized\": {},\n      \"policyUriLocalized\": {},\n      \"tosUriLocalized\": {},\n      \"subjectType\": \"public\",\n      \"tokenEndpointAuthMethod\": \"client_secret_basic\",\n      \"trustedClient\": false,\n      .....\n      .....\n      .....\n\n      \"baseDn\": \"inum=ec53d411-5243-4c76-b91c-661b35853cd0,ou=clients,o=jans\",\n      \"inum\": \"ec53d411-5243-4c76-b91c-661b35853cd0\"\n }\n ]\n}\n</code></pre> <p>To search using parameters, use the command below:</p> Command<pre><code>jans cli --operation-id get-oauth-openid-clients \\\n--endpoint-args limit:2\n</code></pre>","tags":["administration","configuration","openid-connect"]},{"location":"janssen-server/config-guide/auth-server-config/openid-connect-client-configuration/#creating-a-new-openid-connect-clients","title":"Creating a New OpenID Connect Clients","text":"<p>To add an OpenID Connect client, we can use <code>post-oauth-openid-client</code> operation id. As shown in the output for <code>--info</code> command, the <code>post-oauth-openid-client</code> operation requires data to be sent according to <code>Client</code> schema.</p> <p>To see the schema, use the command below:</p> Command<pre><code>jans cli --schema Client\n</code></pre> <p>The Janssen Server also provides an example of data that adheres to the above schema. To fetch the example, use the command below.</p> Command<pre><code>jans cli --schema-sample Client\n</code></pre> <p>Using the schema and the example above, we have added OpenID Connect client data to the file <code>/tmp/openid-connect.json</code>. An OpenID Connect client may have many properties, but we are going to fill only the required properties as shown below:</p> <p>Input<pre><code>{\n  \"redirectUris\": [\n    \"https://www.google.com/\"\n ]\n}\n</code></pre> Now let's post an OpenID Connect client to the Janssen Server to be added to the existing set:</p> Command<pre><code>jans cli --operation-id post-oauth-openid-client \\\n--data /tmp/openid-connect.json\n</code></pre>","tags":["administration","configuration","openid-connect"]},{"location":"janssen-server/config-guide/auth-server-config/openid-connect-client-configuration/#update-openid-connect-client","title":"Update OpenId Connect client","text":"<p>To update the configuration follow the steps below.</p> <ol> <li>Get the existing OpenID Connect Client and store  it into a file for editing. The following command will retrieve the existing  OpenID Connect Client in the schema file. Command<pre><code>jans cli -no-color \\\n--operation-id get-oauth-openid-clients-by-inum \\\n--url-suffix inum:1800.ca57f8f8-e163-4cdc-96f2-e2760e627bfe &gt; /tmp/update-client.json\n</code></pre></li> <li>Edit and update the desired configuration values in the file while keeping  other properties and values unchanged. Updates must adhere to the <code>Client</code>  schema as mentioned here.</li> <li>We have changed in <code>parLifetime</code> only the <code>600</code> to <code>700</code>. Use the updated file  to send the update to the Janssen Server using the command below Command<pre><code>jans cli --operation-id put-oauth-openid-client \\\n--data /tmp/update-client.json\n</code></pre></li> </ol> <p>Upon successful execution of the update, the Janssen Server responds with updated configuration</p>","tags":["administration","configuration","openid-connect"]},{"location":"janssen-server/config-guide/auth-server-config/openid-connect-client-configuration/#patch-openid-connect-client-by-inum","title":"Patch OpenID Connect Client by inum","text":"<p>Using <code>patch-oauth-openid-client-by-inum</code>, we can modify OpenID Connect Clients partially for its properties.</p> <p>To use this operation, specify the <code>inum</code> of the OpenID Connect Client that needs to be updated using the <code>--url-suffix</code> and the property and the new value using the JSON Patch. Refer here to know more about schema.</p> <p>In this example: we will change the value of the property <code>applicationType</code> from <code>web</code> to <code>native</code>.</p> Input<pre><code>[\n{\n  \"op\": \"replace\",\n  \"path\": \"applicationType\",\n  \"value\": \"native\"\n}\n]\n</code></pre> <p>Now let's do the operation with the command line.</p> Command<pre><code>jans cli \\\n--operation-id patch-oauth-openid-client-by-inum \\\n--url-suffix inum:1800.ca57f8f8-e163-4cdc-96f2-e2760e627bfe --data /tmp/schema.json\n</code></pre>","tags":["administration","configuration","openid-connect"]},{"location":"janssen-server/config-guide/auth-server-config/openid-connect-client-configuration/#get-openid-connect-client-by-inum","title":"Get OpenID Connect Client by Inum","text":"<p>With <code>get-oauth-openid-clients-by-inum</code> operation-id, we can get any specific OpenID Connect Client matched with <code>Inum</code>. If we know the <code>inum</code>, we can use the below command:</p> <p><pre><code>jans cli \\\n--operation-id get-oauth-openid-clients-by-inum \\\n--url-suffix inum:1800.ca57f8f8-e163-4cdc-96f2-e2760e627bfe\n</code></pre> The result will only show details of client with <code>inum:1800.ca57f8f8-e163-4cdc-96f2-e2760e627bfe</code>.</p>","tags":["administration","configuration","openid-connect"]},{"location":"janssen-server/config-guide/auth-server-config/openid-connect-client-configuration/#delete-openid-connect-client","title":"Delete OpenID Connect client","text":"<p>Delete the OpenID Connect client using its <code>inum</code>. The command line is:</p> <p>Command<pre><code>jans cli \\\n--operation-id delete-oauth-openid-client-by-inum \\\n--url-suffix inum:a89b5c29-2a91-48b5-bf27-1bf786954a06\n</code></pre> It will delete the OpenID Connect client if it matches with the given <code>inum</code>.</p>","tags":["administration","configuration","openid-connect"]},{"location":"janssen-server/config-guide/auth-server-config/openid-connect-client-configuration/#using-text-based-ui","title":"Using Text Based UI","text":"<p>Start TUI using the command below:</p> Command<pre><code>jans tui\n</code></pre>","tags":["administration","configuration","openid-connect"]},{"location":"janssen-server/config-guide/auth-server-config/openid-connect-client-configuration/#client-screen","title":"Client Screen","text":"<p>Navigate to <code>Auth Server</code> -&gt; <code>Clients</code> to open the client screen as shown in the image below.</p> <p></p> <ul> <li>This screen shows the OpenID Connect Clients list. </li> <li>To get the list of currently added clients, bring the control to <code>Search</code> box  (using the tab key), and press the <code>Enter</code> key. Type the search string to search  for the client with the matching client name.</li> </ul>","tags":["administration","configuration","openid-connect"]},{"location":"janssen-server/config-guide/auth-server-config/openid-connect-client-configuration/#add-update-client-screen","title":"Add-Update Client screen","text":"<ul> <li>Use the <code>Add Client</code> button to create a new client.</li> <li> <p>After adding the valid data using the <code>Save</code> button, add a new OpenID Connect client.</p> </li> <li> <p>Update the OpenID Connect client as well.</p> </li> <li>To update the client, bring the control to the Specific <code>Client</code> row and press the <code>Enter</code> key, then it will show the edit client screen.\u00a0</li> </ul> <p></p> <ul> <li>If you are editing a client, you will have Active Tokens where you can search and delete tokens related to the edited client as shown image below.</li> </ul> <p></p> <p>To view client details in json format, press key v on keyboard, to delete press delete (or d) key.</p>","tags":["administration","configuration","openid-connect"]},{"location":"janssen-server/config-guide/auth-server-config/openid-connect-client-configuration/#delete-screen","title":"Delete Screen","text":"<ul> <li>To delete the client, bring the control to the Specific <code>Client</code> row and press the <code>Delete</code> key. Then it will show the Delete confirmation box.</li> </ul>","tags":["administration","configuration","openid-connect"]},{"location":"janssen-server/config-guide/auth-server-config/openid-connect-client-configuration/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring the OpenID Connect Client. Endpoint details are published in the Swagger document.</p>","tags":["administration","configuration","openid-connect"]},{"location":"janssen-server/config-guide/auth-server-config/rate-limit/","title":"Rate Limit Configuration","text":"<p>AS has built-in rate limiting support. This helps prevent abuse and ensure system stability. Rate Limit is enabled by default. It can be enabled or disabled by <code>rate_limit</code> feature flag. However it requires exact rate limit rules configuration to effectively apply rate limiting.</p> <p>Sample rate limit configuration</p> <pre><code>{\n  \"rateLimitConfiguration\": {\n    \"rateLimitRules\": [\n      {\n        \"path\": \"/jans-auth/restv1/register\",\n        \"methods\": [\n          \"POST\"\n        ],\n        \"requestCount\": 5,\n        \"periodInSeconds\": 60,\n        \"keyExtractors\": [\n          {\n            \"source\": \"body\",\n            \"parameterNames\": [\n              \"software_statement\"\n            ]\n          },\n          {\n            \"source\": \"header\",\n            \"parameterNames\": [\n              \"X-Real-IP\"\n            ]\n          }\n        ]\n      },\n      {\n        \"path\": \"/jans-auth/restv1/register\",\n        \"methods\": [\n          \"POST\"\n        ],\n        \"requestCount\": 10,\n        \"periodInSeconds\": 60,\n        \"keyExtractors\": [\n          {\n            \"source\": \"header\",\n            \"parameterNames\": [\n              \"X-Real-IP\"\n            ]\n          }\n        ]\n      }\n    ]\n  },\n  ...\n}\n</code></pre>","tags":["administration","recipes","rate limit"]},{"location":"janssen-server/config-guide/auth-server-config/rate-limit/#rate-limit-rules","title":"Rate Limit Rules","text":"<p>Rate limiting is applied based on rules which consists of : - path - path of the endpoint, e.g. <code>/jans-auth/restv1/register</code> - methods - http methods: <code>POST</code>, <code>PUT</code>, <code>GET</code>, <code>DELETE</code>, <code>PATCH</code>, <code>OPTIONS</code>, <code>HEAD</code> - requestCount - requests count - periodInSeconds - period allowed for given requests count  - keyExtractors - array of key extractors   - source - source of key, possible values: <code>body</code>, <code>header</code>, <code>query</code>   - parameterNames - name of parameters to extract</p> <p>Key is value which is dynamically constructed from request by applying key extractors. Rate limiting is made by key.</p> <p>Here is sample request ```http request POST /jans-auth/restv1/register X-ClientCert: test_cert {    \"software_statement\": \"dummy_ssa\",    \"redirect_uris\": [\"https://client.example.com/callback\", \"https://client.example.com/callback2\"] }  <pre><code>Key extractors are set as following\n\n```json\n  \"keyExtractors\": [\n        {\n          \"source\": \"body\",\n          \"parameterNames\": [\n            \"redirect_uris\"\n          ]\n        },\n        {\n          \"source\": \"body\",\n          \"parameterNames\": [\n            \"software_statement\"\n          ]\n        },\n        {\n          \"source\": \"header\",\n          \"parameterNames\": [\n            \"X-ClientCert\"\n          ]\n        }\n      ]\n</code></pre></p> <p>AS will form following key by applying key extractors on sample request above:</p> <p><code>/jans-auth/restv1/register_[dummy_ssa]_[https://client.example.com/callback, https://client.example.com/callback2]__test_cert__</code></p>","tags":["administration","recipes","rate limit"]},{"location":"janssen-server/config-guide/auth-server-config/rate-limit/#response","title":"Response","text":"<p>If rate limit is hit then error response <code>Too Many Requests</code> is returned</p> <p>Sample response <pre><code>HTTP/1.1 429 Too Many Requests\nContent-Type: application/json\n\n{\"error\": \"Too many requests\"}\n</code></pre></p>","tags":["administration","recipes","rate limit"]},{"location":"janssen-server/config-guide/auth-server-config/session-management/","title":"Session Management","text":"<p>User sessions in database can be searched, viewed and deleted using TUI, command line an rest-api</p>","tags":["administration","configuration","session management"]},{"location":"janssen-server/config-guide/auth-server-config/session-management/#use-command-line","title":"Use Command-line","text":"<p>In the Janssen Server, you can search, delete, view sessions under <code>ConfigurationLogging</code> task using the command below:</p> Command<pre><code>/opt/jans/jans-cli/config-cli.py --info=AuthSessionManagement\n</code></pre> Sample Output<pre><code>--info AuthSessionManagement\nOperation ID: get-session-by-id\n  Description: Get session by id.\n  Parameters:\n  sid: Session identifier. [string]\nOperation ID: delete-session\n  Description: Delete a session.\n  Parameters:\n  sid: Session identifier. [string]\nOperation ID: revoke-user-session\n  Description: Revoke all sessions by userDn\n  Parameters:\n  userDn: User domain name [string]\nOperation ID: get-sessions\n  Description: Return all session\nOperation ID: search-session\n  Description: Search session\n  Parameters:\n  limit: Search size - max size of the results to return [integer]\n  pattern: Search pattern [string]\n  startIndex: The 1-based index of the first query result [integer]\n  sortBy: Attribute whose value will be used to order the returned response [string]\n  sortOrder: Order in which the sortBy param is applied. Allowed values are \"ascending\" and \"descending\" [string]\n  fieldValuePair: Field and value pair for seraching [string]\n</code></pre> <p>As an example search sessions of user admin expiration date greater than October 12, 2024</p> Command<pre><code>/opt/jans/jans-cli/config-cli.py --operation-id=search-session --endpoint-args=\"fieldValuePair:auth_user=admin\\,expirationDate&gt;2024-10-12 00:00:00\"\n</code></pre> <p>To delete a session with sid=c190667e-a186-421d-8679-420e82615a38</p> Command<pre><code>/opt/jans/jans-cli/config-cli.py --operation-id=delete-session --url-suffix=\"sid:c190667e-a186-421d-8679-420e82615a38\"\n</code></pre>","tags":["administration","configuration","session management"]},{"location":"janssen-server/config-guide/auth-server-config/session-management/#use-text-based-ui","title":"Use Text-based UI","text":"<pre><code>Start TUI using the command below:\n</code></pre> Command<pre><code>jans tui\n</code></pre> <p>To start searching and deleting sessions, navigate to <code>Auth Server</code>-&gt;<code>Sessions</code>.  This brings up a screen as shown below with searching and deleting sessions.</p> <p></p> <p>After entering search criterias, navigate to &lt; Search &gt; button end press Enter. To delete a session, select it and press delete key.</p> <p>Refer to complete documentation here</p>","tags":["administration","configuration","session management"]},{"location":"janssen-server/config-guide/auth-server-config/session-management/#use-rest-api","title":"Use REST API","text":"<p>To use rest-api you need an access token. You can get access token by executing the following command if you previously authorized by TUI:</p> Command<pre><code>/opt/jans/jans-cli/config-cli.py --output-access-token\n</code></pre> <p>Sample Output<pre><code>5abf61a6-b86f-49d7-8134-77168303d0f9\n</code></pre> As an example let us search sessions of user admin expiration date greater than October 12, 2024</p> Command<pre><code>curl -k \"https://example.jans.io/jans-config-api/api/v1/jans-auth-server/session/search?fieldValuePair=auth_user%3Dadmin%2CexpirationDate%3E2024-10-12%2000%3A00%3A00\" -H \"Authorization: Bearer 5abf61a6-b86f-49d7-8134-77168303d0f9\"\n</code></pre> <p>Note! that we use percent encodings for special characters, see for details.</p> <p>The percent decoded value of the filter we used in our search was <code>fieldValuePair=auth_user=admin,expirationDate&gt;2024-10-12 00:00:00</code></p> <p>Another example is to delete session with sid=c190667e-a186-421d-8679-420e82615a38</p> Command<pre><code>curl -k -X DELETE \"https://example.jans.io/jans-config-api/api/v1/jans-auth-server/session/sid/c190667e-a186-421d-8679-420e82615a38\" -H \"Authorization: Bearer 5abf61a6-b86f-49d7-8134-77168303d0f9\"\n</code></pre> <p>Navigate to Auth - Session Management for other endpoints of managing sessions in config-api swagger file.</p>","tags":["administration","configuration","session management"]},{"location":"janssen-server/config-guide/auth-server-config/ssa-config/","title":"SSA Configuration","text":"<p>The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal.  Learn how to use Jans Text-based UI (TUI)  here or jump straight to the Using Text-based UI</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here or Jump straight to the Using Configuration REST API</p>","tags":["administration","recipes","open banking","SSA"]},{"location":"janssen-server/config-guide/auth-server-config/ssa-config/#using-command-line","title":"Using Command Line","text":"<p>In the Janssen Server, you can deploy and customize the SSA using the command line. To get the details of Janssen command line operations relevant to SSA Configuration, you can check the operations under <code>Ssa</code> task using the command below:</p> Command<pre><code>jans cli -auth --info Ssa\n</code></pre> Sample Output<pre><code>Operation ID: post-register-ssa\n  Description: # Create SSA for the organization with `expiration` (optional).\n----\n\n**Security: Bearer Auth**\n\nProvide your bearer token in the Authorization header when making requests to protected resources.\n\nExample: `Authorization: Bearer {{your-access-token}}`\n\n**Security: OAuth 2.0**\n\nScopes:\n- `https://jans.io/auth/ssa.admin` - **SSA Admin**, You can create `SSA`.\n  Parameters:\n    org_id*: The `org_id` is used for organization identification.\n    description: Description SSA.\n    expiration: Expiration date. If this field is not sent, it will take days to expire, according to how it has been configured.\n    software_id*: The `software_id` is used for software identification.\n    software_roles*: List of string values, fixed value [\"password\", \"notify\"].\n    grant_types*: Fixed value [\"client_credentials\"].\n    one_time_use*: Defined whether the SSA will be used only once or can be used multiple times.\n    rotate_ssa*: TODO - Will be used to rotate expiration of the SSA, currently is only saved as part of the SSA.\n    lifetime: SSA lifetime in seconds.\nOperation ID: get-ssa\n  Description: # Get all SSA list based on `jti` or `org_id`.\n----\n\n**Security: Bearer Auth**\n\nProvide your bearer token in the Authorization header when making requests to protected resources.\n\nExample: `Authorization: Bearer {{your-access-token}}`\n\n**Security: OAuth 2.0**\n\nScopes:\n- `https://jans.io/auth/ssa.admin` - **SSA Adm\n.in**, Retrieves all `SSA`\n- `https://jans.io/auth/ssa.portal` - **SSA Portal**, Retrieves all `SSA`\n- `https://jans.io/auth/ssa.developer` - **SSA Developer**, Retrieves the `SSA` created by the same client\n  Parameters:\n  jti: Unique Identifier [string]\n  org_id: Organization ID [string]\nOperation ID: delete-ssa\n  Description: # Revokes existing active SSA based on `jti` or `org_id`\n----\n\n- `jti` - for delete only one SSA, the specified by `jti` \n- `org_id` - for delete all SSA of the specified organization.\n\n**Security: Bearer Auth**\n\nProvide your bearer token in the Authorization header when making requests to protected resources.\n\nExample: `Authorization: Bearer {{your-access-token}}`\n\n**Security: OAuth 2.0**\n\nScopes:\n- `https://jans.io/auth/ssa.admin` - **SSA Admin**, You can revoke `SSA`.\n  Parameters:\n  jti: A unique identifier for the token, which can be used to prevent reuse of the token. [string]\n  org_id: Delete all SSAs of the specified organization. [string]\nOperation ID: validate-ssa\n  Description: # Validates that a given SSA `jti` exists and is valid\n----\n\nThis endpoint does not have any security, it is an open endpoint.\n  Parameters:\n  jti: Unique Identifier [string]\nOperation ID: get-jwt-ssa\n  Description: # Get JWT of SSA based on `jti`.\n----\n\n**Security: Bearer Auth**\n\nProvide your bearer token in the Authorization header when making requests to protected resources.\n\nExample: `Authorization: Bearer {{your-access-token}}`\n\n**Security: OAuth 2.0**\n\nScopes:\n- `https://jans.io/auth/ssa.admin` - **SSA Admin**, Retrieve `JWT` of `SSA`\n  Parameters:\n  jti: Unique Identifier. [string]\n</code></pre>","tags":["administration","recipes","open banking","SSA"]},{"location":"janssen-server/config-guide/auth-server-config/ssa-config/#get-all-ssa","title":"Get all SSA","text":"<p>Use the <code>get-ssa</code> operation to retrieve the list of SSA configuration, run the following command line:</p> Command<pre><code>jans cli -auth --operation-id get-ssa\n</code></pre> Sample Output<pre><code>[\n  {\n    \"ssa\": {\n      \"software_id\": \"SW123456\",\n      \"one_time_use\": false,\n      \"grant_types\": [\n        \"authorization_code\"\n      ],\n      \"org_id\": \"jans\",\n      \"iss\": \"https://ossdhaval-hardy-tortoise.gluu.info\",\n      \"description\": \"admin all access\",\n      \"software_roles\": [\n        \"admin\"\n      ],\n      \"exp\": 3315119711,\n      \"iat\": 1738319712,\n      \"jti\": \"92fd9751-bdd5-474e-be9c-ba38a582b54b\",\n      \"rotate_ssa\": false\n    },\n    \"iss\": \"2000.cad384cc-2459-4e15-a205-2cb5fa69de35\",\n    \"created_at\": 1738319712,\n    \"expiration\": 3315119711,\n    \"status\": \"ACTIVE\"\n  },\n  {\n    \"ssa\": {\n      \"software_id\": \"SW987654\",\n      \"one_time_use\": false,\n      \"grant_types\": [\n        \"authorization_code\",\n        \"refresh_token\"\n      ],\n      \"org_id\": \"gluu\",\n      \"iss\": \"https://ossdhaval-hardy-tortoise.gluu.info\",\n      \"description\": \"gluu admin\",\n      \"software_roles\": [\n        \"admin\"\n      ],\n      \"exp\": 3315120318,\n      \"iat\": 1738320318,\n      \"jti\": \"e94aae83-5a88-410c-a988-277919bdcdaf\",\n      \"rotate_ssa\": false\n    },\n    \"iss\": \"2000.cad384cc-2459-4e15-a205-2cb5fa69de35\",\n    \"created_at\": 1738320318,\n    \"expiration\": 3315120318,\n    \"status\": \"ACTIVE\"\n  }\n]\n</code></pre>","tags":["administration","recipes","open banking","SSA"]},{"location":"janssen-server/config-guide/auth-server-config/ssa-config/#create-ssa","title":"Create SSA","text":"<p>To create a new <code>SSA</code>, we can use <code>post-register-ssa</code> operation id. As shown in the output for <code>--info</code> command, the <code>post-register-ssa</code> operation requires data to create new SSA.</p> <p>we have added below key data to the file <code>/tmp/ssa.json</code>.</p> Input<pre><code>  {\n        \"software_id\": \"SS652413\",\n        \"grant_types\": [\n          \"authorization_code\"\n        ],\n        \"org_id\": \"janssen\",\n        \"description\": \"admin all access\",\n        \"software_roles\": [\n          \"admin\"\n        ]\n  }\n</code></pre> <p>Now let's post this <code>SSA</code> to the Janssen Server to be added to the existing set:</p> Command<pre><code> jans cli -auth --operation-id post-register-ssa --data /tmp/ssa.json\n</code></pre>","tags":["administration","recipes","open banking","SSA"]},{"location":"janssen-server/config-guide/auth-server-config/ssa-config/#get-jwt-of-ssa-based-on-jti","title":"Get JWT of SSA based on <code>jti</code>","text":"<p>Provide to bearer token in the Authorization header when making requests to protected resources.</p> Command<pre><code>jans cli -auth --operation-id get-jwt-ssa \\\n--url-suffix=\"jti:e94aae83-5a88-410c-a988-277919bdcdaf\"\n</code></pre> Sample Output<pre><code>{\n  \"ssa\": \"eyJraWQiOiJjb25uZWN0X2RkM2MzNDYwLTc3YjUtNDMyOS1iN2M0LTY4YTU5MDc5YTNmZF9zaWdfcnMyNTYiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzb2Z0d2FyZV9pZCI6IlNXOTg3NjU0IiwiZ3JhbnRfdHlwZXMiOlsiYXV0aG9yaXphdGlvbl9jb2RlIiwicmVmcmVzaF90b2tlbiJdLCJvcmdfaWQiOiJnbHV1IiwiaXNzIjoiaHR0cHM6Ly9vc3NkaGF2YWwtaGFyZHktdG9ydG9pc2UuZ2x1dS5pbmZvIiwic29mdHdhcmVfcm9sZXMiOlsiYWRtaW4iXSwiZXhwIjozMzE1MTIwMzE4LCJpYXQiOjE3MzgzMjAzMTgsImp0aSI6ImU5NGFhZTgzLTVhODgtNDEwYy1hOTg4LTI3NzkxOWJkY2RhZiJ9.DIDdlnlMHUxlNIMWtauu4Eg5SdyPZG5DthYXCFoRFkXpy8m9lGONPd0IMY18Tp0TKTHy4j2hPCzesEYGXAGPihqCP-ZYz0Jdv0mGd6I3yw_Z4iyNgF9GRVYHWp98wUA1WGqj-Y0oyolhPZmpDtwD2pCFCBWe4taAHmsr5UGBnIUVCSVexpGzX44GDny7TD3_05It8AfcHzQ4NrrCfz0DsYxfkgs7hpcgb4FJuuGczOm2J-vFvb62ReXP7pfWqwZ0oeM-Dik_ScHUEBhKj5jrZyKhUc-ow66zlCmNGkGXDUfTDFgiJ1K1DywqYZzPWc5XD0VnBstKlh230YaURYqq1A\"\n}\n</code></pre>","tags":["administration","recipes","open banking","SSA"]},{"location":"janssen-server/config-guide/auth-server-config/ssa-config/#delete-ssa","title":"Delete SSA","text":"<p>We can delete the specific <code>SSA</code> through its <code>jti</code> using <code>delete-ssa</code> operation. For example, We can put <code>jti:e94aae83-5a88-410c-a988-277919bdcdaf</code> with <code>--url-suffix</code> to delete the session. The following command as below:</p> <pre><code>jans cli -auth --operation-id delete-ssa \\\n--url-suffix=\"jti:e94aae83-5a88-410c-a988-277919bdcdaf\"\n</code></pre> <p>To delete all SSA of the specified organization through its <code>org_id</code>. The following command as below:</p> <pre><code>jans cli -auth --operation-id delete-ssa --url-suffix=\"org_id:gluu\"\n</code></pre>","tags":["administration","recipes","open banking","SSA"]},{"location":"janssen-server/config-guide/auth-server-config/ssa-config/#using-text-based-ui","title":"Using Text-based UI","text":"<p>Start TUI using the command below:</p> Command<pre><code>jans tui\n</code></pre>","tags":["administration","recipes","open banking","SSA"]},{"location":"janssen-server/config-guide/auth-server-config/ssa-config/#ssa-screen","title":"SSA Screen","text":"<p>Navigate to <code>Auth Server</code> -&gt; <code>SSA</code> to open the SSA screen as shown in the image below.</p> <p></p> <p>To get the list of currently added SSA, bring the control to <code>Search</code> box (using the tab key), and press <code>Enter</code>. Type the search string to search for SSA with matching names.</p> <p>Add a new SSA using the <code>Add SSA</code> button. It will open a dialogue where you can add an SSA detail and save it. as shown in the image below.</p> <p></p> <p>Please see description of fields at SSA field descriptions</p> <p>If you are going to create similar SSA, you can save as template by enabling checkbox Save as Template and write a template name.</p> <p>Once you hit &lt;   Save   &gt; button, you will have a dialog which displays created SSA as jwt. Please save it by using button &lt;  Export  &gt;.</p> <p></p> <p>If you saved as template, you can re-use it by hitting button &lt; Templates &gt; which opens a dialog that lists saved SSA templates.</p> <p>To get the detail of any SSA, bring the control on that SSA (using the up-down arrows), and press Enter, you will have the following dialog, so that you can display SSA token, revoke (delete) and also edit details and recreate.</p> <p></p>","tags":["administration","recipes","open banking","SSA"]},{"location":"janssen-server/config-guide/auth-server-config/ssa-config/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring SSA. Endpoint details are published in the Swagger document.</p>","tags":["administration","recipes","open banking","SSA"]},{"location":"janssen-server/config-guide/config-api-config/janssen-config-api-configuration/","title":"Janssen Config-API Configuration","text":"<p>The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal.  Learn how to use Jans Text-based UI (TUI)  here or jump straight to the Using Text-based UI</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here or Jump straight to the Using Configuration REST API</p>","tags":["administration","configuration","config-api"]},{"location":"janssen-server/config-guide/config-api-config/janssen-config-api-configuration/#using-command-line","title":"Using Command Line","text":"<p>In the Janssen Server, you can deploy and customize the Config-API Configuration using the command line. To get the details of Janssen command line operations relevant to Aonfig-API Configuration, you can check the operations under <code>ConfigurationConfigApi</code> task using the command below:</p> Command<pre><code>/opt/jans/jans-cli/config-cli.py --info ConfigurationConfigApi\n</code></pre> <p>It will show the details of the available operation-ids for Config-API.</p> Sample Output<pre><code>/opt/jans/jans-cli/config-cli.py --info ConfigurationConfigApi\nOperation ID: get-config-api-properties\n  Description: Gets config-api configuration properties.\nOperation ID: patch-config-api-properties\n  Description: Partially modifies config-api Configuration properties.\n  Schema: Array of JsonPatch\n\nTo get sample schema type /opt/jans/jans-cli/config-cli.py --schema-sample &lt;schema&gt;, for example /opt/jans/jans-cli/config-cli.py --schema-sample JsonPatch\n</code></pre>","tags":["administration","configuration","config-api"]},{"location":"janssen-server/config-guide/config-api-config/janssen-config-api-configuration/#get-the-current-config-api-configuration","title":"Get The Current Config-API Configuration","text":"<p>To get the properties of Janssen Config-API Configuration, run the command below:</p> Command<pre><code>/opt/jans/jans-cli/config-cli.py --operation-id=get-config-api-properties\n</code></pre> <p>It will return the result as below:</p> Sample Output<pre><code>{\n  \"serviceName\": \"jans-config-api\",\n  \"configOauthEnabled\": true,\n  \"disableLoggerTimer\": false,\n  \"disableAuditLogger\": false,\n  \"customAttributeValidationEnabled\": true,\n  \"acrValidationEnabled\": true,\n  \"apiApprovedIssuer\": [\n    \"https://example.jans.io\"\n  ],\n  \"apiProtectionType\": \"oauth2\",\n  \"apiClientId\": \"1800.b62cb614-a09d-4163-a6bc-32e38a51c4d2\",\n  \"apiClientPassword\": \"CN8ggRUhMkw9K0ocQ+LXbA==\",\n  \"endpointInjectionEnabled\": false,\n  \"authIssuerUrl\": \"https://example.jans.io\",\n  \"authOpenidConfigurationUrl\": \"https://example.jans.io/.well-known/openid-configuration\",\n  \"authOpenidIntrospectionUrl\": \"https://example.jans.io/jans-auth/restv1/introspection\",\n  \"authOpenidTokenUrl\": \"https://example.jans.io/jans-auth/restv1/token\",\n  \"authOpenidRevokeUrl\": \"https://example.jans.io/jans-auth/restv1/revoke\",\n  \"exclusiveAuthScopes\": [\n    \"jans_stat\",\n    \"https://jans.io/scim/users.read\",\n    \"https://jans.io/scim/users.write\"\n  ],\n  \"corsConfigurationFilters\": [\n    {\n      \"filterName\": \"CorsFilter\",\n      \"corsEnabled\": true,\n      \"corsAllowedOrigins\": \"*\",\n      \"corsAllowedMethods\": \"GET,PUT,POST,DELETE,PATCH,HEAD,OPTIONS\",\n      \"corsSupportCredentials\": true,\n      \"corsLoggingEnabled\": false,\n      \"corsPreflightMaxAge\": 1800,\n      \"corsRequestDecorate\": true\n    }\n  ],\n  \"loggingLevel\": \"INFO\",\n  \"loggingLayout\": \"text\",\n  \"disableJdkLogger\": true,\n  \"maxCount\": 200,\n  \"acrExclusionList\": [\n    \"simple_password_auth\"\n  ],\n  \"userExclusionAttributes\": [\n    \"userPassword\"\n  ],\n  \"userMandatoryAttributes\": [\n    \"mail\",\n    \"displayName\",\n    \"status\",\n    \"userPassword\",\n    \"givenName\"\n  ],\n  \"agamaConfiguration\": {\n    \"mandatoryAttributes\": [\n      \"qname\",\n      \"source\"\n    ],\n    \"optionalAttributes\": [\n      \"serialVersionUID\",\n      \"enabled\"\n    ]\n  },\n  \"auditLogConf\": {\n    \"enabled\": true,\n    \"headerAttributes\": [\n      \"User-inum\"\n    ]\n  },\n  \"dataFormatConversionConf\": {\n    \"enabled\": true,\n    \"ignoreHttpMethod\": [\n      \"@jakarta.ws.rs.GET()\"\n    ]\n  },\n  \"plugins\": [\n    {\n      \"name\": \"admin\",\n      \"description\": \"admin-ui plugin\",\n      \"className\": \"io.jans.ca.plugin.adminui.rest.ApiApplication\"\n    },\n    {\n      \"name\": \"fido2\",\n      \"description\": \"fido2 plugin\",\n      \"className\": \"io.jans.configapi.plugin.fido2.rest.ApiApplication\"\n    },\n    {\n      \"name\": \"scim\",\n      \"description\": \"scim plugin\",\n      \"className\": \"io.jans.configapi.plugin.scim.rest.ApiApplication\"\n    },\n    {\n      \"name\": \"user-management\",\n      \"description\": \"user-management plugin\",\n      \"className\": \"io.jans.configapi.plugin.mgt.rest.ApiApplication\"\n    },\n    {\n      \"name\": \"jans-link\",\n      \"description\": \"jans-link plugin\",\n      \"className\": \"io.jans.configapi.plugin.link.rest.ApiApplication\"\n    },\n    {\n      \"name\": \"saml\",\n      \"description\": \"saml plugin\",\n      \"className\": \"io.jans.configapi.plugin.saml.rest.ApiApplication\"\n    },\n    {\n      \"name\": \"kc-link\",\n      \"description\": \"kc-link plugin\",\n      \"className\": \"io.jans.configapi.plugin.kc.link.rest.ApiApplication\"\n    },\n    {\n      \"name\": \"lock\",\n      \"description\": \"lock plugin\",\n      \"className\": \"io.jans.configapi.plugin.lock.rest.ApiApplication\"\n    }\n  ],\n  \"assetMgtConfiguration\": {\n    \"assetMgtEnabled\": true,\n    \"assetServerUploadEnabled\": true,\n    \"fileExtensionValidationEnabled\": true,\n    \"moduleNameValidationEnabled\": true,\n    \"assetBaseDirectory\": \"/opt/jans/jetty/%s/custom\",\n    \"jansServiceModule\": [\n      \"jans-auth\",\n      \"jans-config-api\",\n      \"jans-fido2\",\n      \"jans-scim\"\n    ],\n    \"assetDirMapping\": [\n      {\n        \"directory\": \"i18n\",\n        \"type\": [\n          \"properties\"\n        ],\n        \"description\": \"Resource bundle file.\"\n      },\n      {\n        \"directory\": \"libs\",\n        \"type\": [\n          \"jar\"\n        ],\n        \"description\": \"java archive library.\"\n      },\n      {\n        \"directory\": \"pages\",\n        \"type\": [\n          \"xhtml\"\n        ],\n        \"description\": \"Web pages.\"\n      },\n      {\n        \"directory\": \"static\",\n        \"type\": [\n          \"js\",\n          \"css\",\n          \"png\",\n          \"gif\",\n          \"jpg\",\n          \"jpeg\"\n        ],\n        \"description\": \"Static resources like Java-script, style-sheet and images.\"\n      }\n    ]\n  }\n}\n</code></pre>","tags":["administration","configuration","config-api"]},{"location":"janssen-server/config-guide/config-api-config/janssen-config-api-configuration/#update-config-api-configuration-properties","title":"Update Config-API Configuration Properties","text":"<p>To update the configuration follow the steps below.</p> <ol> <li>Get the current configuration and store it into a file for getting property to configure</li> <li>Copy the property you want to modify, for example, let say we want to add attribute * to *userMandatoryAttributes,  so prepare a json patch file in such a way that get current values, add the desired attribute as follows in file <code>config-api-patch.json</code>:  Sample Output<pre><code>[\n {\n   \"op\": \"replace\",\n   \"path\": \"/userMandatoryAttributes\",\n   \"value\": [\n     \"mail\",\n     \"displayName\",\n     \"status\",\n     \"userPassword\",\n     \"givenName\",\n     \"gender\"\n   ]\n }\n]\n</code></pre>  See  RFC 6902 for details.</li> <li>Execute the following command to apply this patch:  Command<pre><code> /opt/jans/jans-cli/config-cli.py --operation-id=patch-config-api-properties --data ./config-api-patch.json\n</code></pre>  Upon successful execution of the update, the Janssen Server responds with updated configuration.</li> </ol> <p>As another example, let us disable file extension validation in asset management, so our <code>config-api--assetmgt-patch.json</code> will be as follows:</p> Sample Output<pre><code>[\n  {\n    \"op\": \"replace\",\n    \"path\": \"/assetMgtConfiguration/fileExtensionValidationEnabled\",\n    \"value\": false\n  }\n]\n</code></pre>","tags":["administration","configuration","config-api"]},{"location":"janssen-server/config-guide/config-api-config/janssen-config-api-configuration/#using-text-based-ui","title":"Using Text-based UI","text":"<p>In the Janssen Server, you can manage Config-API Configuration using the Text-Based UI also.</p> <p>You can start TUI using the command below:</p> Command<pre><code>sudo /opt/jans/jans-cli/jans_cli_tui.py\n</code></pre> <p>Navigate to <code>Config API</code> section where administrators can update Config-API configurations in six sub-tabs, namely Main, Agama, Plugins, Asset Management, Audit Log Conf, Data Format Conversion, and Auidit Logs</p> <p></p>","tags":["administration","configuration","config-api"]},{"location":"janssen-server/config-guide/config-api-config/janssen-config-api-configuration/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring the Config-API Configuration. Endpoint details are published in the Swagger document, see endpoint <code>/api/v1/api-config</code>.</p>","tags":["administration","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/","title":"Most useful configurations and operations on Jans server using CURL","text":"","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#configuring-the-janssen-server","title":"Configuring the Janssen server","text":"<p>To use CURL commands and configure Janssen's Authorization server, you need to have an access token of \"Config-API\" (which is an RP of Jans-auth server). Configurations to the AS can be done only through \"The Config-API client (RP)\".</p>","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#obtaining-an-access-token","title":"Obtaining an Access token","text":"<p>All commands to configure the AS are protected by an Access token. According to the use case, you must specify the <code>scope</code> for which the access token has been requested. For the client_id and client_secret, contact your administrator.</p> <p>Template</p> <pre><code>curl -u \"client_inum:client_secret\" https://&lt;your.jans.server&gt;/jans-auth/restv1/token \\\n    -d  \"grant_type=client_credentials&amp;scope=put_scope_name_here\"\n</code></pre> <p>Example:</p> <p>To modify a custom script, you need to request an access token using the scope <code>scope=https://jans.io/oauth/config/scripts.write</code></p> <pre><code>curl -u \"put_client_id_here:put_config_api_client_secret_here\" https://&lt;your.jans.server&gt;/jans-auth/restv1/token \\\n     -d  \"grant_type=client_credentials&amp;scope=https://jans.io/oauth/config/scripts.write\" \n</code></pre>","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#enable-an-authentication-script","title":"Enable an authentication script","text":"","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#steps","title":"Steps","text":"<ol> <li>Obtain a token, use scope <code>https://jans.io/oauth/config/scripts.write</code> <pre><code>curl -u \"put_client_id_here:put_config_api_client_secret_here\" https://&lt;your.jans.server&gt;/jans-auth/restv1/token \\\n     -d  \"grant_type=client_credentials&amp;scope=https://jans.io/oauth/config/scripts.write\" \n</code></pre></li> <li>Enable the script <pre><code>curl https://&lt;your.jans.server&gt;/jans-config-api/api/v1/config/scripts/name/name_of_the_script \\ \n    -H \"Authorization: Bearer put_access_token_here\"\n</code></pre></li> </ol> <p>Examples of <code>name_of_the_script</code> ( Authentication methods that are present in the Janssen server.)</p> Name of the script smpp otp duo fido2 super_gluu twilio_sms smpp otp duo fido2 super_gluu","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#client-creation","title":"Client creation","text":"<ol> <li> <p>Creating a client with minimal upfront configuration requires only <code>redirectUris</code> in following format. Add following content in a text file and save it as client.json.  <pre><code>{\n  \"redirectUris\": [\n  \"http://localhost:8080\"\n  ]  \n}\n</code></pre> In place of <code>http://localhost:8080</code> uri used above, any valid redirect URI can be used. To provide full client configuration at the time of creation, download and use this json format, update the values and save it as client.json. Few important fields to populate are <code>scope</code>,<code>responseTypes</code>, <code>redirectUris</code> (The only mandatory field), <code>grantTypes</code>. If there is a need to update the attributes of the client after creation, then make sure that the client is created with <code>grantTypes</code> list having <code>client_credentials</code> grant type as well.</p> </li> <li> <p>Run curl command <pre><code>curl -X POST https://my.jans.server/jans-auth/restv1/register \\ \n     -H \"Content-Type: application/json\"  -d @/some/directory/client.json\n</code></pre></p> </li> </ol> <p>If client is created successfully, response similar to below will be received:</p> <p><pre><code>{\n    \"allow_spontaneous_scopes\": false,\n    \"application_type\": \"web\",\n    \"rpt_as_jwt\": false,\n    \"registration_client_uri\": \"https://my.jans.server/jans-auth/restv1/register?client_id=994ec0a7-1143-456c-85ca-66ba592d7f9a\",\n    \"tls_client_auth_subject_dn\": \"\",\n    \"run_introspection_script_before_jwt_creation\": false,\n    \"registration_access_token\": \"d34f30ff-ae31-4760-8b67-ef071ba9ee68\",\n    \"client_id\": \"994ec0a7-1143-456c-85ca-66ba592d7f9a\",\n    \"token_endpoint_auth_method\": \"client_secret_basic\",\n    \"scope\": \"openid profile permission https://jans.io/auth/ssa.portal uma_protection work_phone phone address test https://jans.io/auth/ssa.admin user_name email clientinfo device_sso org_name https://jans.io/auth/ssa.developer offline_access\",\n    \"client_secret\": \"da4c17de-b6bc-4f25-b642-4c7b887c7860\",\n    \"client_id_issued_at\": 1672221633,\n    \"backchannel_logout_uri\": \"\",\n    \"backchannel_logout_session_required\": false,\n    \"par_lifetime\": 600,\n    \"spontaneous_scopes\": [],\n    \"id_token_signed_response_alg\": \"RS256\",\n    \"access_token_as_jwt\": false,\n    \"grant_types\": [\n        \"authorization_code\",\n        \"refresh_token\"\n    ],\n    \"subject_type\": \"pairwise\",\n    \"keep_client_authorization_after_expiration\": false,\n    \"require_par\": false,\n    \"redirect_uris_regex\": \"\",\n    \"additional_audience\": [],\n    \"frontchannel_logout_session_required\": false,\n    \"client_secret_expires_at\": 1672308033,\n    \"access_token_signing_alg\": \"RS256\",\n    \"response_types\": [\"code\"]\n}\n</code></pre> Response contains <code>client_id</code> and <code>client_secret</code> apart from other client configuration details.</p>","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#get-client-details","title":"Get Client Details","text":"<ol> <li>Obtain an Access Token with scope <code>https://jans.io/oauth/config/openid/clients.readonly</code>. <pre><code> curl -u \"put_client_id_here:put_config_api_client_secret_here\" https://&lt;your.jans.server&gt;/jans-auth/restv1/token \\ \n      -d  \"grant_type=client_credentials&amp;scope=https://jans.io/oauth/config/openid/clients.readonly\" \n</code></pre></li> <li>Obtain client information using: <pre><code>curl -X GET https://my.jans.server/jans-config-api/api/v1/openid/clients/client-s_inum_for_which_scope_to_be_added \n   -H \"Authorization: Bearer put_access_token_here\"\n</code></pre></li> <li>This will return JSON response similar to the one below.  <pre><code>{\n   \"dn\":\"inum=994ec0a7-1143-456c-85ca-66ba592d7f9a,ou=clients,o=jans\",\n   \"expirationDate\":\"2022-12-29T10:00:33\",\n   \"deletable\":true,\n   \"clientSecret\":\"5Mlvuh0JRwl/WcpiUNGGXjtDO4+SprNBjiVFFcWqWB4gu7gYxqcSMw==\",\n   \"frontChannelLogoutSessionRequired\":false,\n   \"redirectUris\":[\n      \"http://localhost:8080\"\n   ],\n   \"responseTypes\":[\n      \"code\"\n   ],\n   \"grantTypes\":[\n      \"authorization_code\",\n      \"refresh_token\",\n      \"client_credentials\"\n   ],\n   \"applicationType\":\"web\",\n   \"clientName\":\"dd-test-client\",\n   \"clientNameLocalized\":{\n\n   },\n   \"logoUriLocalized\":{\n\n   },\n   \"clientUriLocalized\":{\n\n   },\n   \"policyUriLocalized\":{\n\n   },\n   \"tosUriLocalized\":{\n\n   },\n   \"subjectType\":\"pairwise\",\n   \"idTokenSignedResponseAlg\":\"RS256\",\n   \"tokenEndpointAuthMethod\":\"client_secret_basic\",\n   \"scopes\":[\n      \"inum=F0C4,ou=scopes,o=jans\",\n      \"inum=43F1,ou=scopes,o=jans\",\n      \"inum=C4F5,ou=scopes,o=jans\",\n      \"inum=SSA1-PTL1,ou=scopes,o=jans\",\n      \"inum=6D99,ou=scopes,o=jans\",\n      \"inum=7D02,ou=scopes,o=jans\",\n      \"inum=D491,ou=scopes,o=jans\",\n      \"inum=C17A,ou=scopes,o=jans\",\n      \"inum=0465-1DEA,ou=scopes,o=jans\",\n      \"inum=SSA1-AD01,ou=scopes,o=jans\",\n      \"inum=10B2,ou=scopes,o=jans\",\n      \"inum=764C,ou=scopes,o=jans\",\n      \"inum=341A,ou=scopes,o=jans\",\n      \"inum=C4F8,ou=scopes,o=jans\",\n      \"inum=7D01,ou=scopes,o=jans\",\n      \"inum=SSA1-DEV1,ou=scopes,o=jans\",\n      \"inum=C4F6,ou=scopes,o=jans\"\n   ],\n   \"trustedClient\":false,\n   \"persistClientAuthorizations\":true,\n   \"includeClaimsInIdToken\":false,\n   \"customAttributes\":[\n\n   ],\n   \"customObjectClasses\":[\n      \"top\"\n   ],\n   \"rptAsJwt\":false,\n   \"accessTokenAsJwt\":false,\n   \"accessTokenSigningAlg\":\"RS256\",\n   \"disabled\":false,\n   \"attributes\":{\n      \"runIntrospectionScriptBeforeJwtCreation\":false,\n      \"keepClientAuthorizationAfterExpiration\":false,\n      \"allowSpontaneousScopes\":false,\n      \"backchannelLogoutSessionRequired\":false,\n      \"parLifetime\":600,\n      \"requirePar\":false,\n      \"jansDefaultPromptLogin\":false,\n      \"minimumAcrLevel\":-1\n   },\n   \"backchannelTokenDeliveryMode\":\"poll\",\n   \"backchannelUserCodeParameter\":false,\n   \"displayName\":\"dd-test-client\",\n   \"authenticationMethod\":\"client_secret_basic\",\n   \"baseDn\":\"inum=994ec0a7-1143-456c-85ca-66ba592d7f9a,ou=clients,o=jans\",\n   \"inum\":\"994ec0a7-1143-456c-85ca-66ba592d7f9a\"\n}\n</code></pre></li> </ol>","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#add-new-scope-to-client","title":"Add New Scope to Client","text":"<p>To the above client, let's append the profile, so the scope attrib should now have value \"openid user_name profile\"`. This new value will be patched onto the client.</p> <ol> <li>Obtain an Access Token with scope <code>https://jans.io/oauth/config/openid/clients.write</code> <pre><code>curl -u \"put_client_id_here:put_config_api_client_secret_here\" https://&lt;your.jans.server&gt;/jans-auth/restv1/token \\\n         -d  \"grant_type=client_credentials&amp;scope=https://jans.io/oauth/config/openid/clients.write\" \n</code></pre></li> <li>Patch the new scope for the client  <pre><code>curl -X PATCH -k -H 'Content-Type: application/json-patch+json' \\ \n         -i 'https://my.jans.server/jans-config-api/api/v1/openid/clients/put_client_inum_here' \\ \n         -H \"Authorization: Bearer put_access_token_here\" --data '[\n     {\n    \"op\": \"add\",\n    \"path\": \"/scope\",\n    \"value\": \"openid user_name profile\"\n     }\n     ]'\n</code></pre></li> </ol>","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#add-openid-scope-and-map-to-database-attribute","title":"Add OpenID scope and map to database attribute","text":"<ol> <li>Obtain access token <pre><code>curl -k -u \"put_client_id:put_client_secret\" https://jans-ui.jans.io/jans-auth/restv1/token \\\n     -d  \"grant_type=client_credentials&amp;scope=https://jans.io/oauth/config/scopes.write\" \n</code></pre></li> <li>Build json on similar lines <pre><code>{\n  \"dn\": \"string\",\n  \"inum\": \"string\",\n  \"displayName\": \"string\",\n  \"id\": \"string\",\n  \"iconUrl\": \"string\",\n  \"description\": \"string\",\n  \"scopeType\": \"openid\",\n  \"claims\": [\n    \"string\"\n  ],\n  \"defaultScope\": true,\n  \"groupClaims\": true,\n  \"dynamicScopeScripts\": [\n    \"string\"\n  ],\n  \"umaAuthorizationPolicies\": [\n    \"string\"\n  ],\n  \"attributes\": {\n    \"spontaneousClientId\": \"string\",\n    \"spontaneousClientScopes\": [\n      \"string\"\n    ],\n    \"showInConfigurationEndpoint\": true\n  },\n  \"umaType\": false,\n  \"deletable\": false,\n  \"expirationDate\": \"2022-07-26\"\n}\n</code></pre></li> <li>Run curl. Note the <code>claims</code> field which maps to the database attrib <pre><code>curl -k -X POST https://jans-ui.jans.io/jans-config-api/api/v1/scopes -H \"Content-Type: application/json\" \n     -H \"Authorization: Bearer use_bearer_token_here\"  --data '{\n  \"dn\": \"inum=AAC1,ou=scopes,o=jans\",\n  \"inum\": \"AAC1\",\n  \"displayName\": \"website\",\n  \"id\": \"website\",\n    \"description\": \"website\",\n  \"scopeType\": \"openid\",\n  \"claims\": [\"website\"],\n  \"umaType\": false,\n  \"deletable\": false\n}'\n</code></pre></li> </ol>","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#using-the-janssen-server","title":"Using the Janssen server","text":"","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#accessing-openid-discovery-endpoint-well-known-endpoint","title":"Accessing OpenID Discovery endpoint / Well-known endpoint","text":"<pre><code>curl https://jans-ui.jans.io/.well-known/openid-configuration\n</code></pre>","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#client-credentials-flow","title":"Client Credentials Flow","text":"<pre><code>curl -k -u \"put_client_id:put_client_secret\" https://jans-ui.jans.io/jans-auth/restv1/token \\ \n      -d  \"grant_type=client_credentials&amp;scope=https://jans.io/oauth/config/scopes.write\" \n</code></pre>","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#authorization-code-flow","title":"Authorization code flow","text":"<p>Steps:</p> <ol> <li>On a browser type <code>https://my.jans.server/jans-auth/restv1/authorize?redirect_uri=https://my-redirect-app:8080&amp;client_id=Put_client_id_here&amp;scope=username+openid&amp;response_type=code</code></li> <li>Based on the default authentication method set, the user will be presented with credentials for login. The OpenID Provider (Gluu Server) verifies the user\u2019s identity and authenticates the user.</li> <li>In the back channel the following steps take place : </li> <li>The OpenID Provider (Gluu Server) sends the user back to the application with an authorization code.</li> <li>The application sends the code to the Token Endpoint to receive an Access Token and ID Token in the response.</li> <li>The application uses the ID Token to authorize the user. At this point the application/RP can access the UserInfo endpoint for claims.</li> </ol>","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#device-authorization-code-flow","title":"Device Authorization code flow","text":"<ol> <li>Client_id that is used in the curl command below should have grant_type <code>urn:ietf:params:oauth:grant-type:device_code</code></li> <li>Call the Device Authorization Endpoint :     <pre><code>curl -k -u \"client_id_here:client_secret_here\" https://jans-ui.jans.io/jans-auth/restv1/device_authorization \\\n     -d  scope=openid+profile+email+offline_access\" \n</code></pre></li> <li>Response received will be like this     <pre><code>{\n  \"user_code\": \"HJDN-BMHQ\",\n  \"device_code\": \"b8a5e5e6b1c10506af4f4bbb5400ca2587dcfe44974d7e62\",\n  \"interval\": 5,\n  \"verification_uri_complete\": \"https://jans-ui.jans.io/device-code?user_code=HJDN-BMHQ\",\n  \"verification_uri\": \"https://jans-ui.jans.io/device-code\",\n  \"expires_in\": 1800\n}\n</code></pre></li> <li>User should visit the <code>verification_uri</code> link on a browser and enter the <code>user_code</code>.</li> <li>Until the user to activates the device, begin polling token URL to request an Access Token. Use <code>interval</code> from step 2 as the polling interval.     <pre><code>curl -k -u \"client_id:put_client_secret\" https://jans-ui.jans.io/jans-auth/restv1/token \\\n     -d \"grant_type=client_credentials&amp;grant_type=urn:ietf:params:oauth:grant-type:device_code&amp;device_code=YOUR_DEVICE_CODE&amp;client_id=YOUR_CLIENT_ID\" \n</code></pre></li> </ol>","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#using-janssen-config-api","title":"Using Janssen Config Api","text":"<p>Jans Config Api is a REST application that is developed using Weld 4.x (JSR-365) and JAX-RS. Its endpoint can be used to manage configuration and other properties of Jans Auth Server.</p>","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#authentication","title":"Authentication","text":"<p>Janssen Config API endpoints are OAuth protected. It supports basic token as well as JWT token.</p>","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#invoking-api-using-curl","title":"Invoking API using curl","text":"<p>Janssen Config API has REST endpoints and can be invoked using curl.</p>","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#prerequisites","title":"Prerequisites","text":"<p>You will need:</p> <ul> <li>Jans endpoint URL: https:///jans-config-api/.... <li>Token: The endpoints are OAuth protected and hence will require a token with appropriate scopes.</li>","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/curl-guide/#steps_1","title":"Steps","text":"<ul> <li> <p>Refer to API documentation to know the endpoint path and required OAuth scopes to access that   endpoint. Example: Attribute Endpoint.</p> <p></p> </li> <li> <p>You will need a client that has the required scopes. The Jans TUI provides a default client named <code>jans-config-api-client</code>, whose <code>client ID</code> starts with <code>1800</code> and has required scopes. You can use this client to generate a token.</p> </li> <li> <p>Use the auth token to generate the basic token.</p> <p>Syntax: <pre><code>curl -k  https://&lt;my.jans.server.domain&gt;/jans-auth/restv1/token -H \"Accept: application/json\" -u \"&lt;clientId&gt;:&lt;decryptedClientSecret&gt;\" -d \"grant_type=client_credentials\" -d \"scope= &lt;apce separated oAuth Scope List&gt;\"\n</code></pre></p> <p>Example: generate token for attribute:</p> <pre><code>curl -k  https://jans.server1/jans-auth/restv1/token -H \"Accept: application/json\" -u \"1800.3687abff-770f-48fb-8130-97678d918adc:TUDvmnVINbKC\" -d \"grant_type=client_credentials\" -d \"scope=https://jans.io/oauth/config/attributes.readonly\"\n</code></pre> <p></p> </li> <li> <p>Invoke endpoint</p> <p>Syntax:</p> <pre><code>curl -k -i -H \"Accept: application/json\" -H \"Content-Type: application/json\" -H \"Authorization:Bearer &lt;accessToken&gt;\" -X GET https://&lt; my.jans.server.domain &gt;/jans-config-api/api/v1/attributes\n</code></pre> <p>Example: Invoke attribute GET endpoint:</p> <pre><code>curl -k -i -H \"Accept: application/json\" -H \"Content-Type: application/json\" -H \"Authorization:Bearer 45e73488-da3f-4429-9072-e0833c703a0d\" -X GET https://jans.server1/jans-config-api/api/v1/attributes\n</code></pre> <p></p> </li> </ul>","tags":["administration","configuration","tools","cli","curl"]},{"location":"janssen-server/config-guide/config-tools/config-api/","title":"Config-api","text":"<p>Jans Config Api provides a central place to manage and configure jans modules. It helps in configuring auth-server, users, fido2 and scim modules.</p> <p>Config API is a REST application that is developed using Weld 4.x (JSR-365) and JAX-RS. Its endpoints can be used to manage configuration and other properties of Jans Auth Server, which is an open-source OpenID Connect Provider (OP) and UMA Authorization Server (AS)</p> <p></p> <p>If you want to learn more about Weld, please visit its website: https://weld.cdi-spec.org/</p>","tags":["administration","tools","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/#packaging-and-running-the-application","title":"Packaging and running the application","text":"<p>The application can be packaged using <code>./mvnw package</code>. It produces the <code>jans-config-api.war</code> file in the <code>server/target</code> directory. Be aware that all the dependencies are copied into the <code>server/target/jans-config-api/WEB-INF/lib</code> directory.</p>","tags":["administration","tools","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/#plugins","title":"Plugins","text":"<p>Jans Config API follow a flexible plugin architecture in which the new features can be added using extensions called plugins without altering the application itself. In this section, we will discuss the steps to develop and add plugins in Jans Config API. Refer here for more details.</p>","tags":["administration","tools","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/#endpoints-protection","title":"Endpoints protection","text":"<p>Config API endpoints are OAuth 2.0 protected. It supports simple bearer and JWT token. Learn more API endpoint protection using here.</p>","tags":["administration","tools","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/#monitoring","title":"Monitoring","text":"<p>Config API module monitoring related details here.</p>","tags":["administration","tools","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/authorization/","title":"Authorization","text":"","tags":["administration","tools","config-api","endpoint"]},{"location":"janssen-server/config-guide/config-tools/config-api/authorization/#endpoints-protection","title":"Endpoints protection","text":"<p>Config API endpoints are OAuth 2.0 protected. It supports simple bearer and JWT token.</p>","tags":["administration","tools","config-api","endpoint"]},{"location":"janssen-server/config-guide/config-tools/config-api/authorization/#authorization-requirements","title":"Authorization Requirements","text":"<p>1) If a user has <code>write</code> permission then should be able to read data as well. That is no need for explicit read permission 2) Need super permission to execute endpoints  - <code>https://jans.io/oauth/config/read-all</code> should be able to able to execute read for all endpoints - <code>https://jans.io/oauth/config/write-all</code> should be able to execute add/update/delete for all endpoints 3) Functionality wise group permission to enable execution of all endpoints  - example all OpenID endpoints (client, scope), all admin-ui endpoints(role, mapping, permission, license)  https://jans.io/oauth/config/oauth-write https://jans.io/oauth/config/oauth-read</p>","tags":["administration","tools","config-api","endpoint"]},{"location":"janssen-server/config-guide/config-tools/config-api/authorization/#implementation","title":"Implementation","text":"<p>Metadata: An endpoint can be annotated with endpoint specific scope, feature level scope(Group) or admin level scope using @ProtectedApi wherein; - scope -&gt; endpoint specific granular permissions - groupScopes -&gt; feature level permissions - superScopes -&gt; Admin level permissions</p> <p>Logic: - superScopes: If the access token has any of super scopes then no need to check group or granular scopes - groupScopes: If the access token does not have any of the applicable super scopes, then check if the access token has group level scopes. If any of the group level scope present then no need to check group or granular scopes. - scope: If access token does not have any of the super or group level scopes then check if all the applicable endpoint specific granular scopes are present.</p> <p>Example: OpenID Client GET endpoint annotation <code>@ProtectedApi(scopes = { \"https://jans.io/oauth/config/openid/clients.readonly\" }, groupScopes = {             \"https://jans.io/oauth/config/openid/openid-write\", \"https://jans.io/oauth/config/openid-read\" }, superScopes = { \"https://jans.io/oauth/config/read-all\")</code></p> <ul> <li>superScopes: If the access token has https://jans.io/oauth/config/read-all scopes then no need to check presence of any other scope.</li> <li>groupScopes: If the access token does not of any of applicable superScopes but has either of https://jans.io/oauth/config/openid/openid-write or https://jans.io/oauth/config/openid-read then no need to check presence of any other scope.</li> <li>scope: If access token does not have any of the super or group level scopes then check it should have the applicable https://jans.io/oauth/config/openid/clients.readonly scope to invoke the endpoint.</li> </ul>","tags":["administration","tools","config-api","endpoint"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/","title":"Janssen Config-API Configuration","text":"<p>The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal.  Learn how to use Jans Text-based UI (TUI)  here or jump straight to the Using Text-based UI</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here or Jump straight to the Using Configuration REST API</p>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#using-command-line","title":"Using Command Line","text":"<p>In the Janssen Server, you can deploy and customize the Config-API Configuration using the command line. To get the details of Janssen command line operations relevant to Config-API Configuration, you can check the operations under <code>ConfigurationConfigApi</code> task using the command below:</p> Command<pre><code>jans tui --info ConfigurationConfigApi\n</code></pre> <p>It will show the details of the available operation-ids for Config-API.</p> Sample Output<pre><code>Operation ID: get-config-api-properties\n Description: Gets config-api configuration properties.\nOperation ID: patch-config-api-properties\n Description: Partially modifies config-api Configuration properties.\n Schema: Array of JsonPatch\n\nTo get sample schema type jans tui --schema-sample &lt;schema&gt;, for example jans tui --schema-sample JsonPatch\n</code></pre>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#get-the-current-config-api-configuration","title":"Get The Current Config-API Configuration","text":"<p>Configuration for Config-API is a set of key-value pairs, called properties. When we retrieve the configuration, these properties and their current values are returned as a JSON document. To get the properties of Janssen Config-API Configuration, run the command below:</p> Command<pre><code>jans tui --operation-id=get-config-api-properties\n</code></pre> <p>It will return the result as below:</p> Sample Output<pre><code>{\n  \"serviceName\": \"jans-config-api\",\n  \"configOauthEnabled\": true,\n  \"disableLoggerTimer\": false,\n  \"disableAuditLogger\": false,\n  \"customAttributeValidationEnabled\": true,\n  \"acrValidationEnabled\": true,\n  \"apiApprovedIssuer\": [\n    \"https://example.jans.io\"\n ],\n  \"apiProtectionType\": \"oauth2\",\n  \"apiClientId\": \"1800.b62cb614-a09d-4163-a6bc-32e38a51c4d2\",\n  \"apiClientPassword\": \"CN8ggRUhMkw9K0ocQ+LXbA==\",\n  \"endpointInjectionEnabled\": false,\n  \"authIssuerUrl\": \"https://example.jans.io\",\n  \"authOpenidConfigurationUrl\": \"https://example.jans.io/.well-known/openid-configuration\",\n  \"authOpenidIntrospectionUrl\": \"https://example.jans.io/jans-auth/restv1/introspection\",\n  \"authOpenidTokenUrl\": \"https://example.jans.io/jans-auth/restv1/token\",\n  \"authOpenidRevokeUrl\": \"https://example.jans.io/jans-auth/restv1/revoke\",\n  \"exclusiveAuthScopes\": [\n    \"jans_stat\",\n    \"https://jans.io/scim/users.read\",\n    \"https://jans.io/scim/users.write\"\n ],\n  \"corsConfigurationFilters\": [\n {\n      \"filterName\": \"CorsFilter\",\n      \"corsEnabled\": true,\n      \"corsAllowedOrigins\": \"*\",\n      \"corsAllowedMethods\": \"GET,PUT,POST,DELETE,PATCH,HEAD,OPTIONS\",\n      \"corsSupportCredentials\": true,\n      \"corsLoggingEnabled\": false,\n      \"corsPreflightMaxAge\": 1800,\n      \"corsRequestDecorate\": true\n }\n ],\n  \"loggingLevel\": \"INFO\",\n  \"loggingLayout\": \"text\",\n  \"disableJdkLogger\": true,\n  \"maxCount\": 200,\n  \"acrExclusionList\": [\n    \"simple_password_auth\"\n ],\n  \"userExclusionAttributes\": [\n    \"userPassword\"\n ],\n  \"userMandatoryAttributes\": [\n    \"mail\",\n    \"displayName\",\n    \"status\",\n    \"userPassword\",\n    \"givenName\"\n ],\n  \"agamaConfiguration\": {\n    \"mandatoryAttributes\": [\n      \"qname\",\n      \"source\"\n ],\n    \"optionalAttributes\": [\n      \"serialVersionUID\",\n      \"enabled\"\n ]\n },\n  \"auditLogConf\": {\n    \"enabled\": true,\n    \"headerAttributes\": [\n      \"User-inum\"\n ]\n },\n  \"dataFormatConversionConf\": {\n    \"enabled\": true,\n    \"ignoreHttpMethod\": [\n      \"@jakarta.ws.rs.GET()\"\n ]\n },\n  \"plugins\": [\n {\n      \"name\": \"admin\",\n      \"description\": \"admin-ui plugin\",\n      \"className\": \"io.jans.ca.plugin.adminui.rest.ApiApplication\"\n },\n {\n      \"name\": \"fido2\",\n      \"description\": \"fido2 plugin\",\n      \"className\": \"io.jans.configapi.plugin.fido2.rest.ApiApplication\"\n },\n {\n      \"name\": \"scim\",\n      \"description\": \"scim plugin\",\n      \"className\": \"io.jans.configapi.plugin.scim.rest.ApiApplication\"\n },\n {\n      \"name\": \"user-management\",\n      \"description\": \"user-management plugin\",\n      \"className\": \"io.jans.configapi.plugin.mgt.rest.ApiApplication\"\n },\n {\n      \"name\": \"jans-link\",\n      \"description\": \"jans-link plugin\",\n      \"className\": \"io.jans.configapi.plugin.link.rest.ApiApplication\"\n },\n {\n      \"name\": \"saml\",\n      \"description\": \"saml plugin\",\n      \"className\": \"io.jans.configapi.plugin.saml.rest.ApiApplication\"\n },\n {\n      \"name\": \"kc-link\",\n      \"description\": \"kc-link plugin\",\n      \"className\": \"io.jans.configapi.plugin.kc.link.rest.ApiApplication\"\n },\n {\n      \"name\": \"lock\",\n      \"description\": \"lock plugin\",\n      \"className\": \"io.jans.configapi.plugin.lock.rest.ApiApplication\"\n }\n ],\n  \"assetMgtConfiguration\": {\n    \"assetMgtEnabled\": true,\n    \"assetServerUploadEnabled\": true,\n    \"fileExtensionValidationEnabled\": true,\n    \"moduleNameValidationEnabled\": true,\n    \"assetBaseDirectory\": \"/opt/jans/jetty/%s/custom\",\n    \"jansServiceModule\": [\n      \"jans-auth\",\n      \"jans-config-api\",\n      \"jans-fido2\",\n      \"jans-scim\"\n ],\n    \"assetDirMapping\": [\n {\n        \"directory\": \"i18n\",\n        \"type\": [\n          \"properties\"\n ],\n        \"description\": \"Resource bundle file.\"\n },\n {\n        \"directory\": \"libs\",\n        \"type\": [\n          \"jar\"/opt/jans/jans-cli/config-cli.py --info ConfigurationConfigApi\n\n ],\n        \"description\": \"java archive library.\"\n },\n {\n        \"directory\": \"pages\",\n        \"type\": [\n          \"xhtml\"\n ],\n        \"description\": \"Web pages.\"\n },\n {\n        \"directory\": \"static\",\n        \"type\": [\n          \"js\",\n          \"css\",\n          \"png\",\n          \"gif\",\n          \"jpg\",\n          \"jpeg\"\n ],\n        \"description\": \"Static resources like Java-script, style-sheet and images.\"\n }\n ]\n }\n}\n</code></pre>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#update-config-api-configuration-properties","title":"Update Config-API Configuration Properties","text":"<p>To update the configuration, we will use JSON patch schema as shown below.</p> <p>Let's say we want to stop the file extension validation done by config-api's asset management module. This can be done by setting the <code>fileExtensionValidationEnabled</code> property to <code>false</code>. To do that, write a text file (<code>config-api-assetmgt-patch.json</code>) with the content that follows the JSON patch schema.</p> config-api-assetmgt-patch.json<pre><code>[\n {\n    \"op\": \"replace\",\n    \"path\": \"/assetMgtConfiguration/fileExtensionValidationEnabled\",\n    \"value\": false\n }\n]\n</code></pre> <p>Now, execute the following command to apply this patch:  Command<pre><code> jans tui \\\n--operation-id=patch-config-api-properties --data ./config-api-assetmgt-patch.json\n</code></pre>  Upon successful execution of the update, the Janssen Server responds with  updated configuration.</p>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#updating-multi-valued-property","title":"Updating multi-valued property","text":"<p>Let's say we want to update the configuration property  userMandatoryAttributes. This property's value is a list of attributes. We want to remove an attribute from the list. For this, we will have to create a JSON patch file that contains the new list and then run a command to push the update to the Janssen Server. Let's do this step-by-step:</p> <ol> <li>Get the current value list for userMandatoryAttributes property using steps mentioned in Get the current configuration section</li> <li>Using the current list of values as a starting point,  create a JSON patch  file <code>config-api-patch.json</code> as below. Update the list as desired by adding or removing items from the list:</li> </ol> Sample Contents<pre><code>[\n{\n   \"op\": \"replace\",\n   \"path\": \"/userMandatoryAttributes\",\n   \"value\": [\n     \"mail\",\n     \"displayName\",\n     \"status\",\n     \"userPassword\",\n     \"givenName\",\n     \"gender\"\n]\n}\n]\n</code></pre> <p>Now, execute the following command to apply this patch:  Command<pre><code> jans tui \\\n--operation-id=patch-config-api-properties --data ./config-api-patch.json\n</code></pre></p>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#config-api-configuration-parameters","title":"Config API Configuration Parameters:","text":"<p>The table below outlines the key configuration parameters for the Jans Config API. It details settings for OAuth2, security, endpoints, logging, and plugin management.</p> Field named Example Description configOauthEnabled true property can be used to enable or disable the oAuth2 authorization. By default, it is set to true. apiApprovedIssuer [\"https://,https://,https://\"] Enables to set more than one authorization servers. By default, the current auth-server is set. You can add more servers separated by commas. apiProtectionType oauth2 Currently support mechanism is OAuth 2.0 tokens. apiClientId 1800.52eb1bed-ab5c-4ba6-b87e-90aad26058d0 Jans Config API Client. apiClientPassword lwI/8mcMkF63mvueYTZ0mQ== Encrypted secret of Jans Config API Client endpointInjectionEnabled false To be used if the endpoint needs to be injected. authIssuerUrl https://my-jans-server.jans.io URL of underlying auth-server. authOpenidConfigurationUrl https://my-jans-server.jans.io/.well-known/openid-configuration Metadata URL of the authorization server. authOpenidIntrospectionUrl https://my-jans-server.jans.io/jans-auth/restv1/introspection Authorization server endpoint to check the state of an OAuth 2.0 token and to determine meta-information about the token. authOpenidTokenUrl https://my-jans-server.jans.io/jans-auth/restv1/token Authorization server endpoint to obtain an Access Token, an ID Token, and optionally a Refresh Token. authOpenidRevokeUrl https://my-jans-server.jans.io/jans-auth/restv1/token Authorization server endpoint to notify an OAuth 2.0 authorization server that a previously obtained refresh or access token is no longer needed, allowing the server to clean up security credentials. smallryeHealthRootPath /health-check Deprecated param for health-check exclusiveAuthScopes [\"jans_stat\",\"https://jans.io/scim/users.read\",\"https://jans.io/scim/users.write\"] Scopes that are only validated against the underlying Janssen Authorization server. corsConfigurationFilters [{\"filterName\":\"CorsFilter\",\"corsEnabled\":true,\"corsAllowedOrigins\":\"*\",\"corsAllowedMethods\":\"GET,PUT,POST,DELETE,PATCH,HEAD,OPTIONS\",\"corsAllowedHeaders\":\"\",\"corsExposedHeaders\":\"\",\"corsSupportCredentials\":true,\"corsLoggingEnabled\":false,\"corsPreflightMaxAge\":1800,\"corsRequestDecorate\":true}] This list specifies the CORS configuration filters. exclusiveAuthScopes [\"jans_stat\",\"https://jans.io/scim/users.read\",\"https://jans.io/scim/users.write\"] Scopes that are only validated against the underlying Janssen Authorization server. loggingLevel \"INFO\" or \"TRACE\" or \"DEBUG\" Logging level for Config API. loggingLayout \"text\" Contents of logs as plain text format. externalLoggerConfiguration Path to external log4j2 logging configuration. disableJdkLogger true Boolean to disable JDK loggers. maxCount 200 To be used to set maximum records returned in response. userExclusionAttributes [\"userPassword\"] List of attributes to be excluded in User response. userMandatoryAttributes [\"mail\",\"displayName\",\"jansStatus\",\"userPassword\",\"givenName\"] List of attributes mandatory for creating a User. agamaConfiguration {\"mandatoryAttributes\":[\"qname\",\"source\"],\"optionalAttributes\":[\"serialVersionUID\",\"enabled\"]} Configuration parameters like mandatory, optional, etc for agama flow. auditLogConf {\"enabled\":true,\"ignoreHttpMethod\":[],\"headerAttributes\":[\"User-inum\"]} Audit Log configuration. dataFormatConversionConf {\"enabled\":true,\"ignoreHttpMethod\":[\"@jakarta.ws.rs.GET()\"]} DB specific data format conversion configuration for Date field. plugins [{\"name\":\"admin\",\"description\":\"admin-ui plugin\",\"className\":\"io.jans.ca.plugin.adminui.rest.ApiApplication\"},{\"name\":\"fido2\",\"description\":\"fido2 plugin\",\"className\":\"io.jans.configapi.plugin.fido2.rest.ApiApplication\"},{\"name\":\"scim\",\"description\":\"scim plugin\",\"className\":\"io.jans.configapi.plugin.scim.rest.ApiApplication\"},{\"name\":\"user-management\",\"description\":\"user-management plugin\",\"className\":\"io.jans.configapi.plugin.mgt.rest.ApiApplication\"}] List of configured plugin.","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#two-options-to-make-effect-any-manual-changes-done-to-the-configuration","title":"Two options to make effect any manual changes done to the configuration","text":"<ol> <li>Restart jans-config-api </li> <li>Increment the <code>jansRevision</code> property of the configuration without restarting  the application. The timer job will detect the change and fetch the latest  configuration from the DB.</li> </ol>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#locating-config-api-configuration-in-the-persistence-layer","title":"Locating Config API configuration in the Persistence Layer","text":"<p>While it is not recommended that an administrator directly edits a configuration at the persistence layer, it may be useful information for a developer.</p>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#mysql","title":"MySQL","text":"<pre><code>erDiagram\n jansAppConf {\n string doc_id PK \"\"\n string ou  \"jans-config-api\"\n string jansConfDyn \"json configuration for the app\"\n }</code></pre>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#important-attributes","title":"Important attributes","text":"","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#oauth-authorization","title":"OAuth authorization","text":"<p><code>configOauthEnabled</code> property can be used to enable or disable the oAuth2 authorization. By default, it is set to true.</p> <pre><code> \"configOauthEnabled\": true\n</code></pre>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#api-protection","title":"Api protection","text":"<p><code>apiProtectionType</code> property states the protocol used for API authorization. The currently supported value is <code>oauth2</code>.</p> <pre><code> \"apiProtectionType\": \"oauth2\"\n</code></pre>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#api-protection-auth-server","title":"Api protection auth server","text":"<p><code>apiApprovedIssuer</code> property enables to set more than one authorization servers. By default, the current auth-server is set. You can add more servers separated by commas.</p> <pre><code> apiApprovedIssuer\": [\"https://&lt;jans.auth.server&gt;,https://&lt;gluu.server&gt;,https://&lt;anyAuth.server&gt;\"]\n</code></pre>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#logging-level","title":"Logging level","text":"<p><code>loggingLevel</code> property can be used to change the logging level to the desired values <code>(TRACE, DEBUG, INFO, WARN, ERROR)</code>. By default, the level is set to <code>INFO</code></p> <p>```javascript</p> <p>\"loggingLevel\":\"DEBUG\",</p> <p>```</p>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#scopes-other-than-the-one-defined-by-config-api","title":"Scopes other than the one defined by config-api","text":"<p>Config API endpoints are oAuth2 protected. These scopes are created during installation. However, few endpoints require scopes defined by other modules like auth-server.</p> <p>A list of these scopes is maintained in the configuration in order to avoid the creation of these scopes during Config API start-up. <code>exclusiveAuthScopes</code> property can be used to change the logging level to the desired value <code>(TRACE, DEBUG, INFO, WARN, ERROR)</code>. By default, the level is set to <code>INFO</code></p> <pre><code> \"exclusiveAuthScopes\": [\n   \"jans_stat\",\n   \"https://jans.io/scim/users.read\",\n   \"https://jans.io/scim/users.write\"\n],\n</code></pre>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#user-mandatory-and-exclusion-attributes","title":"User - Mandatory and exclusion attributes","text":"","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#mandatoryattributes","title":"MandatoryAttributes","text":"<p><code>userMandatoryAttributes</code> can be used to define mandatory attributes for User while creating and updating.</p> <pre><code>  \"userMandatoryAttributes\": [\n \"mail\",\n \"displayName\",\n \"jansStatus\",\n \"userPassword\",\n \"givenName\"\n],\n</code></pre>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#exclusion-attributes","title":"Exclusion attributes","text":"<p><code>userExclusionAttributes</code> can be used to define User attributes that are not to be returned in the API response. More attributes that are to be skipped in response can be added to the list.</p> <pre><code>  \"userExclusionAttributes\": [\n    \"userPassword\"\n ],\n</code></pre>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#agama-flow-configuration","title":"Agama flow configuration","text":"<p><code>agamaConfiguration</code> stores Agama-related configuration used in Agama related endpoints.</p> <p><code>mandatoryAttributes</code> list defines the required attributes for Agama flow creation and update. <code>optionalAttributes</code> list specifies the optional attributes.</p> <pre><code>  \"agamaConfiguration\": {\n     \"mandatoryAttributes\": [\n   \"qname\",\n   \"source\"\n ],\n   \"optionalAttributes\": [\n   \"serialVersionUID\",\n   \"enabled\"\n ]\n }\n</code></pre>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#using-text-based-ui","title":"Using Text-based UI","text":"<p>You can start TUI using the command below:</p> Command<pre><code>jans tui\n</code></pre> <p>Navigate to <code>Config API</code> section where administrators can update Config-API configurations in six sub-tabs, namely Main, Agama, Plugins, Asset Management, Audit Log Conf, Data Format Conversion</p> <p></p>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/config/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring the Config-API Configuration. Endpoint details are published in the Swagger document, see endpoint <code>/api/v1/api-config</code></p>","tags":["administration","tools","configuration","config-api"]},{"location":"janssen-server/config-guide/config-tools/config-api/logs/","title":"Config-api logs","text":"<p>Two types of logs generated by config-api, <code>application logs</code> and <code>audit log</code>. - Application log contains application functionality logs - Audit log contains information of each request received.</p>","tags":["administration","tools","config-api","logs"]},{"location":"janssen-server/config-guide/config-tools/config-api/logs/#logging-configuration","title":"Logging configuration","text":"<p>Log configuration is stored in DB along with the config-application other configuration</p> <p><code>javascript {  \"configOauthEnabled\": true,  \"apiApprovedIssuer\": [\"https://jans.server2\"],  \"apiProtectionType\": \"oauth2\",  \"apiClientId\": \"1800.c9c0b756-a1fc-4013-9feb-64d531ac2dc1\",  \"apiClientPassword\": \"X9q7cAemqyD9LaS1c5YzIA==\",  \"endpointInjectionEnabled\": false,  \"authIssuerUrl\": \"https://jans.server2\",  \"authOpenidConfigurationUrl\": \"https://jans.server2/.well-known/openid-configuration\",  \"authOpenidIntrospectionUrl\": \"https://jans.server2/jans-auth/restv1/introspection\",  \"authOpenidTokenUrl\": \"https://jans.server2/jans-auth/restv1/token\",  \"authOpenidRevokeUrl\": \"https://jans.server2/jans-auth/restv1/revoke\",  \"smallryeHealthRootPath\": \"/health-check\",  \"disableJdkLogger\":true,  \"loggingLevel\":\"INFO\",  \"loggingLayout\":\"text\",  \"externalLoggerConfiguration\":\"\",  \"exclusiveAuthScopes\": [    \"jans_stat\",    \"https://jans.io/scim/users.read\",    \"https://jans.io/scim/users.write\"  ],  \"corsConfigurationFilters\": [    {      \"filterName\": \"CorsFilter\",      \"corsAllowedOrigins\": \"*\",      \"corsAllowedMethods\": \"GET,PUT,POST,DELETE,PATCH,HEAD,OPTIONS\",      \"corsAllowedHeaders\": \"\",      \"corsExposedHeaders\": \"\",      \"corsSupportCredentials\": true,      \"corsLoggingEnabled\": false,      \"corsPreflightMaxAge\": 1800,      \"corsRequestDecorate\": true,      \"corsEnabled\": true    }  ],  \"userExclusionAttributes\": [    \"userPassword\"  ],   \"userMandatoryAttributes\": [   \"mail\",   \"displayName\",   \"jansStatus\",   \"userPassword\",   \"givenName\"  ],  \"agamaConfiguration\": {     \"mandatoryAttributes\": [    \"qname\",    \"source\"     ],    \"optionalAttributes\": [    \"serialVersionUID\",    \"enabled\"     ]  },  \"auditLogConf\": {    \"enabled\": true,    \"ignoreHttpMethod\": [],    \"headerAttributes\": [      \"User-inum\"    ]  },  \"dataFormatConversionConf\": {    \"enabled\": true,    \"ignoreHttpMethod\": [      \"@jakarta.ws.rs.GET()\"    ]  },  \"plugins\": [    {      \"name\": \"admin\",      \"description\": \"admin-ui plugin\",      \"className\": \"io.jans.ca.plugin.adminui.rest.ApiApplication\"    },    {      \"name\": \"fido2\",      \"description\": \"fido2 plugin\",      \"className\": \"io.jans.configapi.plugin.fido2.rest.ApiApplication\"    },    {      \"name\": \"scim\",      \"description\": \"scim plugin\",      \"className\": \"io.jans.configapi.plugin.scim.rest.ApiApplication\"    },    {      \"name\": \"user-management\",      \"description\": \"user-management plugin\",      \"className\": \"io.jans.configapi.plugin.mgt.rest.ApiApplication\"    }  ] }</code></p>","tags":["administration","tools","config-api","logs"]},{"location":"janssen-server/config-guide/config-tools/config-api/logs/#audit-log","title":"Audit log","text":"","tags":["administration","tools","config-api","logs"]},{"location":"janssen-server/config-guide/config-tools/config-api/logs/#configuration","title":"Configuration","text":"<pre><code>...\nauditLogConf\": {\n    \"enabled\": true,\n    \"ignoreHttpMethod\": [],\n    \"headerAttributes\": [\n      \"User-inum\"\n    ]\n...\n</code></pre> Field Description Example enabled Flag to enable and disable audit log true , default value is true, to enable audit logging ignoreHttpMethod HTTP methods for which audit is disabled @jakarta.ws.rs.GET(), @jakarta.ws.rs.PATCH(), @jakarta.ws.rs.PATCH(), etc headerAttributes List of HTTP header attributes whose value is to be logged User-inum","tags":["administration","tools","config-api","logs"]},{"location":"janssen-server/config-guide/config-tools/config-api/logs/#file-name-and-location-on-server","title":"File name and location on server","text":"<ul> <li>Log name: <code>configapi-audit.log</code></li> <li>Log location: <code>/opt/jans/jetty/jans-config-api/logs</code></li> </ul>","tags":["administration","tools","config-api","logs"]},{"location":"janssen-server/config-guide/config-tools/config-api/logs/#application-logs","title":"Application Logs","text":"<p>Config-api uses log4j to generate application execution logs for each endpoint invocation. These can be used to debug the application.</p>","tags":["administration","tools","config-api","logs"]},{"location":"janssen-server/config-guide/config-tools/config-api/logs/#configuration_1","title":"Configuration","text":"<ul> <li> <p>DB: </p> <p><code>``javascript ... \"loggingLevel\":\"DEBUG\", \"loggingLayout\":\"text\" ...</code></p> </li> <li> <p>log4j file: <code>https://github.com/JanssenProject/jans/blob/main/jans-config-api/server/src/main/resources/log4j2.xml</code></p> </li> </ul>","tags":["administration","tools","config-api","logs"]},{"location":"janssen-server/config-guide/config-tools/config-api/logs/#db-configuration","title":"DB configuration","text":"<ol> <li> <p>Fetch configuration </p> <pre><code> curl -k -i -H \"Accept: application/json\" -H \"Content-Type: application/json\" -H \"Authorization:Bearer 3114e010-fd4d-4e62-b5e2-a51b7d6dd231\" -X GET https://jans.server/jans-config-api/api/v1/api-config\n</code></pre> </li> <li> <p>Patch configuration</p> <pre><code> curl -X PATCH -k -H 'Content-Type: application/json-patch+json' -H 'Authorization:Bearer 3114e010-fd4d-4e62-b5e2-a51b7d6dd231' -i 'https://jans.server/jans-config-api/api/v1/api-config' --data '[{\"op\": \"replace\", \"path\": \"/loggingLevel\", \"value\":\"ERROR\"}, {\"op\": \"replace\", \"path\": \"/loggingLayout\", \"value\":\"json\"}, {\"op\": \"replace\", \"path\": \"/auditLogConf/enabled\", \"value\":false} , {\"op\": \"replace\", \"path\": \"/auditLogConf/headerAttributes\", \"value\":[\"User-inum\",\"city\"]}]'\n</code></pre> </li> </ol>","tags":["administration","tools","config-api","logs"]},{"location":"janssen-server/config-guide/config-tools/config-api/monitoring/","title":"Health - Check endpoints","text":"<ul> <li>/api/v1/health - Returns application consolidated health status - liveness and readiness</li> <li>/api/v1/health/live - Returns application liveness status</li> <li>/api/v1/health/ready -Returns application readiness status</li> <li>/api/v1/health/server-stat - Returns application server status and stats metric like <code>memoryfree</code>, <code>uptime</code>, <code>free_disk_space</code>, etc</li> </ul> <p>Sample health response <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n[\n    {\n        \"name\": \"jans-config-api liveness\",\n        \"status\": \"UP\"\n    },\n    {\n        \"name\": \"jans-config-api readiness\",\n        \"status\": \"UP\"\n    }\n]\n</code></pre></p> <p>Sample liveness response <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n{\n    \"name\": \"jans-config-api liveness\",\n    \"status\": \"UP\"\n}\n</code></pre></p> <p>Sample readiness response <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n{\n    \"name\": \"jans-config-api readiness\",\n    \"status\": \"UP\"\n}\n</code></pre></p> <p>Sample server status response <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n{\n    \"dbType\":\"MySQL\",\n    \"lastUpdate\":\"2023-03-16T03:17:44\",\n    \"facterData\":\n    {\n        \"memoryfree\":\"7.1%\",\n        \"swapfree\":\"60.1%\",\n        \"hostname\":\"jans.server2\",\n        \"ipaddress\":\"192.168.0.102\",\n        \"uptime\":\"3:03\",\n        \"free_disk_space\":\"65.0%\",\n        \"load_average\":\"0.77\"\n    }\n}\n</code></pre></p>","tags":["administration","tools","config-api","monitoring"]},{"location":"janssen-server/config-guide/config-tools/config-api/monitoring/#application-logs","title":"Application logs","text":"<p>Application log can be verified if application is started properly. Refer here for more details.</p>","tags":["administration","tools","config-api","monitoring"]},{"location":"janssen-server/config-guide/config-tools/config-api/openid-client/","title":"OpenID Connect Client","text":"<p>OpenID Connect Client is Relying Parties(RP) using the OAuth Implicit Flow.</p>","tags":["administration","tools","config-api","openid-connect client"]},{"location":"janssen-server/config-guide/config-tools/config-api/openid-client/#listing-existing-openid-connect-clients","title":"Listing existing OpenID Connect clients","text":"<code>GET</code> <code>/</code> <code>(gets list of OpenID Connect clients based on search parameters)</code>  ### Parameters  &gt; | name       |  param type | data type      | type      |default value | description                                                                     | &gt; |------------|-------------|----------------|-----------|--------------|---------------------------------------------------------------------------------| &gt; | limit      |  query      | integer        | optional  |50            |Search size - max size of the results to return                                  | &gt; | pattern    |  query      | string         | optional  |N/A           |Comma separated search patter. E.g. `pattern=edu`, `pattern=edu,locale,License`  | &gt; | startIndex |  query      | integer        | optional  |1             |Index of the first query result                                                  | &gt; | sortBy     |  query      | string         | optional  |inum          |Field whose value will be used to order the returned response                | &gt; | sortOrder  |  query      | string         | optional  |ascending     |Search size - max size of the results to return                                  |   ### Responses  &gt; | http code     | content-type                      | response                                                            | &gt; |---------------|-----------------------------------|---------------------------------------------------------------------| &gt; | `200`         | `application/json`                | `Paginated result`                                                  | &gt; | `401`         | `application/json`                | `{\"code\":\"401\",\"message\":\"Unauthorized\"}`                           | &gt; | `500`         | `application/json`                | `{\"code\":\"500\",\"message\":\"Error msg\"}`                              |  ### Example cURL  &gt; <pre><code> curl -k -i -H \"Accept: application/json\" -H \"Content-Type: application/json\" -H \"Authorization:Bearer 697479e0-e6f4-453d-bf7a-ddf31b53efba\" -X GET http://my.jans.server/jans-config-api/api/v1/openid/clients?limit=3&amp;pattern=test&amp;startIndex=1&amp;includeSource=true\n</code></pre>  ### Sample Response &gt; ```javascript &gt;{ &gt;    \"start\": 0, &gt;    \"totalEntriesCount\": 5, &gt;    \"entriesCount\": 3, &gt;    \"entries\": [ &gt;        { &gt;            \"dn\": \"inum=FF81-2D39,ou=clients,o=jans\", &gt;            \"clientSecret\": \"FF81-2D39-jans\", &gt;            \"frontChannelLogoutSessionRequired\": false, &gt;            \"redirectUris\": [ &gt;                \"https://jans.server2/jans-auth-rp/home.htm\", &gt;                \"https://client.example.com/cb\", &gt;                \"https://client.example.com/cb1\", &gt;                \"https://client.example.com/cb2\" &gt;            ], &gt;            \"claimRedirectUris\": [ &gt;                \"https://jans.server2/jans-auth/restv1/uma/gather_claims\" &gt;            ], &gt;            \"responseTypes\": [ &gt;                \"token\", &gt;                \"code\", &gt;                \"id_token\" &gt;            ], &gt;            \"grantTypes\": [ &gt;                \"authorization_code\", &gt;                \"implicit\", &gt;                \"refresh_token\", &gt;                \"client_credentials\" &gt;            ], &gt;            \"applicationType\": \"web\", &gt;            \"clientName\": \"Jans Test Client (don't remove)\", &gt;            \"clientNameLocalized\": {}, &gt;            \"logoUriLocalized\": {}, &gt;            \"clientUriLocalized\": {}, &gt;            \"policyUriLocalized\": {}, &gt;            \"tosUriLocalized\": {}, &gt;            \"subjectType\": \"public\", &gt;            \"idTokenSignedResponseAlg\": \"RS256\", &gt;            \"tokenEndpointAuthMethod\": \"client_secret_basic\", &gt;            \"scopes\": [ &gt;                \"inum=F0C4,ou=scopes,o=jans\", &gt;                \"inum=10B2,ou=scopes,o=jans\", &gt;                \"inum=764C,ou=scopes,o=jans\", &gt;                \"inum=43F1,ou=scopes,o=jans\", &gt;                \"inum=341A,ou=scopes,o=jans\", &gt;                \"inum=6D99,ou=scopes,o=jans\" &gt;            ], &gt;            \"trustedClient\": true, &gt;            \"persistClientAuthorizations\": false, &gt;            \"includeClaimsInIdToken\": false, &gt;            \"customAttributes\": [], &gt;            \"customObjectClasses\": [ &gt;                \"top\" &gt;            ], &gt;            \"rptAsJwt\": false, &gt;            \"accessTokenAsJwt\": false, &gt;            \"disabled\": false, &gt;            \"attributes\": { &gt;                \"runIntrospectionScriptBeforeJwtCreation\": false, &gt;                \"keepClientAuthorizationAfterExpiration\": false, &gt;                \"allowSpontaneousScopes\": false, &gt;                \"backchannelLogoutSessionRequired\": false, &gt;                \"parLifetime\": 600, &gt;                \"requirePar\": false, &gt;                \"jansDefaultPromptLogin\": false &gt;            }, &gt;            \"displayName\": \"Jans Test Client (don't remove)\", &gt;            \"authenticationMethod\": \"client_secret_basic\", &gt;            \"tokenBindingSupported\": false, &gt;            \"baseDn\": \"inum=FF81-2D39,ou=clients,o=jans\", &gt;            \"inum\": \"FF81-2D39\" &gt;        }, &gt;        { &gt;            \"dn\": \"inum=AB77-1A2B,ou=clients,o=jans\", &gt;            \"clientSecret\": \"AB77-1A2B-jans\", &gt;            \"frontChannelLogoutSessionRequired\": false, &gt;            \"redirectUris\": [ &gt;                \"https://client.example.com/cb\" &gt;            ], &gt;            \"claimRedirectUris\": [ &gt;                \"https://jans.server2/jans-auth/restv1/uma/gather_claims\" &gt;            ], &gt;            \"responseTypes\": [ &gt;                \"code\", &gt;                \"id_token\" &gt;            ], &gt;            \"grantTypes\": [ &gt;                \"authorization_code\", &gt;                \"implicit\", &gt;                \"refresh_token\", &gt;                \"client_credentials\" &gt;            ], &gt;            \"applicationType\": \"web\", &gt;            \"clientName\": \"Jans Test Resource Server Client (don't remove)\", &gt;            \"clientNameLocalized\": {}, &gt;            \"logoUriLocalized\": {}, &gt;            \"clientUriLocalized\": {}, &gt;            \"policyUriLocalized\": {}, &gt;            \"tosUriLocalized\": {}, &gt;            \"subjectType\": \"public\", &gt;            \"idTokenSignedResponseAlg\": \"RS256\", &gt;            \"tokenEndpointAuthMethod\": \"client_secret_basic\", &gt;            \"scopes\": [ &gt;                \"inum=6D99,ou=scopes,o=jans\", &gt;                \"inum=7D90,ou=scopes,o=jans\" &gt;            ], &gt;            \"trustedClient\": true, &gt;            \"persistClientAuthorizations\": false, &gt;            \"includeClaimsInIdToken\": false, &gt;            \"customAttributes\": [], &gt;            \"customObjectClasses\": [ &gt;                \"top\" &gt;            ], &gt;            \"rptAsJwt\": false, &gt;            \"accessTokenAsJwt\": false, &gt;            \"disabled\": false, &gt;            \"attributes\": { &gt;                \"runIntrospectionScriptBeforeJwtCreation\": false, &gt;                \"keepClientAuthorizationAfterExpiration\": false, &gt;                \"allowSpontaneousScopes\": false, &gt;                \"backchannelLogoutSessionRequired\": false, &gt;                \"parLifetime\": 600, &gt;                \"requirePar\": false, &gt;                \"jansDefaultPromptLogin\": false &gt;            }, &gt;            \"displayName\": \"Jans Test Resource Server Client (don't remove)\", &gt;            \"authenticationMethod\": \"client_secret_basic\", &gt;            \"tokenBindingSupported\": false, &gt;            \"baseDn\": \"inum=AB77-1A2B,ou=clients,o=jans\", &gt;            \"inum\": \"AB77-1A2B\" &gt;        }, &gt;        { &gt;            \"dn\": \"inum=3E20,ou=clients,o=jans\", &gt;            \"clientSecret\": \"3E20-jans\", &gt;            \"frontChannelLogoutSessionRequired\": false, &gt;            \"redirectUris\": [ &gt;                \"https://client.example.com/cb\" &gt;            ], &gt;            \"responseTypes\": [ &gt;                \"code\", &gt;                \"id_token\" &gt;            ], &gt;            \"grantTypes\": [ &gt;                \"authorization_code\", &gt;                \"implicit\", &gt;                \"refresh_token\", &gt;                \"client_credentials\" &gt;            ], &gt;            \"applicationType\": \"web\", &gt;            \"clientName\": \"Jans Test Requesting Party Client (don't remove)\", &gt;            \"clientNameLocalized\": {}, &gt;            \"logoUriLocalized\": {}, &gt;            \"clientUriLocalized\": {}, &gt;            \"policyUriLocalized\": {}, &gt;            \"tosUriLocalized\": {}, &gt;            \"subjectType\": \"public\", &gt;            \"idTokenSignedResponseAlg\": \"RS256\", &gt;            \"tokenEndpointAuthMethod\": \"client_secret_basic\", &gt;            \"trustedClient\": true, &gt;            \"persistClientAuthorizations\": false, &gt;            \"includeClaimsInIdToken\": false, &gt;            \"customAttributes\": [], &gt;            \"customObjectClasses\": [ &gt;                \"top\" &gt;            ], &gt;            \"rptAsJwt\": false, &gt;            \"accessTokenAsJwt\": false, &gt;            \"disabled\": false, &gt;            \"attributes\": { &gt;                \"runIntrospectionScriptBeforeJwtCreation\": false, &gt;                \"keepClientAuthorizationAfterExpiration\": false, &gt;                \"allowSpontaneousScopes\": false, &gt;                \"backchannelLogoutSessionRequired\": false, &gt;                \"parLifetime\": 600, &gt;                \"requirePar\": false, &gt;                \"jansDefaultPromptLogin\": false &gt;            }, &gt;            \"displayName\": \"Jans Test Requesting Party Client (don't remove)\", &gt;            \"authenticationMethod\": \"client_secret_basic\", &gt;            \"tokenBindingSupported\": false, &gt;            \"baseDn\": \"inum=3E20,ou=clients,o=jans\", &gt;            \"inum\": \"3E20\" &gt;        } &gt;    ] &gt;} &gt; ```   <code>GET</code> <code>/{inum}</code> <code>(gets OpenID Connect client based on inum)</code>  ### Parameters  &gt; | name       |  param type | data type      | type      |default value | description                            | &gt; |------------|-------------|----------------|-----------|--------------|----------------------------------------| &gt; | `inum`     |  path       | string         | required  | NA           | OpenID Connect client unique identifier|  ### Responses  &gt; | http code     | content-type                      | response                                                            | &gt; |---------------|-----------------------------------|---------------------------------------------------------------------| &gt; | `200`         | `application/json        `        | `OpenID Connect client details`                                     | &gt; | `401`         | `application/json`                | `{\"code\":\"401\",\"message\":\"Unauthorized\"}`                           | &gt; | `401`         | `application/json`                | `{\"code\":\"404\",\"message\":\"Not Found\"}`                           | &gt; | `500`         | `application/json`                | `{\"code\":\"500\",\"message\":\"Error msg\"}`                              |  ### Example cURL  &gt; <pre><code> curl -k -i -H \"Accept: application/json\" -H \"Content-Type: application/json\" -H \"Authorization:Bearer 697479e0-e6f4-453d-bf7a-ddf31b53efba\" -X GET http://my.jans.server/jans-config-api/api/v1/openid/clients/bd27a9f6-7772-4049-bd4f-bf7c651fbe7c\n</code></pre>  ### Sample Response  &gt; ```javascript &gt;{ &gt;    \"dn\": \"inum=bd27a9f6-7772-4049-bd4f-bf7c651fbe7c,ou=clients,o=jans\", &gt;    \"deletable\": false, &gt;    \"clientSecret\": \"WonHg253UDJmtl7d55z1K0PWWEZ3N9Xg+O33ibJ1JwCVs4ynLhjPxQ==\", &gt;    \"frontChannelLogoutSessionRequired\": false, &gt;    \"redirectUris\": [ &gt;        \"https://abc,com\" &gt;    ], &gt;    \"responseTypes\": [ &gt;        \"code\" &gt;    ], &gt;    \"grantTypes\": [ &gt;        \"refresh_token\", &gt;        \"authorization_code\" &gt;    ], &gt;    \"applicationType\": \"web\", &gt;    \"clientName\": \"test1234\", &gt;    \"clientNameLocalized\": {}, &gt;    \"logoUriLocalized\": {}, &gt;    \"clientUriLocalized\": {}, &gt;    \"policyUriLocalized\": {}, &gt;    \"tosUriLocalized\": {}, &gt;    \"subjectType\": \"public\", &gt;    \"tokenEndpointAuthMethod\": \"client_secret_basic\", &gt;    \"scopes\": [ &gt;        \"inum=43F1,ou=scopes,o=jans\", &gt;        \"inum=C17A,ou=scopes,o=jans\", &gt;        \"inum=764C,ou=scopes,o=jans\" &gt;    ], &gt;    \"trustedClient\": false, &gt;    \"persistClientAuthorizations\": false, &gt;    \"includeClaimsInIdToken\": false, &gt;    \"customAttributes\": [], &gt;    \"customObjectClasses\": [ &gt;        \"top\", &gt;        \"jansClntCustomAttributes\" &gt;    ], &gt;    \"rptAsJwt\": false, &gt;    \"accessTokenAsJwt\": false, &gt;    \"disabled\": false, &gt;    \"attributes\": { &gt;        \"runIntrospectionScriptBeforeJwtCreation\": false, &gt;        \"keepClientAuthorizationAfterExpiration\": false, &gt;        \"allowSpontaneousScopes\": false, &gt;        \"backchannelLogoutSessionRequired\": false, &gt;        \"parLifetime\": 600, &gt;        \"requirePar\": false, &gt;        \"jansDefaultPromptLogin\": false &gt;    }, &gt;    \"backchannelUserCodeParameter\": false, &gt;    \"description\": \"test1234\", &gt;    \"displayName\": \"test1234\", &gt;    \"authenticationMethod\": \"client_secret_basic\", &gt;    \"tokenBindingSupported\": false, &gt;    \"baseDn\": \"inum=bd27a9f6-7772-4049-bd4f-bf7c651fbe7c,ou=clients,o=jans\", &gt;    \"inum\": \"bd27a9f6-7772-4049-bd4f-bf7c651fbe7c\" &gt;} &gt; ```","tags":["administration","tools","config-api","openid-connect client"]},{"location":"janssen-server/config-guide/config-tools/config-api/openid-client/#creating-new-openid-connect-client","title":"Creating new OpenID Connect client","text":"<code>POST</code> <code>/{inum}</code> <code>(creates a new OpenID Connect client)</code>  ### Parameters  &gt; | name       |  param type | data type      | type      |default value | description                            | &gt; |------------|-------------|----------------|-----------|--------------|----------------------------------------| &gt; | None       |  request    | object (JSON)  | required  | NA           | OpenID Connect client json                         |  ### Responses  &gt; | http code     | content-type                      | response                                                            | &gt; |---------------|-----------------------------------|---------------------------------------------------------------------| &gt; | `201`         | `application/json        `        | `OpenID Connect client json`                                                 | &gt; | `401`         | `application/json`                | `{\"code\":\"401\",\"message\":\"Unauthorized\"}`                           | &gt; | `500`         | `application/json`                | `{\"code\":\"500\",\"message\":\"Error msg\"}`                              |  ### Example cURL  &gt; <pre><code> curl -X POST -k -H 'Content-Type: application/json' -H 'Authorization: Bearer ba9b8810-7a2b-4e4a-a18a-689d7eacf7d1' -i 'https://my.jans.server/jans-config-api/api/v1/openid/clients' --data @post.json\n</code></pre>  ### Sample Request  &gt; ```javascript &gt;{ &gt;  \"clientName\": \"test1234\", &gt;  \"description\": \"test1234\", &gt;  \"expirable\": [], &gt;  \"softwareSection\": false, &gt;  \"cibaSection\": false, &gt;  \"backchannelUserCodeParameter\": false, &gt;  \"redirectUris\": [ &gt;    \"https://abc,com\" &gt;  ], &gt;  \"claimRedirectUris\": [], &gt;  \"authorizedOrigins\": [], &gt;  \"requestUris\": [], &gt;  \"postLogoutRedirectUris\": [], &gt;  \"responseTypes\": [], &gt;  \"grantTypes\": [], &gt;  \"scopes\": [ &gt;    \"inum=43F1,ou=scopes,o=jans\", &gt;    \"inum=C17A,ou=scopes,o=jans\", &gt;    \"inum=764C,ou=scopes,o=jans\" &gt;  ], &gt;  \"attributes\": { &gt;    \"tlsClientAuthSubjectDn\": null, &gt;    \"runIntrospectionScriptBeforeAccessTokenAsJwtCreationAndIncludeClaims\": false, &gt;    \"keepClientAuthorizationAfterExpiration\": false, &gt;    \"allowSpontaneousScopes\": false, &gt;    \"backchannelLogoutSessionRequired\": false, &gt;    \"backchannelLogoutUri\": [], &gt;    \"rptClaimsScripts\": [], &gt;    \"consentGatheringScripts\": [], &gt;    \"spontaneousScopeScriptDns\": [], &gt;    \"introspectionScripts\": [], &gt;    \"postAuthnScripts\": [], &gt;    \"additionalAudience\": [], &gt;    \"spontaneousScopes\": [], &gt;    \"redirectUrisRegex\": \"\", &gt;    \"parLifetime\": \"\", &gt;    \"requirePar\": false, &gt;    \"jansDefaultPromptLogin\": false, &gt;    \"authorizedAcrValues\": [], &gt;    \"updateTokenScriptDns\": [], &gt;    \"ropcScripts\": [], &gt;    \"jansAuthSignedRespAlg\": \"\", &gt;    \"jansAuthEncRespAlg\": \"\", &gt;    \"jansAuthEncRespEnc\": \"\" &gt;  }, &gt;  \"tlsClientAuthSubjectDn\": null, &gt;  \"frontChannelLogoutSessionRequired\": false, &gt;  \"runIntrospectionScriptBeforeAccessTokenAsJwtCreationAndIncludeClaims\": false, &gt;  \"backchannelLogoutSessionRequired\": false, &gt;  \"keepClientAuthorizationAfterExpiration\": false, &gt;  \"allowSpontaneousScopes\": false, &gt;  \"spontaneousScopes\": [], &gt;  \"introspectionScripts\": [], &gt;  \"spontaneousScopeScriptDns\": [], &gt;  \"consentGatheringScripts\": [], &gt;  \"redirectUrisRegex\": \"\", &gt;  \"parLifetime\": \"\", &gt;  \"requirePar\": false, &gt;  \"updateTokenScriptDns\": [], &gt;  \"ropcScripts\": [], &gt;  \"jansAuthSignedRespAlg\": \"\", &gt;  \"jansAuthEncRespAlg\": \"\", &gt;  \"jansAuthEncRespEnc\": \"\", &gt;  \"postAuthnScripts\": [], &gt;  \"rptClaimsScripts\": [], &gt;  \"additionalAudience\": [], &gt;  \"backchannelLogoutUri\": [], &gt;  \"jansDefaultPromptLogin\": false, &gt;  \"authorizedAcrValues\": [], &gt;  \"customObjectClasses\": [], &gt;  \"requireAuthTime\": false, &gt;  \"trustedClient\": false, &gt;  \"persistClientAuthorizations\": false, &gt;  \"includeClaimsInIdToken\": false, &gt;  \"rptAsJwt\": false, &gt;  \"accessTokenAsJwt\": false, &gt;  \"disabled\": false, &gt;  \"action_message\": \"test1234test1234\" &gt;} &gt; ```","tags":["administration","tools","config-api","openid-connect client"]},{"location":"janssen-server/config-guide/config-tools/config-api/openid-client/#updating-existing-openid-connect-client","title":"Updating existing OpenID Connect client","text":"<code>PUT</code> <code>/{inum}</code> <code>(updates an existing OpenID Connect client)</code>  ### Parameters  &gt; | name       |  param type | data type      | type      |default value | description                            | &gt; |------------|-------------|----------------|-----------|--------------|----------------------------------------| &gt; | None       |  request    | object (JSON)  | required  | NA           | OpenID Connect client json                         |  ### Responses  &gt; | http code     | content-type                      | response                                                                      | &gt; |---------------|-----------------------------------|-------------------------------------------------------------------------------| &gt; | `200`         | `application/json        `        | `OpenID Connect client json`                                                  | &gt; | `404`         | `application/json`                | `{\"code\":\"404\",\"message\":\"The requested OpenID Connect client doesn't exist\"}`| &gt; | `401`         | `application/json`                | `{\"code\":\"401\",\"message\":\"Unauthorized\"}`                                     | &gt; | `500`         | `application/json`                | `{\"code\":\"500\",\"message\":\"Error msg\"}`                                        |  ### Example cURL  &gt; <pre><code> curl -X PUT -k -H 'Content-Type: application/json' -H 'Authorization: Bearer ba9b8810-7a2b-4e4a-a18a-689d7eacf7d1' -i 'https://my.jans.server/jans-config-api/api/v1/openid/clients' --data @put.json\n</code></pre>  ### Sample Request  &gt; ```javascript &gt;{ &gt;    \"dn\": \"inum=bd27a9f6-7772-4049-bd4f-bf7c651fbe7c,ou=clients,o=jans\", &gt;    \"deletable\": false, &gt;    \"clientSecret\": \"c0b5ce54-d1e0-4a22-999a-8bcd055a3bc2\", &gt;    \"frontChannelLogoutSessionRequired\": false, &gt;    \"redirectUris\": [ &gt;        \"https://abc,com\" &gt;    ], &gt;    \"responseTypes\": [ &gt;        \"code\" &gt;    ], &gt;    \"grantTypes\": [ &gt;        \"refresh_token\", &gt;        \"authorization_code\" &gt;    ], &gt;    \"applicationType\": \"web\", &gt;    \"clientName\": \"test1234\", &gt;    \"clientNameLocalized\": {}, &gt;    \"logoUriLocalized\": {}, &gt;    \"clientUriLocalized\": {}, &gt;    \"policyUriLocalized\": {}, &gt;    \"tosUriLocalized\": {}, &gt;    \"subjectType\": \"public\", &gt;    \"tokenEndpointAuthMethod\": \"client_secret_basic\", &gt;    \"scopes\": [ &gt;        \"inum=43F1,ou=scopes,o=jans\", &gt;        \"inum=C17A,ou=scopes,o=jans\", &gt;        \"inum=764C,ou=scopes,o=jans\" &gt;    ], &gt;    \"trustedClient\": false, &gt;    \"persistClientAuthorizations\": false, &gt;    \"includeClaimsInIdToken\": false, &gt;    \"customAttributes\": [], &gt;    \"customObjectClasses\": [ &gt;        \"top\", &gt;        \"jansClntCustomAttributes\" &gt;    ], &gt;    \"rptAsJwt\": false, &gt;    \"accessTokenAsJwt\": false, &gt;    \"disabled\": false, &gt;    \"attributes\": { &gt;        \"runIntrospectionScriptBeforeJwtCreation\": false, &gt;        \"keepClientAuthorizationAfterExpiration\": false, &gt;        \"allowSpontaneousScopes\": false, &gt;        \"backchannelLogoutSessionRequired\": false, &gt;        \"parLifetime\": 600, &gt;        \"requirePar\": false, &gt;        \"jansDefaultPromptLogin\": false &gt;    }, &gt;    \"backchannelUserCodeParameter\": false, &gt;    \"description\": \"test1234\", &gt;    \"displayName\": \"test1234\", &gt;    \"authenticationMethod\": \"client_secret_basic\", &gt;    \"tokenBindingSupported\": false, &gt;    \"baseDn\": \"inum=bd27a9f6-7772-4049-bd4f-bf7c651fbe7c,ou=clients,o=jans\", &gt;    \"inum\": \"bd27a9f6-7772-4049-bd4f-bf7c651fbe7c\" &gt;} &gt; ```","tags":["administration","tools","config-api","openid-connect client"]},{"location":"janssen-server/config-guide/config-tools/config-api/openid-client/#patching-existing-openid-connect-client","title":"Patching existing OpenID Connect client","text":"<code>PATCH</code> <code>/{inum}</code> <code>(patches an existing OpenID Connect client)</code>  ### Parameters  &gt; | name       |  param type | data type          | type      |default value | description                             | &gt; |------------|-------------|--------------------|-----------|--------------|-----------------------------------------| &gt; | inum       |  path       | string             | required  | NA           | OpenID Connect client unique identifier | &gt; | None       |  request    | json-patch object  | required  | NA           | json-patch request                      |   ### Responses  &gt; | http code     | content-type                      | response                                                               | &gt; |---------------|-----------------------------------|------------------------------------------------------------------------| &gt; | `200`         | `application/json        `        | `OpenID Connect client details`                                                    | &gt; | `404`         | `application/json`                | `{\"code\":\"404\",\"message\":\"The requested  doesn't exist\"}`        | &gt; | `401`         | `application/json`                | `{\"code\":\"401\",\"message\":\"Unauthorized\"}`                              | &gt; | `500`         | `application/json`                | `{\"code\":\"500\",\"message\":\"Error msg\"}`                                 |  ### Example cURL  &gt; <pre><code> curl -X PATCH -k -H 'Content-Type: application/json-patch+json' -H 'Authorization: Bearer ba9b8810-7a2b-4e4a-a18a-689d7eacf7d1' -i 'https://my.jans.server/jans-config-api/api/v1/openid/clients/f8c1a111-0919-47e8-a4d4-f7c18f73a644' --data @patch.json\n</code></pre>  ### Sample Request  &gt; <pre><code>[{ \"op\": \"replace\", \"path\": \"/responseTypes\", \"value\":[\"code\",\"token\"]}] \n</code></pre>","tags":["administration","tools","config-api","openid-connect client"]},{"location":"janssen-server/config-guide/config-tools/config-api/openid-client/#deleting-existing-openid-connect-client","title":"Deleting existing OpenID Connect client","text":"<code>DELETE</code> <code>/{inum}</code> <code>(deletes an existing OpenID Connect client)</code>  ### Parameters  &gt; | name       |  param type | data type          | type      |default value | description                             | &gt; |------------|-------------|--------------------|-----------|--------------|-----------------------------------------| &gt; | inum       |  path       | string             | required  | NA           | OpenID Connect client unique identifier |   ### Responses  &gt; | http code     | content-type                      | response                                                               | &gt; |---------------|-----------------------------------|------------------------------------------------------------------------| &gt; | `204`         | `application/json        `        | `No Content`                                                    | &gt; | `404`         | `application/json`                | `{\"code\":\"404\",\"message\":\"The requested  doesn't exist\"}`        | &gt; | `401`         | `application/json`                | `{\"code\":\"401\",\"message\":\"Unauthorized\"}`                              | &gt; | `500`         | `application/json`                | `{\"code\":\"500\",\"message\":\"Error msg\"}`                                 |  ### Example cURL  &gt; <pre><code> curl -X DELETE -k -H 'Content-Type: application/json' -H 'Authorization: Bearer ba9b8810-7a2b-4e4a-a18a-689d7eacf7d1' -i 'https://my.jans.server/jans-config-api/api/v1/openid/clients/f8c1a111-0919-47e8-a4d4-f7c18f73a644'\n</code></pre>  ### Sample Request &gt; None","tags":["administration","tools","config-api","openid-connect client"]},{"location":"janssen-server/config-guide/config-tools/config-api/plugins/","title":"Config-api","text":"<p>Jans Config Api is a REST application that is developed using Weld 4.x (JSR-365) and JAX-RS. Its endpoint can be used to manage configuration and other properties of Jans Auth Server.</p>","tags":["administration","tools","config-api","plugins"]},{"location":"janssen-server/config-guide/config-tools/config-api/plugins/#jans-config-api-plugins","title":"Jans Config API Plugins","text":"<p>Jans Config API follow a flexible plugin architecture in which the new features can be added using extensions called plugins without altering the application itself. In this section, we will discuss the steps to develop and add plugins in Jans Config API.</p> <p>The plugin architecture implemented in Jans Config API allows the deployer to add/remove new rest APIs (plugin) without changing the core application. A plugin contains one or more Rest API(s) packaged in a Java ARchive (jar file). It is added to Jans Config API by adding the plugin jar file path in the external extraClasspath of the jetty context file.</p>","tags":["administration","tools","config-api","plugins"]},{"location":"janssen-server/config-guide/config-tools/config-api/plugins/#pre-requisites","title":"Pre-requisites","text":"<p>The plugin developer should have an understanding of the following:</p> <ul> <li>Jakarta EE Platform: The plugin developer should know the Java programming language</li> <li>Weld: Weld is the reference implementation of CDI: Contexts and Dependency Injection for the Java EE Platform</li> <li>JAX-RS: JAX-RS for creating RESTful web services.</li> <li>Maven: Maven to build projects and manage dependencies. </li> <li>Web application container (Jetty)</li> </ul>","tags":["administration","tools","config-api","plugins"]},{"location":"janssen-server/config-guide/config-tools/config-api/plugins/#sample-plugin","title":"Sample plugin","text":"<p>To help bootstrap the plugin development, we have put together a sample plugin.</p> <ol> <li>Clone the Jans Config API project from here.</li> <li>Navigate under the plugins/sample folder.</li> <li>This folder contains the sample plugins for reference.</li> <li><code>helloworld</code> folder for example contains the code for a basic plugin with GET endpoint sending <code>Hello World!</code> string response.</li> <li>Take the time to explore <code>helloworld</code> which is a minimalistic plugin that showcases very basic aspects of plugin development.</li> </ol>","tags":["administration","tools","config-api","plugins"]},{"location":"janssen-server/config-guide/config-tools/config-api/plugins/#exploring-hello-world-plugin","title":"Exploring Hello World Plugin","text":"","tags":["administration","tools","config-api","plugins"]},{"location":"janssen-server/config-guide/config-tools/config-api/plugins/#beansxml","title":"beans.xml","text":"<p>The <code>resources/META-INF/beans.xml</code> is the CDI deployment descriptor required in <code>bean archive</code>. Deployment descriptor helps WELD to explore beans, interceptors, decorators, etc in the <code>bean archive</code>. Refer to the WELD docs to learn more about deployment descriptors.</p>","tags":["administration","tools","config-api","plugins"]},{"location":"janssen-server/config-guide/config-tools/config-api/plugins/#helloworldextensionjava","title":"HelloWorldExtension.java","text":"<p>A CDI portable extension is a mechanism by which we can implement additional functionalities on top of the CDI container. In this sample plugin, we have created an extension called <code>HelloWorldExtension.java</code>, implementing <code>jakarta.enterprise.inject.spi.Extension</code>. An extension can observe lifecycle events and also can modify the container\u2019s metamodel. Please refer to the WELD documentation for details.</p> <p>We need to register our extension as a service provider by creating a file named <code>resources/META-INF/services/jakarta.enterprise.inject.spi.Extension</code> (as shown below).</p> <p>com.spl.plugin.helloworld.ext.HelloWorldExtension</p>","tags":["administration","tools","config-api","plugins"]},{"location":"janssen-server/config-guide/config-tools/config-api/plugins/#helloworldapplicationjava","title":"HelloWorldApplication.java","text":"<p>The <code>com.spl.plugin.helloworld.rest.HelloWorldApplication.java</code> class is annotated with the <code>@ApplicationPath</code> annotation which identifies the application path that serves as the base URI for all resources of the plugin and is used to register JAX-RS resources and providers.</p>","tags":["administration","tools","config-api","plugins"]},{"location":"janssen-server/config-guide/config-tools/config-api/plugins/#helloworldresourcejava","title":"HelloWorldResource.java","text":"<p>This is a sample JAX-RS resource with an endpoint returning <code>Hello World!</code> string as http response.</p>","tags":["administration","tools","config-api","plugins"]},{"location":"janssen-server/config-guide/config-tools/config-api/plugins/#plugin-deployment","title":"Plugin Deployment","text":"<p>Jans Config API is offered as one of the several components of the Jans Auth Server. A plugin jar can be added to Jans Config API by following below steps.</p> <ol> <li>On an installed Jans Auth Server with Jans Config API (as component) copy plugin jar to <code>/opt/jans/jetty/jans-config-api/custom/libs</code> location.</li> <li>Add the location of plugin jar inside tag with name extraClasspath (multiple plugins can be added comma separated) of <code>/opt/jans/jetty/jans-config-api/webapps/jans-config-api.xml</code> file.</li> </ol> <pre><code>&lt;?xml version=\"1.0\"  encoding=\"ISO-8859-1\"?&gt;\n&lt;!DOCTYPE Configure PUBLIC \"-//Jetty//Configure//EN\" \"http://www.eclipse.org/jetty/configure_9_0.dtd\"&gt;\n\n&lt;Configure class=\"org.eclipse.jetty.webapp.WebAppContext\"&gt;\n      &lt;Set name=\"contextPath\"&gt;/jans-config-api&lt;/Set&gt;\n      &lt;Set name=\"war\"&gt;\n              &lt;Property name=\"jetty.webapps\" default=\".\" /&gt;/jans-config-api.war\n      &lt;/Set&gt;\n      &lt;Set name=\"extractWAR\"&gt;true&lt;/Set&gt;\n\n      &lt;Set name=\"extraClasspath\"&gt;/opt/jans/jetty/jans-config-api/custom/libs/helloWorldjar&lt;/Set&gt;\n\n&lt;/Configure&gt;\n</code></pre> <ol> <li>Restart <code>jans-config-api</code> service.</li> </ol> <pre><code>systemctl restart jans-config-api.service\n</code></pre>","tags":["administration","tools","config-api","plugins"]},{"location":"janssen-server/config-guide/config-tools/config-api/security/","title":"Security","text":"","tags":["administration","tools","config-api","security"]},{"location":"janssen-server/config-guide/config-tools/config-api/security/#security","title":"Security","text":"","tags":["administration","tools","config-api","security"]},{"location":"janssen-server/config-guide/config-tools/config-api/security/#disclosing-vulnerabilities","title":"Disclosing vulnerabilities","text":"<p>If you think you found a security vulnerability, please refrain from posting it publicly on the forums, the chat, or GitHub. Instead, email us on security@jans.io.</p> <p>Refer to Janssen Security Policy</p>","tags":["administration","tools","config-api","security"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/","title":"Janssen CLI","text":"<p><code>jans-cli</code> module is a command-line interface for configuring the Janssen Server. This module interacts with Janssen Server via RESTful configuration APIs that server exposes. <code>jans-cli</code> can be used to retrieve and update configuration of Janssen Server.</p>","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/#installation","title":"Installation","text":"","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/#on-the-janssen-server","title":"On The Janssen Server","text":"<p>On a Janssen Server instance, the <code>jans-cli</code> will be already installed.</p> <p>It can be invoked executing following command on Janssen Server.</p> <pre><code>/opt/jans/jans-cli/config-cli.py\n</code></pre>","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/#stand-alone-installation","title":"Stand-alone Installation","text":"<p><code>jans-cli</code> can be installed on any other machine and then use it to configure remote server where Janssen Server is installed.</p> <ul> <li>Follow these instructions and create a self-executable file</li> <li>Run the file as shown in the example below to enter CLI mode. Here, supplying the argument <code>--no-tui</code> is necessary,   otherwise it will switch to TUI mode.    <pre><code>$ ./jans-cli-tui.pyz --no-tui --host test.jans.io --client-id 2000.562981df-1623-4136-b1d0-aaa277edc48c --client-secret KU6ydImJZK6S --operation-id get-acrs\nPlease wait while retrieving data ...\nAccess token was not found.\nPlease visit verification url https://test.jans.io/device-code?user_code=LKHC-PBTR and authorize this device within 1800 secods\nPlease press \u00abEnter\u00bb when ready\n{\n  \"defaultAcr\": \"simple_password_auth\"\n}\n</code></pre></li> </ul>","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/#cli-tool-configuration","title":"CLI Tool Configuration","text":"<p>Janssen CLI tool stores its configuration under <code>&lt;install-path&gt;/.config</code> directory. Various settings for CLI tool can be found under this directory, for example logging levels.</p> <p>This directory also contains SALT used by Janssen CLI tool.</p>","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/#cli-authorization","title":"CLI Authorization","text":"<p>To run operations on Janssen Server, CLI client will need to be authenticated and authorized by the server. Since CLI has limited input capabilities, it uses Device Authorization Grant flow to get required permissions in form of an access token. After successfully receiving the token, CLI can run operations on the Janssen server while the token is valid. The steps below will summarize this process.</p> <ol> <li>Execution of CLI command will return the following message if a valid token is not found.    <pre><code>Access token was not found.\nPlease visit verification url &lt;Janssen-server-device-code-url&gt; and enter user code CGFZ-RTZR in 1800 seconds\nPlease press &lt;&lt;Enter&gt;&gt; when ready\n</code></pre></li> <li>Take <code>&lt;Janssen-server-device-code-url&gt;</code> from the message above and use any browser to access it from a different device</li> <li>User will be presented with a page where the user has to authenticate using id and password</li> <li>After successful user authentication, the next screen allows the user to enter the user code. Use the user code presented on command-line instruction in step 1 above.</li> <li>After successful code validation, the user is presented with OAuth permissions screen. This screen would list all the permissions requested by Jans CLI. The user can choose to <code>Allow</code> or <code>Not Allow</code> granting of these permissions.</li> <li>After allowing the grant of requested permissions, the user should come back to the command-line interface and hit &lt;&gt; as instructed. This will enable CLI to run operations on the corresponding Janssen server.","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/#getting-help","title":"Getting Help","text":"<p>CLI <code>--help</code> switch prints all options available from CLI to configure Janssen Server. Run command below</p> <p><pre><code>/opt/jans/jans-cli/config-cli.py --help\n</code></pre> To see all options as below: <pre><code>usage: config-cli.py [-h] [--host HOST] [--client-id CLIENT_ID] [--client-secret CLIENT_SECRET] [--access-token ACCESS_TOKEN] [--plugins PLUGINS] [-debug] [--debug-log-file DEBUG_LOG_FILE]\n                     [--operation-id OPERATION_ID] [--url-suffix URL_SUFFIX]\n                     [--info {AdminUiConfiguration,AdminUiLicense,AdminUiPermission,AdminUiRole,AdminUiRolePermissionsMapping,AdminUiWebhooks,Agama,AgamaConfiguration,Attribute,AuthServerHealthCheck,AuthSessionManagement,CacheConfiguration,CacheConfigurationInMemory,CacheConfigurationMemcached,CacheConfigurationNativePersistence,CacheConfigurationRedis,ClientAuthorization,ConfigurationConfigApi,ConfigurationJwkJsonWebKeyJwk,ConfigurationLogging,ConfigurationProperties,ConfigurationSmtp,ConfigurationUserManagement,CustomScripts,DatabaseLdapConfiguration,DefaultAuthenticationMethod,Fido2Configuration,Fido2Registration,HealthCheck,JansAssets,JansLinkConfiguration,KcLinkConfiguration,LockAudit,LockConfiguration,LockLog,MessageConfiguration,MessageConfigurationPostgres,MessageConfigurationRedis,OauthOpenidConnectClients,OauthScopes,OauthUmaResources,OrganizationConfiguration,Plugins,SamlConfiguration,SamlIdentityBroker,SamlTrustRelationship,ScimConfigManagement,StatisticsUser,Token}]\n                     [--op-mode {get,post,put,patch,delete}] [--endpoint-args ENDPOINT_ARGS] [--schema-sample SCHEMA_SAMPLE] [--schema SCHEMA] [-CC CONFIG_API_MTLS_CLIENT_CERT]\n                     [-CK CONFIG_API_MTLS_CLIENT_KEY] [--key-password KEY_PASSWORD] [-noverify] [-use-test-client] [--patch-add PATCH_ADD] [--patch-replace PATCH_REPLACE] [--patch-remove PATCH_REMOVE]\n                     [-no-color] [--log-dir LOG_DIR] [--tmp-dir TMP_DIR] [-revoke-session] [-scim] [-auth] [--data DATA] [--output-access-token]\n\noptions:\n  -h, --help            show this help message and exit\n  --host HOST           Hostname of server\n  --client-id CLIENT_ID\n                        Jans Config Api Client ID\n  --client-secret CLIENT_SECRET, --client_secret CLIENT_SECRET\n                        Jans Config Api Client ID secret\n  --access-token ACCESS_TOKEN\n                        JWT access token or path to file containing JWT access token\n  --plugins PLUGINS     Available plugins separated by comma\n  -debug                Run in debug mode\n  --debug-log-file DEBUG_LOG_FILE\n                        Log file name when run in debug mode\n  --operation-id OPERATION_ID\n                        Operation ID to be done\n  --url-suffix URL_SUFFIX\n                        Argument to be added api endpoint url. For example inum:2B29\n  --info {AdminUiConfiguration,AdminUiLicense,AdminUiPermission,AdminUiRole,AdminUiRolePermissionsMapping,AdminUiWebhooks,Agama,AgamaConfiguration,Attribute,AuthServerHealthCheck,AuthSessionManagement,CacheConfiguration,CacheConfigurationInMemory,CacheConfigurationMemcached,CacheConfigurationNativePersistence,CacheConfigurationRedis,ClientAuthorization,ConfigurationConfigApi,ConfigurationJwkJsonWebKeyJwk,ConfigurationLogging,ConfigurationProperties,ConfigurationSmtp,ConfigurationUserManagement,CustomScripts,DatabaseLdapConfiguration,DefaultAuthenticationMethod,Fido2Configuration,Fido2Registration,HealthCheck,JansAssets,JansLinkConfiguration,KcLinkConfiguration,LockAudit,LockConfiguration,LockLog,MessageConfiguration,MessageConfigurationPostgres,MessageConfigurationRedis,OauthOpenidConnectClients,OauthScopes,OauthUmaResources,OrganizationConfiguration,Plugins,SamlConfiguration,SamlIdentityBroker,SamlTrustRelationship,ScimConfigManagement,StatisticsUser,Token}\n                        Help for operation\n  --op-mode {get,post,put,patch,delete}\n                        Operation mode to be done\n  --endpoint-args ENDPOINT_ARGS\n                        Arguments to pass endpoint separated by comma. For example limit:5,status:INACTIVE\n  --schema-sample SCHEMA_SAMPLE\n                        Get sample json schema template\n  --schema SCHEMA       Get the operation schema which describes all the keys of the schema and its values in detail.\n  -CC CONFIG_API_MTLS_CLIENT_CERT, --config-api-mtls-client-cert CONFIG_API_MTLS_CLIENT_CERT\n                        Path to SSL Certificate file\n  -CK CONFIG_API_MTLS_CLIENT_KEY, --config-api-mtls-client-key CONFIG_API_MTLS_CLIENT_KEY\n                        Path to SSL Key file\n  --key-password KEY_PASSWORD\n                        Password for SSL Key file\n  -noverify             Ignore verifying the SSL certificate\n  -use-test-client      Use test client without device authorization\n  --patch-add PATCH_ADD\n                        Colon delimited key:value pair for add patch operation. For example loggingLevel:DEBUG\n  --patch-replace PATCH_REPLACE\n                        Colon delimited key:value pair for replace patch operation. For example loggingLevel:DEBUG\n  --patch-remove PATCH_REMOVE\n                        Key for remove patch operation. For example imgLocation\n  -no-color             Do not colorize json dumps\n  --log-dir LOG_DIR     Log directory\n  --tmp-dir TMP_DIR     Directory for storing temporary files\n  -revoke-session       Revokes session\n  -scim                 SCIM Mode\n  -auth                 Jans OAuth Server Mode\n  --data DATA           Path to json data file\n  --output-access-token\n                        Prints jwt access token and exits\n</code></pre></p>","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/#cli-command-structure","title":"CLI Command Structure","text":"<p>CLI operations are structurally grouped by <code>Operation Modes</code> and within these modes, they are logically grouped together by tasks. Diagram below depicts this structure.</p> <p></p>","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/#operation-modes","title":"Operation Modes","text":"<p>CLI offer three operation modes, JCA, SCIM and AUTH. JCA is the default mode. To use SCIM and AUTH modes, the CLI command specifies <code>-scim</code> or <code>-auth</code> switches. Use <code>-h</code> switch to get help on each mode.</p> <pre><code>/opt/jans/jans-cli/config-cli.py -scim -h\n</code></pre> <p>The modes usually have different task(and hence operations).</p>","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/#tasks","title":"Tasks","text":"<p><code>Tasks</code> are logical grouping of operation-ids so that users can easily list all the operational-ids relevant to a particular aspect of Janssen Server configuration using <code>--info</code> switch. For instance, all the operation-ids related to attribute management are grouped under <code>attribute</code> task. As mentioned, tasks are logical groupings, they don't perform any operation on the server. Tasks can only be used with <code>--info</code> switch.</p> <p>Execute following command to see what all tasks are offered by jans-cli:</p> <pre><code>/opt/jans/jans-cli/config-cli.py --help\n</code></pre> <p>Options listed for <code>--info</code> switch are tasks groups available. For example:</p> <pre><code>usage: config-cli.py [-h] [--host HOST] [--client-id CLIENT_ID] [--client-secret CLIENT_SECRET] [--access-token ACCESS_TOKEN] [--plugins PLUGINS] [-debug] [--debug-log-file DEBUG_LOG_FILE]\n                     [--operation-id OPERATION_ID] [--url-suffix URL_SUFFIX]\n                     [--info {AdminUiConfiguration,AdminUiLicense,AdminUiPermission,AdminUiRole,AdminUiRolePermissionsMapping,AdminUiWebhooks,Agama,AgamaConfiguration,Attribute,AuthServerHealthCheck,AuthSessionManagement,CacheConfiguration,CacheConfigurationInMemory,CacheConfigurationMemcached,CacheConfigurationNativePersistence,CacheConfigurationRedis,ClientAuthorization,ConfigurationConfigApi,ConfigurationJwkJsonWebKeyJwk,ConfigurationLogging,ConfigurationProperties,ConfigurationSmtp,ConfigurationUserManagement,CustomScripts,DatabaseLdapConfiguration,DefaultAuthenticationMethod,Fido2Configuration,Fido2Registration,HealthCheck,JansAssets,JansLinkConfiguration,KcLinkConfiguration,LockAudit,LockConfiguration,LockLog,MessageConfiguration,MessageConfigurationPostgres,MessageConfigurationRedis,OauthOpenidConnectClients,OauthScopes,OauthUmaResources,OrganizationConfiguration,Plugins,SamlConfiguration,SamlIdentityBroker,SamlTrustRelationship,ScimConfigManagement,StatisticsUser,Token}]\n                     [--op-mode {get,post,put,patch,delete}] [--endpoint-args ENDPOINT_ARGS] [--schema-sample SCHEMA_SAMPLE] [--schema SCHEMA] [-CC CONFIG_API_MTLS_CLIENT_CERT]\n                     [-CK CONFIG_API_MTLS_CLIENT_KEY] [--key-password KEY_PASSWORD] [-noverify] [-use-test-client] [--patch-add PATCH_ADD] [--patch-replace PATCH_REPLACE] [--patch-remove PATCH_REMOVE]\n                     [-no-color] [--log-dir LOG_DIR] [--tmp-dir TMP_DIR] [-revoke-session] [-scim] [-auth] [--data DATA] [--output-access-token]\n</code></pre> <p>To see operation-id available under a task, execute the command below with the task name as an argument:</p> <pre><code>/opt/jans/jans-cli/config-cli.py --info Attribute\n</code></pre> <p>Above will list all the operations under <code>Attribute</code> group.</p> <pre><code>Operation ID: get-attributes\n  Description: Gets a list of Jans attributes.\n  Parameters:\n  limit: Search size - max size of the results to return [integer]\n  pattern: Search pattern [string]\n  status: Status of the attribute [string]\n  startIndex: The 1-based index of the first query result [integer]\n  sortBy: Attribute whose value will be used to order the returned response [string]\n  sortOrder: Order in which the sortBy param is applied. Allowed values are \"ascending\" and \"descending\" [string]\n  fieldValuePair: Field and value pair for seraching [string]\nOperation ID: put-attributes\n  Description: Updates an existing attribute\n  Schema: JansAttribute\nOperation ID: post-attributes\n  Description: Adds a new attribute\n  Schema: JansAttribute\nOperation ID: get-attributes-by-inum\n  Description: Gets an attribute based on inum\n  Parameters:\n  inum: Attribute Id [string]\nOperation ID: delete-attributes-by-inum\n  Description: Deletes an attribute based on inum\n  Parameters:\n  inum: Attribute Id [string]\nOperation ID: patch-attributes-by-inum\n  Description: Partially modify a JansAttribute\n  Parameters:\n  inum: Attribute Id [string]\n  Schema: Array of PatchRequest\n</code></pre>","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/#operation-ids","title":"Operation-ids","text":"<p>jans-cli's unit of work, or a command, is known as <code>operation-id</code>. Each operation id is a configuration retrieval/update action on the Janssen Server. For example: <code>get-attributes</code> is an operation that <code>Gets a list of Janssen Server attributes</code>.</p> <p>To perform any operation, you have to run command line with the operation id. For example:</p> <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id get-acrs\n</code></pre> <p>It returns:</p> <pre><code>Getting access token for scope https://jans.io/oauth/config/acrs.readonly\n{\n  \"defaultAcr\": \"simple_password_auth\"\n}\n</code></pre> <p>Certain operations need data to be able to execute while for others just the operation id is enough. For instance in above example <code>get-acrs</code> operation did not require any data to be passed and worked only with operation id. While operations like <code>delete-attributes-by-inum</code>, <code>post-attributes</code> need additional data to be able to execute. For example, for <code>delete-attributes-by-inum</code> to execute, it needs to know the <code>inum</code> of the attribute to be deleted.</p> <p>For operations which need data the data elements are passed to the operation in form of <code>parameters</code> and/or <code>schema</code>. Operation description provided by <code>--info</code> switch details out what parameters and schemas are applicable to each operation.</p> <p><code>Parameters</code> allow simple string-based values to be passed to the operation, while <code>schema</code> allows JSON structured-data to be passed to the operation. For examples of how operations can be used with parameters and schema, refer to Attribute. Read more about schema in this detail section.</p>","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/#basic-command-line-switches","title":"Basic command-line switches","text":"<ol> <li><code>-h</code> or <code>--help</code> to get all the formations of command line argument (ex; <code>/opt/jans/jans-cli/config-cli.py -h</code>)</li> <li><code>--info</code> to get formations about some operations id for a specific task (ex; <code>opt/jans/jans-cli/config-cli.py --info User</code>)</li> <li><code>--operation-id</code> usage to operate each of the sub-task</li> <li><code>--endpoint-args</code> advanced usage for operation-id</li> <li><code>--data</code> usage to share data in operations</li> </ol>","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/#about-schemas","title":"About Schemas","text":"","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/#patch-request-schema","title":"Patch Request (schema)","text":"<p>This schema file can be found in <code>/components/schemas/PatchRequest</code> for those which one support this operation.</p> <p>When you examine this sample schema, you will see three properties in an object: op, path, and value.</p> <ul> <li>op: operation to be done, one of <code>add</code>, <code>remove</code>, <code>replace</code>, <code>move</code>, <code>copy</code>, <code>test</code></li> <li>path: Path of the property to be changed. use path separator <code>/</code> for config or <code>.</code> for SCIM to change a property inside an object.</li> <li>value: New value to be assigned for each property defined in <code>path</code></li> </ul>","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/#multiple-patch-request-schema","title":"Multiple Patch Request (schema)","text":"<p>When we need to perform multiple patch operations on any configuration endpoint, Instead of doing one by one, we can create a json file including all individual operation into an array. To clarify, please see below json file:</p> <pre><code>[\n    {\n        \"op\": \"operation-name\",\n        \"path\": \"configuration-path\",\n        \"value\": \"Value\"\n    },\n    {\n        \"op\": \"operation-name\",\n        \"path\": \"configuration-path\",\n        \"value\": \"value\"\n    },\n    {\n        \"op\": \"operation-name\",\n        \"path\": \"configuration-path\",\n        \"value\": \"value\"\n    }\n    ...\n    ...\n    ...\n    {\n        \"op\": \"operation-name\",\n        \"path\": \"configuration-path\",\n        \"value\": \"value\"\n    }\n]\n</code></pre> <p>This file contains multiple individual patch operation. In Patch Request (schema) we explained about each of these keys in the above json file.</p> <p>After creating the json file, just run the patch operation command.</p> <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id [patch operation id name] --data [json file absolute url]\n</code></pre>","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-cli/#quick-patch-operations","title":"Quick Patch Operations","text":"<p>There is another patch request feature. It is a single line patch-request command line. It supports three types of operations:</p> <ul> <li><code>patch-replace</code>: to replace value with new one.</li> <li><code>patch-add</code>: it will add value into the key path.</li> <li><code>patch-remove</code>: to remove value from any key path.</li> </ul> <p>The command line looks like below:</p> <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id [patch-operation-id] --[patch-operation-name] key:value\n</code></pre> <p>for example:</p> <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id patch-config-cache --patch-replace memcachedConfiguration/bufferSize:32788\n</code></pre> <p>In this command line: - <code>patch-config-cache</code> is a operation-id from Cache Configurations task. - <code>patch-replace</code> type of operation; used to replace values in - <code>memcachedConfiguration/bufferSize:32788</code> is a <code>key:value</code> pair</p> <p>Multi valued arguments can be provided as <code>key:value1,key:value2</code>, for example <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id=get-config-scripts  --endpoint-args=\"fieldValuePair:scriptType=dynamic_scope,fieldValuePair:level=100\"\n</code></pre></p>","tags":["administration","configuration","tools","cli","commandline"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/","title":"TUI - Text based User Interface","text":"<p>The \"Text User Interface\" or \"TUI\" is a tool for admins to perform ad hoc configuration of the Janssen Project software components.</p> <p>You can run it by executing:</p> <pre><code>sudo /opt/jans/jans-cli/jans_cli_tui.py\n</code></pre> <p>The TUI calls the Jans Config API. A TUI client is configured out of the box when you run either the VM or container Jans setup. The TUI utilizes the OAuth Device Flow for user authentication--the default <code>admin</code> user created during setup has the correct roles to use all the TUI features. Client credentials, tokens and other data is stored in file <code>~/.config/jans-cli.ini</code> in encoded format. The user-role mappings roles are defined in a Jans Auth Server introspection script</p> <pre><code>~/.config/jans-cli.ini\n</code></pre>","tags":["administration","configuration","tools","config","tui","text base UI"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/#plugins","title":"Plugins","text":"<p>It's possible to extend the TUI by writing a plugin. Each plugin is loaded dynamically according to the numeric priority of the folders in <code>/opt/jans/jans-cli/plugins</code>. To enable a plugin, you need to edit <code>jans-cli.ini</code>. The default plugins are:</p> <pre><code>jca_plugins = user-mgt,scim,fido2,admin-ui\n</code></pre>","tags":["administration","configuration","tools","config","tui","text base UI"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/#administration","title":"Administration","text":"<p>When you run the TUI, this is the home panel: </p>","tags":["administration","configuration","tools","config","tui","text base UI"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/#auth-server","title":"Auth Server","text":"<p>The most complicated configuration belongs to Auth Server. This should be no surprise, because this component is responsible for the implementation of OpenID Provider, OAuth Authorization Server, and UMA Authorization Server endpoints.</p> <ul> <li>In below screenshot, we are getting the list of existing clients. </li> <li>It's possible to get details of any client as well. Just hit enter on any client and  you will see information like this. </li> <li>With the button which is located on right upper side named \"Add Client\", it's possible to create new client. </li> </ul>","tags":["administration","configuration","tools","config","tui","text base UI"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/#fido","title":"FIDO","text":"<p>The Janssen FIDO Server implements FIDO 2 and FIDO U2F endpoints. Using the TUI, you can view/update details of the FIDO configuration.</p> <p>There are two configurations included here:</p> <ul> <li>Dynamic Configuration </li> <li>Static Configuration </li> </ul>","tags":["administration","configuration","tools","config","tui","text base UI"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/#scim","title":"SCIM","text":"<p>System for Cross-domain Identity Management, in short SCIM, is a specification that simplifies the exchange of user identity information across different domains. The Janssen Server provides implementation for the SCIM specification.</p> <p>With Janssen CLI-TUI, it's possible to view / update SCIM configuration. </p>","tags":["administration","configuration","tools","config","tui","text base UI"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/#command-line-logs","title":"Command Line Logs","text":"<p>Jans TUI logs all write (post/put/patch) activities to file <code>&lt;log-dir&gt;/cli_cmd.log</code>, default <code>log-dir</code> is home directory of user executing TUI. Consider that we create a user as below</p> <p></p> <p>We will have following line in <code>cli_cmd.log</code>:</p> <pre><code>/usr/bin/python3 /opt/jans/jans-cli/cli/config_cli.py --operation-id post-user --data '{\"customObjectClasses\": [\"top\", \"jansPerson\"], \"customAttributes\": [{\"name\": \"middleName\", \"multiValued\": false, \"values\": [\"\"]}, {\"name\": \"sn\", \"multiValued\": false, \"values\": [\"Watts\"]}, {\"name\": \"nickname\", \"multiValued\": false, \"values\": [\"\"]}], \"mail\": \"ewatts@foo.org\", \"userId\": \"ewatts\", \"displayName\": \"Emelia Watts\", \"givenName\": \"Emelia\", \"userPassword\": \"TopSecret\", \"jansStatus\": \"active\"}'\n</code></pre> <p>By using this line, you can create user via <code>jans-config.py</code>, see for example</p>","tags":["administration","configuration","tools","config","tui","text base UI"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/#standalone-installation","title":"Standalone Installation","text":"<p>Configure the Janssen server using the <code>jans-cli-tui</code> a Text based User Interface app which can be installed on any remote Linux machine. There are two ways of achieving this:</p>","tags":["administration","configuration","tools","config","tui","text base UI"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/#1-build-pyz-self-executable-file","title":"1. Build pyz self executable file","text":"<pre><code>pip3 install shiv\nwget https://github.com/JanssenProject/jans/archive/refs/heads/main.zip -O jans-main.zip\nunzip jans-main.zip\ncd jans-main/jans-cli-tui/\nmake zipapp\n</code></pre> <p>After build you can execute as</p> <pre><code>./jans-cli-tui.pyz\n</code></pre> <p>You will be prompted for credentials if you do not have <code>~/.config/jans-cli.ini</code>. Contact your administrator for credentials. Administrator can obtain credentials on Janssen Server as follows:</p> <pre><code>cat /opt/jans/jans-setup/setup.properties.last | grep tui_client\ntui_client_encoded_pw=4jnkODv3KRV6xNm1oGQ8+g\\=\\=\ntui_client_id=2000.eac308d1-95e3-4e38-87cf-1532af310a9e\ntui_client_pw=GnEkCqg4Vsks\n</code></pre> <p><code>tui_client_id</code> is the Client ID and <code>tui_client_pw</code> is the Client Secret</p>","tags":["administration","configuration","tools","config","tui","text base UI"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/#2-installing-with-pip-from-github","title":"2. Installing with pip from GitHub","text":"<pre><code>pip3 install https://github.com/JanssenProject/jans/archive/refs/heads/main.zip#subdirectory=jans-cli-tui\n</code></pre> <p>Execute:</p> <pre><code>jans-cli-tui\n</code></pre>","tags":["administration","configuration","tools","config","tui","text base UI"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/navigation-guide/","title":"TUI Navigation Guide","text":"","tags":["administration","configuration","tools","tui","text base UI","navigation"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/navigation-guide/#general-structure","title":"General Structure:","text":"<ol> <li>The TUI consists of many tabs, each tab may or may not contain nested tabs.</li> <li>The TUI consists of one main navigation bar which contains (Auth Server, FIDO, SCIM, Scripts, Users, and Jans CLI)</li> </ol> <ol> <li>The tab currently in focus is highlighted at the top. ex:</li> </ol> <p>Note:</p> <ul> <li>in the image provided below <code>SCIM</code> is focused </li> <li>We can notice that there is a cursor mark on the first of the Navigation bar line, which indicates that the focus currently in this widget </li> </ul>","tags":["administration","configuration","tools","tui","text base UI","navigation"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/navigation-guide/#general-purpose-shortcuts","title":"General Purpose shortcuts","text":"<ul> <li><code>f1</code> : Open help dialog (currently, help dialog is static, in the near future it will dynamically change according to the current position inside the TUI )</li> </ul> <ul> <li><code>ESC</code> : Close any dialog or even nested dialog</li> </ul> <ul> <li><code>Ctrl+c</code>(Terminate) : Terminate the program (SIGINT)</li> </ul> <p>Note</p> <p>Configuration changes made through the CLI or Config-API may not immediately reflect in the current view of the TUI. To refresh the interface and see the latest updates, you can either switch to a different TUI tab and return, or restart the TUI application. TUI fetches configuration data from the backend server at the start of the TUI session. So, a restart of TUI will load fresh data.</p>","tags":["administration","configuration","tools","tui","text base UI","navigation"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/navigation-guide/#navigation-shortcuts","title":"Navigation Shortcuts","text":"","tags":["administration","configuration","tools","tui","text base UI","navigation"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/navigation-guide/#general-navigation-shortcuts","title":"General Navigation shortcuts","text":"<ul> <li><code>tab</code>(Next): focus on the next field or widget.  </li> </ul> <ul> <li><code>shift + tab</code>(Previous): focus on the previous field or widget  </li> </ul> <ul> <li><code>PageUp</code>(Next tab): Jump to the next tab in dialogs (ex: Client dialog)</li> </ul> <p>Note: * the focus must be inside the current tab  In the Gif provided, the focus was inside the tab itself before we can press the <code>PageUp</code> key  If the focus is on the tab name itself, we can navigate to other tabs by the <code>Up</code> key and <code>Down</code> key  </p> <p></p> <ul> <li><code>PageDown</code>(Previous tab) : Jump to the previous tab in dialogs (ex: Client dialog) Note:  </li> <li>the focus must be inside the current tab  </li> <li>In the Gif provided, the focus was inside the tab itself before we can press the <code>PageDown</code> key  </li> <li>If the focus is on the tab name itself, we can navigate to other tabs by the <code>Up</code> key and <code>Down</code> key  </li> </ul> <p></p>","tags":["administration","configuration","tools","tui","text base UI","navigation"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/navigation-guide/#main-tabs-navigation-shortcuts","title":"Main tabs Navigation shortcuts","text":"<ul> <li><code>Alt + key</code> You can navigate to any tab inside the TUI by using the <code>Alt</code> key followed by a certain letter from the tab you want to navigate too  </li> </ul> <p>Note: * the colored character inside each Tab name is the specified letter for the navigation. * you can't navigate from a tab in the main top navigation bar to a nested navigation bar inside another tab, you must navigate to it first.  </p> <p>examples on the navigation letters for the main navigation bar:</p> <ul> <li><code>Auth Server</code> -&gt; <code>A</code> </li> <li><code>FIDO</code> -&gt; <code>F</code> </li> <li><code>SCIM</code> -&gt; <code>C</code> </li> <li><code>Scripts</code> -&gt; <code>r</code> </li> <li><code>Users</code> -&gt; <code>U</code> </li> <li><code>Jans CLI</code> -&gt; <code>J</code> </li> </ul> <p></p>","tags":["administration","configuration","tools","tui","text base UI","navigation"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/navigation-guide/#custom-widget-shortcuts","title":"Custom widget shortcuts","text":"<p>Note: * This section contains any widgets with special shortcuts and behavior  </p>","tags":["administration","configuration","tools","tui","text base UI","navigation"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/navigation-guide/#lists-vertical-nav-bar","title":"Lists (Vertical Nav bar)","text":"<p>currently, we have about 6 List widgets</p> <p>Note: * Any list widget can be navigated between its items by the <code>Up</code> key and <code>Down</code> key * There are some shortcuts here that can be used in most but not all List widgets  </p> <ul> <li> <p><code>delete</code>: can be used to delete a certain item</p> </li> <li> <p><code>d</code>: can be used to view all the selected item data in the <code>JSON</code> format</p> </li> <li> <p><code>Enter</code>: can be used to edit the current item</p> </li> </ul> <p>ex:</p> <p></p> <ul> <li><code>p</code>:  can be used to update user's password. </li> </ul> <p></p>","tags":["administration","configuration","tools","tui","text base UI","navigation"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/navigation-guide/#date-widgets","title":"Date Widgets","text":"<p>The date widget can be used to select a date and time. ex (Client Expiration Date)</p> <p></p> <ul> <li><code>tab</code>, <code>shift + tab</code>: can be used to navigate between date and time</li> </ul> <p></p> <ul> <li><code>Up</code>, <code>Down</code>, <code>Right</code>, and <code>Left</code> arrows: can be used to change the date and time</li> </ul> <p>Note: * in the <code>date</code> section, if you navigate to the right border and then pressed <code>Right</code>, the year will be increased.  in the <code>date</code> section, if you navigate to the left border and then pressed <code>Left</code>, the year will be decreased.  in the <code>date</code> section, if you navigate to the up border and then pressed <code>Up</code>, the month will be decreased. * in the <code>date</code> section, if you navigate to the down border and then pressed <code>Down</code>, the month will be increased.  </p> <p></p> <ul> <li>in the <code>time</code> section, you can navigate between hour, minute, and second by the <code>Right</code> key and the <code>Left</code> key.  </li> <li>in the <code>time</code> section, you can increase the time (hour, minute, or second) by the <code>Up</code> key and the <code>Down</code> key.</li> </ul> <p></p>","tags":["administration","configuration","tools","tui","text base UI","navigation"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/navigation-guide/#label-widgets","title":"Label Widgets","text":"<p>The label widget is used with scopes to show certain items instead of a long one, it is similar to the list widget</p> <ul> <li> <p><code>tab</code>, <code>shift + tab</code>: can be used to navigate between the button and the labels</p> </li> <li> <p><code>Right</code> key and <code>Left</code> key can be used to navigate between the labels</p> </li> <li> <p><code>d</code>: can be used to view all the data of the selected label</p> </li> <li> <p><code>delete</code>: can be used to delete a certain label</p> </li> </ul> <p></p>","tags":["administration","configuration","tools","tui","text base UI","navigation"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/navigation-guide/#logout-and-exit","title":"Logout and Exit","text":"<p>Exit will close the TUI screen while logout will force re-authentication of TUI using device-code.</p> <p>Navigate to <code>Jans TUI</code> on upper right corner of the screen and hit enter.</p> <p></p>","tags":["administration","configuration","tools","tui","text base UI","navigation"]},{"location":"janssen-server/config-guide/config-tools/jans-tui/using-command-line-log/","title":"Using TUI Command Line Log","text":"<p>When you do a write operation (post/put/patch) with Jans TUI, it logs activities to file <code>&lt;log-dir&gt;/cli_cmd.log</code>,default <code>log-dir</code> is home directory.</p> <p>Consider you created a user with TUI and have the following line in <code>cli_cmd.log</code>:</p> <pre><code>/usr/bin/python3 /opt/jans/jans-cli/cli/config_cli.py --operation-id post-user --data '{\"customObjectClasses\": [\"top\", \"jansPerson\"], \"customAttributes\": [{\"name\": \"middleName\", \"multiValued\": false, \"values\": [\"\"]}, {\"name\": \"sn\", \"multiValued\": false, \"values\": [\"Watts\"]}, {\"name\": \"nickname\", \"multiValued\": false, \"values\": [\"\"]}], \"mail\": \"ewatts@foo.org\", \"userId\": \"ewatts\", \"displayName\": \"Emelia Watts\", \"givenName\": \"Emelia\", \"userPassword\": \"TopSecret\", \"jansStatus\": \"active\"}'\n</code></pre> <p>You can modify this line to create another user, let us change the followings:</p> <p>userId padilla userPassword NewSecret sn Padilla givenName Reggie displayName Padilla Reggie mail reggie.padilla@egg.org</p> <p>New command will become:</p> <pre><code>/usr/bin/python3 /opt/jans/jans-cli/cli/config_cli.py --operation-id post-user --data '{\"customObjectClasses\": [\"top\", \"jansPerson\"], \"customAttributes\": [{\"name\": \"middleName\", \"multiValued\": false, \"values\": [\"\"]}, {\"name\": \"sn\", \"multiValued\": false, \"values\": [\"Padilla\"]}, {\"name\": \"nickname\", \"multiValued\": false, \"values\": [\"\"]}], \"mail\": \"reggie.padilla@egg.org\", \"userId\": \"padilla\", \"displayName\": \"Padilla Reggie\", \"givenName\": \"Reggie\", \"userPassword\": \"NewSecret\", \"jansStatus\": \"active\"}'\n</code></pre> <p>When you execute this command, user will be created: <pre><code>Server Response:\n{\n  \"dn\": \"inum=65a5a60c-d314-426d-a8f4-8c36325a1024,ou=people,o=jans\",\n  \"userId\": \"padilla\",\n  \"createdAt\": \"2023-05-30T09:48:58\",\n  \"customAttributes\": [\n    {\n      \"name\": \"sn\",\n      \"multiValued\": false,\n      \"values\": [\n        \"Padilla\"\n      ],\n      \"displayValue\": \"Padilla\",\n      \"value\": \"Padilla\"\n    }\n  ],\n  \"customObjectClasses\": [\n    \"top\",\n    \"jansCustomPerson\"\n  ],\n  \"inum\": \"65a5a60c-d314-426d-a8f4-8c36325a1024\",\n  \"mail\": \"reggie.padilla@egg.org\",\n  \"displayName\": \"Padilla Reggie\",\n  \"jansStatus\": \"active\",\n  \"givenName\": \"Reggie\",\n  \"baseDn\": \"inum=65a5a60c-d314-426d-a8f4-8c36325a1024,ou=people,o=jans\"\n}\n</code></pre></p>","tags":["administration","configuration","tools","cli","tui","commandline","logging"]},{"location":"janssen-server/config-guide/fido2-config/janssen-fido2-configuration/","title":"Janssen FIDO2 Configuration","text":"<p>The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal.  Learn how to use Jans Text-based UI (TUI)  here or jump straight to the Using Text-based UI</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here or Jump straight to the Using Configuration REST API</p>","tags":["administration","configuration","fido2"]},{"location":"janssen-server/config-guide/fido2-config/janssen-fido2-configuration/#using-command-line","title":"Using Command Line","text":"<p>In the Janssen Server, you can deploy and customize the FIDO2 Configuration using the command line. To get the details of Janssen command line operations relevant to FIDO2 Configuration, you can check the operations under <code>Fido2Configuration</code> task using the command below:</p> Command<pre><code>jans cli --info Fido2Configuration\n</code></pre> <p>It will show the details of the available operation-ids for Fido2.</p> Sample Output<pre><code>Operation ID: get-properties-fido2\n  Description: Gets Jans Authorization Server Fido2 configuration properties\nOperation ID: put-properties-fido2\n  Description: Updates Fido2 configuration properties\n  Schema: Fido2:AppConfiguration\n\nTo get sample schema type jans cli --schema &lt;schema&gt;, for example jans cli --schema Fido2:AppConfiguration\n</code></pre>","tags":["administration","configuration","fido2"]},{"location":"janssen-server/config-guide/fido2-config/janssen-fido2-configuration/#get-the-current-fido2-configuration","title":"Get The Current Fido2 Configuration","text":"<p>To get the properties of Janssen Fido2 Configuration, run the command below:</p> Command<pre><code>jans cli --operation-id get-properties-fido2\n</code></pre> <p>It will return the result as below:</p> Sample Output<pre><code>{\n  \"issuer\": \"https://example.jans.io\",\n  \"baseEndpoint\": \"https://example.jans.io/jans-fido2/restv1\",\n  \"cleanServiceInterval\": 60,\n  \"cleanServiceBatchChunkSize\": 10000,\n  \"useLocalCache\": true,\n  \"disableJdkLogger\": true,\n  \"loggingLevel\": \"INFO\",\n  \"loggingLayout\": \"text\",\n  \"metricReporterInterval\": 300,\n  \"metricReporterKeepDataDays\": 15,\n  \"metricReporterEnabled\": true,\n  \"personCustomObjectClassList\": [\n    \"jansCustomPerson\",\n    \"jansPerson\"\n  ],\n  \"sessionIdPersistInCache\": false,\n  \"errorReasonEnabled\": false,\n  \"fido2Configuration\": {\n    \"authenticatorCertsFolder\": \"/etc/jans/conf/fido2/authenticator_cert\",\n    \"mdsCertsFolder\": \"/etc/jans/conf/fido2/mds/cert\",\n    \"mdsTocsFolder\": \"/etc/jans/conf/fido2/mds/toc\",\n    \"checkU2fAttestations\": false,\n    \"debugUserAutoEnrollment\": false,\n    \"unfinishedRequestExpiration\": 180,\n    \"metadataRefreshInterval\": 1296000,\n    \"serverMetadataFolder\": \"/etc/jans/conf/fido2/server_metadata\",\n    \"enabledFidoAlgorithms\": [\n      \"RS256\",\n      \"ES256\"\n    ],\n    \"metadataServers\": [\n      {\n        \"url\": \"https://mds.fidoalliance.org/\"\n      }\n    ],\n    \"disableMetadataService\": false,\n    \"hints\": [\n      \"security-key\",\n      \"client-device\",\n      \"hybrid\"\n    ],\n    \"enterpriseAttestation\": false,\n    \"attestationMode\": \"monitor\",\n    \"rp\": [\n      {\n        \"id\": \"https://example.jans.io\",\n        \"origins\": [\n          \"example.jans.io\"\n        ]\n      }\n    ]\n  }\n}\n</code></pre>","tags":["administration","configuration","fido2"]},{"location":"janssen-server/config-guide/fido2-config/janssen-fido2-configuration/#update-fido2-configuration-properties","title":"Update FIDO2 Configuration Properties","text":"<p>To update the configuration follow the steps below.</p> <ol> <li>Get the current configuration and store it into a file for editing</li> <li>Edit and update the desired configuration values (ex: change logging level to TRACE) in the file while keeping other properties and values unchanged. Updates must adhere to the <code>Fido2:AppConfiguration</code> schema as mentioned here. The schema details can be retrieved using the command below. The schema defines what values and datatypes are acceptable for each property value.  Command<pre><code>jans cli --schema Fido2:AppConfiguration\n</code></pre></li> <li>Use the updated file to send the update to the Janssen Server using the command below  Command<pre><code> jans cli --operation-id put-properties-fido2 --data /tmp/conf-data.json\n</code></pre>  Upon successful execution of the update, the Janssen Server responds with updated configuration.you can check the updated value changed (\"loggingLevel\": \"TRACE\")</li> </ol>","tags":["administration","configuration","fido2"]},{"location":"janssen-server/config-guide/fido2-config/janssen-fido2-configuration/#using-text-based-ui","title":"Using Text-based UI","text":"<p>In the Janssen Server, you can manage FIDO2 Configuration using the Text-Based UI also.</p> <p>You can start TUI using the command below:</p> Command<pre><code>jans tui\n</code></pre> <p>Navigate to <code>FIDO</code> section where administrators can update dynamic and static configurations.</p> <p></p>","tags":["administration","configuration","fido2"]},{"location":"janssen-server/config-guide/fido2-config/janssen-fido2-configuration/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring the FIDO2 Configuration. Endpoint details are published in the Swagger document.</p>","tags":["administration","configuration","fido2"]},{"location":"janssen-server/config-guide/scim-config/scim-group-config/","title":"Group Management","text":"<p>The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here or Jump straight to the Using Configuration REST API</p>","tags":["administration","configuration","group"]},{"location":"janssen-server/config-guide/scim-config/scim-group-config/#using-command-line","title":"Using Command Line","text":"Command<pre><code>jans cli -scim --info Group\n</code></pre> Command Output<pre><code>Operation ID: get-groups\n  Description: Query Group resources (see section 3.4.2 of RFC 7644)\n  Parameters:\n  attributes: A comma-separated list of attribute names to return in the response [string]\n  excludedAttributes: When specified, the response will contain a default set of attributes minus those listed here (as a comma-separated list) [string]\n  filter: An expression specifying the search criteria. See section 3.4.2.2 of RFC 7644 [string]\n  startIndex: The 1-based index of the first query result [integer]\n  count: Specifies the desired maximum number of query results per page [integer]\n  sortBy: The attribute whose value will be used to order the returned responses [string]\n  sortOrder: Order in which the sortBy param is applied. Allowed values are \"ascending\" and \"descending\" [string]\nOperation ID: create-group\n  Description: Allows creating a Group resource via POST (see section 3.3 of RFC 7644)\n  Parameters:\n  attributes: A comma-separated list of attribute names to return in the response [string]\n  excludedAttributes: When specified, the response will contain a default set of attributes minus those listed here (as a comma-separated list) [string]\n  Schema: GroupResource\n  Schema: GroupResource\nOperation ID: get-group-by-id\n  Description: Retrieves a Group resource by Id (see section 3.4.1 of RFC 7644)\n  Parameters:\n  attributes: A comma-separated list of attribute names to return in the response [string]\n  excludedAttributes: When specified, the response will contain a default set of attributes minus those listed here (as a comma-separated list) [string]\n  id: No description is provided for this parameter [string]\nOperation ID: update-group-by-id\n  Description: Updates a Group resource (see section 3.5.1 of RFC 7644). Update works in a replacement fashion&amp;amp;#58; every\nattribute value found in the payload sent will replace the one in the existing resource representation. Attributes\nnot passed in the payload will be left intact.\n\n  Parameters:\n  attributes: A comma-separated list of attribute names to return in the response [string]\n  excludedAttributes: When specified, the response will contain a default set of attributes minus those listed here (as a comma-separated list) [string]\n  id: No description is provided for this parameter [string]\n  Schema: GroupResource\n  Schema: GroupResource\nOperation ID: delete-group-by-id\n  Description: Deletes a group resource (see section 3.6 of RFC 7644)\n  Parameters:\n  id: Identifier of the resource to delete [string]\nOperation ID: patch-group-by-id\n  Description: Updates one or more attributes of a Group resource using a sequence of additions, removals, and replacements operations. See section 3.5.2 of RFC 7644\n\n  Parameters:\n  attributes: A comma-separated list of attribute names to return in the response [string]\n  excludedAttributes: When specified, the response will contain a default set of attributes minus those listed here (as a comma-separated list) [string]\n  id: No description is provided for this parameter [string]\n  Schema: PatchRequest\n  Schema: PatchRequest\nOperation ID: search-group\n  Description: Query Group resources (see section 3.4.2 of RFC 7644)\n  Schema: SearchRequest\n  Schema: SearchRequest\n\nTo get sample schema type jans cli -scim --schema-sample &lt;schema&gt;, for example jans cli -scim --schema-sample SearchRequest \n</code></pre>","tags":["administration","configuration","group"]},{"location":"janssen-server/config-guide/scim-config/scim-group-config/#get-groups","title":"Get Groups","text":"<p>This operation can be used to get list of groups. To get the list of groups, run the following command:</p> Command<pre><code>jans cli -scim --operation-id get-groups\n</code></pre> <p>It will show the list of groups with all the members linked with each of these groups.</p> Sample Output<pre><code>{\n  \"schemas\": [\n    \"urn:ietf:params:scim:api:messages:2.0:ListResponse\"\n  ],\n  \"totalResults\": 1,\n  \"startIndex\": 1,\n  \"itemsPerPage\": 1,\n  \"Resources\": [\n    {\n      \"schemas\": [\n        \"urn:ietf:params:scim:schemas:core:2.0:Group\"\n      ],\n      \"id\": \"60B7\",\n      \"meta\": {\n        \"resourceType\": \"Group\",\n        \"location\": \"https://imshakil-boss-guppy.gluu.info/jans-scim/restv1/v2/Groups/60B7\"\n      },\n      \"displayName\": \"Janssen Manager Group\",\n      \"members\": [\n        {\n          \"value\": \"f764391d-56de-4b74-b0a2-f32814706dcc\",\n          \"type\": \"User\",\n          \"display\": \"Default Admin User\",\n          \"$ref\": \"https://imshakil-boss-guppy.gluu.info/jans-scim/restv1/v2/Users/f764391d-56de-4b74-b0a2-f32814706dcc\"\n        }\n      ]\n    }\n  ]\n}\n</code></pre> <p>You can filter for the advanced search with some of its properties:</p> <ol> <li>attributes</li> <li>excludeAttributes</li> <li>filter</li> <li>count [define maximum number of query]</li> <li>sortBy [attribute]</li> <li>sortOrder ['ascending', 'descending']</li> </ol>","tags":["administration","configuration","group"]},{"location":"janssen-server/config-guide/scim-config/scim-group-config/#create-group","title":"Create Group","text":"<p>Using <code>create-group</code> operation, we can create groups into Janssen Server. As we have seen in the output of <code>--info</code> command, this operation requires <code>GroupResource</code> schema. To know the details of schema, run the following command:</p> Command<pre><code>jans cli -scim --schema GroupResource\n</code></pre> <p>The Janssen server also provides sample schema. To get the sample schema of <code>GroupResource</code>:</p> Command<pre><code>jans cli -scim --schema-sample GroupResource\n</code></pre> <p>According to schema, let's put all the details into a json file <code>/tmp/create-group.json</code> to create a group.</p> sample<pre><code>{\n  \"displayName\": \"New Group\"\n}\n</code></pre> <p>Now let's run the following command to add group into the server:</p> Command<pre><code> jans cli -scim --operation-id create-group --data /tmp/create-group.json\n</code></pre> Command Output<pre><code>{\n  \"schemas\": [\n    \"urn:ietf:params:scim:schemas:core:2.0:Group\"\n  ],\n  \"id\": \"7a20464c-3651-48a0-9c9c-6b59373df60c\",\n  \"meta\": {\n    \"resourceType\": \"Group\",\n    \"created\": \"2024-09-06T03:46:31.224Z\",\n    \"lastModified\": \"2024-09-06T03:46:31.224Z\",\n    \"location\": \"https://imshakil-boss-guppy.gluu.info/jans-scim/restv1/v2/Groups/7a20464c-3651-48a0-9c9c-6b59373df60c\"\n  },\n  \"displayName\": \"New Group\"\n}\n</code></pre>","tags":["administration","configuration","group"]},{"location":"janssen-server/config-guide/scim-config/scim-group-config/#get-group-by-id","title":"Get Group by ID","text":"<p>We can view the specific group details through its <code>id</code> using <code>get-group-by-id</code> operation. For example, We can put the group created above <code>id:7a20464c-3651-48a0-9c9c-6b59373df60c</code> with <code>--url-suffix</code> to get the group details. The following command as below:</p> <p>Command<pre><code>jans cli -scim --operation-id get-group-by-id \\\n--url-suffix=\"id:7a20464c-3651-48a0-9c9c-6b59373df60c\"\n</code></pre> Command Output<pre><code>{\n  \"schemas\": [\n    \"urn:ietf:params:scim:schemas:core:2.0:Group\"\n  ],\n  \"id\": \"7a20464c-3651-48a0-9c9c-6b59373df60c\",\n  \"meta\": {\n    \"resourceType\": \"Group\",\n    \"created\": \"Fri Sep 06 03:46:31 UTC 2024\",\n    \"lastModified\": \"Fri Sep 06 03:46:31 UTC 2024\",\n    \"location\": \"https://imshakil-boss-guppy.gluu.info/jans-scim/restv1/v2/Groups/7a20464c-3651-48a0-9c9c-6b59373df60c\"\n  },\n  \"displayName\": \"New Group\",\n  \"members\": []\n}\n</code></pre></p> <p>We see <code>members</code> is empty since we did not associate any user with this group yet. We will add members into this group in the next operation.</p>","tags":["administration","configuration","group"]},{"location":"janssen-server/config-guide/scim-config/scim-group-config/#update-group-by-id","title":"Update Group by ID","text":"<p>The <code>update-group-by-id</code> operation can be used to update group name and adding members into the group. Let's create a json file <code>/tmp/update-group.json</code> according to the <code>GroupResource</code> schema:</p> Sample<pre><code>{\n  \"members\": [\n    {\n      \"value\": \"4ed288be-4d1c-4e05-a3af-7a8935fc7f4c\",\n      \"type\": \"user\"\n    }\n  ]\n}\n</code></pre> <p>We can get the <code>value</code> which is actually the <code>id</code> of specific users from user management section. Let's run the following command to update empty members properties with a member into the group we created above.</p> Command<pre><code>jans cli -scim --operation-id update-group-by-id \\\n--url-suffix=\"id:7a20464c-3651-48a0-9c9c-6b59373df60c\" --data /tmp/update-group.json\n</code></pre> Output<pre><code>{\n  \"schemas\": [\n    \"urn:ietf:params:scim:schemas:core:2.0:Group\"\n  ],\n  \"id\": \"7a20464c-3651-48a0-9c9c-6b59373df60c\",\n  \"meta\": {\n    \"resourceType\": \"Group\",\n    \"created\": \"Fri Sep 06 03:46:31 UTC 2024\",\n    \"lastModified\": \"2024-09-06T05:15:53.227Z\",\n    \"location\": \"https://imshakil-boss-guppy.gluu.info/jans-scim/restv1/v2/Groups/7a20464c-3651-48a0-9c9c-6b59373df60c\"\n  },\n  \"displayName\": \"New Group\",\n  \"members\": [\n    {\n      \"value\": \"4ed288be-4d1c-4e05-a3af-7a8935fc7f4c\",\n      \"type\": \"User\",\n      \"display\": \"Test User\",\n      \"$ref\": \"https://imshakil-boss-guppy.gluu.info/jans-scim/restv1/v2/Users/4ed288be-4d1c-4e05-a3af-7a8935fc7f4c\"\n    }\n  ]\n}\n</code></pre> <p>Please remember one thing, this update method just replace the data. If you want to add members instead of replacing then you must try patch-group-by-id.</p>","tags":["administration","configuration","group"]},{"location":"janssen-server/config-guide/scim-config/scim-group-config/#delete-group-by-id","title":"Delete Group by ID","text":"<p>You can delete a group by its ID. The command line looks like:</p> Command<pre><code>jans cli -scim --operation-id delete-group-by-id \\\n--url-suffix=\"id:7a20464c-3651-48a0-9c9c-6b59373df60c\"\n</code></pre> <p>It will delete the group and all of its associated data if match with the unique group ID.</p>","tags":["administration","configuration","group"]},{"location":"janssen-server/config-guide/scim-config/scim-group-config/#patch-group","title":"Patch Group","text":"<p>This is also an option to update any existing group resources. The only difference between update-group-by-id and patch-group is that the first one just replace new data with previous one. It won't add any new data into the group. With <code>patch-group-by-id</code> operation, we can <code>add</code>, <code>remove</code>, and <code>replace</code> properties of group.</p> <p>According to the output of <code>--info</code> command, we can see <code>patch-group-by-id</code> requires <code>PatchRequest</code> schema.</p> <pre><code>[\n    {\n        \"op\": \"add\",\n        \"path\": \"members\",\n        \"value\": {\n            \"value\": \"f764391d-56de-4b74-b0a2-f32814706dcc\",\n            \"type\": \"user\"\n        }\n    }\n]\n</code></pre> <p>Let's run the following command:</p> Command<pre><code>jans cli -scim --operation-id patch-group-by-id \\\n--url-suffix=\"id:7a20464c-3651-48a0-9c9c-6b59373df60c\" --data /tmp/patch-user.json\n</code></pre>","tags":["administration","configuration","group"]},{"location":"janssen-server/config-guide/scim-config/scim-group-config/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring the OpenID Connect Client. Endpoint details are published in the Swagger document.</p>","tags":["administration","configuration","group"]},{"location":"janssen-server/config-guide/scim-config/user-config/","title":"User Management","text":"<p>The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal.  Learn how to use Jans Text-based UI (TUI)  here or jump straight to the Using Text-based UI</p> <p>Use REST API for programmatic access or invoke via tools like CURL or  Postman. Learn how to use Janssen Server Config API  here or Jump straight to the Using Configuration REST API</p>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#using-command-line","title":"Using Command Line","text":"<p>In the Janssen Server, you can do CRUD operations for user management using its command line tool. To get the details of command line for CRUD operations relevant to User Management, you can find the <code>operation-id</code> under the <code>User</code> task using the Jans CLI in scim mode. The following command line:</p> Command<pre><code>jans cli -scim --info User\n</code></pre> Sample Output<pre><code>Operation ID: get-users\n  Description: Query User resources (see section 3.4.2 of RFC 7644)\n  Parameters:\n  attributes: A comma-separated list of attribute names to return in the response [string]\n  excludedAttributes: When specified, the response will contain a default set of attributes minus those listed here (as a comma-separated list) [string]\n  filter: An expression specifying the search criteria. See section 3.4.2.2 of RFC 7644 [string]\n  startIndex: The 1-based index of the first query result [integer]\n  count: Specifies the desired maximum number of query results per page [integer]\n  sortBy: The attribute whose value will be used to order the returned responses [string]\n  sortOrder: Order in which the sortBy param is applied. Allowed values are \"ascending\" and \"descending\" [string]\nOperation ID: create-user\n  Description: Allows creating a User resource via POST (see section 3.3 of RFC 7644)\n  Parameters:\n  attributes: A comma-separated list of attribute names to return in the response [string]\n  excludedAttributes: When specified, the response will contain a default set of attributes minus those listed here (as a comma-separated list) [string]\n  Schema: UserResource\n  Schema: UserResource\nOperation ID: get-user-by-id\n  Description: Retrieves a User resource by Id (see section 3.4.1 of RFC 7644)\n  Parameters:\n  attributes: A comma-separated list of attribute names to return in the response [string]\n  excludedAttributes: When specified, the response will contain a default set of attributes minus those listed here (as a comma-separated list) [string]\n  id: No description is provided for this parameter [string]\nOperation ID: update-user-by-id\n  Description: Updates a User resource (see section 3.5.1 of RFC 7644). Update works in a replacement fashion; every attribute value found in the payload sent will replace the one in the existing resource representation. Attributes not passed in the payload will be left intact.\n  Parameters:\n  attributes: A comma-separated list of attribute names to return in the response [string]\n  excludedAttributes: When specified, the response will contain a default set of attributes minus those listed here (as a comma-separated list) [string]\n  id: No description is provided for this parameter [string]\n  Schema: UserResource\n  Schema: UserResource\nOperation ID: delete-user-by-id\n  Description: Deletes a user resource\n  Parameters:\n  id: Identifier of the resource to delete [string]\nOperation ID: patch-user-by-id\n  Description: Updates one or more attributes of a User resource using a sequence of additions, removals, and replacements operations. See section 3.5.2 of RFC 7644\n  Parameters:\n  attributes: A comma-separated list of attribute names to return in the response [string]\n  excludedAttributes: When specified, the response will contain a default set of attributes minus those listed here (as a comma-separated list) [string]\n  id: No description is provided for this parameter [string]\n  Schema: PatchRequest\n  Schema: PatchRequest\nOperation ID: search-user\n  Description: Query User resources (see section 3.4.2 of RFC 7644)\n  Schema: SearchRequest\n  Schema: SearchRequest\n\nTo get sample schema type jans cli -scim --schema-sample &lt;schema&gt;, for example jans cli -scim --schema-sample SearchRequest\n</code></pre>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#get-users-list","title":"Get Users List","text":"<p>This operation is used to get list of the users and its properties. The following command line:</p> Command<pre><code>jans cli -scim --operation-id get-users\n</code></pre> Sample Output<pre><code>{\n  \"schemas\": [\n    \"urn:ietf:params:scim:api:messages:2.0:ListResponse\"\n  ],\n  \"totalResults\": 1,\n  \"startIndex\": 1,\n  \"itemsPerPage\": 1,\n  \"Resources\": [\n    {\n      \"schemas\": [\n        \"urn:ietf:params:scim:schemas:core:2.0:User\"\n      ],\n      \"id\": \"f764391d-56de-4b74-b0a2-f32814706dcc\",\n      \"meta\": {\n        \"resourceType\": \"User\",\n        \"location\": \"https://imshakil-boss-guppy.gluu.info/jans-scim/restv1/v2/Users/f764391d-56de-4b74-b0a2-f32814706dcc\"\n      },\n      \"userName\": \"admin\",\n      \"name\": {\n        \"familyName\": \"User\",\n        \"givenName\": \"Admin\",\n        \"middleName\": \"Admin\",\n        \"formatted\": \"Admin Admin User\"\n      },\n      \"displayName\": \"Default Admin User\",\n      \"nickName\": \"Admin\",\n      \"active\": true,\n      \"emails\": [\n        {\n          \"value\": \"admin@imshakil-boss-guppy.gluu.info\",\n          \"primary\": false\n        }\n      ],\n      \"groups\": [\n        {\n          \"value\": \"60B7\",\n          \"display\": \"Janssen Manager Group\",\n          \"type\": \"direct\",\n          \"$ref\": \"https://imshakil-boss-guppy.gluu.info/jans-scim/restv1/v2/Groups/60B7\"\n        }\n      ]\n    }\n  ]\n}\n</code></pre> <p>As shown in the output for <code>--info</code> command, <code>get-users</code> operation-id also supports parameters for the advanced search. Those parameters are:</p> <pre><code>1. attributes\n2. excludeAttributes\n3. filter\n4. count [define maximum number of query]\n5. sortBy [attribute]\n6. sortOrder ['ascending', 'descending']\n</code></pre> <p>This is an example with <code>endpoint-args</code>:</p> Command<pre><code>jans cli -scim --operation-id get-users --endpoint-args attributes:emails\n</code></pre> Sample Output<pre><code>{\n  \"schemas\": [\n    \"urn:ietf:params:scim:api:messages:2.0:ListResponse\"\n  ],\n  \"totalResults\": 1,\n  \"startIndex\": 1,\n  \"itemsPerPage\": 1,\n  \"Resources\": [\n    {\n      \"schemas\": [\n        \"urn:ietf:params:scim:schemas:core:2.0:User\"\n      ],\n      \"id\": \"f764391d-56de-4b74-b0a2-f32814706dcc\",\n      \"emails\": [\n        {\n          \"value\": \"admin@imshakil-boss-guppy.gluu.info\",\n          \"primary\": false\n        }\n      ]\n    }\n  ]\n}\n</code></pre>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#creating-a-new-user","title":"Creating a New User","text":"<p>To create a new user using Jans CLI, we can use <code>create-user</code> operation-id. As shown in the output for <code>--info</code> command, the <code>create-user</code> operation requires data to be sent according to <code>UserResource</code> schema. To see the schema, use the command as below:</p> Command<pre><code>jans cli -scim --schema UserResource\n</code></pre> <p>The Janssen Server also provides sample data for the above schema. Let's run the following command to get the sample schema:</p> Command<pre><code>jans cli -scim --schema-sample UserResource\n</code></pre> <p>From the above example of schema file, we can fill required values in a data file <code>/tmp/user.json</code>. As we have seen in the sample schema there are lot of properties, but we are going to fill minimum to create a <code>test user</code>:</p> user.json<pre><code>{\n  \"userName\": \"test.user\",\n  \"displayName\": \"Test User\",\n  \"nickName\": \"testu\",\n  \"active\": true,\n  \"password\": \"pass@word\",\n  \"emails\": [\n      {\n          \"value\": \"testuser@maildomain.net\",\n          \"primary\": true\n      }\n  ]\n}\n</code></pre> <p>Let's run the following command to create user in Janssen Server:</p> Command<pre><code>jans cli -scim --operation-id create-user --data /tmp/user.json\n</code></pre> Output<pre><code>{\n  \"schemas\": [\n    \"urn:ietf:params:scim:schemas:core:2.0:User\"\n  ],\n  \"id\": \"e24c1479-4a61-4f1f-aa30-2ccc13c0b130\",\n  \"meta\": {\n    \"resourceType\": \"User\",\n    \"created\": \"2024-09-04T06:36:00.882Z\",\n    \"lastModified\": \"2024-09-04T06:36:00.882Z\",\n    \"location\": \"https://imshakil-boss-guppy.gluu.info/jans-scim/restv1/v2/Users/e24c1479-4a61-4f1f-aa30-2ccc13c0b130\"\n  },\n  \"userName\": \"test.user\",\n  \"displayName\": \"Test User\",\n  \"nickName\": \"testu\",\n  \"active\": true,\n  \"emails\": [\n    {\n      \"value\": \"testuser@maildomain.net\",\n      \"primary\": true\n    }\n  ]\n}\n</code></pre>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#find-user-by-id","title":"Find User by Id","text":"<p>We can retrieve user details using user's <code>id</code>. For example in the above created user id is <code>e24c1479-4a61-4f1f-aa30-2ccc13c0b130</code>. To get the user details by user id, We can use the <code>get-user-by-id</code> operation as below:</p> Command<pre><code>jans cli -scim --operation-id get-user-by-id \\\n--url-suffix=\"id:e24c1479-4a61-4f1f-aa30-2ccc13c0b130\"\n</code></pre> Output<pre><code>{\n  \"schemas\": [\n    \"urn:ietf:params:scim:schemas:core:2.0:User\"\n  ],\n  \"id\": \"e24c1479-4a61-4f1f-aa30-2ccc13c0b130\",\n  \"meta\": {\n    \"resourceType\": \"User\",\n    \"created\": \"2024-09-04T06:36:00.882Z\",\n    \"lastModified\": \"2024-09-04T06:36:00.882Z\",\n    \"location\": \"https://imshakil-boss-guppy.gluu.info/jans-scim/restv1/v2/Users/e24c1479-4a61-4f1f-aa30-2ccc13c0b130\"\n  },\n  \"userName\": \"test.user\",\n  \"displayName\": \"Test User\",\n  \"nickName\": \"testu\",\n  \"active\": true,\n  \"emails\": [\n    {\n      \"value\": \"testuser@maildomain.net\",\n      \"primary\": true\n    }\n  ]\n}\n</code></pre>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#update-user-by-id","title":"Update User by Id","text":"<p>Using Jans CLI, We can update user information. As shown in the output command, the <code>update-user-by-id</code> operation requires user data that needs to be changed. You can find details of user properties in schema. Let's change the <code>nickname</code> for the above <code>Test user</code>. First,we need to put the update data into a json file <code>/tmp/update-user.json</code>:</p> <p>```json title='update-user.json {   \"nickName\": \"testuser\"  } <pre><code>Let's run the following command:\n\n```bash title=\"Command\"\njans cli -scim --operation-id update-user-by-id \\\n--url-suffix=\"id:e24c1479-4a61-4f1f-aa30-2ccc13c0b130\" --data /tmp/update-user.json\n</code></pre></p> Sample Output<pre><code>{\n  \"schemas\": [\n    \"urn:ietf:params:scim:schemas:core:2.0:User\"\n  ],\n  \"id\": \"e24c1479-4a61-4f1f-aa30-2ccc13c0b130\",\n  \"meta\": {\n    \"resourceType\": \"User\",\n    \"created\": \"2024-09-04T06:36:00.882Z\",\n    \"lastModified\": \"2024-09-05T05:38:31.491Z\",\n    \"location\": \"https://imshakil-boss-guppy.gluu.info/jans-scim/restv1/v2/Users/e24c1479-4a61-4f1f-aa30-2ccc13c0b130\"\n  },\n  \"userName\": \"test.user\",\n  \"displayName\": \"Test User\",\n  \"nickName\": \"testuser\",\n  \"active\": true,\n  \"emails\": [\n    {\n      \"value\": \"testuser@maildomain.net\",\n      \"primary\": true\n    }\n  ]\n}\n</code></pre>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#patch-user-by-id","title":"Patch User by Id","text":"<p>Using <code>patch-user-by-id</code> operation, We can modify user properties partially. As we have seen in the Output of <code>--info</code> command, <code>patch-user-by-id</code> operation requires <code>PatchRequest</code> schema definition for payload data. To get the sample <code>PatchRequest</code> schema, run the followwing command:</p> <p>```bash titl=\"Command\" jans cli -scim --schema-sample PatchRequest <pre><code>For example, In the above `test user`, we are going to `add` one more email, `remove` nickName and `replace` displayName. Let's put all the operations in a json file `/tmp/patch-user.json`:\n\n```json title=\"patch-user.json\"\n{\n    \"schemas\": [\n        \"urn:ietf:params:scim:api:messages:2.0:PatchOp\"\n    ],\n    \"Operations\": [\n        {\n            \"op\": \"replace\",\n            \"path\": \"displayName\",\n            \"value\": \"Test User\"\n        },\n        {\n            \"op\": \"add\",\n            \"path\": \"emails\",\n            \"value\": [\n                {\n                    \"value\": \"test.user@example.jans.io\",\n                    \"primary\": true\n                }\n            ]\n        },\n        {\n            \"op\": \"remove\",\n            \"path\": \"nickName\"\n        }\n    ]\n}\n</code></pre></p> <p>The command line to run all of these operations:</p> Command<pre><code>jans cli -scim --operation patch-user-by-id \\\n--url-suffix=\"id:e24c1479-4a61-4f1f-aa30-2ccc13c0b130\" \\\n--data /tmp/patch-user.json\n</code></pre>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#delete-user-by-id","title":"Delete User by ID","text":"<p>To delete the, run the following command with the specific user ID as <code>--url-suffix=id:user-id</code>. For example, let's delete the <code>test user</code> we have created earlier:</p> Command<pre><code>jans cli -scim --operation-id delete-user-by-id \\\n--url-suffix=\"id:e24c1479-4a61-4f1f-aa30-2ccc13c0b130\"\n</code></pre>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#using-text-based-ui","title":"Using Text-based UI","text":"<p>Using TUI, We can add, update and deleter users in the Janssen Server. To do that, Let's start TUI using the command below:</p> Command<pre><code>/opt/jans/jans-cli/jans_cli_tui.py\n</code></pre> <p>Navigate to <code>Users</code> to open the users tab as shown in the image below:</p> <p></p> <ul> <li>We can see the list of users from search option</li> <li>To get the list of users available in the Janssen Server, bring the control to <code>Search</code> box (using <code>tab</code> key) and press <code>Enter</code> key.</li> </ul> <p>Let's see at a glance of available user attributes.</p> Attributes Description Username ... Password ... First Name ... Middle Name ... Last Name ... Display Name ... Email ... Active ... Nickname ... CIBA Device Registration Token ... CIBA User code ... Locale ... Website URL ... IMAP Data ... jansAdminUIRole ... Enrollment code ... User Permission ... Preferred Language ... Profile URL ... Secret Question ... Email Verified ... Birthdate ... Time zone info ... Phone Number verified ... Preferred Username ... TransientId ... PersistentId ... Country ... Secret Answer ... OpenID Connect JSON formatted address ... User certificate ... Organization ... Picture URL ...","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#add-user","title":"Add User","text":"<p>Let's add an user by selecting <code>Add Users</code> tab. Initially we can provide bellow attributes value,</p> <p></p> <p>We can add extra claims simply by slecting <code>Add Claim</code></p> <p></p> <p>Finally <code>save</code> and exit. We will get an unique <code>inum</code></p>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#update-user","title":"Update User","text":"<p>To modify any user properties, find the user from search box and hit <code>Enter</code> to pop-up user details, update user details and finally hit on <code>Save</code> button to update the changes.</p> <p></p>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#change-user-password","title":"Change User Password","text":"<p>No chance to recover user password, but you can change. To change password of a user navigate/or search user and press key <code>p</code> when the target user is higlighted. In the figure below, passowrd of user sakamura is being changed.</p> <p></p> <p>Once you write new password (it will be displayed while you type), go to button <code>&lt; Save &gt;</code> and press Enter.</p>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#manage-user-fido-devices","title":"Manage User FIDO Devices","text":"<p>To view and manage users registered FIDO devices, first navigate/or search user and press key  <code>f</code> on the keyboard. If user has any registered FIDO device, a popup will appears as in image below:</p> <p></p> <p>You can veiw details of a device by pressing Enter. To delete a device press key <code>d</code>, you will be prompted for confirmation.</p>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#delete-user","title":"Delete User","text":"<p>To delete user, bring the control on the specific user row and press <code>delete</code> or <code>d</code> key from keyboard. It will show a pop-up for confirmation as below:</p> <p></p>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#using-configuration-rest-api","title":"Using Configuration REST API","text":"<p>Janssen Server Configuration REST API exposes relevant endpoints for managing and configuring the OpenID Connect Client. Endpoint details are published in the Swagger document.</p>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#get-scim-client","title":"Get SCIM Client","text":"<p>Let's obtain the credentials of this client first. In TUI, navigate to <code>Auth Server &gt; Clients</code>. In the search field type SCIM (uppercase). Highlight the row that matches a client named \"SCIM Client\" and press Enter. To see in <code>JSON</code> formate please press <code>d</code>.</p> <p>From the \"Basic\" section, grab the \"client id\" and \"client secret\". This secret is encrypted, to decrypt it, in a terminal run <code>/opt/jans/bin/encode.py -D ENCRYPTED-SECRET-HERE</code>.</p>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#get-access-token","title":"Get Access token","text":"<p>Let's get a token,</p> <pre><code>curl -k -u 'CLIENT_ID:DECRYPTED_CLIENT_SECRET' -k -d grant_type=client_credentials -d scope='https://jans.io/scim/users.read https://jans.io/scim/users write' https://&lt;jans-server&gt;/jans-auth/restv1/token &gt; /tmp/token.json\n</code></pre> <p>In response <code>token.json</code> we will get <code>access_token</code></p> <pre><code>{\n\"access_token\":\"11a76589-7955-4247-9ca5-f3ad7884305...\",\n\"scope\":\"https://jans.io/scim/users.read\",\n\"token_type\":\"Bearer\",\n\"expires_in\":299\n}\n</code></pre>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#retrieve-existing-user","title":"Retrieve existing User","text":"<p>To get an existing user</p> <p><pre><code>curl -k -G -H 'Authorization: Bearer ACCESS_TOKEN' --data-urlencode 'filter=displayName co \"Admin\"' https://&lt;jans-server&gt;/jans-scim/restv1/v2/Users &gt; /tmp/user.json\n</code></pre> In response <code>user.json</code> we will get <pre><code>{\n  \"schemas\": [\n    \"urn:ietf:params:scim:api:messages:2.0:ListResponse\"\n  ],\n  \"totalResults\": 1,\n  \"startIndex\": 1,\n  \"itemsPerPage\": 1,\n  \"Resources\": [\n    {\n      \"schemas\": [\n        \"urn:ietf:params:scim:schemas:core:2.0:User\"\n      ],\n      \"id\": \"5fdbb720-a1fd-477f-af92-b7c054f02c98\",\n      \"meta\": {\n        \"resourceType\": \"User\",\n        \"created\": \"2023-06-12T14:54:09.531Z\",\n        \"location\": \"https://raju.jans13.me/jans-scim/restv1/v2/Users/5fdbb720-a1fd-477f-af92-b7c054f02c98\"\n      },\n      \"userName\": \"admin\",\n      \"name\": {\n        \"familyName\": \"...\",\n        \"givenName\": \"...\",\n        \"middleName\": \"...\",\n        \"formatted\": \"...\"\n      },\n      \"displayName\": \"Admin\",\n      \"active\": true,\n      \"emails\": [\n        {\n          \"value\": \"example@gluu.org\",\n          \"primary\": false\n        }\n      ],\n      \"groups\": [\n        {\n          \"value\": \"60B7\",\n          \"display\": \"Jannsen Manager Group\",\n          \"type\": \"direct\",\n          \"$ref\": \"https://raju.jans13.me/jans-scim/restv1/v2/Groups/60B7\"\n        }\n      ]\n    }\n  ]\n}\n</code></pre></p>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#create-an-user","title":"Create an User","text":"<p>Let's start creating a dummy user. A client sends a POST request containing a \"User\" to the \"/Users\" endpoint. <pre><code>POST /Users  HTTP/1.1\nHost: example.com\nAccept: application/scim+json\nContent-Type: application/scim+json\nAuthorization: Bearer h480djs93hd8..\nContent-Length: ...\n\n{\n  \"schemas\": [\n    \"urn:ietf:params:scim:schemas:core:2.0:User\"\n  ],\n  \"userName\": \"bjensen\",\n  \"externalId\": \"bjensen\",\n  \"name\": {\n    \"formatted\": \"Ms. Barbara J Jensen III\",\n    \"familyName\": \"Jensen\",\n    \"givenName\": \"Barbara\"\n  }\n}\n</code></pre> Open a text editor and copy paste the json body, name as <code>input.json</code>. Hit on your terminal with bellow command. <pre><code>curl -k -H 'Authorization: Bearer ACCESS_TOKEN' -H 'Content-Type: application/scim+json' -d @input.json -o output.json https://&lt;jans-server&gt;/jans-scim/restv1/v2/Users\n</code></pre> response looks like <pre><code>{\n    \"schemas\": [\n        \"urn:ietf:params:scim:schemas:core:2.0:User\"\n    ],\n    \"id\": \"e3009115-b890-4d8b-bd63-bbfef34aa583\",\n    \"externalId\": \"bjensen\",\n    \"meta\": {\n        \"resourceType\": \"User\",\n        \"created\": \"2023-06-26T19:43:32.945Z\",\n        \"lastModified\": \"2023-06-26T19:43:32.945Z\",\n        \"location\": \"https://raju.jans13.me/jans-scim/restv1/v2/Users/e3009115-b890-4d8b-bd63-bbfef34aa583\"\n    },\n    \"userName\": \"bjensen\",\n    \"name\": {\n        \"familyName\": \"Jensen\",\n        \"givenName\": \"Barbara\",\n        \"formatted\": \"Ms. Barbara J Jensen III\"\n    }\n}\n</code></pre></p> <p>This new user has been given an <code>id</code>. If possible, inspect your <code>ou=people</code> branch and find the entry whose <code>inum</code> matches the <code>id</code> given. An easier option would be to via Jans TUI and go to <code>Users</code> and search \"bjensen\" to see the recently created user.</p>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#updating-a-userput","title":"Updating a User(PUT)","text":"<p>Overwrite your <code>input.json</code> with the following. Replace content in angle brackets accordingly:</p> <pre><code>{\n  \"schemas\": [\n    \"urn:ietf:params:scim:schemas:core:2.0:User\"\n  ],\n  \"id\": \"e3009115-b890-4d8b-bd63-bbfef34aa583\",\n  \"userName\": \"bjensen\",\n  \"externalId\": \"bjensen\",\n  \"name\": {\n    \"formatted\": \"Ms. Barbara J Jensen III\",\n    \"familyName\": \"Jensen\",\n    \"givenName\": \"Barbara\"\n  },\n  \"displayName\": \"Jensen Barbara\",\n  \"emails\": [\n    {\n      \"value\": \"jensen@example.com\",\n      \"type\": \"work\",\n      \"primary\": true\n    }\n  ]\n}\n</code></pre> <p>PUT with curl:</p> <pre><code>curl -k -X PUT -H 'Authorization: Bearer ACCESS_TOKEN' -H 'Content-Type: application/scim+json' -d @input.json -o output.json https://&lt;jans-server&gt;/jans-scim/restv1/v2/Users/&lt;user-inum&gt;\n</code></pre> <p>Response <code>(output.json)</code> will show the same contents of a full retrieval.</p> <p>Please verify changes were applied whether by inspecting LDAP or issuing a GET. If you have followed the steps properly, you should notice a new e-mail added and the change in <code>displayName</code> attribute</p>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#updating-a-user-patch","title":"Updating a User (PATCH)","text":"<p>With patching, you can be very precise about the modifications you want to apply. Patching syntax follows JSON Patch spec (RFC 6902) closely. While it's not a must to read the RFC to learn how patch works, see section 3.5.2 of SCIM protocol (RFC 7644) to get the grasp.</p> <p>If you prefer reading code, patch test cases found in the Java scim-client project are worth to look at.</p> <p>The following is a simple example that illustrates the kind of modifications developers can achieve via <code>PATCH</code>. Overwrite your <code>input.json</code> with the following:</p> <pre><code>{\n  \"schemas\": [\n    \"urn:ietf:params:scim:api:messages:2.0:PatchOp\"\n  ],\n  \"Operations\": [\n    {\n      \"op\": \"replace\",\n      \"value\": {\n        \"name\": {\n          \"givenName\": \"Joey\"\n        }\n      }\n    },\n    {\n      \"op\": \"replace\",\n      \"path\": \"emails[type eq \\\"work\\\" or primary eq false].value\",\n      \"value\": \"jensen@example.com\"\n    },\n    {\n      \"op\": \"add\",\n      \"value\": {\n        \"name\": {\n          \"middleName\": \"Jhon\"\n        }\n      }\n    },\n    {\n      \"op\": \"add\",\n      \"value\": {\n        \"emails\": [\n          {\n            \"primary\": true,\n            \"value\": \"my@own.mail\"\n          }\n        ],\n        \"phoneNumbers\": [\n          {\n            \"type\": \"home\",\n            \"value\": \"5 123 8901\"\n          },\n          {\n            \"value\": \"5 123 8902\"\n          }\n        ]\n      }\n    },\n    {\n      \"op\": \"remove\",\n      \"path\": \"name.middleName\"\n    },\n    {\n      \"op\": \"remove\",\n      \"path\": \"phoneNumbers[value ew \\\"01\\\"].type\"\n    }\n  ]\n}\n</code></pre> <p>A collection of modification are provided under \"Operations\". They are processed in order of appearance. Also, every operation has a type; patching supports add, remove and replace.</p> <p>The first operations states the following: replace the value of <code>givenName</code> subattribute (that belongs to complex attribute <code>name</code>) with the string \"Joey\".</p> <p>Operations are easier to understand when using a \"path\". The second operation replaces the value subattribute inside the complex multi-valued attribute emails. Inside the square brackets, we find a filter expression, so the replacement does not apply to all emails in the list but only to those matching the criterion.</p> <p>So the second operation can be read as \"set the value of value subattribute to string <code>jensen@example.com</code> where the type subattribute of the <code>email</code> equals to string \"work\" or if primary attribute is false\".</p> <p>The third operation is similar to the first. It sets the value of a subattribute which was unassigned (null). You could have used \"replace\" operation in this case and results would have been identical.</p> <p>The fourth operation is more interesting. It adds to the current list of emails a new one. It supplies a couple of subattributes for the email to include: primary and value. Additionally, we set the value of (previously unassigned) phoneNumbers multi-valued attribute passing a list of elements.</p> <p>In the fifth operation, we remove the <code>middleName</code> attribute that was set in operation three. Note how we make explicit the path of data to nullify: \"name.middleName\".</p> <p>The sixth operation allows us to remove a specific subattribute of <code>phoneNumbers</code>. The aim is to nullify the \"type\" of the item whose phone number value ends with \"01\". The remove operation can also be used to remove a complete item from a list, or empty the whole list by providing a suitable value for \"path\".</p> <p>Now let's see it in action:</p> <pre><code>curl -k -X PATCH -H 'Authorization: Bearer ACCESS_TOKEN' -H 'Content-Type: application/scim+json' -d @input.json -o output.json https://&lt;jans-server&gt;/jans-scim/restv1/v2/Users/&lt;user-inum&gt;\n</code></pre> <p>So far our resource look like this</p> <pre><code>{\n  \"schemas\": [\n    \"urn:ietf:params:scim:schemas:core:2.0:User\"\n  ],\n  \"id\": \"e3009115-b890-4d8b-bd63-bbfef34aa583\",\n  \"externalId\": \"bjensen\",\n  \"meta\": {\n    \"resourceType\": \"User\",\n    \"created\": \"2023-06-26T19:43:32.945Z\",\n    \"lastModified\": \"2023-06-26T22:34:27.465Z\",\n    \"location\": \"https://raju.jans13.me/jans-scim/restv1/v2/Users/e3009115-b890-4d8b-bd63-bbfef34aa583\"\n  },\n  \"userName\": \"bjensen\",\n  \"name\": {\n    \"familyName\": \"Jensen\",\n    \"givenName\": \"Joey\",\n    \"formatted\": \"Ms. Barbara J Jensen III\"\n  },\n  \"displayName\": \"Jensen Barbara\",\n  \"active\": false,\n  \"emails\": [\n    {\n      \"value\": \"my@own.mail\",\n      \"primary\": true\n    },\n    {\n      \"value\": \"jensen@example.com\",\n      \"type\": \"work\",\n      \"primary\": false\n    }\n  ],\n  \"phoneNumbers\": [\n    {\n      \"value\": \"5 123 8901\"\n    },\n    {\n      \"value\": \"5 123 8902\"\n    }\n  ]\n}\n</code></pre> <p>Note the primary subattribute accompanying <code>email</code> \"my@own.mail\" is false but when inserted we provided <code>true</code>. This is because the SCIM specification states that after modifications are applied to resources (PUT or PATCH), there cannot be more than one item in a multi-valued attribute with primary value set as <code>true</code>.</p> <p>To see more sample <code>JSON</code> payloads, check the <code>.json</code> files used by the scim-client test cases referenced above.</p>","tags":["administration","configuration","user"]},{"location":"janssen-server/config-guide/scim-config/user-config/#deleting-users","title":"Deleting Users","text":"<p>For deleting, the <code>DELETE</code>method of <code>HTTP</code> is used.</p> <p>No input file is used in this case. A delete request could be the following:</p> <pre><code>curl -k -X DELETE -H 'Authorization: Bearer ACCESS_TOKEN' https://&lt;jans-server&gt;/jans-scim/restv1/v2/Users/&lt;user-inum&gt;\n</code></pre> <p>Use the inum of our dummy user, Jensen Barbara.</p> <p>Check your LDAP or via Jans TUI to see that Bjensen is gone.</p>","tags":["administration","configuration","user"]},{"location":"janssen-server/developer/","title":"Developer Guide","text":"<p>Please use the left navigation menu to browse the content of this section while we are still working on developing content for <code>Overview</code> page.</p> <p>Contribute</p> <p>If you\u2019d like to contribute to this document, get started with the Contribution Guide</p>","tags":["administration","developer"]},{"location":"janssen-server/developer/cors/","title":"CORS Filter","text":"<p>CORS Filter is an implementation of the W3C's Cross-Origin Resource Sharing (CORS) specification.</p> <p>The CORS Filter works by adding required <code>Access-Control-*</code> headers to the <code>HttpServletResponse</code> object. The filter also protects against HTTP response splitting. If a request is invalid or not permitted, the request is rejected with HTTP status code 403 (Forbidden).</p> <p>The minimal configuration required to use the CORS Filter is shown below, and is already added to the <code>web.xml</code> in <code>jans-auth.war</code>. The filter name is <code>io.jans.as.server.filter.CorsFilter</code>.</p> <pre><code>    &lt;filter-mapping&gt;\n        &lt;filter-name&gt;CorsFilter&lt;/filter-name&gt;\n        &lt;url-pattern /&gt;\n    &lt;/filter-mapping&gt;\n</code></pre>","tags":["administration","installation"]},{"location":"janssen-server/developer/cors/#configure-cors","title":"Configure CORS","text":"<p>CORS can be configured in Jans Server using <code>Jans TUI</code>. Follow these steps:</p> <ol> <li>Open <code>Jans TUI</code> using <code>jans tui</code> command.</li> <li>Go to <code>Auth Server &gt; Properties</code> and select <code>corsConfigurationFilters</code></li> <li>This will display the CORS Configuration Filter parameters, as shown below:</li> </ol> <p></p> <ol> <li>Define and configure the parameters.</li> <li>Click <code>save</code> at the bottom of the page.</li> </ol>","tags":["administration","installation"]},{"location":"janssen-server/developer/cors/#parameters-supported-by-cors-filters","title":"Parameters supported by CORS Filters","text":"<p>CORS Filter supports the following initialization parameters:</p> Attribute Description corsAllowedOrigins A list of origins that are allowed to access the resource. A <code>*</code> can be specified to enable access to resource from any origin. Otherwise, a whitelist of comma separated origins can be provided. Eg: <code>http://www.w3.org</code>, <code>https://www.apache.org.</code> Defaults: <code>*</code> (Any origin is allowed to access the resource). corsAllowedMethods A comma separated list of HTTP methods that can be used to access the resource, using cross-origin requests. These are the methods which will also be included as part of Access-Control-Allow-Methods header in pre-flight response. Eg: <code>GET</code>, <code>POST</code>. Defaults: <code>GET</code>, <code>POST</code>, <code>HEAD</code>, <code>OPTIONS</code> corsExposedHeaders A comma separated list of request headers that can be used when making an actual request. These headers will also be returned as part of Access-Control-Allow-Headers header in a pre-flight response. Eg: <code>Origin, Accept</code>. Defaults: <code>Origin, Accept, X-Requested-With, Content-Type, Access-Control-Request-Method, Access-Control-Request-Headers</code> corsSupportCredentials A flag that indicates whether the resource supports user credentials. This flag is exposed as part of <code>Access-Control-Allow-Credentials</code> header in a pre-flight response. It helps browser determine whether or not an actual request can be made using credentials. Defaults: <code>true</code> corsLoggingEnabled Value to enable logging, Setting the value to <code>False</code> will disable logging. Defaults: <code>true</code> corsPreflightMaxAge The duration in seconds the browser is allowed to cache the result of the pre-flight request. This will be included as part of the <code>Access-Control-Max-Age</code> header in the pre-flight response. A negative value will prevent the CORS Filter from adding this response header to the pre-flight response. Defaults: <code>1800</code> corsRequestDecorate A flag to control if CORS specific attributes should be added to the HttpServletRequest object. Defaults: <code>true</code>","tags":["administration","installation"]},{"location":"janssen-server/developer/external-libraries/","title":"Using External Libraries In Interception Scripts","text":"<p>Janssen Server Interception script is a powerful tool that enables developers to control many different aspects of the authentication process.</p> <p>It is possible to use external Java libraries in pure Java based interception scripts. If the interception script is implemented in Jython then it is possible to use external Java libraries as well as external Python libraries</p>","tags":["administration","developer","external","libraries"]},{"location":"janssen-server/developer/interception-scripts-debug-ce/","title":"Debugging a custom script:","text":""},{"location":"janssen-server/developer/interception-scripts-debug-ce/#setup","title":"Setup","text":"<p>Assuming that the Jans-auth server is already installed, perform the following steps:</p> <ol> <li>Install https://repo.gluu.org/tools/tools-install.sh</li> <li>Run opt/jans/bin/prepare-dev-tools.py</li> <li>Log in to CE</li> <li> <p>Run /opt/jans/bin/eclipse.sh Once complete, start the PyDev debug server:</p> </li> <li> <p>Open the Eclipse Debug perspective</p> </li> <li>From the menu: <code>Pydev</code> &gt; <code>Start Debug Server</code></li> </ol>"},{"location":"janssen-server/developer/interception-scripts-debug-ce/#development-debugging","title":"Development &amp; Debugging","text":"<ol> <li>Now we are ready to perform script development and debugging. Here is a quick overview:</li> <li>In order to simplify development, put the script into a shared folder like /root/eclipse-workspace</li> <li>Then instruct jans-auth to load the script from the file system instead of  Janssen Server persistence store</li> <li>Add debug instructions to the script, as specified in the next section</li> <li>Execute the script</li> </ol>"},{"location":"janssen-server/developer/interception-scripts-debug-ce/#enable-remote-debug-in-custom-script","title":"Enable Remote Debug in Custom Script","text":"<ol> <li>After the import section, add: <pre><code>REMOTE_DEBUG = True\n\nif REMOTE_DEBUG:\n    try:\n        import sys\n        sys.path.append('/opt/libs/pydevd')\n        import pydevd\n    except ImportError as ex:\n        print \"Failed to import pydevd: %s\" % ex\n        raise\n</code></pre></li> <li>Add the following lines wherever breakpoints are needed:</li> </ol> <pre><code>if REMOTE_DEBUG:\n    pydevd.settrace('localhost', port=5678, stdoutToServer=True, stderrToServer=True)\n</code></pre>"},{"location":"janssen-server/developer/interception-scripts-debug-ce/#example","title":"Example","text":"<ol> <li>Copy the script to /root/eclipse-workspace/basic.py</li> <li>Change script Location type to File using a jans-cli </li> <li>Assume that we're using basic.py,  Specify the Script Path location to: /root/eclipse-workspace/basic.py</li> <li>Enable the script using jans-cli  Check the following log to verify that jans-auth loaded the script properly: /opt/jans/jetty/jans-auth/logs/jans-auth_script.log. It should look like this: <pre><code>... (PythonService.java:239) - Basic. Initialization\n\n... (PythonService.java:239) - Basic. Initialized successfully\n</code></pre></li> <li> <p>Open the following file in Eclipse: /root/eclipse-workspace/basic.py</p> </li> <li> <p>When opening the Python file for the first time, we need to instruct Eclipse to use a specific interpreter. Follow these steps:</p> </li> <li> <p>Press the \"Manual Config\" button in the dialog box after opening the Python file</p> </li> <li>Open \"PyDev-&gt;Interpreters-&gt;Jython Interpreters\"</li> <li>Click the \"New...\" button in the right panel. Name it \"Jython\" and specify the interpreter executable \"/opt/jython/jython.jar\"</li> <li>Click \"OK\", then confirm the settings by clicking \"OK\" again, then \"Apply and Close\"</li> <li> <p>In the final dialog, confirm the settings by clicking \"OK\"</p> </li> <li> <p>Open basic.py in a file editor. After the import section, add the following lines to load the PyDev libraries: <pre><code>REMOTE_DEBUG = True  \n\nif REMOTE_DEBUG:  \n    try:  \n        import sys  \n        sys.path.append('/opt/libs/pydevd')  \n        import pydevd  \n    except ImportError as ex:  \n        print \"Failed to import pydevd: %s\" % ex  \n        raise  \n</code></pre></p> </li> <li>Add this break condition to the first line in the authenticate method:</li> </ol> <p><pre><code>if REMOTE_DEBUG:   \n    pydevd.settrace('localhost', port=5678, stdoutToServer=True, stderrToServer=True) \n</code></pre> 9. Save basic.py</p> <ol> <li>Within one minute, jans-auth should load the changed file. Check the following log file again to make sure there are no load errors: /opt/jans/jetty/jans-auth/logs/jans-auth_script.log</li> <li> <p>To check if the script works, update the default authentication method to Basic Authentication. Use jans-cli.</p> </li> <li> <p>Open another browser or session and try to log in. Make sure to keep the first session open in order to disable the Basic Authentication method in case the script doesn't work as expected.</p> </li> <li>After executing <code>pydevd.settrace</code> the script will transfer execution control to the PyDev server in Eclipse. You can use any debug commands. For example: Step Over (F6), Resume (F8), etc</li> <li>After debugging is finished, resume script execution to transfer execution control back to jans-auth</li> </ol>"},{"location":"janssen-server/developer/interception-scripts-debug-ce/#useful-link-httpswwwpydevorgmanual_adv_remote_debuggerhtml","title":"Useful link : https://www.pydev.org/manual_adv_remote_debugger.html","text":""},{"location":"janssen-server/developer/interception-scripts-debug-ce/#x-server-troubleshooting-running-optjansbinprepare-dev-toolspy-allows-eclipse-to-access-x-server","title":"X Server troubleshooting : Running <code>/opt/jans/bin/prepare-dev-tools.py</code> allows Eclipse to access X server.","text":"<p>It runs the following commands: <pre><code># Only this one key is needed to access from chroot \nxauth -f /root/.Xauthority-jans generate :0 . trusted 2&gt;1 &gt;&gt; /root/prepare-dev-tools.log\n\n# Generate our own key, xauth requires 128 bit hex encoding\nxauth -f /root/.Xauthority-jans add ${HOST}:0 . $(xxd -l 16 -p /dev/urandom)\n\n# Copy result key to chroot\ncp -f /root/.Xauthority-jans /root/.Xauthority\n\n# Allow to access local server X11   \nsudo su $(logname) -c \"xhost +local:\n</code></pre></p>"},{"location":"janssen-server/developer/interception-scripts-debug-ce/#unable-to-access-x11","title":"Unable to access x11","text":"<p>If Eclipse is unable to access X11, run the following command from the host to check if it has the necessary permissisons: <pre><code>user@u144:~$ xhost +local:\nnon-network local connections being added to access control list\nuser@u144:~$ xhost \naccess control enabled, only authorized clients can connect\nLOCAL:\nSI:localuser:user\n</code></pre> If the user is still unable to access X11, remove .Xauthority from user home and log out/log in again.</p>"},{"location":"janssen-server/developer/managed-beans/","title":"Managed Beans","text":"","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#ready-to-use-code-in-custom-script","title":"Ready-to-use code in Custom script:","text":"<p>Jans-auth server uses Weld 3.0 (JSR-365 aka CDI 2.0) for managed beans. The most useful functions are implemented through a set of beans which can be re-used in all custom scripts.</p>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#obtaining-a-bean-inside-a-custom-script","title":"Obtaining a bean inside a custom script:","text":"<p>CdiUtil used to obtain managed beans inside a custom script.</p> <p>Relevant methods:</p> Signature Description  T bean(Class clazz) Gets the managed bean belonging to the class passed as parameter <p>Usage (jython code): Suppose UserService and AuthenticationService beans have to be referenced in the code, it can be done as below:</p> <pre><code>from io.jans.as.server.service import UserService\nfrom io.jans.as.server.service import AuthenticationService\n...\nuserService = CdiUtil.bean(UserService)\nauthenticationService = CdiUtil.bean(AuthenticationService)\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#commonly-used-beans","title":"Commonly used beans:","text":"","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#1-authenticationservice","title":"1. AuthenticationService","text":"<p>Allows to authenticate a user or obtain the current authenticated user  Relevant methods:</p> Signature Description <code>boolean authenticate(String userName)</code> Performs authentication for the user whose identifier (<code>userName</code>) is passed as parameter <code>boolean authenticate(String userName, String password)</code> Performs authentication for the user whose identifier (<code>userName</code>) is passed as parameter. The <code>password</code> supplied must be the correct password of the user in question <code>User getAuthenticatedUser()</code> Returns a representation of the currently authenticated user. <code>null</code> if no user is currently authenticated. See User data object <p>Usage: <pre><code>from io.jans.as.server.service import AuthenticationService\n...\n\n#1. authenticate a user using username and password\nauthenticationService = CdiUtil.bean(AuthenticationService)\nlogged_in = authenticationService.authenticate(user_name, user_password)\n\n# 2. authenticate method without passing password parameter\nlogged_in = authenticationService.authenticate(user_name)\n\n#3. obtain an authenticated user\nuser = authenticationService.getAuthenticatedUser()\nuserName = user.getUserId()\nemailIds = user.getAttribute(\"oxEmailAlternate\")\n</code></pre></p>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#2-userservice","title":"2.  UserService","text":"<p>Allows CRUD operations for users to the local persistence.</p> <p>Relevant methods:</p> Signature Description <code>User addUser(User user, boolean active)</code> Creates a new user based on the representation passed as parameter. <code>active</code> parameter denotes whether user status (<code>gluuStatus</code> attribute) will be <code>active</code> or <code>register</code> <code>User addUserAttribute(String userId, String attributeName, String attributeValue)</code> Adds an attribute to the user identified by <code>userId</code> in the database with the name and value passed. Returns a representation of the modified user or <code>null</code> in case of failure or if such name/attribute is already part of such user <code>boolean addUserAttribute(User user, String attributeName, String attributeValue)</code> Adds an attribute to the <code>user</code> object with the name and value passed. This method only alters the <code>user</code> argument and does not persist changes. Returns <code>false</code> if such name/attribute is already part of <code>user</code> <code>User addUserAttributeByUserInum(String userInum, String attributeName, String attributeValue)</code> Adds an attribute to the user whose <code>inum</code>  attribute (in the database) equals to <code>userInum</code> using the name and value passed. Returns a representation of the modified user or <code>null</code> in case of failure or if such name/attribute is already part of such user <code>CustomAttribute getCustomAttribute(User user, String attributeName)</code> Gets a representation of the attribute whose name is passed for the user in question (<code>user</code>). Returns <code>null</code> if no such attribute is populated <code>String getDnForUser(String inum)</code> Obtains the DN (distinguished name) of the user whose <code>inum</code> attribute equals to <code>userInum</code> (no check that such user may exist is actually made) <code>User getUser(String userId, String... returnAttributes)</code> Retrieves a user representation for the user identified with <code>userId</code> containing only the attributes requested (<code>returnAttributes</code>). <code>null</code> is returned if no such user exists <code>User getUserByAttribute(String attributeName, String attributeValue)</code> Retrieves a user (first available) such that the attribute referenced (<code>attributeName</code>) has the value passed (<code>attributeValue</code>). <code>null</code> is returned if no such user exists <code>String getUserInum(String userId)</code> Retrieves the <code>inum</code> database attribute for the user identified with <code>userId</code>.<code>null</code> is returned if no such user exists <code>User removeUserAttribute(String userId, String attributeName, String attributeValue)</code> Removes <code>attributeValue</code> from the values of the attribute whose name is passed (<code>attributeName</code>) for the user identified with <code>userId</code> <code>User replaceUserAttribute(String userId, String attributeName, String oldAttributeValue, String newAttributeValue)</code> Updates the user identified with <code>userId</code> by replacing the value of the attribute <code>attributeName</code> with the value passed. <code>null</code> is returned if no such user exists <code>void setCustomAttribute(User user, String attributeName, String attributeValue)</code> Sets the value of the attribute <code>attributeName</code> with the single value <code>attributeValue</code> for the user representation passes as parameter. This method does not persist changes <code>User updateUser(User user)</code> Updates the user represented by <code>user</code> object in the database","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#usage","title":"Usage","text":"","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#a-add-a-user","title":"a. Add a user","text":"<pre><code>from  io.jans.as.common.service.common import UserService\nfrom io.jans.orm.model.base import CustomObjectAttribute;\n...\n\nnew_user = User()\nfound_user.getCustomAttributes().add(new CustomObjectAttribute(\"address\", Arrays.asList(\"London\", \"Texas\", \"Kiev\")));\nfound_user.getCustomAttributes().add(new CustomObjectAttribute(\"jansGuid\", \"test_value\"));\nfound_user.getCustomAttributes().add(new CustomObjectAttribute(\"birthdate\", new Date()));\nfound_user.getCustomAttributes().add(new CustomObjectAttribute(\"jansActive\", false));\nfound_user.getCustomAttributes().add(new CustomObjectAttribute(\"scimCustomThird\", 18));\nfound_user.setUserRole(UserRole.ADMIN);\nfound_user.setMemberOf(Arrays.asList(\"group_1\", \"group_2\", \"group_3\"));\n\nCustomObjectAttribute multiValuedSingleValue = new CustomObjectAttribute(\"oxExternalUid\", \"multivalued_single_valued\");\nmultiValuedSingleValue.setMultiValued(true);\nfoundUser.getCustomAttributes().add(multiValuedSingleValue);\n\nnew_user = CdiUtil.bean(UserService).addUser(new_user, True)\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#b-add-user-attributes","title":"b. Add user attributes","text":"<pre><code>userObject = userService.addUserAttribute(user_name, \"oxExternalUid\", cert_user_external_uid, true)\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#c-get-user","title":"c. Get User","text":"<pre><code># example 1 - get User by userId\nuser = userService.getUser(user_name)\n\n# example 2 - get User by User-Id only if attribute oxExternalUid is populated\nuser = userService.getUser(user_name, \"oxExternalUid\")\ncustomAttributeValue = userService.getCustomAttribute(user, \"oxExternalUid\")\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#d-get-specific-user-attribute","title":"d. Get specific User attribute","text":"<pre><code>status_attribute_value = userService.getCustomAttribute(find_user_by_uid, \"gluuStatus\")\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#e-replace-user-attributes","title":"e. Replace user attributes","text":"<pre><code>userService.replaceUserAttribute(user_name, \"oxOTPCache\", cachedOTP, localTotpKey)\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#f-remove-user-attribute","title":"f. Remove user attribute","text":"<pre><code>userService.removeUserAttribute(user.getUserId(),\"oxTrustExternalId\", \"wwpass:%s\"%puid)\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#g-update-users","title":"g. Update users","text":"<pre><code>found_user = userService.getUser(user_name)\n\nfound_user.getCustomAttributes().add(new CustomObjectAttribute(\"address\", Arrays.asList(\"London\", \"Texas\", \"Kiev\")));\nfound_user.getCustomAttributes().add(new CustomObjectAttribute(\"jansGuid\", \"test_value\"));\nfound_user.getCustomAttributes().add(new CustomObjectAttribute(\"birthdate\", new Date()));\nfound_user.getCustomAttributes().add(new CustomObjectAttribute(\"jansActive\", false));\nfound_user.getCustomAttributes().add(new CustomObjectAttribute(\"jansActive\", false));\nfound_user.getCustomAttributes().add(new CustomObjectAttribute(\"scimCustomThird\", 18));\nfound_user.setUserRole(UserRole.ADMIN);\nfound_user.setMemberOf(Arrays.asList(\"group_1\", \"group_2\", \"group_3\"));\n\nuserService.updateUser(found_user)\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#4-user","title":"4.  User","text":"<p>A class employed to represent a user entry in the persistence. Provides getters and setters to retrieve and assign value(s) for attributes</p>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#5-customattribute","title":"5. CustomAttribute","text":"<p>A class that models an attribute. An attribute has a name and a collection of associated values</p>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#6-identity","title":"6. Identity","text":"<p>The authentication flow in jans-auth server is stateless and the instance is preserved because the Identity parameters (another name for session parameters) are persisted in databases. A function in the <code>PersonAuthenticationType</code> script called <code>getExtraParametersForStep</code> should be overridden to include any new session variable. The underlying Jans-auth server takes care of retrieving it, persisting it etc.</p> <p><pre><code>def getExtraParametersForStep(self, configurationAttributes, step):\n       return Arrays.asList(\"sessionParamName1\", \"sessionParamName2\", \"sessionParamName3\")\n</code></pre> Bean details: |Signature|Description| |-|-| |<code>Object getWorkingParameter(String name)</code>|Retrieves a working parameter by name previously set via <code>setWorkingParameter</code>| |<code>void setWorkingParameter(String name, Object value)</code>|Binds data to a name for further use in an authentication flow. Recommended values to store are <code>String</code>s| |<code>SessionId getSessionId()</code>|Retrieves a reference to the associated server session object, see SessionId|</p> <p>Usage <pre><code>from io.jans.as.server.security import Identity\nidentity = CdiUtil.bean(Identity)\n\n#1.\nnewExpDate = identity.getWorkingParameter(\"expDate\")\n\n#2.\nidentity.setWorkingParameter(\"expDate\", expDate)\n\n#3.\nsession_attributes = identity.getSessionId().getSessionAttributes()\nsession_attributes.containsKey(\"remote_ip\")\n</code></pre></p>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#8-sessionidservice","title":"8. SessionIdService","text":"<pre><code>#1. get session\nsessionIdservice = CdiUtil.bean(SessionIdService).getSessionId()\n\n#2. update session\n\nsessionIdservice.getSessionAttributes().put(key, value)\nsessionIdservice.updateSessionId(session)\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#9-grantservice","title":"9. GrantService","text":"","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#10-clientservice-provides-operations-with-clients","title":"10. ClientService : Provides operations with clients.","text":"<p>Usage: <pre><code>from io.jans.as.server.service import ClientService\n\nclientService = CdiUtil.bean(ClientService)\nclient = clientService.getClient(clientId)\n</code></pre></p>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#7-httpservice-httpservice","title":"7. HttpService: HttpService","text":"<p>Provides utility methods to execute HTTP requests, manipulate responses, etc</p> <p>Relevant methods:</p> Signature Description <code>HttpClient getHttpsClient()</code> Returns an instance of <code>org.apache.http.client.HttpClient</code> (see oxcore-util class SslDefaultHttpClient) <code>HttpServiceResponse executeGet(HttpClient httpClient, String requestUri)</code> Perform a GET on the URI requested. Returns an instance of io.jans.as.server.model.net.HttpServiceResponse  (a wrapper on <code>org.apache.http.HttpResponse</code>) <code>byte[] getResponseContent(HttpResponse httpResponse)</code> Consumes the bytes of the associated response. Returns <code>null</code> if the response status code is not 200 (OK)","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#8-cacheservice","title":"8.  CacheService","text":"<p>Provides a unified means to interact with the underlying cache provider configured in the Jans-auth Server</p> <p>Relevant methods:</p> Signature Description <code>void clear()</code> Flushes the whole cache <code>Object get(String key)</code> Retrieves the value of <code>key</code> in the cache. <code>null</code> if there is no such key present <code>void put(int expirationInSeconds, String key, Object object)</code> Puts an object in the cache associated to the key passed. An expiration in seconds can be provided <code>put(String key, Object object)</code> Puts an object in the cache associated to the key passed. The expiration used is the default expiration configured in Gluu <code>void remove(String key)</code> Removes an entry from the cache","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#9-facesservice-provides-utilities-to-properly-build-encoded-urls-and-make-redirections-this-class-is-used-a-great-deal-in-custom-scripts","title":"9. FacesService : Provides utilities to properly build encoded URLs and make redirections. This class is used a great deal in custom scripts","text":"<p>Relevant methods:</p> Signature Description <code>void redirectToExternalURL(String url)</code> Redirects the user's browser to the URL passed as parameter <code>String encodeParameters(String url, Map&lt;String, Object&gt; parameters)</code> Builds a URL by appending query parameters as supplied in <code>parameters</code> map. Every value in the map is properly URL-encoded","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#10-facesmessages","title":"10.  FacesMessages","text":"<p>Allows manipulation of JSF context messages</p> <p>Relevant methods:</p> Signature Description <code>void add(Severity severity, String message)</code> Adds a message to the JSF context with the severity (<code>javax.faces.application.FacesMessage.Severity</code>) specified <code>void clear()</code> Clears the messages of the JSF context <code>String evalAsString(String expression)</code> Evaluates an EL expression using the JSF context and returns the result as a String <code>void setKeepMessages()</code> Sets the \"keep messages\" property of the JSF flash","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#11-stringhelper","title":"11. StringHelper","text":"<p>Provides many utility methods that often arise in the manipulation of Strings Usage:</p> <pre><code>from io.jans.util import StringHelper\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#isnotemptystring","title":"isNotEmptyString","text":"<pre><code>if StringHelper.isNotEmptyString(user_name):\n  # do something\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#equalsignorecase","title":"equalsIgnoreCase","text":"<pre><code>if StringHelper.equalsIgnoreCase(authentication_mode, \"one_step\"):\n  # do something\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#isempty","title":"isEmpty","text":"<pre><code>if StringHelper.isEmpty(auth_method):\n  # do something\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#split","title":"split","text":"<pre><code>allowedClientsListArray = StringHelper.split(allowedClientsList, \",\")\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#tolowercase","title":"toLowerCase","text":"<pre><code>remoteAttribute = StringHelper.toLowerCase(remoteAttributesListArray[i])\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#base64urlencode","title":"base64urlencode","text":"<pre><code>StringUtils.base64urlencode(input);\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#13-encryptionservice","title":"13. EncryptionService","text":"<p>Allows to encrypt/decrypt strings using a 3DES cipher whose salt is found in <code>/etc/jans/conf/salt</code></p> <p>Relevant methods:</p> Signature Description String decrypt(String encryptedString) Decrypts the encrypted string supplied Properties decryptAllProperties(Properties connectionProperties) Returns a <code>java.util.Properties</code> object with all decrypted values found in <code>connectionProperties</code> <code>String encrypt(String unencryptedString)</code> Encrypts the string supplied","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#usage_1","title":"Usage:","text":"<pre><code>from io.jans.as.common.service.common import EncryptionService\n....\n\nencryptionService = CdiUtil.bean(EncryptionService)\npwd_decrypted = encryptionService.decrypt(\"stringtobedecrypted\")\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/managed-beans/#14-base64util","title":"14. Base64Util","text":"<p>Usage:</p> <pre><code>from io.jans.as.model.util import Base64Util\n....\n\nBase64Util.base64urldecodeToString(input_string)\n\nBase64Util.base64urlencode(input_string.encode('utf-8')));\n</code></pre>","tags":["administration","developer","bean","CdiUtil"]},{"location":"janssen-server/developer/xframe/","title":"X-Frame-Options Header","text":"<p>AS has <code>io.jans.as.server.filter.HeadersFilter</code> which is responsible for attaching headers to server responses.</p> <pre><code>    &lt;filter-mapping&gt;\n        &lt;filter-name&gt;HeadersFilter&lt;/filter-name&gt;\n        &lt;url-pattern /&gt;\n    &lt;/filter-mapping&gt;\n</code></pre>","tags":["administration","installation","x-frame","header"]},{"location":"janssen-server/developer/xframe/#configure-x-frame-options-header","title":"Configure X-Frame-Options Header","text":"<p>The <code>X-Frame-Options</code> HTTP response header can be used to indicate whether a browser should be allowed to render a page in a <code>&lt;frame&gt;</code>, <code>&lt;iframe&gt;</code>, <code>&lt;embed&gt;</code> or <code>&lt;object&gt;</code>. Sites can use this to avoid clickjacking attacks, by ensuring that their content is not embedded into other sites.</p> <p>There are two AS configuration properties related to <code>X-Frame-Options</code>:</p> <ul> <li><code>xframeOptionsHeaderValue</code> - sets value of <code>X-Frame-Options</code> header. Default value is <code>SAMEORIGIN</code>. Possible values are: <code>SAMEORIGIN</code> or <code>DENY</code>.</li> <li><code>applyXFrameOptionsHeaderIfUriContainsAny</code> - array of strings. If incoming request contains any string from this array it will attach <code>X-Frame-Options</code> header to response.</li> </ul> <p>By default AS attaches <code>X-Frame-Options</code> header to all responses where request uri contains <code>.htm</code>. It means for all AS pages.</p>","tags":["administration","installation","x-frame","header"]},{"location":"janssen-server/developer/agama/advanced-usages/","title":"Advanced usages","text":"","tags":["developer","agama"]},{"location":"janssen-server/developer/agama/advanced-usages/#ui-templates","title":"UI templates","text":"","tags":["developer","agama"]},{"location":"janssen-server/developer/agama/advanced-usages/#template-overrides","title":"Template overrides","text":"<p>Template overrides is a mechanism that allows templates customization and promotes flows reuse. If an existing flow serves well the needs of a new flow you are writing, with this feature you can homogenize your UI for a more pleasant user experience.</p> <p>To start, use <code>Trigger</code> to play around with the existing flow - as is - from the flow you are creating. Collect the URLs of the pages you are not comfortable with: grab them directly from the browser's address bar. Then proceed as follows with every URL to locate the actual templates physically:</p> <ol> <li>Remove the <code>https://.../fl/</code> portion of the URL</li> <li>Split the URL obtained into two pieces: a folder name and a remainder. The remainder starts after the last slash found in the URL, and usually ends in <code>.fls</code></li> <li>In your Janssen server, locate the directory <code>/opt/jans/jetty/jans-auth/agama/ftl</code></li> <li><code>cd</code> to the directory specified by the folder</li> <li>List the contents of the directory and pick the filename that best matches the remainder</li> </ol> <p>Save a copy of every selected file in the directory associated to your flow (<code>basePath</code> directive) or in a subdirectory of it. Rename the files if desired too.</p> <p>Now, build the <code>Override templates</code> directive passing several pairs of strings separated by lines or spaces. Every pair consists of a string specifying the original template location, that is, <code>&lt;folder&gt;/&lt;filename&gt;</code> followed by the path to the new template version relative to the base path of your flow.</p>","tags":["developer","agama"]},{"location":"janssen-server/developer/agama/advanced-usages/#output-encoding","title":"Output encoding","text":"<p>By default, the engine sends rendered pages using <code>UTF-8</code> character encoding. To specify a different encoding the <code>ftl</code> directive can be used in pages, for instance, <code>&lt;#ftl encoding=\"ISO-8859-5\"&gt;</code>. Always place this at the top of a template.</p>","tags":["developer","agama"]},{"location":"janssen-server/developer/agama/advanced-usages/#localization-and-internationalization","title":"Localization and internationalization","text":"<p>To allow templates render text according to users' language or country, you can add a file named <code>labels.txt</code> to the <code>web</code> directory of a project. There you can place the so-called \"internationalization labels\" (common UI-related messages) as per your needs. The file is expected to have a structure as follows:</p> <pre><code>key = value\n\n... more key/value pairs\n\n[ locale ID 1 ]\n\nkey/value pairs for this locale\n\n[ locale ID 2 ]\n\nkey/value pairs for this locale\n\n...\n[ locale ID n ]\n\nkey/value pairs for this locale\n</code></pre> <p>Note how the file is split into sections for every locale to support. The first section (no locale) will contain the \"default\" labels - more on this later. One locale conveys mostly the same concept of a Java locale (class <code>java.util.Locale</code>). In this case, a locale represents a language, country/region, and variant combination. Examples of locale IDs are:</p> <ul> <li><code>de_CH</code>: German as used in Switzerland</li> <li><code>ca_ES_VALENCIA</code>: Catalan as used in Spain (province of Valencia)</li> <li><code>th_TH_TH</code>: Thai as used in Thailand together with Thai digits</li> <li><code>ja</code>: Japanese (in general)</li> </ul> <p>There may be several sections regarding the same language, like <code>de_CH</code>, <code>de_DE</code>, <code>de_LU</code>, and plain <code>de</code>. Agama engine will pick the text from the section that best maches the settings of the end-user browser (normally, this is supplied through the <code>Accept-Language</code> HTTP header). As an example, if the browser's preferred language is German from Luxembourg, the lookup is made in <code>de_LU</code> section. If no text is found there, the <code>de</code> section is tried. The opening \"no locale\" section is used as a last resort - that's why it is said to contain the \"default\" labels.</p> <p>To reference a label from a template an expression like <code>${labels(\"&lt;KEY&gt;\")}</code> can be used. This will retrieve the proper text using the rules just described. When the lookup fails thoroughly (no way to found a label matching the key), the four character string <code>null</code> is returned. This helps to easily locate template issues if any.</p> <p>A value (message) associated to a key can contain placeholders where data can be injected. Suppose the following key/value pair:</p> <pre><code>disk.count = The disk {1} contains {0} file(s)\n</code></pre> <p>Using <code>${labels(\"disk.count\")}</code> will just retrieve the message as is, however, positional arguments can be passed. As an example, <code>${labels(\"disk.count\", 7, \"SSD-NVME-123\")}</code> will generate <code>The disk SSD-NVME-123 contains 7 file(s)</code>. Note parameters are not restricted to literals (fixed values) like <code>0</code>, <code>false</code>, or <code>\"world\"</code>. Variables can also be used. It is recommended to employ literals/variables whose data types are string, number, date, or boolean only.</p> <p>Labels are global: not only can they be accessed from the project where they are originally defined but from any other project. This allows template overrides to work smoothly, however, it brings the possibility of key collisions, that is, two or more projects defining labels with the same keys. To mitigate this problem, it is recommended to prefix all keys with the name/identifier of the originating project, like:</p> <pre><code>myproject.salutation = hello!\n\n[es]\nmyproject.salutation = hola!\n\n[it]\nmyproject.salutation = ciao!\n</code></pre> <p>When leaving <code>salutation</code> alone, it is likely other projects added to the server in the future may contain their own version of <code>salutation</code> leading to unexpected results.</p> <p>Additional notes:</p> <ul> <li>Language codes should follow the ISO 639 alpha-2 standard</li> <li>Country/region codes should be driven by ISO 3166 alpha-2 or UN M.49 numeric-3 area code</li> <li>Except for the locale section headings, the syntax of <code>labels.txt</code> adheres to that of Java properties files. This is a human-friendly, low-surpise format: a label key starts a line and its value comes after an equal sign or a colon. For readability one or more empty lines can be used between contiguous key/value pairs. Any line starting with <code>!</code> or <code>#</code>  is ignored and thus can be used as a comment or note </li> <li>When positional arguments are passed, Java class <code>java.text.MessageFormat</code> is internally employed. This allows  powerful formatting and proper handling of plurals. If for some reason, formatting fails, the resulting string will be <code>error!</code>. Check the server logs and try to simplify your message in this case</li> </ul>","tags":["developer","agama"]},{"location":"janssen-server/developer/agama/advanced-usages/#access-to-as-labels","title":"Access to AS labels","text":"<p>The jans-auth server comes with a series of files known as \"resource bundles\" that follow the naming <code>jans-auth_xx.properties</code> where <code>xx</code> represents an ISO 639 language code. Bundles can be added or overridden by placing suitable properties files in directory <code>/opt/jans/jetty/jans-auth/custom/i18n</code>. Strings stored in these bundles can be accessed from templates using expressions like <code>${msgs.&lt;KEY&gt;}</code>. As most keys in resource bundles contain dot characters, the alternative notation <code>${msgs[\"KEY\"]}</code> works better for FreeMarker, for example <code>${msgs[\"login.errorMessage\"]}</code>.</p> <p>Whenever possible, it is recommended to place your internationalization labels in the <code>web</code> folder of the project and use the <code>${labels(...</code> notation instead. Note <code>msgs</code> has no support for parameterized placeholders: strings are all static.</p>","tags":["developer","agama"]},{"location":"janssen-server/developer/agama/advanced-usages/#reusable-templates","title":"Reusable templates","text":"<p>A widespread practice in web page authoring is to compose pages based on reusable pieces. As an example, the need for a common header and footer is ubiquitous in HTML projects. With FreeMarker, composition can be achieved by means of macros. These are the equivalent to functions in programming, they can generate output based on parameters passed and can be called anywhere in a template.</p> <p>Agama already makes use of macros for this purpose. Take a look at the <code>ftlh</code> files found at <code>/opt/jans/jetty/jans-auth/agama</code>. These templates are used to present errors, like timeouts, flow crashes, etc.</p> <p>Example:</p> <p>Here, two pages will be built to demonstrate the concept of composition in FreeMarker templates: a homepage and an \"about us\" page. These will be made up of a header, a sidebar, and their respective main content. Assume the sidebar should be shown only for the home page.</p> <p>Note</p> <p>FreeMarker comments are of the form <code>&lt;#-- This won't be printed in the output --&gt;</code></p> <p>One way to structure the solution is the following:</p> <pre><code>&lt;#-- aside.ftlh --&gt;\n\n&lt;#macro sidebar&gt;\n\n&lt;aside&gt;\n  &lt;h2&gt;Recommended tracks&lt;/h2&gt;\n  &lt;nav&gt;\n    &lt;ul&gt;\n      &lt;li&gt;&lt;a href=\"#\"&gt;Efilnikufesin&lt;/a&gt;&lt;/li&gt;\n      &lt;li&gt;&lt;a href=\"#\"&gt;P.O.N.X.&lt;/a&gt;&lt;/li&gt;\n      &lt;!--li&gt;&lt;a href=\"#\"&gt;Planet caravan&lt;/a&gt;&lt;/li--&gt;\n    &lt;/ul&gt;\n  &lt;/nav&gt;\n&lt;/aside&gt;\n\n&lt;/#macro&gt;\n</code></pre> <p><code>aside.ftlh</code> has static markup for a sidebar. It is defined inside a macro called <code>sidebar</code>.</p> <pre><code>&lt;#-- commons.ftlh --&gt;\n\n&lt;#import \"aside.ftlh\" as sbar&gt;\n\n&lt;#macro header&gt;\n\n&lt;header&gt;\n  &lt;h1&gt;Welcome&lt;/h1&gt;\n  &lt;nav&gt;\n    &lt;ul&gt;\n      &lt;li&gt;&lt;a href=\"#\"&gt;Home&lt;/a&gt;&lt;/li&gt;\n      &lt;li&gt;&lt;a href=\"#\"&gt;About&lt;/a&gt;&lt;/li&gt;\n      &lt;li&gt;&lt;a href=\"#\"&gt;Sign Up&lt;/a&gt;&lt;/li&gt;\n    &lt;/ul&gt;\n  &lt;/nav&gt;\n&lt;/header&gt;\n\n&lt;/#macro&gt;\n\n&lt;#macro main useSidebar=false&gt;\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;body&gt;\n    &lt;@header/&gt;\n    &lt;#if useSidebar&gt;\n       &lt;@sbar.sidebar/&gt;\n    &lt;/#if&gt;\n    &lt;#nested&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n\n&lt;/#macro&gt;\n</code></pre> <p><code>commons.ftlh</code> template imports <code>aside.ftlh</code> associating it with the shortname <code>sbar</code>. Additionally:</p> <ul> <li> <p>It defines two macros: <code>header</code> and <code>main</code>. The macro <code>header</code> generates a static navigation menu</p> </li> <li> <p><code>main</code> macro is the skeleton of a very simple HTML page </p> </li> <li> <p><code>main</code> has a parameter named <code>useSidebar</code> whose default is <code>false</code> </p> </li> <li> <p>The <code>sidebar</code> macro is called using <code>&lt;@sbar.sidebar/&gt;</code> while <code>header</code> with <code>&lt;@header/&gt;</code> (local macro) </p> </li> </ul> <pre><code>&lt;#-- index.ftlh --&gt;\n\n&lt;#import \"commons.ftlh\" as com&gt;\n&lt;@com.main useSidebar=true&gt;\n\n&lt;article&gt;\n  &lt;h1&gt;This is the index page!&lt;/h1&gt;\n  &lt;p&gt;Temporibus ut nisi quibusdam iusto vitae similique laudantium. Minima cumque ducimus sit ut dolores. Autem quam soluta illo et omnis expedita voluptas magnam. Sit aperiam laboriosam magnam et amet deleniti. Sit et velit unde quibusdam esse ullam voluptatem. Enim sint blanditiis dolores. Laborum velit eos dolor ad quaerat. Quo tempora excepturi enim dolor harum sunt ipsa. Quis sit dolorem harum ipsa fuga voluptatem commodi.\n  &lt;/p&gt;\n&lt;/article&gt;\n\n&lt;/@com.main&gt;\n</code></pre> <p><code>index.ftlh</code> is the homepage:</p> <ul> <li> <p>Template <code>commons.ftlh</code> is imported and its macro <code>main</code> called passing <code>true</code> for <code>useSidebar</code></p> </li> <li> <p>The markup inside <code>&lt;@com.main...</code> tag is the content to be \"inserted\" when the <code>&lt;#nested&gt;</code> directive is reached  </p> </li> </ul> <pre><code>&lt;#-- about.ftlh --&gt;\n\n&lt;#import \"commons.ftlh\" as com&gt;\n&lt;@com.main&gt;\n\n&lt;article&gt;\n  &lt;h1&gt;About us&lt;/h1&gt;\n  &lt;p&gt;We don't know ourselves very well.&lt;/p&gt;\n&lt;/article&gt;\n\n&lt;/@com.main&gt;\n</code></pre> <p><code>about.ftlh</code> is the \"about us\" page. It works like the homepage except the sidebar will not be shown.</p>","tags":["developer","agama"]},{"location":"janssen-server/developer/agama/advanced-usages/#cancellation","title":"Cancellation","text":"<p>Important</p> <p>Ensure you have previously gone through the contents of this page before proceeding</p> <p>This is a feature that in conjuction with template overrides allows developers to implement alternative routing and backtracking. Suppose a flow is designed to reuse two or more existing subflows. As expected these subflows are neither aware of each other nor of its parent. How can the parent make so that once the user has landed at a page belonging to a given subflow A be presented the alternative to take another route, say, to subflow B?</p> <p>Clearly a page at flow A can be overridden, however, how to abort A and make it jump to B? The answer is cancellation. Through flow cancellation, a running flow can be aborted and the control returned to one of its parents for further processing. This can achieved by overriding a template so that the POST to the current URL includes a form field named <code>_abort</code>.</p> <p>POSTing this way will provoke the associated <code>Trigger</code> call to return a value like <code>{ aborted: true, data: ..., url: ... }</code> where <code>data</code> is a map consisting of the payload (form fields) sent with the POST. Thus, developers can build custom pages and add for example a button to provoke the cancellation. Then, back in the flow implementation take the user to the desired path. The <code>url</code> property will hold the URL where cancellation took place relative to <code>https://your-server/jans-auth/fl/</code>.</p> <p>As an example, suppose there exists two flows that allow users to enter and validate a one-time passcode (OTP), one flow sends the OTP via e-mail while the other through an SMS. Assume these flows receive a user identifier as input and render a single UI page each to enter the received OTP. If we are interested in building a flow that prompts for username/password credentials and use the SMS-based OTP flow with a customization that consists of showing a link like \"Didn't get an SMS?, send the passcode to my e-mail\", the following is a sketch of an implementation:</p> <pre><code>...\n//validate username/password\n...\n\nresult = Trigger co.acme.SmsOTP userId\n    Override templates \"path/to/enter_otp.ftlh\" \"cust_enter_otp.ftlh\"\n\nWhen result.aborted is true\n    //The user clicked on \"send the passcode to my e-mail\"\n    result = Trigger co.acme.EmailOTP userId\n\nWhen result.success is true\n    result.data = { userId: userId }\n\nFinish result\n</code></pre> <p>The overridden template <code>cust_enter_otp.ftlh</code> would have a form like:</p> <pre><code>...\n&lt;form method=\"post\" enctype=\"application/x-www-form-urlencoded\"&gt;\n    &lt;button type=\"submit\" name=\"_abort\"&gt;\n        Didn't get an SMS?, send the passcode to my e-mail&lt;/button&gt;\n&lt;/form&gt;\n</code></pre> <p>Note you cannot make cancellation occur at an arbitrary point of a flow. It can only happen when a page has been rendered, that is, an <code>RRF</code> directive is in execution. When a flow is aborted and the control returned to a parent, there is no way to \"resume\" execution of the flow target of the cancellation.</p>","tags":["developer","agama"]},{"location":"janssen-server/developer/agama/advanced-usages/#cancellation-bubble-up","title":"Cancellation bubble-up","text":"<p>In order to override a page, the path to the corresponding template can be easily derived from the URL seen at the browser's address bar when the subflow is <code>Trigger</code>ed. Note the page may not necessarily belong directly to the subflow  triggered but probably to another flow lying deep in a chain of <code>Trigger</code> invocations.</p> <p>As an example suppose you are interested in building a flow A that reuses flow B. You identify a page shown that needs to be overridden. It might happen this page is actually rendered by C - a flow that B in turn reuses. In scenarios like this cancellation still works transparently and developers need not be aware of flows dependencies. In practice, when cancellation occurs at C, it bubbles up to B and then to A, which is the target of this process.</p> <p>Note that even flow B (as is) may also be overriding C's templates. Resolution of a template path takes place from the inner to the outer flow, so it occurs this way in the example:</p> <ol> <li> <p><code>path</code> is as found in C's <code>RRF</code> instruction</p> </li> <li> <p><code>path</code> is looked up on the list provided in B's <code>Override templates</code>. If a match is found, <code>path</code> is updated accordingly </p> </li> <li> <p><code>path</code> is looked up on the list provided in A's <code>Override templates</code>. If a match is found, <code>path</code> is updated accordingly</p> </li> <li> <p>The page referenced by <code>path</code> is rendered</p> </li> </ol>","tags":["developer","agama"]},{"location":"janssen-server/developer/agama/advanced-usages/#engine-internals","title":"Engine internals","text":"<p>Here we provide insight on some behavioral aspects of the engine that may result of interest to developers.</p>","tags":["developer","agama"]},{"location":"janssen-server/developer/agama/advanced-usages/#flow-advance-and-navigation","title":"Flow advance and navigation","text":"<p>Once a web page (or a response in general) is replied to a client (e.g. web browser), a POST is required to make the flow proceed. The POST is expected to be sent to the current URL only, otherwise, a 404 error will be thrown. The engine will then respond with a redirect (usually 301) so the client will GET the next URL to be rendered. This pattern of navigation is known as \"POST-REDIRECT-GET\".</p> <p>There is a clear correspondence of the \"current URL\" with the physical path of the template rendered. As an example, if the browser location shows <code>https://&lt;your-host&gt;/jans-auth/fl/foo/bar.fls</code>, the involved template is stored at <code>/opt/jans/jetty/jans-auth/agama/ftl/foo</code> and has name <code>bar</code>. This makes flows more predictable and easier to reason about.</p> <p>Note however URLs are not manipulable: an attempt to set the browser location to a URL corresponding to a different template will not make that template be rendered or provoke any unexpected jump in the flow control. Instead, an error page is shown that allows users to re-take where they left off or to restart from scratch. In other words, navigation honors the \"current flow URL\" avoiding attempts to re-visit past stages or make unexpected moves to future ones.</p> <p>Additionally, the engine by default sends responses with proper HTTP headers so page contents are not cached. This is key to prevent manipulation and allows a safe usage of the browser's back button, where it will not be possible to visit past stages.</p>","tags":["developer","agama"]},{"location":"janssen-server/developer/agama/advanced-usages/#code-transpilation","title":"Code transpilation","text":"<p>The engine has some timers running in the background. One of them transpiles code when a change is detected in a given flow's source (written in Agama language). The transpilation process generates vanilla Javascript code runnable through Mozilla Rhino by using a transformation chain like  (DSL) flow code -&gt; (ANTLR4) parse tree -&gt; (XML) abstract syntax tree -&gt; JS.</p> <p>The transformation chain guarantees that a flow written in Agama DSL cannot:</p> <ul> <li>Access Java classes/instances not specified in the original flow code (i.e. the only bridge to Java world is via <code>Call</code>s)</li> <li>Access/modify the standard javascript built-in objects directly</li> <li>Conflict with javascript keywords</li> </ul> <p>Notes</p> <ul> <li>You can find the (ANTLR4) DSL grammar here.</li> <li>The last step of the transformation chain is carried out by means of this Freemarker transformer</li> </ul>","tags":["developer","agama"]},{"location":"janssen-server/developer/agama/advanced-usages/#other-engine-characteristics","title":"Other engine characteristics","text":"<p>Some interesting facts for the curious:</p> <ul> <li>The engine does not use asynchronous paradigms: no events, callbacks, extra threads, etc. All computations remain in the classic request/response servlet lifecycle familiar to most Java developers</li> <li>Continuations allow to express a flow as if it were a straight sequence of commands despite there are actual pauses in the middle: the gaps between an HTTP response and the next request</li> <li>Currently Mozilla Rhino seems to be the only mechanism that brings continuations into the Java language</li> <li>In order to preserve server statelessness, continuations are persisted to storage at every flow pause. This way the proper state can be restored when the continuation is resumed in the upcoming HTTP request</li> </ul>","tags":["developer","agama"]},{"location":"janssen-server/developer/agama/agama-best-practices/","title":"Recommended practices in Agama development","text":"","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/agama-best-practices/#project-reuse-and-customizations","title":"Project reuse and customizations","text":"<p>Agama was designed with reusability in mind. If a project provides functionalities of your interest but you find it does not quite achieve what you want, do not try to modify the project. Instead, create a new separate project reusing the flows and code found in the original project.</p> <p>It might be tempting to just take an Agama project archive, apply some editions, add files to it, repack, and redeploy it. This practice is not recommended. Think of a project as a library used to develop software. In normal situations you will not to hack or patch a library but use wrapper code to override or tailor its behavior.</p> <p>Agama provides a couple of vehicles to manipulate behavior and appearance:</p> <ul> <li>Template overrides</li> <li>Flow cancellation</li> </ul> <p>These allow you to preserve encapsulation and keep project intrusiveness controlled.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/agama-best-practices/#about-flow-design","title":"About flow design","text":"<p>It is up to developers how to design a flow. This will normally require identifying the several \"steps\" that make up the \"journey\" and the conditions upon which \"branching\" takes place. Also it is important to check already existing flows in the server that may be reused for the purpose.</p> <p>Agama language was made to structure flows only, not for doing general purpose programming. This means developers have to use Java for doing low-level computations in the Janssen engine. This way, the resulting implementation (in DSL) serves as a depiction of the flow itself, hiding most of the internal details.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/agama-best-practices/#about-crashes","title":"About crashes","text":"<p>As a flow executes things can go wrong for reasons that developers cannot foresee. A database may have crashed, a connection to an external system may have failed, the flow itself may have some bug, etc. When an abnormal situation is presented, a flow simply crashes.</p> <p>If a flow crashes, its parent flows (or flow) if they exist, crash as well. Trying to handle crashes involves a lot of planning and work which is too costly and will unlikely account for the so many things that might fail in a real setting. Thus, coding defensively is not recommended. While it is possible to deal with Java exceptions (product of <code>Call</code>s) and other abnormalities when <code>Trigger</code>ing flows, these features should be used sparingly.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/agama-best-practices/#internationalization-labels","title":"Internationalization labels","text":"<p>When using localization and internationalization use meaningful label keys and prefix all of them with the name of the project in question. If your project is called <code>magicAuthnJourneys</code>, then <code>magicAuthnJourneys.image.caption</code> and <code>magicAuthnJourneys.start_button_label</code> are good examples. This is a strategy that avoids possible name collisions in labels.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/agama-best-practices/#oop-prose-warning","title":"OOP prose warning","text":"<p>Java support adds the ability to execute pieces of business logic required to build up a flow. These \u201cpieces of logic\u201d match well to Java methods, however situations like this must be avoided:</p> <pre><code>x = \u2026 // A java object obtained in some way\ny = \u2026 // A java object obtained in some way\nCall x methodA arg1 arg2 \u2026\nCall x methodB arg1 arg2 arg3 \u2026\nz = Call y methodC \u2026\nCall x methodD \u2026 z \u2026\n</code></pre> <p>If all those calls represent a meaningful unit of work they should be abstracted out and grouped into a single method invocation which should be thoroughly implemented in Java. Note Agama should not be used to do object-oriented programming but to make a clear, concise representation of a flow. As a rule of thumb, let Java do the heavy work; this is wiser, safer, and faster.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/agama-best-practices/#variable-naming","title":"Variable naming","text":"<p>Camel case is recommended. Also, in real-world flows developers would like to prefix a variable name with <code>j</code> when its value originates from a Java call and does not match any of Agama types directly. Example: <code>jCustomerDetail</code>.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/agama-best-practices/#finishing-flows","title":"Finishing flows","text":"<p>Carefully decide how use the <code>Finish</code> directive in a flow. Specially when terminating sucessfully, many times developers would like to attach the identity of the user in question, as in <code>Finish userId</code>. This results in a successful authentication event and makes sense, but this is not always desired. Sometimes due to decomposition practices (in order to favor re-use and better organization), small flows can arise that should not carry the user identifier.</p> <p>As an example, suppose several flows exist for OTP (one-time passcode) authentication, like SMS, e-mail, token-based, etc. These would receive the user identifier as an input and act accordingly by verifying the passcode the user has entered at the browser. A parent flow can be used to prompt for a username and password first, and then forward the user to the OTP flow that better matches the user's preferences. This sounds fine, however, since any flow can be triggered by means of an authentication request by default, a skilled individual might try to launch one of the OTP flows directly passing proper parameters. This would result in authentications using a single factor (i.e. no password) which is undesirable.</p> <p>Thus, it is recommended to include <code>userId</code> in <code>Finish</code> only when there is a reason to do so, that is, when the authentication carried out by the flow is strong enough. This largely depends on the defined organization policies, but using a two-factor authentication is often a good sign of strength. Another approach is explicitly state which flows  should not be triggered from a browser directly. This can be done in the Agama project descriptor, <code>project.json</code>.</p> <p>Recall the simplest way to express a positive authentication outcome is just <code>Finish true</code>.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/engine-bridge-config/","title":"Engine and bridge configurations","text":"","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/engine-bridge-config/#availability","title":"Availability","text":"<p>The engine and the bridge are two of the components part of the Agama Framework implementation in Janssen. The engine is a piece of software in charge of parsing flows written in Agama DSL and put them into action. The \"bridge\" is a regular jython script that temporarily hands control to the engine when an Agama flow is started, and receives control back once the flow has finished. This script is in charge of completing the authentication process for the user.</p> <p>By default, the bridge is disabled. To activate it do the following:</p> <ul> <li>Open TUI</li> <li>Navigate to <code>Scripts</code> &gt; Search 'agama' &gt; Select the script and hit enter &gt; check <code>enabled</code> &gt; <code>save</code> </li> </ul>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/engine-bridge-config/#engine-configuration","title":"Engine configuration","text":"<p>Some aspects of the engine are configurable and they are integral part of the Jans authentication server's JSON configuration - specifically the section labeled <code>agamaConfiguration</code>. To learn how to perform changes in the server's configuration click here.</p> <p>The properties of Agama engine configuration are described in the following:</p> <ul> <li> <p><code>enabled</code>: A boolean value that specifies if the engine is enabled. To disable the engine, open TUI and navigate to <code>Auth Server</code> &gt; <code>properties</code> &gt; <code>agamaConfiguration</code>. Then uncheck <code>enabled</code> and hit <code>save</code></p> </li> <li> <p><code>templatesPath</code>: A path relative to <code>/opt/jans/jetty/jans-auth/agama</code> that serves as the root of Agama flow pages. Default value is <code>/ftl</code></p> </li> <li> <p><code>scriptsPath</code>: A path relative to <code>/opt/jans/jetty/jans-auth/agama</code> that serves as the root of the hierarchy of (Java/Groovy) classes added on the fly. Default value is <code>/scripts</code></p> </li> <li> <p><code>maxItemsLoggedInCollections</code>: When a list or map is logged   in    a flow, only the first few items are included in the output. You can use this property to increase that limit. Default value is <code>9</code></p> </li> <li> <p><code>pageMismatchErrorPage</code>: A path relative to <code>/opt/jans/jetty/jans-auth/agama</code> containing the location of the page shown when an unexpected URL is requested while a flow is in course. Default value is <code>mismatch.ftlh</code></p> </li> <li> <p><code>interruptionErrorPage</code>: A path relative to <code>/opt/jans/jetty/jans-auth/agama</code> containing the location of the page shown when a user exceeds the amount of time allowed to take a flow to completion. Note that in order to preserve resources, the engine holds references to unfinished flows only for a small period of time (usually less than two minutes). Once the reference is lost, the error page regarded here won't be shown but <code>pageMismatchErrorPage</code>. Default value is <code>timeout.ftlh</code></p> </li> <li> <p><code>crashErrorPage</code>: A path relative to <code>/opt/jans/jetty/jans-auth/agama</code> containing the location of the page shown when an error has occured while running the flow. It contains a brief description of the problem for troubleshooting. Default value is <code>crash.ftlh</code></p> </li> <li> <p><code>finishedFlowPage</code>:  A path relative to <code>/opt/jans/jetty/jans-auth/agama</code> containing the location of the page shown when a flow has finished (whether successfully or not) in the phase handled exclusively by the engine. This page features an auto-submitting form that users won't notice in practice. This page will rarely need modifications. Default value is <code>finished.ftlh</code></p> </li> <li> <p><code>serializeRules</code>: A JSON object specifying the serialization rules, see below. It is not recommended to remove items from the out-of-the-box rules. Adding items is fine</p> </li> </ul>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/engine-bridge-config/#serialization-rules","title":"Serialization rules","text":"<p>At certain points in the course of a flow, serialization of all its variables is required. The engine employs two mechanisms for this purpose: standard Java serialization and KRYO serialization. Depending on the type of (Java) object to be serialized, administrators can specify when a mechanism is preferred over the other through a set of simple rules.</p> <p>This can be better explained with an example. Suppose the following configuration:</p> <pre><code>\"serializeRules\": {\n  \"JAVA\": [\"ice\", \"com.acme\"],\n  \"KRYO\": [ \"com.acme.bike\" ]\n}\n</code></pre> <ul> <li> <p>If the object to serialize belongs to class <code>com.acme.bike.SuperSonic</code>, both lists are traversed for the best package match. Here KRYO wins because it has a perfect match with respect to the package of the class</p> </li> <li> <p>If the class were <code>com.acme.bike.mega.SuperSonic</code>, KRYO still wins because it has the closest match to the package of the class</p> </li> <li> <p>In case of <code>ice.cream.Salty</code>, JAVA is chosen (best match)</p> </li> <li> <p>In case of <code>org.buskers.Singer</code>, no matches are found, however, KRYO is chosen - it's the fallback method</p> </li> <li> <p>In case of <code>com.acmeMan</code>, no matches are found. KRYO is picked as in the previous case</p> </li> </ul> <p>Please account additional behaviors:</p> <ul> <li>If the object's class is in the default package (unnamed package), KRYO is used</li> <li>If the exact class name is found in one of the lists, the method represented by such list is employed</li> <li>If the object is a (Java) exception, JAVA is used unless the full class name appears listed in the KRYO rules</li> </ul>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/engine-bridge-config/#bridge-configuration","title":"Bridge configuration","text":"<p>Administrators can modify the behavior of the bridge by setting the <code>finish_userid_db_attribute</code> configuration property of the script. This is used to map the identity of the user to login in the case of sucessfully finished flows. The value of this property will contain a physical database attribute that will be correlated with the <code>userId</code> passed in the <code>Finish</code> instruction of the flow.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/","title":"Frequently asked questions","text":"","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#common-errors","title":"Common errors","text":"","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#unable-to-find-a-suitable-constructor-with-arity-in-class","title":"Unable to find a suitable constructor with arity ... in class ...","text":"<p>A Java invocation of the form <code>Call package.className#new ...</code> is passing an incorrect number of arguments or their data types do not match the signature of the constructors for that class.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#unable-to-find-a-suitable-method-called-with-arity-in-class","title":"Unable to find a suitable method called ... with arity ... in class ...","text":"<p>A java invocation is attempting to call a method that is not part of the given class, the number of arguments passed for the method is not correct, or the arguments could not be converted to make a successful call.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#no-finish-instruction-was-reached","title":"No Finish instruction was reached","text":"<p>This occurs when no <code>Finish</code> statement has been found in the execution of a flow and there are no remaining instructions.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#serialization-errors","title":"Serialization errors","text":"<p>Agama engine saves the state of a flow every time an RRF or RFAC instruction is reached. The State can be understood as the set of all variables defined in a flow and their associated values up to a certain point.</p> <p>Most of times, variables hold basic Agama values like strings, booleans, numbers, lists or maps, however, more complex values may appear due to Java <code>Call</code>s. The engine does its best  to properly serialize these Java objects, nonetheless, this is not always possible. In these cases, the flow crashes and errors will appear on screen as well as in the server logs.</p> <p>Use the information in the logs to detect the problematic Java class. This would normally allow you to identify the variable that is causing the issue. Now you have several options to proceed:</p> <ul> <li>Check if the value held by the variable is needed for the given RRF/RFAC or some upcoming statement. If that's not the case, simply set it to <code>null</code> before RRF/RFAC occurs</li> <li>Extract only the necessary pieces from the variable, that is, grab only the fields from the object which are of use for the rest of the flow. If they are simple values like strings or numbers, serialization will succeed. Ensure to nullify or overwrite the original variable</li> <li>Adjust the given class so it is \"serialization\" friendlier. Sometimes, adding a no-args constructor fixes the problem. In other cases, making the class implement the <code>java.io.Serializable</code> interface will make it work. The error in the log should provide a hint </li> <li>Tweak the engine serialization rules so an alternative type of serialization can be used for this particular object </li> <li>Modify your Java code so an alternative class is used instead</li> </ul> <p>In general, a good practice is to avoid handling complex variables in flows. Letting big object graphs live in the state has a negative impact on performance and also increases the risk of serialization issues.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#libraries-and-classes-added-on-the-fly","title":"Libraries and classes added on the fly","text":"","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#what-groovy-and-java-versions-are-supported","title":"What Groovy and Java versions are supported?","text":"<p>Groovy 4.0 and Java 8 or higher. The runtime is Amazon Corretto 17.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-add-third-party-libraries","title":"How to add third party libraries?","text":"<p>You can include jar files in the <code>lib</code> directory of a project. This applies only for VM-based installation of Janssen. Onboarding the jar files require a restart of the authentication server.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#a-class-is-still-available-after-removing-the-corresponding-file","title":"A class is still available after removing the corresponding file","text":"<p>This is because the JVM does not support unloading: even if a given source file is removed, its corresponding class will still be accessible - it remains in the classpath. The classpath will be clean again after a service restart.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-add-log-statements","title":"How to add log statements?","text":"<p>The Jans server uses slf4j and log4j2 logging frameworks. Below is a simple usage example for Java/Groovy code:</p> <pre><code>import org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\n...\nLogger logger = LoggerFactory.getLogger(your.class);\nlogger.info(\"ahoy, ahoy\");\n</code></pre> <p>Note</p> <p>The logging descriptor used by the server can be found here</p> <p>Depending on the package <code>your</code> class belongs to, the message may not appear in the server log. In this case, you have two choices:</p> <ul> <li>Supply a custom log4j descriptor</li> <li>Use a class in package <code>io.jans</code> when calling <code>getLogger</code>. A good example would be using <code>io.jans.agama.model.Flow</code></li> </ul>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-append-data-to-a-flows-log-directly","title":"How to append data to a flow's log directly?","text":"<p>Call method <code>log</code> of class <code>io.jans.agama.engine.script.LogUtils</code>. This method receives a variable number of arguments as DSL's <code>Log</code> does. Thus you can do <code>LogUtils.log(\"@w Today is Friday %th\", 13)</code>, as in the logging examples.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-use-contexts-and-dependency-injection-cdi","title":"How to use Contexts and Dependency Injection (CDI)?","text":"<p>Jans server uses Weld (a CDI reference implementation), and as such makes heavy use of managed beans, scopes, dependency injection, events, etc. Unless the code added is part of a jar library, annotations related to scopes or dependency injection won't take any effect in your code. This is because the Java container does a thorough scanning of classes upon start, but the source code files in <code>lib</code> directory are compiled upon use and modification, as expected in a scripting scenario.</p> <p>Java/Groovy files can however reuse any of the (application-scoped) managed beans available in the server's classpath. To obtain a reference to a bean, use a call like:</p> <pre><code>import io.jans.service.cdi.util.CdiUtil;\n...\nref = CdiUtil.bean(managedBean.class);\n</code></pre> <p>More advanced bean lookup capabilities are provided by method <code>instance</code> of this class where you can supply qualifiers.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#templates","title":"Templates","text":"","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-implement-localization","title":"How to implement localization?","text":"<p>This topic is covered here.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-modify-the-built-in-error-pages","title":"How to modify the built-in error pages?","text":"<p>Agama features some error pages out-of-the-box. They can be customized by editing the corresponding files referenced in the configuration doc page.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#is-javascript-supported","title":"Is Javascript supported?","text":"<p>Yes, the template engine is not concerned about the kind of contents linked in markup. It does not even care if your markup makes any sense. For FreeMarker, templates just produce a textual output.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#a-flow-page-is-not-rendered-as-html-the-browser-just-shows-the-source-code-as-text","title":"A flow page is not rendered as HTML, the browser just shows the source code as text","text":"<p>This is due to lack of proper <code>Content-Type</code> response header. This occurs if your template has filename extension other than <code>ftlh</code>. If you don't want to rename your template, insert <code>&lt;#ftl output_format=\"HTML\"&gt;</code> at the beginning of the file.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-produce-json-instead-of-html","title":"How to produce JSON instead of HTML?","text":"<p>In your templates use <code>&lt;#ftl output_format=\"JSON\"&gt;</code> in the first line. Take a look at the templates whose name start with <code>json_</code> in folder <code>/opt/jans/jetty/jans-auth/agama</code>. Particularly check how JSON content can be escaped - unfortunately FreeMarker does not support escaping for JSON out-of-the-box.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#development-tools","title":"Development tools","text":"","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#are-there-any-ide-or-editor-plugins-available-for-coding-flows-and-manage-projects","title":"Are there any IDE or editor plugins available for coding flows and manage projects?","text":"<p>Not plugins, but you can use Agama Lab for projects and flows authoring.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-debug-flows","title":"How to debug flows?","text":"<p>We plan to offer a debugger in the future. In the meantime, you can do <code>printf</code>-like debugging using the <code>Log</code> instruction. See Agama logging.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#miscellaneous","title":"Miscellaneous","text":"","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-launch-a-flow","title":"How to launch a flow?","text":"<p>A flow is launched by issuing an authentication request in a browser as explained in the launching flows documentation.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#does-flow-execution-timeout","title":"Does flow execution timeout?","text":"<p>Yes. The maximum amount of time an end-user can take to fully complete a flow is driven by the configuration of the authentication server and can be constrained even more in the flow itself. Read about timeouts here.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-prevent-launching-a-flow-directly-from-the-browser","title":"How to prevent launching a flow directly from the browser?","text":"<p>This can be configured in the project's metadata file.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#updates-in-a-flows-code-are-not-reflected-in-its-execution","title":"Updates in a flow's code are not reflected in its execution","text":"<p>When a project is re-deployed, a flow remains unchanged if it comes with errors in the provided <code>.gama</code> file. The tool used for deployment will let you know which flows have errors and their descriptions.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#why-are-the-contents-of-a-list-or-map-logged-partially","title":"Why are the contents of a list or map logged partially?","text":"<p>This is to avoid traversing big structures fully. You can increase the value of <code>maxItemsLoggedInCollections</code> in the engine configuration.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-add-two-numbers-or-compare-numeric-values-in-agama","title":"How to add two numbers or compare numeric values in Agama?","text":"<p>Agama only provides operators for equality/inequality check in conditional statements. Comparisons like \"less-than\", \"greater-than-or-equal\", etc. require Java usage, however, the structure of an authentication flow will rarely have to deal with this kind of computations.</p> <p>Hint: methods like <code>addExact</code>, <code>incrementExact</code>, etc. in <code>java.lang.Math</code> may help you to do some arithmetic.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-concatenate-strings-in-agama","title":"How to concatenate strings in Agama?","text":"<p>See the previous answer. A two-lines solution could be:</p> <pre><code>strings = [ s1, s2, ... ]\nCall java.lang.String#join \"\" strings\n</code></pre>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-know-the-index-of-a-given-loop-iteration","title":"How to know the index of a given loop iteration?","text":"<p>See the examples in the Looping section of the language reference.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-know-the-number-of-iterations-carried-out-by-a-loop-once-it-has-finished","title":"How to know the number of iterations carried out by a loop once it has finished?","text":"<p>You can assign this value to a variable at the top of your loop declaration. See the examples in the Looping section of the language reference.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-access-localization-labels-from-java-code","title":"How to access localization labels from Java code?","text":"<p>In Freemarker, localization labels are accessed using the <code>${labels(key, ...)}</code> notation. The following would be a Java equivalent:</p> <pre><code>import io.jans.agama.engine.service.LabelsService;\n...\n\nlbls = io.jans.service.cdi.util.CdiUtil.bean(LabelsService.class);\nString label = lbls.get(\"&lt;label key&gt;\", ... optional extra params);\n</code></pre> <p>Note the localization context (language, country, etc.) used in such a call is based on the HTTP request that is taking place when the code is invoked.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#can-agama-code-be-called-from-java","title":"Can Agama code be called from Java?","text":"<p>No. These two languages are supposed to play roles that should not be mixed, check here.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/faq/#how-to-run-flows-from-native-applications-instead-of-web-browsers","title":"How to run flows from native applications instead of web browsers?","text":"<p>There is a separate doc page covering this aspect here.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/flows-navigation-ui/","title":"Flows navigation, UI pages and assets","text":"<p>RRF is a powerful construct in Agama. Its syntax follows this pattern:</p> <p>(assignment-var =)? <code>RRF</code> \"path-to-UI-template\" map-variable?</p> <p>Execution involves several steps which can be summarized as: location of template, rendering, and user-data retrieval. The process is explained in the following.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/flows-navigation-ui/#template-location","title":"Template location","text":"<p>Note</p> <p>For convenience, references to the server directory <code>/opt/jans/jetty/jans-auth/agama</code> will be replaced by <code>&lt;AGAMA-DIR&gt;</code> from here onwards.</p> <p>A path is built by concatenating the <code>Basepath</code> of the flow this <code>RRF</code> belongs to and the actual template path, i.e. path-to-UI-template as in the introductory parapraph. Then the engine's templates path root is prepended to it. The \"root\" is the value set in the engine configuration for the property <code>templatesPath</code>. Thus, in a default installation, the value to prepend would be <code>&lt;AGAMA-DIR&gt;/ftl</code>.</p> <p>If there is no such file, the flow will crash right away, otherwise, processing continues.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/flows-navigation-ui/#how-to-build-templates","title":"How to build templates?","text":"<p>Templates are expected to be written using Apache FreeMarker. This is a simple and highly productive language to produce HTML and other forms of output. By convention templates generating HTML markup in Agama should have the extension <code>ftlh</code>. Practically they will look and behave as regular HTML files.</p> <p>Developers are encouraged to take a peep at the FreeMarker manual before trying to write their first pages. It usually boils down to produce the desired markup plus adding some placeholders for information that is dynamic. The key concept there is <code>Template + data-model = output</code> which is pretty natural. The summation in this equation is generally referred to as \"rendering a template\" in this documentation.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/flows-navigation-ui/#rendering","title":"Rendering","text":"<p>Rendering is the process of \"injecting\" the variable passed (map-variable in the above) into a template. If no variable is present in the instruction, it is assumed an empty map was passed, i.e. <code>{ }</code>.</p> <p>The variable injected (\"data model\" in FreeMarker terms) always has to be an Agama map, Java bean or object implementing the <code>java.util.Map</code> interface. This will allow access to the contents of such variable from within the template.</p> <p>Here is a simple example. Suppose you want to ask for a username and password in a page called <code>login.ftl</code> and that such page will be stored in <code>&lt;AGAMA-DIR&gt;/ftl/myflow/pages/login.ftl</code>. Assume the flow has the header directive <code>Basepath \"myflow\"</code>. Also, let's say we want to pass a custom salutation message to be shown at the top of the page. Here is how the Agama code would look like:</p> <pre><code>...\nobj = { message: \"Hey ho!, let's go\" }\nRRF \"pages/login.ftl\" obj\n...\n</code></pre> <p>And here the UI page contents:</p> <pre><code>&lt;!doctype html&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n    ...\n    &lt;body&gt;\n\n        &lt;h1&gt;${message}&lt;/h1&gt;         \n\n        &lt;form method=\"post\" enctype=\"application/x-www-form-urlencoded\"&gt;\n            &lt;div&gt;\n                &lt;label for=\"username\"&gt;Username&lt;/label&gt;\n                &lt;input type=\"text\" name=\"username\"&gt;\n            &lt;/div&gt;\n            &lt;div&gt;\n                &lt;label for=\"password\"&gt;Password&lt;/label&gt;\n                &lt;input type=\"password\" name=\"password\"&gt;\n            &lt;/div&gt;\n            &lt;input type=\"submit\" value=\"Login\"&gt;\n        &lt;/form&gt;\n\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/flows-navigation-ui/#extended-data-model","title":"Extended data model","text":"<p>The data model (injected map) is attached some additional keys for convenience:</p> <ul> <li> <p><code>webCtx</code>. It gives easy access to often needed bits like current path, locale, etc. This is a Java object you can inspect here. Take a look at the getters; writing <code>${webCtx.contextPath}</code> in a template will insert the result of calling method <code>getContextPath</code> - normally the string <code>/jans-auth</code></p> </li> <li> <p><code>cache</code>. Allows developers to retrieve values already stored in the Jans configured cache, e.g. <code>${cache.myKey}</code>. To avoid template errors in case of a cache miss, you can use Freemarker's safeguard expressions. Note you cannot store/modify values in the cache from templates</p> </li> <li> <p><code>labels</code> and <code>msgs</code>. These give access to localized messages. They are useful when templates have to render different texts depening on user context, such as country and language. Learn more here</p> </li> </ul>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/flows-navigation-ui/#assets-handling","title":"Assets handling","text":"<p>Clearly, templates can link other local web resources like Javascript code, images, etc. The location of this kind of files is expected to be in the filesystem under <code>&lt;AGAMA-DIR&gt;/fl</code> directory. Note this is not the same directory of templates. Doing so would allow users to retrieve the code of templates by simple URL manipulation.</p> <p>As an example, suppose your flow <code>Basepath</code> is <code>foo</code> and you have the instructions <code>RRF index.ftlh</code> and <code>RRF bar/index2.ftlh</code> somewhere in your code. Then your local <code>&lt;AGAMA-DIR&gt;/ftl</code> would look like:</p> <pre><code>foo\n|- index.ftlh\n+- bar\n   \\- index2.ftlh\n</code></pre> <p>Say <code>index.ftlh</code> has markup like <code>&lt;img src=\"bar/me.png\"&gt;</code> and <code>index2.ftlh</code> has <code>&lt;link href=\"my/style.css\" rel=\"stylesheet\"&gt;</code> somewhere. This is how <code>&lt;AGAMA-DIR&gt;/fl</code> would look like:</p> <pre><code>foo\n+- bar\n   |- me.png\n   \\- my\n      \\- style.css\n</code></pre>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/flows-navigation-ui/#user-data-retrieval","title":"User-data retrieval","text":"<p>Once the rendered page is shown in the browser, the flow execution is literally paused. If the user stands idly at this page, nothing will happen. To make the flow proceed, an HTTP POST must be made to the current URL. This is exactly what <code>login.ftl</code> of the above example tries to do: it provides a button that submits the form via POST for the flow to resume execution.</p> <p>Once the flow continues, an Agama map is built using all form fields received at the server and bound to the variable used in the assignment of the RRF instruction (the variable referred as assignment-var in the introduction of this page). This only applies when <code>RRF</code> has an assignment associated, of course.</p> <p>If the earlier example is modified to</p> <pre><code>...\nobj = { message: \"Hey ho!, let's go\" }\ncredentials = RRF \"pages/login.ftl\" obj\n...\n</code></pre> <p>the form values can then be referenced as <code>credentials.username</code> and <code>credentials.password</code> in the flow. In other words, the keys of the resulting map will correspond to the form field names. The values will all be strings.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/flows-navigation-ui/#3-param-variant","title":"3-param variant","text":"<p>In the Jans Agama engine, <code>RRF</code> can be passed a third parameter: <code>RRF templatePath variable boolean</code>. When the boolean value is <code>true</code> the callback URL will be available while <code>RRF</code> is in execution (as in RFAC). In this case, if the callback is visited, data passed to it will be set as the result of the <code>RRF</code>. If a POST to the current URL is received first, i.e. callback not hit, behavior will be as in the two-param <code>RRF</code> invocation. This is also the case when a <code>false</code> value is passed for the third parameter.</p> <p>The three-param variant of <code>RRF</code> can be useful when:</p> <ul> <li>The decision to redirect to an external site can only be done from the browser itself</li> <li>The external site expects to receive an HTTP POST. In this case, the rendered template may contain a form with fields as needed plus auto-submission logic in Javascript to perform the actual POST. This typically occurs in inbound-identity flows where identity providers require authentication requests serialized in <code>application/x-www-form-urlencoded</code> format as is the case of SAML HTTP POST binding, for example</li> </ul>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/","title":"Janssen Agama Engine","text":"","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#introduction","title":"Introduction","text":"<p>The Janssen Server implements the Agama framework through several components bundled in its authentication server (AS):</p> <ul> <li> <p>The engine: the piece of software that actually runs the flows and interacts with the user's browser - sort of a small web application. As expected, these flows are mainly targetted at user authentication</p> </li> <li> <p>A transpiler: code written in Agama language is transpiled to an intermediate representation which can then be interpreted at runtime by the engine</p> </li> <li> <p>The bridge: since the engine itself does not implement an authentication protocol, another piece is required to put flows in the context of a standard authorization framework like OpenId Connect. This is what the bridge does</p> </li> <li> <p>The deployer: a piece of software capable of deploying Agama projects to the engine.</p> </li> </ul> <p>The rest of this document describes implementation-specific details of the engine bundled with the Jans Server. These details give shape to the requirements abstractly defined for an Agama-compliant engine.</p> <p>Note</p> <p>Ensure both the Agama engine and the bridge are enabled in the Janssen server to effectively use engine's features</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#launching-flows","title":"Launching flows","text":"<p>Flows can be launched by sending an (OpenId Connect) authentication request to the user's browser. This usually boils down to making a redirection to a URL looking like <code>https://&lt;jans-server-name&gt;/jans-auth/restv1/authorize?acr_values=agama_flowQname&amp;scope=...&amp;response_type=...&amp;redirect_uri=https...&amp;client_id=...&amp;state=...</code>. Check the OpenId Connect spec for more details. Note Jans Server is spec-compliant.</p> <p>Things to highlight:</p> <ul> <li> <p>The <code>acr_values</code> parameter carries the qualified name (identifier) of the flow to launch prefixed with the string <code>agama_</code>, for example <code>acr_values=agama_test.acme.co</code></p> </li> <li> <p>If the flow to call receives input parameters, this data can be appended to the <code>acr_values</code> parameter: use a hyphen to separate the flow name and the parameters expressed in Base64 URL encoded format. For example, if the flow had inputs  <code>height</code> and <code>color</code>, you would encode the string <code>{\"height\": 190, \"color\": \"blue\"}</code> and the resulting value would be <code>agama_test.acme.co-eyJoZWlnaHQiOiAxOTAsICJjb2xvciI6ICJibHVlIn0</code>. When a given input variable is not provided, the engine will assign a <code>null</code> value automatically</p> </li> </ul>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#authentication-and-finish","title":"Authentication and <code>Finish</code>","text":"<p>When a top-level flow (i.e. one with no parents) finishes successfully, the selection of the user to authenticate is driven by the <code>userId</code> passed in <code>data</code>, as in</p> <pre><code>obj = { success: true, data: { userId: \"john_doe\" } }\n// map literals cannot be passed directly to Finish - a variable can be used instead\nFinish obj \n</code></pre> <p>By default <code>userId</code> maps to the <code>uid</code> attribute that generally all user entries already have in the database of Jans Server, in other words, the \"user name\". This attribute is configurable though via property <code>finish_userid_db_attribute</code> of the bridge script. In some cases, you would like to change that to <code>mail</code> in order to pass things like <code>{ success: true, data: { userId: \"john_doe@jd.me\" } }</code> for instance.</p> <p>Important</p> <p>If the database lookup does not produce exactly one user entry, this is treated as a failed authentication attempt by the authentication server.</p> <p>When the authentication succeeds, the whole contents of <code>data</code> are stored in the authentication server's session of the given user under the key <code>agamaData</code>. Contents are serialized to a JSON string previously.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#crashes-timeouts-and-failures","title":"Crashes, timeouts, and failures","text":"<p>Execution rules define several possible flow states. For crashed, timed out, and finished failed flows, the engine will present proper error pages to users. These are configurable by properties <code>crashErrorPage</code>, <code>interruptionErrorPage</code>, and <code>finishedFlowPage</code> respectively, of the engine-configuration.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#how-timeouts-work","title":"How timeouts work","text":"<p>Authentication flows are normally short-lived. They usually span no more than a few minutes. In Agama, the maximum amount of time an end-user can take to fully complete a flow is driven by the configuration of the authentication server, specifically the <code>sessionIdUnauthenticatedUnusedLifetime</code> property which is measured in seconds. As an example, if this value is 120, any attempt to authenticate taking more than two minutes will throw the given error page.</p> <p>Moreover, when a flow specifies its own timeout in the header the effective timeout is the smallest value between <code>sessionIdUnauthenticatedUnusedLifetime</code> and the value in the header.</p> <p>Depending on specific needs, <code>sessionIdUnauthenticatedUnusedLifetime</code> may have to be set to a higher value than the server's default. This may be the case where flows send e-mail notifications with temporary codes, for instance.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#logging","title":"Logging","text":"<p>There are three relevant sources of log data:</p> <ul> <li>The engine. It emits information related to flows transpilation, projects deployment, and flow crashes - generally low-level information</li> <li>Log instructions. These are statements originated directly from the Agama code</li> <li>Call directives. Foreign code can issue logging statements as well as any other code a <code>Call</code> may depend on. See the FAQ</li> </ul> <p>The following table details the location of log data. Paths are relative to directory <code>/opt/jans/jetty/jans-auth/log</code>:</p> Source Destination file Engine <code>jans-auth.log</code> <code>Log</code> instructions <code>jans-auth_script.log</code> Foreign code <code>jans-auth.log</code> <p>Depending on the specificity required, you may have to change the logging level so more or less details appear in the logs. This can be done by altering the <code>loggingLevel</code> property of the auth server configuration. <code>DEBUG</code> usually suffices for troubleshooting.</p> <p>The available levels for statements issued with the <code>Log</code> instruction are:</p> Level name shortcut <code>error</code> e <code>warn</code> w <code>info</code> i <code>debug</code> d <code>trace</code> t <p>For instance, these two instructions are equivalent: <code>Log \"@e Universe collapsed\"</code> and <code>Log \"@error Universe collapsed\"</code></p> <p>The engine will use <code>info</code> when the level is not specified explicitly, as in <code>Log \"Look ma!\"</code>.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#rfac-and-callback-url","title":"RFAC and Callback URL","text":"<p>Engine's callback URL is <code>https://&lt;your-server-name&gt;/jans-auth/fl/callback</code>. This resource is only be available for a given browser session while <code>RFAC</code> is in execution. Once the callback is visited or the flow times out (whichever occurs first), subsequent requests will respond with an HTTP 404 error.</p> <p>The mechanism used for redirection is a \"302 Found\" HTTP redirect that entails a subsequent GET request to the external site. In cases where a POST is expected, the 3-param version of RRF can be useful.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#rrf-navigation-and-assets-handling","title":"RRF, navigation, and assets handling","text":"<p>Understanding how <code>RRF</code> works in the engine is key to writing meaningful flows. This topic is fully covered here.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#foreign-calls","title":"Foreign calls","text":"<p>In the Jans Agama engine, Java or Groovy code can be called by means of the <code>Call</code> instruction. Specifically, public methods from public classes or static methods from public interfaces.</p> <p>Note</p> <p>Java language background is required for this section.</p> <p>The following exemplifies different kind of usages of Java from Agama code:</p> ExampleNotes <pre><code>Call java.lang.Integer#parseInt \"FF\" 16\n</code></pre> Invokes the <code>parseInt</code> method of <code>Integer</code> class passing the given arguments (i.e. conversion of hexadecimal string to a primitive <code>int</code>). The returned value is ignored <pre><code>numbers = [ 2, -2, 0, 3, -3, 4 ]\nsmall = Call java.util.Collections#min numbers\n</code></pre> Invokes the <code>min</code> method of the <code>Collections</code> class.Supplies a list of numbers as argument.The smallest number is stored in variable <code>small</code> <pre><code>jLocale = Call java.util.Locale#getDefault\nlocaleName = jLocale.displayName\n</code></pre> Computes the display name of the JVM default locale <pre><code>car = { brand: \"Ford\", model: 1963 }\nsidecar = Call java.util.Map#copyOf car\n</code></pre> Makes a deep clone of a map <pre><code>number | E = Call java.lang.Integer#parseInt \"AGA\" 16\nWhen E is not null\n    Log \"An error occurred:\" E.message \n</code></pre> Similar to the first example.If an exception is thrown by the invocation, it's caught and assigned to variable <code>E</code>.Note both checked and unchecked exceptions are caught <pre><code>| E = Call com.acme.Worker#notifyExternalSystem\n//Do something with E\n//... \n</code></pre> If exception catching is required when calling a method that returns <code>void</code>, there is no need to put a variable before the pipe <pre><code>p1 = Call java.awt.Point#new\np2 = Call java.awt.Point#new 1 3\nCall p2 translate -1 1\n</code></pre> Creates instances of class <code>java.awt.Point</code> with different constructors. For <code>p1</code> the no-args constructor is used.Method <code>translate</code> is invoked on the <code>p2</code> instance. Note usage of a space here instead of hash (<code>#</code>) <pre><code>cls1 = Call java.lang.CharSequence#class\ncls2 = Call java.lang.Integer#class\nCall cls2 parseInt \"FF\" 16\n</code></pre> Stores in <code>cls1</code> a reference to interface class <code>CharSequence.class</code>.Stores in <code>cls2</code> a reference to <code>Integer.class</code>.The 3rd line statement achieves the same effect of <code>Call java.lang.Integer#parseInt \"FF\" 16</code> <pre><code>L = [ \"A\", \"B\", \"C\" ]\nS = Call java.util.Set#of 0 2 4 6\nmap = { numbers: S, letters: L  }\nhasOne = Call map.numbers contains 1\n</code></pre> Calls the <code>contains</code> method of the <code>java.util.Set</code> object stored in <code>map.numbers</code> passing <code>1</code> as argument and storing the result in <code>hasOne</code> <p>The usage of a hash sign (or spaces) before a method name helps disambiguate whether the invocation is on a static class method or an object method. This is so because an expression like <code>hey.You</code> may reference the class <code>You</code> on package <code>hey</code>, or the value of key <code>You</code> in a map named <code>hey</code>.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#highlights","title":"Highlights","text":"<p>Any method that meets the conditions mentioned (public or interface static) and that is reachable in the JVM classpath can be called; developers are not restricted solely to <code>java.*</code> packages.</p> <p>When using <code>Call</code>, the method to execute is picked based on the name (e.g. after the <code>#</code> sign) and the number of arguments supplied. If a class/interface exhibits several methods with the same name and arity (number of parameters), the method that best matches the datatypes of the arguments with respect to its signature is selected. Sometimes this requires to perform arguments conversions and they may fail. In such case, the second best suited method is tried and so on.</p> <p>When all attempts fail or there are no candidate methods to choose from, the <code>Call</code> simply throws a <code>NoSuchMethodException</code>.</p> <p>For non-static method invocations, i.e. no hash sign, the class used for method lookup is that of the instance passed (the first parameter in the <code>Call</code> directive). This includes all associated superclasses too, as expected. When the instance does not hold a Java but an Agama value, the following is used to pick a class:</p> Agama type Java class for method lookup <code>string</code> <code>String</code> <code>boolean</code> <code>Boolean</code> <code>number</code> <code>Double</code> <code>list</code> <code>java.util.List</code> <code>map</code> <code>java.util.Map</code> <p>Limitations:</p> <ul> <li> <p>list and map literals cannot be passed as arguments to method calls directly. This means the following is illegal: <code>Call co.Utils#myMethod { key: [ 1, 2 , 3] } [ \"Yeeha!\" ]</code>. To achieve the same effect assign the literal value to a variable and pass that instead</p> </li> <li> <p><code>Call</code>ing a method that mutates one or more of the arguments passed will not work properly if the corresponding parameters in the method signature have type information attached. For example, copying a list into another using <code>java.util.Collections#copy\u200b(List&lt;? super T&gt; dest, List&lt;? extends T&gt; src)</code> may not behave as expected. Conversely, calling <code>java.lang.reflect.Array#set\u200b(Object array, int index, Object value)</code> works fine because <code>array</code> does not have a parameterized type. The practice of mutating passed arguments is unusual and sometimes discouraged in programming</p> </li> </ul>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#exception-handling","title":"Exception handling","text":"<p>As seen in the examples Agama engine can deal with Java exceptions, however, this feature should be used sparingly. When exception handling adds undesired complexity to your code, create wrapper methods in Java and do the processing there instead of delegating that to the DSL.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#arguments-conversion","title":"Arguments conversion","text":"<p>Agama types do not match Java types. This means passing a \"native\" Agama value as parameter in a method <code>Call</code> requires some form of compatibility with the target (Java) type in the method signature.</p> <p>An argument (Agama value) is compatible with a method parameter if it can be \"converted\" successfully. As we'll see, conversion feels pretty natural in practice. If this process fails a <code>java.lang.IllegalArgumentException</code> is thrown and the flow will crash unless the exception is caught. Note however the recommended practice is to let flows crash.</p> <p>The following lists some of the most common successful conversions:</p> Agama value Can be converted to <code>string</code> <code>String</code> or <code>char[]</code> <code>boolean</code> <code>Boolean</code> or primitive equivalent <code>number</code> <code>Double</code>/<code>Float</code>/<code>Integer</code>/<code>Long</code>/<code>Short</code>/<code>Byte</code> or primitive equivalent <code>null</code> Any non-primitive <code>list</code> Array or class implementing <code>Collection&lt;T&gt;</code> as long as items can be converted to type <code>T</code> <code>map</code> Class implementing <code>Map&lt;K, V&gt;</code> as long as keys and values can be converted to types <code>K</code> and <code>V</code>, respectively <code>map</code> Java bean. Unrecognized properties in Agama value are ignored <p>The below table shows some examples of interesting and handy conversions:</p> Agama value Param data type in target Java method Argument value (Agama) Received param value (in method) Notes Positive <code>number</code> having fractional part <code>Integer</code>/<code>Long</code>/<code>Short</code>/<code>Byte</code> or primitive equivalent 2.6 2 Integer part kept Negative <code>number</code> having fractional part <code>Integer</code>/<code>Long</code>/<code>Short</code>/<code>Byte</code> or primitive equivalent -2.4 2 Integer part kept Integer <code>number</code> <code>Float</code>/<code>Double</code> or primitive equivalent 1 1.0 <code>list</code> of <code>number</code>s <code>List&lt;Integer&gt;</code> [1, 2.0, 3.1, -4.2] [1, 2, 3, -4] Only integer parts kept <code>list</code> of integer <code>number</code>s <code>List&lt;Float&gt;</code>/<code>List&lt;Double&gt;</code> [1, 2, 3, -4] [1.0, 2.0, 3.0, -4.0] <code>string</code> of length 1 <code>Character</code> or primitive equivalent a a Passing a zero, two, or more lengthed string will make the call fail <p>When the argument is not an Agama but a Java object/primitive, the following rules apply:</p> <ul> <li>If the value can be cast to the target type, no conversion is needed, otherwise</li> <li>If it is an instance of <code>java.lang.Number</code> and the type is a numeric primitive or wrapper (e.g. <code>Integer</code>), the value is truncated if required, otherwise</li> <li>The value is serialized to JSON - if possible - and then an attempt to create a Java instance based on the given JSON contents is made. For this purpose, the FasterXML Jackson library is used</li> </ul> <p>This is powerful because it allows to send data of similar shape/structure when data types do not necessarily match. Consider the following example:</p> <pre><code>s = \"a man's gotta do what a man's gotta do\"\njStrArr = Call s split \" \"\nwords = Call java.util.Collections#unmodifiableSet jStrArr\n</code></pre> <p>This Agama snippet creates the (Java) <code>Set</code> of different words found in a given (Agama) <code>string</code>. Note <code>jStrArr</code> is of type <code>String[]</code> and is passed directly to method <code>unmodifiableSet</code> which originally expects an instance of <code>Set</code> as parameter.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#from-java-to-agama","title":"From Java to Agama","text":"<p>We just saw how Agama values are treated in Java code. Here we make an analysis in the reverse direction: from Java to Agama where Java values are obtained through <code>Call</code> invocations.</p> <p>The following table relates Java types to Agama types:</p> Java value (<code>x</code>) Agama equivalent Notes <code>x</code> is a Java array or implements <code>java.util.List</code> list Changing the list contents (includes updates on x.length) can only be achieved if the Java list is modifiable <code>x</code> implements <code>java.util.Map</code> and keys are of type<code>java.lang.String</code> map Changing the map contents can only be achieved if the Java map is modifiable <code>x</code> is a <code>java.lang.(Double|Float|Long|Integer|Short|Byte)</code> or an equivalent primitive number <code>x</code> is a (non-null) <code>java.lang.Boolean</code> or equivalent primitive boolean <code>x</code> is a <code>java.lang.String</code> string (limited) Neither indexing nor <code>x.length</code> can be used null null <p>Except for maps, the following holds for a value <code>x</code> obtained through a Java <code>Call</code>:</p> <ul> <li> <p>If <code>x</code>'s class has getters and/or setters for some fields, they can be called. As an example if <code>age</code> and <code>name</code> are available fields, <code>x.age</code> can be used to get the value of <code>age</code> </p> </li> <li> <p>Likewise, setting a value is possible too: <code>x.name = \"Larry\"</code> (if a suitable setter exists) </p> </li> <li> <p>In general, a no-args method starting with <code>get</code> or <code>is</code> can be invoked. This is useful for instance to get the (Java) class name of your object (<code>x.class.name</code>) or determine if a list has no elements (<code>x.empty</code>)</p> </li> </ul>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#classpath","title":"Classpath","text":"<p>A class/interface is accessible to Agama code as long as it is part of:</p> <ul> <li><code>jans-auth.war &gt; WEB-INF/lib/*.jar</code> or,</li> <li><code>jans-auth.war &gt; WEB-INF/classes</code> or,</li> <li><code>/opt/jans/jetty/jans-auth/custom/libs/*.jar</code> (may require edition of <code>jans-auth.xml</code> descriptor)   </li> </ul> <p>Additionally, it is possible to upload source code on the fly to augment the classpath. Any valid Java or Groovy file is accepted and must be located under <code>/opt/jans/jetty/jans-auth/agama/scripts</code>. For instance, a class named <code>com.acme.Person</code> must reside in folder <code>/opt/jans/jetty/jans-auth/agama/scripts/com/acme</code>.</p> <p>Important</p> <p>Only files with extensions <code>.java</code> or <code>.groovy</code> are accounted</p> <p>The <code>scripts</code> directory provides automatic \"hot\" reloading. This is a valuable time saver for developers because there is no need to restart the jans-auth webapp when sources are modified. This feature has some limitations which are explained in the following.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#limitations-of-code-added-on-the-fly","title":"Limitations of code added \"on the fly\"","text":"<p>Classes in <code>scripts</code> directory can only be accessed through <code>Call</code> directives. As an example suppose you added classes <code>A</code> and <code>B</code> to <code>scripts</code>, and <code>A</code> depends on <code>B</code>. <code>Call</code>s using class <code>A</code> will work and any change to files <code>A</code> and/or <code>B</code> will be picked automatically. On the contrary, trying to load this kind of classes using <code>Class.forName</code> either from a jar file in <code>custom/libs</code> or from Agama itself will degenerate in <code>ClassNotFoundException</code>. Note <code>A</code> and <code>B</code> can also depend on classes found at any of the locations listed at the beginning of this section.</p> <p>Note Java sources are actually interpreted as Groovy code. 99% of times this is not a concern since Groovy can be considered a superset of Java, however, there are some minor discrepancies that may exhibit unexpected behaviors. These differences are described here.</p> <p>We consider the following to be remarkable:</p> <ul> <li>Array literals in shorthand syntax not allowed, e.g. <code>int[] array = {1, 2, 3}</code>. Use <code>int[] array = new int[] {1, 2, 3}</code> instead</li> <li>String interpolation: <code>\"hello $mark\"</code> evaluates the value of variable <code>mark</code> and prepends <code>hello</code> to it!. To avoid this use a backslash, like in <code>\"hello \\$mark\"</code>. Learn more about interpolation here. In general, prepend ocurrences of <code>$</code> in your string literals with a <code>\\</code></li> <li>Usage of <code>==</code> operator actually calls the <code>equals</code> method. Most of times this is fine but can be a problem when you are overriding <code>equals</code> in your class and make use of <code>==</code>. This will introduce a recursive call in your implementation and may degenerate in a stack overflow. If possible, use the <code>===</code> operator or the <code>is</code> method in these cases</li> </ul>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/jans-agama-engine/#oop-prose-warning","title":"OOP prose warning","text":"<p>See the recommended practices to learn more about this topic.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/native-applications/","title":"Agama flows in native applications","text":"<p>Agama is a framework primarily focused on web flows, however, with the Authorization Challenge endpoint of Jans Server, developers can  now run their flows outside the browser. This makes possible to offer secure, multi-step authentication flows from desktop and mobile applications without resorting to mechanisms like Web Views that  substantially degrade the user experience.</p> <p>Additionally, the same already-familiar tools for authoring and deploying Agama projects can be used for the job. Moreover, the flows built for the web can be run in the native world without modification, requiring only to code the respective native UI and the logic that interacts with the Authorization Challenge endpoint, called \"the endpoint\" hereafter.</p> <p>In this document, we present an overview of how the endpoint works to make your Agama flows run without a web browser. Preliminar acquaintance with the following topics is recommended:</p> <ul> <li>Agama DSL and <code>.gama</code> format</li> <li>Agama projects deployment in the Janssen Server </li> <li>Execution rules in the Jans Agama engine</li> <li>A basic understanding of OAuth 2.0 for First-Party Applications</li> </ul>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#how-do-flows-actually-run","title":"How do flows actually run?","text":"<p>Before getting into the technicalities, let's cover some key preliminar concepts.</p> <p>The engine - the piece of software that actually runs flows - is eminently driven by HTTP requests. This is unsurprising because the main \"consumers\" of the engine are web browsers. When targetting native apps, the engine remains the same, and flows still run at the server side. This means native apps won't hold any business logic, or make computations of significance.</p> <p>The RRF (render-reply-fetch) Agama instruction is of paramount importance in flows. In a regular web setting, it involves three steps:</p> <ul> <li>Injecting some data to a UI template in order to generate HTML markup. This is known as rendering</li> <li>Reply the markup to the web browser - this will display a web page</li> <li>At the server side, retrieve data the user may have provided in his interaction with the page. This is, fetch </li> </ul> <p>In a native setting no HTML markup is supposed to be generated and returned\u2014it's the app that is in charge of displaying the UI now. For this purpose, it will receive (from the endpoint) the data that would be originally injected into the template. Most of times, this will carry information gathered at earlier stages of the flow and that is relevant to properly show or update the UI.</p> <p>Likewise, the \"data submission\" for the fetch phase of RRF is performed by the app too. In this case, the relevant data grabbed from the user interaction is sent to the server side (via challenge endpoint) and becomes the result of the RRF (the value for the variable on the left-hand side of the instruction). Note both the input (\"injected\" data) and the output (result) is specified in JSON format.</p> <p>Once the fetch occurs, the flow proceeds its execution until another RRF instruction is hit, where the procedure described above takes place again.</p> <p>Note this approach has two big benefits:</p> <ol> <li>Regular web flows can be reused in the native world without modifications</li> <li>The mindset for flows design remain the same</li> </ol> <p>There is a subtle exception regarding the first statement and has to do with flows containing RFAC instructions. RFAC is used to redirect to external sites, and as such, it requires a web browser. In the case of native apps, flows will crash once an RFAC instruction is hit.</p>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#inversion-of-control-in-apps","title":"Inversion of control in apps","text":"<p>The above concepts bring an important constraint to app design that should be accounted before undertaking any project: control is inverted.</p> <p>Normally, an app \"knows\" exactly what to do at each step of its workflow, and eventually delegates data retrieval tasks to the server side. When using the endpoint, the server side drives the logic: the app does not \"take decisions\" and instead \"reacts\" to the received data. This will be demonstrated later through a practical example.</p>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#about-the-example-otp-via-e-mail","title":"About the example: OTP via e-mail","text":"<p>To avoid a rather abstract explanation, we'll use an example to illustrate the steps required to run a flow from a native app. Suppose an authentication flow operating in the following manner:</p> <ul> <li>A username is prompted</li> <li>If the corresponding user has no e-mail associated to his account, the flow ends with an error message</li> <li>If the user has exactly one e-mail in his profile, a random one-time passcode (OTP) is sent to his registered address</li> <li>If the user has more than one e-mail, a screen is shown to pick the address where he would like the OTP be sent to</li> <li>The user is prompted to enter the passcode sent. If supplied correctly, the flow ends and the user is authenticated, otherwise the flow ends with an error</li> </ul> <p>This hypothetical flow is simple but will give you a good idea on how to interact with the endpoint.</p>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#the-flow-code","title":"The flow code","text":"<p>The below depicts the implementation:</p> <p></p> <p>Flow <code>co.acme.flows.emailOtp</code> is self-explanatory and does not require further insight. Note the templates referenced in RRF directives don't necessarily have to exist, however, the template names will be included in the output of the endpoint as the flow executes. This serves as a hint or reference for the app to know the current point of execution and determine what should be shown in the UI. It will be more clearly seen in the next section.</p>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#running-the-flow","title":"Running the flow","text":"","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#requisites","title":"Requisites","text":"<p>To be able to run an Agama flow from a native app using the endpoint, it is required to register an OAuth Client in the Jans server with at least the <code>authorization_challenge</code> scope. The process of client registration is beyond the scope of this document.</p> <p>All HTTP requests exemplified here make use of <code>curl</code>. Ensure this tool is familiar to you.</p>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#workflow","title":"Workflow","text":"<p>Requests to the endpoint are all issued to the URL <code>https://&lt;jans-hostname&gt;/jans-auth/restv1/authorize-challenge</code> using the POST verb. Responses will contain JSON content whose structure will vary depending on the result of the operation as we will see.</p> <p>Once the first request is sent, the flow will start and all instructions will be executed until an RRF is found. Here the flow will be paused, and the endpoint will respond with the data that was passed to RRF: the template path and the \"injected\" data. Let's start issuing real requests now.</p>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#initial-request","title":"Initial request","text":"<p>In the first request, at least the following parameters must be passed:</p> Name Value <code>acr_values</code> agama_challenge <code>use_auth_session</code> true <code>client_id</code> The client identifier of a previously registered client <code>flow_name</code> The qualified name of the flow to launch <p>So in our example, it may look like:</p> <pre><code>curl -i -d acr_values=agama_challenge -d use_auth_session=true\n     -d flow_name=co.acme.flows.emailOtp -d client_id=&lt;client-id&gt;\n     https://&lt;jans-hostname&gt;/jans-auth/restv1/authorize-challenge\n</code></pre> <p>Note</p> <p>This command, as all others following has been split into several lines for better readability.</p> <p>The response will look like:</p> <pre><code>HTTP/1.1 401 Unauthorized\nContent-Type: application/json\n...\n\n{\n  \"error\": \"flow_paused\"\n  \"flow_paused\": {\n    \"_template\": \"username-prompt.ftl\"\n  },\n  \"auth_session\": \"BmAiCeArLdAa0\",\n}\n</code></pre> <p>While this may look like something wrong happened, it is not really the case. This is derived from the spec the endpoint adheres to, where the authorization server must report every intermediate response as an error with a 401 status code.</p> <p>The value of the <code>error</code> property references a section that contains the template path. Here it corresponds to the first RRF instruction reached in the execution (line 4 in the flow's code). Particularly this RRF was not invoked passing two parameters, so there is only one property inside the <code>flow_paused</code> JSON object.</p> <p>Note the presence of <code>auth_session</code>. This value allows the authorization server to associate subsequent requests issued by the app with this specific flow execution.</p> <p>Based on this response, the app should render UI elements in order to capture the username. Here, <code>username-prompt.ftl</code> serves as a hint for the app to know the point of execution the flow is at currently.</p>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#subsequent-requests","title":"Subsequent requests","text":"<p>From here onwards, requests must contain the following parameters:</p> Name Value <code>use_auth_session</code> true <code>auth_session</code> The value obtained in the previous request <code>data</code> A JSON object that will become the result of the RRF instruction the flow is paused at. If the given RRF has no assignment associated, an empty object must be passed: <code>{ }</code> <p>Note</p> <p>Whenever a request is missing the <code>auth_session</code> param, it is assumed the inital request is being attempted.</p> <p>Let's assume the user entered <code>Joan</code> as username in the app. A request like the below can then be issued so the variable <code>obj</code> at line 4 is assigned a value:</p> <pre><code>curl -i -d auth_session=BmAiCeArLdAa0 -d use_auth_session=true\n     --data-urlencode data='{ \"username\": \"Joan\" }' \n     https://&lt;jans-hostname&gt;/jans-auth/restv1/authorize-challenge\n</code></pre> <p>This will make the flow advance until the next RRF is reached. Suppose the user Joan was found to have two e-mail addresses: <code>joan@doe.com</code> and <code>joan@deere.com</code>. This will make the flow hit line 23. The response will look as follows:</p> <pre><code>HTTP/1.1 401 Unauthorized\nContent-Type: application/json\n...\n\n{\n  \"error\": \"flow_paused\"\n  \"flow_paused\": {\n    \"_template\": \"email-prompt.ftl\",\n    \"addresses\": [ \"joan@doe.com\", \"joan@deere.com\" ]\n  },\n  \"auth_session\": \"BmAiCeArLdAa0\",\n}\n</code></pre> <p>Note the <code>flow_paused</code> section has the contents of the object prepared in line 22.</p> <p>Based on this response, now the app should show a selection list for the user to pick one of these addresses. Once the selection is made, a new request can be issued:</p> <pre><code>curl -i -d auth_session=BmAiCeArLdAa0 -d use_auth_session=true\n     --data-urlencode data='{ \"email\": \"joan@doe.com\" }' \n     https://&lt;jans-hostname&gt;/jans-auth/restv1/authorize-challenge\n</code></pre> <p>The flow will continue and the hypothetical message will be sent to <code>joan@doe.com</code> (line 28). Then the next RRF is reached (line 32) and we get as response:</p> <pre><code>HTTP/1.1 401 Unauthorized\nContent-Type: application/json\n...\n\n{\n  \"error\": \"flow_paused\"\n  \"flow_paused\": {\n    \"_template\": \"passcode-prompt.ftl\"\n  },\n  \"auth_session\": \"BmAiCeArLdAa0\",\n}\n</code></pre> <p>The app must now update the UI so the passcode is prompted. When ready, a new request comes:</p> <pre><code>curl -i -d auth_session=BmAiCeArLdAa0 -d use_auth_session=true\n     --data-urlencode data='{ \"otp\": \"123456\" }' \n     https://&lt;jans-hostname&gt;/jans-auth/restv1/authorize-challenge\n</code></pre> <p>Assuming the entered code (123456) was correct, the response would look like:</p> <pre><code>HTTP/1.1 401 Unauthorized\nContent-Type: application/json\n...\n\n{\n  \"error\": \"flow_finished\",\n  \"flow_finished\": {\n    \"data\": { \"userId\": \"Joan\" },\n    \"success\": true\n  },\n  \"auth_session\": \"efb10525-6c43-4e50-88ab-92461c258526\"\n}\n</code></pre> <p>This means we have hit line 37.</p> <p>When a <code>Finish</code> instruction is reached it is fully executed and the error reported in the response changes to <code>flow_finished</code>. What is left now is binding the user identified by <code>userId</code> (Joan) to the authorization request we have been handling (<code>BmAiCeArLdAa0</code>). This is how the user actually gets authenticated.</p>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#final-request","title":"Final request","text":"<p>To authenticate the user, we issue one last request:</p> <pre><code>curl -i -d auth_session=BmAiCeArLdAa0 -d use_auth_session=true\n     https://&lt;jans-hostname&gt;/jans-auth/restv1/authorize-challenge\n</code></pre> <p>Note parameter <code>data</code> is not needed. As response we obtain:</p> <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n...\n\n{ \"authorization_code\" : \"SplxlOBeZQQYbYS6WxSbIA\" }\n</code></pre> <p>Once an authorization code has been obtained, the app can request an access token. This topic is beyond the scope of this document.</p> <p>At this point, the app can update the UI giving the user access to the actual app contents. No more requests are expected to be received by the endpoint with the given <code>auth_session</code> value.</p>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#understanding-errors","title":"Understanding errors","text":"<p>So far we have been following the \"happy\" path in the example flow where all assumptions are met. This is unrealistic so here we offer an overview of how the endpoint behaves when abnormal conditions come up.</p> <p>Note</p> <p>In this section, we stick to the terminology found here.</p>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#missing-parameters","title":"Missing parameters","text":"<p>Assume the following request is issued:</p> <pre><code>curl -i -d use_auth_session=true -d acr_values=agama_challenge -d client_id=&lt;client-id&gt;\n     https://&lt;jans-hostname&gt;/jans-auth/restv1/authorize-challenge\n</code></pre> <p>This lacks the name of the flow to launch. The response is:</p> <pre><code>HTTP/1.1 400 Bad Request\nContent-Type: application/json\n...\n\n{\n  \"error\": \"missing_param\",\n  \"missing_param\": { \"description\": \"Parameter 'flow_name' missing in request\" }\n}\n</code></pre>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#failed-flows","title":"Failed flows","text":"<p>Many times, flows simply fail as a way to reject access. This is achived in Agama by using code like:</p> <pre><code>obj = { success: false, error: \"You are too suspicious\" }\nFinish obj\n</code></pre> <p>In this case, the response looks like:</p> <pre><code>HTTP/1.1 401 Unauthorized\nContent-Type: application/json\n...\n\n{\n  \"error\": \"flow_finished\",\n  \"flow_finished\": {\n    \"success\": false,\n    \"error\": \"You are too suspicious\"\n  }\n}\n</code></pre> <p>Note <code>auth_session</code> is not replied. As such, no more requests to the endpoint should be made passing the <code>auth_session</code> value obtained earlier.</p>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#engine-errors","title":"Engine errors","text":"<p>There are several conditions under which the engine produces errors. In these cases, the HTTP error emitted by the engine is included in the endpoint response. As in previous error scenarios, no <code>auth_session</code> is replied.</p>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#flow-timeout","title":"Flow timeout","text":"<p>With native apps, timeout of flows obeys the same rules of the web scenario. The only difference is the server property employed for the timeout calculation, namely, <code>authorizationChallengeSessionLifetimeInSeconds</code>. If absent, it defaults to one day.</p> <p>Here is how a flow timeout is reported:</p> <pre><code>HTTP/1.1 500 Server Error\nContent-Type: application/json\n...\n\n{\n  \"error\": \"engine_error\",\n  \"engine_error\": {\n    \"description\": \"Unexpected response to https://&lt;jans-hostname&gt;/jans-auth/fl/...\",\n    \"body\": {\n      \"message\": \"You have exceeded the amount of time required to complete your authentication\",\n      \"timeout\": true\n    },\n    \"contentType\": \"application/json\",\n    \"status\": 410\n  }\n}\n</code></pre>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#crashed-flow","title":"Crashed flow","text":"<p>When a flow crashes, the error is reported in similar way the timeout is reported. Here are some examples:</p> <ol> <li> <p>An attempt to access a property or index of a <code>null</code> variable in Agama code</p> <pre><code>HTTP/1.1 500 Server Error\nContent-Type: application/json\n...\n\n{\n  \"error\": \"engine_error\",\n  \"engine_error\": {\n    \"description\": \"Unexpected response to https://&lt;jans-hostname&gt;/jans-auth/fl/...\",\n    \"body\": {\n      \"title\": \"An unexpected error ocurred\",\n      \"message\": \"TypeError: Cannot read property \\\"x\\\" from null\"\n    },\n    \"contentType\": \"application/json\",\n    \"status\": 500\n  }\n}\n</code></pre> </li> <li> <p>A variable does not meet the expected shape for a given Agama directive</p> <pre><code>HTTP/1.1 500 Server Error\nContent-Type: application/json\n...\n\n{\n  \"error\": \"engine_error\",\n  \"engine_error\": {\n    \"description\": \"Unexpected response to https://&lt;jans-hostname&gt;/jans-auth/fl/...\",\n    \"body\": {\n      \"title\": \"An unexpected error ocurred\",\n      \"message\": \"TypeError: Data passed to RRF was not a map or Java equivalent\"\n    },\n    \"contentType\": \"application/json\",\n    \"status\": 500\n  }\n}\n</code></pre> </li> <li> <p>Indexing a string in Java beyond length</p> <pre><code>HTTP/1.1 500 Server Error\nContent-Type: application/json\n...\n\n{\n\n  \"error\": \"engine_error\",\n  \"engine_error\": {\n    \"description\": \"Unexpected response to https://&lt;jans-hostname&gt;/jans-auth/fl/...\",\n    \"body\": {\n      \"title\": \"An unexpected error ocurred\",\n      \"message\": \"String index out of range: 100\"\n    },\n    \"contentType\": \"application/json\",\n    \"status\": 500\n  }\n}\n</code></pre> </li> </ol>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#other-errors","title":"Other errors","text":"<p>There are a variety of miscelaneous errors. Here we describe the most common.</p>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#finished-flows-with-problems-of-user-identification","title":"Finished flows with problems of user identification","text":"<p>When a <code>Finish</code> instruction does not include a reference to a user identifier, or if the referenced user does not exist, the endpoint responds like:</p> <pre><code>HTTP/1.1 500 Server Error\nContent-Type: application/json\n...\n\n{\n  \"error\": \"unexpected_error\",\n  \"unexpected_error\": { \"description\": \"Unable to determine identity of user\" }\n}\n</code></pre>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#attempt-to-launch-an-unknown-flow","title":"Attempt to launch an unknown flow","text":"<p>If the initial request references an inexisting flow or one that has been flagged as not launchable directly by clients.</p> <pre><code>HTTP/1.1 500 Server Error\nContent-Type: application/json\n...\n\n{\n  \"unexpected_error\": {\"description\": \"Flow ... does not exist or cannot be launched an application\"},\n  \"error\": \"unexpected_error\"\n}\n</code></pre>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/native-applications/#agama-is-disabled","title":"Agama is disabled","text":"<p>If the Agama engine is disabled, the following is generated upon the first request:</p> <pre><code>HTTP/1.1 500 Server Error\nContent-Type: application/json\n...\n\n{\n  \"error\": \"unexpected_error\",\n  \"unexpected_error\": { \"description\": \"Agama engine is disabled\" }\n}\n</code></pre>","tags":["developer","agama","native apps","challenge endpoint"]},{"location":"janssen-server/developer/agama/projects-deployment/","title":"Agama projects deployment","text":"<p>The Agama framework defines a file format to package and distribute Agama projects. Here we describe the process of deployment in the Jans Agama engine.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/projects-deployment/#workflow","title":"Workflow","text":"<p>Deployment occurs through a REST API. Here is a typical workflow once a <code>.gama</code> file is ready:</p> <ol> <li>Send (POST) the archive contents to the deployment endpoint. Normally a 202 response should be obtained meaning a task has been queued for processing</li> <li>Poll (via GET) the status of the deployment. When the archive has been effectively deployed a status of 200 should be obtained. It may take up to 30 seconds for the process to complete once the archive is sent. This time may extend if there is another deployment in course</li> <li>Optionally supply configuration properties for flows if needed. This is done via PUT to the <code>/configs</code> endpoint. The response of the previous step may contain descriptive/sample configurations that can be used as a guide</li> <li>Test the deployed flows and adjust the archive for any changes required</li> <li>Go to point 1 if needed. If configuration properties were previously set and no changes are required in this regard, step 3 can be skipped </li> <li>If desired, a request can be sent to undeploy the flows (via DELETE)</li> </ol> <p>The following tables summarize the available endpoints. All URLs are relative to <code>/jans-config-api/api/v1</code>. An OpenAPI document is also available here.</p> Endpoint -&gt; <code>/agama-deployment</code> Purpose Retrieve a list of deployments in the server. This is not a search, just a paged listing Method GET Query params <code>start</code> and <code>count</code> helps paginating results. <code>start</code> is 0-index based. Both params optional Output Existing deployments (regardless they are thoroughly processed or still being deployed). They are listed and sorted by deployment date Sample output <code>{\"start\":...,\"totalEntriesCount\":...,\"entriesCount\":...,\"entries\":[ ... ]}</code> Status 200 (OK) Endpoint -&gt; <code>/agama-deployment/{name}</code> Purpose Retrieve details of a single deployment by name Method GET Path params <code>name</code> Sample output The structure of a deployment is explained below Status 200 (deployment task is finished), 204 (task still in course), 404 (project unknown) Deployment structure Notes Example dn Distinguished name <code>jansId=123,ou=deployments,ou=agama,o=jans</code> id Identifier of deployment (generated automatically) <code>115276</code> createdAt Datetime (in UTC) of the instant the deployment task was created (POSTed) <code>2022-12-07T21:47:42</code> taskActive Boolean value indicating if the deployment task is being currently processed, ie. the <code>gama</code> file is being scanned, flows analysed, etc. <code>false</code> finishedAt Datetime (in UTC) representing the instant when the deployment task was finished, or <code>null</code> if it hasn't ended <code>2022-12-07T21:48:42</code> details Extra details, see below Deployment details structure Notes Example projectMetadata Includes author, type, description, project's name, and example configuration - as supplied when the deployment task was created error A general description of the error (if presented) when processing the task, otherwise <code>null</code> <code>Archive missing web and/or code subdirectories</code> flowsError A mapping of the errors obtained per flow found in the archive. The keys correspond to qualified names. A <code>null</code> value indicates the flow was successfully added <code>{ \"co.acme.example\": \"Syntax error on line 4\", \"io.jans.test\": null }</code> libs A listing of paths to <code>java</code>, <code>groovy</code>, or <code>jar</code> files included in the project archive Endpoint -&gt; <code>/agama-deployment/{name}</code> Purpose Add or replace an Agama project to the server Method POST Path params <code>name</code> (the project's name) Body The binary contents of a <code>.gama</code> file; example here. Ensure to use header <code>Content-Type: application/zip</code> Query params <code>autoconfigure</code> - passing <code>true</code> will make this project be configured with the sample configurations found in the provided binary archive (<code>configs</code> section of project.json). This param should rarely be passed: use only in controlled environments where the archive is not shared with third parties Output Textual explanation, e.g. <code>A deployment task for project XXX has been queued. Use the GET endpoint to poll status</code> Status 202 (the task was created and scheduled for deployment), 409 (there is a task already for this project and it hasn't finished yet), 400 (a param is missing) Endpoint -&gt; <code>/agama-deployment/configs/{name}</code> Purpose Retrieve the configurations associated to flows that belong to the project of interest. The project must have been already processed fully Method GET Path params <code>name</code> (the project's name) Output A JSON object whose properties are flow names and values correspond to configuration properties defined (JSON objects too) Status 200 (successful response), 204 (this project is still in course of deployment), 404 (unknown project) Endpoint -&gt; <code>/agama-deployment/configs/{name}</code> Purpose Set or replace the configurations associated to flows that belong to the project of interest. The project must have been already processed fully Method PUT Path params <code>name</code> (the project's name) Body JSON payload Output A JSON object whose properties are flow names and values correspond to a boolean indicating the success of the update for the given flow Status 200 (successful response), 204 (this project is still in course of deployment), 404 (unknown project), 400 (a param is missing) Endpoint -&gt; <code>/agama-deployment/{name}</code> Purpose Undeploy an Agama project from the server. Entails removing flows and assets initally supplied Method DELETE Path params <code>name</code> (the project's name) Status 204 (scheduled for removal), 409 (the project is being deployed currently), 404 (unknown project)","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/projects-deployment/#endpoints-access","title":"Endpoints access","text":"<p>API operations are protected by Oauth2 scopes this way:</p> <ul> <li>GET: <code>https://jans.io/oauth/config/agama.readonly</code></li> <li>POST:  <code>https://jans.io/oauth/config/agama.write</code></li> <li>DELETE: <code>https://jans.io/oauth/config/agama.delete</code></li> </ul>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/agama/projects-deployment/#internals-of-deployment","title":"Internals of deployment","text":"<p>This section offers details on how the server deploys a <code>.gama</code> file. In summary five steps take place once the deployment task is picked up:</p> <ol> <li>Input payload validation</li> <li>Flows transpilation</li> <li>Transfer of libraries</li> <li>Transfer of assets and source files</li> <li>Task finalization</li> </ol> <p>After the initial validation of structure takes place, the <code>code</code> directory is scanned for <code>flow</code> files and every flow is transpiled and added to the database if its transpilation was successful.</p> <p>Next, <code>jar</code> files found are transferred to the server's custom libs directory - this only applies for VM-based installations.</p> <p>Then a transfer of templates and assets from <code>web</code> directory followed by copying Groovy/Java sources (from <code>lib</code>) takes place. Finally the deployment task is marked as finalized and a status summary saved to database for later retrieval.</p> <p>Notes:</p> <ul> <li>Developers are required to restart the authentication server for the classes in jar files to be effectively picked up</li> <li>Steps 3 and 4 are carried out only if all flows passed transpilation successfully</li> <li>In Cloud Native environments only one node takes charge of processing a given deployment thoroughly. Other nodes will automatically sync with regards to the files of step 4.</li> </ul> <p>The API also offers undeployment capabilities. Here is how it works:</p> <ol> <li>Directories holding templates and assets are removed</li> <li>Source files and jar files are removed, if any</li> <li>Flows are removed from database</li> </ol> <p>The above applies only for the artifacts originally part of the deployment, of course. Again, nodes in Cloud Native installations will sync accordingly.</p>","tags":["administration","developer","agama"]},{"location":"janssen-server/developer/customization/","title":"Customization","text":"<p>Please use the left navigation menu to browse the content of this section while we are still working on developing content for <code>Overview</code> page.</p> <p>Contribute</p> <p>If you\u2019d like to contribute to this document, get started with the Contribution Guide</p>","tags":["administration","developer","customization"]},{"location":"janssen-server/developer/customization/custom-client-logs/","title":"Custom client logs","text":"","tags":["administration","developer","customization"]},{"location":"janssen-server/developer/customization/custom-client-logs/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","developer","customization"]},{"location":"janssen-server/developer/customization/custom-client-logs/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","developer","customization"]},{"location":"janssen-server/developer/customization/custom-client-logs/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","developer","customization"]},{"location":"janssen-server/developer/customization/customize-web-pages/","title":"Customization Using Custom Assets","text":"<p>Janssen Server allows customization and extension of current web page designs, images, web templates etc. For example, extending the list of languages supported by Janssen Server or maybe customizing the login page to show the organization's logo and align styling to meet the branding of the organization.</p> <p>All of the above need some amount of custom assets, like custom CSS stylesheets, logo images, etc to be available on the Janssen Server. All these are called <code>Custom Assets</code>.</p>","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#custom-assets-accepted-by-module","title":"Custom Assets Accepted by Module","text":"<p>Listing of custom asset types that each Janssen Server module accepts:</p>","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#config-api","title":"Config-API","text":"Path Asset Type /opt/jans/jetty/jans-config-api/custom/config *.xml /opt/jans/jetty/jans-config-api/custom/i18n *.properties /opt/jans/jetty/jans-config-api/custom/libs *.jar /opt/jans/jetty/jans-config-api/custom/pages *.xhtml /opt/jans/jetty/jans-config-api/custom/static .js, .css, .png, .gif, .jpg, .jpeg","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#auth-server","title":"Auth-Server","text":"Path Asset Type /opt/jans/jetty/jans-auth/custom/i18n *.properties /opt/jans/jetty/jans-auth/custom/libs *.jars /opt/jans/jetty/jans-auth/custom/pages *.xhtml /opt/jans/jetty/jans-auth/custom/static .js, .css, .png, .gif, .jpg, .jpeg /etc/certs/jans-auth-keys.pkcs12 *.pkcs12","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#casa","title":"Casa","text":"Path Asset Type /opt/jans/jetty/jans-casa/plugins *.jar /opt/jans/jetty/jans-casa/static .js, .css, .png, .gif, .jpg, .jpeg","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#agama","title":"Agama","text":"Path Asset Type /opt/jans/jetty/jans-auth/agama engine templates /opt/jans/jetty/jans-auth/agama/fl .js, .css, .png, .gif, .jpg, .jpeg /opt/jans/jetty/jans-auth/agama/ftl .ftl, .ftlh /opt/jans/jetty/jans-auth/agama/scripts .java .groovy, .gvy, .gy, *.gsh","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#fido2","title":"Fido2","text":"Path Asset Type /etc/jans/conf/fido2/authenticator_cert .pem, .crt /etc/jans/conf/fido2/mds/cert *.crt /etc/jans/conf/fido2/mds/toc *.jwt /etc/jans/conf/fido2/server_metadata *.json","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#lock","title":"Lock","text":"Path Asset Type /opt/jans/jetty/jans-lock/custom/libs *.jar","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#keycloak-link","title":"KeyCloak-link","text":"Path Asset Type /opt/jans/jetty/jans-keycloak-link/custom/libs/ *.jar /var/jans/keycloak-link-snapshots/ *.txt","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#link","title":"Link","text":"Path Asset Type /opt/jans/jetty/jans-link/custom/libs *.jar /var/jans/link-snapshots/ *.txt","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#managing-custom-assets","title":"Managing Custom Assets","text":"<p>Janssen Server configuration tools like CLI and TUI provide the ability to add, update, and delete custom assets. Refer to the custom assets configuration guide to learn how to manage custom assets.</p>","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#customizing-web-pages","title":"Customizing Web Pages","text":"<p>Janssen Server uses xhtml pages to render the web interface needed in interactive web-flows. For example, password authentication flow.</p> <p>It is possible to override the built-in <code>xhtml</code> pages or to add completely new pages.</p>","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#customizing-built-in-web-pages","title":"Customizing Built-in Web Pages","text":"<p>In order to customize built-in web pages, follow the steps below:</p> <ul> <li>Create a new <code>xhtml</code> page as a copy of the relevant built-in xhtml page</li> <li>Make changes to the code of the new page according to the need </li> <li>Override the built-in page with the new page</li> </ul> <p>To override the built-in page with the new page, add the new page as a custom asset and make sure that the new page has the same name and extension as the built-in page. The Janssen Server will automatically use the custom page instead of the built-in page.</p> <p>For example, the default login web page is rendered using login.xhtml. To override this page, add a new custom <code>login.xhtml</code>. Same can be done for other built-in pages like authorization page, logout page, error page.</p>","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#adding-new-web-pages","title":"Adding New Web Pages","text":"<p>If the authentication/authorization flow requires new web pages, the same can be added as custom asset and then can be referenced using a relative path.</p> <p>For instance, if <code>enterOTP.xhtml</code> is your webpage for step 2 of the authentication flow that is being implemented using a custom script, then upload the page as a custom asset under the relevant Janssen service and then reference it in the custom script as follows:</p> <pre><code> def getPageForStep(self, configurationAttributes, step):\n # Used to specify the page you want to return for a given step\n if (step == 1):\n return \"/auth/login.xhtml\"  \n if (step == 2)\n return \"/auth/enterOTP.xhtml\"\n</code></pre>","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#reference-login-pages","title":"Reference login pages:","text":"<p>Here you will find several login pages for different authentication methods.</p>","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#customized-resource-bundles","title":"Customized resource bundles:","text":"<p>Janssen Server provides language translation support using a set of built-in resource bundles.</p> <p>To override the defaults, the custom <code>.properties</code> files should be uploaded as custom assets. If the file name matches the existing resource bundle, then the custom bundle will override the built-in resource bundle.</p> <p>Examples of file names are:</p> <ul> <li>jans-auth_en.properties</li> <li>jans-auth_bg.properties</li> </ul> <p>To add translations for a language that is not yet supported, create a new properties file and name it jans-auth_[language_code].properties. Then add it to the Janssen Server as custom asset. Janssen Server will automatically add the support for new language using the new resource bundle.</p>","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#custom-css-files","title":"Custom CSS files:","text":"<p>Upload the custom CSS files as custom assets and then reference it in <code>.xhtml</code> file using the URL <code>https://your.jans.server/jans-auth/ext/resources/stylesheet/theme.css</code> or <code>/jans-auth/ext/resources/stylesheet/theme.css</code></p>","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#custom-image-files","title":"Custom image files:","text":"<p>Upload the custom image files as custom assets and then reference it in <code>.xhtml</code> file using the URL <code>https://your.jans.server/jans-auth/ext/resources/img/fileName.png</code> or <code>/jans-auth/ext/resources/img/fileName.jpg</code>.</p>","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/customization/customize-web-pages/#page-layout-header-footer-xhtml-template-customization","title":"Page layout, header, footer (xhtml Template) customization","text":"<p>Templates refer to the common interface layout and style. For example, a banner, logo in the common header, and copyright information in the footer.</p> <p>Upload the custom template <code>template.xhtml</code> file as custom assets.This file will automatically override the built-in default template file.</p>","tags":["administration","developer","customization","internationalization","i18n","locale","css","images","header","footer","template"]},{"location":"janssen-server/developer/scripts/","title":"Interception Scripts (or custom scripts)","text":"<p>Interception scripts (or custom scripts)  allow you to define custom business logic for various features offered by the OpenID Provider (Jans-auth server). Some examples of features which can be customized are - implementing a 2FA authentication method, consent gathering, client registration, adding business specific claims to ID token or Access token etc. Scripts can easily be upgraded and doesn't require forking the Jans Server code or re-building it.</p>","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#types-of-interception-scripts-in-jans-server","title":"Types of Interception scripts in Jans server","text":"<p>Listed below, are custom scripts classified into various types, each of which represents a feature of the Jans server that can be extended as per the business need. Each script type is described by a java interface whose methods should be overridden to implement your business case.</p> Script Name Purpose Person Authentication Allows the definition of multi-step authentication workflows, including adaptive authentication - where the number of steps varies depending on the context. Consent Gathering Allows exact customization of the authorization (or consent) process. By default, the OP will request authorization for each scope, and display the respective scope description. Link Interception (Link Interception) Allows implementing custom business logic in existing link interception script. Client Registration Allows implementing custom business logic during dynamic client registration, including validating SSA's and granting scopes. Dynamic Scopes Enables admin to generate scopes on the fly, for example by calling external APIs ID Generator Update Token Enables transformation of claims and values in id_token, Access token and Refresh tokens; allows the setting of token lifetime; allows the addition or removal of scopes to / from tokens; allows the addition of audit logs each time a token is created. Session Management Token Exchange Token Exchange custom script which allows to perform custom validation, send error response and modify existing response if needed. SCIM Introspection Introspection scripts allows to modify response of Introspection Endpoint spec and present additional meta information surrounding the token. Post Authentication Client Authentication Authorization Challenge Authorization Detail Access Evaluation Access Evaluation custom script for Access Evaluation Endpoint (AuthZEN) Access Evaluation Discovery Access Evaluation Discovery custom script for <code>/.well-known/authzen-configuration</code> Access Evaluation Discovery Endpoint (AuthZEN) Select Account Resource Owner Password Credentials UMA 2 RPT Authorization Policies UMA 2 Claims-Gathering UMA RPT Claims Fido2 Extension Extension of attestation and assertion endpoints Discovery OpenID discovery response modification Logout Status JWT Logout Status JWT modification: lifetime and claims PAR PAR Script to modify PAR before persistence or/and change response from <code>/par</code> endpoint Transaction Token TxToken Script to modify TxToken payload, response from endpoint or lifetime. Cookie Cookies attributes modification script CIBA - End User notification Configuration API IDP End Session Persistence Extension Revoke Token Application Session Spontaneous Scope Create User SSA Response Modification Healtch Check Lock Extension","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#implementation-languages-jython-or-pure-java","title":"Implementation languages - Jython or pure Java","text":"<p>Interception scripts are written in Jython or in pure Java, enabling Java or Python libraries to be imported.</p>","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#implementation-in-pure-java","title":"Implementation in Pure Java","text":"<p>A script in Java refers to a java source file (e.g. <code>Discovery.java</code>) which is compiled by AS and executed at runtime.</p> <p>Some rules:</p> <ul> <li>The java class file containing the script should not have a package set.</li> <li>The name of the class must match to the name set in CustomScriptType source code (e.g. for discovery script it is \"Discovery\")</li> <li>Scripts must implement predefined interface which can be found against the CustomScriptType. For e.g. if you are writing a Person authentication script then your class should implement the following interface</li> <li>All libraries available at runtime to server are available also to pure java script</li> <li>To log to <code>jans-auth_script.log</code> use <code>scriptLogger</code></li> <li>Normal log will log in to <code>jans-auth.log</code></li> </ul> <p>Example pure java script <pre><code>import io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.discovery.DiscoveryType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.json.JSONObject;\n\nimport java.util.Map;\n\n/**\n * @author Yuriy Zabrovarnyy\n */\npublic class Discovery implements DiscoveryType {\n\n    private static final Logger log = LoggerFactory.getLogger(Discovery.class);\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Init of Discovery Java custom script\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Init of Discovery Java custom script\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Destroy of Discovery Java custom script\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        log.info(\"getApiVersion Discovery Java custom script: 11\");\n        return 11;\n    }\n\n    @Override\n    public boolean modifyResponse(Object responseAsJsonObject, Object context) {\n        scriptLogger.info(\"write to script logger\");\n        JSONObject response = (JSONObject) responseAsJsonObject;\n        response.accumulate(\"key_from_java\", \"value_from_script_on_java\");\n        return true;\n    }\n}\n</code></pre></p>","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#using-java-libraries-in-a-script","title":"Using Java libraries in a script:","text":"<p> Steps: 1. Add library jars to <code>/opt/jans/jetty/jans-auth/custom/libs/</code> 2. Edit /opt/jans/jetty/jans-auth/webapps/jans-auth.xml and add the following line replacing the word <code>library-name</code> with the actual name of the library: <pre><code>&lt;Set name=\"extraClasspath\"&gt;/opt/jans/jetty/jans-auth/custom/libs/library-name.jar&lt;/Set&gt;\n</code></pre> 3. Restart jans-auth service <code>systemctl restart jans-auth</code></p>","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#implementation-in-jython","title":"Implementation in Jython","text":"<p>The example below is only meant to convey the concept, we will cover the details in later parts of the documentation. Suppose, we are implementing an Openbanking Identity platform and we have to add business specific claims say <code>openbanking_intent_id</code> to the ID token. The custom script which will help us accomplish our goal is of the type <code>UpdateTokenType</code> where the <code>modifyIdToken</code> method has to be implemented. A sample custom script with this business logic will be as stated below: <pre><code>class UpdateToken(UpdateTokenType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        &lt; initialization code comes here &gt;\n        return True\n\n    def destroy(self, configurationAttributes):\n        &lt; clean up code comes here&gt;\n        return True\n\n    def getApiVersion(self):\n        return &lt;version number&gt;\n\n   def modifyIdToken(self, jsonWebResponse, context):\n\n       # Step1: &lt;get openbanking_intent_id from session &gt;\n              sessionId = context.getSession()\n              openbanking_intent_id = sessionId.getSessionAttributes().get(\"openbanking_intent_id \")   \n\n       # Step2: &lt;add custom claims to ID token here&gt;\n              jsonWebResponse.getClaims().setClaim(\"openbanking_intent_id \", openbanking_intent_id )\n</code></pre></p>","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#using-java-libraries-in-a-jython-script","title":"Using Java libraries in a Jython script:","text":"<p> Steps: 1. Add library jars to <code>/opt/jans/jetty/jans-auth/custom/libs/</code> 2. Edit /opt/jans/jetty/jans-auth/webapps/jans-auth.xml and add the following line replacing the word <code>library-name</code> with the actual name of the library: <pre><code>&lt;Set name=\"extraClasspath\"&gt;/opt/jans/jetty/jans-auth/custom/libs/library-name.jar&lt;/Set&gt;\n</code></pre> 3. Restart jans-auth service <code>systemctl restart jans-auth</code></p>","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#using-python-libraries-in-a-script","title":"Using Python libraries in a script:","text":"<ol> <li> <p>You can only use libraries (packages and modules) that are written in    Pure Python. Importing a Python class which is a wrapper around a library    written in C is not supported by the Jans server. As an example, the psycopg2    library used to connect to PostgreSQL from Python. Since it is a C wrapper    around libpq, it won't work with Jython.</p> </li> <li> <p>Python 3 packages / modules are not supported.</p> </li> </ol> <p> Steps: 1. Pure Python libraries should be added to <code>/opt/jans/python/libs</code></p> <ol> <li> <p>Using pip to install additional Python packages:</p> </li> <li> <p>Find out about your Jython version first. cd into the /opt directory in your   Jans Server container and run ls. A directory named jython- should be   listed too where  will correspond to the Jython version. Note the   version. <li>Open the file <code>/etc/jans/conf/jans.properties</code> and look for the line starting   with <code>pythonModulesDir=</code>. Append the value <code>/opt/jython-&lt;version&gt;/Lib/site-packages</code>   to any existing value. Each value is separater by a colon (:). It should look   something like this <code>pythonModulesDir=/opt/jans/python/libs:/opt/jython-2.7.2a/Lib/site-packages</code>   Run the following command <code>/opt/jython-&lt;version&gt;/bin/jython -m ensurepip</code>   Install your library with <code>/opt/jython-&lt;version&gt;/bin/pip install &lt;library_name&gt;</code>   where  is the name of the library to install. <li>Restart the jans-auth service : <code>systemctl restart jans-auth</code></li>","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#debugging-a-jython-script","title":"Debugging a Jython script","text":"<ol> <li> <p>This article covers the details for debugging a script in a developer environment (CE).</p> </li> <li> <p>This article covers the details for debugging a script in a CN environment.</p> </li> </ol>","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#mandatory-methods-to-be-overridden","title":"Mandatory methods to be overridden","text":"<p>This is the base class of all custom script types and all custom scripts should implement the following methods. * <code>init(self, customScript, configurationAttributes)</code> : This method is only   called once during the script initialization (or jans-auth service restarts). It   can be used for global script initialization, initiate objects etc</p> <ul> <li> <p><code>destroy(self, configurationAttributes)</code>: This method is called when a custom   script fails to initialize or upon jans-auth service restarts. It can be used to   free resource and objects created in the init() method</p> </li> <li> <p><code>getApiVersion(self, configurationAttributes, customScript)</code> : The   getApiVersion method allows API changes in order to do transparent migration   from an old script to a new API. Only include the customScript variable if the   value for getApiVersion is greater than 10</p> </li> </ul>","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#configurable-properties-of-a-custom-script","title":"Configurable properties of a custom script","text":"Property Description Name unique identifier(name) for the custom script e.g. person_authentication_google Description Description Text Programming Languages Python/Java Level Used in Person Authentication script type, the strength of the credential is a numerical value assigned to the custom script that is tied to the authentication method. The higher the value, the stronger it is considered. Thus, if a user has several credentials enrolled, he will be asked to present the one of them having the highest strength associated. Location type <ul> <li> Database - Stored in persistence (MYSQL or PLSQL whichever applicable ) </li><li>File - stored as a file  Interactive <ul><li>Web - web application</li><li>native - mobile application</li><li>both</li></ul> Custom Properties Key - value pairs for configurable parameters like Third Party API keys, location of configuration files etc","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#building-business-logic-in-a-custom-script","title":"Building business logic in a custom script","text":"<p>Jans-auth server uses Weld 3.0 (JSR-365 aka CDI 2.0) for managed beans. The most common business functions are implemented through a set of beans. This article presents many ready-to-use beans which can be used to build a script.</p>","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#operations-on-custom-scripts-using-jans-cli","title":"Operations on custom scripts using jans-cli","text":"<p>Jans-cli supports the following six operations on custom scripts:</p> <ol> <li><code>get-config-scripts</code>, gets a list of custom scripts.</li> <li><code>post-config-scripts</code>, adds a new custom script.</li> <li><code>put-config-scripts</code>, updates a custom script.</li> <li><code>get-config-scripts-by-type</code>, requires an argument <code>--url-suffix TYPE: ______</code>.    You can specify the following types: PERSON_AUTHENTICATION, INTROSPECTION, RESOURCE_OWNER_PASSWORD_CREDENTIALS, APPLICATION_SESSION, CACHE_REFRESH, UPDATE_USER, USER_REGISTRATION, CLIENT_REGISTRATION, ID_GENERATOR, UMA_RPT_POLICY, UMA_RPT_CLAIMS, UMA_CLAIMS_GATHERING, CONSENT_GATHERING, DYNAMIC_SCOPE, SPONTANEOUS_SCOPE, END_SESSION, POST_AUTHN, SCIM, CIBA_END_USER_NOTIFICATION, PERSISTENCE_EXTENSION, IDP, or UPDATE_TOKEN.</li> <li><code>get-config-scripts-by-inum</code>, requires an argument <code>--url-suffix inum: _____</code></li> <li><code>delete-config-scripts-by-inum</code>, requires an argument <code>--url-suffix inum: _____</code></li> </ol> <p>The post-config-scripts and put-config-scripts require various details about the scripts. The following command gives the basic schema of the custom scripts to pass to these operations.</p>","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#basic-schema-of-a-custom-script","title":"Basic schema of a custom script","text":"<p>Command:</p> <p><code>/opt/jans/jans-cli/config-cli.py --schema CustomScript</code></p> <p>Output: <pre><code>{\n    \"dn\": \"string\",\n    \"inum\": \"string\",\n    \"name\": \"string\",\n    \"aliases\": [\n        \"string\"\n    ],\n    \"description\": \"string\",\n    \"script\": \"string\",\n    \"scriptType\": \"ciba_end_user_notification\",\n    \"programmingLanguage\": \"python\",\n    \"level\": 45,\n    \"revision\": 156,\n    \"enabled\": true,\n    \"scriptError\": {\n        \"raisedAt\": {\n        \"type\": \"string\",\n        \"format\": \"date-time\"\n        },\n        \"stackTrace\": {\n        \"type\": \"string\"\n        }\n    },\n    \"modified\": true,\n    \"internal\": true,\n    \"locationType\": \"db\",\n    \"locationPath\": \"string\",\n    \"baseDn\": \"string\"\n}\n</code></pre> To add or modify a script first, we need to create the script's python file (e.g. /tmp/sample.py) and then create a JSON file by following the above schema and update the fields as :</p> <p>/tmp/sample.json <pre><code>{\n  \"name\": \"mySampleScript\",\n  \"aliases\": null,\n  \"description\": \"This is a sample script\",\n  \"script\": \"_file /tmp/sample.py\",\n  \"scriptType\": \"PERSON_AUTHENTICATION\",\n  \"programmingLanguage\": \"PYTHON\",\n  \"moduleProperties\": [\n    {\n      \"value1\": \"mayvalue1\",\n      \"value2\": \"myvalues2\",\n      \"description\": \"description for property\"\n    }\n  ],\n  \"configurationProperties\": null,\n  \"level\": 1,\n  \"revision\": 0,\n  \"enabled\": false,\n  \"scriptError\": null,\n  \"modified\": false,\n  \"internal\": false\n}\n</code></pre></p>","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#add-modify-and-delete-a-script","title":"Add, Modify and Delete a script","text":"<p>The following command will add a new script with details given in /tmp/sample.json file. The jans-cli will generate a unique inum of this new script if we skip inum in the json file. <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id post-config-scripts --data /tmp/sampleadd.json\n</code></pre> The following command will modify/update the existing script with details given in /tmp/samplemodify.json file. Remember to set inum field in samplemodify.json to the inum of the script to update.</p> <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id put-config-scripts --data /tmp/samplemodify.json\n</code></pre> <p>To delete a custom script by its inum, use the following command:</p> <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id delete-config-scripts-by-inum --url-suffix inum:SAMPLE-TEST-INUM\n</code></pre>","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#list-existing-custom-scripts","title":"List existing custom scripts","text":"<p>These commands to print the details are important, as using them we can get the inum of these scripts which is required to perform update or delete operation.</p> <ol> <li> <p>The following command will display the details of all the existing custom scripts. This will be helpful to get the inum of scripts to perform the update and delete operation. <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id get-config-scripts\n</code></pre></p> </li> <li> <p>Following command displays the details of selected custom script (by inum).</p> </li> </ol> <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id get-config-scripts-by-inum --url-suffix inum:_____  \n</code></pre> <ol> <li>Use the following command to display the details of existing custom scripts of a given type (for example: INTROSPECTION). <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id get-config-scripts-by-type --url-suffix type:INTROSPECTION\n</code></pre> Note: Incase the AS's Access token is bound to the client's MTLS certificate, you need to add the certificate and key files to the above commands. E.g: <code>/opt/jans/jans-cli/config-cli.py --operation-id post-config-scripts --data /tmp/sampleadd.json -cert-file sampleCert.pem -key-file sampleKey.key</code></li> </ol>","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#client-specific-implementations","title":"Client specific implementations","text":"","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/developer/scripts/#useful-links","title":"Useful links","text":"<ol> <li>Custom scripts and jans-cli</li> </ol>","tags":["administration","developer","interception scripts"]},{"location":"janssen-server/fido/","title":"FIDO Administration Guide","text":"","tags":["administration","fido"]},{"location":"janssen-server/fido/#janssen-fido2-server","title":"Janssen FIDO2 server","text":"<p>FIDO2 as an open standard for authentication is based on public key cryptography.</p> <p>Janssen's FIDO2 server - a component inside the Janssen project enables users of RPs to enroll and authenticate themselves using U2F keys, FIDO2 keys or inbuilt platform authenticator.</p> <ol> <li>The FIDO2 server uses REST endpoints to communicate with an RP via an https connection.</li> <li>The FIDO2 server implements the FIDO Metadata Service (MDS3) defined by FIDO Alliance.</li> <li>The FIDO2 server stores user data into the same persistence store as the Jans-Auth server. (PostgreSQL, MYSQL etc.)</li> </ol> <p>Janssen's FIDO server is a standalone server communicates with the RP using an API which can be obtained by querying the following URL :</p> <pre><code>https://&lt;myjans-server&gt;/.well-known/fido2-configuration\n</code></pre> <p>Response:</p> <pre><code>  {\n    \"version\": \"1.1\",\n    \"issuer\": \"https://&lt;myjans-server&gt;\",\n    \"attestation\": {\n      \"base_path\": \"https://&lt;myjans-server&gt;/jans-fido2/restv1/attestation\",\n      \"options_enpoint\": \"https://&lt;myjans-server&gt;/jans-fido2/restv1/attestation/options\",\n      \"result_enpoint\": \"https://&lt;myjans-server&gt;/jans-fido2/restv1/attestation/result\"\n    },\n    \"assertion\": {\n      \"base_path\": \"https://&lt;myjans-server&gt;/jans-fido2/restv1/assertion\",\n      \"options_enpoint\": \"https://&lt;myjans-server&gt;/jans-fido2/restv1/assertion/options\",\n      \"result_enpoint\": \"https://&lt;myjans-server&gt;/jans-fido2/restv1/assertion/result\"\n    }\n  }\n</code></pre>","tags":["administration","fido"]},{"location":"janssen-server/fido/#customization-authentication-flow-using-interception-script","title":"Customization authentication flow using Interception script","text":"<p>In the Janssen ecosystem, the authentication flow that comprises of the calls to WebAuthn   API and the FIDO server is achieved using an interception script, details of it can be found   here.</p>","tags":["administration","fido"]},{"location":"janssen-server/fido/#managing-user-fido-devices","title":"Managing User FIDO Devices","text":"<p>TUI privdes managing user FIDO devices, see here.</p>","tags":["administration","fido"]},{"location":"janssen-server/fido/#references","title":"References","text":"<ol> <li>https://www.w3.org/TR/webauthn-2/</li> <li>http://fidoalliance.org/specs/mds/fido-metadata-statement-v3.0-ps-20210518.html</li> </ol>","tags":["administration","fido"]},{"location":"janssen-server/fido/#tools","title":"Tools","text":"<ol> <li>https://jwt.io/ \u2013 For JWT decoding and debugging</li> <li>https://www.base64decode.org/ \u2013 For Decoding Base64 to UTF8</li> <li>https://fidoalliance.org/certification/fido-certified-products/ - To browse authenticators listed with FIDO Alliance</li> </ol>","tags":["administration","fido"]},{"location":"janssen-server/fido/config/","title":"FIDO Configuration","text":"","tags":["administration","fido2"]},{"location":"janssen-server/fido/config/#configuration-parameters-of-janssens-fido2-server","title":"Configuration Parameters of Janssen's FIDO2 server:","text":"Field named Example Description issuer https://my-jans-server.jans.io URL using the https scheme with no query or fragment component. The OP asserts this as its Issuer Identifier baseEndpoint https://my-jans-server/jans-fido2/restv1 Base URL of the FIDO2 server Endpoints webAuthnEndpoint https://FQDN/jans-fido2/restv1/webauthn/configuration Base URL of the FIDO2 Web Authn Server Endpoint which return RP Origins cleanServiceInterval 60 Time interval for the Clean Service in seconds. cleanServiceBatchChunkSize 10000 Each clean up iteration fetches chunk of expired data per base dn and removes it from storage. useLocalCache true Boolean value specifying whether to enable local in-memory cache for attributes, scopes, clients and organization configuration disableJdkLogger true Boolean value specifying whether to enable JDK Loggers loggingLevel \"INFO\" or \"TRACE\" or \"DEBUG\" Logging level for FIDO2 server loggingLayout \"text\" or \"json\" Contents of logs as plain text or json format externalLoggerConfiguration Path to external log4j2 logging configuration metricReporterInterval 300 The interval for metric reporter in seconds. metricReporterKeepDataDays 15 The number of days to retain metric reported data in the system metricReporterEnabled true Boolean value specifying whether to enable Metric Reporter fido2Configuration See JSON contents in the below example FIDO2 Configuration","tags":["administration","fido2"]},{"location":"janssen-server/fido/config/#fido2configuration-structure","title":"Fido2Configuration structure","text":"Field Type Description Default Value / Example <code>authenticatorCertsFolder</code> String The folder where authenticator certificates are stored. <code>\"%(fido2ConfigFolder)s/authenticator_cert\"</code> <code>mdsCertsFolder</code> String The folder where MDS TOC root certificates are stored. <code>\"%(fido2ConfigFolder)s/mds/cert\"</code> <code>mdsTocsFolder</code> String The folder where MDS TOC files are stored. <code>\"%(fido2ConfigFolder)s/mds/toc\"</code> <code>userAutoEnrollment</code> Boolean Whether to allow users to enroll on enrollment/authentication requests. <code>false</code> <code>unfinishedRequestExpiration</code> Integer The expiration time in seconds for pending enrollment/authentication requests. <code>120</code> (120 seconds) <code>metadataRefreshInterval</code> Integer The expiration time in seconds for approved authentication requests. <code>1296000</code> (15 days) <code>serverMetadataFolder</code> String The folder where authenticators' metadata in JSON format is stored. <code>\"%(fido2ConfigFolder)s/server_metadata\"</code> <code>enabledFidoAlgorithms</code> Array of Strings The list of requested credential types for FIDO authentication. <code>[\"RS256\", \"ES256\"]</code> <code>requestedParties</code> Array of Objects The list of requested parties (RPs) configuration for FIDO authentication. <code>[ { \"id\": \"https://%(hostname)s\", \"origins\": [\"%(hostname)s\"] } ]</code> <code>metadataServers</code> Array of Objects A list of metadata servers providing external metadata URLs for FIDO authentication. <code>[ { \"url\": \"https://mds.fidoalliance.org/\" } ]</code> <code>disableMetadataService</code> Boolean Whether downloading MDS metadata should be skipped. <code>false</code> <code>hints</code> Array of Strings Hints provided to the RP (e.g., security-key, client-device, hybrid). <code>[\"security-key\", \"client-device\", \"hybrid\"]</code> <code>enterpriseAttestation</code> Boolean Whether enterprise authenticators are enabled for use in a specific protected environment. <code>false</code> <code>attestationMode</code> String \"disabled\" means attestation \"none\", \"monitor\" means attestation \"direct\" but still accept if none return, \"enforced\" means that credential creation will fail if attestation is not returned <code>\"monitor\"</code>","tags":["administration","fido2"]},{"location":"janssen-server/fido/config/#configuring-the-fido2-server","title":"Configuring the FIDO2 server:","text":"","tags":["administration","fido2"]},{"location":"janssen-server/fido/config/#1-read-configuration-parameters","title":"1. Read Configuration parameters:","text":"<p>Use the following command to obtain configuration parameters:</p> <p><code>jans cli --operation-id get-properties-fido2</code></p> <p>Response: <pre><code>{\n  \"issuer\": \"https://my.jans.server\",\n  \"baseEndpoint\": \"https://my.jans.server/jans-fido2/restv1\",\n  \"cleanServiceInterval\": 60,\n  \"cleanServiceBatchChunkSize\": 10000,\n  \"useLocalCache\": true,\n  \"disableJdkLogger\": true,\n  \"loggingLevel\": \"DEBUG\",\n  \"loggingLayout\": \"text\",\n  \"metricReporterInterval\": 300,\n  \"metricReporterKeepDataDays\": 15,\n  \"metricReporterEnabled\": true,\n  \"personCustomObjectClassList\": [\n    \"jansCustomPerson\",\n    \"jansPerson\"\n  ],\n  \"sessionIdPersistInCache\": false,\n  \"fido2Configuration\": {\n    \"authenticatorCertsFolder\": \"/etc/jans/conf/fido2/authenticator_cert\",\n    \"mdsCertsFolder\": \"/etc/jans/conf/fido2/mds/cert\",\n    \"mdsTocsFolder\": \"/etc/jans/conf/fido2/mds/toc\",\n    \"checkU2fAttestations\": false,\n    \"debugUserAutoEnrollment\": false,\n    \"unfinishedRequestExpiration\": 180,\n    \"authenticationHistoryExpiration\": 1296000,\n    \"serverMetadataFolder\": \"/etc/jans/conf/fido2/server_metadata\",\n    \"metadataUrlsProvider\": \"\",\n    \"disableMetadataService\": false,\n    \"attestationMode\": \"monitor\",\n    \"assertionOptionsGenerateEndpointEnabled\":true,\n    \"enabledFidoAlgorithms\": [\n      \"RS256\",\n      \"ES256\"\n    ],\n    \"rp\": [\n      {\n        \"id\": \"https://my.jans.server\",\n        \"origins\": [\n          \"my.jans.server\"\n        ]\n      }\n    ]\n  }\n}\n</code></pre></p>","tags":["administration","fido2"]},{"location":"janssen-server/fido/config/#2-update-configuration-parameters","title":"2. Update configuration parameters:","text":"<p>Steps:   A. Create a JSON file say <code>/tmp/config_values.json</code> by editing the JSON from Point 1   B. Use the following command   <code>jans cli --operation-id post-config-scripts --data /tmp/config_values.json</code></p>","tags":["administration","fido2"]},{"location":"janssen-server/fido/config/#3-change-log-level-of-fido2-server","title":"3. Change log level of FIDO2 server","text":"<p>Steps:   A. Create a JSON file say <code>/tmp/config_values.json</code> by editing the JSON from Point 1. Edit <code>loggingLevel</code> to <code>TRACE</code> or <code>DEBUG</code> or <code>INFO</code>   B. Use the following command     <code>jans cli --operation-id put-properties-fido --data /tmp/config_values.json</code></p>","tags":["administration","fido2"]},{"location":"janssen-server/fido/config/#4-locating-fido2-configuration-in-persistence-layer","title":"4. Locating FIDO2 configuration in Persistence Layer","text":"<p>While it is not recommended that an administrator directly edits a configuration at the persistence layer, it may be useful information for a developer.</p>","tags":["administration","fido2"]},{"location":"janssen-server/fido/config/#5-webauthn-endpoint","title":"5. WebAuthn Endpoint","text":"<p>A. The WebAuthn Endpoints retrieve the list of RP (Relying Party) Origins configured for FIDO2 authentication.   B. Endpoints: https://FQDN/restv1/webauthn/configuration &amp;&amp; https://FQDN/.well-known/webauthn</p>","tags":["administration","fido2"]},{"location":"janssen-server/fido/config/#mysql","title":"MySQL","text":"<pre><code>erDiagram\n    jansAppConf {\n        string doc_id PK \"\"\n        string ou  \"jans-fido2\"\n        string jansConfDyn \"json configuration for the app\"\n    }</code></pre>","tags":["administration","fido2"]},{"location":"janssen-server/fido/logs/","title":"FIDO Logs","text":"","tags":["administration","fido"]},{"location":"janssen-server/fido/logs/#log-level-and-logging-layout-parameters-of-janssens-fido2-server","title":"Log level and Logging Layout Parameters of Janssen's FIDO2 server:","text":"Field named Example Description loggingLevel \"INFO\" or \"TRACE\" or \"DEBUG\" Logging level for FIDO2 server loggingLayout \"text\" or \"json\" Contents of logs as plain text or json format","tags":["administration","fido"]},{"location":"janssen-server/fido/logs/#1-read-configuration-parameters","title":"1. Read Configuration parameters:","text":"<p>Use the following command to obtain configuration parameters:</p> <p><code>jans cli --operation-id get-properties-fido2</code></p> <p>Response: <pre><code>{\n   \"issuer\":\"https://.jans.io\",\n   \"baseEndpoint\":\"https://my-jans-server.jans.io/jans-fido2/restv1\",\n   \"cleanServiceInterval\":60,\n   \"cleanServiceBatchChunkSize\":10000,\n   \"useLocalCache\":true,\n   \"disableJdkLogger\":true,\n   \"loggingLevel\":\"INFO\",\n   \"loggingLayout\":\"text\",\n   \"externalLoggerConfiguration\":\"\",\n   \"metricReporterInterval\":300,\n   \"metricReporterKeepDataDays\":15,\n   \"metricReporterEnabled\":true,\n   \"personCustomObjectClassList\":[\n      \"jansCustomPerson\",\n      \"jansPerson\"\n   ],\n   \"fido2Configuration\":{\n      \"authenticatorCertsFolder\":\"/etc/jans/conf/fido2/authenticator_cert\",\n      \"mdsCertsFolder\":\"/etc/jans/conf/fido2/mds/cert\",\n      \"mdsTocsFolder\":\"/etc/jans/conf/fido2/mds/toc\",\n      \"serverMetadataFolder\":\"/etc/jans/conf/fido2/server_metadata\",\n      \"enabledFidoAlgorithms\":[\n         \"RS256\",\n         \"ES256\"\n      ],\n      \"rp\":[\n         {\n            \"id\":\"https://my-jans-server.jans.io\",\n            \"origins\":[\n               \"my-jans-server.jans.io\"\n            ]\n         }\n      ],\n      \"debugUserAutoEnrollment\":false,\n      \"unfinishedRequestExpiration\":180,\n      \"authenticationHistoryExpiration\":1296000\n   }\n}\n</code></pre></p>","tags":["administration","fido"]},{"location":"janssen-server/fido/logs/#2-update-logginglevel-or-logginglayout","title":"2. Update <code>loggingLevel</code> or <code>loggingLayout</code>:","text":"<p>Steps:   A. Create a JSON file say <code>/tmp/config_values.json</code> by editing the JSON from Point 1 and      - edit <code>loggingLevel</code> to <code>TRACE</code> or <code>DEBUG</code> or <code>INFO</code>      - edit <code>loggingLayout</code> to <code>text</code> or <code>json</code></p> <p>B. Use the following command to update the logging level   <code>jans cli --operation-id post-config-scripts --data /tmp/config_values.json</code></p> <p>C. restart <code>jans-fido2</code> <code>service fido2 restart</code> or <code>systemctl restart fido2</code></p>","tags":["administration","fido"]},{"location":"janssen-server/fido/logs/#location-of-logs-in-fido2-server","title":"Location of logs in FIDO2 server:","text":"<p>Logs can be found at <code>/opt/jans/jetty/jans-fido2/logs</code></p>","tags":["administration","fido"]},{"location":"janssen-server/fido/passwordlessLoginExperience/","title":"FIDO Passwordless / Usernameless Login","text":"<p>Seamless Passwordless and Usernameless Login</p> <ul> <li>Conditional UI eliminates the need for both passwords and usernames.</li> <li>Users don\u2019t have to recall their registered email or username.</li> <li>Browsers provide autofill suggestions, displaying the correct email or username along with the appropriate passkey.</li> <li>Conditional UI allows websites to initiate a passkey/WebAuthn request alongside a standard password prompt.</li> <li>The effectiveness of Conditional UI depends on the compatibility of the user\u2019s device and browser. Read more here(https://passkeys.dev/device-support/)</li> </ul> <p>Sequence diagram</p> <p><pre><code>User-&gt;RP: isConditionalMediationAvailable()\nRP-&gt;FIDO Server: POST start Conditional UI\nFIDO Server-&gt;RP: PublicKeyCredentialRequestOptions\nUser-&gt;RP: credentials.get(PublicKeyCredentialRequestOptions + mediation: conditional)\nRP-&gt;User: show autofill selection, \\nread browser cookie and find allowed credentials \\n(does not contain username)\nUser-&gt;RP: select passkey from autofill &amp; authenticate (e.g. Face ID, Touch ID)\nRP-&gt;FIDO Server: Authenticator response\nFIDO Server-&gt;RP: Logged in\n</code></pre> </p>"},{"location":"janssen-server/fido/passwordlessLoginExperience/#implementing-a-usernameless-flow-for-a-web-app-rp","title":"Implementing a usernameless flow for a web-app (RP):","text":"<ol> <li> <p>Guideline : Use the FIDO Person authentication script as a guideline. </p> </li> <li> <p>During Registraion: At the time of Credential registration, a cookie called 'allowList' should be added. Content of the allowList is as follows, note that we are not storing usernames or email ids:  <pre><code>[{ id: ...., type: 'public-key', transports: ['usb', 'ble', 'nfc']}]\n</code></pre></p> </li> </ol> <p>Python code for the same can be noted in the Person Authentication Script - https://github.com/JanssenProject/jans/blob/main/docs/script-catalog/person_authentication/fido2-external-authenticator/Fido2ExternalAuthenticator.py</p> <ol> <li>Authentication :</li> </ol> <p>In Assertion Request, set RP id and Allow credentials fetched from the cookie <code>allowList</code> <pre><code>assertionRequest = AssertionOptions()\nassertionRequest.setRpId(domain)\nassertionRequest.setAllowCredentials(Arrays.asList(allowList))\nassertionResponse = assertionService.authenticate(assertionRequest).readEntity(java.lang.String)\n</code></pre></p> <ol> <li>In the login web page, here is an .xhtml sample <pre><code> &lt;h:inputText placeholder=\"#{msgs['login.username']}\" id=\"username\" name=\"username\" required=\"true\" value=\"#{credentials.username}\" &gt;\n    &lt;f:passThroughAttribute name=\"autocomplete\" value=\"username webauthn\"/&gt;\n &lt;/h:inputText&gt;\n</code></pre> on submit, do the following: javascript code : <pre><code>if ( window.PublicKeyCredential &amp;amp;&amp;amp; PublicKeyCredential.isConditionalMediationAvailable)\n{\n\n  // Step A: call webauthn.js's getAssertionConditional method with AssertionOptions ( rpId, allowList)\n  // Step B: create an io.jans.fido2.model.assertion.AssertionResult object using step A and call io.jans.fido2.client.AssertionService's verify() method\n             In otherwords call the FIDO server's API \"/result\" for Assertion \n}\n</code></pre></li> </ol>"},{"location":"janssen-server/fido/types-of-creds/","title":"Types of Credentials","text":"<p>Types of credentials</p> <p>Passkeys introduce a fresh identity with a new name, icon, and features, redefining authentication methods. They serve as a broad term encompassing various credential types, including:</p> <ul> <li>Discoverable Credentials</li> <li>FIDO Credentials</li> <li>WebAuthn Discoverable Credentials</li> <li>FIDO2 Credentials</li> <li>Synced Passkeys</li> <li>Device-Bound Passkeys</li> </ul> <p>WebAuthn Hints</p> <p>WebAuthn hints, defined in the server configuration, guide the authentication process by indicating the preferred type of authenticator. The three primary values are:</p> <ul> <li>Security-Key: Suggests the use of a physical security key, often employed in high-security environments.</li> <li>Client-Device: Indicates a preference for the platform authenticator integrated into the user's current device.</li> <li>Hybrid: Recommends using a general-purpose authenticator, such as a smartphone, especially when dedicated security keys are less common among users.</li> </ul>"},{"location":"janssen-server/fido/vendor-metadata/","title":"FIDO Vendor Metadata Management","text":"","tags":["administration","fido2","metadata Service","attestation"]},{"location":"janssen-server/fido/vendor-metadata/#metadata-service","title":"Metadata Service:","text":"<p>The metadata service is a centralized, trusted database of FIDO authenticators. It is used by the Relying Party to validate authenticators i.e. attest the genuine-ness of a device. If implemented in organizations like government, federal agencies, banking and healthcare organizations for example) and/or organizations handling sensitive data (media companies, R&amp;D institutions, corporations, etc), this information can help protect organizations against security vulnerabilities.</p>","tags":["administration","fido2","metadata Service","attestation"]},{"location":"janssen-server/fido/vendor-metadata/#1-local-metadata-service","title":"1. Local metadata service:","text":"<p>Janssen's FIDO server has a configuration parameter called <code>serverMetadataFolder</code> which by default points to a directory location <code>/etc/jans/conf/fido2/server_metadata</code> where the administrator can (obtain from a vendor and ) place authenticator metadata in json format.</p> <p>Example of authenticator metadata: <pre><code>{\n    \"aaguid\": \"83c44309-....-8be444b573cb\",\n    \"metadataStatement\": {\n        \"legalHeader\": \"Submission of this statement and retrieval and use of this statement indicates acceptance of the appropriate agreement located at https://fidoalliance.org/metadata/metadata-legal-terms/.\",\n        \"aaguid\": \"83c44309-....-8be444b573cb\",\n        \"description\": \"Just an example\",\n        \"authenticatorVersion\": 448962,\n        \"protocolFamily\": \"fido2\",\n        \"schema\": 3,\n        \"upv\": [\n            {\n                \"major\": 1,\n                \"minor\": 0\n            },\n            {\n                \"major\": 1,\n                \"minor\": 1\n            }\n        ],\n        \"authenticationAlgorithms\": [\n            \"ed25519_eddsa_sha512_raw\",\n            \"secp256r1_ecdsa_sha256_raw\"\n        ],\n        \"publicKeyAlgAndEncodings\": [\n            \"cose\"\n        ],\n        \"attestationTypes\": [\n            \"basic_full\"\n        ],\n        \"userVerificationDetails\": [\n            [\n                {\n                    \"userVerificationMethod\": \"passcode_external\",\n                    \"caDesc\": {\n                        \"base\": 64,\n                        \"minLength\": 4,\n                        \"maxRetries\": 8,\n                        \"blockSlowdown\": 0\n                    }\n                },\n                {\n                    \"userVerificationMethod\": \"presence_internal\"\n                }\n            ],\n            [\n                {\n                    \"userVerificationMethod\": \"passcode_external\",\n                    \"caDesc\": {\n                        \"base\": 64,\n                        \"minLength\": 4,\n                        \"maxRetries\": 8,\n                        \"blockSlowdown\": 0\n                    }\n                }\n            ],\n            [\n                {\n                    \"userVerificationMethod\": \"fingerprint_internal\",\n                    \"baDesc\": {\n                        \"selfAttestedFRR\": 0,\n                        \"selfAttestedFAR\": 0,\n                        \"maxTemplates\": 5,\n                        \"maxRetries\": 5,\n                        \"blockSlowdown\": 0\n                    }\n                },\n                {\n                    \"userVerificationMethod\": \"presence_internal\"\n                }\n            ],\n            [\n                {\n                    \"userVerificationMethod\": \"none\"\n                }\n            ],\n            [\n                {\n                    \"userVerificationMethod\": \"fingerprint_internal\",\n                    \"baDesc\": {\n                        \"selfAttestedFRR\": 0,\n                        \"selfAttestedFAR\": 0,\n                        \"maxTemplates\": 5,\n                        \"maxRetries\": 5,\n                        \"blockSlowdown\": 0\n                    }\n                }\n            ],\n            [\n                {\n                    \"userVerificationMethod\": \"presence_internal\"\n                }\n            ]\n        ],\n        \"keyProtection\": [\n            \"hardware\",\n            \"secure_element\"\n        ],\n        \"matcherProtection\": [\n            \"on_chip\"\n        ],\n        \"cryptoStrength\": 128,\n        \"attachmentHint\": [\n            \"external\",\n            \"wired\"\n        ],\n        \"tcDisplay\": [],\n        \"attestationRootCertificates\": [\n            \"MII....psmyPzK+Vsgw2jeRQ5JlKDyqE0hebfC1tvFu0CCrJFcw==\"\n        ],\n        \"icon\": \"data:image/png;base64,iVBORw0KGgoAAAA....k5+36hF7vXAAAAAElFTkSuQmCC\",\n        \"authenticatorGetInfo\": {\n            \"versions\": [\n                \"FIDO_2_0\",\n                \"FIDO_2_1_PRE\",\n                \"FIDO_2_1\"\n            ],\n            \"extensions\": [\n                \"credProtect\",\n                \"hmac-secret\",\n                \"largeBlobKey\",\n                \"credBlob\",\n                \"minPinLength\"\n            ],\n            \"aaguid\": \"83c.....73cb\",\n            \"options\": {\n                \"plat\": false,\n                \"rk\": true,\n                \"clientPin\": true,\n                \"up\": true,\n                \"uv\": false,\n                \"pinUvAuthToken\": true,\n                \"largeBlobs\": true,\n                \"ep\": false,\n                \"bioEnroll\": false,\n                \"userVerificationMgmtPreview\": false,\n                \"authnrCfg\": true,\n                \"credMgmt\": true,\n                \"credentialMgmtPreview\": true,\n                \"setMinPINLength\": true,\n                \"makeCredUvNotRqd\": false,\n                \"alwaysUv\": true\n            },\n            \"maxMsgSize\": 1200,\n            \"pinUvAuthProtocols\": [\n                2,\n                1\n            ],\n            \"maxCredentialCountInList\": 8,\n            \"maxCredentialIdLength\": 128,\n            \"transports\": [\n                \"usb\"\n            ],\n            \"algorithms\": [\n                {\n                    \"type\": \"public-key\",\n                    \"alg\": -7\n                },\n                {\n                    \"type\": \"public-key\",\n                    \"alg\": -8\n                }\n            ],\n            \"maxSerializedLargeBlobArray\": 1024,\n            \"forcePINChange\": false,\n            \"minPINLength\": 4,\n            \"firmwareVersion\": 328965,\n            \"maxCredBlobLength\": 32,\n            \"maxRPIDsForSetMinPINLength\": 1,\n            \"preferredPlatformUvAttempts\": 3,\n            \"uvModality\": 2,\n            \"remainingDiscoverableCredentials\": 25\n        }\n    },\n    \"statusReports\": [\n        {\n            \"status\": \"FIDO_CERTIFIED_L1\",\n            \"effectiveDate\": \"2021-08-06\",\n            \"url\": \"www.yubico.com\",\n            \"certificationDescriptor\": \"An example\",\n            \"certificateNumber\": \"FIDO2.....001\",\n            \"certificationPolicyVersion\": \"1.3\",\n            \"certificationRequirementsVersion\": \"1.4\"\n        },\n        {\n            \"status\": \"FIDO_CERTIFIED\",\n            \"effectiveDate\": \"2021-08-06\"\n        }\n    ],\n    \"timeOfLastStatusChange\": \"2021-08-16\"\n}\n</code></pre></p>","tags":["administration","fido2","metadata Service","attestation"]},{"location":"janssen-server/fido/vendor-metadata/#2-metadata-service-for-authenticators-approved-by-fido-alliance-mds3","title":"2. Metadata service for authenticators approved by FIDO Alliance (MDS3)","text":"<p>Metadata entries for trusted authenticators registered with FIDO Alliance can be found on - https://fidoalliance.org/certification/fido-certified-products/</p> <p></p> <p>Draw.io reference for image: <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;mxfile host=\"app.diagrams.net\" modified=\"2022-11-03T13:17:35.619Z\" agent=\"5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36 Edg/106.0.1370.52\" etag=\"MPAHjBuOoBSpVro-BGSI\" version=\"20.5.1\" type=\"google\"&gt;&lt;diagram id=\"An1oD0C01MiJfx2t8ul6\" name=\"Page-1\"&gt;7Vlbc6M2FP41nrYPyXAx2Hl07HUv052kdWe7fVRAAU0EokLEdn/9noOEsQBnva6ZnZ3ZJ3M+ISG+79yEJ/4y2/0sSZG+FzHlE8+JdxN/NfE8158F8IPIXiOzYKqBRLLY3NQCG/YfNaBj0IrFtLRuVEJwxQobjESe00hZGJFSbO3bngW3n1qQhPaATUR4H/2bxSrV6DxwWvwXypK0ebLrmJGMNDcboExJLLZHkP9u4i+lEEpfZbsl5Uhew4uetz4xetiYpLk6Z0L6cRW7f/0ZB+E2cD9U+8dy+ceNUeeV8Mq88G8kL2/Wv64eEN9Q+Uql2b/aN6SUW5ZxkoN1/yxyZVRz52Cb9ahUdHdyo+7h9cFvqMioknu4xUyY+oYx4zJzY25b/g9Yesx9aEBiNE8OS7e0wIVh5gtY8nssIUGALDhnJI/oDyUY76kiMVGk5ooomuH7wm7yGJ1WVqW2olQMMJqSAi9zoZDVbcoU3RQkQmwLkQVYqjKOLMPlE4leEimqPH6oFGc5NXhM5MsDzGIKqXNuneBcRU47x0mZvMBSaRr0VLoL+iLNg5E0mvY0+l1AGNu6bFpdvn0B3FlHgbCnwGxAgdlYCsx6CvRYpnm8wKQMVsRJWbLI5rWmlOJDnJO5hca9jH0ZjUc8BQPppMEk5USxV/uZQ+SZJzwKVsf9zqbbiORNO0mqFJWMqJl0nL7fXsf1O+soIhOqeuvUSh5e+nJxwy9NgVg6GISPF3KFEQM5L0zw6sdUKSzeC9yjt35msSBmjVshE9zdYZX1Tz0Xsl3kM3E6QnUKHLs6+d655amr/NUCbz4QeJp1fH+LvvDfSjQDN2XNDOjguF6xq+lpxhuxoGPJuSBIOPZYBWw2JBmynD+Vhb6R6wlr/TA9rycbEK5sbQhnSY6JAIiHHsO/R1kYpOyFGchYHOP0e0lhp+SpXgpFL9DJaxKD+0mwwrUqJUqjM5ilkuKFLgWHSospXXcqjPMuNL57eGHfPVxvwD1G8467/+8d8xPe0aSASqVAD2insLU5zyEujmPvOkK5ri3UoXE/Fmo2FMfeWEo1OxqvggI3cv/RDNbGP3WfEjTmanc8uNo31o4pnObeOk5obD0TD3jabqeicTzzkUoGDGGQ19gZddxAuji+RZlpzXX1+1z9+lo9gD/r1Iy7C5uAqddZqJs1Ru4CXHd0D208zfKyt33siv5091XdZN6pHe6lbtI5QfdOxmO7iTdeR7JQiuLxmon8e+9hlzS/W9L8fkkb6kxHaz3c/oeTq/UenabD+QB559vpPuzDnD/UJA4pNR9Nqf7nk6tFLLCiyAvFLUDIOsNNoxNhBD6jeRTZ7amxe+7QX9UkTViJEYzUAXOH1ZsT5fcU0el65x3PG/q4OlTiLvi2Cmb7dVuXlvY/Av/dJw==&lt;/diagram&gt;&lt;/mxfile&gt;\n</code></pre></p> <p>Janssen's FIDO2 server -</p> <ol> <li>Downloads, verifies and caches metadata BLOBs from the FIDO Metadata Service.</li> <li>Re-downloads the metadata BLOB when it expires.</li> <li>Provides trust root certificates for verifying attestation statements during credential registrations.</li> </ol>","tags":["administration","fido2","metadata Service","attestation"]},{"location":"janssen-server/fido/vendor-metadata/#3-skip-metadata-validation","title":"3. Skip metadata validation","text":"<p>Metadata validation is recommended but not mandatory as per FIDO2 specifications. In FIDO2 we can disable this validation by setting the <code>attestionMode</code> parameter (default is monitor).</p> <p>It should look something like this:</p> <pre><code>\"fido2Configuration\": {\n  ...,\n  \"attestationMode\": \"disabled\",\n  ...\n}\n</code></pre>","tags":["administration","fido2","metadata Service","attestation"]},{"location":"janssen-server/fido/vendor-metadata/#4-how-apple-does-it-differently","title":"4. How Apple does it differently","text":"<p>If you check <code>attStmt</code> and it contains <code>x5c</code>, it is a FULL attestation. FULL basically means that it is a certificate that is chained to the vendor. It's signed by a batch private key whose public key is in a batch certificate that is chained to the Apple attestation root certificate. Usually certificates have an authorityInfoAccess extension that helps locate the root, but Apple chose not to do that. Nevertheless, a quick google give us the needed root certificate https://www.apple.com/certificateauthority/Apple_WebAuthn_Root_CA.pem.</p> <p>This certificate is downloaded to the path <code>/etc/jans/conf/fido2/authenticator_cert</code>.</p> <p>You can see more details of the implementation in this link from https://medium.com/webauthnworks/webauthn-fido2-verifying-apple-anonymous-attestation-5eaff334c849.</p>","tags":["administration","fido2","metadata Service","attestation"]},{"location":"janssen-server/fido/vendor-metadata/#references","title":"References:","text":"<ol> <li>https://fidoalliance.org/announcing-the-new-streamlined-and-simplified-metadata-service-for-authenticator-vendors-and-customers/</li> </ol>","tags":["administration","fido2","metadata Service","attestation"]},{"location":"janssen-server/install/","title":"Installation Overview","text":"<p>The goal of Janssen Project is to give you a lot of deployment options. This is a challenge--the more ways to install, the more ways for things to go wrong! But to build a large community, we need to provide ways to install the software in enough different ways to make at least the bulk of the community happy.</p> <p>Currently, that means the following installation options:</p> <ol> <li>VM packages for Ubuntu, SUSE and Red Hat</li> <li>Helm deployments for Amazon, Google, Microsoft and Rancher</li> <li>Docker monolith deployment for development / testing (not production)</li> </ol>","tags":["administration","installation"]},{"location":"janssen-server/install/#minimal-configuration","title":"Minimal Configuration","text":"<p>It turns out that just installing the Janssen binary object code (i.e. the bits), is totally useless. That's because in order to do anything useful with the Janssen Project, you need a minimal amount of configuration. For example, you need to generate cryptographic key pairs, you need to generate a minimal amount of data in the database, you need to generate some web server TLS certificates.  For this reason, for most of the platforms, installation is a three step process. Step 1, install the bits. Step 2, run \"setup\" and answer some basic question (like the hostname of your IDP). Step 3, fire up a configuration tool to perform any other last mile configuration.</p>","tags":["administration","installation"]},{"location":"janssen-server/install/#databases","title":"Databases","text":"<p>The Janssen Project gives you a few options to store data: MySQL, Postgres. MySQL is recommended for production deployments while Postgres for development. You can also configure an in-memory cache server like Redis. Sometimes installation and configuration of this database is included in the setup process. Sometimes, you need to setup the database ahead of time. Please refer to the database instructions specific for your choice. And of course, you may need to refer to the database documentation itself--we don't want to duplicate any of that third party content.</p>","tags":["administration","installation"]},{"location":"janssen-server/install/#optimization","title":"Optimization","text":"<p>Remember, installation is just a starting point. To get peak performance, you may need to tweak some of the configuration dials for your system or the database. If you intend to deploy a Janssen Server in production for high concurrency, make sure you benchmark the exact flows you expect to serve in production.</p>","tags":["administration","installation"]},{"location":"janssen-server/install/#selinux-policy","title":"SELinux Policy","text":"<p>Janssen Server installs and uses the Apache web server as a <code>reverse proxy</code>. While the Janssen Server itself will bind to <code>localhost</code>, the Apache reverse proxy listens to external interfaces and forwards the request to the Janssen Server. If you have SELinux enabled VM, then the Apache web server can't forward the request to Janssen Server. Therefore setup script adds the following SELinux policy:</p> <pre><code>httpd_can_network_connect 1 -P\n</code></pre>","tags":["administration","installation"]},{"location":"janssen-server/install/install-faq/","title":"Janssen Server Installation FAQs","text":"","tags":["administration","installation","faq"]},{"location":"janssen-server/install/install-faq/#after-installation-how-do-i-verify-that-the-janssen-server-is-up-and-running","title":"After installation, how do I verify that the Janssen Server is up and running?","text":"<p>Health and status of Janssen Server and its various processes can be verified in multiple ways:</p>","tags":["administration","installation","faq"]},{"location":"janssen-server/install/install-faq/#use-the-janssen-server-health-check-endpoint","title":"Use the Janssen Server Health Check endpoint","text":"<p>Janssen Server provides a health check endpoint for Authentication module. It can be invoked from commandline using CURL as below:</p> <pre><code>curl -k https://janssen-host-name/jans-auth/sys/health-check\n</code></pre> <p>For a healthy server, this option will return output as below:</p> <pre><code>Please wait while retrieving data ...\n\n{\n\"status\": \"running\",\n\"db_status\": \"online\"\n}\n</code></pre>","tags":["administration","installation","faq"]},{"location":"janssen-server/install/install-faq/#access-well-known-endpoints","title":"Access .well-known endpoints","text":"<p>Janssen Server exposes <code>.well-known</code> endpoint for openid configuration as per the OpenIDConnect RFC. Successful response from this endpoint is also an indicator of healthy authentication module.</p> <p>From command-line interface, use CURL to access this endpoint. For example:</p> <pre><code>curl https://janssen-host-name/jans-auth/.well-known/openid-configuration\n</code></pre> <p>This should return JSON response from Janssen Server as per OpenId specification. Sample below:</p> <pre><code>{\n  \"request_parameter_supported\" : true,\n  \"pushed_authorization_request_endpoint\" : \"https://janssen-host-name/jans-auth/restv1/par\",\n  \"introspection_endpoint\" : \"https://janssen-host-name/jans-auth/restv1/introspection\",\n  \"claims_parameter_supported\" : false,\n  \"issuer\" : \"https://janssen-host-name\",\n  \"userinfo_encryption_enc_values_supported\" : [ \"RSA1_5\", \"RSA-OAEP\", \"A128KW\", \"A256KW\" ],\n  \"id_token_encryption_enc_values_supported\" : [ \"A128CBC+HS256\", \"A256CBC+HS512\", \"A128GCM\", \"A256GCM\" ],\n  \"authorization_endpoint\" : \"https://janssen-host-name/jans-auth/restv1/authorize\",\n  \"service_documentation\" : \"http://jans.org/docs\",\n  \"authorization_encryption_alg_values_supported\" : [ \"RSA1_5\", \"RSA-OAEP\", \"A128KW\", \"A256KW\" ],\n  \"claims_supported\" : [ \"street_address\", \"country\", \"zoneinfo\", \"birthdate\", \"role\", \"gender\", \"user_name\", \"formatted\", \"phone_mobile_number\", \"preferred_username\", \"inum\", \"locale\", \"updated_at\", \"post_office_box\", \"nickname\", \"preferred_language\", \"email\", \"website\", \"email_verified\", \"profile\", \"locality\", \"room_number\", \"phone_number_verified\", \"given_name\", \"middle_name\", \"picture\", \"name\", \"phone_number\", \"postal_code\", \"region\", \"family_name\", \"jansAdminUIRole\" ],\n  \"token_endpoint_auth_methods_supported\" : [ \"client_secret_basic\", \"client_secret_post\", \"client_secret_jwt\", \"private_key_jwt\", \"tls_client_auth\", \"self_signed_tls_client_auth\" ],\n  \"tls_client_certificate_bound_access_tokens\" : true,\n  \"response_modes_supported\" : [ \"FORM_POST\", \"QUERY_JWT\", \"FRAGMENT_JWT\", \"FORM_POST_JWT\", \"QUERY\", \"FRAGMENT\", \"JWT\" ],\n  \"backchannel_logout_session_supported\" : true,\n  \"token_endpoint\" : \"https://janssen-host-name/jans-auth/restv1/token\",\n  \"response_types_supported\" : [ \"id_token token\", \"id_token\", \"code\", \"code token\", \"id_token code token\", \"id_token code\", \"token\" ],\n  \"acr_mappings\" : {\"alias1\": \"acr1\"},\n  \"authorization_encryption_enc_values_supported\" : [ \"A128CBC+HS256\", \"A256CBC+HS512\", \"A128GCM\", \"A256GCM\" ],\n  \"backchannel_token_delivery_modes_supported\" : [ \"poll\", \"ping\", \"push\" ],\n  \"dpop_signing_alg_values_supported\" : [ \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"request_uri_parameter_supported\" : true,\n  \"backchannel_user_code_parameter_supported\" : false,\n  \"grant_types_supported\" : [ \"RESOURCE_OWNER_PASSWORD_CREDENTIALS\", \"CLIENT_CREDENTIALS\", \"OXAUTH_UMA_TICKET\", \"AUTHORIZATION_CODE\", \"DEVICE_CODE\", \"REFRESH_TOKEN\", \"IMPLICIT\" ],\n  \"ui_locales_supported\" : [ \"en\", \"bg\", \"de\", \"es\", \"fr\", \"it\", \"ru\", \"tr\" ],\n  \"userinfo_endpoint\" : \"https://janssen-host-name/jans-auth/restv1/userinfo\",\n  \"op_tos_uri\" : \"http://www.jans.io/doku.php?id=jans:tos\",\n  \"require_request_uri_registration\" : false,\n  \"id_token_encryption_alg_values_supported\" : [ \"RSA1_5\", \"RSA-OAEP\", \"A128KW\", \"A256KW\" ],\n  \"frontchannel_logout_session_supported\" : true,\n  \"authorization_signing_alg_values_supported\" : [ \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"claims_locales_supported\" : [ \"en\" ],\n  \"clientinfo_endpoint\" : \"https://janssen-host-name/jans-auth/restv1/clientinfo\",\n  \"request_object_signing_alg_values_supported\" : [ \"none\", \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"ES256\", \"ES384\", \"ES512\", \"ES512\", \"PS256\", \"PS384\", \"PS512\" ],\n  \"request_object_encryption_alg_values_supported\" : [ \"RSA1_5\", \"RSA-OAEP\", \"A128KW\", \"A256KW\" ],\n  \"global_token_revocation_endpoint\" : \"https://janssen-host-name/jans-auth/restv1/global-token-revocation\",\n  \"check_session_iframe\" : \"https://janssen-host-name/jans-auth/opiframe.htm\",\n  \"scopes_supported\" : [ \"https://jans.io/scim/all-resources.search\", \"address\", \"user_name\", \"clientinfo\", \"openid\", \"https://jans.io/scim/fido2.write\", \"profile\", \"uma_protection\", \"permission\", \"https://jans.io/scim/fido.read\", \"https://jans.io/scim/users.write\", \"https://jans.io/scim/groups.read\", \"revoke_session\", \"global_token_revocation\", \"https://jans.io/scim/fido.write\", \"https://jans.io/scim/bulk\", \"https://jans.io/scim/users.read\", \"phone\", \"mobile_phone\", \"offline_access\", \"https://jans.io/scim/groups.write\", \"email\", \"https://jans.io/scim/fido2.read\", \"jans_client_api\" ],\n  \"backchannel_logout_supported\" : true,\n  \"acr_values_supported\" : [ \"simple_password_auth\" ],\n  \"request_object_encryption_enc_values_supported\" : [ \"A128CBC+HS256\", \"A256CBC+HS512\", \"A128GCM\", \"A256GCM\" ],\n  ...\n  ...\n</code></pre>","tags":["administration","installation","faq"]},{"location":"janssen-server/install/install-faq/#check-os-services","title":"Check OS Services","text":"<p>Check the OS platform Janssen Services and their status</p>","tags":["administration","installation","faq"]},{"location":"janssen-server/install/install-faq/#check-logs","title":"Check Logs","text":"<p>Check logs for errors</p>","tags":["administration","installation","faq"]},{"location":"janssen-server/install/install-faq/#how-can-i-see-status-of-janssen-os-platform-services","title":"How can I see status of Janssen OS platform services?","text":"","tags":["administration","installation","faq"]},{"location":"janssen-server/install/install-faq/#ubuntu","title":"Ubuntu","text":"<pre><code>systemctl list-units --all \"jans*\"\n</code></pre> <p>Command above should list services along with its current status.</p> <pre><code>UNIT                    LOAD   ACTIVE SUB     DESCRIPTION               \njans-auth.service       loaded active running Janssen OAauth service    \njans-config-api.service loaded active running Janssen Config API service\njans-fido2.service      loaded active running Janssen Fido2 Service     \njans-scim.service       loaded active running Janssen Scim service      \n\nLOAD   = Reflects whether the unit definition was properly loaded.\nACTIVE = The high-level unit activation state, i.e. generalization of SUB.\nSUB    = The low-level unit activation state, values depend on unit type.\n\n5 loaded units listed.\n</code></pre> <p>Note</p> <p>Some process listed above may not be available in every installation based on options selected during installation.</p>","tags":["administration","installation","faq"]},{"location":"janssen-server/install/install-faq/#where-can-i-find-janssen-server-logs","title":"Where can I find Janssen Server logs?","text":"<p>During installation, Janssen Server produces setup logs under following location:</p> <pre><code>/opt/jans/jans-setup/logs/\n</code></pre> <p>Individual modules of the Janssen Server will continue to write their operational logs under respective directory at path below:</p> <pre><code>/opt/jans/jetty/&lt;module-name&gt;/logs/\n</code></pre>","tags":["administration","installation","faq"]},{"location":"janssen-server/install/install-faq/#how-do-i-check-the-version-of-janssen-server","title":"How do I check the version of Janssen server?","text":"<pre><code>/opt/jans/bin/show_version.py\n</code></pre> <p>Alternatively, TUI can be used to get this information:</p> <ol> <li>Open TUI</li> <li>Navigate to <code>Jans TUI</code> menu item on top menu bar</li> <li>Navigate to <code>Application Versions</code></li> <li>Hit <code>enter</code></li> </ol> <p>This will show version of each Janssen Server modules:</p> <p></p>","tags":["administration","installation","faq"]},{"location":"janssen-server/install/install-faq/#after-installation-whats-next","title":"After installation, what's next?","text":"<p>After successful installation of the Janssen Server, start configuring Janssen Server to fulfil your organizational requirements and authentication flows you intend to implement. Use the Text-based UI or command-line interface to configure the Janssen Server.</p>","tags":["administration","installation","faq"]},{"location":"janssen-server/install/install-faq/#does-the-janssen-server-uninstall-process-remove-the-data-store-as-well","title":"Does the Janssen Server uninstall process remove the data store as well?","text":"<p>No. For all persistence options, the Janssen server uninstall steps (this for instance) will only remove the Janssen Server software and it'll keep the data store untouched. Removing the data store is at the discretion of the administrator and it is a manual step. If not removed before attempting a reinstall of the Janssen Server, the installer would fail due to the existence of the previous data store.</p>","tags":["administration","installation","faq"]},{"location":"janssen-server/install/setup/","title":"Janssen Setup Script","text":"","tags":["administration","installation","setup"]},{"location":"janssen-server/install/setup/#running-setup","title":"Running Setup","text":"<p>After installation, executing <code>setup.py</code> will launch the SETUP Command Line by default.</p> <p>To run the script, run the following command:</p> <pre><code>python3 /opt/jans/jans-setup/setup.py\n</code></pre> <p>A warning will pop up if the free disk space is less than the recommended 40 GB. The installer will check that all dependant packages are installed or not, and if missing it will ask to install. When prompted Y/y at the command prompt will install all required packages.</p> <ol> <li> <p>The installer will detect which operating system, init type, and Apache version are currently on the server.</p> </li> <li> <p>The setup script will bring up a prompt to provide information for certificates as well as the IP Address and the hostname for the Janssen Authorization Server. Hit Enter to accept the default values.</p> </li> </ol> <pre><code>Enter IP Address:\nEnter hostname:\nEnter your city or locality:\nEnter your state or province two letter code:\nEnter two letter Country Code\nEnter Organization name:\nEnter email address for support at your organization:\nEnter maximum RAM for applications in MB:\nEnter Password for Admin User:\n</code></pre> <ol> <li> <p>Next, pick a persistence mechanism. Choose from MySQL, PGSql that can be installed locally or remotely.</p> </li> <li> <p>Next, pick which services should be installed for this deployment:</p> </li> </ol> <p><code>bash Install Jans Config API? [Yes] : Install Scim Server? [Yes] : Install Fido2 Server? [Yes] : Install Gluu Casa? [No] :</code></p> <ol> <li>Finally, review the summary screen that gives an overview of the selections made during the setup process.</li> </ol> <p>Note! After setup completed, you will be prompted to remove setup files (directories <code>/opt/dist</code> and <code>/opt/jans/jans-setup</code>). If you are not going to do any post-setup operations, type yes to remove setup files. If you don't respond in 10 seconds, setup files will be preserved.</p>","tags":["administration","installation","setup"]},{"location":"janssen-server/install/setup/#avoiding-common-issues","title":"Avoiding common issues","text":"<p>Avoid setup issues by acknowledging the following:</p> <ul> <li> <p>IP Address: Do not use localhost for either the IP address or hostname.</p> </li> <li> <p>Hostname:</p> </li> <li> <p>Make sure to choose the hostname carefully. Changing the hostname after installation is not a simple task.</p> </li> <li> <p>Use a real hostname--this can always be managed via host file entries if adding a DNS entry is too much work for testing.</p> </li> <li> <p>For clustered deployments, use the hostname of the cluster that will be used by applications connecting to Janssen Authorization Server.</p> </li> </ul> <p>Warning</p> <p>Use a FQDN (fully qualified domain name) as hostname and refrain from using 127.0.0.1 as IP address or usage of private IP is not supported and not recommended.</p>","tags":["administration","installation","setup"]},{"location":"janssen-server/install/setup/#script-command-line-options","title":"Script Command Line Options","text":"<p>To check usage of this script run help command <pre><code>python3 /opt/jans/jans-setup/setup.py --help\n</code></pre></p> <pre><code>usage: jans_setup.py [-h] [--version] [-c] [-d D] [-f F] [-n] [-N] [-u] [-csx] [-encode-salt ENCODE_SALT]\n                     [-remote-rdbm {mysql,pgsql} | -local-rdbm {mysql,pgsql}] [-ip-address IP_ADDRESS]\n                     [-host-name HOST_NAME] [-org-name ORG_NAME] [-email EMAIL] [-city CITY] [-state STATE]\n                     [-country COUNTRY] [-rdbm-user RDBM_USER] [-rdbm-password RDBM_PASSWORD] [-rdbm-port RDBM_PORT]\n                     [-rdbm-db RDBM_DB] [-rdbm-host RDBM_HOST] [-rdbm-schema RDBM_SCHEMA] [-remote-rdbm-ssl-cert-fn REMOTE_RDBM_SSL_CERT_FN] \n                     [--reset-rdbm-db] [--shell] [--dump-config-on-error] [--no-progress] [-admin-password ADMIN_PASSWORD] [-jans-max-mem JANS_MAX_MEM]\n                     [-properties-password PROPERTIES_PASSWORD] [-approved-issuer APPROVED_ISSUER] [--force-download]\n                     [--download-exit] [-jans-app-version JANS_APP_VERSION] [-jans-build JANS_BUILD]\n                     [-setup-branch SETUP_BRANCH] [--disable-config-api-security] [--cli-test-client]\n                     [--import-ldif IMPORT_LDIF] [-enable-script ENABLE_SCRIPT] [-disable-script DISABLE_SCRIPT]\n                     [-java-version {11,17}] [-w] [-t] [-x] [--allow-pre-released-features] [--no-data]\n                     [--no-jsauth] [--no-config-api] [--no-scim] [--no-fido2] [--install-link]\n                     [--with-casa] [--install-jans-saml] [--install-jans-lock]\n                     [--install-opa] [--load-config-api-test] [-config-patch-creds CONFIG_PATCH_CREDS]\n                     [-test-client-id TEST_CLIENT_ID] [-test-client-pw TEST_CLIENT_PW]\n                     [-test-client-redirect-uri TEST_CLIENT_REDIRECT_URI] [--test-client-trusted]\n</code></pre> <p>Use this script to configure your Jans Server and to add initial data. If setup.properties is found in this folder, these properties will automatically be used instead of the interactive setup.</p> <p>Below are the optional arguments:</p> Argument Description -h, --help show this help message and exit --version show program's version number and exit -c Use command line instead of TUI -d D Installation directory -f F Specify setup.properties file -n No interactive prompt before install starts. Run with -f -N, --no-httpd No apache httpd server -u Update hosts file with IP address / hostname -csx Collect setup properties, save and exit -remote-rdbm Enables using remote RDBM server -local-rdbm Enables installing/configuring local RDBM server -ip-address IP_ADDRESS Used primarily by Apache httpd for the Listen directive -host-name HOST_NAME Internet-facing FQDN that is used to generate certificates and metadata. -org-name ORG_NAME Organization name field used for generating X.509 certificates -email EMAIL Email address for support at your organization used for generating X.509 certificates -city CITY City field used for generating X.509 certificates -state STATE State field used for generating X.509 certificates -country COUNTRY Two letters country code used for generating X.509 certificates -rdbm-user RDBM_USER RDBM username -rdbm-password RDBM_PASSWORD RDBM password -rdbm-port RDBM_PORT RDBM port -rdbm-db RDBM_DB RDBM database -rdbm-host RDBM_HOST RDBM host -rdbm-schema Jans Database Schema -remote-rdbm-ssl-cert-fn REMOTE_RDBM_SSL_CERT_FN To use SSL connection for remote RDBM server, set path of SSL root certificate file of remote RDBM server --reset-rdbm-db Deletes all tables on target database. Warning! You will lose all data on target database. --shell Drop into interactive shell before starting installation --dump-config-on-error Dump configuration on error --no-progress Use simple progress -admin-password ADMIN_PASSWORD Used as the Administrator password -jans-max-mem JANS_MAX_MEM Total memory (in KB) to be used by Jannsen Server -properties-password PROPERTIES_PASSWORD Encoded setup.properties file password -approved-issuer APPROVED_ISSUER Api Approved Issuer --force-download Force downloading files --download-exit Download files and exits -jans-app-version JANS_APP_VERSION Version for Jannsen applications -jans-build JANS_BUILD Build version for Janssen applications -setup-branch SETUP_BRANCH Jannsen setup github branch --disable-config-api-security Turn off oauth2 security validation for jans-config-api --cli-test-client Use config api test client for CLI --import-ldif IMPORT_LDIF Render ldif templates from directory and import them in Database -enable-script ENABLE_SCRIPT inum of script to enable -disable-script DISABLE_SCRIPT inum of script to disable -disable-selinux Disable SELinux -w Get the development head war files -t Load test data -x Load test data and exit --allow-pre-released-features Enable options to install experimental features, not yet officially supported --no-data Do not import any data to database backend, used for clustering --no-jsauth Do not install OAuth2 Authorization Server --no-config-api Do not install Jans Auth Config Api --no-scim Do not install Scim Server --no-fido2 Do not install Fido2 Server --with-casa Install Gluu/Flex Casa Server --load-config-api-test Load Config Api Test Data --install-link Install Link Server -config-patch-creds CONFIG_PATCH_CREDS password:username for downloading auto test ciba password -test-client-id TEST_CLIENT_ID ID of test client which has all available scopes. Must be in UUID format. -test-client-pw TEST_CLIENT_PW Secret for test client -test-client-redirect-uri TEST_CLIENT_REDIRECT_URI Redirect URI for test client --test-client-trusted Make test client trusted","tags":["administration","installation","setup"]},{"location":"janssen-server/install/docker-install/compose/","title":"Docker compose","text":"<p>Warning This image is for testing and development purposes only. Use Janssen helm charts for production setups.</p> <p>Docker monolith image packaging for Janssen. This image packs janssen services including the auth-server, config-api, fido2, and scim.</p>","tags":["administration","installation","quick-start","docker compose","docker image"]},{"location":"janssen-server/install/docker-install/compose/#pre-requisites","title":"Pre-requisites","text":"<ul> <li>Docker</li> <li>Docker compose</li> </ul>","tags":["administration","installation","quick-start","docker compose","docker image"]},{"location":"janssen-server/install/docker-install/compose/#environment-variables","title":"Environment Variables","text":"<p>Installation depends on the set of environment variables shown below. These environment variables can be set to customize installation as per the need. If not set, the installer uses default values.</p> ENV Description Default <code>CN_HOSTNAME</code> Hostname to install janssen with. <code>demoexample.jans.io</code> <code>CN_ADMIN_PASS</code> Password of the admin user. <code>1t5Fin3#security</code> <code>CN_ORG_NAME</code> Organization name. Used for ssl cert generation. <code>Janssen</code> <code>CN_EMAIL</code> Email. Used for ssl cert generation. <code>support@jans.io</code> <code>CN_CITY</code> City. Used for ssl cert generation. <code>Austin</code> <code>CN_STATE</code> State. Used for ssl cert generation <code>TX</code> <code>CN_COUNTRY</code> Country. Used for ssl cert generation. <code>US</code> <code>CN_INSTALL_MYSQL</code> Install jans with mysql as the backend <code>false</code> <code>CN_INSTALL_PGSQL</code> Install jans with Postgres as the backend <code>false</code> <code>CN_INSTALL_CONFIG_API</code> Installs the Config API service. <code>true</code> <code>CN_INSTALL_SCIM</code> Installs the SCIM  API service. <code>true</code> <code>CN_INSTALL_FIDO2</code> Installs the FIDO2 API service. <code>true</code> <code>RDBMS_DATABASE</code> RDBMS jans database for MySQL or Postgres. <code>jans</code> <code>RDBMS_USER</code> RDBMS database user for MySQL or Postgres. <code>jans</code> <code>RDBMS_PASSWORD</code> RDBMS database user password for MySQL or Postgres. <code>1t5Fin3#security</code> <code>RDBMS_HOST</code> RDBMS host for MySQL or Postgres. <code>mysql</code> which is the docker compose service name <code>TEST_CLIENT_ID</code> ID of test client in UUID which has all available scopes to access any jans API <code>9876baac-de39-4c23-8a78-674b59df8c09</code> <code>TEST_CLIENT_SECRET</code> Secret for test client <code>1t5Fin3#security</code> <code>TEST_CLIENT_TRUSTED</code> Trust test client <code>true</code> <code>TEST_CLIENT_REDIRECT_URI</code> Not Implemented yet Redirect URI for test client. Multiple uri's with comma may be provided, if not provided redirect uris will be same as the config-api-client ``","tags":["administration","installation","quick-start","docker compose","docker image"]},{"location":"janssen-server/install/docker-install/compose/#how-to-run","title":"How to run","text":"<p>Download the compose file of your chosen persistence from mysql or postgres.</p> MySQLPostgreSQL <pre><code>wget https://raw.githubusercontent.com/JanssenProject/jans/main/docker-jans-monolith/jans-mysql-compose.yml \n</code></pre> <pre><code>wget https://raw.githubusercontent.com/JanssenProject/jans/main/docker-jans-monolith/jans-postgres-compose.yml \n</code></pre> <p>Download the script files</p> <pre><code>wget https://raw.githubusercontent.com/JanssenProject/jans/main/docker-jans-monolith/up.sh /\nwget https://raw.githubusercontent.com/JanssenProject/jans/main/docker-jans-monolith/down.sh /\nwget https://raw.githubusercontent.com/JanssenProject/jans/main/docker-jans-monolith/clean.sh\n</code></pre> <p>Give execute permission to the scripts</p> <pre><code>    chmod u+x up.sh down.sh clean.sh\n</code></pre>","tags":["administration","installation","quick-start","docker compose","docker image"]},{"location":"janssen-server/install/docker-install/compose/#create-and-start-containers","title":"Create and Start Containers","text":"<p><code>up.sh</code> script invokes the appropriate compose file based on parameter passed. You can pass <code>mysql</code> or <code>postgres</code> as an argument to the script. If you don't pass any, it will default to mysql.</p> <p>It creates two containers, a janssen monolith container and a container for persistence.</p> <p>Troubleshooting</p> <p>Sometimes the command below runs into an error regarding TLS handshake timeout while trying to connect to docker registry. Try restarting docker services. Root-cause of this error is not known.</p> <pre><code>service docker restart\n</code></pre> MySQLPostgreSQL <pre><code>./up.sh mysql \n</code></pre> <pre><code>./up.sh postgres\n</code></pre> <p>To view the containers running</p> MySQLPostgreSQL <pre><code>docker compose -f jans-mysql-compose.yml ps\n</code></pre> <pre><code>docker compose -f jans-postgres-compose.yml ps\n</code></pre> <p>To stop the containers.</p> <pre><code>./down.sh #You can pass mysql|postgres as an argument to the script. If you don't pass any, it will default to mysql.\n</code></pre>","tags":["administration","installation","quick-start","docker compose","docker image"]},{"location":"janssen-server/install/docker-install/compose/#configure-janssen-server","title":"Configure Janssen Server","text":"<ul> <li> <p>Access the Docker container shell using:</p> MySQLPostgreSQL <pre><code>docker compose -f jans-mysql-compose.yml exec jans /bin/bash \n</code></pre> <pre><code>docker compose -f jans-postgres-compose.yml exec jans /bin/bash\n</code></pre> </li> <li> <p>You can grab <code>client_id</code> and <code>client_pw</code>(secret) pairs and other values from <code>setup.properties</code> or <code>/opt/jans/jans-setup/setup.properties.last</code></p> </li> <li> <p>Use the CLI tools located under <code>/opt/jans/jans-cli/</code> to configure Janssen as needed. For example you can run the TUI:</p> <pre><code>python3 /opt/jans/jans-cli/config-cli-tui.py\n</code></pre> </li> </ul>","tags":["administration","installation","quick-start","docker compose","docker image"]},{"location":"janssen-server/install/docker-install/compose/#access-endpoints-externally","title":"Access endpoints externally","text":"<p>Add to your <code>/etc/hosts</code> file the ip domain record which should be the ip of the instance docker is installed at and the domain used in the env above <code>CN_HOSTNAME</code>.</p> <pre><code># For-example\n172.22.0.3      demoexample.jans.io\n</code></pre> <p>After adding the record you can hit endpoints such as https://demoexample.jans.io/.well-known/openid-configuration</p>","tags":["administration","installation","quick-start","docker compose","docker image"]},{"location":"janssen-server/install/docker-install/compose/#clean-up","title":"Clean up","text":"<p>Remove setup and volumes</p> <pre><code>./clean.sh #You can pass mysql|postgres as an argument to the script. If you don't pass any, it will default to mysql.\n</code></pre>","tags":["administration","installation","quick-start","docker compose","docker image"]},{"location":"janssen-server/install/docker-install/quick-start/","title":"Docker Deployments Quick Start","text":"<p>Warning</p> <p>This image is for testing and development purposes only. Use Janssen helm charts for production setups.</p> <p>The quickest way to get a Janssen Server up and running is to install a Docker container-based fully featured Janssen Server.</p>","tags":["administration","installation","quick-start","docker"]},{"location":"janssen-server/install/docker-install/quick-start/#system-requirements","title":"System Requirements","text":"<p>System should meet minimum VM system requirements</p>","tags":["administration","installation","quick-start","docker"]},{"location":"janssen-server/install/docker-install/quick-start/#install","title":"Install","text":"<p>Installation depends on a set of environment variables. These environment variables can be set to customize installation as per the need. If not set, the installer uses default values.</p> <p>Run this command to start the installation:</p> MySQLPostgreSQL <pre><code>wget https://raw.githubusercontent.com/JanssenProject/jans/nightly/automation/startjanssenmonolithdemo.sh &amp;&amp; chmod u+x startjanssenmonolithdemo.sh &amp;&amp; sudo bash startjanssenmonolithdemo.sh demoexample.jans.io MYSQL \"\" main\n</code></pre> <pre><code>wget https://raw.githubusercontent.com/JanssenProject/jans/nightly/automation/startjanssenmonolithdemo.sh &amp;&amp; chmod u+x startjanssenmonolithdemo.sh &amp;&amp; sudo bash startjanssenmonolithdemo.sh demoexample.jans.io PGSQL \"\" main\n</code></pre> <p>Console messages like below confirms the successful installation:</p> <pre><code>[+] Running 3/3\n \u283f Network docker-jans-monolith_cloud_bridge  Created                      0.0s\n \u283f Container docker-jans-monolith-mysql-1     Started                      0.6s\n \u283f Container docker-jans-monolith-jans-1      Started                      0.9s\n\nWaiting for the Janssen server to come up. Depending on the resources it may take 3-5 mins for the services to be up.\nTesting openid-configuration endpoint.. \n</code></pre> <p>As can be seen, the install script also accesses the well-known endpoints to verify that Janssen Server is responsive.</p>","tags":["administration","installation","quick-start","docker"]},{"location":"janssen-server/install/docker-install/quick-start/#verify-installation-by-accessing-standard-endpoints","title":"Verify Installation By Accessing Standard Endpoints","text":"<p>To access Janssen Server standard endpoints from outside of the Docker container, systems <code>/etc/hosts</code> file needs to be updated. Open the file and add the IP domain record which should be the IP of the instance docker is installed. And the domain used in the env above <code>CN_HOSTNAME</code>.</p> <pre><code># For-example\n172.22.0.3      demoexample.jans.io\n</code></pre> <p>After adding the record, hit the standard endpoints such as</p> <pre><code>https://demoexample.jans.io/.well-known/openid-configuration\n</code></pre>","tags":["administration","installation","quick-start","docker"]},{"location":"janssen-server/install/docker-install/quick-start/#configure-janssen-server","title":"Configure Janssen Server","text":"<ol> <li> <p>Access the Docker container shell using:</p> <pre><code>docker exec -ti docker-jans-monolith-jans-1 bash\n</code></pre> </li> <li> <p>Grab a pair of client_id and client_pw(secret) from <code>setup.properties</code> or <code>/opt/jans/jans-setup/setup.properties.last</code></p> </li> <li> <p>Use the CLI tools located under <code>/opt/jans/jans-cli/</code> to configure Janssen Server as needed. For example you can run the TUI:     <pre><code>jans tui\n</code></pre></p> </li> </ol>","tags":["administration","installation","quick-start","docker"]},{"location":"janssen-server/install/docker-install/quick-start/#uninstall-remove-the-janssen-server","title":"Uninstall / Remove the Janssen Server","text":"<p>This docker based installation uses <code>docker compose</code> under the hood to create containers. Hence uninstalling Janssen server involves invoking <code>docker compose</code> with appropriate yml file. Run command below to stop and remove containers.</p> MySQLPostgreSQL <pre><code>docker compose -f /tmp/jans/docker-jans-monolith/jans-mysql-compose.yml down &amp;&amp; rm -rf /tmp/jans\n</code></pre> <pre><code>docker compose -f /tmp/jans/docker-jans-monolith/jans-postgres-compose.yml down &amp;&amp; rm -rf /tmp/jans\n</code></pre> <p>Console messages like below confirms the successful removal:</p> <pre><code>[+] Running 3/3\n \u283f Container docker-jans-monolith-jans-1      Removed                   10.5s\n \u283f Container docker-jans-monolith-mysql-1     Removed                    0.9s\n \u283f Network docker-jans-monolith_cloud_bridge  Removed                    0.1s\n</code></pre>","tags":["administration","installation","quick-start","docker"]},{"location":"janssen-server/install/helm-install/","title":"Helm Deployments","text":"<p>Deploy Janssen on Kubernetes using Helm charts. This guide walks you through the installation process step by step.</p>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/#installation-flow","title":"Installation Flow","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  1. Choose Your Platform                                        \u2502\n\u2502     \u2514\u2500&gt; Set up your Kubernetes cluster                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  2. Configure Ingress                                           \u2502\n\u2502     \u2514\u2500&gt; Gateway API (recommended) or Nginx Ingress              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  3. Set Up Database                                             \u2502\n\u2502     \u2514\u2500&gt; PostgreSQL (recommended) or MySQL                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  4. Install Janssen                                             \u2502\n\u2502     \u2514\u2500&gt; Run helm install with your override.yaml                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  5. Post-Installation                                           \u2502\n\u2502     \u2514\u2500&gt; Verify and configure using TUI                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/#step-1-choose-your-platform","title":"Step 1: Choose Your Platform","text":"<p>Select your Kubernetes platform to get started:</p> Platform Guide Amazon EKS Amazon EKS Setup Google GKE Google GKE Setup Microsoft AKS Microsoft AKS Setup Local (Minikube/MicroK8s) Local Setup Rancher Marketplace Rancher Setup (includes all steps)","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/#step-2-configure-ingress","title":"Step 2: Configure Ingress","text":"<p>After your cluster is ready, configure how traffic reaches Janssen:</p> <p>Ingress Setup Guide - Gateway API or Nginx Ingress</p>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/#step-3-set-up-database","title":"Step 3: Set Up Database","text":"<p>Configure persistence storage:</p> <p>Database Setup Guide - PostgreSQL or MySQL</p>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/#step-4-install-janssen","title":"Step 4: Install Janssen","text":"<p>Deploy the Helm chart:</p> <p>Install Janssen Guide</p>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/#step-5-post-installation","title":"Step 5: Post-Installation","text":"<p>Verify and configure your deployment:</p> <p>Post-Installation Guide</p>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/#system-requirements","title":"System Requirements","text":"<p>The resources may be set minimally to the below:</p> <ul> <li>8-12 GB RAM based on the services deployed</li> <li>8-10 CPU cores based on the services deployed</li> <li>50GB hard-disk</li> </ul> <p>Use the listing below for a detailed estimation of minimum required resources. The table contains the default resources recommendation per service. Depending on the use of each service the resources need may be increased or decreased.</p> Service CPU Unit RAM Disk Space Processor Type Required Auth server 2.5 2.5GB N/A 64 Bit Yes config - job 0.3 0.3GB N/A 64 Bit Yes on fresh installs persistence - job 0.3 0.3GB N/A 64 Bit Yes on fresh installs auth-key-rotation 0.3 0.3GB N/A 64 Bit No [Strongly recommended] cleanup - job 0.3 0.3GB N/A 64 Bit No [Strongly recommended] fido2 0.5 0.5GB N/A 64 Bit No scim 1 1GB N/A 64 Bit No nginx 1 1GB N/A 64 Bit No config-api 1 1GB N/A 64 Bit No casa 0.5 0.5GB N/A 64 Bit No link 0.5 1GB N/A 64 Bit No saml 0.5 1GB N/A 64 Bit No kc-scheduler - job 0.3 0.3GB N/A 64 Bit No <p>Releases of images are in style 0.0.0-nightly or x.y-z-1</p>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/#helm-chart-reference","title":"Helm Chart Reference","text":"<p>For all configuration options, see the Helm Chart Reference.</p>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/#looking-for-older-charts","title":"Looking for Older Charts?","text":"<p>We maintain the last 5 versions. For older charts, build from the repository:</p> <pre><code>git clone --filter blob:none --no-checkout https://github.com/JanssenProject/jans.git /tmp/jans \\\n    &amp;&amp; cd /tmp/jans \\\n    &amp;&amp; git sparse-checkout init --cone \\\n    &amp;&amp; git checkout v1.0.0 \\\n    &amp;&amp; git sparse-checkout add charts/janssen \\\n    &amp;&amp; cd charts/janssen \\\n    &amp;&amp; helm dependency update \\\n    &amp;&amp; helm package .\n</code></pre>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/database-setup/","title":"Database Setup","text":"<p>Janssen requires a database for persistence storage. Choose between PostgreSQL (recommended) or MySQL.</p>","tags":["administration","installation","helm","database","postgresql","mysql"]},{"location":"janssen-server/install/helm-install/database-setup/#production-recommendations","title":"Production Recommendations","text":"<p>For production environments, use a managed database service:</p> Cloud Provider PostgreSQL Service MySQL Service AWS Amazon RDS for PostgreSQL Amazon RDS for MySQL Google Cloud Cloud SQL for PostgreSQL Cloud SQL for MySQL Azure Azure Database for PostgreSQL Azure Database for MySQL","tags":["administration","installation","helm","database","postgresql","mysql"]},{"location":"janssen-server/install/helm-install/database-setup/#option-1-postgresql-recommended","title":"Option 1: PostgreSQL (Recommended)","text":"","tags":["administration","installation","helm","database","postgresql","mysql"]},{"location":"janssen-server/install/helm-install/database-setup/#testingdevelopment-setup","title":"Testing/Development Setup","text":"<p>Deploy PostgreSQL on your cluster for testing:</p> <pre><code>wget https://raw.githubusercontent.com/JanssenProject/jans/0.0.0-nightly/automation/pgsql.yaml\nkubectl apply -f pgsql.yaml\n</code></pre>","tags":["administration","installation","helm","database","postgresql","mysql"]},{"location":"janssen-server/install/helm-install/database-setup/#postgresql-configuration","title":"PostgreSQL Configuration","text":"<p>Add this to your <code>override.yaml</code>:</p> <pre><code>config:\n  configmap:\n    cnSqlDbName: jans\n    cnSqlDbPort: 5432\n    cnSqlDbDialect: pgsql\n    cnSqlDbHost: postgresql.jans.svc\n    cnSqlDbUser: postgres\n    cnSqlDbTimezone: UTC\n    cnSqldbUserPassword: Test1234#  # Change for production!\n</code></pre>","tags":["administration","installation","helm","database","postgresql","mysql"]},{"location":"janssen-server/install/helm-install/database-setup/#option-2-mysql","title":"Option 2: MySQL","text":"","tags":["administration","installation","helm","database","postgresql","mysql"]},{"location":"janssen-server/install/helm-install/database-setup/#testingdevelopment-setup_1","title":"Testing/Development Setup","text":"<p>Deploy MySQL on your cluster for testing:</p> <pre><code>wget https://raw.githubusercontent.com/JanssenProject/jans/0.0.0-nightly/automation/mysql.yaml\nkubectl apply -f mysql.yaml\n</code></pre>","tags":["administration","installation","helm","database","postgresql","mysql"]},{"location":"janssen-server/install/helm-install/database-setup/#mysql-configuration","title":"MySQL Configuration","text":"<p>Add this to your <code>override.yaml</code>:</p> <pre><code>config:\n  configmap:\n    cnSqlDbName: jans\n    cnSqlDbPort: 3306\n    cnSqlDbDialect: mysql\n    cnSqlDbHost: mysql.jans.svc\n    cnSqlDbUser: root\n    cnSqlDbTimezone: UTC\n    cnSqldbUserPassword: Test1234#  # Change for production!\n</code></pre>","tags":["administration","installation","helm","database","postgresql","mysql"]},{"location":"janssen-server/install/helm-install/database-setup/#connecting-to-managed-databases","title":"Connecting to Managed Databases","text":"<p>When using a managed database service, update these values:</p> <ul> <li><code>cnSqlDbHost</code>: Your database endpoint/hostname</li> <li><code>cnSqlDbUser</code>: Your database username</li> <li><code>cnSqldbUserPassword</code>: Your database password</li> <li><code>cnSqlDbName</code>: Your database name (create beforehand)</li> </ul> <p>Security</p> <p>Never use default passwords in production. Store credentials securely using Kubernetes Secrets.</p>","tags":["administration","installation","helm","database","postgresql","mysql"]},{"location":"janssen-server/install/helm-install/database-setup/#next-steps","title":"Next Steps","text":"<p>Proceed to Install Janssen to deploy the Helm chart.</p>","tags":["administration","installation","helm","database","postgresql","mysql"]},{"location":"janssen-server/install/helm-install/ingress-setup/","title":"Ingress &amp; Traffic Management","text":"<p>This guide covers configuring ingress for your Janssen deployment. Choose between the modern Gateway API (recommended) or the legacy Kubernetes Ingress.</p>","tags":["administration","installation","helm","ingress","gateway-api"]},{"location":"janssen-server/install/helm-install/ingress-setup/#option-1-gateway-api-recommended","title":"Option 1: Gateway API (Recommended)","text":"<p>The Kubernetes Gateway API provides a more expressive and extensible way to manage traffic.</p>","tags":["administration","installation","helm","ingress","gateway-api"]},{"location":"janssen-server/install/helm-install/ingress-setup/#install-gateway-api-crds","title":"Install Gateway API CRDs","text":"<p>If your cluster does not have the Gateway API Custom Resource Definitions:</p> <pre><code>kubectl apply --server-side -f https://github.com/kubernetes-sigs/gateway-api/releases/download/v1.4.1/standard-install.yaml\n</code></pre>","tags":["administration","installation","helm","ingress","gateway-api"]},{"location":"janssen-server/install/helm-install/ingress-setup/#install-a-gateway-controller","title":"Install a Gateway Controller","text":"<p>You must have a conformant Gateway Controller installed.</p> <p>Example using Nginx Gateway Fabric:</p> <pre><code>helm install ngf oci://ghcr.io/nginx/charts/nginx-gateway-fabric --create-namespace -n nginx-gateway\n</code></pre>","tags":["administration","installation","helm","ingress","gateway-api"]},{"location":"janssen-server/install/helm-install/ingress-setup/#configure-gateway-ip","title":"Configure Gateway IP","text":"<p>Option A: Static IP (Recommended)</p> <p>Reserve a static public IP with your cloud provider before installation. Add this IP to your <code>override.yaml</code>.</p> <p>Option B: Dynamic IP</p> <ol> <li>Run initial Helm install without <code>global.lbIp</code></li> <li>Wait for the cloud provider to assign an IP:    <pre><code>kubectl get gateway -n jans\n</code></pre></li> <li>Add the IP to <code>global.lbIp</code> in <code>override.yaml</code></li> <li>Run <code>helm upgrade</code> to apply</li> </ol>","tags":["administration","installation","helm","ingress","gateway-api"]},{"location":"janssen-server/install/helm-install/ingress-setup/#gateway-api-configuration","title":"Gateway API Configuration","text":"<p>Add this to your <code>override.yaml</code>:</p> <pre><code>global:\n  lbIp: \"\"  # Add your static IP here\n  fqdn: demoexample.jans.io  # Your domain\n  isFqdnRegistered: true  # Set to false if no registered domain\n  gatewayApi:\n    enabled: true\n  nginx-ingress:\n    enabled: false\ngatewayApi:\n  gatewayClassName: nginx  # Match your controller (nginx, istio, etc.)\n  name: jans-gateway\n  httpPort: 80\n  httpsPort: 443\n</code></pre>","tags":["administration","installation","helm","ingress","gateway-api"]},{"location":"janssen-server/install/helm-install/ingress-setup/#option-2-kubernetes-ingress-legacy","title":"Option 2: Kubernetes Ingress (Legacy)","text":"<p>Use this if you prefer the traditional Ingress resource.</p> <p>Retirement Notice</p> <p>The upstream ingress-nginx project is in a terminal maintenance window through March 2026 and will receive no further releases, bug fixes, or security updates after that date. Consider migrating to Gateway API (Option 1) or an alternative maintained ingress controller. See the upstream announcement for details.</p>","tags":["administration","installation","helm","ingress","gateway-api"]},{"location":"janssen-server/install/helm-install/ingress-setup/#install-nginx-ingress-controller","title":"Install Nginx Ingress Controller","text":"<pre><code>helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx\nhelm repo add stable https://charts.helm.sh/stable\nhelm repo update\nhelm install nginx ingress-nginx/ingress-nginx\n</code></pre>","tags":["administration","installation","helm","ingress","gateway-api"]},{"location":"janssen-server/install/helm-install/ingress-setup/#get-the-load-balancer-address","title":"Get the Load Balancer Address","text":"<p>For GKE/AKS (IP address): <pre><code>kubectl get svc nginx-ingress-nginx-controller --output jsonpath='{.status.loadBalancer.ingress[0].ip}'\n</code></pre></p> <p>For EKS (hostname): <pre><code>kubectl get svc nginx-ingress-nginx-controller --output jsonpath='{.status.loadBalancer.ingress[0].hostname}'\n</code></pre></p>","tags":["administration","installation","helm","ingress","gateway-api"]},{"location":"janssen-server/install/helm-install/ingress-setup/#ingress-configuration","title":"Ingress Configuration","text":"<p>Choose the configuration that matches your setup:</p>","tags":["administration","installation","helm","ingress","gateway-api"]},{"location":"janssen-server/install/helm-install/ingress-setup/#with-a-registered-domain-fqdn","title":"With a Registered Domain (FQDN)","text":"<p>For GKE/AKS with a registered domain:</p> <pre><code>global:\n  lbIp: \"\"  # Add LoadBalancer IP from previous command\n  fqdn: demoexample.jans.io  # Your registered domain\n  isFqdnRegistered: true\nnginx-ingress:\n  ingress:\n    path: /\n    hosts:\n      - demoexample.jans.io  # Your domain\n    tls:\n      - secretName: tls-certificate\n        hosts:\n          - demoexample.jans.io  # Your domain\n</code></pre> <p>For EKS with a registered domain (uses hostname instead of IP):</p> <pre><code>global:\n  fqdn: demoexample.jans.io  # Your registered domain\n  isFqdnRegistered: true\nconfig:\n  configmap:\n    lbAddr: http://YOUR-EKS-HOSTNAME.elb.amazonaws.com  # Add EKS hostname here\nnginx-ingress:\n  ingress:\n    path: /\n    hosts:\n      - demoexample.jans.io  # Your domain\n    tls:\n      - secretName: tls-certificate\n        hosts:\n          - demoexample.jans.io  # Your domain\n</code></pre>","tags":["administration","installation","helm","ingress","gateway-api"]},{"location":"janssen-server/install/helm-install/ingress-setup/#without-a-registered-domain","title":"Without a Registered Domain","text":"<p>If you don't have a registered domain, use the LoadBalancer address directly:</p> <p>For GKE/AKS:</p> <pre><code>global:\n  lbIp: \"\"  # Add LoadBalancer IP from previous command\n  isFqdnRegistered: false\n</code></pre> <p>For EKS:</p> <pre><code>config:\n  configmap:\n    lbAddr: http://YOUR-EKS-HOSTNAME.elb.amazonaws.com  # Add EKS hostname here\nglobal:\n  isFqdnRegistered: false\n</code></pre>","tags":["administration","installation","helm","ingress","gateway-api"]},{"location":"janssen-server/install/helm-install/ingress-setup/#next-steps","title":"Next Steps","text":"<p>Proceed to Database Setup to configure persistence storage.</p>","tags":["administration","installation","helm","ingress","gateway-api"]},{"location":"janssen-server/install/helm-install/install-janssen/","title":"Install Janssen with Helm","text":"<p>After configuring your cluster, ingress, and database, you're ready to install Janssen.</p>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/install-janssen/#complete-overrideyaml-example","title":"Complete override.yaml Example","text":"<p>Here's a complete <code>override.yaml</code> combining Gateway API and MySQL:</p> <pre><code>global:\n  lbIp: \"\"  # Add your LoadBalancer IP\n  fqdn: demoexample.jans.io  # Your domain\n  isFqdnRegistered: true\n  gatewayApi:\n    enabled: true\n  nginx-ingress:\n    enabled: false\ngatewayApi:\n  gatewayClassName: nginx\n  name: jans-gateway\nconfig:\n  configmap:\n    cnSqlDbName: jans\n    cnSqlDbPort: 3306\n    cnSqlDbDialect: mysql\n    cnSqlDbHost: mysql.jans.svc\n    cnSqlDbUser: root  # Use a dedicated user in production\n    cnSqlDbTimezone: UTC\n    cnSqldbUserPassword: Test1234#  # Change for production!\n</code></pre> <p>Security</p> <p>Replace example credentials with secure values for production deployments.</p> <p>Adjust values based on your choices from the previous steps.</p>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/install-janssen/#add-the-janssen-helm-repository","title":"Add the Janssen Helm Repository","text":"<pre><code>helm repo add janssen https://docs.jans.io/charts\nhelm repo update\n</code></pre>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/install-janssen/#install-janssen","title":"Install Janssen","text":"<pre><code>helm install janssen janssen/janssen -n jans --create-namespace -f override.yaml\n</code></pre>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/install-janssen/#verify-installation","title":"Verify Installation","text":"<p>Check pod status:</p> <pre><code>kubectl get pods -n jans\n</code></pre> <p>Wait for all pods to reach <code>Running</code> or <code>Completed</code> status.</p>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/install-janssen/#upgrade-an-existing-installation","title":"Upgrade an Existing Installation","text":"<p>To apply configuration changes:</p> <pre><code>helm upgrade janssen janssen/janssen -n jans -f override.yaml\n</code></pre>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/install-janssen/#uninstall","title":"Uninstall","text":"<p>To remove Janssen:</p> <pre><code>helm uninstall janssen -n jans\n</code></pre>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/install-janssen/#chart-reference","title":"Chart Reference","text":"<p>For all available Helm values, see the Helm Chart Reference.</p>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/install-janssen/#next-steps","title":"Next Steps","text":"<p>Proceed to Post-Installation to configure and verify your deployment.</p>","tags":["administration","installation","helm"]},{"location":"janssen-server/install/helm-install/post-install/","title":"Post-Installation","text":"<p>After installing Janssen, use this guide to configure and verify your deployment.</p>","tags":["administration","installation","helm","configuration"]},{"location":"janssen-server/install/helm-install/post-install/#verify-pod-status","title":"Verify Pod Status","text":"<p>Ensure all pods are running:</p> <pre><code>kubectl get pods -n jans\n</code></pre> <p>Expected output shows pods in <code>Running</code> or <code>Completed</code> state.</p>","tags":["administration","installation","helm","configuration"]},{"location":"janssen-server/install/helm-install/post-install/#configure-janssen-with-tui","title":"Configure Janssen with TUI","text":"<p>The Terminal User Interface (TUI) provides an interactive way to configure Janssen components. The TUI calls the Config API to perform configuration.</p> <p>See the TUI for Kubernetes guide for detailed instructions.</p>","tags":["administration","installation","helm","configuration"]},{"location":"janssen-server/install/helm-install/post-install/#verify-endpoints","title":"Verify Endpoints","text":"<p>Test that your Janssen endpoints are accessible:</p> Service Endpoint Auth Server <code>https://&lt;FQDN&gt;/.well-known/openid-configuration</code> FIDO2 <code>https://&lt;FQDN&gt;/.well-known/fido2-configuration</code> SCIM <code>https://&lt;FQDN&gt;/.well-known/scim-configuration</code>","tags":["administration","installation","helm","configuration"]},{"location":"janssen-server/install/helm-install/post-install/#view-logs","title":"View Logs","text":"<p>Check logs for troubleshooting:</p> <pre><code>kubectl logs -n jans -l app=auth-server\nkubectl logs -n jans -l app=config-api\n</code></pre>","tags":["administration","installation","helm","configuration"]},{"location":"janssen-server/install/helm-install/post-install/#common-issues","title":"Common Issues","text":"","tags":["administration","installation","helm","configuration"]},{"location":"janssen-server/install/helm-install/post-install/#pods-not-starting","title":"Pods not starting","text":"<p>Check events for the namespace: <pre><code>kubectl get events -n jans --sort-by='.lastTimestamp'\n</code></pre></p>","tags":["administration","installation","helm","configuration"]},{"location":"janssen-server/install/helm-install/post-install/#database-connection-errors","title":"Database connection errors","text":"<p>Verify database connectivity: <pre><code>kubectl exec -it -n jans &lt;config-pod&gt; -- nc -zv &lt;db-host&gt; &lt;db-port&gt;\n</code></pre></p>","tags":["administration","installation","helm","configuration"]},{"location":"janssen-server/install/helm-install/post-install/#certificate-issues","title":"Certificate issues","text":"<p>Ensure TLS certificates are properly configured: <pre><code>kubectl get secrets -n jans | grep tls\n</code></pre></p>","tags":["administration","installation","helm","configuration"]},{"location":"janssen-server/install/helm-install/post-install/#next-steps","title":"Next Steps","text":"<ul> <li>Kubernetes Operations - Day-2 operations</li> <li>Config API - REST API configuration</li> <li>Monitoring - Set up monitoring</li> </ul>","tags":["administration","installation","helm","configuration"]},{"location":"janssen-server/install/helm-install/prerequisites/amazon-eks/","title":"Amazon EKS Cluster Setup","text":"<p>This guide covers the prerequisites and cluster creation specific to Amazon Elastic Kubernetes Service (EKS).</p>","tags":["administration","installation","helm","EKS","Amazon Web Services","AWS"]},{"location":"janssen-server/install/helm-install/prerequisites/amazon-eks/#prerequisites","title":"Prerequisites","text":"<ol> <li> <p>Install AWS CLI</p> </li> <li> <p>Configure your AWS user account using the aws configure command. This user account must have permissions to work with Amazon EKS IAM roles, service-linked roles, AWS CloudFormation, and VPC resources.</p> </li> <li> <p>Install kubectl</p> </li> <li> <p>Install eksctl</p> </li> <li> <p>Install Helm3</p> </li> </ol>","tags":["administration","installation","helm","EKS","Amazon Web Services","AWS"]},{"location":"janssen-server/install/helm-install/prerequisites/amazon-eks/#create-the-eks-cluster","title":"Create the EKS Cluster","text":"<pre><code>eksctl create cluster --name janssen-cluster --nodegroup-name jans-nodes --node-type NODE_TYPE --nodes 2 --managed --region REGION_CODE\n</code></pre> <p>Replace <code>NODE_TYPE</code> with an instance type (for example: <code>t3.xlarge</code>, <code>m5.large</code>) and <code>REGION_CODE</code> with your AWS region (for example: <code>us-east-1</code>, <code>eu-west-1</code>). Adjust <code>nodes</code> as per your desired cluster size.</p>","tags":["administration","installation","helm","EKS","Amazon Web Services","AWS"]},{"location":"janssen-server/install/helm-install/prerequisites/amazon-eks/#install-the-ebs-csi-driver","title":"Install the EBS CSI Driver","text":"<p>The EBS CSI driver requires an IAM role or ServiceAccount with appropriate permissions for EBS CSI operations. See the EBS CSI IAM role guide for setup instructions.</p> <p>To attach volumes to your pods, install the Amazon EBS CSI driver.</p>","tags":["administration","installation","helm","EKS","Amazon Web Services","AWS"]},{"location":"janssen-server/install/helm-install/prerequisites/amazon-eks/#create-the-janssen-namespace","title":"Create the Janssen Namespace","text":"<pre><code>kubectl create namespace jans\n</code></pre>","tags":["administration","installation","helm","EKS","Amazon Web Services","AWS"]},{"location":"janssen-server/install/helm-install/prerequisites/amazon-eks/#next-steps","title":"Next Steps","text":"<p>Proceed to Ingress Setup to configure traffic routing.</p>","tags":["administration","installation","helm","EKS","Amazon Web Services","AWS"]},{"location":"janssen-server/install/helm-install/prerequisites/google-gke/","title":"Google GKE Cluster Setup","text":"<p>This guide covers the prerequisites and cluster creation specific to Google Kubernetes Engine (GKE).</p>","tags":["administration","installation","helm","GKE","Google Cloud","GCP"]},{"location":"janssen-server/install/helm-install/prerequisites/google-gke/#prerequisites","title":"Prerequisites","text":"<ol> <li> <p>Enable GKE API if not enabled yet.</p> </li> <li> <p>If you are using Cloud Shell, skip to step 5.</p> </li> <li> <p>Install gcloud CLI.</p> </li> <li> <p>Install kubectl:</p> </li> </ol> <pre><code>gcloud components install kubectl\n</code></pre> <ol> <li>Install Helm3.</li> </ol>","tags":["administration","installation","helm","GKE","Google Cloud","GCP"]},{"location":"janssen-server/install/helm-install/prerequisites/google-gke/#create-the-gke-cluster","title":"Create the GKE Cluster","text":"<pre><code>gcloud container clusters create janssen-cluster --num-nodes 2 --machine-type e2-standard-4 --zone us-west1-a\n</code></pre> <p>Adjust <code>num-nodes</code> and <code>machine-type</code> as per your desired cluster size.</p>","tags":["administration","installation","helm","GKE","Google Cloud","GCP"]},{"location":"janssen-server/install/helm-install/prerequisites/google-gke/#create-the-janssen-namespace","title":"Create the Janssen Namespace","text":"<pre><code>kubectl create namespace jans\n</code></pre>","tags":["administration","installation","helm","GKE","Google Cloud","GCP"]},{"location":"janssen-server/install/helm-install/prerequisites/google-gke/#next-steps","title":"Next Steps","text":"<p>Proceed to Ingress Setup to configure traffic routing.</p>","tags":["administration","installation","helm","GKE","Google Cloud","GCP"]},{"location":"janssen-server/install/helm-install/prerequisites/local/","title":"Local Kubernetes Setup (Minikube/MicroK8s)","text":"<p>This guide covers setting up Janssen on a local Kubernetes cluster for development and testing.</p>","tags":["administration","installation","helm","local","minikube","microk8s"]},{"location":"janssen-server/install/helm-install/prerequisites/local/#system-requirements","title":"System Requirements","text":"<p>For local deployments, minimum resources are:</p> <ul> <li>8 GB RAM</li> <li>4 CPU cores</li> <li>50 GB hard-disk</li> </ul>","tags":["administration","installation","helm","local","minikube","microk8s"]},{"location":"janssen-server/install/helm-install/prerequisites/local/#resource-breakdown-by-service","title":"Resource Breakdown by Service","text":"Service CPU RAM Required Auth server 2.5 2.5GB Yes FIDO2 0.5 0.5GB No SCIM 1 1GB No Config job 0.3 0.3GB Yes (fresh installs) Persistence job 0.3 0.3GB Yes (fresh installs) Nginx 1 1GB Yes (if not using ALB/Istio) Auth-key-rotation 0.3 0.3GB Strongly recommended Config-API 1 1GB No Casa 0.5 0.5GB No Link 0.5 1GB No SAML 0.5 1GB No","tags":["administration","installation","helm","local","minikube","microk8s"]},{"location":"janssen-server/install/helm-install/prerequisites/local/#quick-start-script","title":"Quick Start Script","text":"<p>Start a fresh Ubuntu 18.04/20.04/22.04 VM with ports 443 and 80 open, then run:</p> <pre><code>sudo su -\nwget https://raw.githubusercontent.com/JanssenProject/jans/0.0.0-nightly/automation/startjanssendemo.sh &amp;&amp; chmod u+x startjanssendemo.sh &amp;&amp; ./startjanssendemo.sh\n</code></pre> <p>This installs Docker, MicroK8s, Helm, and Janssen with default settings.</p>","tags":["administration","installation","helm","local","minikube","microk8s"]},{"location":"janssen-server/install/helm-install/prerequisites/local/#accessing-endpoints","title":"Accessing Endpoints","text":"<p>The installer adds a hosts record in the VM. To access from outside the VM, map the VM IP to your FQDN.</p> Service Endpoint Auth server <code>https://FQDN/.well-known/openid-configuration</code> FIDO2 <code>https://FQDN/.well-known/fido2-configuration</code> SCIM <code>https://FQDN/.well-known/scim-configuration</code>","tags":["administration","installation","helm","local","minikube","microk8s"]},{"location":"janssen-server/install/helm-install/prerequisites/local/#manual-setup","title":"Manual Setup","text":"<p>If you prefer manual setup:</p> <ol> <li>Install Minikube or MicroK8s</li> <li>Install Helm3</li> <li>Create the namespace:    <pre><code>kubectl create namespace jans\n</code></pre></li> </ol>","tags":["administration","installation","helm","local","minikube","microk8s"]},{"location":"janssen-server/install/helm-install/prerequisites/local/#next-steps","title":"Next Steps","text":"<p>Proceed to Ingress Setup to configure traffic routing.</p>","tags":["administration","installation","helm","local","minikube","microk8s"]},{"location":"janssen-server/install/helm-install/prerequisites/microsoft-aks/","title":"Microsoft AKS Cluster Setup","text":"<p>This guide covers the prerequisites and cluster creation specific to Azure Kubernetes Service (AKS).</p>","tags":["administration","installation","helm","AKS","Microsoft","Azure"]},{"location":"janssen-server/install/helm-install/prerequisites/microsoft-aks/#prerequisites","title":"Prerequisites","text":"<ol> <li> <p>Install Azure CLI</p> </li> <li> <p>Install Helm3</p> </li> </ol>","tags":["administration","installation","helm","AKS","Microsoft","Azure"]},{"location":"janssen-server/install/helm-install/prerequisites/microsoft-aks/#create-a-resource-group","title":"Create a Resource Group","text":"<pre><code>az group create --name janssen-resource-group --location eastus\n</code></pre>","tags":["administration","installation","helm","AKS","Microsoft","Azure"]},{"location":"janssen-server/install/helm-install/prerequisites/microsoft-aks/#create-the-aks-cluster","title":"Create the AKS Cluster","text":"<pre><code>az aks create -g janssen-resource-group -n janssen-cluster --enable-managed-identity --node-vm-size NODE_TYPE --node-count 2 --enable-addons monitoring --enable-msi-auth-for-monitoring --generate-ssh-keys\n</code></pre> <p>Adjust <code>node-count</code> and <code>node-vm-size</code> as per your desired cluster size.</p>","tags":["administration","installation","helm","AKS","Microsoft","Azure"]},{"location":"janssen-server/install/helm-install/prerequisites/microsoft-aks/#connect-to-the-cluster","title":"Connect to the Cluster","text":"<pre><code>az aks install-cli\naz aks get-credentials --resource-group janssen-resource-group --name janssen-cluster\n</code></pre>","tags":["administration","installation","helm","AKS","Microsoft","Azure"]},{"location":"janssen-server/install/helm-install/prerequisites/microsoft-aks/#create-the-janssen-namespace","title":"Create the Janssen Namespace","text":"<pre><code>kubectl create namespace jans\n</code></pre>","tags":["administration","installation","helm","AKS","Microsoft","Azure"]},{"location":"janssen-server/install/helm-install/prerequisites/microsoft-aks/#next-steps","title":"Next Steps","text":"<p>Proceed to Ingress Setup to configure traffic routing.</p>","tags":["administration","installation","helm","AKS","Microsoft","Azure"]},{"location":"janssen-server/install/helm-install/prerequisites/rancher/","title":"Rancher Marketplace Setup","text":"<p>This guide covers installing Janssen through the Rancher Marketplace.</p>","tags":["administration","installation","helm","rancher"]},{"location":"janssen-server/install/helm-install/prerequisites/rancher/#prerequisites","title":"Prerequisites","text":"<ol> <li>Provision a Linux VM with:</li> <li>4 CPU cores</li> <li>16 GB RAM</li> <li>50 GB SSD</li> <li> <p>Ports 443 and 80 open</p> <p>These are minimum specs for testing or single-node/demo installations. Production environments require higher resources and HA configurations. See Rancher production requirements for guidance.</p> </li> <li> <p>Install Docker</p> </li> </ol>","tags":["administration","installation","helm","rancher"]},{"location":"janssen-server/install/helm-install/prerequisites/rancher/#start-rancher","title":"Start Rancher","text":"<p>Not for Production</p> <p>Single-node Docker installations are intended only for testing and development. For production deployments, use a high-availability Kubernetes-based Helm installation. See Rancher HA installation docs for guidance.</p> <pre><code>docker run -d --restart=unless-stopped -p 80:80 -p 443:443 --privileged rancher/rancher:v2.13.2\n</code></pre> <p>Version Pinning</p> <p>Use a specific version tag (e.g., <code>v2.13.2</code>) instead of <code>latest</code> for production deployments to ensure reproducibility.</p> <p>Note</p> <p>If deploying an Ingress controller that uses ports 80 and 443, adjust the host ports. See Rancher documentation for details.</p>","tags":["administration","installation","helm","rancher"]},{"location":"janssen-server/install/helm-install/prerequisites/rancher/#get-bootstrap-password","title":"Get Bootstrap Password","text":"<p>When you run <code>docker run -d</code>, it outputs only the container ID. Save this value. If you missed it, you can retrieve the container ID later using <code>docker ps</code>.</p> <p>Retrieve the bootstrap password:</p> <pre><code>docker logs &lt;container-id&gt; 2&gt;&amp;1 | grep \"Bootstrap Password:\"\n</code></pre>","tags":["administration","installation","helm","rancher"]},{"location":"janssen-server/install/helm-install/prerequisites/rancher/#access-rancher-ui","title":"Access Rancher UI","text":"<ol> <li>Navigate to <code>https://&lt;VM-IP-ADDRESS&gt;</code></li> <li>Log in with username <code>admin</code> and the bootstrap password</li> <li>Set a new password when prompted</li> </ol>","tags":["administration","installation","helm","rancher"]},{"location":"janssen-server/install/helm-install/prerequisites/rancher/#install-janssen-via-marketplace","title":"Install Janssen via Marketplace","text":"<ol> <li>From the Rancher home page, click on the <code>local</code> cluster</li> <li>Navigate to Apps &gt; Repositories &gt; Create</li> <li>Add repository:</li> <li>Name: <code>janssen</code></li> <li>Index URL: <code>https://docs.jans.io/charts</code></li> <li>Click Create</li> <li>Go to Apps &gt; Charts</li> <li>Search for \"Janssen\" and begin installation</li> <li>In Step 1, select Customize Helm options before install</li> <li>In Step 2, customize your settings</li> <li>In Step 3, unselect Wait and start the installation. Leaving \"Wait\" selected makes Helm wait for all resources to reach a ready state, which can cause the install to hang or time out in UI-driven installs. Unselecting it allows the release to be created asynchronously. Note that you'll need to check resource readiness separately (e.g., via <code>kubectl get pods -n jans</code>).</li> </ol>","tags":["administration","installation","helm","rancher"]},{"location":"janssen-server/install/helm-install/prerequisites/rancher/#next-steps","title":"Next Steps","text":"<p>Rancher Marketplace Flow</p> <p>When installing via Rancher Marketplace, the Ingress, Database, and Helm install steps are handled through the Rancher UI during chart installation. Skip directly to post-installation.</p> <p>After installation, proceed to Post-Installation for configuration.</p>","tags":["administration","installation","helm","rancher"]},{"location":"janssen-server/install/vm-install/","title":"VM Installation","text":"<p>Installing the Janssen software on a VM is a three step process:</p> <ol> <li>Check: VM requirements</li> <li>Install: package or docker container</li> <li>Run: <code>setup.py</code> to configure</li> </ol> <p>After this process, you should have the Janssen Project software running, and you'll be ready to start registering OAUTH clients, customizing your login pages, and doing all the other stuff that Janssen enables.</p> <p>You can check Github for the latest Releases. The instructions for the various packages also give you a shortcut using <code>wget</code> and <code>curl</code> to get the latest bits for your distro.</p> <p>Use the left navigation to get started and pick the Janssen Project VM flavor of your choice!</p> <p>Contribute</p> <p>If you\u2019d like to contribute to this document, get started with the Contribution Guide</p>","tags":["administration","installation","vm"]},{"location":"janssen-server/install/vm-install/dynamic-download/","title":"Install Janssen Server using Dynamic Download","text":"<p>The dynamic download installs the latest development version of the Janssen Server.</p> <p>Note</p> <p>This method of installation is suitable only for testing, development, or feature exploration purposes. Not for production deployments.</p>","tags":["administration","installation","vm","dynamic"]},{"location":"janssen-server/install/vm-install/dynamic-download/#system-requirements","title":"System Requirements","text":"<p>System should meet minimum VM system requirements</p>","tags":["administration","installation","vm","dynamic"]},{"location":"janssen-server/install/vm-install/dynamic-download/#prerequisites","title":"Prerequisites","text":"<ul> <li><code>curl</code> should be installed</li> </ul>","tags":["administration","installation","vm","dynamic"]},{"location":"janssen-server/install/vm-install/dynamic-download/#install","title":"Install","text":"<ol> <li> <p>Download the installer <pre><code>curl https://raw.githubusercontent.com/JanssenProject/jans/nightly/jans-linux-setup/jans_setup/install.py &gt; install.py\n</code></pre></p> </li> <li> <p>Execute Installer</p> </li> </ol> <p>To execute installer, run the command below:</p> <pre><code>python3 install.py\n</code></pre> <p>The installer can be invoked using various options to tailor the     installation process. Invoke the commands below to know about all the     available options.</p> <pre><code>python3 install.py --help\n</code></pre> <p>One particularly useful option for development environments is the one     below which installs the Janssen Server with test data loaded.</p> <pre><code>python3 install.py --args=\"-t\"\n</code></pre> <p>Installer can be run with all the arguments provided via command-line    at the time of invocking the install script. This enables prompt-less    installation. For example, see the command below:</p> <pre><code>python3 install.py --args=\"-n -ip-address 10.229.38.28 -host-name jans-opensuse -city ah -state gj -country in -org-name gluu -email dhaval@gluu.org -jans-max-mem 26349 -admin-password admin --with-casa --install-jans-keycloak-link -t\"\n</code></pre>","tags":["administration","installation","vm","dynamic"]},{"location":"janssen-server/install/vm-install/dynamic-download/#uninstall","title":"Uninstall","text":"<p>Use the command below to uninstall the Janssen Server</p> <p>Note</p> <p>For removal of the attached persistence store, please refer to this note.</p> <pre><code>python3 install.py -uninstall\n</code></pre>","tags":["administration","installation","vm","dynamic"]},{"location":"janssen-server/install/vm-install/rhel/","title":"Red Hat EL Janssen Installation","text":"<p>Before you install, check the VM system requirements.</p>","tags":["administration","installation","vm","RHEL"]},{"location":"janssen-server/install/vm-install/rhel/#install-the-package","title":"Install the Package","text":"<ul> <li>Install EPEL and mod-auth-openidc as dependencies</li> </ul> <pre><code>sudo yum -y install https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm\nsudo yum -y module enable mod_auth_openidc \n</code></pre> <ul> <li>Download the GPG key zip file , unzip and import GPG key</li> </ul> <pre><code>wget https://github.com/JanssenProject/jans/files/11814522/automation-jans-public-gpg.zip\n</code></pre> <pre><code>unzip automation-jans-public-gpg.zip\n</code></pre> <pre><code>sudo rpm -import automation-jans-public-gpg.asc\n</code></pre> <ul> <li>Download the release package from the Github Janssen Project   Releases</li> </ul> <pre><code>wget https://github.com/JanssenProject/jans/releases/download/nightly/jans-0.0.0-nightly.el8.x86_64.rpm -P ~/\n</code></pre> <ul> <li> <p>Verify integrity of the downloaded package using published <code>sha256sum</code>.</p> <ul> <li> <p>Go to the Janssen Project Releases page and copy the <code>sha256sum</code> value for the <code>jans-0.0.0-nightly.el8.x86_64.rpm</code> file:</p> </li> <li> <p>Replace <code>paste-release-sha256sum</code> in the command below with the actual checksum you copied from the release page, and run the following command: Command<pre><code>echo 'paste-release-sha256sum jans-0.0.0-nightly.el8.x86_64.rpm' | sed 's/^sha256://' &gt; jans-0.0.0-nightly.el8.x86_64.rpm.sha256sum &amp;&amp; sha256sum -c jans-0.0.0-nightly.el8.x86_64.rpm.sha256sum\n</code></pre></p> </li> </ul> <p>Output similar to below should confirm the integrity of the downloaded package.</p> <pre><code>jans-0.0.0-nightly.el8.x86_64.rpm: OK\n</code></pre> </li> <li> <p>Install the package</p> </li> </ul> <pre><code>sudo yum install ~/jans-0.0.0-nightly.el8.x86_64.rpm\n</code></pre>","tags":["administration","installation","vm","RHEL"]},{"location":"janssen-server/install/vm-install/rhel/#run-the-setup-script","title":"Run the setup script","text":"<ul> <li>Run the setup script in interactive mode:</li> </ul> <pre><code>sudo python3 /opt/jans/jans-setup/setup.py\n</code></pre> <p>The installer should confirm successful installation with a message similar to the one shown below:</p> <p></p> <p>See more detailed instructions on the setup script if you're confused how to answer any of the questions, for details about command line arguments, or you would prefer to use a properties file instead of interactive mode.</p>","tags":["administration","installation","vm","RHEL"]},{"location":"janssen-server/install/vm-install/rhel/#verify-the-installation","title":"Verify the Installation","text":"<p>After the successful completion of setup process, verify the system health.</p>","tags":["administration","installation","vm","RHEL"]},{"location":"janssen-server/install/vm-install/rhel/#log-in-to-text-user-interface-tui","title":"Log in to Text User Interface (TUI)","text":"<p>Begin configuration by accessing the TUI with the following command:</p> <pre><code>jans tui\n</code></pre> <p>Full TUI documentation can be found here</p> <p>If you have selected casa during installation you can access casa using url<code>https://&lt;host&gt;/jans-casa</code></p>","tags":["administration","installation","vm","RHEL"]},{"location":"janssen-server/install/vm-install/rhel/#enabling-https","title":"Enabling HTTPS","text":"<p>To enable communication with Janssen Server over TLS (https) in a production environment, Janssen Server needs details about CA certificate. Update the HTTPS cofiguration file <code>https_jans.conf</code> as shown below:</p> <p>Note</p> <p>Want to use <code>Let's Encrypt</code> to get a certificate? Follow this guide.</p> <ul> <li>Open <code>https_jans.conf</code></li> </ul> <pre><code>sudo vi /etc/httpd/conf.d/https_jans.conf\n</code></pre> <ul> <li>Update <code>SSLCertificateFile</code> and <code>SSLCertificateKeyFile</code> parameters values</li> </ul> <pre><code>SSLCertificateFile location_of_fullchain.pem\nSSLCertificateKeyFile location_of_privkey.pem\n</code></pre> <ul> <li>Restart <code>httpd</code> service for changes to take effect</li> </ul> <pre><code>sudo service httpd restart\n</code></pre>","tags":["administration","installation","vm","RHEL"]},{"location":"janssen-server/install/vm-install/rhel/#uninstall","title":"Uninstall","text":"<p>Uninstall process involves two steps and removes all the Janssen Server components.</p> <p>Note</p> <p>For removal of the attached persistence store, please refer to this note.</p> <ol> <li>Delete files installed by Janssen</li> <li> <p>Remove and purge the <code>jans</code> package</p> </li> <li> <p>Use the command below to uninstall the Janssen server</p> </li> </ol> <pre><code>sudo python3 /opt/jans/jans-setup/install.py -uninstall\n</code></pre> <p>Console output like below will confirm the successful uninstallation of the Janssen Server</p> <pre><code>This process is irreversible.\nYou will lose all data related to Janssen Server.\n\n\n\nAre you sure to uninstall Janssen Server? [yes/N] yes\n\nUninstalling Jannsen Server...\nRemoving /etc/default/jans-config-api\nStopping jans-config-api\nRemoving /etc/default/jans-scim\nStopping jans-scim\nRemoving /etc/default/jans-fido2\nStopping jans-fido2\nRemoving /etc/default/jans-auth\nStopping jans-auth\nRemoving /etc/default/jans-client-api\nStopping jans-client-api\nStopping OpenDj Server\nExecuting rm -r -f /etc/certs\nExecuting rm -r -f /etc/jans\nExecuting rm -r -f /opt/jans\nExecuting rm -r -f /opt/amazon-corretto*\nExecuting rm -r -f /opt/jre\nExecuting rm -r -f /opt/node*\nExecuting rm -r -f /opt/jetty*\nExecuting rm -r -f /opt/jython*\nExecuting rm -r -f /opt/opendj\nExecuting rm -r -f /opt/dist\nRemoving /etc/apache2/sites-enabled/https_jans.conf\nRemoving /etc/apache2/sites-available/https_jans.conf\n</code></pre> <ul> <li>Remove the linux package</li> </ul> <p>Use the command below to remove and purge <code>jans</code> package</p> <pre><code>yum remove jans.x86_64\n</code></pre> <p>Successful removal will remove the Janssen Server package along with the removal of all the unused dependencies.</p>","tags":["administration","installation","vm","RHEL"]},{"location":"janssen-server/install/vm-install/suse/","title":"SUSE Janssen Installation","text":"<p>Before you install, check the VM system requirements.</p>","tags":["administration","installation","vm","SUSE","SLES","Leap"]},{"location":"janssen-server/install/vm-install/suse/#install-the-package","title":"Install the Package","text":"<ul> <li>If the server firewall is running, make sure you allow <code>https</code>, which is needed for OpenID and FIDO.</li> </ul> <pre><code>sudo firewall-cmd --permanent --zone=public --add-service=https\n</code></pre> <pre><code>sudo firewall-cmd --reload\n</code></pre> <ul> <li>for SLES, we need to enable PackageHub as per OSversion and architecture <pre><code>sudo SUSEConnect -p PackageHub/15.5/x86_64\n</code></pre></li> <li>Download the GPG key zip file , unzip and import GPG key</li> </ul> <pre><code>wget https://github.com/JanssenProject/jans/files/11814522/automation-jans-public-gpg.zip\n</code></pre> <pre><code>unzip automation-jans-public-gpg.zip\n</code></pre> <pre><code>sudo rpm -import automation-jans-public-gpg.asc\n</code></pre> <ul> <li>Download the release package from the GitHub Janssen Project   Releases</li> </ul> <pre><code>wget https://github.com/JanssenProject/jans/releases/download/nightly/jans-0.0.0-nightly.suse15.x86_64.rpm\n</code></pre> <ul> <li> <p>Verify integrity of the downloaded package using published <code>sha256sum</code>.</p> <ul> <li> <p>Go to the Janssen Project Releases page and copy the <code>sha256sum</code> value for the <code>jans-0.0.0-nightly.suse15.x86_64.rpm</code> file:</p> </li> <li> <p>Replace <code>paste-release-sha256sum</code> in the command below with the actual checksum you copied from the release page, and run the following command:</p> </li> </ul> Command<pre><code>echo 'paste-release-sha256sum jans-0.0.0-nightly.suse15.x86_64.rpm' | sed 's/^sha256://' &gt; jans-0.0.0-nightly.suse15.x86_64.rpm.sha256sum &amp;&amp; sha256sum -c jans-0.0.0-nightly.suse15.x86_64.rpm.sha256sum\n</code></pre> <p>Output similar to below should confirm the integrity of the downloaded package.</p> <pre><code>jans-0.0.0-nightly.el8.x86_64.rpm: OK\n</code></pre> </li> <li> <p>Install the package</p> </li> </ul> <pre><code>sudo zypper install ~/jans-0.0.0-nightly.suse15.x86_64.rpm\n</code></pre>","tags":["administration","installation","vm","SUSE","SLES","Leap"]},{"location":"janssen-server/install/vm-install/suse/#run-the-setup-script","title":"Run the setup script","text":"<ul> <li>Run the setup script in interactive mode:</li> </ul> <pre><code>sudo python3 /opt/jans/jans-setup/setup.py\n</code></pre> <p>See more detailed instructions on the setup script if you're confused how to answer any of the questions, for details about command line arguments, or you would prefer to use a properties file instead of interactive mode.</p>","tags":["administration","installation","vm","SUSE","SLES","Leap"]},{"location":"janssen-server/install/vm-install/suse/#verify-the-installation","title":"Verify the Installation","text":"<p>After the successful completion of setup process, verify the system health.</p>","tags":["administration","installation","vm","SUSE","SLES","Leap"]},{"location":"janssen-server/install/vm-install/suse/#log-in-to-text-user-interface-tui","title":"Log in to Text User Interface (TUI)","text":"<p>Begin configuration by accessing the TUI with the following command:</p> <pre><code>jans tui\n</code></pre> <p>Full TUI documentation can be found here</p> <p>If you have selected casa during installation you can access casa using url <code>https://&lt;host&gt;/jans-casa</code></p>","tags":["administration","installation","vm","SUSE","SLES","Leap"]},{"location":"janssen-server/install/vm-install/suse/#enabling-https","title":"Enabling HTTPS","text":"<p>To enable communication with Janssen Server over TLS (https) in a production environment, Janssen Server needs details about CA certificate. Update the HTTPS cofiguration file <code>https_jans.conf</code> as shown below:</p> <p>Note</p> <p>Want to use <code>Let's Encrypt</code> to get a certificate? Follow this guide.</p> <ul> <li> <p>Open <code>https_jans.conf</code> <pre><code>sudo vi /etc/apache2/vhosts.d/_https_jans.conf\n</code></pre></p> </li> <li> <p>Update <code>SSLCertificateFile</code> and <code>SSLCertificateKeyFile</code> parameters values   <pre><code>SSLCertificateFile location_of_fullchain.pem\nSSLCertificateKeyFile location_of_privkey.pem\n</code></pre></p> </li> <li> <p>Restart <code>httpd</code> service for changes to take effect   <pre><code>sudo /usr/sbin/rcapache2 restart\n</code></pre></p> </li> </ul>","tags":["administration","installation","vm","SUSE","SLES","Leap"]},{"location":"janssen-server/install/vm-install/suse/#uninstall","title":"Uninstall","text":"<p>Uninstall process involves two steps and removes all the Janssen Server components.</p> <p>Note</p> <p>For removal of the attached persistence store, please refer to this note.</p> <ol> <li>Uninstall Janssen Server</li> <li>Remove and purge the <code>jans</code> package</li> </ol> <p>If you have not run the Jans setup script, you can skip step 1 and just remove the package.</p> <p>First, run command below to uninstall the Janssen server</p> <pre><code>sudo python3 /opt/jans/jans-setup/install.py -uninstall\n</code></pre> <p>You'll see the following confirmation:</p> <pre><code>This process is irreversible.\nYou will lose all data related to Janssen Server.\n\n\n\nAre you sure to uninstall Janssen Server? [yes/N] yes\n\nUninstalling Jannsen Server...\nRemoving /etc/default/jans-config-api\nStopping jans-config-api\nRemoving /etc/default/jans-scim\nStopping jans-scim\nRemoving /etc/default/jans-fido2\nStopping jans-fido2\nRemoving /etc/default/jans-auth\nStopping jans-auth\nRemoving /etc/default/jans-client-api\nStopping jans-client-api\nStopping OpenDj Server\nExecuting rm -r -f /etc/certs\nExecuting rm -r -f /etc/jans\nExecuting rm -r -f /opt/jans\nExecuting rm -r -f /opt/amazon-corretto*\nExecuting rm -r -f /opt/jre\nExecuting rm -r -f /opt/node*\nExecuting rm -r -f /opt/jetty*\nExecuting rm -r -f /opt/jython*\nExecuting rm -r -f /opt/opendj\nExecuting rm -r -f /opt/dist\nRemoving /etc/apache2/sites-enabled/https_jans.conf\nRemoving /etc/apache2/sites-available/https_jans.conf\n</code></pre> <p>Second uninstall the package:</p> <pre><code>rpm -qa | grep jans\n</code></pre> <p>And then use <code>zypper remove &lt;package&gt;</code></p>","tags":["administration","installation","vm","SUSE","SLES","Leap"]},{"location":"janssen-server/install/vm-install/ubuntu/","title":"Ubuntu Janssen Installation","text":"<p>Before you install, check the VM system requirements.</p> <ul> <li>Download the GPG key zip file , unzip and import GPG key</li> </ul> Command<pre><code>wget https://github.com/JanssenProject/jans/files/11814522/automation-jans-public-gpg.zip\n</code></pre> Command<pre><code>unzip automation-jans-public-gpg.zip\n</code></pre> Command<pre><code>sudo gpg --import automation-jans-public-gpg.asc;\n</code></pre>","tags":["administration","installation","vm","ubuntu"]},{"location":"janssen-server/install/vm-install/ubuntu/#install-the-package","title":"Install the Package","text":"","tags":["administration","installation","vm","ubuntu"]},{"location":"janssen-server/install/vm-install/ubuntu/#ubuntu-2404","title":"Ubuntu 24.04","text":"<ul> <li> <p>Download the release package from the Github Janssen Project Releases</p> Command<pre><code>wget https://github.com/JanssenProject/jans/releases/download/nightly/jans_0.0.0-nightly.ubuntu24.04_amd64.deb -P /tmp\n</code></pre> </li> <li> <p>Go to <code>/tmp</code> directory:</p> Command<pre><code>cd /tmp\n</code></pre> </li> <li> <p>Verify integrity of the downloaded package by verifying published <code>sha256sum</code>.  </p> <ul> <li>Go to the Janssen Project Releases page and copy the <code>sha256sum</code> value for the <code>jans_0.0.0-nightly.ubuntu24.04_amd64.deb</code> file:</li> <li>Replace <code>paste-release-sha256sum</code> in the command below with the actual checksum you copied from the release page, and run the following command: Command<pre><code>echo 'paste-release-sha256sum jans_0.0.0-nightly.ubuntu24.04_amd64.deb' | sed 's/^sha256://' &gt; jans_0.0.0-nightly.ubuntu24.04_amd64.deb.sha256sum &amp;&amp; sha256sum -c jans_0.0.0-nightly.ubuntu24.04_amd64.deb.sha256sum\n</code></pre></li> </ul> <p>Output similar to below should confirm the integrity of the downloaded package.</p> Output<pre><code>jans_0.0.0-nightly.ubuntu24.04_amd64.deb: OK\n</code></pre> </li> <li> <p>Install the package</p> </li> </ul> Command<pre><code>sudo apt install  ./jans_0.0.0-nightly.ubuntu24.04_amd64.deb\n</code></pre>","tags":["administration","installation","vm","ubuntu"]},{"location":"janssen-server/install/vm-install/ubuntu/#ubuntu-2204","title":"Ubuntu 22.04","text":"<ul> <li> <p>Download the release package from the Github Janssen Project Releases</p> Command<pre><code>wget https://github.com/JanssenProject/jans/releases/download/nightly/jans_0.0.0-nightly.ubuntu22.04_amd64.deb -P /tmp\n</code></pre> </li> <li> <p>Go to <code>/tmp</code> directory:</p> Command<pre><code>cd /tmp\n</code></pre> </li> <li> <p>Verify integrity of the downloaded package by verifying published <code>sha256sum</code>.   </p> <ul> <li> <p>Go to the Janssen Project Releases page and copy the <code>sha256sum</code> value for the <code>jans_0.0.0-nightly.ubuntu22.04_amd64.deb</code> file:</p> </li> <li> <p>Replace <code>paste-release-sha256sum</code> in the command below with the actual checksum you copied from the release page, and run the following command: Command<pre><code>echo 'paste-release-sha256sum jans_0.0.0-nightly.ubuntu22.04_amd64.deb' | sed 's/^sha256://' &gt; jans_0.0.0-nightly.ubuntu22.04_amd64.deb.sha256sum &amp;&amp; sha256sum -c jans_0.0.0-nightly.ubuntu22.04_amd64.deb.sha256sum\n</code></pre> Output similar to below should confirm the integrity of the downloaded package.</p> </li> </ul> Output<pre><code>jans_0.0.0-nightly.ubuntu22.04_amd64.deb: OK\n</code></pre> </li> <li> <p>Install the package</p> </li> </ul> Command<pre><code>sudo apt install  ./jans_0.0.0-nightly.ubuntu22.04_amd64.deb\n</code></pre> <p>Or,</p> Command<pre><code>dpkg -i jans_1.4.0-stable.ubuntu22.04_amd64.deb\n</code></pre>","tags":["administration","installation","vm","ubuntu"]},{"location":"janssen-server/install/vm-install/ubuntu/#ubuntu-2004","title":"Ubuntu 20.04","text":"<ul> <li> <p>Download the release package from the Github Janssen Project Releases</p> <pre><code>wget https://github.com/JanssenProject/jans/releases/download/nightly/jans_0.0.0-nightly.ubuntu20.04_amd64.deb -P /tmp\n</code></pre> </li> <li> <p>Go to <code>/tmp</code> directory:</p> Command<pre><code>cd /tmp\n</code></pre> </li> <li> <p>Verify integrity of the downloaded package by verifying published <code>sha256sum</code>.   </p> <ul> <li> <p>Go to the Janssen Project Releases page and copy the <code>sha256sum</code> value for the <code>jans_0.0.0-nightly.ubuntu20.04_amd64.deb</code> file:</p> </li> <li> <p>Replace <code>paste-release-sha256sum</code> in the command below with the actual checksum you copied from the release page, and run the following command: Command<pre><code>echo 'paste-release-sha256sum jans_0.0.0-nightly.ubuntu20.04_amd64.deb' | sed 's/^sha256://' &gt; jans_0.0.0-nightly.ubuntu20.04_amd64.deb.sha256sum &amp;&amp; sha256sum -c jans_0.0.0-nightly.ubuntu20.04_amd64.deb.sha256sum\n</code></pre></p> </li> </ul> <p>Output similar to below should confirm the integrity of the downloaded package.</p> Output<pre><code>jans_0.0.0-nightly.ubuntu20.04_amd64.deb: OK\n</code></pre> </li> <li> <p>Install the package</p> </li> </ul> Command<pre><code>sudo apt install  ./jans_0.0.0-nightly.ubuntu20.04_amd64.deb\n</code></pre>","tags":["administration","installation","vm","ubuntu"]},{"location":"janssen-server/install/vm-install/ubuntu/#run-the-setup-script","title":"Run the setup script","text":"<ul> <li>Run the setup script in interactive mode:</li> </ul> Command<pre><code>sudo python3 /opt/jans/jans-setup/setup.py\n</code></pre> <p>See more detailed instructions on the setup script if you're confused how to answer any of the questions, for details about command line arguments, or you would prefer to use a properties file instead of interactive mode.</p>","tags":["administration","installation","vm","ubuntu"]},{"location":"janssen-server/install/vm-install/ubuntu/#verify-the-installation","title":"Verify the Installation","text":"<p>After the successful completion of setup process, verify the system health.</p>","tags":["administration","installation","vm","ubuntu"]},{"location":"janssen-server/install/vm-install/ubuntu/#log-in-to-text-user-interface-tui","title":"Log in to Text User Interface (TUI)","text":"<p>Begin configuration by accessing the TUI with the following command:</p> Command<pre><code>jans tui\n</code></pre> <p>Full TUI documentation can be found here</p> <p>If you have selected casa during installation you can access casa using url <code>https://&lt;host&gt;/jans-casa</code></p>","tags":["administration","installation","vm","ubuntu"]},{"location":"janssen-server/install/vm-install/ubuntu/#lets-encrypt","title":"Let's Encrypt","text":"<p>To enable communication with Janssen Server over tls (https) in production environment, Janssen Server needs details about CA certificate.</p> <p>To generate Let\u2019s Encrypt CA certificate follow this let's encrypt.</p>","tags":["administration","installation","vm","ubuntu"]},{"location":"janssen-server/install/vm-install/ubuntu/#uninstall","title":"Uninstall","text":"<p>Uninstall process involves two steps and removes all the Janssen Server components.</p> <p>Note</p> <p>For removal of the attached persistence store, please refer to this note.</p> <ol> <li>Delete files installed by Janssen</li> <li>Remove and purge the <code>jans</code> package</li> </ol> <p>Use the command below to uninstall the Janssen server</p> Command<pre><code>sudo python3 /opt/jans/jans-setup/install.py -uninstall\n</code></pre> <p>You'll see the following confirmation:</p> Output<pre><code>This process is irreversible.\nYou will lose all data related to Janssen Server.\n\n\n\nAre you sure to uninstall Janssen Server? [yes/N] yes\n\nUninstalling Jannsen Server...\nRemoving /etc/default/jans-config-api\nStopping jans-config-api\nRemoving /etc/default/jans-scim\nStopping jans-scim\nRemoving /etc/default/jans-fido2\nStopping jans-fido2\nRemoving /etc/default/jans-auth\nStopping jans-auth\nRemoving /etc/default/jans-client-api\nStopping jans-client-api\nExecuting rm -r -f /etc/certs\nExecuting rm -r -f /etc/jans\nExecuting rm -r -f /opt/jans\nExecuting rm -r -f /opt/amazon-corretto*\nExecuting rm -r -f /opt/jre\nExecuting rm -r -f /opt/node*\nExecuting rm -r -f /opt/jetty*\nExecuting rm -r -f /opt/jython*\nExecuting rm -r -f /opt/dist\nRemoving /etc/apache2/sites-enabled/https_jans.conf\nRemoving /etc/apache2/sites-available/https_jans.conf\n</code></pre> <p>The command below removes and purges the <code>jans</code> package</p> Command<pre><code>apt-get --purge remove jans\n</code></pre> <p>Which should result in the following:</p> Output<pre><code>Reading package lists... Done\nBuilding dependency tree... Done\nReading state information... Done\nThe following packages were automatically installed and are no longer required:\n  apache2 apache2-bin apache2-data apache2-utils libapr1 libaprutil1 libaprutil1-dbd-sqlite3 libaprutil1-ldap liblua5.3-0 postgresql postgresql-contrib python3-pymysql python3-ruamel.yaml\n  python3-ruamel.yaml.clib\nUse 'apt autoremove' to remove them.\nThe following packages will be REMOVED:\n  jans*\n0 upgraded, 0 newly installed, 1 to remove and 2 not upgraded.\nAfter this operation, 1631 MB disk space will be freed.\nDo you want to continue? [Y/n] y\n(Reading database ... 166839 files and directories currently installed.)\nRemoving jans (0.0.0-nightly~ubuntu20.04) ...\nChecking to make sure service is down...\n</code></pre>","tags":["administration","installation","vm","ubuntu"]},{"location":"janssen-server/install/vm-install/vm-requirements/","title":"VM System Requirements","text":"<p>The Janssen Project currently provides packages for these Linux distros:</p>","tags":["requirements","installation","vm","hardware"]},{"location":"janssen-server/install/vm-install/vm-requirements/#supported-os-versions","title":"Supported OS Versions","text":"","tags":["requirements","installation","vm","hardware"]},{"location":"janssen-server/install/vm-install/vm-requirements/#ubuntu","title":"Ubuntu","text":"<ul> <li>Ubuntu 24.04</li> <li>Ubuntu 22.04</li> <li>Ubuntu 20.04</li> </ul>","tags":["requirements","installation","vm","hardware"]},{"location":"janssen-server/install/vm-install/vm-requirements/#rhel","title":"RHEL","text":"<ul> <li>Red Hat Enterprise Linux 8 (RHEL 8)</li> </ul>","tags":["requirements","installation","vm","hardware"]},{"location":"janssen-server/install/vm-install/vm-requirements/#suse","title":"SUSE","text":"<ul> <li>SUSE Linux Enterprise Server (SLES) 15</li> <li>openSUSE Leap 15.5</li> </ul>","tags":["requirements","installation","vm","hardware"]},{"location":"janssen-server/install/vm-install/vm-requirements/#hardware-requirements","title":"Hardware Requirements","text":"<p>A single-VM deployment is where all services are running on one server. Although, the requirements can vary based on the size of the data and the required concurrency, the following guidelines can help you plan:</p>","tags":["requirements","installation","vm","hardware"]},{"location":"janssen-server/install/vm-install/vm-requirements/#development-and-test-environments","title":"Development and Test Environments","text":"<ul> <li>8 GB RAM</li> <li>4 CPU</li> <li>20 GB Disk</li> </ul>","tags":["requirements","installation","vm","hardware"]},{"location":"janssen-server/install/vm-install/vm-requirements/#production-environment-recommendation","title":"Production Environment Recommendation:","text":"<ul> <li>8 GB RAM</li> <li>4 CPU</li> <li>4 GB swap space</li> <li>50 GB Disk</li> </ul>","tags":["requirements","installation","vm","hardware"]},{"location":"janssen-server/install/vm-install/vm-requirements/#port-configuration","title":"Port Configuration","text":"<p>Janssen Server requires the following ports to be open for incoming connections.</p> Port Protocol Notes 443 TCP TLS/HTTP <p>You may want to use a redirect on port 80 to 443, although it is not required. Of course you will also need some way to login to your server, but that is out of scope of these docs.</p> <p>Check your server firewall documentation to configure your firewall to allow <code>https</code>.</p>","tags":["requirements","installation","vm","hardware"]},{"location":"janssen-server/install/vm-install/vm-requirements/#hostname-ip-address-configuration","title":"Hostname / IP Address Configuration","text":"<p>It is recommended that you use a static ip address for your Janssen Server. Your server should also return the hostname for the <code>hostname</code> command, it's recommended that you add the hostname to the <code>/etc/hosts</code> file.</p>","tags":["requirements","installation","vm","hardware"]},{"location":"janssen-server/install/vm-install/vm-requirements/#file-descriptor-configuration-fd","title":"File Descriptor Configuration (FD)","text":"<p>Like most database and Internet servers, you must have at least 65k file descriptors. If you don't, your server will hang.</p> <p>First, check the current file descriptor limit using command below. If the existing FD limit exceeds 65535, then you're good.</p> <pre><code># cat /proc/sys/fs/file-max\n</code></pre> <p>If FD limit is less than 65535 (e.g. 1024), then follow the steps below to increase the value.</p> <p>1) Set soft and hard limits by adding the following lines in the <code>/etc/security/limits.conf</code> file</p> <pre><code>* soft nofile 65535\n* hard nofile 262144\n</code></pre> <p>2) Add the following lines to <code>/etc/pam.d/login</code> if not already present</p> <pre><code>session required pam_limits.so\n</code></pre> <p>3) Increase the FD limit in <code>/proc/sys/fs/file-max</code></p> <pre><code>echo 65535 &gt; /proc/sys/fs/file-max**\n</code></pre> <p>4) Use the <code>ulimit</code> command to set the FD limit to the hard limit specified in <code>/etc/security/limits.conf</code>. If setting to hard limit doesn't work, then try to set it to the soft limit.</p> <pre><code>ulimit -n 262144\n</code></pre> <p>5) Restart the system</p>","tags":["requirements","installation","vm","hardware"]},{"location":"janssen-server/kubernetes-ops/","title":"Kubernetes Operation Guide","text":"<p>This Operation guide helps you learn about the common operations for Janssen on Kubernetes.</p>","tags":["administration","kubernetes","operations"]},{"location":"janssen-server/kubernetes-ops/#prerequisite","title":"Prerequisite","text":"<ul> <li> <p>Review the Janssen components and architecture</p> </li> <li> <p>Complete the installation of Janssen on your desired Kubernetes provider.</p> </li> </ul>","tags":["administration","kubernetes","operations"]},{"location":"janssen-server/kubernetes-ops/#common-operations","title":"Common Operations","text":"<ul> <li>Upgrade</li> <li>Scaling</li> <li>Backup and Restore </li> <li>Certificate Management </li> <li>Customization </li> <li>Start Order </li> <li>Logs</li> <li>External Secrets and Configmaps</li> <li>Health Check</li> <li>TUI K8s</li> <li>Custom Attributes</li> <li>Shibboleth IDP</li> <li>Memory Dump</li> </ul>","tags":["administration","kubernetes","operations"]},{"location":"janssen-server/kubernetes-ops/backup-restore/","title":"Backup and Restore","text":"<p>The Jans Server should be backed up frequently, we recommend once daily.</p> <p>There are multiple methods for backing up jans server. One way is manually using imperative commands. The other is automatically using open source tools.</p>","tags":["administration","kubernetes","operations","backup","restore"]},{"location":"janssen-server/kubernetes-ops/backup-restore/#manual-backup-and-restore","title":"Manual Backup and Restore","text":"","tags":["administration","kubernetes","operations","backup","restore"]},{"location":"janssen-server/kubernetes-ops/backup-restore/#manual-backup","title":"Manual Backup","text":"<ol> <li> <p>Configmap backup: <pre><code>kubectl get configmap cn -n &lt;namespace&gt; -o yaml &gt; configmap-backup.yaml\n</code></pre></p> </li> <li> <p>Secret backup: <pre><code>kubectl get secret cn -n &lt;namespace&gt; -o yaml &gt; secret-backup.yaml\n</code></pre></p> </li> <li> <p>Get the user supplied values:</p> <p>Save the values.yaml that was used in the initial jans installation using helm.</p> <p>In the event that the user supplied or override values yaml was lost, you can obtain it by executing the following command: <pre><code>helm get values &lt;release name&gt; -n &lt;namespace&gt;\n</code></pre></p> </li> <li> <p>Keep note of installed chart version: <pre><code>helm list -n &lt;namespace&gt;\n</code></pre></p> </li> </ol> <p>Keep note of the chart version. For example: <code>0.0.0-nightly</code></p>","tags":["administration","kubernetes","operations","backup","restore"]},{"location":"janssen-server/kubernetes-ops/backup-restore/#manual-restore","title":"Manual Restore","text":"<ol> <li> <p>Create namespace <pre><code>kubectl create namespace &lt;namespace&gt;\n</code></pre></p> </li> <li> <p>Configmap restore: <pre><code>kubectl create -f configmap-backup.yaml\n</code></pre></p> </li> <li> <p>Secret restore: <pre><code>kubectl create -f secret-backup.yaml\n</code></pre></p> </li> <li> <p>Insall jans using the override or user supplied values with the same chart version:</p> </li> </ol> <pre><code>helm install &lt;release-name&gt; janssen/janssen -f values.yaml --version=&lt;0.0.0-nightly&gt; -n &lt;namespace&gt;\n</code></pre>","tags":["administration","kubernetes","operations","backup","restore"]},{"location":"janssen-server/kubernetes-ops/backup-restore/#automatic-backup-and-restore","title":"Automatic Backup and Restore","text":"<p>There are several tools that helps in automatic backups and restore, like Kasten K10.</p> <p>You can follow online guides to deploy it and use it to configure automatic backups.</p>","tags":["administration","kubernetes","operations","backup","restore"]},{"location":"janssen-server/kubernetes-ops/cert-management/","title":"Certificate Management","text":"<p>Rotating Certificates and Keys in Kubernetes setup</p> <p>Note</p> <p><code>janssen-config-cm</code> in all examples refer to jans installation configuration parameters where <code>janssen</code> is the <code>helm-release-name</code>.</p>","tags":["administration","kubernetes","operations","certificate management","certification and key rotation"]},{"location":"janssen-server/kubernetes-ops/cert-management/#web-ingress","title":"Web (Ingress)","text":"Associated certificates and keys /etc/certs/web_https.crt /etc/certs/web_https.key <p>Note</p> <p>During fresh installation, the config-job checks if SSL certificates and keys are mounted as files. If no mounted files are found, it attempts to download SSL certificates from the FQDN supplied. If the download is successful, an empty key file is generated. If no mounted or downloaded files are found, it generates self-signed SSL certificates, CA certificates, and keys.</p>","tags":["administration","kubernetes","operations","certificate management","certification and key rotation"]},{"location":"janssen-server/kubernetes-ops/cert-management/#rotate","title":"Rotate","text":"<ol> <li> <p>Create a file named <code>web-key-rotation.yaml</code> with the following contents :</p> <pre><code>apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: web-key-rotation\nspec:\n  template:\n    metadata:\n      annotations:\n        sidecar.istio.io/inject: \"false\"                  \n    spec:\n      restartPolicy: Never\n      containers:\n        - name: web-key-rotation\n          image: ghcr.io/janssenproject/jans/cloudtools:0.0.0-nightly-1\n          envFrom:\n          - configMapRef:\n              name: janssen-config-cm # This may be differnet in Helm\n          args: [\"certmanager\", \"patch\", \"web\", \"--opts\", \"valid-to:365\"]\n</code></pre> </li> <li> <p>Apply job       <pre><code>kubectl apply -f web-key-rotation.yaml -n &lt;jans-namespace&gt;\n</code></pre></p> </li> </ol>","tags":["administration","kubernetes","operations","certificate management","certification and key rotation"]},{"location":"janssen-server/kubernetes-ops/cert-management/#load-from-existing-source","title":"Load from existing source","text":"<p>Note</p> <p>This will load <code>web_https.crt</code> and <code>web_https.key</code> from <code>/etc/certs</code>.</p> <ol> <li> <p>Create a secret with <code>web_https.crt</code> and <code>web_https.key</code>. Note that this may already exist in your deployment.</p> <pre><code>kubectl create secret generic web-cert-key --from-file=web_https.crt --from-file=web_https.key -n &lt;jans-namespace&gt;\n</code></pre> </li> <li> <p>Create a file named <code>load-web-key-rotation.yaml</code> with the following contents :</p> <pre><code>apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: load-web-key-rotation\nspec:\n  template:\n    metadata:\n      annotations:\n        sidecar.istio.io/inject: \"false\"                  \n    spec:\n      restartPolicy: Never\n      volumes:\n      - name: web-cert\n        secret:\n          secretName: web-cert-key\n          items:\n            - key: web_https.crt\n              path: web_https.crt\n      - name: web-key\n        secret:\n          secretName: web-cert-key\n          items:\n            - key: web_https.key\n              path: web_https.key                              \n      containers:\n        - name: load-web-key-rotation\n          image: ghcr.io/janssenproject/jans/cloudtools:0.0.0-nightly-1\n          envFrom:\n          - configMapRef:\n              name: janssen-config-cm  #This may be differnet in Helm\n          volumeMounts:\n            - name: web-cert\n              mountPath: /etc/certs/web_https.crt\n              subPath: web_https.crt\n            - name: web-key\n              mountPath: /etc/certs/web_https.key\n              subPath: web_https.key\n          args: [\"certmanager\", \"patch\", \"web\", \"--opts\", \"source:from-files\"]\n</code></pre> </li> <li> <p>Apply job</p> </li> </ol> <pre><code>kubectl apply -f load-web-key-rotation.yaml -n &lt;jans-namespace&gt;\n</code></pre>","tags":["administration","kubernetes","operations","certificate management","certification and key rotation"]},{"location":"janssen-server/kubernetes-ops/cert-management/#auth-server","title":"Auth-server","text":"<p>Warning</p> <p>key rotation CronJob is usually installed with jans. Please make sure before deploying using <code>kubectl get cronjobs -n &lt;jans-namespace&gt;</code></p> Associated certificates and keys /etc/certs/auth-keys.json /etc/certs/auth-keys.jks <ol> <li> <p>Create a file named <code>auth-key-rotation.yaml</code> with the following contents :</p> <pre><code>kind: CronJob\napiVersion: batch/v1\nmetadata:\n  name: auth-key-rotation\nspec:\n  # runs the job every 48 hours\n  schedule: \"@every 48h\"\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      template:\n        metadata:\n          annotations:\n            sidecar.istio.io/inject: \"false\"\n        spec:\n          containers:\n            - name: auth-key-rotation\n              image: ghcr.io/janssenproject/jans/cloudtools:0.0.0-nightly-1\n              resources:\n                requests:\n                  memory: \"300Mi\"\n                  cpu: \"300m\"\n                limits:\n                  memory: \"300Mi\"\n                  cpu: \"300m\"\n              envFrom:\n                - configMapRef:\n                    name: janssen-config-cm\n              args: [\"certmanager\", \"patch\", \"auth\", \"--opts\", \"interval:48\", \"--opts\", \"key-strategy:OLDER\", \"--opts\", \"privkey-push-delay:300\", \"--opts\", \"privkey-push-strategy:NEWER\"]\n          restartPolicy: Never\n</code></pre> </li> <li> <p>Apply cron job</p> <pre><code>kubectl apply -f auth-key-rotation.yaml -n &lt;jans-namespace&gt;\n</code></pre> </li> </ol>","tags":["administration","kubernetes","operations","certificate management","certification and key rotation"]},{"location":"janssen-server/kubernetes-ops/custom-attributes/","title":"Custom Attributes","text":"<p>Making changes in the schema to add custom columns/attributes</p> <ol> <li> <p>Download the <code>custom_schema.json</code> file:</p> <p><code>wget https://raw.githubusercontent.com/JanssenProject/jans/main/jans-linux-setup/jans_setup/schema/custom_schema.json</code></p> </li> <li> <p>Make your edits in <code>custom_schema.json</code>:</p> <p>For example we will add 4 attributes and define them as int, json, bool, and text</p> <p>Firstly, add the attribute names to the object class: <pre><code>\"objectClasses\": [\n    {\n    \"kind\": \"AUXILIARY\",\n    \"may\": [\n        \"intAttribute\",\n        \"jsonAttribute\",\n        \"boolAttribute\",\n        \"textAttribute\"\n</code></pre></p> </li> <li> <p>Describe the attributes inside <code>attributeTypes</code>. You can refer to RFC 4517:</p> <pre><code>\"attributeTypes\": [\n    {\n    \"desc\": \"int desc\",\n    \"equality\": \"integerMatch\",\n    \"names\": [\n        \"intAttribute\"\n    ],\n    \"oid\": \"jansAttr\",\n    \"syntax\": \"1.3.6.1.4.1.1466.115.121.1.27\",\n    \"x_origin\": \"Jans created attribute\"\n    },\n\n{\n    \"desc\": \"json desc\",\n    \"equality\": \"caseIgnoreSubstringsMatch\",\n    \"names\": [\n        \"jsonAttribute\"\n    ],\n    \"multivalued\": true,\n    \"oid\": \"jansAttr\",\n    \"syntax\": \"1.3.6.1.4.1.1466.115.121.1.15\",\n    \"x_origin\": \"Jans created attribute\"\n    },\n\n{\n    \"desc\": \"bool desc\",\n    \"equality\": \"booleanMatch\",\n    \"names\": [\n        \"boolAttribute\"\n    ],\n    \"oid\": \"jansAttr\",\n    \"syntax\": \"1.3.6.1.4.1.1466.115.121.1.7\",\n    \"x_origin\": \"Jans created attribute\"\n    },\n\n    {\n        \"desc\": \"text desc\",\n        \"equality\": \"caseIgnoreMatch\",\n        \"names\": [\n        \"textAttribute\"\n        ],\n        \"oid\": \"jansAttr\",\n        \"syntax\": \"1.3.6.1.4.1.1466.115.121.1.15\",\n        \"x_origin\": \"Jans created attribute\"\n    }\n\n],\n</code></pre> </li> <li> <p>Create a configmap with the schema file:  </p> <p><code>kubectl create cm custom-schema-cm --from-file=custom_schema.json -n &lt;namespace&gt;</code></p> </li> <li> <p>Mount the configmap in your <code>override.yaml</code> under <code>persistence.volumes</code> and <code>persistence.volumeMounts</code>:</p> <pre><code>persistence:\n    volumeMounts:\n        - name: schema\n          mountPath: /app/schema/custom_schema.json\n          subPath: custom_schema.json\n    volumes:\n        - name: schema\n          configMap:\n            name: custom-schema-cm \n</code></pre> </li> <li> <p>Run helm install or helm upgrade if Jans has been already installed.</p> <pre><code>helm upgrade &lt;helm-release-name&gt; janssen/janssen -n &lt;namespace&gt; -f override.yaml --version=1.0.x\n</code></pre> </li> </ol>","tags":["administration","kubernetes","operations","custom attributes","schema","claim"]},{"location":"janssen-server/kubernetes-ops/customization/","title":"Customization","text":"<p>Most organizations will want to edit and customize the look and feel of public-facing <code>jans</code> server pages to match their own corporate branding. The following documentation provides the file locations of public facing pages, as well as instructions for adding custom HTML, CSS, and Javascript files to your <code>jans</code> server.</p> <p>All web pages are xhtml files.</p>","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#default-pages-bundled-in-the-jans-authwar-are","title":"Default pages bundled in the <code>jans-auth.war</code> are:","text":"<ul> <li>Login page: login.xhtml</li> <li>Authorization page: authorize.xhtml</li> <li>Logout page: logout.xhtml</li> <li>Error page: error.xhtml</li> </ul>","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#to-override-default-pages-listed-above","title":"To override default pages listed above:","text":"<p>Put a modified <code>login.xhtml</code> or <code>authorize.xhtml</code> or <code>error.xhtml</code> or <code>logout.xhtml</code> under <code>/opt/jans/jetty/jans-auth/custom/pages/</code></p>","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#directory-structure-for-customization","title":"Directory structure for customization","text":"<pre><code>/opt/jans/jetty/jans-auth/\n|-- custom\n|   |-- i18n (resource bundles)\n|   |-- libs (library files used by custom script)\n|   |-- pages (web pages)\n|   |-- static (images and css files)\n</code></pre>","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#adding-a-new-web-page-for-person-authentication-scripts","title":"Adding a new web page for Person Authentication scripts","text":"<ol> <li>If <code>enterOTP.xhtml</code> is your webpage for step 2 of authentication, place it under <code>/opt/jans/jetty/jans-auth/custom/pages/auth/enterOTP.xhtml</code></li> <li>Reference it in the custom script as follows: <pre><code>    def getPageForStep(self, configurationAttributes, step):\n        # Used to specify the page you want to return for a given step\n        if (step == 1):\n          return \"/auth/login.xhtml\"\n        if (step == 2)\n          return \"/auth/enterOTP.xhtml\"\n</code></pre></li> </ol>","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#reference-login-pages","title":"Reference login pages","text":"<p>Here you will find several login pages for different authentication methods.</p>","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#customized-resource-bundles","title":"Customized resource bundles","text":"<ol> <li> <p>Resource bundles that are present in the jans-auth.war are present in this folder</p> </li> <li> <p>To override the defaults, custom <code>.properties</code> files should be placed in the following file under this path : <code>/opt/jans/jetty/jans-auth/custom/i18n/jans-auth.properties</code> Resource bundle names to support other languages should be placed under the same folder <code>/opt/jans/jetty/jans-auth/custom/i18n/</code>. Some examples of file names are :</p> <ul> <li>jans-auth_en.properties</li> <li>jans-auth_bg.properties</li> <li>jans-auth_de.properties</li> <li>jans-auth_es.properties</li> <li>jans-auth_fr.properties</li> <li>jans-auth_it.properties</li> <li>jans-auth_ru.properties</li> <li>jans-auth_tr.properties</li> </ul> </li> <li> <p>To add translation for a language that is not yet supported, create new properties file in resource folder and name it jans-auth_[language_code].properties, then add language code as supported-locale to the faces-config.xml present in the same folder.</p> </li> </ol>","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#custom-css-files","title":"Custom CSS files","text":"<ol> <li>Place the file in <code>/opt/jans/jetty/jans-auth/custom/static/stylesheet/theme.css</code></li> <li>Reference it in .xhtml file using the URL <code>https://your.jans.server/jans-auth/ext/resources/stylesheet/theme.css</code> or <code>/jans-auth/ext/resources/stylesheet/theme.css</code></li> </ol>","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#custom-image-files","title":"Custom image files","text":"<ol> <li>All images should be placed under <code>/opt/jans/jetty/jans-auth/custom/static/img</code></li> <li>Reference it in .xhtml file using the URL <code>https://your.jans.server/jans-auth/ext/resources/img/fileName.png</code> or <code>/jans-auth/ext/resources/img/fileName.jpg</code></li> </ol>","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#page-layout-header-footer-xhtml-template-customization","title":"Page layout, header, footer (xhtml Template) customization","text":"<p>Templates refers to the common interface layout and style. For example, a banner, logo in common header and copyright information in footer.</p> <ol> <li>All templates should be placed under <code>/opt/jans/jetty/jans-auth/custom/pages/WEB-INF/incl/layout/</code> </li> <li>Place a modified <code>template.xhtml</code> in the above location which will override the default template file from the war</li> </ol>","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#custom-jar-file-for-scripts","title":"Custom Jar file for scripts","text":"","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#for-jars-less-than-1mb","title":"for JARs less than 1MB","text":"<ol> <li> <p>Create a configmap with the custom jar file:      <code>kubectl -n &lt;namespace&gt; create cm my-custom-jar --from-file=mycustom.jar</code></p> </li> <li> <p>Mount the configmap in your values.yaml under <code>auth-server.volumes</code> and <code>auth-server.volumeMounts</code></p> <pre><code>auth-server:\n  volumeMounts:\n    - name: my-custom-jar-volume\n      mountPath: /opt/jans/jetty/jans-auth/custom/libs/mycustom.jar\n      subPath: mycustom.jar\n  volumes:\n    - name: my-custom-jar-volume\n      configMap:\n        name: my-custom-jar\n</code></pre> </li> <li> <p>Run helm install or helm upgrade if Jans has been already installed.     <pre><code>helm upgrade &lt;helm-release-name&gt; janssen/janssen -n &lt;namespace&gt; -f values.yaml --version=1.0.x\n</code></pre></p> </li> </ol>","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#for-jars-greater-than-1mb","title":"For JARs greater than 1MB","text":"<ol> <li> <p>Create a configmap or secret for a shell script that contains instructions to pull the custom jar file:</p> <p><pre><code>#!/bin/sh\n# This script will pull the custom jar file from a remote location\n# and place it in the correct location for the Jans Auth server to use it\nwget -O /opt/jans/jetty/jans-auth/custom/libs/mycustom.jar https://mydomain.com/mycustom.jar\n</code></pre> <code>kubectl -n &lt;namespace&gt; create cm my-custom-jar --from-file=mycustomjar.sh</code></p> </li> <li> <p>Mount the configmap or secret in your values.yaml under <code>auth-server.volumes</code> and <code>auth-server.volumeMounts</code></p> <pre><code>auth-server:\n  volumeMounts:\n    - name: my-custom-jar-volume\n      mountPath: /tmp/mycustomjar.sh\n      subPath: mycustomjar.sh\n  volumes:\n    - name: my-custom-jar-volume\n      configMap:\n        name: my-custom-jar\n        defaultMode: 0755\n  customScripts:\n    - /tmp/mycustomjar.sh\n</code></pre> </li> <li> <p>Run helm install or helm upgrade if Jans has been already installed.     <pre><code>helm upgrade &lt;helm-release-name&gt; janssen/janssen -n &lt;namespace&gt; -f values.yaml --version=1.0.x\n</code></pre></p> </li> </ol>","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#customized-pages-examples","title":"Customized pages examples","text":"","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#custom-login-page","title":"Custom Login page","text":"<p>This guide will demonstrate how to customize the html and css of the default login page.</p> <p>Here's a screenshot of the default login page.</p> <p></p> <p>As an example, we will add text to the top of the form and change the color of the button using the following steps:</p> <ol> <li> <p>Locate the directory that contains exploded auth-server WAR</p> <pre><code>kubectl exec -n &lt;namespace&gt; &lt;auth-server-pod-name&gt; -- ls /opt/jetty/temp\n</code></pre> <p>Output example:</p> <pre><code>jetty-0_0_0_0-8080-jans-auth_war-_jans-auth-any-15449359106458251753\n</code></pre> </li> <li> <p>Get the <code>login.xhtml</code> from the auth-server pod:</p> <pre><code>kubectl -n jans cp &lt;auth-server-pod-name&gt;:opt/jetty/temp/jetty-0_0_0_0-8080-jans-auth_war-_jans-auth-any-15449359106458251753/webapp/login.xhtml login.xhtml\n</code></pre> <p>Modify the file locally:</p> <pre><code>&lt;h:form\n    id=\"loginForm\"\n  class=\"bg-highlight position-relative d-flex flex-column align-items-center justify-content-center\"\n  style=\"height: 100vh; gap: 2rem\"\n  &gt;\n&lt;!-- customization --&gt;\n&lt;div class=\"row\"&gt;&lt;p id=\"creds-title\"&gt;Enter Credentials&lt;/p&gt;&lt;/div&gt;\n&lt;!-- end of customization --&gt;\n</code></pre> </li> <li> <p>Get the <code>login-template.xhtml</code> from the auth-server pod:     <pre><code>kubectl -n jans cp &lt;auth-server-pod-name&gt;:opt/jetty/temp/jetty-0_0_0_0-8080-jans-auth_war-_jans-auth-any-15449359106458251753/webapp/WEB-INF/incl/layout/login-template.xhtml login-template.xhtml\n</code></pre>     Modify the file locally:</p> <pre><code>&lt;h:head&gt;\n    &lt;link type=\"text/css\" rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css?family=Open+Sans:300,400,600\" /&gt;\n    &lt;!-- customization --&gt;\n    &lt;link rel=\"stylesheet\" href=\"/jans-auth/ext/resources/stylesheet/custom.css\" /&gt;\n    &lt;!-- end of customization --&gt;\n&lt;/h:head&gt;\n</code></pre> </li> <li> <p>Copy the following text and save it as <code>custom.css</code>:</p> <pre><code>  #creds-title {\n    font-style: italic;\n    font-weight: bolder;\n    color: white;\n    font-size: 2em;\n  }\n</code></pre> </li> <li> <p>Create <code>configmaps</code> to store the content of <code>login.xhtml</code>, <code>login-template.xhtml</code> and <code>custom.css</code>.</p> <pre><code>kubectl -n &lt;namespace&gt; create cm auth-server-custom-html --from-file=login.xhtml\nkubectl -n &lt;namespace&gt; create cm auth-server-custom-layout-html --from-file=login-template.xhtml\nkubectl -n &lt;namespace&gt; create cm auth-server-custom-css --from-file=custom.css\n</code></pre> </li> <li> <p>Mount the <code>configmaps</code> in your <code>values.yaml</code> under <code>auth-server.volumes</code> and <code>auth-server.volumeMounts</code>:</p> <pre><code>auth-server:\n  volumeMounts:\n    - name: auth-server-pages-volume\n      mountPath: /opt/jans/jetty/jans-auth/custom/pages # login.xthml will be mounted under this directory\n    - name: auth-server-layout-volume\n      mountPath: /opt/jans/jetty/jans-auth/custom/pages/WEB-INF/incl/layout # login-template.xthml will be mounted under this directory\n    - name: auth-server-static-volume\n      mountPath: /tmp/static #custom.css will be mounted in the temporary location\n  lifecycle:\n    postStart:\n      exec:\n        command: [ \"sh\", \"-c\", \"mkdir /opt/jans/jetty/jans-auth/custom/static/stylesheet/ &amp;&amp; cp /tmp/static/custom.css /opt/jans/jetty/jans-auth/custom/static/stylesheet/\"] # custom.css will be copied from the temporary to the desired location\n  volumes:\n    - name: auth-server-pages-volume\n      configMap:\n        name: auth-server-custom-html\n    - name: auth-server-layout-volume\n      configMap:\n        name: auth-server-custom-layout-html\n    - name: auth-server-static-volume\n      configMap:\n        name: auth-server-custom-css\n</code></pre> </li> <li> <p>Run helm install or helm upgrade if Jans has been already installed.</p> <pre><code>helm upgrade &lt;helm-release-name&gt; janssen/janssen -n &lt;namespace&gt; -f values.yaml --version=1.0.x\n</code></pre> </li> </ol> <p>Here's a screenshot of the customized login page.</p> <p></p>","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#custom-device-code-page","title":"Custom Device-code page","text":"<p>This guide will demonstrate how to customize the html and css of the device-code page.</p> <p>Here's a screenshot of the device-code page.</p> <p></p> <p>As an example, we will change the color of the button to blue using the following steps:</p> <ol> <li> <p>Locate the directory that contains exploded auth-server WAR</p> <pre><code>kubectl exec -n &lt;namespace&gt; &lt;auth-server-pod-name&gt; -- ls /opt/jetty/temp\n</code></pre> <p>Output example:</p> <pre><code>jetty-0_0_0_0-8080-jans-auth_war-_jans-auth-any-15449359106458251753\n</code></pre> </li> <li> <p>Get the <code>device_authorization.xhtml</code> from the auth-server pod:</p> <pre><code>kubectl -n jans cp &lt;auth-server-pod-name&gt;:opt/jetty/temp/jetty-0_0_0_0-8080-jans-auth_war-_jans-auth-any-15449359106458251753/webapp/device_authorization.xhtml device_authorization.xhtml\n</code></pre> <p>Modify the file locally:</p> <pre><code>&lt;div class=\"device-authz-button\"&gt;\n    &lt;div style=\"width: 100%\"&gt;\n&lt;!-- customization --&gt;        \n    &lt;div style=\"text-align: center;\"&gt;\n    &lt;h:commandButton id=\"continueButton\"\n                    style=\"background-color: red; color: white;\" value=\"#{msgs['device.authorization.confirm.button']}\"\n                    iconAwesome=\"fa-sign-in\"&gt;\n        &lt;f:ajax execute=\"@form\" render=\"@form messages\" listener=\"#{deviceAuthorizationAction.processUserCodeVerification}\" /&gt;\n    &lt;/h:commandButton&gt;\n    &lt;/div&gt;\n&lt;!-- end of customization --&gt;                                               \n</code></pre> </li> <li> <p>Create a configmap to store the content of <code>device_authorization.xhtml</code>.</p> <pre><code>kubectl -n &lt;namespace&gt; create cm device-code-custom-html --from-file=device_authorization.xhtml\n</code></pre> </li> <li> <p>Mount the <code>configmap</code> in your <code>values.yaml</code> under <code>auth-server.volumes</code> and <code>auth-server.volumeMounts</code>:</p> <pre><code>auth-server:\n  volumeMounts:\n    - name: device-code-pages-volume\n      mountPath: /opt/jans/jetty/jans-auth/custom/pages # device_authorization.xthml will be mounted under this directory\n  volumes:\n    - name: device-code-pages-volume\n      configMap:\n        name: device-code-custom-html\n</code></pre> </li> <li> <p>Run helm install or helm upgrade if Jans has been already installed.</p> <pre><code>helm upgrade &lt;helm-release-name&gt; janssen/janssen -n &lt;namespace&gt; -f values.yaml --version=1.0.x\n</code></pre> </li> </ol> <p>Here's a screenshot of the customized device-code page.</p> <p></p>","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/customization/#custom-error-page","title":"Custom Error page","text":"<p>This guide will demonstrate how to customize the html and css of the error page.</p> <p>Here's a screenshot of the default Error page.</p> <p></p> <p>As an example, we will change the color of the text at the top of the error page:</p> <ol> <li> <p>Locate the directory that contains exploded auth-server WAR</p> <pre><code>kubectl exec -n &lt;namespace&gt; &lt;auth-server-pod-name&gt; -- ls /opt/jetty/temp\n</code></pre> <p>Output example:</p> <pre><code>jetty-0_0_0_0-8080-jans-auth_war-_jans-auth-any-15449359106458251753\n</code></pre> </li> <li> <p>Get the <code>error.xhtml</code> from the auth-server pod:</p> <pre><code>kubectl -n jans cp &lt;auth-server-pod-name&gt;:opt/jetty/temp/jetty-0_0_0_0-8080-jans-auth_war-_jans-auth-any-15449359106458251753/webapp/error.xhtml error.xhtml\n</code></pre> <p>Modify the file locally:</p> <pre><code>&lt;div class=\"section\"&gt;\n   &lt;!-- customization --&gt;\n  &lt;h1\n    style=\"color: red; font-size: 3em; font-weight: bold; font-family: Arial\"&gt;\n    OOPS&lt;/h1&gt;\n  &lt;!-- end of customization --&gt;\n&lt;/div&gt;\n</code></pre> </li> <li> <p>Create a configmap to store the content of <code>error.xhtml</code>.</p> <pre><code>kubectl -n &lt;namespace&gt; create cm error-custom-html --from-file=error.xhtml\n</code></pre> </li> <li> <p>Mount the <code>configmap</code> in your <code>values.yaml</code> under <code>auth-server.volumes</code> and <code>auth-server.volumeMounts</code>:</p> <pre><code>auth-server:\n  volumeMounts:\n    - name: error-pages-volume\n      mountPath: /opt/jans/jetty/jans-auth/custom/pages # error.xthml will be mounted under this directory\n  volumes:\n    - name: error-pages-volume\n      configMap:\n        name: error-custom-html\n</code></pre> </li> <li> <p>Run helm install or helm upgrade if Jans has been already installed.</p> <pre><code>helm upgrade &lt;helm-release-name&gt; janssen/janssen -n &lt;namespace&gt; -f values.yaml --version=1.0.x\n</code></pre> </li> </ol> <p>Here's a screenshot of the customized error page.</p> <p></p>","tags":["administration","developer","operations","kubernetes","customization"]},{"location":"janssen-server/kubernetes-ops/external-secrets-configmaps/","title":"External Secrets and Configmaps","text":"<p>This guide shows how to store and retrieve jans <code>configmaps</code> and <code>secrets</code> externally in <code>AWS Secrets Manager</code>, <code>GCP Secret Manager</code> and <code>Vault</code>.</p> <p>Note</p> <p>Configmaps and Secrets are stored as a collection of key-value pairs. A secret in AWS/GCP Secret Manager has a max size of 65536 bytes. So the collection of key-value pairs is splitted between secrets, and thus note that during secrets retrieval it's possible that a single key-value pair is to be splitted between 2 AWS/GCP secrets.</p>","tags":["administration","kubernetes","configmaps","secrets"]},{"location":"janssen-server/kubernetes-ops/external-secrets-configmaps/#create-secrets","title":"Create Secrets","text":"","tags":["administration","kubernetes","configmaps","secrets"]},{"location":"janssen-server/kubernetes-ops/external-secrets-configmaps/#aws","title":"AWS","text":"<p>There are 2 types of Secrets in AWS:</p> <ol> <li> <p><code>String Secret</code> where the secret can be created and retrieved from the console.</p> </li> <li> <p><code>Binary Secret</code> where the secret is binary-encoded and can be created and retrieved only using the CLI/SDK.</p> </li> </ol> <p><code>Configmaps</code> are stored in a single <code>String Secret</code>. It follows the naming convention of <code>janssen_configs</code></p> <p><code>Secrets</code> are splitted and stored in multiple <code>Binary Secrets</code> due to the max size limitation.</p> <ul> <li> <p><code>Secrets</code> follows the naming convention of <code>janssen_secrets</code>, <code>janssen_secrets_1</code>, <code>janssen_secrets_2</code>..etc</p> </li> <li> <p>Every single secret doesn't have to be a valid json, but instead the collection of all secrets should have a valid json. For example: </p> <p><code>janssen_secrets</code>: {\"key1\":\"value1\",</p> <p><code>janssen_secrets_1</code>: \"key2\":\"value2\",</p> <p><code>janssen_secrets_2</code>: \"key3\":\"value3\"}</p> </li> </ul>","tags":["administration","kubernetes","configmaps","secrets"]},{"location":"janssen-server/kubernetes-ops/external-secrets-configmaps/#fresh-installation","title":"Fresh Installation","text":"<p>You will need the <code>ACCESS_KEY_ID</code> and <code>SECRET_ACCESS_KEY</code> of an IAM user with a <code>SecretsManagerReadWrite</code> policy attached.</p> <p>Add the following configuration to your <code>override.yaml</code>: <pre><code>global:\n    configAdapterName: aws\n    configSecretAdapter: aws \nconfig:\n  configmap:\n    cnAwsAccessKeyId: L30E10OME18S1220S221\n    cnAwsSecretAccessKey: Z1A1M9A1L1EKALIeHHN~o\n    cnAwsDefaultRegion: us-east-1 #Choose based on the desired region\n    cnAwsSecretsEndpointUrl: https://secretsmanager.us-east-1.amazonaws.com #Choose based on the desired region\n    cnAwsSecretsNamePrefix: janssen\n    cnAwsProfile: janssen #Choose based on your aws named profile \n    cnAwsSecretsReplicaRegions: [] #Optional if you want secrets to be replicated. [{\"Region\": \"us-west-1\"}, {\"Region\": \"us-west-2\"}]\n</code></pre></p> <p>Run <code>helm install</code> or <code>helm upgrade</code> if <code>Janssen</code> is already installed:</p> <pre><code>helm upgrade &lt;helm-release-name&gt; janssen/janssen -f override.yaml -n &lt;namespace&gt;\n</code></pre>","tags":["administration","kubernetes","configmaps","secrets"]},{"location":"janssen-server/kubernetes-ops/external-secrets-configmaps/#exportmigration","title":"Export/Migration","text":"","tags":["administration","kubernetes","configmaps","secrets"]},{"location":"janssen-server/kubernetes-ops/external-secrets-configmaps/#configmaps","title":"Configmaps","text":"<ul> <li> <p>Get the json of the configmap   <pre><code>kubectl get configmap -n &lt;namespace&gt; cn -o json \n</code></pre></p> </li> <li> <p>Configmaps in AWS are stored as <code>StringSecret</code>, they can be created and retrieved from the console:   Click <code>Create Secret</code> &gt; Choose <code>Other type of Secret</code> &gt; Click on <code>Plaintext</code> tab &gt; Paste the <code>json</code> of the key-value pairs.</p> </li> </ul>","tags":["administration","kubernetes","configmaps","secrets"]},{"location":"janssen-server/kubernetes-ops/external-secrets-configmaps/#secrets","title":"Secrets","text":"<ul> <li> <p>Get the json of the secret   <pre><code>kubectl get secret -n &lt;namespace&gt; cn -o json \n</code></pre></p> </li> <li> <p>Secrets in AWS are splitted across multiple <code>BinarySecrets</code> which is created and retrieved using the CLI/SDK</p> </li> <li> <p>Assuming the json is stored in a file named <code>binary-secrets.json</code>:   <pre><code>aws secretsmanager create-secret --name &lt;secret-name&gt; --secret-binary fileb://binary-secrets.json --region &lt;secret-region&gt;\n</code></pre></p> </li> </ul>","tags":["administration","kubernetes","configmaps","secrets"]},{"location":"janssen-server/kubernetes-ops/external-secrets-configmaps/#gcp","title":"GCP","text":"","tags":["administration","kubernetes","configmaps","secrets"]},{"location":"janssen-server/kubernetes-ops/external-secrets-configmaps/#fresh-installation_1","title":"Fresh Installation","text":"<p>Make sure you enabled <code>Secret Manager API</code>.</p> <p>You will need a <code>Service account</code> with the <code>roles/secretmanager.admin</code> role. This service account json should then be <code>base64</code> encoded.</p> <p>Add the following configuration to your <code>override.yaml</code>: <pre><code>global:\n  configAdapterName: google\n  configSecretAdapter: google \nconfig:\n  configmap:\n    cnGoogleSecretManagerServiceAccount: SWFtTm90YVNlcnZpY2VBY2NvdW50Q2hhbmdlTWV0b09uZQo= #base64 encoded service account json\n    cnGoogleProjectId: google-project-to-save-config-and-secrets-to\n    cnSecretGoogleSecretVersionId: \"latest\" # Secret version to be used for secret configuration. Defaults to latest and should normally always stay that way. \n    cnSecretGoogleSecretNamePrefix: janssen\n    cnGoogleSecretManagerPassPhrase: Test1234# #Passphrase for Janssen secret in Google Secret Manager. Used for encrypting and decrypting data from Google's Secret Manager. \n    cnConfigGoogleSecretVersionId: \"latest\" #Secret version to be used for configuration. Defaults to latest and should normally always stay that way.\n    cnConfigGoogleSecretNamePrefix: janssen\n</code></pre></p> <p>Run <code>helm install</code> or <code>helm upgrade</code> if <code>Janssen</code> is already installed:</p> <pre><code>helm upgrade &lt;helm-release-name&gt; janssen/janssen -f override.yaml -n &lt;namespace&gt;\n</code></pre>","tags":["administration","kubernetes","configmaps","secrets"]},{"location":"janssen-server/kubernetes-ops/external-secrets-configmaps/#exportmigration_1","title":"Export/Migration","text":"<p>Get the json of the secret/configmap <pre><code>kubectl get configmap -n &lt;namespace&gt; cn -o json \n</code></pre></p> <p>From the console, Go to <code>Secret Manager</code>&gt; Click on <code>Create Secret</code> &gt; Add a <code>name</code> &gt; Upload a <code>json</code> file or add the json to the <code>Secret value</code> field &gt; Create</p>","tags":["administration","kubernetes","configmaps","secrets"]},{"location":"janssen-server/kubernetes-ops/external-secrets-configmaps/#managing-versions","title":"Managing Versions","text":"<p>While there's no limitation on how many versions a secret can have, the recommendation is to keep the number as low as possible, e.g. 5 active versions. If there are too many secret versions, it's best to destroy older versions manually, for example:</p> <pre><code>gcloud secrets versions list jans-secret --filter=\"state = enabled\" --filter=\"createTime &lt; '2024-03-02'\" | grep \"NAME:\" | tr -d \"NAME: \" &gt; versions_to_destroy.txt\nwhile read -r line; do\n  gcloud secrets versions destroy \"$line\" --secret=jans-secret\ndone &lt; \"versions_to_destroy.txt\"\n</code></pre>","tags":["administration","kubernetes","configmaps","secrets"]},{"location":"janssen-server/kubernetes-ops/external-secrets-configmaps/#vault","title":"Vault","text":"<p>Note</p> <p>The deployment of Vault is hosted on-premises, not within the HashiCorp Cloud Platform service</p> <ol> <li> <p>Enable the KV secrets engine version 1 in Vault. For example:     <code>vault secrets enable -path=secret -version=1 kv</code></p> <p>Note that the <code>path</code> i.e. <code>secret</code> will be mapped to <code>cnVaultKvPath</code> later.</p> </li> <li> <p>Create a <code>policy</code>, which will be attached later to the <code>appRole</code>.</p> <p>Create first a file named <code>policy.hcl</code> with the required capabilities. <pre><code>path \"secret/&lt;name&gt;/*\" {\n capabilities = [\"create\", \"list\", \"read\", \"delete\", \"update\"]\n}  \n</code></pre></p> <p>Note that <code>&lt;name&gt;</code> will be mapped to <code>cnVaultPrefix</code> later.</p> <p>Create the policy: <code>vault policy write &lt;name&gt; /path/to/policy.hcl</code></p> </li> <li> <p>Enable and configure appRole. You have also to reference the previously created policy. For example:     <pre><code>vault auth enable -path=approle approle\nvault write auth/approle/role/&lt;role-name&gt; token_policies=\"&lt;policy-name&gt;\"\n</code></pre></p> <p>The default appRole path is <code>approle</code> which will be mapped to <code>cnVaultAppRolePath</code> later.</p> </li> <li> <p>Add the following configuration to your <code>override.yaml</code>:</p> <p><pre><code>global:\n  configSecretAdapter: vault\nconfig:\n  configmap:  \n    # -- Vault AppRole RoleID.\n    cnVaultRoleId: \"\"\n    # -- Vault AppRole SecretID.\n    cnVaultSecretId: \"\"\n    # -- Base URL of Vault.\n    cnVaultAddr: http://localhost:8200\n    # -- Verify connection to Vault.\n    cnVaultVerify: false\n    # -- Path to file contains Vault AppRole role ID.\n    cnVaultRoleIdFile: /etc/certs/vault_role_id\n    # -- Path to file contains Vault AppRole secret ID.\n    cnVaultSecretIdFile: /etc/certs/vault_secret_id\n    # -- Vault namespace used to access the secrets.\n    cnVaultNamespace: \"\"\n    # -- Path to Vault KV secrets engine.\n    cnVaultKvPath: secret\n    # -- Base prefix name used to access secrets.\n    cnVaultPrefix: jans\n    # -- Path to Vault AppRole.\n    cnVaultAppRolePath: approle\n</code></pre> 5.  Run <code>helm install</code> or <code>helm upgrade</code></p> </li> </ol>","tags":["administration","kubernetes","configmaps","secrets"]},{"location":"janssen-server/kubernetes-ops/external-secrets-configmaps/#retrieve-secrets","title":"Retrieve Secrets","text":"","tags":["administration","kubernetes","configmaps","secrets"]},{"location":"janssen-server/kubernetes-ops/external-secrets-configmaps/#aws_1","title":"AWS","text":"<p>String Secret: To retrieve the secret value from the Console, click on the secret name and then click on <code>Retrieve Secret Value</code></p> <p>Binary Secret: To retrieve the secret value using the cli <pre><code>aws secretsmanager get-secret-value --secret-id &lt;secret-name&gt; --query 'SecretBinary' --output text --region &lt;secret-region&gt;\n</code></pre></p> <p>Note that the secret is binary encoded, so in order to have a decoded value, you can run the following <pre><code>aws secretsmanager get-secret-value --secret-id &lt;secret-name&gt; --query 'SecretBinary' --output text --region &lt;secret-region&gt; | base64 --decode\n</code></pre></p> <p>Repeat these commands across all the secrets, to get the full key-value pairs.</p>","tags":["administration","kubernetes","configmaps","secrets"]},{"location":"janssen-server/kubernetes-ops/external-secrets-configmaps/#gcp_1","title":"GCP","text":"<p>Review this to check multiple ways to retrieve secrets stored in GCP Secret Manager.</p>","tags":["administration","kubernetes","configmaps","secrets"]},{"location":"janssen-server/kubernetes-ops/health-check/","title":"Health Check","text":"<p>Health checks are used to determine if a container is working as it should or not. This is done in Kubernetes using probes.</p> <p>Jans deployed components uses two types of probes:</p> <ol> <li> <p>Readiness probes: used to know when a container is ready to start accepting traffic</p> </li> <li> <p>Liveness probes: used to know when to restart a container</p> </li> </ol>","tags":["administration","kubernetes","operations","health-checks"]},{"location":"janssen-server/kubernetes-ops/health-check/#jans-liveness-and-readiness-probes","title":"Jans Liveness and Readiness probes","text":"<p>Here is a list of the liveness and readiness probes of the deployed jans components</p>","tags":["administration","kubernetes","operations","health-checks"]},{"location":"janssen-server/kubernetes-ops/health-check/#auth-server","title":"auth-server","text":"<p>Auth-sever executes the python3 healthcheck.py in liveness and readiness probes. This python scripts parses the healthcheck endpoint to make sure the status is up.</p> <pre><code>  livenessProbe:\n  # Executes the python3 healthcheck.\n    exec:\n      command:\n        - python3\n        - /app/scripts/healthcheck.py\n    # Configure the liveness healthcheck for the auth-server if needed.    \n    initialDelaySeconds: 30\n    periodSeconds: 30\n    timeoutSeconds: 5\n  readinessProbe:\n  # Executes the python3 healthcheck.\n    exec:\n      command:\n        - python3\n        - /app/scripts/healthcheck.py\n    # Configure the readiness healthcheck for the auth-server if needed.    \n    initialDelaySeconds: 25\n    periodSeconds: 25\n    timeoutSeconds: 5\n</code></pre>","tags":["administration","kubernetes","operations","health-checks"]},{"location":"janssen-server/kubernetes-ops/health-check/#config-api","title":"config-api","text":"<p>The health check of liveness and readiness probes is a HTTP GET request against a config-api endpoint</p> <pre><code>  livenessProbe:\n    # http liveness probe endpoint\n    httpGet:\n      path: /jans-config-api/api/v1/health/live\n      port: 8074\n    # Configure the liveness healthcheck for the config-api if needed.\n    initialDelaySeconds: 30\n    periodSeconds: 30\n    timeoutSeconds: 5\n  readinessProbe:\n    # http readiness probe endpoint\n    httpGet:\n      path: jans-config-api/api/v1/health/ready\n      port: 8074\n    # Configure the readiness healthcheck for the config-api if needed.\n    initialDelaySeconds: 25\n    periodSeconds: 25\n    timeoutSeconds: 5\n</code></pre>","tags":["administration","kubernetes","operations","health-checks"]},{"location":"janssen-server/kubernetes-ops/health-check/#fido2","title":"fido2","text":"<p>The health check of liveness and readiness probes is a HTTP GET request against a fido2 endpoint</p> <pre><code>  livenessProbe:\n    # http liveness probe endpoint\n    httpGet:\n      path: /jans-fido2/sys/health-check\n      port: http-fido2\n    # Configure the liveness healthcheck for the fido2 if needed.\n    initialDelaySeconds: 25\n    periodSeconds: 25\n    timeoutSeconds: 5\n  readinessProbe:\n    # http readiness probe endpoint\n    httpGet:\n      path: /jans-fido2/sys/health-check\n      port: http-fido2\n    # Configure the readiness healthcheck for the fido2 if needed.\n    initialDelaySeconds: 30\n    periodSeconds: 30\n    timeoutSeconds: 5\n</code></pre>","tags":["administration","kubernetes","operations","health-checks"]},{"location":"janssen-server/kubernetes-ops/health-check/#scim","title":"scim","text":"<p>The health check of liveness and readiness probes is a HTTP GET request against a scim endpoint</p> <pre><code>  livenessProbe:\n    httpGet:\n      # http liveness probe endpoint\n      path: /jans-scim/sys/health-check\n      port: 8080\n    # Configure the liveness healthcheck for the SCIM if needed.  \n    initialDelaySeconds: 30\n    periodSeconds: 30\n    timeoutSeconds: 5\n  readinessProbe:\n    httpGet:\n      # http readiness probe endpoint\n      path: /jans-scim/sys/health-check\n      port: 8080\n    # Configure the readiness healthcheck for the SCIM if needed.  \n    initialDelaySeconds: 25\n    periodSeconds: 25\n    timeoutSeconds: 5\n</code></pre>","tags":["administration","kubernetes","operations","health-checks"]},{"location":"janssen-server/kubernetes-ops/logs/","title":"Logs","text":"<p>The Janssen logs can be viewed using the following command:</p> <pre><code>kubectl logs &lt;pod-name&gt; -n &lt;namespace&gt; \n</code></pre>","tags":["administration","kubernetes","operations","logs"]},{"location":"janssen-server/kubernetes-ops/logs/#log-levels","title":"Log Levels","text":"<p>The following log levels can be configured through the configuration CLI:</p> Log Level Messages Logged Trace All messages Debug Debug level and above Info Informational level and above Warn Warning level and above Error Error level and above Fatal Only fatal errors Off Logging is disabled","tags":["administration","kubernetes","operations","logs"]},{"location":"janssen-server/kubernetes-ops/logs/#configuring-log-levels","title":"Configuring Log Levels","text":"<p>To get the current log level of any component, run the following command:</p> <pre><code>kubectl get configmap -n &lt;namespace&gt; &lt;helm-release-name&gt;-config-cm -o yaml | grep CN_&lt;service-name&gt;_APP_LOGGERS\n</code></pre>","tags":["administration","kubernetes","operations","logs"]},{"location":"janssen-server/kubernetes-ops/logs/#auth-server","title":"auth-server","text":"<p>To get the current log level of auth-server:</p> <pre><code>kubectl get configmap -n &lt;namespace&gt; &lt;helm-release-name&gt;-config-cm -o yaml | grep CN_AUTH_APP_LOGGERS \n</code></pre> <p>Example output: <pre><code>CN_AUTH_APP_LOGGERS: \n'{\n\"audit_log_level\":\"INFO\",\n\"audit_log_target\":\"FILE\",\n\"auth_log_level\":\"INFO\",\n\"auth_log_target\":\"STDOUT\",\n\"http_log_level\":\"INFO\",\n\"http_log_target\":\"FILE\",\n\"persistence_duration_log_level\":\"INFO\",\n\"persistence_duration_log_target\":\"FILE\",\n\"persistence_log_level\":\"INFO\",\n\"persistence_log_target\":\"FILE\",\n\"script_log_level\":\"INFO\",\n\"script_log_target\":\"FILE\"\n}'\n</code></pre></p> <p>To override the current logging level in auth-server, you can either add the desired changes to a yaml file and apply it using <code>helm</code>, or change it directly using kubectl edit command:</p> <ul> <li>Add changes to yaml:</li> </ul> <p>add these changes to your <code>override.yaml</code> file:</p> <pre><code>............\n............\nglobal:\n  auth-server:\n    appLoggers:\n      authLogLevel: \"TRACE\"\n      httpLogLevel: \"TRACE\"\n      persistenceLogLevel: \"TRACE\"\n      persistenceDurationLogLevel: \"TRACE\"\n      scriptLogLevel: \"TRACE\"\n      auditStatsLogLevel: \"TRACE\"\n............\n............      \n</code></pre> <p>Apply the changes:</p> <pre><code>helm upgrade &lt;helm-release-name&gt; janssen/janssen -f override.yaml -n &lt;namespace&gt;\n</code></pre> <p>View the logs of auth-server: <pre><code>kubectl logs -f deployment/&lt;helm-release-name&gt;-auth-server -n &lt;namespace&gt;\n</code></pre></p>","tags":["administration","kubernetes","operations","logs"]},{"location":"janssen-server/kubernetes-ops/logs/#config-api","title":"config-api","text":"<p>To get the current log level of config-api:</p> <pre><code>kubectl get configmap -n &lt;namspace&gt; &lt;helm-release-name&gt;-config-cm -o yaml | grep CN_CONFIG_API_APP_LOGGERS \n</code></pre> <p>Example output: <pre><code>CN_CONFIG_API_APP_LOGGERS: \n'{\n\"config_api_log_level\":\"INFO\",\n\"config_api_log_target\":\"STDOUT\",\n\"persistence_duration_log_level\":\"INFO\",\n\"persistence_duration_log_target\":\"FILE\",\n\"persistence_log_level\":\"INFO\",\n\"persistence_log_target\":\"FILE\",\n\"script_log_level\":\"INFO\",\n\"script_log_target\":\"FILE\"\n}'\n</code></pre></p> <p>To override the current logging level in config-api, you can either add the desired changes to a yaml file and apply it using <code>helm</code>, or change it directly using kubectl edit command:</p> <ul> <li>Add changes to yaml:</li> </ul> <p>add these changes to your <code>override.yaml</code> file:</p> <pre><code>............\n............\nglobal:\n  config-api:\n    appLoggers:\n      configApiLogLevel: \"TRACE\"\n      persistenceLogLevel: \"TRACE\"\n      persistenceDurationLogLevel: \"TRACE\"\n      scriptLogLevel: \"TRACE\"\n............\n............      \n</code></pre> <p>Apply the changes:</p> <pre><code>helm upgrade &lt;helm-release-name&gt; janssen/janssen -f override.yaml -n &lt;namespace&gt;\n</code></pre> <p>View the logs of config-api: <pre><code>kubectl logs -f deployment/&lt;helm-release-name&gt;-config-api -n &lt;namespace&gt;\n</code></pre></p>","tags":["administration","kubernetes","operations","logs"]},{"location":"janssen-server/kubernetes-ops/logs/#fido2","title":"fido2","text":"<p>To get the current log level of fido2:</p> <pre><code>kubectl get configmap -n &lt;namespace&gt; &lt;helm-release-name&gt;-config-cm -o yaml | grep CN_FIDO2_APP_LOGGERS \n</code></pre> <p>Example output: <pre><code>CN_FIDO2_APP_LOGGERS: \n'{\n\"fido2_log_level\":\"INFO\",\n\"fido2_log_target\":\"STDOUT\",\n\"persistence_log_level\":\"INFO\",\n\"persistence_log_target\":\"FILE\"\n}'\n</code></pre></p> <p>To override the current logging level in fido2, you can either add the desired changes to a yaml file and apply it using <code>helm</code>, or change it directly using kubectl edit command:</p> <ul> <li>Add changes to yaml:</li> </ul> <p>add these changes to your <code>override.yaml</code> file:</p> <pre><code>............\n............\nglobal:\n  fido2:\n    appLoggers:\n      fido2LogLevel: \"TRACE\"\n      persistenceLogLevel: \"TRACE\"\n............\n............      \n</code></pre> <p>Apply the changes:</p> <pre><code>helm upgrade &lt;helm-release-name&gt; janssen/janssen -f override.yaml -n &lt;namespace&gt;\n</code></pre> <p>View the logs of fido2: <pre><code>kubectl logs -f deployment/&lt;helm-release-name&gt;-fido2 -n &lt;namespace&gt;\n</code></pre></p>","tags":["administration","kubernetes","operations","logs"]},{"location":"janssen-server/kubernetes-ops/logs/#scim","title":"scim","text":"<p>To get the current log level of scim:</p> <pre><code>kubectl get configmap -n &lt;namespace&gt; &lt;helm-release-name&gt;-config-cm -o yaml | grep CN_SCIM_APP_LOGGERS \n</code></pre> <p>Example output: <pre><code>CN_SCIM_APP_LOGGERS: \n'{\n\"persistence_duration_log_level\":\"INFO\",\n\"persistence_duration_log_target\":\"FILE\",\n\"persistence_log_level\":\"INFO\",\n\"persistence_log_target\":\"FILE\",\n\"scim_log_level\":\"INFO\",\n\"scim_log_target\":\"STDOUT\",\n\"script_log_level\":\"INFO\",\n\"script_log_target\":\"FILE\"\n}'\n</code></pre></p> <p>To override the current logging level in scim, you can either add the desired changes to a yaml file and apply it using <code>helm</code>, or change it directly using kubectl edit command:</p> <ul> <li>Add changes to yaml:</li> </ul> <p>add these changes to your <code>override.yaml</code> file:</p> <pre><code>............\n............\nglobal:\n  scim:\n    appLoggers:\n      scimLogLevel: \"TRACE\"\n      persistenceLogLevel: \"TRACE\"\n      persistenceDurationLogLevel: \"TRACE\"\n      scriptLogLevel: \"TRACE\"\n............\n............      \n</code></pre> <p>Apply the changes:</p> <pre><code>helm upgrade &lt;helm-release-name&gt; janssen/janssen -f override.yaml -n &lt;namespace&gt;\n</code></pre> <p>View the logs of scim: <pre><code>kubectl logs -f deployment/&lt;helm-release-name&gt;-scim -n &lt;namespace&gt;\n</code></pre></p>","tags":["administration","kubernetes","operations","logs"]},{"location":"janssen-server/kubernetes-ops/logs/#hack-it","title":"Hack it","text":"<p>Warning This can cause deployments to break, but if you wish you may edit it directly and restart the wanted deployment</p> <p>Edit using the following command: <pre><code>kubectl edit configmap &lt;helm-release-name&gt;-config-cm -n &lt;namespace&gt;\n</code></pre></p> <p>Restart the wanted deployment: <pre><code>kubectl rollout restart deployment &lt;deployment-name&gt; -n &lt;namespace&gt;\n</code></pre></p>","tags":["administration","kubernetes","operations","logs"]},{"location":"janssen-server/kubernetes-ops/memory-dump/","title":"Memory Dump","text":"<p>This document will demonstrate how to generate a memory dump so that you can analyze your memory usage.</p>","tags":["administration","kubernetes","operations","memory","dump","heap"]},{"location":"janssen-server/kubernetes-ops/memory-dump/#services-supported","title":"Services supported","text":"<p>This operation can be made in the following Java-based services:</p> Service JAVA_OPTIONS environment variable auth-server CN_AUTH_JAVA_OPTIONS casa CN_CASA_JAVA_OPTIONS config-api CN_CONFIG_API_JAVA_OPTIONS fido2 CN_FIDO2_JAVA_OPTIONS link CN_LINK_JAVA_OPTIONS saml CN_SAML_JAVA_OPTIONS scim CN_SCIM_JAVA_OPTIONS","tags":["administration","kubernetes","operations","memory","dump","heap"]},{"location":"janssen-server/kubernetes-ops/memory-dump/#steps","title":"Steps","text":"<p>Let's go through the steps needed to generate a dump in <code>config-api</code>:</p> <ol> <li> <p>Increase the pod's memory request and limit to something larger than the default.</p> </li> <li> <p>Edit the config-api deployment and modify the JAVA_OPTIONS: </p> <pre><code>        env:\n        - name: CN_CONFIG_API_JAVA_OPTIONS\n          value: -XX:MaxDirectMemorySize=400m -Xmx150m -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/tmp -XX:MaxRAMPercentage=0\n</code></pre> </li> <li> <p>Modify the <code>command</code> key in the deployment to add the following:</p> <pre><code>          command:\n            - /bin/sh\n            - -c\n            - |\n              /app/scripts/entrypoint.sh &amp;\n              sleep 900000000\n</code></pre> </li> <li> <p>You can view the heap usage using the following command:    <code>kubectl exec -n &lt;namespace&gt; pod-name -- jcmd 7 GC.heap_info</code> </p> </li> <li> <p>Now once the process meets its limit, the process should shut down without the pod getting an OOM, allowing you to get the dump from within the pod.</p> </li> <li> <p>Copy the generated dump from the pod:     <pre><code>kubectl cp -n &lt;namespace&gt; pod-name:tmp/java_pid7.hprof java_pid7.hprof\n</code></pre></p> </li> </ol>","tags":["administration","kubernetes","operations","memory","dump","heap"]},{"location":"janssen-server/kubernetes-ops/scaling/","title":"Scaling","text":"<p>Scaling is the ability to handle the increase in usage by expanding the existing resources(nodes/pods).</p>","tags":["administration","kubernetes","operations","scaling"]},{"location":"janssen-server/kubernetes-ops/scaling/#scaling-types","title":"Scaling types","text":"<p>Scaling in Kubernetes can be done <code>automatically</code> and <code>manually</code>.</p>","tags":["administration","kubernetes","operations","scaling"]},{"location":"janssen-server/kubernetes-ops/scaling/#automatic-scaling","title":"Automatic Scaling","text":"<p>Kubernetes has the capability to provision resources <code>automatically</code> in order to match the needed demand.</p>","tags":["administration","kubernetes","operations","scaling"]},{"location":"janssen-server/kubernetes-ops/scaling/#horizontal-pod-autoscaler-hpa","title":"Horizontal Pod Autoscaler (HPA)","text":"<p>HPA automatically resizes the number of <code>pods</code> to match demand.</p> <p>In order for <code>hpa</code> to work, you have to:</p> <ol> <li> <p>Install metrics server</p> <pre><code>kubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml\n</code></pre> </li> <li> <p>Define <code>requests</code> for the metric used</p> </li> </ol> <p>It is configured and enabled by default in the deployed <code>jans</code> components.</p> <p>The default configuration scales in and out based on the CPU utilization of the pods.</p> <pre><code>&lt;component-name&gt;:\n    hpa:\n      enabled: true\n      minReplicas: 1\n      maxReplicas: 10\n      targetCPUUtilizationPercentage: 50\n      # -- metrics if targetCPUUtilizationPercentage is not set\n      metrics: []\n      # -- Scaling Policies\n      behavior: {}\n</code></pre>","tags":["administration","kubernetes","operations","scaling"]},{"location":"janssen-server/kubernetes-ops/scaling/#cluster-autoscaler","title":"Cluster Autoscaler","text":"<p>Cluster Autoscaler automatically resizes the number of <code>nodes</code> in a given node pool, based on the demands of your workloads.</p> <p>Cluster Autoscaler is available in AWS, GCP, and Azure.</p>","tags":["administration","kubernetes","operations","scaling"]},{"location":"janssen-server/kubernetes-ops/scaling/#manual-scaling","title":"Manual Scaling","text":"<p>Kubernetes also offers the option to manually scale your resources.</p> <p>For example, you can increase <code>manually</code> the pod replicas of auth-server deployment using the following command:</p> <pre><code>kubectl scale --replicas=3 deployment/auth-server -n &lt;namespace&gt;\n</code></pre>","tags":["administration","kubernetes","operations","scaling"]},{"location":"janssen-server/kubernetes-ops/start-order/","title":"Start Order","text":"","tags":["administration","kubernetes","operations","start-order"]},{"location":"janssen-server/kubernetes-ops/start-order/#service-start-order","title":"Service Start Order","text":"","tags":["administration","kubernetes","operations","start-order"]},{"location":"janssen-server/kubernetes-ops/start-order/#network-traffic-between-jans-services","title":"Network traffic between Jans services","text":"<ol> <li> <p>Database Access: all Jans services require access to the database.</p> </li> <li> <p>Pod-2-Pod Communication: Jans services communicate with each other as depicted.</p> </li> <li> <p>External/Internet Communication:</p> <ul> <li> <p>Auth-server: should be publically accessible.</p> </li> <li> <p>Rest of the pods:  We recommend to only keep the <code>.well-known</code> endpoints public and protect the rest.</p> </li> </ul> </li> </ol>","tags":["administration","kubernetes","operations","start-order"]},{"location":"janssen-server/kubernetes-ops/tui-k8s/","title":"TUI K8s","text":"<p>Using the TUI with a Janssen Kubernetes Setup - Watch Video</p>","tags":["administration","kubernetes","operations","tui"]},{"location":"janssen-server/kubernetes-ops/tui-k8s/#installing-tui-and-connecting-to-a-kubernetes-installation","title":"Installing TUI and connecting to a Kubernetes installation","text":"<ol> <li> <p>Download jans-cli-tui from the release assets depending on your OS. For example: </p> <p><code>wget https://github.com/JanssenProject/jans/releases/download/nightly/jans-cli-tui-linux-ubuntu-X86-64.pyz</code></p> <p>Now we have <code>jans-cli-tui-linux-ubuntu-X86-64.pyz</code> downloaded.</p> </li> <li> <p>Now we can grab the FQDN, client-id, client-secret, and connect using the following commands:     <pre><code>FQDN= #Add your FQDN here\nTUI_CLIENT_ID=$(kubectl get cm cn -n &lt;namespace&gt; --template={{.data.tui_client_id}})\nTUI_CLIENT_SECRET=$(kubectl get secret cn -n &lt;namespace&gt; --template={{.data.tui_client_pw}} | base64 -d)\n#add -noverify if your FQDN is not registered\npython3 jans-cli-tui-linux-ubuntu-X86-64.pyz --host $FQDN --client-id $TUI_CLIENT_ID --client-secret $TUI_CLIENT_SECRET\n</code></pre></p> </li> </ol>","tags":["administration","kubernetes","operations","tui"]},{"location":"janssen-server/kubernetes-ops/upgrade/","title":"Upgrade","text":"<p>This guide shows how to upgrade a Janssen helm deployment.</p> <p>Note</p> <p>Custom scripts are considered external configuration and are not updated automatically during an upgrade. Please review and adapt your custom scripts to work with the newer version of the Janssen Server.</p> <ol> <li> <p><code>helm ls -n &lt;namepsace&gt;</code></p> </li> <li> <p>Keep note of the helm release version</p> </li> <li> <p>Add your changes to <code>override.yaml</code></p> </li> <li> <p>Apply your upgrade:</p> <p><code>helm upgrade &lt;janssen-release-name&gt; janssen/janssen -n &lt;namespace&gt; -f override.yaml --version=0.0.0-nightly</code></p> </li> </ol>","tags":["administration","kubernetes","operations","helm","upgrade"]},{"location":"janssen-server/link/","title":"Jans Link Components","text":"<p>The Jans Link is a group of independent components that provide synchronization services to update the Janssen User Store from an external authoritative data source. Changes to the external data in the external store are detected by comparing periodic snapshots. Currently, Jans Link components are unidirectional where the Link component treats the external data as authoritative. Meaning, that changes made in the Janssen user store do not flow back to the external data source. Custom data transformations, like adding claims or claims enhancement, can be applied during the synchronization process. It is possible through the use of the Link Interception Script, which is invoked for each user update.</p> <p>Like all other Janssen Components, configuration and management of Jans Link components is possible through Text-based user Interface (TUI). Refer to subsections of this documentation for more details about each Jans Link component.</p>","tags":["administration","Jans Link"]},{"location":"janssen-server/link/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide. You can also participate in community discussions.</p>","tags":["administration","Jans Link"]},{"location":"janssen-server/link/jans-link/","title":"Jans LDAP Link","text":"<p>The Jans LDAPLink synchronization service updates the Janssen User Store when authoritative data is managed in an external LDAP store.</p>","tags":["administration","link","jans-ldap-link"]},{"location":"janssen-server/link/jans-link/#installation","title":"Installation","text":"<p>The API is available as the <code>Jans Link</code> component of Jans Server. Upon installation you can select if you want to install this Service along with other Janssen Server components. Post installation, to add Jans-Link component, use the following:</p> <pre><code>python3 /opt/jans/jans-setup/setup.py --install-jans-link`\n</code></pre> <p>Jans LDAP link gets installed as a service that can be managed using below commands.</p> <p>To Start Jans-Link</p> <pre><code>systemctl start jans-link\n</code></pre> <p>To check status</p> <pre><code>systemctl status jans-link\n</code></pre> <p>To Stop Jans-Link</p> <pre><code>systemctl stop jans-link\n</code></pre>","tags":["administration","link","jans-ldap-link"]},{"location":"janssen-server/link/jans-link/#jans-ldap-link-configuration","title":"Jans LDAP Link Configuration","text":"<p>The Janssen Server provides multiple configuration tools to perform these tasks.</p> Use Command-lineUse Text-based UIUse REST API <p>Use the command line to perform actions from the terminal. Learn how to  use Jans CLI here or jump straight to  the Using Command Line</p> <p>Use a fully functional text-based user interface from the terminal.  Learn how to use Jans Text-based UI (TUI)  here or jump straight to the Using Text-based UI</p> <p>The Jans link does not have a REST API.</p>","tags":["administration","link","jans-ldap-link"]},{"location":"janssen-server/link/jans-link/#using-command-line","title":"Using Command Line","text":"<p>Janssen Server CLI provides the number of operations and metadata information about the Jans LDAP link.</p> <p>To see Jans-Link info using Jans CLI</p> Command<pre><code> jans cli --info JansLinkConfiguration\n</code></pre> <pre><code>Operation ID: get-jans-link-properties\n  Description: Gets Jans Link App configuration.\nOperation ID: put-jans-link-properties\n  Description: Updates Jans Link configuration properties.\n  Schema: Jans Link Plugin:AppConfiguration\n</code></pre>","tags":["administration","link","jans-ldap-link"]},{"location":"janssen-server/link/jans-link/#gets-jans-link-app-configuration","title":"Gets Jans Link App configuration","text":"<p>To see Jans Link properties, use the below command. Use the operation ID <code>get-jans-link-properties</code> to get all the Jans link on the Janssen Server.</p> <p>Command<pre><code> jans cli --operation-id get-jans-link-properties\n</code></pre> The output of the above command will be similar to this:</p> Sample Output<pre><code>{\n  \"inumConfig\": {\n    \"configId\": \"local_inum\",\n    \"bindDN\": \"@ldap_binddn@\",\n    \"bindPassword\": \"@ldap_bind_encoded_pw@\",\n    \"servers\": [\n      \"@ldap_hostname@:@ldaps_port@\"\n    ],\n    \"maxConnections\": 10,\n    \"useSSL\": true,\n    \"baseDNs\": [\n      \"ou=link,o=site\"\n    ],\n    \"useAnonymousBind\": false,\n    \"enabled\": true,\n    \"version\": 0,\n    \"level\": 0\n  },\n  \"targetConfig\": {\n    \"maxConnections\": 2,\n    \"useSSL\": false,\n    \"useAnonymousBind\": false,\n    \"enabled\": false,\n    \"version\": 0,\n    \"level\": 0\n  },\n  \"ldapSearchSizeLimit\": 1000,\n  \"keyAttributes\": [\n    \"uid\"\n  ],\n  \"keyObjectClasses\": [\n    \"gluuPerson\"\n  ],\n  \"sourceAttributes\": [\n    \"mail\",\n    \"cn\",\n    \"sn\"\n  ],\n  \"updateMethod\": \"copy\",\n  \"defaultInumServer\": true,\n  \"keepExternalPerson\": true,\n  \"useSearchLimit\": false,\n  \"attributeMapping\": [\n    {\n      \"source\": \"uid\",\n      \"destination\": \"uid\"\n    },\n    {\n      \"source\": \"cn\",\n      \"destination\": \"cn\"\n    },\n    {\n      \"source\": \"sn\",\n      \"destination\": \"sn\"\n    }\n  ],\n  \"snapshotFolder\": \"/var/jans/link-snapshots\",\n  \"snapshotMaxCount\": 10,\n  \"baseDN\": \"o=jans\",\n  \"personObjectClassTypes\": [\n    \"jansCustomPerson\",\n    \"jansPerson\",\n    \"eduPerson\"\n  ],\n  \"personCustomObjectClass\": \"jansCustomPerson\",\n  \"allowPersonModification\": false,\n  \"supportedUserStatus\": [\n    \"active\",\n    \"inactive\"\n  ],\n  \"metricReporterInterval\": 0,\n  \"metricReporterKeepDataDays\": 0,\n  \"disableJdkLogger\": true,\n  \"cleanServiceInterval\": 0,\n  \"linkEnabled\": false,\n  \"serverIpAddress\": \"255.255.255.255\",\n  \"lastUpdate\": \"2023-07-05T18:27:28\",\n  \"lastUpdateCount\": \"0\",\n  \"problemCount\": \"3\",\n  \"useLocalCache\": false\n}\n</code></pre>","tags":["administration","link","jans-ldap-link"]},{"location":"janssen-server/link/jans-link/#updates-jans-link-configuration-properties","title":"Updates Jans Link configuration properties","text":"<p>Let's update the Jans Link configuration properties using the Janssen CLI command line. To perform the <code>put-jans-link-properties</code> operation, we have to use its schema. To get its schema:</p> Command<pre><code>jans cli --schema \"Jans Link Plugin:AppConfiguration\"\n</code></pre> <p>You can also use the following command for <code>Jans Link Plugin:AppConfiguration</code> a schema example.</p> <p>Command<pre><code>jans cli --schema-sample \"Jans Link Plugin:AppConfiguration\"\n</code></pre> To update the configuration, follow the steps below.</p> <ol> <li>Get Jans Link App configuration and store it into  a file for editing. The following command will retrieve the existing Jans link in the schema file. Command<pre><code>jans cli -no-color \\\n--operation-id get-jans-link-properties &gt; /tmp/update-jans-link.json\n</code></pre></li> <li>Edit and update the desired configuration values in the file while keeping other properties  and values unchanged. Updates must adhere to the <code>Jans Link Plugin:AppConfiguration</code> schema as mentioned  here.</li> <li>We have seen in the jans link <code>maxConnections:10</code> and <code>useSSL:true</code>. We are going to  update it with <code>maxConnections:15</code> and <code>useSSL:false</code>. Command<pre><code>jans cli --operation-id put-jans-link-properties \\\n--data /tmp/update-jans-link.json\n</code></pre> Upon successful execution of the update, the Janssen Server responds with updated configuration</li> </ol>","tags":["administration","link","jans-ldap-link"]},{"location":"janssen-server/link/jans-link/#using-text-based-ui","title":"Using Text-based UI","text":"<p>Start TUI using the command below:</p> Command<pre><code>jans tui\n</code></pre> <p>Navigate to <code>Jans Link</code> -&gt; <code>Configuration</code> to open the screen as shown in the image below.</p> <p></p> <p>The section below covers Jans LDAP link configuration in more detail.</p>","tags":["administration","link","jans-ldap-link"]},{"location":"janssen-server/link/jans-link/#configuration-using","title":"Configuration Using","text":"<p>In order to configre Jans LDAP Link, the administrator needs to know various values of the backend LDAP(or Active Directory). For example, <code>host</code> &amp; <code>port</code>, <code>bindDN</code>, user information, <code>password</code>, <code>Objectclasses</code>, <code>attributes</code> which will be pulled, etc.</p> <p>In addition, the administrator needs to know generic information about the Jans Server's LDAP. By default, the deployer can use <code>localhost:1636</code>, <code>cn=directory manager</code>, <code>password</code> chosen during installation, <code>ou=people,o=site</code> as server information, <code>bindDN</code>, <code>bindDN</code> <code>password</code> and <code>baseDN</code> respectively.</p> <p>Let's move forward with the Jans-Link setup.</p> <p></p> <ul> <li><code>Enabled</code> : Enable your Jans-link configuration. TUI</li> <li> <p><code>Refresh Method</code>: There have two refresh mode <code>copy</code> and <code>VDS</code>. If the organization has any kind of Active Directory/LDAP server, they are strongly recommended to use the Copy Method from the drop-down menu. Any organization with a database like mysql can use the VDS method. This option can be enabled via the drop-down menu in Refresh Method option.</p> </li> <li> <p><code>Mapping</code> : In the source attribute to destination attribute mapping field, you can enter the source attribute value on the left, and the destination attribute on the right. In other words, you can specify what the attribute is on the backend in the left field, and what it should be rendered as when it comes through the Jans Server in the right field.</p> </li> <li> <p><code>Server IP address</code>: Proviede your server IP address.</p> </li> <li> <p><code>Polling Interval (minutes)</code>: This is the interval value for running the link mechanism in the Jans Server. It is recommended to be kept higher than 15 minutes.</p> </li> <li> <p><code>Keep External Persons</code> : Enable it during Jans-Link setup. This will allow your default user 'admin' to log into Jans Server after initial linking iteration. If you do not enable 'Keep External Person', your 'admin' user including all other test users will be gone after first linking iteration.</p> </li> <li> <p><code>Snapshot Directory</code> : Every cycle of Jans Server link cycle saves an overall snapshot and problem-list record on a specified location. This is where the Jans Server Administrator can specify the location. You can easily decide whether link synchronizes all users or not. Generally the rejected users are enclosed in the problem-list file.</p> </li> <li> <p><code>Snapshot Count</code> : This defines the total number of snapshots that are allowed to be saved in the hard drive of the VM. It is recommended to be kept to 10 snapshots.</p> </li> <li> <p><code>Load Source Data withLimited Search</code></p> </li> </ul>","tags":["administration","link","jans-ldap-link"]},{"location":"janssen-server/link/jans-link/#customer-backend-key-attribute","title":"Customer Backend Key Attribute","text":"<ul> <li> <p><code>Key Attributes</code> : This is the unique key attribute of backend Active Directory/LDAP Server such as MikeAccountname for any Active Directory.</p> </li> <li> <p><code>Key Object Classes</code> : This contains the <code>Object Classes</code> of the backend Active Directory/LDAP which has permission to talk to Jans Server link such as person, organizationalPerson, user etc.</p> </li> <li> <p><code>Source Attributes</code> : This contains the list of attributes which will be pulled and read by the Jans Server.</p> </li> <li> <p><code>Custom LDAP Filter</code> : If there is any custom search required, this filtering mechanism can be used such as \"sn=*\" whereas the value of this field ensures that every user must contain an attribute named <code>SN</code>.</p> </li> </ul>","tags":["administration","link","jans-ldap-link"]},{"location":"janssen-server/link/jans-link/#source-backend-ldap-server","title":"Source Backend LDAP Server","text":"<p>This section allows the Jans Server to connect to the backend Active Directory/LDAP server of the organization.</p> <p>Add new Source LDAP Config</p> <ul> <li> <p><code>Name</code> : Input <code>source</code> as the value</p> </li> <li> <p><code>Bind DN</code> : This contains the username to connect to the backend server. You need to use full DN here. As for example, <code>cn=jans</code>,<code>dc=company</code>,<code>dc=org</code>.</p> </li> <li> <p><code>Bind Password</code> : This is your server password.</p> </li> <li> <p><code>Max Connections</code> : This value defines the maximum number of connections that are allowed to read the backend Active Directory/LDAP server. It is recommended to keep the value of 2 or 3.</p> </li> <li> <p><code>Server:Port</code> : provide your server name and port number.</p> </li> <li> <p><code>Base DNs</code> : This contains the location of the Active Directory/LDAP tree from where the Jans Server shall read the user information.</p> </li> <li> <p><code>Use SSL</code> : Use this feature if the backend server allows SSL connectivity.</p> </li> <li> <p><code>Enable</code> : This check-box is used to save and push the changes. Do not use this unless the server administrator has entered all the required values.</p> </li> </ul>","tags":["administration","link","jans-ldap-link"]},{"location":"janssen-server/link/jans-link/#inum-db-server","title":"Inum DB Server","text":"<p>This section of the application allows the server administrator to connect to the internal LDAP of the Jans Server. As Jans Server administrator, you do not need to insert anything here in this section as new Gluu Server versions automatically populates this for you (unless you try to manually configure it anyway).</p>","tags":["administration","link","jans-ldap-link"]},{"location":"janssen-server/link/jans-link/#things-to-remember","title":"Things To Remember","text":"<p>The Jans Server supports two LDAP modes:</p> <ul> <li>Authentication</li> <li>Identity mapping</li> </ul> <p>To synchronize user accounts from an external LDAP directory server, you can use the built-in Jans CLI or Jans TUI features for Service Link, which supports mapping identities from one or more source directory servers.</p> <p>After configuring Jans Link, you should give it some time to run and populate the LDAP server. Here are some tips before you get started:</p> <ul> <li> <p>Make sure you are using LDAP authentication</p> </li> <li> <p>Check the snapshots folder to see if files are being created.</p> </li> <li> <p>Use the Jans TUI to browse users.</p> </li> <li> <p>Use the command ldapsearch to check to see if results are starting to come in. The following command will search for the total number of users in the Jans LDAP:</p> </li> </ul> <pre><code>/opt/opendj/bin/ldapsearch -h localhost -p 1636 -Z -X -D \"cn=directory manager\" -w &lt;pass&gt; -b \"ou=people,o=DA....,o=jans\" dn | grep \"dn\\:\" | wc -l\n</code></pre> <p>Try to log in with one of these users. We assume that you have also set up your Jans Server to use the correct LDAP server for authentication.</p>","tags":["administration","link","jans-ldap-link"]},{"location":"janssen-server/link/jans-link/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","link","jans-ldap-link"]},{"location":"janssen-server/lock/","title":"Janssen Lock Guide","text":"<p>Janssen Lock provides a centralized control plane for domains to use Cedar to secure a network of distributed applications and audit the activity of both people and software. The Lock Server acts as the Policy Retrieval Point (PRP) in a distributed authorization architecture, connecting ephemeral Cedarling instances to enterprise infrastructure.</p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#overview","title":"Overview","text":"<p>A Lock topology consists of three main software components:</p> <ol> <li>Lock Server: A Java Weld application that serves as the centralized Policy Retrieval Point (PRP)</li> <li>Cedarling: An embedded Java PDP that runs the Amazon Rust Cedar Engine and validates JWTs</li> <li>Jans Auth Server: Provides OAuth and OpenID Connect services for secure communication</li> </ol> <p></p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#key-features","title":"Key Features","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#centralized-policy-distribution","title":"Centralized Policy Distribution","text":"<ul> <li>Policy Store Management: Centralized repository for Cedar policies and schemas</li> <li>Version Control: Integration with external policy sources (GitHub, file systems)</li> <li>Cache Management: Efficient policy caching with TTL expiration</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#oauth-protected-communication","title":"OAuth-Protected Communication","text":"<ul> <li>Secure Endpoints: All Lock Server endpoints protected by OAuth 2.0</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#comprehensive-audit-capabilities","title":"Comprehensive Audit Capabilities","text":"<ul> <li>Decision Logging: Centralized collection of authorization decisions</li> <li>Health Monitoring: Real-time health status from Cedarling clients</li> <li>Telemetry Data: Performance metrics and usage statistics</li> <li>Compliance Support: Structured audit logs for regulatory requirements</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#flexible-deployment-options","title":"Flexible Deployment Options","text":"<ul> <li>Standalone Deployment: Independent web server for dedicated Lock Server instances</li> <li>Integrated Deployment: Embedded within Jans Auth Server for unified management</li> <li>High Availability: Support for load-balanced, multi-instance deployments</li> <li>Container Ready: Docker containerization with Kubernetes support</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#architecture-overview","title":"Architecture Overview","text":"<p>Lock is designed for organizations that deploy a network of Cedarlings. Communication in this topology is bi-directional:</p> <ul> <li>Cedarling \u2192 Lock Server: HTTP requests to OAuth-protected endpoints to retrieve policies and send audit data</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#authorization-model-alignment","title":"Authorization Model Alignment","text":"<p>Janssen Lock aligns with established authorization frameworks including RFC 2904 and XACML:</p> Role Acronym Lock Component Description Policy Decision Point PDP Cedarling Evaluates authorization policies and makes access decisions Policy Information Point PIP JWT Tokens Provides entity data for policy evaluation Policy Enforcement Point PEP Application Enforces authorization decisions from Cedarling Policy Administration Point PAP Jans Config API Administrative interface for policy management Policy Retrieval Point PRP Lock Server Centralized repository and distribution point for policies","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#policy-store-structure","title":"Policy Store Structure","text":"<p>The Policy Store is a JSON document that contains all data required for Cedarling policy evaluation and JWT token verification. For detailed information about the Policy Store format, structure, and configuration options, see the Cedarling Policy Store documentation.</p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#security-model","title":"Security Model","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#oauth-20-protection","title":"OAuth 2.0 Protection","text":"<p>All Lock Server endpoints are protected using OAuth 2.0 with specific scopes:</p> <ul> <li><code>https://jans.io/oauth/lock/policy-store.read</code> - Policy store retrieval</li> <li><code>https://jans.io/oauth/lock/log.write</code> - Audit log submission</li> <li><code>https://jans.io/oauth/lock/health.write</code> - Health status reporting</li> <li><code>https://jans.io/oauth/lock/telemetry.write</code> - Telemetry data submission</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#authorization-flow","title":"Authorization Flow","text":"<ol> <li>Client Registration: Cedarling clients register using Software Statement Assertion (SSA)</li> <li>Token Acquisition: Clients obtain access tokens with required scopes</li> <li>Request Authorization: Lock Server validates tokens and uses embedded Cedarling for authorization</li> <li>Resource Access: Authorized requests receive policy store data or accept audit submissions</li> </ol>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#embedded-cedarling-authorization","title":"Embedded Cedarling Authorization","text":"<p>The Lock Server uses its own embedded Cedarling instance to make authorization decisions:</p> <ul> <li>Policy Store Access: Determines which clients can access specific policy stores</li> <li>Audit Submission: Controls which clients can submit audit data</li> <li>Administrative Operations: Protects configuration and management endpoints</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#getting-started","title":"Getting Started","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#quick-start","title":"Quick Start","text":"<ol> <li>Deploy Lock Server: Choose standalone or integrated deployment</li> <li>Configure Policy Store: Set up policy sources and trusted issuers</li> <li>Register Cedarling Clients: Use SSA for secure client registration</li> <li>Test Policy Retrieval: Verify Cedarling can fetch policies</li> <li>Monitor Operations: Use CLI/TUI for ongoing management</li> </ol>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#deployment-options","title":"Deployment Options","text":"<ul> <li>Standalone Deployment: Independent Lock Server instance</li> <li>Integrated Deployment: Embedded in Jans Auth Server</li> <li>High Availability Setup: Load-balanced multi-instance deployment</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#management-interfaces","title":"Management Interfaces","text":"<ul> <li>CLI Commands: Command-line policy and client management</li> <li>TUI Interface: Text-based user interface for administration</li> <li>REST API: Programmatic access to Lock Server functionality</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#use-cases","title":"Use Cases","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#enterprise-application-security","title":"Enterprise Application Security","text":"<ul> <li>Centralized policy management for microservices</li> <li>Consistent authorization across distributed applications</li> <li>Real-time policy updates without service restarts</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#compliance-and-auditing","title":"Compliance and Auditing","text":"<ul> <li>Centralized audit log collection</li> <li>Regulatory compliance reporting</li> <li>Security event monitoring and alerting</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#multi-tenant-environments","title":"Multi-tenant Environments","text":"<ul> <li>Tenant-specific policy isolation</li> <li>Scalable policy distribution</li> <li>Per-tenant audit and monitoring</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#cloud-native-deployments","title":"Cloud-Native Deployments","text":"<ul> <li>Kubernetes-native policy distribution</li> <li>Container-based Cedarling deployment</li> <li>Service mesh integration</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/#more-information","title":"More Information","text":"<ul> <li>Lock Server Configuration and Operation: Detailed setup and management guide</li> <li>Cedarling Documentation: Client-side authorization engine</li> <li>Cedar Policy Language: Official Cedar documentation</li> <li>OAuth 2.0 Integration: OAuth implementation details</li> <li>Jans Auth Server: Complete identity platform documentation</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point"]},{"location":"janssen-server/lock/lock-server/","title":"Lock Server Configuration and Operation","text":"<p>The Janssen Lock Server is a Java Weld application that serves as the centralized Policy Retrieval Point (PRP) in a distributed Cedar-based authorization architecture. It connects ephemeral Cedarling instances to enterprise infrastructure by providing policy distribution, audit log collection, and OAuth-protected endpoints for secure communication.</p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#overview","title":"Overview","text":"<p>The Lock Server acts as the bridge between policy authoring tools (like Agama Lab Policy Designer) and distributed Cedarling instances, ensuring consistent policy enforcement across the network while maintaining high availability and security.</p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#key-capabilities","title":"Key Capabilities","text":"<ul> <li>Policy Distribution: Centralized management and distribution of Cedar policies</li> <li>Policy Updates: Efficient policy change management and distribution</li> <li>Audit Collection: Centralized logging of authorization decisions and system events</li> <li>OAuth Security: Comprehensive OAuth 2.0 protection for all endpoints</li> <li>Flexible Deployment: Standalone or integrated with Jans Auth Server</li> <li>Management Interfaces: CLI, TUI, and REST API for administration</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#architecture","title":"Architecture","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#high-level-components","title":"High-Level Components","text":"<pre><code>graph TB\n    subgraph \"Policy Authoring\"\n        AL[Agama Lab Policy Designer]\n        GH[GitHub Repository]\n    end\n\n    subgraph \"Lock Server Infrastructure\"\n        LS[Lock Server]\n        CL[Embedded Cedarling]\n        PS[Policy Store Cache]\n        AL_LOG[Audit Logs]\n    end\n\n    subgraph \"OAuth Infrastructure\"\n        AS[Jans Auth Server]\n        DCR[Dynamic Client Registration]\n    end\n\n    subgraph \"Cedarling Clients\"\n        C1[Cedarling Client 1]\n        C2[Cedarling Client 2]\n        CN[Cedarling Client N]\n    end\n\n    AL --&gt; GH\n    GH --&gt; PS\n    C1 --&gt; DCR\n    C2 --&gt; DCR\n    CN --&gt; DCR\n    DCR --&gt; AS\n    C1 -.-&gt;|OAuth Token| LS\n    C2 -.-&gt;|OAuth Token| LS\n    CN -.-&gt;|OAuth Token| LS\n    LS --&gt; CL\n    LS --&gt; PS\n    LS --&gt; AL_LOG\n    C1 -.-&gt;|Audit Data| LS\n    C2 -.-&gt;|Audit Data| LS\n    CN -.-&gt;|Audit Data| LS</code></pre>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#internal-architecture","title":"Internal Architecture","text":"<p>The Lock Server consists of several layers:</p> <ul> <li>Web Layer: REST endpoints for policy and audit operations</li> <li>Security Layer: OAuth token validation and Cedarling authorization</li> <li>Business Logic: Policy store management, audit collection, client management</li> <li>Data Layer: Policy store cache, audit storage, client registry</li> <li>Integration Layer: Embedded Cedarling, external policy sources</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#installation-and-deployment","title":"Installation and Deployment","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#deployment-options","title":"Deployment Options","text":"<p>The Lock Server supports two primary deployment models:</p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#standalone-deployment","title":"Standalone Deployment","text":"<p>Deploy Lock Server as an independent web application:</p> <pre><code># docker-compose.yml\nversion: '3.8'\nservices:\n  lock-server:\n    image: janssenproject/lock-server:latest\n    ports:\n      - \"8080:8080\"\n    environment:\n      - LOCK_SERVER_POLICY_STORE_SOURCE=github\n      - LOCK_SERVER_GITHUB_REPO=org/policy-repo\n      - LOCK_SERVER_OAUTH_ISSUER=https://auth.example.com\n      - LOCK_SERVER_JWKS_URI=https://auth.example.com/.well-known/jwks\n    volumes:\n      - ./config:/opt/jans/lock-server/config\n      - ./logs:/opt/jans/lock-server/logs\n    networks:\n      - jans-network\n\n  redis:\n    image: redis:alpine\n    networks:\n      - jans-network\n\nnetworks:\n  jans-network:\n    driver: bridge\n</code></pre>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#integrated-deployment","title":"Integrated Deployment","text":"<p>Deploy Lock Server embedded within Jans Auth Server:</p> <pre><code># Jans Auth Server configuration\nservices:\n  jans-auth:\n    image: janssenproject/jans-auth-server:latest\n    environment:\n      - JANS_LOCK_SERVER_ENABLED=true\n      - JANS_LOCK_SERVER_POLICY_STORE_SOURCE=local\n      - JANS_LOCK_SERVER_EMBEDDED_MODE=true\n    volumes:\n      - ./lock-server-config:/opt/jans/jetty/jans-auth/custom/lock-server\n      - ./policy-stores:/opt/jans/lock-server/policy-stores\n</code></pre>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#high-availability-setup","title":"High Availability Setup","text":"<p>For production deployments requiring high availability:</p> <pre><code># HA deployment with load balancer\nservices:\n  nginx:\n    image: nginx:alpine\n    ports:\n      - \"443:443\"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf\n      - ./ssl:/etc/nginx/ssl\n    depends_on:\n      - lock-server-1\n      - lock-server-2\n\n  lock-server-1:\n    image: janssenproject/lock-server:latest\n    environment:\n      - LOCK_SERVER_INSTANCE_ID=lock-server-1\n      - LOCK_SERVER_REDIS_URL=redis://redis:6379\n    depends_on:\n      - redis\n\n  lock-server-2:\n    image: janssenproject/lock-server:latest\n    environment:\n      - LOCK_SERVER_INSTANCE_ID=lock-server-2\n      - LOCK_SERVER_REDIS_URL=redis://redis:6379\n    depends_on:\n      - redis\n\n  redis:\n    image: redis:alpine\n    command: redis-server --appendonly yes\n    volumes:\n      - redis-data:/data\n\nvolumes:\n  redis-data:\n</code></pre>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#installation-steps","title":"Installation Steps","text":"<ol> <li>Prerequisites</li> <li>Java 11 or higher</li> <li>Jans Auth Server (for OAuth services)</li> <li> <p>Redis (for HA deployments)</p> </li> <li> <p>Download and Extract <pre><code>wget https://github.com/JanssenProject/jans/releases/latest/download/lock-server.tar.gz\ntar -xzf lock-server.tar.gz\ncd lock-server\n</code></pre></p> </li> <li> <p>Configure Environment <pre><code>cp config/lock-server.properties.template config/lock-server.properties\n# Edit configuration file with your settings\n</code></pre></p> </li> <li> <p>Start Lock Server <pre><code>./bin/start-lock-server.sh\n</code></pre></p> </li> </ol>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#configuration","title":"Configuration","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#core-configuration-properties","title":"Core Configuration Properties","text":"<p>The Lock Server uses a properties file for configuration:</p> <pre><code># Lock Server Configuration\nlock.server.host=0.0.0.0\nlock.server.port=8080\nlock.server.context.path=/\n\n# OAuth Configuration\nlock.server.oauth.issuer=https://auth.example.com\nlock.server.oauth.jwks.uri=https://auth.example.com/.well-known/jwks\nlock.server.oauth.token.validation.enabled=true\n\n# Policy Store Configuration\nlock.server.policy.store.source=github\nlock.server.policy.store.github.repo=organization/policy-repo\nlock.server.policy.store.github.branch=main\nlock.server.policy.store.github.token=${GITHUB_TOKEN}\nlock.server.policy.store.cache.ttl=300\n\n# Cedarling Configuration\nlock.server.cedarling.policy.store.uri=file:///opt/jans/lock-server/policies/lock-server-policies.json\nlock.server.cedarling.log.level=INFO\n\n# Audit Configuration\nlock.server.audit.enabled=true\nlock.server.audit.storage=file\nlock.server.audit.file.path=/opt/jans/lock-server/logs/lock_server_audit.log\nlock.server.audit.rdbms.enabled=false\n\n# Policy Update Configuration\nlock.server.policy.update.enabled=true\nlock.server.policy.update.check.interval=60\n\n# Logging Configuration\nlock.server.log.level=INFO\nlock.server.log.config.file=/opt/jans/lock-server/logs/lock_server_config.log\nlock.server.log.jwt.status.file=/opt/jans/lock-server/logs/lock_server_jwt_status.log\n</code></pre>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#policy-store-sources","title":"Policy Store Sources","text":"<p>The Lock Server supports multiple policy store sources:</p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#github-repository","title":"GitHub Repository","text":"<pre><code>lock.server.policy.store.source=github\nlock.server.policy.store.github.repo=organization/policy-repo\nlock.server.policy.store.github.branch=main\nlock.server.policy.store.github.path=policy-stores/\nlock.server.policy.store.github.token=${GITHUB_TOKEN}\n</code></pre>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#local-file-system","title":"Local File System","text":"<pre><code>lock.server.policy.store.source=file\nlock.server.policy.store.file.path=/opt/jans/lock-server/policy-stores/\nlock.server.policy.store.file.watch.enabled=true\n</code></pre>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#http-endpoint","title":"HTTP Endpoint","text":"<pre><code>lock.server.policy.store.source=http\nlock.server.policy.store.http.base.url=https://policy-server.example.com/api/v1/\nlock.server.policy.store.http.auth.type=bearer\nlock.server.policy.store.http.auth.token=${POLICY_SERVER_TOKEN}\n</code></pre>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#rest-api-endpoints","title":"REST API Endpoints","text":"<p>The Lock Server provides several REST API endpoints for different operations:</p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#policy-store-endpoints","title":"Policy Store Endpoints","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#get-policy-store","title":"Get Policy Store","text":"<pre><code>GET /policy-store/{id}\nAuthorization: Bearer &lt;access_token&gt;\n</code></pre> <p>Response: <pre><code>{\n  \"cedar_version\": \"v4.0.0\",\n  \"policy_store\": {\n    \"name\": \"Application Policy Store\",\n    \"description\": \"Policies for application authorization\",\n    \"policies\": { ... },\n    \"schema\": { ... },\n    \"trusted_issuers\": { ... }\n  }\n}\n</code></pre></p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#list-policy-stores","title":"List Policy Stores","text":"<pre><code>GET /policy-stores\nAuthorization: Bearer &lt;access_token&gt;\n</code></pre> <p>Response: <pre><code>{\n  \"policy_stores\": [\n    {\n      \"id\": \"app-policies\",\n      \"name\": \"Application Policies\",\n      \"description\": \"Main application policy store\",\n      \"version\": \"1.2.3\",\n      \"last_updated\": \"2024-01-01T12:00:00Z\"\n    }\n  ]\n}\n</code></pre></p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#audit-endpoints","title":"Audit Endpoints","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#submit-audit-logs","title":"Submit Audit Logs","text":"<pre><code>POST /audit/logs\nAuthorization: Bearer &lt;access_token&gt;\nContent-Type: application/json\n\n{\n  \"logs\": [\n    {\n      \"request_id\": \"req-123456\",\n      \"timestamp\": \"2024-01-01T12:00:00Z\",\n      \"log_kind\": \"Decision\",\n      \"pdp_id\": \"cedarling-001\",\n      \"policy_store_id\": \"app-policies\",\n      \"decision\": \"ALLOW\",\n      \"principal\": \"Jans::User::\\\"user123\\\"\",\n      \"action\": \"Jans::Action::\\\"read\\\"\",\n      \"resource\": \"Jans::Application::\\\"app001\\\"\",\n      \"diagnostics\": {\n        \"reason\": [\"policy-001\"],\n        \"errors\": []\n      },\n      \"decision_time_ms\": 15\n    }\n  ]\n}\n</code></pre>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#submit-health-status","title":"Submit Health Status","text":"<pre><code>POST /audit/health\nAuthorization: Bearer &lt;access_token&gt;\nContent-Type: application/json\n\n{\n  \"pdp_id\": \"cedarling-001\",\n  \"timestamp\": \"2024-01-01T12:00:00Z\",\n  \"status\": \"healthy\",\n  \"policy_store_version\": \"1.2.3\",\n  \"uptime_seconds\": 86400,\n  \"memory_usage_mb\": 128,\n  \"cpu_usage_percent\": 15.5\n}\n</code></pre>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#submit-telemetry-data","title":"Submit Telemetry Data","text":"<pre><code>POST /audit/telemetry\nAuthorization: Bearer &lt;access_token&gt;\nContent-Type: application/json\n\n{\n  \"pdp_id\": \"cedarling-001\",\n  \"timestamp\": \"2024-01-01T12:00:00Z\",\n  \"metrics\": {\n    \"total_requests\": 1000,\n    \"successful_requests\": 950,\n    \"failed_requests\": 50,\n    \"average_response_time_ms\": 12.5,\n    \"policy_evaluations\": 1000,\n    \"cache_hits\": 800,\n    \"cache_misses\": 200\n  }\n}\n</code></pre>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#well-known-configuration","title":"Well-Known Configuration","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#lock-server-configuration","title":"Lock Server Configuration","text":"<pre><code>GET /.well-known/lock-master-configuration\n</code></pre> <p>Response: <pre><code>{\n  \"issuer\": \"https://lock-server.example.com\",\n  \"policy_store_endpoint\": \"https://lock-server.example.com/policy-store\",\n  \"policy_stores_endpoint\": \"https://lock-server.example.com/policy-stores\",\n  \"audit_endpoint\": \"https://lock-server.example.com/audit\",\n\n  \"jwks_uri\": \"https://auth.example.com/.well-known/jwks\",\n  \"scopes_supported\": [\n    \"https://jans.io/oauth/lock/policy-store.read\",\n    \"https://jans.io/oauth/lock/log.write\",\n    \"https://jans.io/oauth/lock/health.write\",\n    \"https://jans.io/oauth/lock/telemetry.write\"\n  ],\n  \"features_supported\": [\n    \"policy-store-retrieval\",\n    \"audit-collection\",\n    \"health-monitoring\",\n    \"telemetry-collection\"\n  ]\n}\n</code></pre></p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#oauth-security","title":"OAuth Security","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#scope-based-access-control","title":"Scope-Based Access Control","text":"<p>The Lock Server uses OAuth 2.0 scopes to control access to different endpoints:</p> Scope Endpoints Description <code>https://jans.io/oauth/lock/policy-store.read</code> <code>/policy-store/*</code>, <code>/policy-stores</code> Read access to policy stores <code>https://jans.io/oauth/lock/log.write</code> <code>/audit/logs</code> Submit authorization decision logs <code>https://jans.io/oauth/lock/health.write</code> <code>/audit/health</code> Submit health status information <code>https://jans.io/oauth/lock/telemetry.write</code> <code>/audit/telemetry</code> Submit telemetry and metrics data","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#logging-and-monitoring","title":"Logging and Monitoring","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#log-files","title":"Log Files","text":"<p>The Lock Server generates several log files for different purposes:</p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#configuration-log-lock_server_configlog","title":"Configuration Log (<code>lock_server_config.log</code>)","text":"<p>Records configuration changes and system events: <pre><code>2024-01-01 12:00:00 INFO  [ConfigService] Policy store configuration updated: app-policies\n2024-01-01 12:01:00 INFO  [ConfigService] Trusted issuer added: enterprise_idp\n2024-01-01 12:02:00 WARN  [ConfigService] Policy store cache miss for: test-policies\n2024-01-01 12:03:00 ERROR [ConfigService] Failed to fetch policy store from GitHub: network timeout\n</code></pre></p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#audit-log-lock_server_auditlog","title":"Audit Log (<code>lock_server_audit.log</code>)","text":"<p>Stores authorization decisions and audit events: <pre><code>{\n  \"timestamp\": \"2024-01-01T12:00:00Z\",\n  \"request_id\": \"req-123456\",\n  \"log_kind\": \"Decision\",\n  \"pdp_id\": \"cedarling-001\",\n  \"policy_store_id\": \"app-policies\",\n  \"decision\": \"ALLOW\",\n  \"principal\": \"Jans::User::\\\"user123\\\"\",\n  \"action\": \"Jans::Action::\\\"read\\\"\",\n  \"resource\": \"Jans::Application::\\\"app001\\\"\",\n  \"decision_time_ms\": 15\n}\n</code></pre></p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#jwt-status-log-lock_server_jwt_statuslog","title":"JWT Status Log (<code>lock_server_jwt_status.log</code>)","text":"<p>Tracks JWT token validation and processing: <pre><code>2024-01-01 12:00:00 INFO  [JWTValidator] Token validated successfully for client: client123\n2024-01-01 12:01:00 WARN  [JWTValidator] Token expired for client: client456\n2024-01-01 12:02:00 ERROR [JWTValidator] Invalid signature for token from issuer: https://malicious.com\n</code></pre></p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#rdbms-audit-storage","title":"RDBMS Audit Storage","text":"<p>For enterprise deployments, audit logs can be stored in a relational database:</p> <pre><code>CREATE TABLE audit_logs (\n    id VARCHAR(255) PRIMARY KEY,\n    client_id VARCHAR(255),\n    request_id VARCHAR(255),\n    timestamp TIMESTAMP,\n    log_kind VARCHAR(50),\n    pdp_id VARCHAR(255),\n    policy_store_id VARCHAR(255),\n    decision VARCHAR(10),\n    principal TEXT,\n    action TEXT,\n    resource TEXT,\n    diagnostics JSON,\n    decision_time_ms BIGINT,\n    INDEX idx_timestamp (timestamp),\n    INDEX idx_client_id (client_id),\n    INDEX idx_policy_store_id (policy_store_id)\n);\n</code></pre>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#metrics-and-monitoring","title":"Metrics and Monitoring","text":"<p>The Lock Server exposes metrics for monitoring:</p> <ul> <li>Policy Store Metrics: Cache hit/miss rates, fetch times, update frequencies</li> <li>Authorization Metrics: Request rates, decision times, success/failure ratios</li> <li>Client Metrics: Active connections, request patterns, error rates</li> <li>System Metrics: Memory usage, CPU utilization, response times</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#cli-management","title":"CLI Management","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#jans-cli-commands","title":"Jans CLI Commands","text":"<p>The Lock Server can be managed using Jans CLI commands:</p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#policy-store-management","title":"Policy Store Management","text":"<pre><code># List policy stores\njans-cli --operation-id get-lock-policy-stores\n\n# Get specific policy store\njans-cli --operation-id get-lock-policy-store --url-suffix \"app-policies\"\n\n# Update policy store configuration\njans-cli --operation-id put-lock-policy-store --url-suffix \"app-policies\" \\\n  --data '{\"source\": \"github\", \"repository\": \"org/new-repo\"}'\n\n# Delete policy store\njans-cli --operation-id delete-lock-policy-store --url-suffix \"app-policies\"\n</code></pre>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#client-management","title":"Client Management","text":"<pre><code># List connected Cedarling clients\njans-cli --operation-id get-lock-clients\n\n# Get client details\njans-cli --operation-id get-lock-client --url-suffix \"client123\"\n\n# Search clients by username\njans-cli --operation-id get-lock-clients --query \"username=john.doe\"\n\n# View client authorization activity\njans-cli --operation-id get-lock-client-activity --url-suffix \"client123\" \\\n  --query \"start_date=2024-01-01&amp;end_date=2024-01-31\"\n</code></pre>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#metrics-and-monitoring_1","title":"Metrics and Monitoring","text":"<pre><code># Get authorization metrics\njans-cli --operation-id get-lock-metrics --query \"metric=authorization_requests&amp;period=daily\"\n\n# Get system health\njans-cli --operation-id get-lock-health\n\n# Get audit log summary\njans-cli --operation-id get-lock-audit-summary --query \"start_date=2024-01-01\"\n</code></pre>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#tui-interface","title":"TUI Interface","text":"<p>The Text-based User Interface provides an interactive way to manage Lock Server:</p> <ol> <li>Access TUI: <code>sudo /opt/jans/bin/jans-tui.py</code></li> <li>Navigate to Lock Server: <code>Lock Server</code> &gt; <code>Configuration</code></li> <li>Available Sections:</li> <li>Policy Store Management</li> <li>Client Registry</li> <li>Audit Logs</li> <li>System Metrics</li> <li>Configuration Settings</li> </ol>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#troubleshooting","title":"Troubleshooting","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#common-issues","title":"Common Issues","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#policy-store-not-loading","title":"Policy Store Not Loading","text":"<p>Symptoms: Cedarling clients cannot retrieve policy stores Causes: - Invalid policy store source configuration - Network connectivity issues - Authentication failures with external sources</p> <p>Solutions: <pre><code># Check policy store configuration\njans-cli --operation-id get-lock-policy-store-config\n\n# Test policy store connectivity\ncurl -H \"Authorization: Bearer &lt;token&gt;\" \\\n  https://lock-server.example.com/policy-store/app-policies\n\n# Check logs for errors\ntail -f /opt/jans/lock-server/logs/lock_server_config.log\n</code></pre></p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#oauth-token-validation-failures","title":"OAuth Token Validation Failures","text":"<p>Symptoms: Clients receive 401 Unauthorized responses Causes: - Expired or invalid access tokens - Incorrect JWKS URI configuration - Clock synchronization issues</p> <p>Solutions: <pre><code># Verify JWKS URI configuration\njans-cli --operation-id get-lock-oauth-config\n\n# Check JWT status logs\ntail -f /opt/jans/lock-server/logs/lock_server_jwt_status.log\n\n# Test token validation manually\ncurl -H \"Authorization: Bearer &lt;token&gt;\" \\\n  https://lock-server.example.com/.well-known/lock-master-configuration\n</code></pre></p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#policy-update-issues","title":"Policy Update Issues","text":"<p>Symptoms: Cedarling clients not receiving latest policy updates Causes: - Policy store cache configuration issues - Network connectivity problems - Policy source synchronization failures</p> <p>Solutions: <pre><code># Check policy store cache status\njans-cli --operation-id get-lock-policy-cache-status\n\n# Force policy store refresh\njans-cli --operation-id post-lock-policy-refresh --url-suffix \"app-policies\"\n\n# Monitor policy update logs\ntail -f /opt/jans/lock-server/logs/lock_server_config.log\n</code></pre></p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#performance-optimization","title":"Performance Optimization","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#policy-store-caching","title":"Policy Store Caching","text":"<ul> <li>Increase cache TTL for stable policy stores</li> <li>Use Redis for distributed caching in HA setups</li> <li>Monitor cache hit rates and adjust accordingly</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#database-optimization","title":"Database Optimization","text":"<ul> <li>Create appropriate indexes for audit log queries</li> <li>Implement log rotation and archival policies</li> <li>Use connection pooling for database access</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#network-optimization","title":"Network Optimization","text":"<ul> <li>Use CDN for policy store distribution</li> <li>Implement compression for large policy stores</li> <li>Configure appropriate timeout values</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#security-considerations","title":"Security Considerations","text":"","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#production-deployment-security","title":"Production Deployment Security","text":"<ol> <li>TLS Configuration: Always use HTTPS in production</li> <li>Token Security: Implement proper token rotation and validation</li> <li>Network Security: Use firewalls and network segmentation</li> <li>Audit Security: Protect audit logs from tampering</li> <li>Access Control: Implement least-privilege access principles</li> </ol>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#security-best-practices","title":"Security Best Practices","text":"<ul> <li>Regular security updates and patches</li> <li>Monitoring and alerting for security events</li> <li>Regular audit log reviews</li> <li>Secure backup and recovery procedures</li> <li>Incident response planning</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#api-reference","title":"API Reference","text":"<p>For complete API documentation, see the Lock Server OpenAPI Specification.</p>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/lock/lock-server/#see-also","title":"See Also","text":"<ul> <li>Janssen Lock Overview: Complete Lock ecosystem documentation</li> <li>Cedarling Documentation: Client-side authorization engine</li> <li>Cedar Policy Language: Official Cedar documentation</li> <li>OAuth 2.0 Configuration: OAuth implementation details</li> <li>Jans CLI Reference: Command-line interface documentation</li> </ul>","tags":["administration","lock","authorization","authz","Cedar","Cedarling","policy-retrieval-point","java-weld"]},{"location":"janssen-server/planning/","title":"Deployment and Planning Guide","text":"<p>This Deployment Guide will help you plan how to launch a digital identity service for your organization. It will hopefully answer many of the \"why\" questions, not just the \"how\" questions, setting the stage for what challenges are in scope for Janssen--and where you may need to use other software.  It addresses some common questions that don't quite fit into other parts of the Janssen docs.</p> <p>By covering the key features and designs, hopefully, this guide will help you understand the different deployment options available, when to use each, and how to right-size your Janssen identity services.</p> <p>The audience for this deployment guide includes technical architects, designers, developers, and Janssen administrators.</p> <p>Contribute</p> <p>If you\u2019d like to contribute to this document, get started with the Contribution Guide</p>","tags":["administration","planning","deployment"]},{"location":"janssen-server/planning/application-portal/","title":"Application Portal","text":"<p>An application portal (\"portal\") is a website that displays all the protected applications available for an end user to access. The Janssen Project does not provide a portal. But you can build your own.</p> <p>Each application that you want in your portal should be configured as an OpenID Connect RP. Build a simple website (any CMS will do) that is also an RP. The OP can provide the roles of the user, or another claim, which will enable your portal to determine which websites to display. Iterate and display the websites (or icons) with the respective URLs.</p>","tags":["administration","planning","portal"]},{"location":"janssen-server/planning/benchmarking/","title":"Benchmarking","text":"<p>Want confidence that your Janssen platform will perform with the latency and concurrency you need in production? If so, then you MUST benchmark properly. It's critical that your test data and transactions mock what you need to prove in production. For cloud-native deployments, benchmarking is also essential to test auto-scaling and failover. Ideally, you'll test the same hardware and network.</p> <p>Remember that OAuth has different flows, which have a different number of steps, and different requirements for compute and persistence. For example, the OAuth Client Credential Grant is very short: there is one token request and one token response. The OpenID Code Flow has many more steps: it has a request/response to the authorization, token, Userinfo and logout endpoints. It's really important to test the exact flow you intend to use in production.</p> <p>Benchmarking also has the benefit of testing the index configuration in your database. Every database trades disk space for performance by using indexes. If you miss an index, performance sometimes comes to a grinding halt. Your service may even crash. Having confidence that all potential index scenarios get executed in your benchmarking is essential.</p> <p>Auth Server publishes JUnit tests and some tools for generating test data. Because each page rendered by Auth Server has a state, you cannot use a static load generation page tool. Don't forget to gather data on compute, storage, and memory. Also, watch the resources consumed by each web service and system service (e.g. database). You can't find the bottleneck without this data. System libraries and hardware choices may also impact your results.</p> <p>Benchmarking is an iterative process. Inevitably, things never go exactly how you guessed they would. And you make changes to your environment and run the benchmarking tests again--ad nauseam. Leave enough time for benchmarking. However much time you think it will take, triple your estimate.</p> <p>Make sure you look at both short tests and long-running tests. A slow memory leak may only present after many hours of high load. Also, run some crazy tests, just so you know what happens. Some organizations benchmark for ten times the normal volume. But when an incident happens, they see 1,000 times the normal volume. Think outside-the-box.</p> <p>It's tricky load testing some newer two-factor authentication services, especially if they rely on new features of the browser. Hopefully the tools to benchmark these will evolve.</p> <p>Janssen Auth Server supports a number of deployment models--both VM and cloud-native. While cloud-native architecture enables true horizontal scalability, it comes at a cost. Benchmarking can help you understand if that cost is justified.</p>","tags":["administration","planning","benchmarking"]},{"location":"janssen-server/planning/benchmarking/#load-test","title":"Load test","text":"<p>In cloud-native architecture, the load testing is executed via k8s pods.</p>","tags":["administration","planning","benchmarking"]},{"location":"janssen-server/planning/benchmarking/#authorization-code-flow-jmeter-load-test","title":"Authorization Code Flow jmeter load test","text":"<p>For load testing with Authorization Code Flow jmeter test, the following script is used.</p> <p>See Authorization code flow recipe for details.</p>","tags":["administration","planning","benchmarking"]},{"location":"janssen-server/planning/benchmarking/#resource-owner-password-grant-ropc-flow-jmeter-load-test","title":"Resource Owner Password Grant (ROPC) Flow jmeter load test","text":"<p>For load testing with Resource Owner Password Grant (ROPC) Flow jmeter test, the following script is used.</p> <p>See ROPC flow recipe for details.</p>","tags":["administration","planning","benchmarking"]},{"location":"janssen-server/planning/caching/","title":"Caching","text":"<p>There are two reasons to use caching. First, to improve performance by reducing the number of writes to the disk. Second, to share session data in a clustered deployment. Janssen supports a few different options for caching, as controlled by the <code>cacheProviderType</code>. Also keep in mind that unless the <code>sessionIdPersistInCache</code> is set to <code>True</code>, Auth Server will store sessions in the database.</p> <ol> <li> <p>In-Memory If you only have one server, you can use RAM as the cache. Watch the memory usage of Auth Server--if it gets too high you may want to switch to another cache mechanism.</p> </li> <li> <p>Database A \"database cache\" is an oxymoron. But in cases where you don't want another component or service, but you need the session replication for a cluster, it may be convenient to persist the \"cache\" data in the database.</p> </li> <li> <p>Redis The best choice if you need a cache service for RDBMS, or Spanner. Great performance and low cache miss rate. Commercial Redis supports TLS, which is a good option if you need secure communication.</p> </li> <li> <p>Memcached Still a good choice, especially if that's what you already run for other applications. We have observed a slightly higher cache miss rate under high load, which is fairly atypical for most login applications.</p> </li> <li> <p>Cloud Cache Amazon ElastiCache or Google Memorystore offers both Redis and Memcached managed services. They work fine.</p> </li> </ol>","tags":["administration","planning","caching","Redis","Memcached"]},{"location":"janssen-server/planning/central-auth-service/","title":"Central Auth Service","text":"<p>Older monolithic web access management platforms from the 2000s had features to allow central policy management--what users can access what resources. But modern federated digital identity platforms generally do not. That's true for two reasons. First implementing all the OAuth and OpenID features is already a wide swath of requirements. Second, policy management, or authorization, has itself become a nice market. Note the policy management platforms list in the RBAC planning guide page.</p> <p>With that said, if the number of policies is low, there are some ways to use Jans Auth Server as a central policy decision point. You could use the presence of OAuth scopes to signal to the policy enforcement point the extent of access. In this case, policies could be implemented as code in the Update Token interception script. A similar strategy is to use UMA access tokens (\"RPT tokens\"), in which case you would use either the RPT interception script or the claims gathering interception script to implement your policies (or a combination of both).  But this approach should be used with caution. Most of the policy management tools today use a declarative language for policies. Maintaining policies in code does not scale as well.</p>","tags":["administration","planning","integration"]},{"location":"janssen-server/planning/certificates-keys/","title":"JSON Signing and Encryption","text":"<p>Janssen uses keys for signing and encryption, primarily concerning JSON documents. There are six IETF RFCs that provide considerable detail:</p> <ul> <li>RFC 7515 JSON Web Signing (JWS)</li> <li>RFC 7516 JSON Web Encryption (JWE)</li> <li>RFC 7517 JSON Web Key (JWK)</li> <li>RFC 7518 JSON Web Algorithms (JWA)</li> <li>RFC 7519 JSON Web Signing (JWT)</li> <li>RFC 7520 Examples of Protecting Content Using JSON Object Signing and Encryption (JOSE)</li> </ul>","tags":["administration","planning","certificates","keys","cryptography","JCE","HSM","FIPS"]},{"location":"janssen-server/planning/certificates-keys/#auth-server-supported-signing","title":"Auth Server Supported Signing","text":"JWT Type Algorithms DPOP RS256, RS384, RS512, ES256, ES384, ES512, PS256, PS384, PS512 Authorization HS256, HS384, HS512, RS256, RS384, RS512, ES256, ES384, ES512, ES512, PS256, PS384, PS512 Request Object HS256, HS384, HS512, RS256, RS384, RS512, ES256, ES384, ES512, PS256, PS384, PS512 Userinfo HS256, HS384, HS512, RS256, RS384, RS512, ES256, ES384, ES512, PS256, PS384, PS512 Token Endpoint Auth HS256, HS384, HS512, RS256, RS384, RS512, ES256, ES384, ES512, PS256, PS384, PS512 ID Token HS256, HS384, HS512, RS256, RS384, RS512, ES256, ES384, ES512, PS256, PS384, PS512","tags":["administration","planning","certificates","keys","cryptography","JCE","HSM","FIPS"]},{"location":"janssen-server/planning/certificates-keys/#auth-server-supported-encryption","title":"Auth Server Supported Encryption","text":"Encryption Methods Algorithms Authorization A128CBC+HS256, A256CBC+HS512, A128GCM, A256GCM id_token A128CBC+HS256, A256CBC+HS512, A128GCM, A256GCM Request object A128CBC+HS256, A256CBC+HS512, A128GCM, A256GCM Userinfo A128CBC+HS256, A256CBC+HS512, A128GCM, A256GCM Encryption Algorithms Algorithms Userinfo RSA1_5, RSA-OAEP, A128KW, A256KW id_token RSA1_5, RSA-OAEP, A128KW, A256KW authorization RSA1_5, RSA-OAEP, A128KW, A256KW request object RSA1_5, RSA-OAEP, A128KW, A256KW","tags":["administration","planning","certificates","keys","cryptography","JCE","HSM","FIPS"]},{"location":"janssen-server/planning/certificates-keys/#java-cryptographic-engine-jce","title":"Java Cryptographic Engine (JCE)","text":"<p>Janssen projects ships and tests with the Bouncy Castle Crypto API's JCE. However, you may substitute your own JCE as long as it has implementations for the algorithms used by Auth Server.</p>","tags":["administration","planning","certificates","keys","cryptography","JCE","HSM","FIPS"]},{"location":"janssen-server/planning/certificates-keys/#key-rotation","title":"Key Rotation","text":"<p>OpenID Connect clients must support the rotation of both signing and encryption keys. The best practice is to rotate often--the default configuration in a VM installation of Auth Server is every two days. The reason for such a frequent rotation is to make sure developer account for rotation at the time they create applications--lest they forget and their software breaks a year later when rotation happens.</p> <p>In a single VM deployment, key rotation is controlled by Auth Server. But in a clustered deployment, key rotation has to happen centrally. Janssen includes a key rotation service for cloud deployments.</p>","tags":["administration","planning","certificates","keys","cryptography","JCE","HSM","FIPS"]},{"location":"janssen-server/planning/certificates-keys/#certificates","title":"Certificates","text":"<p>X.509 is used extensively for web server TLS. But it is also used for Mutual Transport Layer Security (MTLS), either initiated by a software client, or presented by a person (i.e. a personal certificate). MTLS is generally implemented in the web tier.</p>","tags":["administration","planning","certificates","keys","cryptography","JCE","HSM","FIPS"]},{"location":"janssen-server/planning/certificates-keys/#fips","title":"FIPS","text":"<p>To support FIPS 140-2 conformance, you must use a FIPS approved JCE, and preferably, use an operating system that has FIPS Enforcement, like RHEL 8.</p>","tags":["administration","planning","certificates","keys","cryptography","JCE","HSM","FIPS"]},{"location":"janssen-server/planning/components/","title":"Components Overview","text":"<p>This page has a brief description of the major components of a Janssen deployment.</p> <ol> <li> <p>Auth Server: This component is the OAuth Authorization Server, the OpenID Connect Provider, and the UMA Authorization Server--this is the main Internet-facing component of Janssen. It's the service that returns tokens, JWTs, and identity assertions. This service must be Internet-facing.</p> </li> <li> <p>Database: Like most IAM platforms, Janssen requires some kind of persistence service to store configuration and other entity data (client, person, scope, attribute, FIDO device, etc.) As different databases are good for different deployments, Janssen supports MySQL and Postgres.</p> </li> <li> <p>Cache: Getting data from a disk is still the slowest part of any web platform. If you want higher transaction speeds, one strategy is to use a memory cache instead of the disk (i.e. database). Janssen was designed to store short-lived objects in the cache, like the <code>code</code> in the OpenID code flow (which is only used one time) or access tokens, which only live for a few minutes. Currently, Janssen has three options for cache: <code>in-memory</code>, which is suitable only for one node VM deployments; <code>redis</code> which is probably your best option; and <code>memcached</code> which you should use if a Redis cache service is not available (and tends to have more cache misses under high volume).</p> </li> <li> <p>Key Management Janssen does a lot of cryptographic signing and encryption. Where you store the private keys has an impact on the security of your Janssen platform. For cloud deployments, many providers are providing key storage as a service. You could also use the file system or an HSM.</p> </li> <li> <p>FIDO2:  This component provides the server side endpoints to enroll and validate devices that use FIDO. It provides both FIDO U2F (register, authenticate) and FIDO 2 (attestation, assertion) endpoints. This service must be internet facing.</p> </li> <li> <p>Config API: The API to configure the auth-server and other components is consolidated in this component. This service should not be Internet-facing.</p> </li> <li> <p>SCIM: SCIM is JSON/REST API to manage user data. Use it to add, edit and update user information. This service should not be Internet facing.</p> </li> <li> <p>CLI: While you can use <code>curl</code> to call the Config API, CLI is a command line tool that provides a simple single line options for configuration. In the background, it is just calling the Config API. To authenticate, you'll use the OAuth Device flow. The CLI need not be on the same server as any of the components (you can run it from your desktop). But you will need network connectivity to the Config API and the Auth Server.</p> </li> <li> <p>TUI: A menu-driven interactive tool for configuration, the \"TUI\" or \"text user interface\" might resemble a 90's BIOS configuration, but it gets the job done without the need for a web browser. Like the CLI, you can run it from anywhere, but need connectivity to the Config API and Auth Server. The TUI writes a \"CLI log\"--the one-liner you could have executed to do whatever you just did in the interface. This will help you if you want to script stuff later on.</p> </li> <li> <p>Jans Core: This library has code that is shared across several Janssen projects. You will most likely need this project when you build other Janssen components.</p> </li> <li> <p>Jans ORM: This is the library for persistence and caching implementations in Janssen. Currently,only RDBMS is supported. </p> </li> <li> <p>Agama: The Agama module offers an alternative way to build authentication flows in Janssen Server. With Agama, flows are coded in a DSL (domain specific language) designed for the sole purpose of writing web flows.</p> </li> <li> <p>Setup: Configuring a Janssen Auth Server platform is complicated. How do you generate the keys and certificates? How do you generate the minimal data set to start your system? The setup component helps you bootstrap a minimal system.</p> </li> </ol>","tags":["administration","planning","components","architecture"]},{"location":"janssen-server/planning/customization/","title":"Customization and Localization","text":"<p>You can customize just about everything in the Janssen Platform.  That's pretty much the point of running your own identity platform. This includes the look and feel of the web pages, the language of the user-facing content, the behavior of endpoints, error messages, and more.</p>","tags":["administration","planning","localization","international","language"]},{"location":"janssen-server/planning/customization/#behavior-of-endpoints","title":"Behavior of endpoints","text":"<p>Almost every endpoint has an interception script, which enables you to implement custom business logic. For a more general discussion of the extensibility of the Janssen platform, see the Developer Guide.</p>","tags":["administration","planning","localization","international","language"]},{"location":"janssen-server/planning/customization/#web-content","title":"Web content","text":"<p>There are several front channel flows in Auth Server (front channel = web browser):</p> <ol> <li>OpenID User Authentication</li> <li>OpenID Consent</li> <li>Post-Authentication</li> <li>UMA Claims Gathering</li> </ol> <p>Each of these scripts contains a method which is similar to <code>getPageForStep</code> which fetches the respective Facelets <code>xhtml</code> file for that step. Facelets is very friendly to designers, as it's possible to mix content such as regular HTML with JSF components. Thus Facelets pages can have both static and dynamic content and leverage all your \"normal\" web design tools like CSS and JavaScript. Facelets also support templates. Each <code>.xhtml</code> page has access to the authentication context, and you can insert data from the respective interception script. Also, each <code>.xhtml</code> page is unique and has a built-in state identifier, preventing Auth Server from responding to any page which it did not render. For more information, see the Developer Guide.</p> <p>Note, in the <code>getPageForStep</code> method, you can have a conditional statement to return different pages based either on the detected or requested language of the subject.</p>","tags":["administration","planning","localization","international","language"]},{"location":"janssen-server/planning/customization/#error-messages","title":"Error messages","text":"<p>You can change the descriptions for the various front-channel Auth Server error messages, for example, what would Auth Server return for a bad request to the Authorization Endpoint. Of course, you can also customize the web server error messages, like 404, by configuring your web server.  Auth Server should never return a stackTrace.</p>","tags":["administration","planning","localization","international","language"]},{"location":"janssen-server/planning/customization/#localization-for-openid-connect-client-metadata","title":"Localization for OpenID Connect client metadata","text":"<p>Because client information may be displayed via the OpenID protocol, language support is needed at the client level. For example, the client name, description, terms of service URI, or logo may differ based on the end user's language.</p> <p>Section 2.1 of OpenID Connect Client Registration, Metadata Languages and Scripts states:</p> <p>Human-readable Client Metadata values and Client Metadata values that reference human-readable values MAY be represented in multiple languages and scripts. For example, values such as client_name, tos_uri, policy_uri, logo_uri, and client_uri might have multiple locale-specific values in some Client registrations.</p> <p>To specify the languages and scripts, BCP47 language tags are added to Client Metadata member names, delimited by a <code>#</code> character. For example, the value for <code>tos_uri#ja-Hani-JP</code> would direct the subject to the terms of service agreement in Japanese.</p> <p>Janssen does not yet support languages syntax for OpenID user claims, as described in OpenID Core Section 5.2, Claims Languages and Scripts.</p>","tags":["administration","planning","localization","international","language"]},{"location":"janssen-server/planning/delegated-user-admin/","title":"Delegated User Admin","text":"<p>Delegated user administration is normally implemented via a website where a privileged user can search / add / edit / delete people in their organization. You will not be surprised to hear that this is an identity management use case that Janssen Auth Server does not provide out of the box.</p> <p>But if you wanted to build a website that performed this function, you could use the SCIM protocol to do so. In your application, you could read the user claims to find out the organization, role, or other information about the person managing data. Then your web application could use this information to make filters when making SCIM calls. Or another handy trick is to put the person's role information in an OAuth access token (using the Update Token script), and then use the SCIM interception script to add the respective filters.</p>","tags":["administration","planning"]},{"location":"janssen-server/planning/discovery/","title":"Discovery","text":"<p>In a federated identity topology, you can authenticate a person by redirecting their browser to the correct IDP. But what happens when there is more then one IDP? Before the person authenticates, how do you know to which IDP to send them? This challenge is called \"discovery\", \"where are you from\", or \"WAYF\".</p> <p>There are a few ways to handle discovery. Here are a few:</p> <ol> <li> <p>Display a list of logos and enable the end user to pick the IDP. If you ever clicked on a social login button, you've experienced this approach.</p> </li> <li> <p>Use a different URL for each IDP, like <code>https://customer1.saas.com</code> or <code>https://saas.com/customer2</code>. Based on which URL the person hits, you know where to send them.</p> </li> <li> <p>Prompt the person to enter something identifying, like their email address. You can use this to look up their home IDP.</p> </li> <li> <p>Use contextual information, like network address, geolocation, or browser data.</p> </li> </ol> <p>Once you've figured out the person behind the browser, it may make sense to write a cookie so next time, you don't have to bother them.</p> <p>While it's possible to implement a discovery workflow using an Agama script or an Auth Server person authentication interception script, you also write a simple web application, and then redirect to the authorization endpoint with a hint as an extra parameter and a specific <code>acr_values</code>.</p>","tags":["administration","planning","discovery"]},{"location":"janssen-server/planning/dns/","title":"DNS","text":"<p>Trust in the Internet is largely derived from TLS. Like it or not, we are highly reliant on making a secure connection from a web browser using X.509 security to ensure that we are connecting to a trusted web server. The <code>cn</code> of that web server certificate is the hostname of the server. There is no guarantee that a two distinct trusted root CA's have not issued duplicate certificates for the same hostname. Thus, if your DNS server is hacked, bad things may ensue. This is not a hypothetical risk. Actual attacks have been implemented by adding entries to a DNS server that look real, but point to the attacker's website. DNS attacks are very difficult for the end-user to detect. For example, <code>https://account.acme.com</code> v. <code>https://accounts.acme.com</code>--both would look ok to a typical end user. So rule number one: PROTECT DNS--the whole integrity of your identity platform is otherwise vulnerable.</p> <p>From a deployment perspective, remember that in most cases the hostname of your IDP points to the HTTP load balancer (unless you have a single VM deployment). In most cases, you will also terminate TLS in the load balancer.</p> <p>The DNS hostname is baked into the protocols. For example, the authorization endpoint may look like this:</p> <pre><code>\"authorization_endpoint\" : \"https://account.acme.com/jans-auth/restv1/authorize\"\n</code></pre> <p>Note that the hostname is built into the protocol, not just the Web TLS layer. If you were to change the hostname of your web server, your deployment would break, because you would have to update all the configuration data in the IDP that contains the hostname too. And you'd have to regenerate any X.509 certificates.  For this reason, you should think carefully about the hostname before you run setup and create the base installation of your Janssen Platform. To change the hostname, we recommend you re-install. If you want to promote your configuration from development to production, you may also need to consider keeping the hostname the same--although be careful you don't hit production by mistake in your testing.</p>","tags":["administration","planning","DNS","hostname","TLS","X.509"]},{"location":"janssen-server/planning/identity-access-governance/","title":"Identity Access Governance","text":"<p>Janssen is not a governance platform, so it does not do any of the following:</p>","tags":["administration","planning","IAG","Identity Governance"]},{"location":"janssen-server/planning/identity-access-governance/#role-management","title":"Role Management","text":"<p>Role Based Access Control (RBAC) is a strategy used by many organizations to authorize access to resources. However, RBAC has a dark side: if roles are used to reference each unique access requirement the number of roles can grow exponentially. In fact, some organizations have more roles than people! This is known as \"role explosion.\" Role Management is an enterprise workforce governance practice which correlates roles across all applications to reduce their number to the lowest common denominator of \"enterprise roles\".</p>","tags":["administration","planning","IAG","Identity Governance"]},{"location":"janssen-server/planning/identity-access-governance/#access-certification","title":"Access Certification","text":"<p>The role request and approval processes tend to result in a person accumulating many roles over time. However, because removal of roles no-longer-needed is often overlooked, it's important for organizations to regularly perform access certification campaigns (i.e. \"recertification\" or \"attestation\"). For example, once per year, managers may need to decide if the roles assigned to subordinate employees are still needed.</p> <p>Removal of a non-sensitive role is not an urgent matter. However, certain situations might require faster action, for example if an employee is moved to a different organizational unit with a different manager. The new manager assumes responsibility for the employee's roles, and should execute an ad-hoc recertification process for that specific user.</p>","tags":["administration","planning","IAG","Identity Governance"]},{"location":"janssen-server/planning/identity-access-governance/#segregation-of-duties","title":"Segregation of Duties","text":"<p>Sometimes an organization should prevent a person from having two roles simultaneously. For example, there could be an account rule that a person can't both sign and approve checks. Or a person can't perform both financial advisory and equity trading. The governance platform may enable organizations to define these Segregation of Duties to prevent such conflicts of interest.</p>","tags":["administration","planning","IAG","Identity Governance"]},{"location":"janssen-server/planning/identity-management/","title":"Identity Management","text":"<p>In Janssen docs, the term Identity Management or \"IDM\" is the process of adding, editing and deleting data in various domain systems. Ideally, identity data would exist in only one place. But this ideal is currently undesirable. For performance, data joins, auditing, and many other reasons (for the foreseeable future) identity data is sprinkled across many systems. So when we update identity data, how do we keep all our infrastructure up-to-date? This task has been the realm of IDM platforms, which enable organizations to define workflows to update identity information, and through the use of \"connectors\", to push this data to all disparate databases.</p> <p>IDM platforms range in size and complexity. An admin could write a Python script to automate adding new users to a domain. Large enterprises may implement a commercial IDM platform, like Sailpoint or an open-source IDM platform like Evolveum Midpoint. Or you might have a human IDM--\"Hey Bob, we hired a new person. Can you add her?\"</p> <p>The Janssen platform does not include an IDM component. Fundamentally, Janssen is a consumer of identity data. One of the most common ways for identity data to make its way to the Janssen database is via the SCIM interface. This is an API that has a <code>/users</code> endpoint, to which an IDM system can send updates. For example, the IDM system may <code>POST</code> to the <code>/users</code> endpoint to add a new user to the Janssen database, or <code>DELETE</code> to the <code>/users</code> endpoint to remove a user.</p> <p>With that said, sometimes organizations might encode IDM business logic in the Janssen platform. This is particularly true for consumer-facing applications. In general, it only works for relatively simple requirements, particularly when the Janssen platform is the authoritative source of identity data. Using the various interception scripts, it's possible to send identity data from the Janssen platform to external systems. For example, let's say an organization has only two silos of identity data: Jans Auth Server and a MongoDB database record. In a case like this, when a person registers through a Person Authn Interception Script or Agama flow, you could call an API which updates the MongoDB database. It's also possible to implement approval workflows using UMA. For example, an API might require an UMA access token (i.e. an RPT token), and obtaining this token may require the consent of two different individuals.</p> <p>But it is worth remembering that the Janssen Platform was not purpose-built for IDM, and therefore any implementation for such use cases should be tactical. You may have to build many features yourself. Especially for enterprise workforce applications, you should seriously consider using off-the-shelf software before writing too much code in Janssen.</p>","tags":["administration","planning","IDM","Identity Management","SCIM"]},{"location":"janssen-server/planning/kubernetes/","title":"Kubernetes","text":"<p>This planning guide helps you learn about when to use Jans with Kubernetes, why to use it, an overview of best practices around it, platforms supported and important tools that can help ease the operations.</p>","tags":["administration","planning","kubernetes"]},{"location":"janssen-server/planning/kubernetes/#the-when-and-why","title":"The When and Why?","text":"<p>Whether to use Kubernetes , VM or a cluster of VMs depends on answering several key questions some of which are:</p>","tags":["administration","planning","kubernetes"]},{"location":"janssen-server/planning/kubernetes/#whats-the-size-of-my-organizationcustomer-serving-base","title":"What's the size of my organization/customer serving base?","text":"<p>Answering this question gives the load of authentications per second expected which determines if you are in the threshold of operating a VM for Jans. Anything past 50 auths per second points to a cluster setup which is curerntly Kuberentes. We do plan to support more cloud-native setups soon.</p>","tags":["administration","planning","kubernetes"]},{"location":"janssen-server/planning/kubernetes/#can-my-organization-handle-min-hrs-of-downtime","title":"Can my organization handle  min-hrs of downtime?","text":"<p>This ties to question 1 but even with the best operational automation VM setups restoring/patching a VM will result in downtime.</p>","tags":["administration","planning","kubernetes"]},{"location":"janssen-server/planning/kubernetes/#does-my-organization-function-in-different-regions","title":"Does my organization function in different regions?","text":"<p>If your organization works in several regions a VM setup is almost immediately ruled out.</p>","tags":["administration","planning","kubernetes"]},{"location":"janssen-server/planning/kubernetes/#does-my-organization-expect-to-double-in-growth-each-year-or-possibly-faster","title":"Does my organization expect to double in growth each year? or possibly faster?","text":"<p>If your organization or your customer base is growing fast rule out a VM setup.</p>","tags":["administration","planning","kubernetes"]},{"location":"janssen-server/planning/kubernetes/#is-this-an-on-premise-vs-hybrid-vs-cloud-deployment","title":"Is this an on-premise vs hybrid vs cloud deployment?","text":"<p>This question weighs on the current infrastructure of your organization. Operating on-premise Kubernetes setups needs generally more technical resources than operating a cloud setup. Comparing that to a VM setup, operating a VM setup is much easier in on-premise setups. The more the momentum of your org pulls to cloud vs onpremise the more it pulls to Kuberetnes vs a VM setup respectively.</p>","tags":["administration","planning","kubernetes"]},{"location":"janssen-server/planning/kubernetes/#whats-my-organizations-technical-expertise-level-on-kubernetes-vs-vms","title":"What's my organizations technical expertise level on Kubernetes vs VMs?","text":"<p>This determines the amount of investment needed to overcome the learning curve to operate a Kubernetes cluster. If your Kubernetes technical resources are low and the above questions point to a VM setup you should think about going with a vm setup. If you got conflicting answers above, for example if the customer size dedicated that you should operate a Kubernetes cluster you need to invest in your technical staff. If you are on the borderline invest in your Kubernetes technical staff while operating a vm setup and prepare to move in the near future.</p>","tags":["administration","planning","kubernetes"]},{"location":"janssen-server/planning/kubernetes/#does-the-deployment-need-to-be-highly-availableha","title":"Does the deployment need to be highly available(HA)?","text":"<p>We recommend using Kubernetes-based CN deployments for situations where high availability is a critical factor. Though VM cluster can provide high availability, we do not recommend the HA setup with VMs. Primarily because effort required to upgrade multiple servers and configuring them is much more as compared to a cloud-native deployment and it is error-prone. We recommend you follow the CN setup for HA as you will get automatic upgrades, patches with a single helm upgrade command.</p> <p>In general the Kubernetes deployment offers an easy deployment strategy with a helm chart and an easy upgrade path but taking the above into account is very important.</p>","tags":["administration","planning","kubernetes"]},{"location":"janssen-server/planning/kubernetes/#the-supported-clouds","title":"The Supported Clouds","text":"<p>We support several clouds managed Kubernetes solutions but that doesn't mean our setup will not work with other managed Kubernetes solutions. In fact, our Kubernetes setup is expected to work across almost all managed solutions however those not listed below were not tested.</p> <ul> <li>AWS </li> <li>GCP</li> <li>Azure</li> <li>DOKS</li> </ul>","tags":["administration","planning","kubernetes"]},{"location":"janssen-server/planning/kubernetes/#localhybrid","title":"Local/Hybrid","text":"","tags":["administration","planning","kubernetes"]},{"location":"janssen-server/planning/kubernetes/#rancher","title":"Rancher","text":"<p>Rancher UI can be deployed to several clouds / multi-clouds and also be used to manage local setups.</p>","tags":["administration","planning","kubernetes"]},{"location":"janssen-server/planning/kubernetes/#important-tools-and-tech-to-consider","title":"Important tools and tech to consider","text":"<ul> <li>Helm</li> <li>Terraform</li> <li>Prometheus and Grafana</li> <li>Pipeline tech such as Jenkins, Ansible, Cloud Build etc.</li> </ul>","tags":["administration","planning","kubernetes"]},{"location":"janssen-server/planning/load-balancers/","title":"Load Balancers","text":"<p>Janssen Auth Server is stateless, so you can spool up as many instances as your load requires. But as there is only one hostname, you need a way to distribute the requests. Typically, this is where a load balancer comes in.  The load balancer also terminates the SSL connection, which offloads the cryptographic compute from the application. In cloud-native jargon, load balancing is called HTTP Ingress.</p> <p>In your load balancer configuration, you can use any routing algorithm. There is no need for \"sticky sessions\", or whatever the load balancer you are using calls that. For example, it's ok to use even round robin. Although modern HTTP ingress controllers enable some very flexible routing options to do A/B testing and zero downtime updates.</p> <p>As Janssen Auth Server doesn't really care what load balancer you use, some options you might want to consider are:</p> <ol> <li> <p>Apache HTTPD</p> </li> <li> <p>nginx</p> </li> <li> <p>istio</p> </li> <li> <p>f5</p> </li> <li> <p>Amazon Elastic Load Balancing</p> </li> <li> <p>Google Cloud Load Balancing</p> </li> </ol>","tags":["administration","planning","load balancer","nginx","apache HTTPD","istio"]},{"location":"janssen-server/planning/machine-to-machine/","title":"Machine-to-Machine","text":"<p>OAuth gives us a perfect infrastructure for one machine (i.e. software) to authenticate itself while calling an API of another machine: the Client Credential Grant. The software receiving the token can validate the access token signature, or if it's a reference token, can use OAuth Introspection.</p> <p>For extra security, the software in question can also use mutual TLS to authenticate.</p> <p>The OAuth Authorization Server can also send extra security context, like scopes (which typically communicate the extent of access), or other information about the software vendor or characteristics.</p> <p>Of course this requires the devices in this machine-to-machine scenario to have a tcp stack (some constrained IOT devices only have a UDP stack).</p>","tags":["administration","planning"]},{"location":"janssen-server/planning/multi-tenancy/","title":"Multi-tenancy","text":"<p>Multitenancy is a software architecture where several distinct customers can utilize a single software instance. For a federated identity platform, this presents a number of challenges:</p> <ol> <li>Privacy: Customers must only see their own user information and data</li> <li>Trust: Customers trust a distinct set of RPs</li> <li>Authorization: Customers have specific policy requirements</li> <li>UX: Customers brand all user-facing web pages and messages</li> <li>Logs: Customers see only their own log</li> <li>Custom Business Logic: Customers have special rules, for example, to authenticate users, register clients, or issue access tokens.</li> <li>Cryptographic Keys: Customers have their own keys</li> <li>URLs: Customers host the IDP using their own domain name</li> <li>Quality of Service: Customers control response time and concurrency</li> <li>Access: Customers can access systems and data directly</li> </ol> <p>One key decision to make with regard to multitenancy is which systems to share. You could share nothing, which lowers deployment complexity but increases operational complexity. Or you could share everything, which is easier to operate, saves money on hardware, but requires a lot more code. Or you could land somewhere between--share some systems, but not others.</p> <p>If you want to address all the challenges of multitenancy, then a \"shared nothing\" approach makes the most sense. And with advances in cloud-native deployment, gitops, and configuration as code, you can approach the cost savings of \"shared everything\" multitenancy today, especially if you leverage serverless, just in time auto-scaling. However, you will need some cloud-native devops gurus to pull this off.</p> <p>If having one top-level domain is acceptable, it is possible to add a <code>tenant_id</code> property to each entity (for example, client and person entities). Auth Server and SCIM interception scripts enable you to filter results by adding this <code>tenant_id</code> to queries behind the scenes. For example, you could also render different login pages by using <code>default_acr_values</code> for clients.</p> <p>It's possible in the future Janssen Project will implement some kind of support to bundle a multitenancy approach that captures some of the properties described above at the code level, but for the time being, it is not a priority.</p>","tags":["administration","planning","multitenancy"]},{"location":"janssen-server/planning/overview/","title":"Deployment and Planning Guide","text":"<p>This Deployment Guide will help you plan how to launch a digital identity service for your organization. It will hopefully answer many of the \"why\" questions, not just the \"how\" questions, setting the stage for what challenges are in scope for Janssen--and where you may need to use other software.  It addresses some common questions that don't quite fit into other parts of the Janssen docs.</p> <p>By covering the key features and designs, hopefully, this guide will help you understand the different deployment options available, when to use each, and how to right-size your Janssen identity services.</p> <p>The audience for this deployment guide includes technical architects, designers, developers, and Janssen administrators.</p> <p>Contribute</p> <p>If you\u2019d like to contribute to this document, get started with the Contribution Guide</p>","tags":["administration","planning","deployment"]},{"location":"janssen-server/planning/passwordless-auth/","title":"Passwordless Auth","text":"<p>Auth Server is not proscriptive about how an organization authenticates a person. If you want to avoid passwords, that's great. Everyone knows passwords are terrible.</p> <p>Modern authentication flows use a series of web pages to mitigate sufficient risk, enabling them to issue an assertion about the subject's identity. In order to perform authentication, identification is a given. This implies that all authentication flows normally start with the subject asserting some kind of identifier: username, email address, phone number, or any other identifier that uniquely identifies a person. Auth Server is not opinionated about how you do this. You could prompt the user to enter their identifier. Or for example, you could ask the user to scan a QR code, and identify a phone identified with a person.</p> <p>With identification done, Auth Server can present any number of additional web pages to establish that identity. These pages can ask for any \"factors\". For example, if you want to perform two factor authentication in one step, you could use a FIDO 2 credential, which combines possession with either knowledge or biometric. But in practice, you could ask for any one or more combinations of credentials--none of which must include a password.</p> <p>Net-net, \"passwordless\" is really just marketing jargon. Normally it implies some kind of risk assessment to optimize user experience. If you can imagine any such authentication flow, you can implement it in Auth Server.</p>","tags":["administration","planning","passwordless"]},{"location":"janssen-server/planning/persistence/","title":"Persistence","text":"<p>The performance of the web tier is derived from the performance of the persistence tier. While memory-caching short lived entities to reduce persistence is an option, there are still long lived objects that need to be written to the disk.</p> <p>Picking the right database has a huge impact on the operational burden of a digital identity infrastructure. All database administration requires some black art--every platform has some secret knobs and levers that are critical to tuning, availability and rapid diagnosis. So beyond the performance requirements that determine the right choice for a database, you also need to consider operational concerns.</p> <p>Janssen's strategy is to provide optionality for persistence. There is no one size fits all solution for databases. The following section will detail some of the pros and cons of the various databases we currently support.</p> <ol> <li> <p>MySQL You know it... you love it. That's the biggest advantage. Performance is great out of the box. But if you have high concurrency, you'll have to figure out a plan for replication, and horizontal scaling.  MySQL is our default persistence for Production deployments using Kubernetes.</p> </li> <li> <p>Postgres Same as MySQL above, but there are some great commercial distributions of Postgres like EnterpriseDB. Postgres is our default  persistence for VM based non-production deployments.</p> </li> <li> <p>Aurora So you want MySQL, but you want Amazon to handle some of the care and feeding? Aurora enables you to consume database as a cloud service. Scalability is excellent and multi-region deployments are possible. The main catch is that write operations are limited to one region, with the ability to failover to another region. But to accomplish this, you need a cloud engineer to implement it.</p> </li> </ol>","tags":["administration","planning","persistence","MySQL","Aurora","Postgres","database"]},{"location":"janssen-server/planning/platform-goal/","title":"Mission","text":"<p>Make it easier for organizations to innovate and scale open source, standards-based identity services.</p>","tags":["administration","planning","platform-goals"]},{"location":"janssen-server/planning/platform-goal/#scale","title":"Scale","text":"<p>Using Janssen Project software, organizations can build runtime identity services to meet 100% of their requirements for enrollment, authentication, credential management, and authorization. The Janssen Project includes software tools and services for deploying, operating, testing, and developing identity infrastructure at scale.</p> <p>Scale is more than cloud-native design patterns. To truly scale, domains have to consider the people and organizational challenges. To scale domains need to:</p> <ul> <li>manage the complexity and cost of integrating multiple technologies,   platforms, and vendors that may not be compatible or interoperable</li> <li>ensure the security and compliance of data and transactions   across different systems, networks, and  jurisdictions, especially when   dealing with sensitive or regulated information</li> <li>adapt to the changing and unpredictable demands of customers, markets, and   deliver fast and reliable services; domains must develop and   share the skills and talent needed to design, implement, and operate   scalable identity infrastructure, and foster a culture of innovation and   collaboration among teams</li> <li>balance the trade-offs between scaling up (adding more resources within a   system) and scaling out (adding more systems across a network), and choosing   the optimal architecture and configuration for different workloads and   scenarios.</li> </ul> <p>At the Janssen Project, we are doing our best to address all these challenges with regard to scaling identity infrastructure.</p>","tags":["administration","planning","platform-goals"]},{"location":"janssen-server/planning/platform-goal/#security","title":"Security","text":"<p>Janssen Project tackles the most challenging security requirements. This means keeping current with OpenID and FIDO self-certifications, creating distributions that enables conformance with FIPS 140-2, and implementing best practices for software development.</p> <p>Janssen Project is unapologetically Java. The reason is simple: Java has the most cryptographic implementations. Java Cryptographic Engines (JCE) are written by many companies and open-source projects. It takes a long time to trust a cryptographic implementation. Not only does Java have the most options for cryptography, but it also has some of the most trusted implementations. And when new algorithms are announced, Java SDKs are usually first.</p>","tags":["administration","planning","platform-goals"]},{"location":"janssen-server/planning/platform-goal/#community","title":"Community","text":"<p>In 2020, Gluu contributed the code to the Linux Foundation Janssen Project. One of the main reasons this was undertaken was to expand the size of the community. Developers don't want to contribute to a project that might change the license at any moment (e.g. Hashicorp, Elastic, MongoDB).</p> <p>There is room for many companies to productize the Janssen Project software. Governments can feel safe using the Janssen Project--it's been recognized as a Digital Public Good. A healthy ecosystem for infrastructure software results in long-term innovation velocity.</p> <p>With the introduction of Agama, we're hoping that developers will have an opportunity to build connectors to third-party systems and services. Gluu is hosting the Agama Lab Explore Catalog to help developers publish their Agama projects, making it easier for the community to find ready-built projects that encourage the re-use of code.</p>","tags":["administration","planning","platform-goals"]},{"location":"janssen-server/planning/platform-goal/#deployment","title":"Deployment","text":"<ul> <li> <p>Developers should have distributions to enable rapid testing for non-production instances.</p> </li> <li> <p>Linux system administrators should have packages for easy installation and update of non-clustered deployments.</p> </li> <li> <p>Cloud-native engineers should have assets for high-end deployments, including high concurrency and high availability.</p> </li> </ul>","tags":["administration","planning","platform-goals"]},{"location":"janssen-server/planning/role-based-access-management/","title":"Role Based Access","text":"<p>Using roles to control access to resources makes sense for lots of security use cases. One benefit of RBAC is that it's deterministic-- from an audit perspective, you can tell who had access to what at any point in time. This is harder to achieve when contextual variables play a role in determining access.</p> <p>An OpenID Provider / OAuth Authorization Server like Jans Auth Server certainly has a role to play in the implementation of an RBAC infrastructure, but is not capable of delivering all the functionality your organization will need for a complete solution. For example, you may need a platform to define enterprise roles or to perform role consolidation. This is normally handled by an identity governance tool. Also, Jans Auth Server is not a policy management platform, like * Styra OPA, OSO * Zanzibar, or * Hashicorp Boundary or * Apache Fortress</p> <p>The tools above are just a few open source policy management frameworks. There are more commercial products in this space.</p> <p>Although Jans Auth Server may not be a complete RBAC solution, there are still some RBAC capabilities to consider. When a person authenticates using a web browser, the client can obtain user claims via OpenID Connect. It may make sense to send the <code>role</code> role claim to the client. You may also send the <code>memberOf</code> claim, if your organization uses group membership to manage roles.</p> <p>But what if you need to dynamically compute roles? Or if you don't want to over-share by sending all the roles and groups associated for a person? One strategy is to use the Jans Auth Server Update Token Interception script to render the role claim, either in the OAuth access token, the <code>id_token</code> or the Userinfo JWT.</p>","tags":["administration","planning","RBAC","Role"]},{"location":"janssen-server/planning/security-best-practices/","title":"Security Best Practices","text":"<p>Janssen Project distributions are designed to be easy to deploy. Its default security settings may not be strict enough for certain organizations or use cases. This document highlights important security controls and offers best practices for increasing security related to your deployment.</p>","tags":["administration","planning","security","recommendations"]},{"location":"janssen-server/planning/security-best-practices/#scripts","title":"Scripts","text":"<p>Make sure only required scripts are enabled. It's extremely important to disable any person authentication or other scripts not in use.</p>","tags":["administration","planning","security","recommendations"]},{"location":"janssen-server/planning/security-best-practices/#keys","title":"Keys","text":"<p>Use RSA keys with a minimum strength of 2048 bits and Elliptic Curve keys with a minimum of 160 bits. Also, check the key rotation policy of your Auth Server. This differs based on your deployment model. A single server can handle key rotation locally, but if you have deployed a cluster, you must manage key rotation centrally.</p>","tags":["administration","planning","security","recommendations"]},{"location":"janssen-server/planning/security-best-practices/#admin-web-services","title":"Admin Web Services","text":"<p>Make sure SCIM and the config API are not Internet facing. If you do expose SCIM, you should network restrict access as much as possible. Although SCIM is protected via OAuth or UMA access tokens, because a breach of SCIM would undermine the integrity of authentications, a multi-layer security approach is warranted. There is no use case for an Internet facing Config API--you should tightly control access to this service.</p> <p>Make sure no services are listening on external interfaces except for those that are absolutely required--<code>tcp/443</code> for the OpenID and FIDO endpoints.</p> <p>On Linux servers, a list of current listeners can be obtained with <code>netstat -nlpt</code> (for TCP) and <code>netstat -nlpu</code> (for UDP). In particular, make sure the internal databases used by Gluu to store all its configuration are not Internet facing.</p>","tags":["administration","planning","security","recommendations"]},{"location":"janssen-server/planning/security-best-practices/#openid","title":"OpenID","text":"<p>Review the OAuth 2.0 Security Best Current Practice IETF draft.</p> <p>Don't use the implicit flow. In the implicit flow, the client is not authenticated, and a token is returned from the Authorization endpoint. If the <code>response_type</code> in your OpenID Authentication contains <code>token</code>, you are using the implicit flow. Section 2.1.2 of the current OAuth Security Best Practices OAuth working group draft specifically warns against using the implicit flow. If you must use the implicit flow, Review the CORS filter configuration for Jans Auth Server. CORS restricts access to trusted domains to execute browser application requests to Auth Server endpoints. By default, the filter allows any RP to call OpenID endpoints.</p> <p>Review Auth Server properties chosen for <code>sessionIdUnusedLifetime</code> and <code>sessionIdLifetime</code>. Long sessions present higher risks of session hijacking and unauthorized access from shared devices.</p>","tags":["administration","planning","security","recommendations"]},{"location":"janssen-server/planning/security-best-practices/#oauth-client-security","title":"OAuth Client Security","text":"<p>The table below summarizes the default values for dynamically registered clients.</p> Attribute Default Value applicationType web subjectType public idTokenSignedResponseAlg RS512 userInfoSignedResponseAlg RS512 userInfoEncryptedResponseAlg RSA-OAEP userInfoEncryptedResponseEnc RSA-OAEP accessTokenLifetime 3600 <p>Consider whether support of OpenID Connect Dynamic Client Registration extension is required. If not, disable it by setting <code>dynamicRegistrationEnabled</code> to <code>False</code>. If Dynamic Client Registration is enabled, consider using software statements, and writing a Client Registration interception script to implement extra rules for software statement validation.</p> <p>Check the list of scopes to quickly assess which scopes the clients can potentially add to their registration entry without consent of OP's administrator. Make sure sensitive scopes are <code>dynamicRegistrationScopesParamEnabled</code> set to False.</p> <p>The Auth Server property <code>dynamicRegistrationScopesParamEnabled</code> controls whether default scopes are globally enabled; scopes defined as default will be automatically added to any dynamically registered client entry.</p> <p>For client authentication at the token endpoint, move away from shared secrets-- use either private key authentication or MTLS. A client secret is basically a password for your software application. Utilize asymmetric client authentication.</p> <p>Make sure your OpenID client applications check the state value, and verify that it is the same state posted in the original request. This is necessary to prevent Cross Site Request Forgery (CSRF). Also make sure that clients use a non-static value for state (i.e. a one time non-guessable value). You can also verify the state in the <code>s_hash</code> claim of the id_token in the authentication response.</p> <p>This may sound obvious, but make sure your clients verify the signature of the id_token. The location of the current public keys of the OpenID Provider can be found in the configuration endpoint (<code>jwks_uri</code>). It is also recommended that clients implement a unique <code>redirect_uri</code> per OP.</p> <p>This may also sound obvious, but make sure you trust the OpenID Connect client software library that your developers are using to authenticate users. Also make sure OpenID Connect client libraries are updated expeditiously.</p> <p>Suggest to web developers that they read the OpenID Connect Basic Client Implementer's Guide, which provides a more reader-friendly narrative for how to use the OpenID code flow--the main flow for relying parties.</p> <p>Client developers should consider using a Request Object JWT, which prevents hackers from tampering with the request parameters. Request objects can mitigate the Malicious Endpoint Attack and the IDP confusion attack.</p> <p>Mobile developers should read RFC 8252 OAuth 2.0 for Native Apps and follow the recommendations there. It's really important not to store any client secret or private key in the application, because hackers can decompile applications to extract these secrets. That's why RFC 8252 recommends using PKCE to prevent Authorization Code Interception Attack, and use a SHA256 as the code challenge method. Use App Auth if possible for Android, iOS, or JavaScript.</p> <p>If additional client security is needed, consider using the FAPI profile of OpenID Connect, which adds additional signing, encryption and security mitigations.</p>","tags":["administration","planning","security","recommendations"]},{"location":"janssen-server/planning/security-best-practices/#uma","title":"UMA","text":"<p>The UMA protocol enables post-authentication authorization flows. Consider the following system-level properties:</p> <ul> <li> <p><code>umaGrantAccessIfNoPolicies</code> allows access to a resource even if no policies are defined for the related scopes; though it simplifies initial testing, we recommend disabling this feature in production setups</p> </li> <li> <p><code>umaRestrictResourceToAssociatedClient</code> won't allow any other client except the one that registered the resource initially to acquire a RPT for it; it's recommended to have it enabled for production setups</p> </li> </ul>","tags":["administration","planning","security","recommendations"]},{"location":"janssen-server/planning/self-service-password-2fa/","title":"Self-Service Password/2FA","text":"<p>If your domain offers two-factor authentication, it's a good idea to enable end users to manage their various credentials. Google does a great job in this regard. Check out 2-Step Verification. What's great about this page is that Google lets you manage all your different credentials on one page.</p> <p>You can build a page like Google on your own website. You need to be able to list, add, and remove 2FA credentials for a given user's account. But another good option is the Jans Casa web application.</p>","tags":["administration","planning","2FA","self-service","Account Recovery","Jans casa"]},{"location":"janssen-server/planning/stepped-up-auth/","title":"Stepped-up Auth","text":"<p>The holy grail of security policies since the introduction of RSA OTP tokens, stepped-up authentication is when the subject is presented with an additional authentication requirement, usually in response to perceived risk. As Jans How do you decide when to invoke stepped-up authentication? As Auth Server is not a policy enforcement point, or a policy management system, these two aspects are out of scope. But once you make a runtime decision that you need more evidence of identity, the OpenID Connect Authentication Request has a few features that can help you out.</p> <p>The first is <code>prompt=login</code>. This is a hint from the Relying Party to the OpenID Provider that re-authentication is needed. Not all OpenID Connect providers support this feature (for example, Google does not).  However Auth Server does currently support this parameter, although there is a feature request to make it optional.</p> <p>The second is <code>acr_values</code>. In Auth Server, this provides a hint to the Auth Server to invoke a specific Person Authentication interception script. Typically, this would specify your workflow for additional authentication. If you are using Agama, you can also provide a hint for which Agama flow to invoke by adding __.</p> <p>Another more esoteric strategy is to use UMA claims gathering. In this flow, the subject's browser is directed to the claims gathering endpoint (i.e. front channel), at which point the claims gathering script could invoke an OpenID authentication, using the <code>prompt</code> and <code>acr_values</code> parameters mentioned above.</p> <p>If you want to see an example of how a client implements stepped-up authentication, you should checkout this mod_auth_openidc wiki page.</p>","tags":["administration","planning","stepped-up authentication"]},{"location":"janssen-server/planning/timeout-management/","title":"Timeout Management","text":"<p>Warning: business expectations regarding timeouts may drive you crazy. There are several timeout values in Janssen Auth Server. Also, web apps and mobile apps may have their own timeout thresholds. The holy grail of timeouts is when everything times out at the same time--IDP and applications. This is rarely attainable. Normally the application needs to handle gracefully the case when the IDP session expires first. And if the application session expires first, it may need to trigger a logout event at the OpenID Provider.</p> <p>Below is a list of some of the Auth Server configuration properties for timeouts that you should consider:</p> <ol> <li> <p>sessionIdCookieLifetime</p> </li> <li> <p>sessionIdLifetime</p> </li> <li> <p>sessionIdUnusedLifetime</p> </li> <li> <p>sessionIdUnauthenticatedUnusedLifetime</p> </li> <li> <p>spontaneousScopeLifetime</p> </li> <li> <p>refreshTokenLifetime</p> </li> <li> <p>idTokenLifetime</p> </li> <li> <p>accessTokenLifetime</p> </li> <li> <p>cleanServiceInterval</p> </li> <li> <p>dynamicRegistrationExpirationTime</p> </li> <li> <p>refreshTokenExtendLifetimeOnRotation</p> </li> <li> <p>CIBA, UMA and Device Flow: have their own specific timeouts.</p> </li> </ol>","tags":["administration","planning","timeout"]},{"location":"janssen-server/planning/use-cases/","title":"Use Cases","text":"","tags":["administration","planning","use-cases","architecture"]},{"location":"janssen-server/planning/use-cases/#browser-single-sign-on-b-ss0","title":"Browser Single Sign-On (B-SS0)","text":"<p>Web browser SSO is one of the main use cases for Janssen. The OpenID Connect interfaces of the Auth Server provide the identity layer that manages authentication and B-SSO. Auth Server tracks web browser sessions via a cookie. An end user may actually have several active sessions, although only one session is active. For example, below is a hypothetical session cookie:</p> <pre><code>session_id: c691e83d-eb1b-41f0-b453-fab905681b5b\ncurrent_sessions: [\"de510ab6-b06c-4393-86d8-12a7c501aafe\", \"c691e83d-eb1b-41f0-b453-fab905681b5b\"]\n</code></pre> <p>To switch sessions, an RP can redirect to the Jans Auth Server OpenID Connect Provider authorization endpoint with the parameters <code>prompt=select_account</code>.</p>","tags":["administration","planning","use-cases","architecture"]},{"location":"janssen-server/planning/use-cases/#native-single-sign-on-n-ss0","title":"Native Single Sign-On (N-SS0)","text":"<p>On most mobile platforms, mobile apps signed by the same vendor certs can share information via the system \"keychain\" (Account Manager on Android). OpenID Mobile SSO specifies a new scope, extends the token endpoint, and profiles the OAuth2 Token Exchange spec allowing mobile apps to share identity between apps produced and signed by the same vendor (i.e. signed with the same vendor certificate).</p>","tags":["administration","planning","use-cases","architecture"]},{"location":"janssen-server/planning/use-cases/#single-logout-slo","title":"Single Logout (SLO)","text":"<p>The bane of identity engineers everywhere, Auth Server does offer some endpoints that enable SLO. Janssen Auth Server implements Back-Channel Logout and Session Management. But the most commonly used strategy is Front-Channel Logout. This works by displaying a web page with numerous iFrames, each with the respective logout URL for each application. The reason SLO is so hard is that logout is inherently an asynchronous use case. When you need a bunch of websites to receive a notification, some of those notifications may fail. Ideally, you'd replay messages that aren't received. But end users want a fast logout response, and don't want to wait for all the applications to confirm they received and acted on the notification. So making logout synchronous is a round-hole / square-peg situation. But with that said, Auth Server supports it.</p>","tags":["administration","planning","use-cases","architecture"]},{"location":"janssen-server/planning/use-cases/#api-access-management","title":"API Access Management","text":"<p>Janssen Auth Server is frequently used to issue access tokens to authenticate software clients that needs to call an API. The OAuth WG has published many useful specifications about how to do this securely, and Janssen implements many of these RFCs and drafts. In OAuth parlance, Jans Auth Server is the Authorization Server; and Jans Client API is a service that helps clients with advanced features like MTLS and private key authentication. As OAuth scopes are frequently used to control the extent of access of clients, many domains are using Jans Auth Server to dynamically render scopes based on the identity of the client, or the security context. The Jans Auth Server also implements OAuth and OpenID client registration API. Finally, Jans Auth Server publishes an SSA endpoint, for OAuth software statement assertions which enables trusted services to request an SSA that specifies what type of clients can register. All of these features mean that Jans Auth Server is an essential tool as part of your API access management infrastructure.</p>","tags":["administration","planning","use-cases","architecture"]},{"location":"janssen-server/planning/use-cases/#multifactor-authentication","title":"Multifactor Authentication","text":"<p>OpenID Connect is a web identity layer. Auth Server displays and processes a series of web pages to authenticate a person, and then shares user claims with the applications that requested them. Out of the box, Auth Server supports many MFA workflows, including FIDO, passkeys, OATH OTP (HOTP, TOTP), SMS (via Twilio or SMPP), and many more. But you're not limited to the MFA that comes out of the box. Using Person Authentication Scripts, you can implement any authentication workflow that you can imagine. You can also use the Janssen Project's Agama programming language to implement multi-step authentication workflows.</p>","tags":["administration","planning","use-cases","architecture"]},{"location":"janssen-server/planning/use-cases/#mobile-authentication","title":"Mobile Authentication","text":"<p>One of the initial requirements for OpenID was to support mobile apps (because SAML is terrible for mobile apps). OpenID and OAuth have developed several mitigations that make mobile authentication more secure, which are described in RFC 8252. However, due to the complexity of cookie sharing between the mobile phone browser SDK, and the mobile browser (assuming you are using the system browser), your results may vary if you actually want SSO.  Recently, OpenID has published a new specification draft for Native SSO for Mobile Apps, that is on the roadmap. There are some other hacky ways you can implement mobile authentication, for example, using the OAuth <code>password</code> grant--but this is possible only for first-party applications, and is generally discouraged because there is no way to securely store a client secret in the mobile application, which hackers can easily decompile.</p>","tags":["administration","planning","use-cases","architecture"]},{"location":"janssen-server/planning/use-cases/#open-banking","title":"Open Banking","text":"<p>You'll notice that the Gluu Open Banking Identity Platform is certified for Financial-grade API (FAPI) 1.0 Final--this is Gluu's distribution of the Janssen Auth Server profiled for banking. If you want to implement an OP for open banking, Jans Auth Server is one of the few comprehensive open-source platforms that will enable you to do so.</p>","tags":["administration","planning","use-cases","architecture"]},{"location":"janssen-server/planning/use-cases/#social-sign-in","title":"Social Sign-in","text":"<p>This could really be covered under the MFA section. But it's not uncommon that as part of an authentication workflow, Auth Server may redirect you to an external identity provider, which then sends you back to Auth Server with some kind of reference id or assertion. Out of the box, Jans supports the top three social sites: Google, Apple, and Facebook (which account for 80% of social login). But of course, you can implement any social login using an Agama project.</p>","tags":["administration","planning","use-cases","architecture"]},{"location":"janssen-server/planning/use-cases/#registration","title":"Registration","text":"<p>It's not that uncommon that an authentication workflow is used to create an account for a person in an identity provider. In fact, it's so common, that the OpenID working group recently created a spec to standardize a parameter in the authentication request to signal to the OpenID Provider that this is what's happening: prompt=create. As we're just displaying a series of web pages, we can display a registration form, process the form (with some kind of remote identity proofing?), send an email, SMS, Telegram messages, or whatever. Also, frequently social login is tied to registration--the first time you login with an external IDP, Auth Server creates an account on the fly with the user claims sent by the remote IDP.</p>","tags":["administration","planning","use-cases","architecture"]},{"location":"janssen-server/planning/use-cases/#authorization","title":"Authorization","text":"<p>Frequently people conflate the identity layer with the authorization layer. RBAC is still an important security paradigm. So it makes sense to people that the place where you store information about a person's roles is where you define policies about what resources a role can access (i.e. policies). Recently, centralized authorization has had an active resurgence. Companies like Styra, Oso, and HashiCorp have introduced innovative centralized authorization software. These systems, acting as a \"policy decision point\", enable you to define policies, and can evaluate these policies at runtime. Note: they rely on \"policy enforcement points\" to call their endpoints, supplying the data which is input to policies. With that said, there are places in Auth Server where you can define or impact authorization (besides user claims). In particular, OAuth scopes are used to convey the extent of access in an access token, that when presented to an API by a software client, enables access control. However, the scope is still input to policy, and may in fact be just one more piece of data considered by a policy decision point. And one more caveat... the \"authorization\" in an OAuth \"authorization server\", was originally meant to convey the authorization of the person who was trying to access something. Whether a person consented to share information, or grant a client the ability to act on their behalf, is another important consideration. So does \"Auth Server\" provide authorization? It depends!</p>","tags":["administration","planning","use-cases","architecture"]},{"location":"janssen-server/planning/use-cases/#consent-gathering","title":"Consent Gathering","text":"<p>Through the \"front channel\" (i.e. the browser), Auth Server can interact with a person by displaying web pages. OpenID Connect and OAuth scopes trigger the authorization phase (after authentication). By default, the scopes requested by the client and their respective descriptions are displayed for approval. However, like all pages in Auth Server, these pages can be customized to meet your exact requirements.</p> <p>Auth Server also implements the User Managed Access Protocol (\"UMA\"). This profile of OAuth2 enables consent to be sought from a person even after the initial authentication has taken place. This phase is also called \"claims gathering\", but one of the claims could be whether a person consents to something.</p> <p>Note: Authorizations are stored relative to a person's entity in the database. How a person views and revokes consent is outside the scope of Auth Server. To view a person's consents, you need to use the config API, as this information is not shared via OpenID Connect or SCIM.</p>","tags":["administration","planning","use-cases","architecture"]},{"location":"janssen-server/planning/vm-cluster/","title":"VM Cluster","text":"<p>Note</p> <p>For high availability, we recommend using the Cloud-Native(CN) deployment instead of VM cluster deployments.</p> <p>What if you need four or five nines availability, but cloud-native is not an option? You could cluster Janssen using VMs, but you'll have to do some legwork, because we don't publish tools for this task. This planning guide will cover some of the things you'll need to consider.</p> <ol> <li> <p>Hostname: Remember when you run the Linux setup to use the hostname of the cluster, not the hostname of the individual server.  This is important because the OpenID Provider metadata needs to use the public hostname (i.e. the URLs you'll find at <code>/.well-known/openid-configuration</code>)</p> </li> <li> <p>Load Balancing / SSL: As Auth Server and FIDO (the two Internet facing components) are stateless,  you can use any load balancer routing algorithm, even round robin. You can also use the load balancer to terminate SSL.</p> </li> <li> <p>Database: The web services Janssen Components share the database, so you'll have to use database replication. You could also use a cloud database that takes care of replication for you.</p> </li> <li> <p>Cache: You can't use <code>IN-MEMORY</code> cache which would have no way to replicate to the other nodes in the network. You could use the Database for caching, although this will impact performance, although it's only an issue for high concurrency use cases. But if you really need a very high concurrency, our recommendation is to use Redis for caching, which has less cache hit misses than Memcached.</p> </li> <li> <p>Key management: Where do you store the private keys? If on the file system, you'll have to make sure that they get securely copied. This is trickier than it sounds because of key rotation. OpenID Connect working group suggests key rotation every two days, to make sure developers who write OpenID applications handle key rotation properly in their code, and don't hardcode the metadata, but retrieve it from the OpenID configuration endpoint.</p> </li> <li> <p>Customizations: You must copy any libraries, xhtml pages, CSS or javascript must be available on all servers.</p> </li> </ol>","tags":["administration","planning","vm","cluster"]},{"location":"janssen-server/planning/vm-single-instance/","title":"VM Single Instance","text":"<p>While an active-active cluster enables you to achieve four or five nines uptime, you may want to consider a single VM instance if simplicity of operation trumps availability. If you do a good job at monitoring, and can restore from backup quickly, it's certainly possible to meet an SLA of 99.9% availability using just one server.</p> <p>Janssen has Linux packages available for SUSE, Red Hat and Ubuntu. One operational consideration is that you should <code>hold</code> the version of Jans Auth Server, to avoid update during the normal package update process. As many applications may rely on a central IDP, you want to plan updates and have a rollback plan if something goes wrong. An automated, unattended update process for the IDP is too risky.</p> <p>An important security tradeoff when you run Janssen on a single VM is that services which you want to control access to are running on a server with an Internet-facing ethernet interface: the Config API, database, and SCIM server. Even though these services are running on <code>localhost</code>, if the Internet facing interface is compromised, network protection could be bypassed.</p> <p>The main advantage of running a single VM is simplicity. Your sys admins won't need any special training. And it will be easy to install, backup, monitor, and configure your deployment. If you have many autonomous domains, each with its own brand and user identity management process, the simplicity of running a single IDP might be the best solution. If three nines are acceptable to your business, the expense of deploying and operating a cluster may not be justified.</p>","tags":["administration","planning","vm","single instance"]},{"location":"janssen-server/recipes/","title":"Janssen Recipes","text":"<p>The Janssen Authentication Server is extremely flexible, extensible, and modular. With the correct configuration, Agama, and interception scripts, a wide variety of authentication flows can be implemented. This section contains samples and tutorials to configure third party integrations, specific authentication flows, benchmarking, customizations, compliance profiles, and more.</p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/ACRouter/","title":"ACRouter Script for 2FA","text":"","tags":["recipes","2FA","ACRouter"]},{"location":"janssen-server/recipes/ACRouter/#user-journey","title":"User Journey","text":"<p>Janssen's authentication server can integrate with any number of authentication mechanisms from different vendors. Factoring the pros and cons of each method, organizations can offer a diverse set of options. A users can register multiple types of credentials and use any preferred credential to perform a login.</p> <p>An ACRouter Script is a <code>PersonAuthenticationType</code> script orchestrates a 2FA flow by delegating specific implementation details of authentication methods to other scripts. This allows the flow to present users with alternatives in case some credential is not working as expected or is lost.</p> <p></p>","tags":["recipes","2FA","ACRouter"]},{"location":"janssen-server/recipes/ACRouter/#authentication-flow","title":"Authentication flow","text":"<pre><code>\nsequenceDiagram\nautonumber\n\n    title User selects authentication mechanism\n    User agent-&gt;&gt;Jans AS: Invoke /authorize endpoint\n    Jans AS-&gt;&gt;User agent: Present \"username\" only screen &lt;br/&gt; OR &lt;br/&gt;username - password screen\n    User agent-&gt;&gt;Jans AS: Present username &lt;br/&gt; OR username and  password\n    Jans AS -&gt;&gt; Jans AS: verify user\n    Jans AS-&gt;&gt;User agent: Show UI for preferred authentication method, &lt;br&gt;and also a link \"Alternate way to sign in\"\n    loop n times - (enter creds or select alternate way to sign in)\n        User agent-&gt;&gt;Jans AS: Enter credentials (Or click on \"Alternate way to sign in\")\n        Jans AS-&gt;&gt;User agent: Present page for authentication &lt;br/&gt; or &lt;br/&gt; present alternate authentication mechanisms\n    end\n\n    Jans AS-&gt;Jans AS: 8. validate id_token,&lt;br/&gt;create internal Jans session\n    opt if new user\n        Jans AS-&gt;Jans AS: 9. Dynamic enrollment or registration\n    end\n    Jans AS-&gt;User agent: 10. write Jans session cookie</code></pre>","tags":["recipes","2FA","ACRouter"]},{"location":"janssen-server/recipes/ACRouter/#an-acrouter-script","title":"An ACRouter script:","text":"<p>Currently, the Jans Auth server comes with 2 <code>PersonAuthenticationType</code> interception scripts that integrate multiple authentication methods and offer alternative options to users for sign-in.</p> <ol> <li> <p>Casa Script The <code>casa</code> script offers a 2 steps authentication flow with login and password prompted in the first step and a user-preferred authentication mechanism in the second step.</p> </li> <li> <p>Passwordless script The <code>passwordless</code> script offers a 2 steps authentication flow with username prompted in the first step and a user-preferred authentication mechanism in the second step.</p> </li> </ol>","tags":["recipes","2FA","ACRouter"]},{"location":"janssen-server/recipes/ACRouter/#casa-app-for-enrollment-of-a-variety-of-credentials","title":"Casa App for enrollment of a variety of credentials:","text":"<p>Casa is a self-service web portal that end-users can use to 1. Enroll, delete and manage two-factor authentication (2FA) credentials for their account (e.g. FIDO security keys, mobile apps, phone numbers, etc.) 1. Turn 2FA on and off</p>","tags":["recipes","2FA","ACRouter"]},{"location":"janssen-server/recipes/ACRouter/#adding-a-new-authentication-method-as-an-alternative-authentication-method","title":"Adding a new authentication method as an \"alternative authentication method\":","text":"","tags":["recipes","2FA","ACRouter"]},{"location":"janssen-server/recipes/ACRouter/#step-1-write-a-custom-script","title":"Step 1: Write a custom script:","text":"<p>Ensure the following preconditions are met so that the authentication mehtod integrates seamlessly within flow: 1. The orchestrator script looks for authentication method scripts under <code>/opt/jans/python/libs</code>.  Write a custom script that focuses only on authentication. The script file name should follow naming convention like <code>orchestratorName-external_acrName</code> e.g. <code>casa-external_fido2</code> or <code>pwdless-external_fido2</code> 1. For step 1, <code>prepareForStep</code> must only return <code>True</code> 1. For step 1, <code>getExtraParametersForStep</code> must only return <code>None</code> 1. For step 1, the <code>authenticate</code> routine must check if there is already an authenticated user, and if so bypass validating the username and password. This is because a user may have previously attempted authentication with a different method. 1. Keep in mind that <code>getPageForStep</code> won't be called when <code>step=1</code> in your script. The orchestrator script i.e. <code>casa</code> or <code>passwordless</code> script takes charge of this specific step/method combination 1. Add a <code>hasEnrollments</code> routine with a signature like this   <code>def hasEnrollments(self, configurationAttributes, user):</code> <code>hasEnrollments</code> must return <code>True</code> or <code>False</code>, describing whether <code>user</code> has one or more credentials enrolled for the type you are interested in Objects:</p> Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>SimpleCustomProperty</code> Map of configuration properties. Reference <code>User</code> User object Reference","tags":["recipes","2FA","ACRouter"]},{"location":"janssen-server/recipes/ACRouter/#step2-modification-to-web-pages","title":"Step2: Modification to web-pages:","text":"<ol> <li>Ensure that custom pages returned by <code>getPageForStep</code> for step 2 (or higher) contain the fragment: <pre><code>    &lt;ui:include src=\"/casa/casa.xhtml\" /&gt;\n</code></pre> This will display a set of links for the user to navigate to alternate 2FA pages. The list will be shown when clicking on a link which should be provided this way: <pre><code>    &lt;a href=\"javascript:showAlternative('ELEMENT_ID')\" id=\"alter_link\" class=\"green hover-green f7-cust\"&gt;#{msgs['casa.alternative']}&lt;/a&gt;\n</code></pre> Here <code>ELEMENT_ID</code> is the identifier for the HTML node that wraps all visual elements of your page (excluding <code>casa.xhtml</code>). It is required to preserve <code>alter_link</code> as <code>id</code> for the <code>a</code> tag.</li> <li>Place the modified xhtml page under the path specified in <code>getPageForStep</code>, for e.g. <code>/opt/jans/jetty/jans-auth/custom/pages/casa/fido2.xhtml</code></li> </ol>","tags":["recipes","2FA","ACRouter"]},{"location":"janssen-server/recipes/ACRouter/#step3-handle-enrollment-using-the-casa-app","title":"Step3: Handle enrollment using the Casa app","text":"","tags":["recipes","2FA","ACRouter"]},{"location":"janssen-server/recipes/ACRouter/#step-4-enable-the-acrouter-script-ie-passwordless-or-casa-script","title":"Step 4: Enable the ACRouter script i.e. <code>passwordless</code> or <code>casa</code> script","text":"<p>Once your script is enabled in the Jans-auth server, you can test it for authentication purposes. Try your script by creating an authentication request passing <code>casa</code> or <code>passwordless</code> as acr value.</p>","tags":["recipes","2FA","ACRouter"]},{"location":"janssen-server/recipes/benchmark/","title":"Benchmark","text":"<p>The Janssen Server has been optimized with several container strategies that allow scaling microservices and orchestrating them using Kubernetes. In this tutorial we will be running a load test from three different regions on a janssen setup on three different regions. For simplicity, we will be using microk8s however we do recommend users to use the kubernetes cluster providers that they will be using in production. For instance, we run our loadtests across EKS, GKE, AKS and DOKS.</p> <p>With this procedure the following with a <code>10</code> million user database is expected:</p>","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#results","title":"Results","text":"<p>Note</p> <p>The authorization code flow hits a total of 4 steps, 3 authorization steps <code>/token</code>, <code>/authorize</code>, <code>/jans-auth/login</code> and 1 redirect.</p> Flow Authentications per second Authorization code flow 800-1000","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#installation","title":"Installation","text":"<p>As mentioned in the overview we recommend using the same Kubernetes cluster as planned in production. More guides to install on different clouds can be found here.</p>","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#persistence","title":"Persistence","text":"<p>We recommend your persistence in production to be HA, backup supported and point in time recovery supported. Below is a table of the persistence used and resources set for this test.</p> Persistence # of nodes RAM(GiB) vCPU Total RAM (GiB) Total vCPU MySQL 1 52 8 52 8","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#set-up-the-cluster","title":"Set up the cluster","text":"","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#kubernetes-cluster-load-test-resources","title":"Kubernetes Cluster Load Test Resources","text":"<p>Note</p> <p>Instance type can be selected to best suit the deployment intended. Keep in mind when selecting the instance type to strive for a <code>10</code> or up to <code>10</code> network bandwidth (Gbps). Below details the exact resources needed for this tutorial. This is in addition to the persistence resources listed above.</p> <p>Resourcing is  critical as timeouts in connections can occur, resulting in failed authentications or cutoffs.</p> Regions # of nodes RAM(GiB) vCPU Total RAM (GiB) Total vCPU US-West 1 96 48 96 48 US-East 1 96 48 96 48 EU-Central 1 96 48 96 48 Grand Total 288 GB 144 <p>A Kubernetes cluster can be created with three nodes or more in one region and that's fine as long as the nodes are in multiple zones. We will continue with the above table and using microk8s.</p> <ol> <li> <p>Create three ubuntu 22.04 nodes and run on each one the following:</p> <p><pre><code>sudo snap install microk8s --classic\nsudo snap alias microk8s.kubectl kubectl\n</code></pre> 2. Designate one of the nodes as the master. We will choose the <code>us-west</code> node to be our master. On the master node run:</p> </li> <li> <p>Execute : </p> <pre><code>microk8s.enable ingress dashboard observability dns metrics-server hostpath-storage registry\n</code></pre> </li> <li> <p>All the other microk8s nodes must be resolvable from within the master. If fqdns are not globally resolved (registered) open the <code>/etc/hosts</code> file in the master node and map each hostname of the other nodes. YThe hostname of the other nodes can be obtained by executing the command <code>hostname</code>.</p> <p><pre><code># If the hostnames are not globally resolvable on master\necho \"192.123.123.123 ubuntu-us-east\" &gt;&gt; /etc/hosts\necho \"192.124.124.124 ubuntu-eu-central\" &gt;&gt; /etc/hosts\n</code></pre>    3. Execute:  </p> <pre><code>microk8s add-node\n</code></pre> </li> </ol> <p>Copy the output of the command above with <code>--worker</code> i.e. <code>microk8s join 192.12.12.12:25000/88687d1cc5ecdee0db5014c4df9b82cb/adedf6a730eb --worker</code> and execute it in the other nodes (worker nodes) to join them. Step <code>iii</code> ( this step) needs to be repeated for each worker node.</p> <ol> <li> <p>Make sure helm is installed.</p> </li> <li> <p>Prepare your override.yaml. Copy the below into a file named override.yaml. At the time of writing this we are using image tags <code>0.0.0-nightly_dev</code> which are the bleeding edge images for release <code>0.0.0-nightly</code>. Stable images such as <code>0.0.0-nightly-1</code> should be used.</p> </li> </ol> <pre><code>config:\n   image:\n     repository: ghcr.io/janssenproject/jans/configurator\n     tag: 0.0.0-nightly_dev \n   countryCode: US\n   email: support@gluu.org\n   orgName: Gluu\n   city: Austin\n   configmap:\n     cnSqlDbName: test\n     cnSqlDbPort: 3306\n     cnSqlDbDialect: mysql\n     cnSqlDbHost: mycool.cloud.mysql\n     cnSqlDbUser: root\n     cnSqlDbTimezone: UTC\n     cnSqldbUserPassword: Test1234#\nglobal:\n  auth-server:\n    enabled: true\n  config-api:\n    enabled: true\n  cnPersistenceType: sql\n  cloud:\n    testEnviroment: false\n  fqdn: example.gluu.info\n  isFqdnRegistered: true\n  # In the event the fqdn above is not resolvable from the internet comment the above line and uncomment the below two setting your lbIp to your master ndoe ip.\n  #isFqdnRegistered: false\n  #lbIp: 192.12.12.12\n  istio:\n    enabled: false\n    ingress: false\n  nginx-ingress:\n    enabled: true\n  fido2:\n    enabled: false\n    ingress:\n      fido2ConfigEnabled: false\n  scim:\n    enabled: false\n    ingress:\n      scimConfigEnabled: false\n      scimEnabled: false\nauth-server:\n  image:\n    pullPolicy: IfNotPresent\n    repository: ghcr.io/janssenproject/jans/auth-server\n    tag: 0.0.0-nightly_dev\nconfig-api:\n  image:\n    pullPolicy: IfNotPresent\n    repository: ghcr.io/janssenproject/jans/config-api\n    tag: 0.0.0-nightly_dev\npersistence:\n  image:\n    pullPolicy: IfNotPresent\n    repository: ghcr.io/janssenproject/jans/persistence-loader\n    tag: 0.0.0-nightly_dev \nnginx-ingress:\n  ingress:\n    path: /\n    hosts:\n      - example.gluu.info\n    tls:\n      - secretName: tls-certificate\n        hosts:\n          - example.gluu.info\n</code></pre> <ol> <li>Run the following:    <pre><code> kubectl create ns jans\n helm repo add janssen https://docs.jans.io/charts\n helm repo update\n helm install janssen janssen/janssen -n jans -f override.yaml\n</code></pre></li> </ol>","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#load-test","title":"Load-test","text":"<p>Our tests used 10 million users that were loaded. We have created a docker image to load users. That same image is also used to load test Janssen using jmeter tests for the <code>Authorization code</code> flow. More tests will come!. This image will load users and use a unique password for each user.</p>","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#loading-users","title":"Loading users","text":"<p>Loading users requires a hefty but temporary amount of resources. By default, the resources ask for <code>10</code> vCPU and <code>5</code> Gis. However, to speed up the process increase the number of CPUs as the job in step two below uses parallel tasks. If left as is 10 million users would load in around 17 hours or so.</p> <ol> <li> <p>Create a folder called <code>add_users</code>.</p> <pre><code>mkdir -p add_users &amp;&amp; cd add_users\n</code></pre> </li> <li> <p>Copy the following yaml into the folder under the name <code>load_users.yaml</code>.</p> </li> <li> <p>Open the file and modify the required parameters. Note that the following environments can be used as configmaps data to configure the pod.</p> ENV Description Default <code>TEST_USERS_PREFIX_STRING</code> The user prefix string attached to the test users loaded <code>test_user</code> <code>USER_NUMBER_STARTING_POINT</code> The user number to start from . This is appended to the username i.e test_user0 <code>0</code> <code>USER_NUMBER_ENDING_POINT</code> The user number to end at. <code>50000000</code> <code>LOAD_USERS_TO_RDBMS</code> Enable loading users to RDBMS persistence. <code>true</code> or <code>false</code> == `` <code>false</code> <code>USER_SPLIT_PARALLEL_THREADS</code> The number of parallel threads to break the total number users across. This number heavily effects vCPU usage. <code>20</code> <code>RDBMS_TYPE</code> RDBMS type if <code>mysql</code> or <code>pgsql</code> is the persistence to load users in. <code>mysql</code> <code>RDBMS_DB</code> RDBMS Database name if <code>mysql</code> or <code>pgsql</code> is the persistence to load users in. <code>jans</code> <code>RDBMS_USER</code> RDBMS user if <code>mysql</code> or <code>pgsql</code> is the persistence to load users in. <code>jans</code> <code>RDBMS_PASSWORD</code> RDBMS user password if <code>mysql</code> or <code>pgsql</code> is the persistence to load users in. . `` <code>RDBMS_HOST</code> RDBMS host if <code>mysql</code> or <code>pgsql</code> is the persistence to load users in. <code>localhost</code> <p>Tips: To speed the loading process, increase the vCPU requests and limits of the pod.</p> </li> <li> <p>Create a namespace for load-testing.</p> <pre><code>kubectl create ns load\n</code></pre> </li> <li> <p>Create <code>load_users.yaml</code></p> <pre><code>kubectl create -f load_users.yaml -n load\ncd ..\n</code></pre> </li> </ol> <p>Wait until all the users are up before moving forward. Tail the logs by running <code>kubectl logs deployment/load-users -n load</code>.</p>","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#load-testing","title":"Load testing","text":"","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#authorization-code-flow","title":"Authorization code flow","text":"","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#resources-needed-for-authorization-code-client-jmeter-test","title":"Resources needed for Authorization code client jmeter test","text":"<p>The below resources were calculated when creating the nodes above.</p> NAME # of pods RAM(GiB) vCPU Total RAM(GiB) Total vCPU Authorization code flow jmeter test 20 8 1.3 190 24 Grand Total 190 GiB 24","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#setup-client","title":"Setup Client","text":"<p>Create the client needed to run the test by executing the following. Make sure to change the <code>FQDN</code>  :</p> <ol> <li> <p>Create a folder called <code>load_test</code>.</p> <pre><code>mkdir -p load_test &amp;&amp; cd load_test\n</code></pre> </li> <li> <p>Create the client json file</p> <p><pre><code>FQDN=example.gluu.info\ncat &lt;&lt; EOF &gt; auth_code_client.json\n{\n    \"dn\": null,\n    \"inum\": null,\n    \"displayName\": \"Auth Code Flow Load Test Client\",\n    \"redirectUris\": [\n      \"https://$FQDN\"\n    ],\n    \"responseTypes\": [\n      \"id_token\",\n      \"code\"\n    ],\n    \"grantTypes\": [\n      \"authorization_code\",\n      \"implicit\",\n      \"refresh_token\"\n    ],\n    \"tokenEndpointAuthMethod\": \"client_secret_basic\",\n    \"scopes\": [\n      \"openid\",\n      \"profile\",\n      \"email\",\n      \"user_name\"\n    ],\n    \"trustedClient\": true,\n    \"includeClaimsInIdToken\": false,\n    \"accessTokenAsJwt\": false,\n    \"disabled\": false,\n    \"deletable\": false,\n    \"description\": \"Auth Code Flow Load Testing Client\"\n}\nEOF\n</code></pre> 3. Copy the following yaml into the folder. You may run the soak auth code test by copying the soak_test_auth_code.yaml instead. </p> </li> <li> <p>Download or build config-cli-tui and run:</p> <pre><code># Notice the namespace is jans here . Change it if it was changed during installation of janssen previously\nTUI_CLIENT_ID=$(kubectl get cm cn -o json -n jans | grep '\"tui_client_id\":' | sed -e 's#.*:\\(\\)#\\1#' | tr -d '\"' | tr -d \",\" | tr -d '[:space:]')\nTUI_CLIENT_SECRET=$(kubectl get secret cn -o json -n jans | grep '\"tui_client_pw\":' | sed -e 's#.*:\\(\\)#\\1#' | tr -d '\"' | tr -d \",\" | tr -d '[:space:]' | base64 -d)\n# add -noverify if your fqdn is not registered\n./config-cli-tui.pyz --host $FQDN --client-id $TUI_CLIENT_ID --client-secret $TUI_CLIENT_SECRET --no-tui --operation-id=post-oauth-openid-client --data=auth_code_client.json\n</code></pre> </li> <li> <p>Save the client id and secret from the response and enter them along with your FQDN in the yaml file downloaded in step 3  under <code>AUTHZ_CLIENT_ID</code>, <code>AUTHZ_CLIENT_SECRET</code> and <code>FQDN</code> respectively then execute :</p> <pre><code>kubectl apply -f load_test_auth_code.yaml\n# or \nkubectl apply -f soak_test_auth_code.yaml\n</code></pre> </li> <li> <p>The janssen setup by default installs an HPA which will automatically scale your pods if the metrics server is installed according to traffic. To load it very quickly scale the auth-server manually:     <code>bash     kubectl scale deploy janssen-auth-server -n jans --replicas=40</code></p> </li> <li> <p>Finally, scale the load test. The replica number here should be manually controlled.     <code>bash     kubectl scale deploy load-testing-authz -n load --replicas=20    # or      kubectl scale deploy load-testing-soak-authz -n load --replicas=20</code></p> </li> </ol>","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#resource-owner-password-credentials-ropc-flow","title":"Resource Owner Password Credentials (ROPC) flow","text":"","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#resources-needed-for-ropc-client-jmeter-test","title":"Resources needed for ROPC client jmeter test","text":"<p>The below resources were calculated when creating the nodes above.</p> NAME # of pods RAM(GiB) vCPU Total RAM(GiB) Total vCPU ROPC flow jmeter test 20 8 1.3 190 24 Grand Total 190 GiB 24","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#setup-client_1","title":"Setup Client","text":"<p>Create the client needed to run the test by executing the following. Make sure to change the <code>FQDN</code>  :</p> <ol> <li> <p>Create a folder called <code>load_test</code>.</p> <pre><code>mkdir -p load_test &amp;&amp; cd load_test\n</code></pre> </li> <li> <p>Create the client json file</p> <pre><code>FQDN=example.gluu.info\ncat &lt;&lt; EOF &gt; ropc_client.json\n{\n    \"dn\": null,\n    \"inum\": null,\n    \"displayName\": \"ROPC Flow Load Test Client\",\n    \"redirectUris\": [\n      \"https://$FQDN\"\n    ],\n    \"responseTypes\": [\n      \"id_token\",\n      \"code\"\n    ],\n    \"grantTypes\": [\n      \"authorization_code\",\n      \"implicit\",\n      \"refresh_token\",\n      \"password\"\n    ],\n    \"tokenEndpointAuthMethod\": \"client_secret_basic\",\n    \"scopes\": [\n      \"openid\",\n      \"profile\",\n      \"email\",\n      \"user_name\"\n    ],\n    \"trustedClient\": true,\n    \"includeClaimsInIdToken\": false,\n    \"accessTokenAsJwt\": false,\n    \"disabled\": false,\n    \"deletable\": false,\n    \"description\": \"ROPC Flow Load Testing Client\"\n}\nEOF\n</code></pre> </li> <li> <p>Copy the following yaml into the folder.</p> </li> <li> <p>Download or build config-cli-tui and run:</p> <pre><code># Notice the namespace is jans here . Change it if it was changed during installation of janssen previously\nTUI_CLIENT_ID=$(kubectl get cm cn -o json -n jans | grep '\"tui_client_id\":' | sed -e 's#.*:\\(\\)#\\1#' | tr -d '\"' | tr -d \",\" | tr -d '[:space:]')\nTUI_CLIENT_SECRET=$(kubectl get secret cn -o json -n jans | grep '\"tui_client_pw\":' | sed -e 's#.*:\\(\\)#\\1#' | tr -d '\"' | tr -d \",\" | tr -d '[:space:]' | base64 -d)\n# add -noverify if your fqdn is not registered\n./config-cli-tui.pyz --host $FQDN --client-id $TUI_CLIENT_ID --client-secret $TUI_CLIENT_SECRET --no-tui --operation-id=post-oauth-openid-client --data=ropc_client.json\n</code></pre> </li> <li> <p>Save the client id and secret from the response and enter them along with your FQDN in the yaml file <code>load_test_ropc.yaml</code>  under <code>ROPC_CLIENT_ID</code>, <code>ROPC_CLIENT_SECRET</code> and <code>FQDN</code> respectively then execute :</p> <pre><code>kubectl apply -f load_test_ropc.yaml\n</code></pre> </li> <li> <p>The janssen setup by default installs an HPA which will automatically scale your pods if the metrics server is installed according to traffic. To load it very quickly scale the auth-server manually:     <code>bash     kubectl scale deploy janssen-auth-server -n jans --replicas=40</code></p> </li> <li> <p>Finally, scale the load test. The replica number here should be manually controlled.     <code>bash     kubectl scale deploy load-testing-ropc -n load --replicas=20</code></p> </li> </ol>","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#dcr-flow","title":"DCR flow","text":"","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#resources-needed-for-dcr-client-jmeter-test","title":"Resources needed for DCR client jmeter test","text":"<p>The below resources were calculated when creating the nodes above.</p> NAME # of pods RAM(GiB) vCPU Total RAM(GiB) Total vCPU DCR test 20 8 1.3 190 24 Grand Total 190 GiB 24","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/benchmark/#setup-client_2","title":"Setup Client","text":"<p>Create the client needed to run the test by executing the following. Make sure to change the <code>FQDN</code>  :</p> <ol> <li> <p>Create a folder called <code>load_test</code>.</p> <pre><code>mkdir -p load_test &amp;&amp; cd load_test\n</code></pre> </li> <li> <p>Create the client json file</p> <pre><code>FQDN=example.gluu.info\ncat &lt;&lt; EOF &gt; dcr_client.json\n{\n    \"dn\": null,\n    \"inum\": null,\n    \"displayName\": \"DCR Flow Load Test Client\",\n    \"redirectUris\": [\n      \"https://$FQDN\"\n    ],\n    \"responseTypes\": [\n      \"id_token\",\n      \"code\"\n    ],\n    \"grantTypes\": [\n      \"authorization_code\",\n      \"implicit\",\n      \"refresh_token\",\n      \"password\"\n    ],\n    \"tokenEndpointAuthMethod\": \"client_secret_basic\",\n    \"scopes\": [\n      \"openid\",\n      \"profile\",\n      \"email\",\n      \"user_name\"\n    ],\n    \"trustedClient\": true,\n    \"includeClaimsInIdToken\": false,\n    \"accessTokenAsJwt\": false,\n    \"disabled\": false,\n    \"deletable\": false,\n    \"description\": \"DCR Flow Load Testing Client\"\n}\nEOF\n</code></pre> </li> <li> <p>Copy the following yaml into the folder.</p> </li> <li> <p>Download or build config-cli-tui and run:</p> <pre><code># Notice the namespace is jans here . Change it if it was changed during installation of janssen previously\nTUI_CLIENT_ID=$(kubectl get cm cn -o json -n jans | grep '\"tui_client_id\":' | sed -e 's#.*:\\(\\)#\\1#' | tr -d '\"' | tr -d \",\" | tr -d '[:space:]')\nTUI_CLIENT_SECRET=$(kubectl get secret cn -o json -n jans | grep '\"tui_client_pw\":' | sed -e 's#.*:\\(\\)#\\1#' | tr -d '\"' | tr -d \",\" | tr -d '[:space:]' | base64 -d)\n# add -noverify if your fqdn is not registered\n./config-cli-tui.pyz --host $FQDN --client-id $TUI_CLIENT_ID --client-secret $TUI_CLIENT_SECRET --no-tui --operation-id=post-oauth-openid-client --data=dcr_client.json\n</code></pre> </li> <li> <p>You will need to load the sectorIdentifier into your persistence.For MySQL that statement would be the following taking into account the <code>FQDN</code>:</p> <pre><code>INSERT INTO jansSectorIdentifier (doc_id, dn, jansId, jansRedirectURI, objectClass)\nVALUES (\n  'a55ede29-8f5a-461d-b06e-76caee8d40b5',\n  'jansId=a55ede29-8f5a-461d-b06e-76caee8d40b5,ou=sector_identifiers,o=jans',\n  'a55ede29-8f5a-461d-b06e-76caee8d40b5',\n  '{\"v\": [\"https://www.jans.org\", \"http://localhost:80/jans-auth-rp/home.htm\", \"https://localhost:8443/jans-auth-rp/home.htm\", \"https://$FQDN/jans-auth-rp/home.htm\", \"https://$FQDN/jans-auth-client/test/resources/jwks.json\", \"https://client.example.org/callback\", \"https://client.example.org/callback2\", \"https://client.other_company.example.net/callback\", \"https://client.example.com/cb\", \"https://client.example.com/cb1\", \"https://client.example.com/cb2\"]}',\n  'jansSectorIdentifier'\n);\n</code></pre> </li> <li> <p>Save the client id and secret from the response and enter them along with your FQDN in the yaml file <code>load_test_ropc.yaml</code>  under <code>DCR_CLIENT_ID</code>, <code>DCR_CLIENT_SECRET</code> and <code>FQDN</code> respectively then execute :</p> <pre><code>kubectl apply -f load_test_dcr.yaml\n</code></pre> </li> <li> <p>The janssen setup by default installs an HPA which will automatically scale your pods if the metrics server is installed according to traffic. To load it very quickly scale the auth-server manually:     <code>bash     kubectl scale deploy janssen-auth-server -n jans --replicas=40</code></p> </li> <li> <p>Finally, scale the load test. The replica number here should be manually controlled.     <code>bash     kubectl scale deploy load-testing-ropc -n load --replicas=20</code></p> </li> </ol>","tags":["administration","helm","kubernetes","benchmarking"]},{"location":"janssen-server/recipes/casa/","title":"Casa - Self-service MFA portal","text":"<p>Casa is a self-service web portal that allows end users to view, enroll, and remove MFA credentials, including hardware tokens, software tokens, commercial services (like Duo), social login, biometric, and mobile.  Casa is also extensible. As new authentication technologies arise, you can download plugins to leverage them in your organization through Casa.</p> <p></p>","tags":["administration","recipe","casa"]},{"location":"janssen-server/recipes/casa/#prerequisites","title":"Prerequisites","text":"<ul> <li>Installed Janssen Server  </li> </ul>","tags":["administration","recipe","casa"]},{"location":"janssen-server/recipes/casa/#installing-casa","title":"Installing Casa","text":"<p>Casa gets installed as an add-on to Janssen Server and integrates with <code>jans-auth-server</code> module as an OpenID connect Relying Party. Casa can be installed using the command below.</p> <p>Currently, Casa installation is supported on CentOS 8 and Ubuntu 20.</p> <p>The following steps will install Casa as an add-on.</p> <ul> <li>Download installer</li> </ul> <pre><code>  wget https://raw.githubusercontent.com/GluuFederation/flex/main/flex-linux-setup/flex_linux_setup/flex_setup.py  -O flex_setup.py\n</code></pre> <ul> <li>Run the installer</li> </ul> <pre><code>python3 flex_setup.py\n</code></pre>","tags":["administration","recipe","casa"]},{"location":"janssen-server/recipes/casa/#automate-install","title":"Automate install","text":"<p>If you have <code>setup.properties</code> file and want to automate installation, you can pass properties file as</p> <pre><code>python3 flex_setup.py -f /path/to/setup.properties -n -c\n</code></pre> <p>Minimal example setup.properties file:</p> <pre><code>ip=10.146.197.201\nhostname=flex.gluu.org\norgName=Gluu\nadmin_email=flex@gluu.org\ncity=Austin\nstate=Texas\ncountryCode=US\ninstallLdap=True\nadmin_password=MyAdminPassword\nldapPass=MyLdapPassword\ncasa_client_id=3000.7986c837-2a8f-4c31-9c63-1bd2f6abce77\ncasa_client_pw=MyCasaClientSecret\n</code></pre> <ul> <li> <p>You will be prompted: <code>Install Admin UI [Y/n]:</code>. Select <code>n</code></p> </li> <li> <p>You will be prompted: <code>Install Casa [Y/n]:</code>. Select <code>y</code></p> </li> <li> <p>At the end of the installation you will be presented with a URL to access the Casa portal.</p> </li> <li> <p>You can use this URL and log into the portal using the administrator credentials that you created during the Janssen Server installation.</p> </li> </ul>","tags":["administration","recipe","casa"]},{"location":"janssen-server/recipes/casa/#enabling-authentication-methods","title":"Enabling Authentication methods","text":"<ol> <li>Enable authentication mechanisms in Jan-auth server like <code>otp</code>, <code>fido2</code>, <code>email_otp</code>.</li> <li>launch jans-cli-tui to enable scripts in Jans-auth server</li> <li> <p>search for script, open script and navigate to enable section and press     enter at enable then press save. </p> </li> <li> <p>Login to the Casa portal as an administrator</p> </li> <li> <p>Enable authentication methods by navigating to <code>Administration console</code>     -&gt; <code>Enabled Authentication methods</code>. Details about enabling authentication methods are available in Casa documentation</p> </li> </ol>","tags":["administration","recipe","casa"]},{"location":"janssen-server/recipes/casa/#configuring-authentication-methods","title":"Configuring authentication methods","text":"<p>At this point, users (How to create users can log in to the Casa portal and enable/configure one or more authentication methods for their account.</p>","tags":["administration","recipe","casa"]},{"location":"janssen-server/recipes/casa/#uninstalling-casa-from-janssen-server","title":"Uninstalling Casa from Janssen Server","text":"<p>Execute following command to uninstall Casa from Janssen Server</p> <pre><code>python3 flex_setup.py -remove casa\n</code></pre>","tags":["administration","recipe","casa"]},{"location":"janssen-server/recipes/device-flow-config/","title":"Authentication via Device Flow Recipe","text":"","tags":["administration","recipes","device flow"]},{"location":"janssen-server/recipes/device-flow-config/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","recipes","device flow"]},{"location":"janssen-server/recipes/device-flow-config/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","recipes","device flow"]},{"location":"janssen-server/recipes/device-flow-config/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","recipes","device flow"]},{"location":"janssen-server/recipes/inbound-oidc/","title":"Inbound OpenId-Connect Authentication","text":"<p>In this tutorial, we will see how you can integrate any inbound external oauth2 provider authentication in the Janssen server. If you are looking for social login support then check out passport module for that.</p> <p>We will use interception authentication script which is a PersonAuthenticationType script for whole flow. Currently, It supports <code>Authorization Code Flow</code> and <code>client_secret_post</code> token endpoint auth method.</p>","tags":["administration","recipe","openid-connect","inbound","authentication"]},{"location":"janssen-server/recipes/inbound-oidc/#authentication-flow","title":"Authentication Flow","text":"<p>You can add any external OAuth2 server authentication option and provision authenticated users to your Janssen server A.K.A. Inbound-identity.</p> <pre><code>\nsequenceDiagram\n\ntitle OIDC Inbound Identity Flow\n\nparticipant browser as Browser\nparticipant rp as RP\nparticipant jans as Jans Authz Server\nparticipant eidp as External Provider\n\nautonumber\nbrowser-&gt;&gt;rp: Request page\nbrowser-&gt;&gt;jans: Invoke /authorize endpoint\njans-&gt;&gt;browser: Present \"Login with OAuth2\" button\nbrowser-&gt;&gt;browser: User click on button\nbrowser-&gt;&gt;eidp: Redirect login request\nloop n times - (multistep authentication)\neidp-&gt;&gt;browser: Present login screen\nbrowser-&gt;&gt;eidp: Present login credentials\nend\neidp-&gt;&gt;eidp: Authenticate user\neidp-&gt;&gt;jans: Redirect to callback url with success response(code)\njans-&gt;&gt;jans: Validate code, id_token, userinfo\nopt if new user\njans-&gt;&gt;jans: Dynamic enrollment or registration\nend\njans-&gt;&gt;jans: Create internal Jans session\njans-&gt;&gt;rp: Redirect with Success response\nrp-&gt;&gt;rp: Validate response\nrp-&gt;&gt;browser: Page is accessed</code></pre>","tags":["administration","recipe","openid-connect","inbound","authentication"]},{"location":"janssen-server/recipes/inbound-oidc/#prerequisites","title":"Prerequisites","text":"<ul> <li>The external oauth2 server authentication script</li> <li>External OAuth2 Provider credentials: you can choose any external OP server that follows OAuth2 standards and authentication features.  </li> <li>RP application: This is your application that will be used by your users and where you want to add this auth feature.</li> </ul>","tags":["administration","recipe","openid-connect","inbound","authentication"]},{"location":"janssen-server/recipes/inbound-oidc/#configure-janssen-server","title":"Configure Janssen server","text":"","tags":["administration","recipe","openid-connect","inbound","authentication"]},{"location":"janssen-server/recipes/inbound-oidc/#1-add-custom-script","title":"1. Add Custom Script","text":"<ul> <li> <p>Create <code>cs.json</code> with the contents of a CUSTOM script.</p> </li> <li> <p>Edit the <code>cs.json</code> file's contents to reflect the addition of the oidc custom script.</p> <ul> <li> <p>Populate the <code>script</code> field with <code>oidc-jans-script.py</code> script. Download <code>oidc-jans-script.py</code> script from here.</p> </li> <li> <p>This script needs to accept one property <code>oidc_creds_file</code>. which is a JSON file with your external oauth2 server details:</p> <pre><code>// oidc_creds_file: /opt/oidc.json\n{\n\"op_server\": \"https://your.external.oauth2.server\",\n\"client_id\": \"xxxxxxxxxxxxxxxx-xxxxx-external-oauth2\",\n\"client_secret\": \"xxxxxxxxxxxxxx-xxxxx-external-oauth2\",\n\"authorization_uri\": \"https://your.external.oauth2.server/xx/xxxx\",\n\"token_uri\": \"https://your.external.oauth2.server/oauth/xx/xxx\",\n\"userinfo_uri\": \"https://your.external.oauth2.server/xxx/xxx\",\n\"redirect_uri\": \"https://your.jans.server/jans-auth/postlogin.htm\",\n\"scope\": \"openid profile email\",\n\"auto_redirect\": false,\n\"title\": \"Login with OAuth2\"\n}\n</code></pre> Property Description op_server Your external OAuth2 server FQDN client_id Client id of your external OAuth2 server client_secret Client secret of your external OAuth2 server authorization_uri Authorization endpoint of your external OAuth2 server token_uri Token endpoint of your external OAuth2 server userinfo_uri Userinfo endpoint of your external OAuth2 server redirect_uri Sample: <code>https://&lt;your.jans.server&gt;/jans-auth/postlogin.htm</code>, This is redirect URL where your OAuth2 server redirect back with <code>code</code>. Use this same URL to configure <code>redirect urls</code> at your external OAuth2 server. scope OAuth scopes auto_redirect If true, it will automatically redirect to external OAuth2 server otherwise you will get one button on jans login page. title This property is used to set text for a button which is shown on jans login page </li> <li> <p><code>name</code> field should reflect the use case i.e. <code>oidc</code></p> </li> <li><code>script_type</code> field should be <code>PERSON_AUTHENTICATION</code></li> <li> <p><code>cs.json</code> example:</p> <pre><code>{\n  \"dn\": null,\n  \"inum\": null,\n  \"name\": \"oidc\",\n  \"aliases\": [],\n  \"description\": \"OIDC Inbound custom script\",\n  \"script\": \"_file /root/oidc-jans-script.py\",\n  \"scriptType\": \"PERSON_AUTHENTICATION\",\n  \"programmingLanguage\": \"JYTHON\",\n  \"moduleProperties\": {\n    \"value1\": null,\n    \"value2\": null,\n    \"description\": null\n  },\n  \"configurationProperties\": [\n    {\n      \"value1\": \"oidc_creds_file\",\n      \"value2\": \"/opt/oidc.json\",\n      \"description\": \"External server details\",\n      \"hide\": true\n    }\n  ],\n  \"level\": \"integer\",\n  \"revision\": 0,\n  \"enabled\": true,\n  \"scriptError\": {\n    \"raisedAt\": null,\n    \"stackTrace\": null\n  },\n  \"modified\": false,\n  \"internal\": false\n}\n</code></pre> </li> </ul> </li> <li> <p>Add the custom script       <pre><code>jans cli --operation-id post-config-scripts --data /tmp/cs.json\n</code></pre></p> </li> </ul>","tags":["administration","recipe","openid-connect","inbound","authentication"]},{"location":"janssen-server/recipes/inbound-oidc/#2-login-page-setup","title":"2. Login Page Setup","text":"<ul> <li>OIDC Script needs a login page</li> <li>Download oidc-jans-login.xhtml from here </li> <li>Place it here <code>/opt/jans/jetty/jans-auth/custom/pages/auth/oidc/</code>. If folders are not there then create them in the same order. Rename it to <code>oidc.xhtml</code>.</li> <li>Restart jans-auth server <code>service jans-auth restart</code></li> <li>Check here for more details on custom login page.</li> </ul> <p>Now <code>oidc</code> script is an available authentication mechanism for your Janssen Server. This means that using OpenID Connect <code>acr_values</code>, applications can now request your external auth server for authentication.</p> <p>!!! Note To make sure <code>oidc</code> script has been enabled successfully, you can check your Janssen Server's OpenID Connect configuration by navigating to the following URL: <code>https://&lt;hostname&gt;/.well-known/openid-configuration</code>. Find <code>acr_values_supported:</code> and you should see <code>oidc</code>.</p>","tags":["administration","recipe","openid-connect","inbound","authentication"]},{"location":"janssen-server/recipes/inbound-oidc/#test-with-rp-client","title":"Test with RP Client","text":"<p>RP(Relying party) is an application that will be used by your users when you want to add authentication and protect resources. Once you initiate auth request from your RP Application make sure to add <code>acr_values=oidc</code> in the request. <code>acr_values</code> is your script name as configured above.</p>","tags":["administration","recipe","openid-connect","inbound","authentication"]},{"location":"janssen-server/recipes/locking-accounts/","title":"Recipe for Locking or Disabling Accounts","text":"","tags":["administration","recipes"]},{"location":"janssen-server/recipes/locking-accounts/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/locking-accounts/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/locking-accounts/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/passportjs/","title":"Passport JS recipe","text":"<p>This is a guide for user authentication at any external Social Providers(Google, Apple, Facebook, etc) using Passport-JS(a.k.a \"inbound identity\").</p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/passportjs/#components","title":"Components","text":"<ul> <li>The Passport Social authentication script</li> <li>The Passport JS Project</li> </ul>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/passportjs/#authentication-flow","title":"Authentication Flow","text":"<p>After users authenticate at the external social identity provider, the control flows back to Janssen Authentication server where the user is verified and the user-id is provisioned into the Janssen server.</p> <p>Diagram source file</p> <p></p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/passportjs/#role-of-passport-js-project-and-janssens-authentication-server","title":"Role of Passport-JS project and Janssen's Authentication server","text":"<ol> <li>Passport-js project encrypts and signs user data before passing it to the Janssen server.</li> <li>Janssen Auth server verifies the received JWT, decrypts data, add/update user into MySQL, and marks the user as authenticated.  Check Script Code For details.</li> </ol> <p>Diagram source file</p> <p></p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/passportjs/#setup-and-configurations","title":"Setup and configurations","text":"","tags":["administration","recipes"]},{"location":"janssen-server/recipes/passportjs/#setup-passport-js-project","title":"Setup Passport JS Project","text":"<p>Passport JS is very good library in Node JS which helps to add many social provider authentication in project. For this Inbound Jans Flow, You have to make a Passport Node JS project which help to generates auth request for your external social providers, get the user information, and send it to the Janssen server.</p> <p>Below things need to add in Passport JS Project to setup complete auth flow with Jans.</p> <ol> <li>Make a token endpoint which expose token with unique id. Jans will use this endpoint to get token and use this token for secur auth request. Passport Project has to validate this token in Jans request. This is just a simple strategy to protect passport endpoint from spam requests and only allow jans to request it. Code sample:</li> </ol> <pre><code>// Encryption compatible with Jans EncryptionService\n// Salt File path: /etc/jans/conf/salt\nrouter.get('/token',\n  function (req, res, next) {\n    const t = jwt.sign(\n      { jwt: uuidv4() }, '&lt;saltfilevalue&gt;', { expiresIn: 120 } // 2 min expiration\n    )\n    res.status(200).send({ token_: t }) // key should be token_\n  }\n)\n</code></pre> <p>You need to use Salt File <code>/etc/jans/conf/salt</code> as a secret key. You will get this salt file after Jans intallation. Jans interception script uses this same file for decryption.</p> <ol> <li> <p>Create auth request endpoints which will be request by User on Jans auth login page. For Example: Suppose you have added google strategy in your passport project. In that case you can make a endpoint like <code>/google/:token</code>. <code>google</code> is provider id in providers_json_file. <code>token</code> is the same token which we created in above step.</p> </li> <li> <p>After authentication Passport Project has to send encoded userinfo data to Jans <code>https://&lt;your.jans.server.com&gt;/jans-auth/postlogin.htm</code>. Below is the Node JS code sample to send POST request with data to Jans Post Login Endpoint.</p> </li> </ol> <pre><code>const postUrl = \"https://&lt;your.jans.server.com&gt;/jans-auth/postlogin.htm\"\nres.set('content-type', 'text/html;charset=UTF-8')\nreturn res.status(200).send(`\n  &lt;html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\"&gt;\n    &lt;body onload=\"document.forms[0].submit()\"&gt;\n      &lt;noscript&gt;\n        &lt;p&gt;\n          &lt;b&gt;Note:&lt;/b&gt; your browser does not support JavaScript, please press the Continue\n          button to proceed.\n        &lt;/p&gt;\n      &lt;/noscript&gt;\n\n      &lt;form action=\"${postUrl}\" method=\"post\"&gt;\n        &lt;div&gt;\n          &lt;input type=\"hidden\" name=\"user\" value=\"${jwt}\"/&gt;\n          &lt;noscript&gt;\n            &lt;input type=\"submit\" value=\"Continue\"/&gt;\n          &lt;/noscript&gt;\n        &lt;/div&gt;\n      &lt;/form&gt;\n    &lt;/body&gt;\n  &lt;/html&gt;`\n)\n</code></pre> <p>Check next step to generate <code>jwt</code>.</p> <ol> <li>To make encoded userinfo data, use jwt private key signing technique. Check below sample code:</li> </ol> <pre><code>// mapped user info data with MySQL attributes\nconst user = {\n    uid: profile.username || profile.id,\n    mail: profile.email,\n    cn: profile.displayName,\n    displayName: profile.displayName,\n    givenName: profile.name.givenName,\n    sn: profile.name.familyName,\n    provider: \"&lt;your-social-provider-name&gt;\", // e.g. google\n}\n\njwt.sign({\n    iss: 'https://&lt;your.jans.server.com&gt;/jans-auth/postlogin.htm',\n    sub: user.uid,\n    aud: 'https://&lt;your.jans.server.com&gt;',\n    jti: uuidv4(),\n    exp: now / 1000 + 30,\n    iat: now,\n    data: encrypt(user)\n  }, privateKey, defaultRpOptions)\n\n// Check `generate Keystore` section below to generate keys\nconst privateKey = `-----BEGIN PRIVATE KEY-----\nxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\nYour Private Key\nxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n-----END PRIVATE KEY-----`\n\ncosnt defaultRpOptions = {\n  algorithm: config.get('keyAlg'),\n  header: {\n    typ: 'JWT',\n    alg: config.get('keyAlg'),\n    kid: config.get('keyId')\n  }\n}\n\nfunction encrypt (obj) {\n  // Encryption compatible with Jans EncryptionService\n  // Salt File path: /etc/jans/conf/salt\n  const pt = JSON.stringify(obj)\n  const encrypt = crypto.createCipheriv('des-ede3-ecb', '&lt;saltfilevalue&gt;', '')\n  let encrypted = encrypt.update(pt, 'utf8', 'base64')\n  encrypted += encrypt.final('base64')\n  return encrypted\n}\n</code></pre> <p>Follow Steps in Generate Keystore section to generate private key.</p> <ol> <li>You can add as many as possible passport strategies in your passport project. Above steps are little complex, use this sample code file to build your passport application.</li> </ol>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/passportjs/#apache-proxy-setup","title":"Apache proxy setup","text":"<p>For seamless flow, You can deploy Passport Project on Jans server and you can use an apache proxy pass to configure the passport with jans-server. Add the below configuration to the Janssen apache server and restart the apache server.</p> <pre><code>&lt;Location /passport&gt;\n    ProxyPass http://localhost:8090/passport retry=5 connectiontimeout=60 timeout=60\n    Order deny,allow\n    Allow from all\n&lt;/Location&gt;\n</code></pre> <p>After these configurations, you need to use <code>jans-fqdn</code> in passport callback URL. This is optional configurations, you can deploy your passport project on another server.</p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/passportjs/#add-passport-social-script","title":"Add passport-social script","text":"<p>Download the script from here and add it to Janssen Server using <code>jans-cli</code>. After Janssen Server installation, you will get <code>jans-cli</code>.</p> <p>Follow this jans-cli guide to add a custom script in Janssen.</p> <p>The custom script has the following properties:</p> Property Description key_store_file Keystore file path. Use these instructions to create a keystore. key_store_password Keystore file secret password providers_json_file Array of JSON Objects. Provider JSON file with social provider which you want to add for authentication. passport_fqdn Passport FQDN e.g. <code>https://your-passport.com</code> passport_token_endpoint_path It will use <code>passport_fqdn</code> as a prefix so just add path. e.g. <code>/passport/token</code>. Jans request this endpoint to get token for next auth request here. Check Step-1 in Setup Passport section to make token endpoint. passport_auth_endpoint_path It will use <code>passport_fqdn</code> as a prefix so just add path. e.g. <code>/passport/auth</code>. Jans request this endpoint to initiate auth request here. Check Step-2 in Setup Passport section to make passport auth endpoint. Jans will append provider and token during auth request e.g. If you have added google provider with id <code>google</code> in <code>providers_json_file</code> then jans request will be look like <code>https://your-passport.com/passport/auth/google/&lt;token&gt;</code>. <p>Note: After adding and enabling successfully, you can check your Janssen's Auth Server OpenID Connect configuration by navigating to the following URL: https://your-jans-server.com/.well-known/openid-configuration. Find <code>\"acr_values_supported\"</code> and you should see <code>passport-social</code>.</p> <p>Note: Once you initiate auth request from your RP Application make sure to add <code>acr_values=passport-social</code> in the request. acr_values is your script name.</p> <p>Below is the <code>providers_json_file</code> format:</p> <pre><code>[\n  {\n    \"id\": \"google\",\n    \"displayName\": \"google\",\n    \"requestForEmail\": false,\n    \"emailLinkingSafe\": false,\n    \"logoImg\": \"img-url-or-path\"\n  }\n]\n</code></pre> Property Description id Unique string for your provider displayName This name will be shown on auth page logoImg This logo image will be shown on auth page e.g. <code>/jans-auth/img/glu_icon.png</code> requestForEmail It is not required to be <code>true</code>. If you set it to true then it will prompt a user to enter an email. emailLinkingSafe It is not required to be <code>true</code>. If you want to link to existing users then set it to true","tags":["administration","recipes"]},{"location":"janssen-server/recipes/passportjs/#customize-login-pages","title":"Customize login pages","text":"<p><code>Passport-social</code> script uses <code>passportlogin.xhtml</code> and <code>passportpostlogin.xhtml</code> which are already comes which Janssen installation. No need to do anything. For UI Customization, you can download current page source code from here, modify UI, replace pages at path <code>/opt/jans/jetty/jans-auth/custom/pages/auth/passport/</code> and restart <code>jans-auth</code> server.</p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/passportjs/#generate-keystore","title":"Generate Keystore","text":"<p>Passport sends private key sign user data jwt to janssen server, for that we need to generate Keystore. keystore is a safe and passport-protected private key container. Use the below commands:</p> <pre><code># generate Keystore\n\nkeytool -genkey -keyalg RSA -keysize 2048 -v -keystore &lt;keystore-file-name&gt;.jks -alias &lt;kid-unique-string&gt;\n\nExample:\nkeytool -genkey -keyalg RSA -keysize 2048 -v -keystore keystore.jks -alias kid-2s3d5-f5-6f5-f4dd4\n</code></pre> <p>This command will prompt you to enter a password. Whichever password you have entered, this same password you need to configure <code>key_store_password</code> at Janssen custom script configuration.</p> <p><code>&lt;kid-unique-string&gt;</code> is your kid which you need for passport  JWT <code>keyId</code> config. <code>keystore.jks</code> need it to configure <code>key_store_file</code> property at Janssen custom script configuration.</p> <pre><code># JKS to PKCS#12\n\nkeytool -importkeystore -srckeystore keystore.jks \\\n   -destkeystore keystore.p12 \\\n   -srcstoretype jks \\\n   -deststoretype pkcs12\n</code></pre> <pre><code># PKCS#12 to PEM\n\nopenssl pkcs12 -nodes -in keystore.p12 -out keystore.pem\n</code></pre> <p>You can see many things in <code>keystore.pem</code>. but we need only the private key part to make a new file and add the private key part there like in the below example:</p> <pre><code>// private.pem\n\n-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCSETIkMkVKOwwO\nXkYVPaBdz+lhsXpMjMJR4dTdFzn01hvcEDUf57wLmgvBXnfWDXEyEFrsvQGePZw7\nfoYAdnCtSqZW+dLsh6SUxL5iK0uakiY4SBX401fpbhdCeSC1pK8K+qE3jgc/o60d\noRAHLz/RCwaa8BszTwyxlLMh7xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\nxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\nxxxxxxxxxxxxxxxxxxxxxxxxxPQEK0b5mPeV84fZJlfbRv01PIrwGRZJtcWC9Ke5\nxSBoh0uvpZ37z2CJC7HZSz+bYz0ZhYiX372gl7BUxbLYdCz2Z9l0DDhwCO68wCzC\nnualRv0U2Y5EYkekj180KnAR\n-----END PRIVATE KEY-----\n</code></pre> <p>we need this file for the passport <code>keyPath</code> config.</p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/passportjs/#testing-at-rp-application","title":"Testing at RP application","text":"<p>RP(Relying party) is an application that will be used by your users when you want to add authentication and protect resources. Once you initiate auth request from your RP Application make sure to add <code>acr_values=passport-social</code> in the request. acr_values is your script name as configured above.</p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/password-expirations/","title":"Password Expiration Recipe","text":"","tags":["administration","recipes"]},{"location":"janssen-server/recipes/password-expirations/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/password-expirations/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/password-expirations/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/registration/","title":"Registration Recipe","text":"","tags":["administration","recipes"]},{"location":"janssen-server/recipes/registration/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/registration/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/registration/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","recipes"]},{"location":"janssen-server/recipes/social-login/","title":"Social Login","text":"","tags":["administration","Social login","Google","Apple","Facebook"]},{"location":"janssen-server/recipes/social-login/#implementing-social-logins","title":"Implementing Social logins","text":"<p>You can use a <code>PersonAuthenticationType</code> script to allow users to sign using credentials from popular Social Identity providers or Inbound Identity Providers like Facebook, Google and Apple. After users authenticate, we provision their Social Identity Provider credentials into the Jans-auth server. No additional username, password, credentials are needed for this user.</p> <ol> <li>Facebook</li> <li>Google</li> <li>Apple</li> </ol> <p>Following is a high-level diagram depicting a typical flow - user authentication on a Social Identity Platform and subsequent user provisioning on Jans-Auth server.</p> <p>You can copy paste this sequence in https://sequencediagram.org/ <pre><code>title Social login\nJans AS&lt;-User agent: 1. Invoke /authorize endpoint\nJans AS-&gt;User agent: 2. Discovery: Present list of remote IDPs (Google, Apple, FB...)\nUser agent-&gt;Jans AS: 3. Select IDP (e.g. click on button)\nJans AS-&gt;Social login Identity Provider: 4. Redirects login request to IDP\n\nloop n times - (multistep authentication)\nSocial login Identity Provider-&gt;User agent: 5. present login screen\nUser agent-&gt;Social login Identity Provider: 6. present credentials\nend\n\nSocial login Identity Provider-&gt;Jans AS: 7. return id_token, user claims\nJans AS-&gt;Jans AS: 8. validate id_token,\\ncreate internal Jans session\nopt if new user\n  Jans AS-&gt;Jans AS: 9. Dynamic enrollment or registration\nend\n\nJans AS-&gt;User agent: 10. write Jans session cookie\n</code></pre> </p>","tags":["administration","Social login","Google","Apple","Facebook"]},{"location":"janssen-server/recipes/social-login/#user-provisioning","title":"User provisioning","text":"<p>After a user has logged in at an external provider a new record is added in local database - or updated if the user is known.</p> <p>To determine if a user was already added, a string is composed with the provider name and the user ID. For example, if user \"MrBrown123\" has logged in at Twitter, the string would look like <code>passport-twitter:mrbrown123</code>. A database search is performed for a match in the people branch for an entry where attribute <code>jansExtUid</code> equals <code>passport-twitter:mrbrown123</code>.</p> <p>If there are no matches, an entry is added using the values received from the external provider (after having applied the corresponding attribute mapping) attaching the computed value for <code>jansExtUid</code>. The user profile can contain single or multivalued attributes.</p> <p>\ud83d\udcdd The prefix <code>passport-&lt;provider-name&gt;</code> is used to keep the code compatible with the Passport.js implementation for Inbound Identity</p>","tags":["administration","Social login","Google","Apple","Facebook"]},{"location":"janssen-server/recipes/stepped-up-authn/","title":"Stepped-up Authentication Recipe","text":"","tags":["administration","recipes","stepped-up authentication","Update token","modify access token","scope"]},{"location":"janssen-server/recipes/stepped-up-authn/#what-is-stepped-up-authentication","title":"What is Stepped Up Authentication ?","text":"<p>While navigating through an application, a user is challenged to produce an additional authentication when a certain API (of higher criticality) accessed by the client, does not have the needed scope.</p> <p>Consider the following sequence of events : 1. A user is logged in to an app using very basic authentication mechanism. Say login- password. 2. The user navigates through the app. 3. When the user attempts to access a critical resource, he is presented with another authentication step say otp. 4. The user, after successful authentication, has the needed access token to access the critical resource.</p> <pre><code>\nsequenceDiagram\n\ntitle Stepped-up Authentication\n\nactor Person\nparticipant Browser\nparticipant Website\nparticipant Auth Server\nparticipant API\n\nautonumber\n\nWebsite-&gt;&gt;API: request some endpoint\nAPI-&gt;&gt;API:  Enforce&lt;br&gt; presence of &lt;br&gt; 'otp' scope&lt;br&gt; in  access_token\nAPI-&gt;&gt;Website: 3. 401 Unauthorized&lt;br&gt;WWW-Authenticate: Bearer error=\"insufficient_user_authentication\" \nWebsite-&gt;&gt;Browser: Enforce additional challenge on the user&lt;br&gt; (Enter OTP) \nPerson-&gt;&gt;Browser:Enter OTP\nBrowser-&gt;&gt;Auth Server: /authorize endpoint\nNote right of Auth Server: Stepped-up Authentication\nAuth Server-&gt;&gt;Auth Server:Validate OTP (Person authentication script)\nNote right of Auth Server: Modify scope of AT\nAuth Server-&gt;&gt;Auth Server: Modify scope of AT to include OTP (Update token script)\nAuth Server-&gt;&gt; Website: Return Access Token with scope containing OTP\n</code></pre>","tags":["administration","recipes","stepped-up authentication","Update token","modify access token","scope"]},{"location":"janssen-server/recipes/stepped-up-authn/#implementation-details","title":"Implementation details","text":"<p>This implementation has been broken down to 5 parts highlighted in different colours. The details contain sample code that can be used to be build the flow using <code>Person Authentication Scripts</code> and <code>Update Token Scripts</code> <pre><code>\nsequenceDiagram\ntitle Implementation Stepped-up authn in Janssen's Authentication server\n\nactor Person\nparticipant Browser\nparticipant Website\nparticipant Auth Server\nparticipant API\nautonumber\nrect rgb(255, 223, 211)\nWebsite-&gt;&gt;Browser: html login form\nPerson-&gt;&gt;Browser: Update PII\nBrowser-&gt;&gt;Website: POST \nWebsite-&gt;&gt;Auth Server: login request /authorize?response_type=code id_token\nAuth Server-&gt;&gt; Auth Server: UpdateTokenScript - place user info in id_token &lt;br&gt;e.g. encrypted inum\nAuth Server -&gt;&gt;Website: return id_token and code\nend\nrect rgb(211,211,211)\nWebsite-&gt;&gt; Website: Extract the user info from id_token and save in website's session (not to be confused with Auth Server session)\nend\n\nrect rgb(212, 238, 227)\nWebsite-&gt;&gt;API: request some endpoint\nAPI-&gt;&gt;API:  Enforce&lt;br&gt; presence of &lt;br&gt; 'otp' scope&lt;br&gt; in  access_token\nAPI-&gt;&gt;Website: 401 Unauthorized&lt;br&gt;WWW-Authenticate: &lt;br&gt;Bearer error=\"insufficient_user_authentication\" \nWebsite-&gt;&gt;Browser:  redirect to AS\nend\n\n\nrect rgb(186,225,255)\nBrowser-&gt;&gt;Auth Server: authorize?acr_values=otp&lt;br&gt;&amp;client_id=1234&lt;br&gt;&amp;scope=otp + other scopes&lt;br&gt;&amp;response_type=code&lt;br&gt;&amp;client_id=____&lt;br&gt;&amp;redirect_uri=____&lt;br&gt;&amp;state=_____&lt;br&gt;&amp;nonce=____&lt;br&gt;&amp;prompt=login&amp;&lt;br&gt;login_hint=encrypted_inum\nAuth Server-&gt;&gt;Auth Server:  Get encrypted user inum,&lt;br&gt;from login_hint, and decrypt&lt;br&gt;return None, if inum not found&lt;br&gt; \nAuth Server-&gt;&gt;Browser:  Display OTP Page\nPerson-&gt;&gt;Browser:  enter OTP\nBrowser-&gt;&gt;Auth Server: POST OTP form\nAuth Server-&gt;&gt;Auth Server: validate OTP\nAuth Server-&gt;&gt;Auth Server: add session variable scope_enforce= otp\nAuth Server-&gt;&gt;Browser:  redirect to callback\nBrowser-&gt;&gt;Website:  callback URI\nWebsite-&gt;&gt;Auth Server: /token + client creds\nAuth Server-&gt;&gt;Auth Server:  Update token script is invoked. &lt;br&gt; read session variable scope-enforce &lt;br&gt; update scope of AT to include otp\nAuth Server-&gt;&gt;Website: access_token, id_token,&lt;br&gt;refresh_token\nend \n\nrect rgb(255,255,186)\nWebsite-&gt;&gt;API:  request some endpoint&lt;br&gt;(with new access_token)\nAPI-&gt;&gt;API:  verify the acess_token. It should contain the necessary scope i.e otp\nend\n</code></pre></p>","tags":["administration","recipes","stepped-up authentication","Update token","modify access token","scope"]},{"location":"janssen-server/recipes/stepped-up-authn/#step-a-ensure-id_token-has-some-info-to-identify-the-user","title":"Step A: Ensure id_token has some info to identify the user:","text":"<ol> <li>When the user logs in for the very first time and performs basic authentication, the Update Token script can be used to place a custom claim containing some user information like</li> <li>User permissions</li> <li>User personal information </li> <li>Internal user identifier. In this example, we store the encrypted inum of the user as a \"custom claim\" in the id_token. </li> <li>A good practice is to not put the primary key / user identifier in plain text</li> </ol> <p>UpdateToken script: <pre><code>   def modifyIdToken(self, jsonWebResponse, context):\n        print \"Update token script. Modify idToken: %s\" % jsonWebResponse\n        sessionIdService = CdiUtil.bean(SessionIdService)\n        session = sessionIdService.getSessionByDn(context.getGrant().getSessionDn()) # fetch from persistence\n        userService = CdiUtil.bean(UserService)\n        user_name = session.getSessionAttributes().get(\"auth_user\")                \n        foundUser = userService.getUserByAttribute(\"uid\", user_name)        \n        userInum = foundUser.getAttribute(\"inum\") \n\n        encryptedInum = CdiUtil.bean(EncryptionService).encrypt(userInum)\n        print encryptedInum \n\n        #custom claim in id_token\n        jsonWebResponse.getClaims().setClaim(\"someFancyName\", encryptedInum)\n\n        return True\n</code></pre></p>","tags":["administration","recipes","stepped-up authentication","Update token","modify access token","scope"]},{"location":"janssen-server/recipes/stepped-up-authn/#step-b-website-rp-extracts-the-user-info-from-id_token","title":"Step B: Website (RP) extracts the user info from id_token:","text":"<ol> <li>The Website (RP / client) should extract the user info from id_token and save it in the website's session.</li> <li>The website's session should not be confused with the Auth Server's session. </li> <li>The Auth Server sessions are state-less and any session related information that the website wishes to consume can only be that which can be extracted from an id_token.</li> </ol>","tags":["administration","recipes","stepped-up authentication","Update token","modify access token","scope"]},{"location":"janssen-server/recipes/stepped-up-authn/#step-c-critical-resource-accessed-by-user","title":"Step C: Critical Resource accessed by user.","text":"<ol> <li>Website detects critical resource, examines the Access token presented by the client.</li> <li>Redirects to RP for stepped-up authentication</li> </ol>","tags":["administration","recipes","stepped-up authentication","Update token","modify access token","scope"]},{"location":"janssen-server/recipes/stepped-up-authn/#step-d-stepped-up-authentication","title":"Step D: Stepped-up authentication","text":"<ol> <li>Website calls /authorize endpoint with login_hint=encrypted_inum, which was previously extracted from id_token in Step B</li> <li>Use <code>login_hint</code>, <code>id_token_hint</code> or <code>request</code>-jwe to identify the user in Person Authentication script used to perform the additional authentication step.</li> </ol> <p>Stepped-up Authn Person Authentication script: <pre><code> def prepareForStep(self, configurationAttributes, requestParameters, step):\n        print \"OTP test. Prepare for steps %s\" %step\n        if (step ==1):\n            try:\n                userService = CdiUtil.bean(UserService)\n\n                encryptedInum  = ServerUtil.getFirstValue(requestParameters, \"login_hint\")\n\n                identity = CdiUtil.bean(Identity)\n                print encryptedInum  \n\n                inum = CdiUtil.bean(EncryptionService).decrypt(encryptedInum)\n                foundUser = userService.getUserByInum(inum )\n                print  foundUser\n                username = foundUser.getUserId()\n                print \"username is %s \" % username\n                identity.setWorkingParameter(\"uusername\", username )\n                return True\n            except:\n                print \"OTP. Exception: '%s'\" % (sys.exc_info()[1])\n                return False\n\n        else:\n            return False\n</code></pre> 3. Validate user otp 4. \"enforce_scope=otp\", add to session</p> <pre><code>def authenticate(self, configurationAttributes, requestParameters, step):\n        print(\"OTP, authentication for step %s\" %step)\n        authenticationService = CdiUtil.bean(AuthenticationService)\n        identity = CdiUtil.bean(Identity)\n        userService = CdiUtil.bean(UserService)\n        username =  identity.getWorkingParameter(\"username\")\n        print username \n\n        #Here we set hard coded otp\n        otp = '12345'           \n        inputOtp = ServerUtil.getFirstValue(requestParameters, \"loginForm:otpCode\")\n        print(\"Client end otp %s \" %inputOtp)\n        print(\"Server end otp %s\" %otp)\n        if otp == inputOtp:            \n            print \"OTP Authenticated\"\n            print CdiUtil.bean(SessionIdService).getSessionId()\n            authenticationService.authenticate('username')\n            # adding to session\n            identity.setWorkingParameter(\"enforce_scope\",\"otp\")\n            return True\n        else:\n            print(\"Wrong otp\")\n            return errorMessage(\"Wrong otp entered\")\n            return False\n</code></pre> <p>5: Update AT with relevant scope * Check the session variable \"enforce_scope\" and add the \"scope\" to the Access token.  * You can also modify Access token header claims and regular claims using the <code>modifyAccessToken</code> in the Update Token Script. Update Token script: <pre><code>    def modifyAccessToken(self, accessToken, context):\n\n        #read from session\n    sessionIdService = CdiUtil.bean(SessionIdService)\n    sessionId = sessionIdService.getSessionByDn(context.getGrant().getSessionDn()) # fetch from persistence\n\n        enforce_scope = sessionId.getSessionAttributes().get(\"enforce_scope \")\n    if enforce_scope not None:\n               context.overwriteAccessTokenScopes(accessToken, Sets.newHashSet(\"existingScope1\", \"existingScope2\", \"mynewscope\"))\n\n        context.getHeader().setClaim(\"custom_header_name\", \"custom_header_value\")\n        context.getClaims().setClaim(\"claim_name\", \"claimValue\")\n</code></pre></p>","tags":["administration","recipes","stepped-up authentication","Update token","modify access token","scope"]},{"location":"janssen-server/recipes/stepped-up-authn/#step-e-access-the-critical-resource-with-new-access-token","title":"Step E: Access the critical resource with new Access token:","text":"<p>The access token contains needed scope because the scopes were updated in Step D,  point 5</p>","tags":["administration","recipes","stepped-up authentication","Update token","modify access token","scope"]},{"location":"janssen-server/recipes/stepped-up-authn/#update-token-script","title":"Update token script","text":"<pre><code>from io.jans.as.server.service import AuthenticationService\nfrom io.jans.as.server.service import UserService\nfrom io.jans.as.server.service import SessionIdService\nfrom io.jans.as.server.util import ServerUtil\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.service.common import EncryptionService\nfrom io.jans.model.custom.script.type.token import UpdateTokenType\n\n\nclass UpdateToken(UpdateTokenType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Update token script. Initializing ...\"\n        print \"Update token script. Initialized successfully\"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"Update token script. Destroying ...\"\n        print \"Update token script. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n\n    def modifyIdToken(self, jsonWebResponse, context):\n        print \"Update token script. Modify idToken: %s\" % jsonWebResponse\n        sessionIdService = CdiUtil.bean(SessionIdService)\n        session = sessionIdService.getSessionByDn(context.getGrant().getSessionDn()) # fetch from persistence\n        userService = CdiUtil.bean(UserService)\n        user_name = session.getSessionAttributes().get(\"auth_user\")                \n        foundUser = userService.getUserByAttribute(\"uid\", user_name)        \n        userInum = foundUser.getAttribute(\"inum\") \n        print userInum\n        encryptedInum = CdiUtil.bean(EncryptionService).encrypt(userInum)\n        print encryptedInum \n        #custom claim in id_token\n        jsonWebResponse.getClaims().setClaim(\"someFancyName\", encryptedInum)\n        #print \"Update token script. After modify idToken: %s\" % jsonWebResponse\n        #jsonWebResponse.getClaims().setClaim(\"someFancyName\", \"madhu\")\n        return True\n\n    def modifyAccessToken(self, accessToken, context):\n\n        #read from session\n        sessionIdService = CdiUtil.bean(SessionIdService)\n        sessionId = sessionIdService.getSessionByDn(context.getGrant().getSessionDn()) # fetch from persistence\n\n        enforce_scope = sessionId.getSessionAttributes().get(\"enforce_scope\")\n        if enforce_scope is not  None:\n            context.overwriteAccessTokenScopes(accessToken, Sets.newHashSet(\"openid\", \"profile\", \"otp\"))\n\n        return True\n\n    def modifyRefreshToken(self, refreshToken, context):\n        return True\n\n    def getRefreshTokenLifetimeInSeconds(self, context):\n        return 0\n\n    def getIdTokenLifetimeInSeconds(self, context):\n        return 0\n\n    def getAccessTokenLifetimeInSeconds(self, context):\n        return 0\n</code></pre>","tags":["administration","recipes","stepped-up authentication","Update token","modify access token","scope"]},{"location":"janssen-server/recipes/stepped-up-authn/#otp-script","title":"OTP script","text":"<pre><code>from io.jans.as.server.util import ServerUtil\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.server.security import Identity\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\nfrom io.jans.as.server.service import AuthenticationService\nfrom io.jans.as.server.service import UserService\nfrom io.jans.as.server.service import SessionIdService\nfrom org.jans.as.server.service import CookieService\nfrom javax.faces.application import FacesMessage\nfrom org.gluu.jsf2.message import FacesMessages\nfrom org.gluu.jsf2.service import FacesService\nfrom io.jans.util import StringHelper\nfrom java.util import Arrays\n\ndef errorMessage(errorInfo):\n    facesMessages = CdiUtil.bean(FacesMessages)\n\n    facesMessages.setKeepMessages()\n    facesMessages.clear()\n    facesMessages.add(FacesMessage.SEVERITY_ERROR, errorInfo)\n    return False\n\nclass PersonAuthentication(PersonAuthenticationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript,  configurationAttributes):\n        print \"OTP test. Initialization\"\n        self.auth_user = None\n        self.isUserAuthenticated = False\n        self.isValidOtp = False\n        print \"OTP test. Initialized successfully\"\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print \"OTP test. Destroy\"\n        print \"OTP test. Destroyed successfully\"\n        return True\n\n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n\n    def getApiVersion(self):\n        return 11\n\n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n        return True\n\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n        return None\n\n    def authenticate(self, configurationAttributes, requestParameters, step):\n        print(\"OTP test, authentication for step %s\" %step)\n        authenticationService = CdiUtil.bean(AuthenticationService)\n        identity = CdiUtil.bean(Identity)\n        userService = CdiUtil.bean(UserService)\n        username =  identity.getWorkingParameter(\"uusername\")\n        print \"username is %s \" , username \n        if(username  is not None):\n            userAuthenticated = authenticationService.authenticate(username)\n            print(\"User present in session\")\n\n            if(not userAuthenticated):\n                print (\"Not authenticated\")\n                return False        \n\n        #Here we set hard coded otp\n        otp = '12345'           \n        inputOtp = ServerUtil.getFirstValue(requestParameters, \"loginForm:otpCode\")\n        print(\"Client end otp %s \" %inputOtp)\n        print(\"Server end otp %s\" %otp)\n        if otp == inputOtp:            \n            print \"OTP Authenticated\"\n            print CdiUtil.bean(SessionIdService).getSessionId()\n            authenticationService.authenticate('username')\n            identity.setWorkingParameter(\"enforce_scope\",\"otp\")\n            return True\n        else:\n            print(\"Wrong otp\")\n            return errorMessage(\"Wrong otp entered\")\n            return False\n\n\n\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\n        print \"OTP test. Prepare for steps %s\" %step\n        if (step ==1):\n            try:\n                userService = CdiUtil.bean(UserService)\n\n                encryptedInum  = ServerUtil.getFirstValue(requestParameters, \"login_hint\")\n\n                identity = CdiUtil.bean(Identity)\n                print encryptedInum  \n\n                inum = CdiUtil.bean(EncryptionService).decrypt(encryptedInum)\n                foundUser = userService.getUserByInum(inum )\n                print  foundUser\n                username = foundUser.getUserId()\n                print \"username is %s \" % username\n                identity.setWorkingParameter(\"uusername\", username )\n                return True\n            except:\n                print \"OTP. Exception: '%s'\" % (sys.exc_info()[1])\n                return False\n\n        else:\n            return False\n\n    def getExtraParametersForStep(self, configurationAttributes, step):\n        return Arrays.asList(\"uusername\", \"enforce_scope\")\n    def getCountAuthenticationSteps(self, configurationAttributes):\n        return 1\n\n    def getPageForStep(self, configurationAttributes, step):\n        print(\"Get page for step %s\" %step)\n        if( step==1 ) :\n\n                return \"/auth/otp/otplogin.xhtml\"\n\n        else:\n            return \"\"\n\n    def getNextStep(self, configurationAttributes, requestParameters, step):\n        return -1\n\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n        print \"Get external logout URL call\"\n        return None\n\n    def logout(self, configurationAttributes, requestParameters):\n        print\"logout\"\n        return True\n</code></pre>","tags":["administration","recipes","stepped-up authentication","Update token","modify access token","scope"]},{"location":"janssen-server/recipes/user-password-validation/","title":"Password validation","text":"<p>User password validation can be set to check the password strength, like the password must have at least one uppercase, or lowercase, number, and the length of the password. By default, the password attribute validation is not enabled.</p>","tags":["administration","recipes","password"]},{"location":"janssen-server/recipes/user-password-validation/#enable-user-password-validation-through-command-line-tool-cli","title":"Enable user password validation through Command Line Tool (CLI)","text":"<ol> <li> <p>Obtain the unique ID, that is inum for <code>userPassword</code> attribute. <pre><code>jans cli --operation-id get-attributes --endpoint-args pattern:userPassword\n</code></pre></p> </li> <li> <p>Obatin the PatchRequest schema <pre><code>jans cli --schema PatchRequest &gt; /tmp/patch.json\n</code></pre></p> </li> <li> <p>Update <code>/tmp/patch.json</code> with user password validation details</p> <ul> <li>Enter a valid regex expression to check the strength of the password.</li> <li>Enter Minimum length, the minimum length of a value associated with    this attribute.</li> <li>Enter Maximum length, the maximum length of a value associated with    this attribute. Following is the example of having <code>userPassword</code> with minimum 8 characters, maximum 20 characters and should be alphanumeric with special characters. <pre><code>[{\n    \"op\": \"add\",\n    \"path\": \"/attributeValidation\",\n    \"value\": {\n        \"minLength\": 5,\n        \"maxLength\":15,\n        \"regexp\": \"^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#&amp;()\u2013[{}]:;',?/*~$^+=&lt;&gt;]).{8,20}$\"\n    }\n}]\n</code></pre></li> </ul> </li> <li> <p>Execute patch operation for <code>userPassword</code> attribute. <pre><code>jans cli --operation-id patch-attributes-by-inum \\\n--url-suffix=\"inum:AAEE\" --data /tmp/patch.json\n</code></pre> </p> </li> <li> <p>Create a new user using <code>post-user</code> operation.</p> </li> <li> <p>An error notification will be displayed if the password does not match the     validation criteria.</p> </li> </ol>","tags":["administration","recipes","password"]},{"location":"janssen-server/recipes/user-password-validation/#enable-user-password-validation-through-jans-text-ui-tui","title":"Enable user password validation through Jans Text UI (TUI)","text":"<ol> <li> <p>When using Janssen Text-based UI(TUI) to configure <code>userPassword</code> attribute validation , navigate via <code>Auth Server</code>-&gt;<code>Attributes</code>-&gt;search for <code>userPassword</code> attribute-&gt;open the attribute details-&gt;enable <code>Enable Custom Validation</code> field-&gt; Enter a value for <code>Regular expression</code>, <code>Minimum Length</code> &amp; <code>Maximum Length</code> fields-&gt;Save </p> </li> <li> <p>Create a new user using <code>Users</code> TUI menu.</p> </li> <li> <p>An error notification will be displayed if the password does not match the validation criteria.</p> </li> </ol>","tags":["administration","recipes","password"]},{"location":"janssen-server/recipes/user-password-validation/#enable-user-password-validation-through-jans-config-api","title":"Enable user password validation through Jans Config API","text":"<ol> <li> <p>Obtain the access token <pre><code>curl -k -u \"&lt;put_client_id_here&gt;:&lt;put_config_api_client_secret_here&gt;\" https://&lt;your.jans.server&gt;/jans-auth/restv1/token \\\n     -d  \"grant_type=client_credentials&amp;scope=https://jans.io/oauth/config/attributes.write\"\n</code></pre></p> </li> <li> <p>Obtain the unique ID, that is inum for <code>userPassword</code> attribute. <pre><code>curl -k -i -H \"Accept: application/json\" -H \"Content-Type: application/json\" \\\n  -H \"Authorization:Bearer &lt;put_access_token_here&gt;\" \n  -X GET https://&lt;your.jans.server&gt;/jans-config-api/api/v1/attributes?pattern=userPassword\n</code></pre></p> </li> <li> <p>Apply Patch for <code>userPassword</code>, use inum as path parameter</p> </li> <li>Enter a valid regex expression to check the strength of the password.</li> <li>Enter Minimum length, the minimum length of a value associated with this attribute.</li> <li> <p>Enter Maximum length, the maximum length of a value associated with this attribute.   Following is the example of having <code>userPassword</code> with minimum 8 characters, maximum 20 characters, and should be alphanumeric with special characters. <pre><code>curl -k --location --request PATCH 'https://&lt;your.jans.server&gt;/jans-config-api/api/v1/attributes/&lt;put_userPassword_inum_here&gt;' \\\n --header 'Content-Type: application/json-patch+json' --header 'Authorization: Bearer &lt;put_access_token_here&gt;' \\\n  --data-raw '[{\n    \"op\": \"add\",\n    \"path\": \"/attributeValidation\",\n    \"value\": {\n        \"minLength\": 8,\n        \"maxLength\":20,\n        \"regexp\": \"^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#&amp;()\u2013[{}]:;'\\'',?/*~$^+=&lt;&gt;]).{8,20}$\"\n    }\n}]'\n</code></pre></p> </li> <li> <p>Create a new user using <code>/jans-config-api/mgt/configuser</code> endpoint.</p> </li> <li> <p>An error notification will be displayed if the password does not match the validation criteria.</p> </li> </ol>","tags":["administration","recipes","password"]},{"location":"janssen-server/recipes/custom-web-development/authn-with-apache-reverse-proxy/","title":"Auth With Apache Reverse Proxy","text":"","tags":["administration","recipes","custom-web-development","mod-auth-openidc","apache","proxy"]},{"location":"janssen-server/recipes/custom-web-development/authn-with-apache-reverse-proxy/#contents","title":"Contents:","text":"<ul> <li>Component Setup</li> <li>Configure Janssen server</li> <li>Configure Protected Resource</li> <li>Configure openidc module</li> <li>Test Complete Flow</li> </ul> <p>This guide describes steps to enable authentication for web applications using the Janssen server which is an OpenID Connect Provider (OP).</p> <p>In the process of setting up a working environment, we will see how to use the command-line tool <code>jans-cli</code> to manually register an OpenID Connect client with the Janssen server. We will also see how to configure Relying Party to communicate with the Janssen server.</p>","tags":["administration","recipes","custom-web-development","mod-auth-openidc","apache","proxy"]},{"location":"janssen-server/recipes/custom-web-development/authn-with-apache-reverse-proxy/#hardware-configuration","title":"Hardware configuration","text":"<p>For development and POC purposes, 4GB RAM and 10 GB HDD should be available for Janssen Server. For PROD deployments, please refer installation guide.</p>","tags":["administration","recipes","custom-web-development","mod-auth-openidc","apache","proxy"]},{"location":"janssen-server/recipes/custom-web-development/authn-with-apache-reverse-proxy/#prerequisites","title":"Prerequisites","text":"<ul> <li>Installed Apache reverse proxy that is SSL enabled</li> <li>Installed Janssen server. Refer to Janssen Installation Guide for instructions.</li> </ul>","tags":["administration","recipes","custom-web-development","mod-auth-openidc","apache","proxy"]},{"location":"janssen-server/recipes/custom-web-development/authn-with-apache-reverse-proxy/#component-setup","title":"Component Setup","text":"<p>In this setup, we have four important components. - Protected resource is a resource that we need to protect using authentication. A web application for example.  - User workstation is from where the user will use a browser(i.e user agent) to access the protected resource - Apache reverse proxy with mod_auth_openidc is our reverse proxy server and relying party.   - Reverse Proxy: In our setup protected resources will be accessible through the proxy's FQDN <code>https://test.apache.rp.io</code>. For simplicity, we will use a CGI script as a protected resource and host it on the Apache proxy itself. In a typical production setup, protected resources are usually hosted on a separate server.    - Relying Party: We will use Apache module mod_auth_openidc to provide relying party(RP) functionality. RP implements authentication flows from OpenID Connect specification. For each incoming request, RP ensures that the request is authenticated. If the request is not pre-authenticated, then RP will coordinate with Janssen server to integrate authentication. - Janssen server is our open-id connect provider (OP). We will assume that the Janssen server is accessible at FQDN <code>https://janssen.op.io/</code></p>","tags":["administration","recipes","custom-web-development","mod-auth-openidc","apache","proxy"]},{"location":"janssen-server/recipes/custom-web-development/authn-with-apache-reverse-proxy/#configure-janssen-server","title":"Configure Janssen server","text":"<p>In this section, we will register a new OpenID Connect client on Janssen server. In our setup, the relying party (Apache with mod_auth-openidc) is the OIDC client. There are two ways you can register OIDC client with Janssen server. 1. Manual Client Registration 2. Dynamic Client Registration (DCR)</p> <p>Here we will use manual client registration.</p> <p>To register a new OpenID connect client on the Janssen server, we will use <code>jans-cli</code> tool provided by the Janssen server. <code>jans-cli</code> has a menu-driven interface that makes it easy to configure the Janssen server. Here we will use the menu-driven approach to register a new client. To further understand how to use menu-driven approach and get complete list of supported command-line operations, refer to jans-cli documentation.</p> <ul> <li> <p>Run the command below on Janssen server to enter interactive mode. </p> <p>Note:  <code>jans-cli</code> has to be authenticated and authorized with the respective Janssen server. If <code>jans-cli</code> is being executed for the first time or if there is no valid access token available, then running the command below will initiate device authentication and authorization flow. In that case, follow the steps for jans-cli authorization to continue running the command.</p> <pre><code>/opt/jans/jans-cli/config-cli.py\n</code></pre> <p>Running above command will bring up main menu as shown in sample below:</p> <p></p> <p>To register a new OpenID Connect client, select <code>OAuth OpenID Connect - Clients</code> option (<code>16</code> in above sample). Selecting an appropriate option will bring up related sub-menu. </p> </li> <li> <p>From sub-menu, select option for <code>Create new OpenId connect client</code>. Upon selecting this option, CLI will prompt for inputs required to register a new OpenID connect client.</p> </li> <li> <p>Provide inputs for the following properties:</p> <pre><code>displayName: &lt;name-of-choice&gt;\napplication Type: web\nincludeClaimsInIdToken  [false]: \nPopulate optional fields? y\nclientSecret: &lt;secret-of-your-choice&gt;\nsubjectType: public\ntokenEndpointAuthMethod: client_secret_basic\nredirectUris: https://test.apache.rp.io/callback\nscopes: email_,openid_,profile\nresponseTypes: code\ngrantTypes: authorization_code\n</code></pre> </li> <li> <p>Once values for all the above properties are provided, input <code>c</code> at the prompt to instruct <code>jans-cli</code> to create schema using inputs provided till now. At this time, <code>jans-cli</code> will show the schema(JSON) that will be used to create a new OpenID Connect client on Janssen server. Verify that schema has captured all the provided inputs correctly.</p> </li> <li>Now next step is for <code>jans-cli</code> to post this JSON schema to Janssen server to actually register new client. To do this, input <code>y</code> on the prompt.</li> <li> <p>If the client is successfully registered then we will receive JSON data back. This data describes newly registered client. Some of these values from this JSON response, like <code>inum</code> and <code>clientSecret</code>, will be required when we configure <code>mod_auth_openidc</code> as a client. So keep this reponse JSON handy. See a sample of JSON response below:</p> <pre><code>{\n  \"dn\": \"inum=165bdf95-f15e-44f0-bdd7-cdac71fda8e0,ou=clients,o=jans\",\n  \"inum\": \"165bdf95-f15e-44f0-bdd7-cdac71fda8e0\",\n  \"displayName\": \"dm\",\n  \"clientSecret\": \"a9894ba8-eb01-4a26-a69d-026f10a49272\",\n  \"frontChannelLogoutUri\": null,\n  \"frontChannelLogoutSessionRequired\": false,\n  \"registrationAccessToken\": null,\n  \"clientIdIssuedAt\": null,\n  \"clientSecretExpiresAt\": null,\n  \"redirectUris\": null,\n  \"claimRedirectUris\": null,\n  \"responseTypes\": null,\n  \"grantTypes\": [],\n  \"applicationType\": \"web\",\n  \"contacts\": null,\n  \"clientName\": \"dm\",\n  \"idTokenTokenBindingCnf\": null,\n  \"logoUri\": null,\n  \"clientUri\": null,\n  \"policyUri\": null,\n  \"tosUri\": null,\n  \"jwksUri\": null,\n  \"jwks\": null,\n  \"sectorIdentifierUri\": null,\n  \"subjectType\": \"public\",\n  \"idTokenSignedResponseAlg\": null,\n  \"idTokenEncryptedResponseAlg\": null,\n  \"idTokenEncryptedResponseEnc\": null,\n  \"userInfoSignedResponseAlg\": null,\n  \"userInfoEncryptedResponseAlg\": null,\n  \"userInfoEncryptedResponseEnc\": null,\n  \"requestObjectSigningAlg\": null,\n  \"requestObjectEncryptionAlg\": null,\n  \"requestObjectEncryptionEnc\": null,\n  \"tokenEndpointAuthMethod\": null,\n  \"tokenEndpointAuthSigningAlg\": null,\n  \"defaultMaxAge\": null,\n  \"requireAuthTime\": false,\n  \"defaultAcrValues\": null,\n  \"initiateLoginUri\": null,\n  \"postLogoutRedirectUris\": null,\n  \"requestUris\": null,\n  \"scopes\": null,\n  \"claims\": null,\n  \"trustedClient\": false,\n  \"lastAccessTime\": null,\n  \"lastLogonTime\": null,\n  \"persistClientAuthorizations\": false,\n  \"includeClaimsInIdToken\": false,\n  \"refreshTokenLifetime\": null,\n  \"accessTokenLifetime\": null,\n  \"customAttributes\": [],\n  \"customObjectClasses\": null,\n  \"rptAsJwt\": false,\n  \"accessTokenAsJwt\": false,\n  \"accessTokenSigningAlg\": null,\n  \"disabled\": false,\n  \"authorizedOrigins\": null,\n  \"softwareId\": null,\n  \"softwareVersion\": null,\n  \"softwareStatement\": null,\n  \"attributes\": {\n    \"tlsClientAuthSubjectDn\": null,\n    \"runIntrospectionScriptBeforeJwtCreation\": false,\n    \"keepClientAuthorizationAfterExpiration\": false,\n    \"allowSpontaneousScopes\": false,\n    \"spontaneousScopes\": null,\n    \"spontaneousScopeScriptDns\": null,\n    \"backchannelLogoutUri\": null,\n    \"backchannelLogoutSessionRequired\": false,\n    \"additionalAudience\": null,\n    \"postAuthnScripts\": null,\n    \"consentGatheringScripts\": null,\n    \"introspectionScripts\": null,\n    \"rptClaimsScripts\": null\n  },\n  \"backchannelTokenDeliveryMode\": null,\n  \"backchannelClientNotificationEndpoint\": null,\n  \"backchannelAuthenticationRequestSigningAlg\": null,\n  \"backchannelUserCodeParameter\": null,\n  \"expirationDate\": null,\n  \"deletable\": false,\n  \"jansId\": null\n}\n</code></pre> </li> </ul>","tags":["administration","recipes","custom-web-development","mod-auth-openidc","apache","proxy"]},{"location":"janssen-server/recipes/custom-web-development/authn-with-apache-reverse-proxy/#configure-protected-resource","title":"Configure protected resource","text":"<p>As mentioned under component setup, our protected resource will be hosted on Apache reverse proxy itself. It is a simple Python based cgi script that will print request header information and can be accessed through <code>https://test.apache.rp.io/cgi-bin/printHeaders.py</code>. Execute the steps below on Apache host to set up the protected resource:</p> <ol> <li>Create script file <code>printHeaders.py</code> <pre><code>vi /usr/lib/cgi-bin/printHeaders.py\n</code></pre>     with content as below     <pre><code>#!/usr/bin/python3\n\nimport os\n\nd = os.environ\nk = d.keys()\n\nprint \"Content-type: text/html\\n\\n\"\n\nprint \"&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;printHeaders.cgi&lt;/TITLE&gt;&lt;/Head&gt;&lt;BODY&gt;\"\nprint \"&lt;h1&gt;Environment Variables&lt;/H1&gt;\"\nfor item in k:\n  print \"&lt;p&gt;&lt;B&gt;%s&lt;/B&gt;: %s &lt;/p&gt;\" % (item, d[item])\nprint \"&lt;/BODY&gt;&lt;/HTML&gt;\"\n</code></pre></li> <li>Add Apache <code>cgi</code> module to enable execution of CGI     <pre><code>a2enmod cgi\n</code></pre></li> <li>Change permissions for CGI script so that it can be executed by Apache     <pre><code>chown www-data:www-data /usr/lib/cgi-bin/printHeaders.py\nchmod ug+x /usr/lib/cgi-bin/printHeaders.py\n</code></pre></li> </ol> <p>At this point, <code>printHeaders.py</code> should be accessible at <code>https://test.apache.rp.io/cgi-bin/printHeaders.py</code> without requiring any authentication.</p>","tags":["administration","recipes","custom-web-development","mod-auth-openidc","apache","proxy"]},{"location":"janssen-server/recipes/custom-web-development/authn-with-apache-reverse-proxy/#configure-openidc-module","title":"Configure openidc module","text":"","tags":["administration","recipes","custom-web-development","mod-auth-openidc","apache","proxy"]},{"location":"janssen-server/recipes/custom-web-development/authn-with-apache-reverse-proxy/#install-mod-auth-openidc","title":"Install mod-auth-openidc","text":"<p>On Apache reverse proxy host, add mod-auth-openidc using commands below <pre><code>apt-get install libapache2-mod-auth-openidc\na2enmod auth_openidc\nservice apache2 restart\n</code></pre></p>","tags":["administration","recipes","custom-web-development","mod-auth-openidc","apache","proxy"]},{"location":"janssen-server/recipes/custom-web-development/authn-with-apache-reverse-proxy/#configure-mod-auth-openidc","title":"Configure mod-auth-openidc","text":"<ul> <li>Open <code>/etc/apache2/sites-available/default-ssl.conf</code></li> <li>Add mod-auth-openidc configuration parameters given below for virtual host <code>_default_:443</code>. Find more configuration options for mod-auth-openidc here. </li> <li>This configuration will enable authentication for any resource under <code>/</code> context root.</li> </ul> <pre><code>OIDCProviderMetadataURL https://janssen.op.io/jans-auth/.well-known/openid-configuration\nOIDCClientID &lt;inum-as-received-in-client-registration-response&gt;\nOIDCClientSecret &lt;as-provided-in-client-registration-request&gt;\nOIDCResponseType code\nOIDCScope \"openid email profile\"\nOIDCProviderTokenEndpointAuth client_secret_basic\nOIDCSSLValidateServer Off\nOIDCProviderIssuer https://janssen.op.io\nOIDCRedirectURI https://test.apache.rp.io/callback\nOIDCCryptoPassphrase &lt;crypto-passphrase-of-choice&gt;\n&lt;Location \"/\"&gt;\n    Require valid-user\n    AuthType openid-connect\n&lt;/Location&gt;\n</code></pre> <p>Restart Apache service. <pre><code>service apache2 restart\n</code></pre></p>","tags":["administration","recipes","custom-web-development","mod-auth-openidc","apache","proxy"]},{"location":"janssen-server/recipes/custom-web-development/authn-with-apache-reverse-proxy/#test-complete-flow","title":"Test Complete Flow","text":"<ul> <li>Accessing <code>https://test.apache.rp.io/cgi-bin/printHeaders.py</code> should redirect to the Janssen authentication screen.</li> <li>Upon valid authentication, Janssen will present the user with a consent screen where the user will be able to allow user attributes that can be provided to the app</li> <li>If allowed, the user will be successfully taken to the <code>printHeaders.py</code> page. In the process, <code>mod_auth_openidc</code> also requests user claims (i.e attributes) from the <code>/userinfo</code> endpoint of the Janssen server. And makes these claims available as environment variables to the application.</li> <li><code>printHeaders.py</code> prints all the environment variables, along with user claims received from the Janssen server. The application can use this information to identify the user and also enforce access policies. Sample output below shows some of this user information and token information printed as part of environment variables:</li> </ul> <pre><code>Environment Variables\n\nOIDC_CLAIM_sub: e205be81-6a85-4d83-9126\n\nOIDC_CLAIM_email_verified: 1\n\nOIDC_CLAIM_name: Default myname User\n\nOIDC_CLAIM_nickname: myname\n\nOIDC_CLAIM_given_name: myname\n\nOIDC_CLAIM_middle_name: myname\n\nOIDC_CLAIM_family_name: User\n\nOIDC_CLAIM_email: myname@mydomain.io\n\nOIDC_access_token: d6a12cce-f196-4da3-ba17\n\nOIDC_access_token_expires: 165493257\n\nHTTPS: on\n\nSSL_TLS_SNI: test.apache.rp.io\n</code></pre>","tags":["administration","recipes","custom-web-development","mod-auth-openidc","apache","proxy"]},{"location":"janssen-server/recipes/saml/","title":"SAML Recipes","text":"<p>This section contains recipes and guides for SAML-based Single Sign-On (SSO) with the Janssen Project.</p>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/#shibboleth-identity-provider","title":"Shibboleth Identity Provider","text":"<p>The Janssen Project includes an integrated Shibboleth IDP for SAML 2.0 Identity Provider functionality. The Shibboleth IDP delegates authentication to the Janssen Auth Server, enabling all Janssen authentication methods for SAML-based SSO.</p>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/#quick-links","title":"Quick Links","text":"<ul> <li>Shibboleth IDP Overview</li> <li>Installation Guide</li> <li>Configuration</li> <li>Helm Deployment</li> <li>Config API</li> <li>Terraform Provider</li> </ul>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/#saml-topics","title":"SAML Topics","text":"Topic Description Shibboleth IDP SAML 2.0 Identity Provider based on Shibboleth 5.1.6 Federation Joining identity federations IDP-Initiated SSO IDP-initiated authentication flows SP Configuration Configuring Service Providers","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   SAML Service  \u2502     \u2502   Shibboleth    \u2502     \u2502   Janssen Auth  \u2502\n\u2502   Provider      \u2502\u2500\u2500\u2500\u2500\u25b6\u2502   IDP           \u2502\u2500\u2500\u2500\u2500\u25b6\u2502   Server        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502                       \u2502                       \u2502\n        \u2502   SAML AuthnRequest   \u2502   OAuth/OIDC          \u2502\n        \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502\n        \u2502                       \u2502                       \u2502\n        \u2502                       \u2502\u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n        \u2502   SAML Response       \u2502   User Identity       \u2502\n        \u2502\u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                       \u2502\n</code></pre>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/#use-cases","title":"Use Cases","text":"","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/#enterprise-sso","title":"Enterprise SSO","text":"<p>Use the Shibboleth IDP to provide SAML SSO for enterprise applications that require SAML authentication, such as: - Salesforce - Box - ServiceNow - Microsoft 365 (via SAML) - Custom enterprise applications</p>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/#federation","title":"Federation","text":"<p>Join identity federations like InCommon or eduGAIN to enable cross-organizational authentication.</p>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/#legacy-application-support","title":"Legacy Application Support","text":"<p>Support legacy applications that only understand SAML while maintaining modern authentication at the identity provider.</p>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/#related-documentation","title":"Related Documentation","text":"<ul> <li>Auth Server - OAuth 2.0 and OpenID Connect</li> <li>Agama - Custom authentication flows</li> </ul> <p>Contribute</p> <p>If you'd like to contribute to this document, get started with the Contribution Guide</p>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/federation/","title":"Federation","text":"","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/federation/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/federation/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/federation/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/idp-init-authn/","title":"IDP-Initiated SSO","text":"","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/idp-init-authn/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/idp-init-authn/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/idp-init-authn/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/sso-sp/","title":"SP Configuration","text":"","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/sso-sp/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/sso-sp/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","recipes","saml"]},{"location":"janssen-server/recipes/saml/sso-sp/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","recipes","saml"]},{"location":"janssen-server/reference/","title":"Reference Guide","text":"<p>The purpose of the reference guide is to provide exhaustive listings that are useful for administrators and developers. This includes, for example, the listing of all the REST APIs exposed by Janssen Server modules or the listing of all the properties used to configure Janssen Server.</p> <p>Use the left navigation bar to traverse through sub-sections of the reference guide.</p>","tags":["administration","reference"]},{"location":"janssen-server/reference/learning-reference/","title":"Community Content References","text":"<p>This is a list of helpful learning resources outside the official documentation about the Janssen Project. Most of the content is created by the community at large, along with the core team. This is not a complete list of all the content created by the community on various platforms. Please help us keep it updated by raising a PR for adding more links.</p> <p>The Janssen team usually publishes content in the following locations:</p> <ul> <li>YouTube Channel</li> <li>Linkedin Page</li> <li>Medium Article</li> </ul>","tags":["administration","external content","blogs","videos","tutorials"]},{"location":"janssen-server/reference/learning-reference/#additional-content","title":"Additional Content","text":"","tags":["administration","external content","blogs","videos","tutorials"]},{"location":"janssen-server/reference/learning-reference/#articles-and-blogs","title":"Articles and Blogs","text":"<ul> <li>An intro to Janssen IDP Terraform Provider - Part1</li> <li>An intro to Janssen IDP Terraform Provider - Part2</li> <li>Janssen + Mod Auth openidc module to Test OpenID Connect Single Sign-on (SSO) and Single Single Logout (SLO)</li> <li>Enhancing Secure Mobile Authentication with OAuth, Dynamic Client Registration, and DPoP</li> <li>Janssen Cedarling : UniFFI Binding for Mobile Apps (iOS)</li> <li>Cedarling for Access Control in Web Applications</li> </ul>","tags":["administration","external content","blogs","videos","tutorials"]},{"location":"janssen-server/reference/learning-reference/#videos","title":"Videos","text":"<ul> <li>Agama Project Of The Week Series </li> </ul>","tags":["administration","external content","blogs","videos","tutorials"]},{"location":"janssen-server/reference/openapi/","title":"API Reference","text":"<p>Janssen Server components publish REST API using OpenAPI specification and Java API using javadoc.</p>","tags":["administration","reference","REST API","javadocs"]},{"location":"janssen-server/reference/openapi/#rest-api","title":"REST API","text":"<p>Follow the links below to access respective documentation.</p> Service REST API Jans Auth Server Swagger Jans Config API Swagger Jans Core NA Jans FIDO 2 Swagger Jans SCIM API Swagger Jans KC SAML API Swagger Jans Lock Server Swagger","tags":["administration","reference","REST API","javadocs"]},{"location":"janssen-server/reference/openapi/#javadocs","title":"Javadocs","text":"<p>Javadocs for all the modules can be accessed from left side navigation bar under respective module name in Reference Guide &gt; <code>Javadocs / OpenAPI</code>.</p>","tags":["administration","reference","REST API","javadocs"]},{"location":"janssen-server/reference/database/","title":"Database Guide","text":"<p>Modern systems can work with different DB. Jans is also not exception from this rule. Currently it can work with different DB types and also can work in hybrid environment where application can use the strong power of each DB. This part is based on jans-orm layer. It has pluggable architecture which allows to add support for more DB in future.</p> <p>One of the main target of ORM module is to provide simple lightweight layer to access DB. Also it provides abstractions which hide dependency to specific DB.</p>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/#supported-db","title":"Supported DB","text":"<p>Jans has next persistence modules out-of-the-box:</p> <ul> <li>MySQL</li> <li>PostgreSQL</li> <li>Hybrid. This is virtual DB layer which allows to combine few DB types based on record type.</li> </ul>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/#configuration","title":"Configuration","text":"<p>On a Janssen Server instance the type of persistence(DB) used is specified in <code>/etc/jans/conf/jans.properties</code> using the entry as show below:</p> <pre><code>persistence.type=sql\n</code></pre> <p>Values for property <code>persistence.type</code> is set during the installation and based on choice of persistence(DB) type, it can be one of these supported values:</p> <ul> <li><code>sql</code> </li> <li><code>hybrid</code>. </li> </ul> <p>Code Connect</p> <p>In Janssen Server code base, the list of supported persistence types can be  found here.</p> <p>Based on persistent type in use, the corresponding properties file with relevant configuration properties will be available on Janssen Server instance under the directory <code>/etc/jans/conf/</code>. List of configuration files for these persistence types are:</p> <ul> <li><code>jans-sql.properties</code></li> <li><code>jans-hybrid.properties</code></li> </ul> <p>The application reloads configuration from these files after start up or on files date time modification after initialization.</p>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/#overriding-db-configuration-properties","title":"Overriding DB Configuration Properties","text":"<p>Configuration properties and the values specified under <code>.properties</code> files discussed in above section, can be overridden by dynamically passing them as a JVM parameter or as an environment variable.</p>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/#cloud-native-installations","title":"Cloud-native Installations","text":"<p>For Janssen Server installations using Helm, Docker, or local Kubernetes, dynamically passing DB configuration properties can be done by specifying environment variables.</p> <p>For example:</p> <ul> <li>Override connection URI for one specific component. For instance,   <code>jans-auth</code> component   <pre><code>CN_AUTH_JAVA_OPTIONS=-Dconnection.uri=new-mysql-uri\n</code></pre></li> <li>Override connection URI globally for all Janssen Server modules   <pre><code>CN_JAVA_OPTIONS=-Dconnection.uri=new-mysql-uri\n</code></pre>   or by exporting system-level environment variable as below   <pre><code>CONNECTION_URI=new-mysql-uri\n</code></pre> For a Helm installation you can globally override hte URI in the <code>values.yaml</code></li> </ul> <pre><code>global:\n  usrEnvs:\n    normal:\n      CN_JAVA_OPTIONS: -Dconnection.uri=jdbc:postgresql://postgresql.sql.svc.cluster.local:5432/jansdb\n</code></pre> <p>Or for a specific component like the auth server:</p> <pre><code>auth-server:\n  usrEnvs:\n    normal:\n      CN_JAVA_OPTIONS: -Dconnection.uri=jdbc:postgresql://postgresql.sql.svc.cluster.local:5432/jansdb\n</code></pre>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/#vm-installations","title":"VM Installations","text":"<p>For the Janssen Server installed on a VM, a new parameter or parameters with override values can be added either at the global level for all modules or specific to certain modules only. The steps below show how to override the DB connection URI:</p>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/#globally-for-all-modules","title":"Globally For All Modules","text":"<p>Define environment variable at the VM level, such as shown in the example below:</p> <pre><code>export CONNECTION_URI=jdbc:postgresql://localhost:5432/jansdb\n</code></pre> <p>This will affect all Janssen Server modules, where properties like <code>connection.uri</code> or <code>connection-uri</code> will be overridden with the new value.</p>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/#module-specific","title":"Module Specific","text":"<p>Properties can also be added/overridden at the module level as well. To do this, pass new values either as JVM parameters or as environment variables at the module level.</p> <p>Janssen Server module level configuration is stored under <code>/etc/default/</code> directory which contains config files for Janssen modules. For example <code>/etc/default/jans-auth</code> file contains configuration for <code>jans-auth</code> module.</p> <ul> <li>Update the <code>JAVA_OPTIONS</code> parameter to add the value of the new connection   URI against the <code>connection.uri</code> parameter.   For example:   <pre><code>-Dconnection.uri=jdbc:postgresql://localhost:5432/jansdb`\n</code></pre></li> <li>Using the environment variable, export a new variable, as shown in the example   below:   <pre><code>export CONNECTION_URI=jdbc:postgresql://localhost:5432/jansdb\n</code></pre>   The exported variable above, <code>CONNECTION_URI</code>, will override the value   provided by <code>connection.uri</code> or <code>connection-uri</code> parameters.</li> </ul>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/#architecture","title":"Architecture","text":"<p>Jans ORM has modular architecture. The are few layers in this implementation</p> <ol> <li> <p>jans-orm-core: This is base layer with next functionality:</p> <ul> <li> <p>define API methods to work with DB without specific DB dependency</p> </li> <li> <p>provide base implementation with reusable parts needed for DB modules implementation</p> </li> <li> <p>scan beans and work with ORM layer annotations</p> </li> </ul> </li> <li> <p>jans-orm-annotation: Define annotations which instruct ORM about how to work with beans and properties </p> </li> <li> <p>jans-orm-filter: This module provides Filter API. The syntax is very similar to LDAP filters. The ORM layer converts them at runtime to DB query syntax: SQL/NoSQL</p> </li> <li> <p>jans-orm-cdi: Provides reusable factory which can be used in CDI based projects</p> </li> <li> <p>jans-orm-standalone: Provides reusable factory for non CDI based application</p> </li> <li> <p>jans-orm-ldap, jans-orm-couchbase, jans-orm-sql: These are DB specific implementations.</p> </li> </ol>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/#sample-table-and-orm-api","title":"Sample table and ORM API","text":"<p>In order to work with DB ORM layer should know which data (attributes/columns) is needed for application. Most part of this information it takes from DB schema at startup but rest of it developer should define in java bean. Here is typical schema with comments:</p> <pre><code>// Specify that this is Table/objectClass structure\n@DataEntry\n// Table/objectClass name is `jansPerson`\n@ObjectClass(value = \"jansPerson\")\npublic class SimpleUser implements Serializable {\n\n    private static final long serialVersionUID = -1634191420188575733L;\n\n    // Define entry primary key. i.e a distinguished name, DN\n    @DN\n    private String dn;\n\n    // Define text attribute with name in DB `uid`.\n    // Consistency attribute instruct ORM that it should send query to DB and\n    // specify that it should execute it after table index update.\n    // This is used with Couchbase DB\n    @AttributeName(name = \"uid\", consistency = true)\n    private String userId;\n\n    // Define date/time attribute with name in DB `updatedAt`\n    @AttributeName\n    private Date updatedAt;\n\n    // Define date/time attribute with name in DB `jansCreationTimestamp`\n    @AttributeName(name = \"jansCreationTimestamp\")\n    private Date createdAt;\n\n    // Define multivalued text attribute with name in DB `jansPersistentJWT`\n    @AttributeName(name = \"jansPersistentJWT\")\n    private String[] oxAuthPersistentJwt;\n\n\n    // All attributes which not defined above ORM should put into the List&lt;CustomObjectAttribute&gt;\n    // This is convenient for custom attributes\n    @AttributesList(name = \"name\", value = \"values\", multiValued = \"multiValued\", sortByName = true)\n    protected List&lt;CustomObjectAttribute&gt; customAttributes = new ArrayList&lt;CustomObjectAttribute&gt;();\n\n    ...\n</code></pre> <p>Main PersistenceEntryManager API methods which applications can use:</p> <pre><code>    &lt;T&gt; boolean authenticate(String primaryKey, Class&lt;T&gt; entryClass, String password);\n    &lt;T&gt; boolean authenticate(String baseDN, Class&lt;T&gt; entryClass, String userName, String password);\n\n    void persist(Object entry);\n    void merge(Object entry);\n\n    &lt;T&gt; boolean contains(String primaryKey, Class&lt;T&gt; entryClass);\n    &lt;T&gt; boolean contains(String primaryKey, Class&lt;T&gt; entryClass, Filter filter);\n\n    &lt;T&gt; int countEntries(Object entry);\n    &lt;T&gt; int countEntries(String primaryKey, Class&lt;T&gt; entryClass, Filter filter);\n    &lt;T&gt; int countEntries(String primaryKey, Class&lt;T&gt; entryClass, Filter filter, SearchScope scope);\n\n    &lt;T&gt; T find(Object primaryKey, Class&lt;T&gt; entryClass, String[] ldapReturnAttributes);\n\n    &lt;T&gt; List&lt;T&gt; findEntries(Object entry);\n    &lt;T&gt; List&lt;T&gt; findEntries(Object entry, int count);\n\n    &lt;T&gt; List&lt;T&gt; findEntries(String primaryKey, Class&lt;T&gt; entryClass, Filter filter);\n    &lt;T&gt; List&lt;T&gt; findEntries(String primaryKey, Class&lt;T&gt; entryClass, Filter filter, int count);\n    &lt;T&gt; List&lt;T&gt; findEntries(String primaryKey, Class&lt;T&gt; entryClass, Filter filter, String[] ldapReturnAttributes);\n    &lt;T&gt; List&lt;T&gt; findEntries(String primaryKey, Class&lt;T&gt; entryClass, Filter filter, String[] ldapReturnAttributes, int count);\n    &lt;T&gt; List&lt;T&gt; findEntries(String primaryKey, Class&lt;T&gt; entryClass, Filter filter, SearchScope scope, String[] ldapReturnAttributes,\n                            int start, int count, int chunkSize);\n    &lt;T&gt; List&lt;T&gt; findEntries(String primaryKey, Class&lt;T&gt; entryClass, Filter filter, SearchScope scope, String[] ldapReturnAttributes,\n                            BatchOperation&lt;T&gt; batchOperation, int start, int count, int chunkSize);\n\n    &lt;T&gt; PagedResult&lt;T&gt; findPagedEntries(String primaryKey, Class&lt;T&gt; entryClass, Filter filter, String[] ldapReturnAttributes, String sortBy,\n                                        SortOrder sortOrder, int start, int count, int chunkSize);\n\n    void remove(Object entry);\n\n    &lt;T&gt; void removeByDn(String dn, String[] objectClasses);\n    &lt;T&gt; void remove(String primaryKey, Class&lt;T&gt; entryClass);\n\n    &lt;T&gt; int remove(String primaryKey, Class&lt;T&gt; entryClass, Filter filter, int count);\n\n    &lt;T&gt; void removeRecursively(String primaryKey, Class&lt;T&gt; entryClass);\n    &lt;T&gt; void removeRecursivelyFromDn(String primaryKey, String[] objectClasses);\n\n    boolean hasBranchesSupport(String primaryKey);\n    boolean hasExpirationSupport(String primaryKey);\n\n    String getPersistenceType();\n    String getPersistenceType(String primaryKey);\n\n    Date decodeTime(String primaryKey, String date);\n    String encodeTime(String primaryKey, Date date);\n\n    int getHashCode(Object entry);\n\n    &lt;T&gt; List&lt;AttributeData&gt; exportEntry(String dn, String objectClass);\n\n    &lt;T&gt; void importEntry(String dn, Class&lt;T&gt; entryClass, List&lt;AttributeData&gt; data);\n</code></pre>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/#new-db-support-and-integrations","title":"New DB support and integrations","text":"<p>The ORM developed with perspective to simplify to add new DB support. New ORM implementation requires only few classes/interfaces implementations.</p> <ol> <li> <p>Extend <code>public interface DbOperationService extends PersistenceOperationService</code> interface to define list of CRUD method which <code>DbEntryManager</code> can use.</p> </li> <li> <p>Implement abstract methods <code>DbEntryManager extends BaseEntryManager&lt;DbOperationService&gt;</code>. This define DB specific methods to work with DB low layer.</p> </li> <li> <p>Implement <code>public class DbEntryManagerFactory implements PersistenceEntryManagerFactory</code>. This CDI <code>@ApplicationScoped</code> needed to allow integrate new DB module into application.</p> </li> <li> <p>Put into final jar file <code>/META-INF/beans.xml</code> to allow CDI framework automatically find DbEntryManagerFactory from previous point.</p> </li> </ol> <p>After this it's enough to put new ORM DB module into application war file or follow customization sections to add jar file to custom jetty classpath.</p>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/#db-schema","title":"DB Schema","text":"<p>The DB schema and beans definitions should match each other. During deployment setup generates schema and indexes based on rules in schema file. The data types defined in it setup map to DB SQL types based on default rules.</p> <p>It's possible to override default generation rules. For this case there is next file.</p> <p>Default indexes defined in next files: couchbase_index.json, mysql_index.json, pgsql_index.json</p>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/mysql-config/","title":"MySQL ORM persistence layer","text":"<p>The recommended MySQL version is 8.x or newer. Before running installation the administrator can pre-install DB and provide credentials to access it or he can select option to install MySQL on same server during setup.</p> <p>During installation setup generates default /etc/jans/conf/jans-sql.properties and creates jansdb schema with tables and  initial data set.</p> <p></p>","tags":["administration","reference","database","remote database"]},{"location":"janssen-server/reference/database/mysql-config/#configuration-properties","title":"Configuration properties","text":"<p>List of specific for MySQL default setting from <code>jans-sql.properties</code>:</p> <pre><code>db.schema.name=jansdb\n\nconnection.uri=jdbc:mysql://localhost:3306/jansdb?enabledTLSProtocols=TLSv1.2\n\nconnection.driver-property.serverTimezone=UTC+0000\n# Prefix connection.driver-property.key=value will be coverterd to key=value JDBC driver properties\n#connection.driver-property.driverProperty=driverPropertyValue\n\n#connection.driver-property.useServerPrepStmts=false\nconnection.driver-property.cachePrepStmts=false\nconnection.driver-property.cacheResultSetMetadata=true\nconnection.driver-property.metadataCacheSize=500\n#connection.driver-property.prepStmtCacheSize=500\n#connection.driver-property.prepStmtCacheSqlLimit=1024\n\nauth.userName=jans\nauth.userPassword=CC0NHhtXW78=\n\n# Password hash method\npassword.encryption.method=SSHA-256\n\n# Connection pool size\nconnection.pool.max-total=40\nconnection.pool.max-idle=15\nconnection.pool.min-idle=5\n\n# Max time needed to create connection pool in milliseconds\nconnection.pool.create-max-wait-time-millis=20000\n\n# Max wait 20 seconds\nconnection.pool.max-wait-time-millis=20000\n\n# Allow to evict connection in pool after 30 minutes\nconnection.pool.min-evictable-idle-time-millis=1800000\n\n# Sets whether objects created for the pool will be validated before being returned from it\n#connection.pool.test-on-create=true\n\n# Sets whether objects borrowed from the pool will be validated when they are returned to the pool\n#connection.pool.test-on-return=true\n</code></pre> <p>The rest of properties are static for all other supported DB:</p> <pre><code>binaryAttributes=objectGUID\ncertificateAttributes=userCertificate\n</code></pre>","tags":["administration","reference","database","remote database"]},{"location":"janssen-server/reference/database/mysql-config/#doc_id-building-rules","title":"<code>doc_id</code> building rules","text":"<p>In order to support transparency for end applications and allow data migration from one DB to another ORM requires <code>DN</code> attribute in each entry. This attribute it also uses to build <code>doc_id</code>. Here is example of this <code>DN</code> -&gt; <code>doc_id</code> conversion:</p> <p></p> <p><code>doc_id</code> is primary key. In order to build unique document identifier ORM uses another unique attribute <code>DN</code>. <code>doc_id</code> is last <code>RDN</code> value.</p>","tags":["administration","reference","database","remote database"]},{"location":"janssen-server/reference/database/mysql-config/#generic-tables-structure","title":"Generic tables structure","text":"<p>Each table in jansdb MySQL schema follow next rules:</p> <ol> <li>one table for every objectClass</li> <li>has 2 mandatory column <code>DN</code> and <code>doc_id</code></li> <li>Index for primary key</li> </ol> <p></p>","tags":["administration","reference","database","remote database"]},{"location":"janssen-server/reference/database/mysql-config/#data-mapping-rules","title":"Data mapping rules","text":"<p>ORM uses VARCHAR / DATETIME(3) / INT / BINARY / SMALLINT / BLOB / JSON data types. SMALLINT represents boolean attribute type.</p> <p></p> <p><code>JSON</code> it uses to store multi-valued attribute values. The generic format of such values is:</p> <p><pre><code>{\"v\": [\"value_1\", \"value_2\", ...]}\n</code></pre> ORM add <code>v</code> key on top level due to MySQL limitations of indexing JSON array if they are on to level. If it's specified in schema that application can do search in multi-valued attribute setup add next indexes for each column:</p> <p><pre><code>  KEY `jansExtUid_json_1` ((cast(json_extract(`jansExtUid`,_utf8mb4'$.v') as char(128) array))),\n  KEY `jansExtUid_json_2` ((cast(json_extract(`jansExtUid`,_utf8mb4'$.v[0]') as char(128) charset utf8mb4))),\n  KEY `jansExtUid_json_3` ((cast(json_extract(`jansExtUid`,_utf8mb4'$.v[1]') as char(128) charset utf8mb4))),\n  KEY `jansExtUid_json_4` ((cast(json_extract(`jansExtUid`,_utf8mb4'$.v[2]') as char(128) charset utf8mb4))),\n</code></pre> By default it creates indexes for first 3 values. Administrator should add more indexes to confrom maximum count of values.</p> <p>In future versions if top level JSON array indexing will work well we can review format to use simple JSON array.</p> <p>For user password field ORM on persist/update operations automatically create hash. On authentication ORM compares hashes.</p> <p></p> <p>To store attributes defined in java beans with <code>@JsonObject</code> annotation ORM uses TEXT column type.</p> <p></p>","tags":["administration","reference","database","remote database"]},{"location":"janssen-server/reference/database/mysql-config/#java-example","title":"Java example","text":"<p>This example shows how to use ORM. It opens connection to MySQL DB and add user entry to it:</p> <pre><code>    public static void main(String[] args) {\n        // Create Sql entry manager\n        SqlEntryManager couchbaseEntryManager = createSqlEntryManager();\n\n        // Create and fill user bean\n        SimpleUser newUser = new SimpleUser();\n        newUser.setDn(String.format(\"inum=%s,ou=people,o=jans\", System.currentTimeMillis()));\n        newUser.setUserId(\"sample_user_\" + System.currentTimeMillis());\n        newUser.setUserPassword(\"test\");\n        newUser.getCustomAttributes().add(new CustomObjectAttribute(\"jansAddress\", Arrays.asList(\"London\", \"Texas\", \"New York\")));\n        newUser.getCustomAttributes().add(new CustomObjectAttribute(\"jansGuid\", \"test_value\"));\n\n        // Call ORM API to store entry\n        couchbaseEntryManager.persist(newUser);\n\n        couchbaseEntryManager.destroy();\n    }\n\n    public static SqlEntryManager createSqlEntryManager() {\n        SqlEntryManagerFactory couchbaseEntryManagerFactory = new SqlEntryManagerFactory();\n        couchbaseEntryManagerFactory.create();\n        Properties connectionProperties = getSampleConnectionProperties();\n\n        SqlEntryManager couchbaseEntryManager = couchbaseEntryManagerFactory.createEntryManager(connectionProperties);\n\n        return couchbaseEntryManager;\n    }\n\n    private static Properties getSampleConnectionProperties() {\n        Properties connectionProperties = new Properties();\n\n        connectionProperties.put(\"sql#db.schema.name\", \"jansdb\");\n        connectionProperties.put(\"sql#connection.uri\", \"jdbc:mysql://localhost:3306/jansdb?profileSQL=true\");\n\n        connectionProperties.put(\"sql#connection.driver-property.serverTimezone\", \"GMT+2\");\n        connectionProperties.put(\"sql#connection.pool.max-total\", \"300\");\n        connectionProperties.put(\"sql#connection.pool.max-idle\", \"300\");\n\n        connectionProperties.put(\"sql#auth.userName\", \"jans\");\n        connectionProperties.put(\"sql#auth.userPassword\", \"secret\");\n\n        // Password hash method\n        connectionProperties.put(\"sql#password.encryption.method\", \"SSHA-256\");\n\n        // Max time needed to create connection pool in milliseconds\n        connectionProperties.put(\"sql#connection.pool.create-max-wait-time-millis\", \"20000\");\n\n        // Max wait 20 seconds\n        connectionProperties.put(\"sql#connection.pool.max-wait-time-millis\", \"20000\");\n\n        // Allow to evict connection in pool after 30 minutes\n        connectionProperties.put(\"sql#connection.pool.min-evictable-idle-time-millis\", \"1800000\");\n\n        connectionProperties.put(\"sql#binaryAttributes\", \"objectGUID\");\n        connectionProperties.put(\"sql#certificateAttributes\", \"userCertificate\");\n\n        return connectionProperties;\n    }\n</code></pre> <p>More MySQL ORM examples is in this sample module.</p>","tags":["administration","reference","database","remote database"]},{"location":"janssen-server/reference/database/mysql-ops/","title":"MySQL Operation","text":"<p>Below operations require to log into mysql workspace first with command: <code>mysql</code></p>","tags":["administration","reference","database","additional claims to database","jansPerson"]},{"location":"janssen-server/reference/database/mysql-ops/#change-password-for-user-jans","title":"Change password for user <code>jans</code> :","text":"<ul> <li><code>ALTER USER 'jans'@'localhost' IDENTIFIED BY 'TopSecret';</code></li> <li><code>GRANT ALL PRIVILEGES ON jansdb.* TO 'jans'@'localhost';</code></li> </ul>","tags":["administration","reference","database","additional claims to database","jansPerson"]},{"location":"janssen-server/reference/database/mysql-ops/#create-new-user-claims-to-jansperson","title":"Create new user claims to <code>jansPerson</code>:","text":"<ul> <li>You can add additional attributes to <code>jansPerson</code> table and use them. Here DB stores all the user attribute information in one entry. Additional attributes will not affect the server functionality.</li> <li>Ensure you restart services after DB schema modification</li> </ul>","tags":["administration","reference","database","additional claims to database","jansPerson"]},{"location":"janssen-server/reference/database/mysql-ops/#modify-column-size-of-jansperson","title":"Modify column size of jansPerson :","text":"<p>Say we want to increase the size of <code>mail</code> field to 144. Do the following: * a. Modify column size -   <pre><code>ALTER TABLE `jansdb`.`jansPerson` CHANGE COLUMN `mail` `mail` VARCHAR(144) NULL DEFAULT NULL ;\n</code></pre> * b. Drop indexes and re-create -   <pre><code>ALTER TABLE jansdb.jansPerson DROP INDEX `jansPerson_CustomIdx2`;\nALTER TABLE jansdb.jansPerson ADD INDEX `jansPerson_CustomIdx2` ((lower(`mail`)));\n</code></pre> * c. Ensure you restart services after DB schema modification</p>","tags":["administration","reference","database","additional claims to database","jansPerson"]},{"location":"janssen-server/reference/database/mysql-ops/#add-user-in-jans-admin-group","title":"Add user in Jans admin group","text":"<ul> <li>Search for inum of <code>JansGrp</code></li> <li><code>use jansdb; select * from jansGrp\\G;</code> </li> <li>Add specific user in this group</li> <li>Get <code>DN</code> of user<ul> <li><code>use jansdb; select * from jansPerson where uid='testUser'\\G</code>;</li> <li>Copy <code>DN</code> of this user. i.e. <code>inum=83d43a5d-3311-4c93-ae26-df80c320557a,ou=people,o=jans</code> </li> </ul> </li> <li>Perform operation: <code>use jansdb; update jansGrp set member = '{\"v\": [\"inum=e4fe2c89-f588-41a2-aac5-2f1afa63bed1,ou=people,o=jans\", \"inum=83d43a5d-3311-4c93-ae26-df80c320557a,ou=people,o=jans\"]}';</code> </li> </ul>","tags":["administration","reference","database","additional claims to database","jansPerson"]},{"location":"janssen-server/reference/database/mysql-ops/#update-user-information","title":"Update user information","text":"<p>In this example we are going to update one user's email address.</p> <ul> <li>Search for existing email address: <code>use jansdb; select * from jansPerson where uid='testUser'\\G;</code></li> <li>Modify it: <code>use jansdb; update jansPerson set mail='newEmail@gluu.org' where uid='testUser';</code></li> </ul>","tags":["administration","reference","database","additional claims to database","jansPerson"]},{"location":"janssen-server/reference/database/mysql-ops/#search-user","title":"Search user :","text":"<ul> <li><code>use jansdb; select * from jansPerson where uid='admin'\\G;</code></li> </ul>","tags":["administration","reference","database","additional claims to database","jansPerson"]},{"location":"janssen-server/reference/database/mysql-ops/#add-custom-attribute","title":"Add custom attribute","text":"<p>There are three steps here:</p> <ul> <li>Create attribute in MySQL database: <code>ALTER TABLE jansdb.jansPerson ADD COLUMN cmdAttr VARCHAR(64) NULL;</code></li> <li>Restart the ConfgiApi service. If you are using kubernetes please restart the deployment.</li> <li>Create attribute using the terraform provider, curl commands, or  TUI: </li> </ul> <p>Contribute</p> <p>If you\u2019d like to contribute to this document, get started with the Contribution Guide</p>","tags":["administration","reference","database","additional claims to database","jansPerson"]},{"location":"janssen-server/reference/database/mysql-schema-ERdiagram/","title":"mysql schema ERdiagram","text":"<pre><code>erDiagram\n    jansAppConf {\n        string doc_id PK \"\"\n        string ou  \"casa,jans-conf-api,jans-scim, jans-fido2\"\n        string jansConfDyn \"json configuration for the app\"\n    }\n\n    jansPerson {\n        string doc_id PK \"eg - username1 username2\"\n        string dn \"eg: inum=username1,ou=person,o=jans\"\n        string displayName\n        string inum\n        string memberOf FK \"JSON array of dn from jansGrp\"\n        string mail\n        string uid\n        string userPassword\n        string jansAdminUIRole FK \"....\"\n    }\njansPerson ||--o{ jansGrp: belongs-to\njansGrp ||--o{ jansPerson : contains\n\njansGrp {\n    string doc_id PK \"60B7\"\n    string dn \"inum=60B7,ou=groups,o=jans\"\n    string displayName\n    string member FK \"json array of dn from jansPerson\"\n    string inum \"inum=60B7\"\n    string owner FK \"dn from jansPerson\"\n\n}\n\njansCustomScr {\n    string doc_id PK \"eg : 031C-4A65\"\n    string dn \"inum=031C-4A65, ou=script,o=jans\"\n    string inum \"same as doc_id\"\n    string displayName\n    string jansScr \"the entire script content\"\n    string jansScrType \"person_authentication,update_token\"\n    boolean jansEnabled \"0/1\"\n}\n\njansScr {\n    string doc_id PK\n    string dn\n    string inum\n    string jansScr\n    string jansScrTyp\n}\njansFido2AuthnEntry {\n    string doc_id   PK  \n    string dn\n    string jansId\n    datetime creationDate\n    string jansSessStateId\n    string jansCodeChallenge\n    string personInum FK \"inum from jansPerson\"\n    string jansAuthData\n    string jansStatus\n    string jansCodeChallengeHash\n}\njansPerson ||--o{ jansFido2AuthnEntry : contains\njansFido2RegistrationEntry {\n    string doc_id   PK\n    string dn\n    string jansId\n    datetime creationDate\n    string displayName\n    string jansSessStateId\n    string jansCodeChallenge\n    string jansCodeChallengeHash\n    string jansPublicKeyId\n    string personInum   FK \"inum from jansPerson\"\n    string jansRegistrationData\n    string jansDeviceNotificationConf\n    string jansCounter\n    string jansStatus\n\n}\njansPerson ||--o{ jansFido2RegistrationEntry : contains\n\njansClnt {\n    string doc_id PK \"fd46d193-bca6-4343-b49f-6e0b020197c3\"\n    string dn \"inum=fd46d193-bca6-4343-b49f-6e0b020197c3,ou=clients,o=jans\"\n    string displayName \"some name\"\n    string inum \"same as doc_id\"\n    string jansScope FK \"json array containing inum values from jansScope\"\n    string jansClaim FK \"json array containing inum from jansAttr\"\n}\njansClnt ||--o{ jansScope : contains\njansClnt ||--o{ jansSectorIdentifier : contains\n\njansClnt ||--o{ jansAttr : contains\n\njansClntAuthz ||--|{ jansClnt : linked-with\njansClntAuthz ||--|{ jansPerson : linked-with\njansClntAuthz ||--|{ jansScope : linked-with\n\n\n\njansClntAuthz{\n    string doc_id PK \"86ff3d19-4885-4f36-b536-17efcc802a27_2000.efad6d0e-c17b-4694-aedf-b322d10476ce\"\n    string dn \"jansId=86ff3d19-4885-4f36-b536-17efcc802a27_2000.efad6d0e-c17b-4694-aedf-b322d10476ce,ou=authorizations,o=jans\"\n    string jansId \"same as docId\"\n    string jansClntId FK \"JSON array of 1 or more client-s doc_id\"\n    string jansUserId FK \"doc_id from jansPerson\"\n    string jansScope FK \"JSON array of 1 or more scopes from jansScope\"\n}\njansScope{\n    string doc_id PK \"1200.ABCB46\"\n    string dn \"inum=1200.ABCB46,ou=scope,o=jans\"\n    string displayName\n    string inum \"same as doc_id\"\n    string jansScopeTyp \"openid, oauth\"\n    string jansClaim FK \"JSON array of 0 or more inums from jansAttr\"\n}\njansScope ||--o{ jansAttr : mapped-to\n\njansAttr{\n    string doc_id PK \"11AA\"\n    string dn \"inum=11AA,ou=attributes,o=jans\"\n    string displayName\n    string jansAttrName\n    string inum \"same as doc_id\"\n\n}\njansCache {\n    string doc_id PK \"7934d59de2bd01746b7\"\n    string uuid \"same as doc_id\"\n    string dn \"uuid=7934d59de...,ou=cache,o=jans\"\n    string dat \"rO0ABXNyAB.......\"\n}\njansSectorIdentifier{\n\n}\njansCibaReq{\n    string doc_id   PK\n    string dn\n    string authReqId    FK \"\"\n    string clnId    FK \"\"\n\n    string usrId FK \"doc_id from jansPerson\"\n    datetime creationDate\n    datetime exp\n    string jansStatus   \"active or inactive\"\n\n}\n\njansToken ||--o{ jansClnt : mapped-to\n\njansToken{\n    string doc_id PK\n    string dn\n    string usrId FK \"doc_id from jansPerson\"\n    string ssnId FK \"\"\n    string uuid\n    string tknCde\n    string clnId FK \"JSOn array containing dn of jansClnt\"\n    }\n\njansUmaPCT {\n   string doc_id    PK\n\n   string dn\n   string clnId FK \"json array of multiple inums from jansClnt\"\n   string iat\n   string tknCde FK \"\"\n   string ssnId FK\n   string jansClaimValues   FK \"\"\n   string dpop\n   string authzCode\n   string grtId FK \"... from jansGrant\"\n   string grtTyp\n   string jwtReq\n   string nnc\n   string scp   FK \"\"\n   string tknTyp\n   string usrId FK \"doc_id from jansPerson\"\n   string jansUsrDN FK \"dn from jansPerson\"\n   strin acr\n   string uuid\n   string chlng\n   string chlngMth\n   string clms\n   string attr  FK \"\"\n   string tknBndCnf\n\n\n}\njansUmaRPT {\nstring doc_id   PK\n    string dn\n    string clnId    FK \"\"\n    string tknCde   FK \"\"\n    string usrId    FK \"doc_id from jansPerson\"\n    string ssnId    FK \"\"\n    string jansUmaPermission    FK \"\"\n    string uuid\n    string dpop\n    string authzCode\n    string grtId    FK \"\"\n    string grtTyp   FK \"\"\n    string jwtReq\n    string nnc\n    string scp  FK \"\"\n    string tknTyp\n    string jansUsrDN    FK \"doc_id from jansPerson\"\n    string acr\n    string chlng\n    string chlngMth\n    string clms FK \"\"\n    string attr FK \"\"\n    string tknBndCnf\n}\njansUmaResource {\n    string doc_id   PK\n    string objectClass\n    string dn\n    string displayName\n    string inum\n    string owner    FK \"\"\n    string jansAssociatedClnt   FK \"\"\n    string jansUmaScope FK \"\"\n    string jansFaviconImage\n    string jansGrp  FK \"\"\n    string jansId\n    string jansResource\n    string jansRevision\n    string jansTyp\n    string jansScopeExpression\n    string description\n\n}\njansUmaResourcePermission {\n    string doc_id   PK\n    string dn\n    string exp\n    string del\n    string jansUmaScope\n    string jansConfCode\n    string jansResourceSetId\n    string jansAttrs\n    string jansTicket\n    string jansStatus\n\n}\n\njansGrant {\n    string doc_id PK\n    string dn\n    string grtId\n}\njansPerson ||--o{ jansSessId : has\njansSessId ||--|{ jansClnt : associated-with\njansSessId {\n    string doc_id   PK\n    string objectClass\n    string dn\n    string jansId\n    string sid\n    string creationDate\n    string jansUsrDN FK \"dn from jansPerson\"\n    string authnTime\n    string jansState\n    string jansSessState\n    string jansPermissionGranted\n    string jansAsJwt\n    string jansJwt\n    string jansPermissionGrantedMap\n    string jansInvolvedClnts    FK \"\"\n    string jansSessAttr\n\n}\njansClnt ||--o{ jansSectorIdentifer : contains\njansPairwiseIdentifier }o--|| jansPerson : linked-with\n\njansSectorIdentifer {\n    string doc_id   PK\n    string objectClass\n    string dn\n    string jansId\n    string description\n    string jansRedirectURI\n    string jansClntId   FK \"json array of multiple inums from jansClnt\"\n\n}\n\njansPairwiseIdentifier{\n    string doc_id   PK\n    string objectClass\n    string dn\n    string jansId\n    string jansSectorIdentifier FK \"\"\n    string jansClntId FK \"json array of multiple inums from jansClnt\"\n    string jansUsrId FK \"doc_id from jansPerson\"\n}\n\n\njansAdminConfDyn {\n\n}\njansStatEntry{\n\n}\njansDeviceRegistration{}\njansInumMap{}\njansMetric{}\njansPar{}\njansPassResetReq{}\njansPushApp{}\njansPushDevice{}\njansRp{}\nrpExpiredObject{}\njansAgama{}\n\n\n\n\n</code></pre>","tags":["administration","reference","database","mysql","schema","er-diagram"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/","title":"MySQL Indexes","text":"","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#adsprjdeployment","title":"adsPrjDeployment","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment adsPrjDeployment 0 PRIMARY 1 doc_id adsPrjDeployment 0 doc_id 1 doc_id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#agmflow","title":"agmFlow","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment agmFlow 0 PRIMARY 1 doc_id agmFlow 0 doc_id 1 doc_id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#agmflowrun","title":"agmFlowRun","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment agmFlowRun 0 PRIMARY 1 doc_id agmFlowRun 0 doc_id 1 doc_id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansappconf","title":"jansAppConf","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansAppConf 0 PRIMARY 1 doc_id jansAppConf 0 doc_id 1 doc_id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansattr","title":"jansAttr","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansAttr 0 PRIMARY 1 doc_id jansAttr 0 doc_id 1 doc_id jansAttr 1 jansAttr_description 1 description YES jansAttr 1 jansAttr_displayName 1 displayName YES jansAttr 1 jansAttr_jansAttrName 1 jansAttrName YES jansAttr 1 jansAttr_jansAttrOrigin 1 jansAttrOrigin YES jansAttr 1 jansAttr_inum 1 inum YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#janscache","title":"jansCache","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansCache 0 PRIMARY 1 doc_id jansCache 0 doc_id 1 doc_id jansCache 1 jansCache_CustomIdx1 1 del YES jansCache 1 jansCache_CustomIdx1 2 exp YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#janscibareq","title":"jansCibaReq","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansCibaReq 0 PRIMARY 1 doc_id jansCibaReq 0 doc_id 1 doc_id jansCibaReq 1 jansCibaReq_CustomIdx1 1 jansStatus YES jansCibaReq 1 jansCibaReq_CustomIdx1 2 exp YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansclnt","title":"jansClnt","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansClnt 0 PRIMARY 1 doc_id jansClnt 0 doc_id 1 doc_id jansClnt 1 jansClnt_displayName 1 displayName YES jansClnt 1 jansClnt_description 1 description YES jansClnt 1 jansClnt_inum 1 inum YES jansClnt 1 jansClnt_jansClntSecretExpAt 1 jansClntSecretExpAt YES jansClnt 1 jansClnt_jansRegistrationAccessTkn 1 jansRegistrationAccessTkn YES jansClnt 1 jansClnt_CustomIdx1 1 del YES jansClnt 1 jansClnt_CustomIdx1 2 exp YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansclntauthz","title":"jansClntAuthz","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansClntAuthz 0 PRIMARY 1 doc_id jansClntAuthz 0 doc_id 1 doc_id jansClntAuthz 1 jansClntAuthz_jansUsrId 1 jansUsrId YES jansClntAuthz 1 jansClntAuthz_CustomIdx1 1 del YES jansClntAuthz 1 jansClntAuthz_CustomIdx1 2 exp YES jansClntAuthz 1 jansClntId_json_1 1 None YES jansClntAuthz 1 jansClntId_json_2 1 None YES jansClntAuthz 1 jansClntId_json_3 1 None YES jansClntAuthz 1 jansClntId_json_4 1 None YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#janscustomscr","title":"jansCustomScr","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansCustomScr 0 PRIMARY 1 doc_id jansCustomScr 0 doc_id 1 doc_id jansCustomScr 1 jansCustomScr_inum 1 inum YES jansCustomScr 1 jansCustomScr_jansScrTyp 1 jansScrTyp YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansdeviceregistration","title":"jansDeviceRegistration","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansDeviceRegistration 0 PRIMARY 1 doc_id jansDeviceRegistration 0 doc_id 1 doc_id jansDeviceRegistration 1 jansDeviceRegistration_jansDeviceKeyHandle 1 jansDeviceKeyHandle YES jansDeviceRegistration 1 jansDeviceRegistration_jansDeviceHashCode 1 jansDeviceHashCode YES jansDeviceRegistration 1 jansDeviceRegistration_jansApp 1 jansApp YES jansDeviceRegistration 1 jansDeviceRegistration_jansStatus 1 jansStatus YES jansDeviceRegistration 1 jansDeviceRegistration_personInum 1 personInum YES jansDeviceRegistration 1 jansDeviceRegistration_creationDate 1 creationDate YES jansDeviceRegistration 1 jansDeviceRegistration_CustomIdx1 1 del YES jansDeviceRegistration 1 jansDeviceRegistration_CustomIdx1 2 exp YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansdocument","title":"jansDocument","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansDocument 0 PRIMARY 1 doc_id jansDocument 0 doc_id 1 doc_id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansfido2authnentry","title":"jansFido2AuthnEntry","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansFido2AuthnEntry 0 PRIMARY 1 doc_id jansFido2AuthnEntry 0 doc_id 1 doc_id jansFido2AuthnEntry 1 jansFido2AuthnEntry_creationDate 1 creationDate YES jansFido2AuthnEntry 1 jansFido2AuthnEntry_jansApp 1 jansApp YES jansFido2AuthnEntry 1 jansFido2AuthnEntry_jansCodeChallenge 1 jansCodeChallenge YES jansFido2AuthnEntry 1 jansFido2AuthnEntry_jansCodeChallengeHash 1 jansCodeChallengeHash YES jansFido2AuthnEntry 1 jansFido2AuthnEntry_personInum 1 personInum YES jansFido2AuthnEntry 1 jansFido2AuthnEntry_jansStatus 1 jansStatus YES jansFido2AuthnEntry 1 jansFido2AuthnEntry_CustomIdx1 1 del YES jansFido2AuthnEntry 1 jansFido2AuthnEntry_CustomIdx1 2 exp YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansfido2registrationentry","title":"jansFido2RegistrationEntry","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansFido2RegistrationEntry 0 PRIMARY 1 doc_id jansFido2RegistrationEntry 0 doc_id 1 doc_id jansFido2RegistrationEntry 1 jansFido2RegistrationEntry_creationDate 1 creationDate YES jansFido2RegistrationEntry 1 jansFido2RegistrationEntry_jansApp 1 jansApp YES jansFido2RegistrationEntry 1 jansFido2RegistrationEntry_jansCodeChallenge 1 jansCodeChallenge YES jansFido2RegistrationEntry 1 jansFido2RegistrationEntry_jansCodeChallengeHash 1 jansCodeChallengeHash YES jansFido2RegistrationEntry 1 jansFido2RegistrationEntry_jansPublicKeyId 1 jansPublicKeyId YES jansFido2RegistrationEntry 1 jansFido2RegistrationEntry_jansPublicKeyIdHash 1 jansPublicKeyIdHash YES jansFido2RegistrationEntry 1 jansFido2RegistrationEntry_personInum 1 personInum YES jansFido2RegistrationEntry 1 jansFido2RegistrationEntry_jansStatus 1 jansStatus YES jansFido2RegistrationEntry 1 jansFido2RegistrationEntry_CustomIdx1 1 del YES jansFido2RegistrationEntry 1 jansFido2RegistrationEntry_CustomIdx1 2 exp YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansgrant","title":"jansGrant","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansGrant 0 PRIMARY 1 doc_id jansGrant 0 doc_id 1 doc_id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansgrp","title":"jansGrp","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansGrp 0 PRIMARY 1 doc_id jansGrp 0 doc_id 1 doc_id jansGrp 1 jansGrp_description 1 description YES jansGrp 1 jansGrp_displayName 1 displayName YES jansGrp 1 jansGrp_inum 1 inum YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansinummap","title":"jansInumMap","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansInumMap 0 PRIMARY 1 doc_id jansInumMap 0 doc_id 1 doc_id jansInumMap 1 jansInumMap_jansStatus 1 jansStatus YES jansInumMap 1 jansInumMap_inum 1 inum YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansmetric","title":"jansMetric","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansMetric 0 PRIMARY 1 doc_id jansMetric 0 doc_id 1 doc_id jansMetric 1 jansMetric_jansStartDate 1 jansStartDate YES jansMetric 1 jansMetric_jansEndDate 1 jansEndDate YES jansMetric 1 jansMetric_jansAppTyp 1 jansAppTyp YES jansMetric 1 jansMetric_jansMetricTyp 1 jansMetricTyp YES jansMetric 1 jansMetric_CustomIdx1 1 del YES jansMetric 1 jansMetric_CustomIdx1 2 exp YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansorganization","title":"jansOrganization","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansOrganization 0 PRIMARY 1 doc_id jansOrganization 0 doc_id 1 doc_id jansOrganization 1 jansOrganization_uid 1 uid YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#janspairwiseidentifier","title":"jansPairwiseIdentifier","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansPairwiseIdentifier 0 PRIMARY 1 doc_id jansPairwiseIdentifier 0 doc_id 1 doc_id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#janspar","title":"jansPar","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansPar 0 PRIMARY 1 doc_id jansPar 0 doc_id 1 doc_id jansPar 1 jansPar_jansId 1 jansId YES jansPar 1 jansPar_CustomIdx1 1 del YES jansPar 1 jansPar_CustomIdx1 2 exp YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#janspassresetreq","title":"jansPassResetReq","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansPassResetReq 0 PRIMARY 1 doc_id jansPassResetReq 0 doc_id 1 doc_id jansPassResetReq 1 jansPassResetReq_creationDate 1 creationDate YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansperson","title":"jansPerson","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansPerson 0 PRIMARY 1 doc_id jansPerson 0 doc_id 1 doc_id jansPerson 1 jansPerson_displayName 1 displayName YES jansPerson 1 jansPerson_givenName 1 givenName YES jansPerson 1 jansPerson_inum 1 inum YES jansPerson 1 jansPerson_mail 1 mail YES jansPerson 1 jansPerson_sn 1 sn YES jansPerson 1 jansPerson_uid 1 uid YES jansPerson 1 jansExtUid_json_1 1 None YES jansPerson 1 jansExtUid_json_2 1 None YES jansPerson 1 jansExtUid_json_3 1 None YES jansPerson 1 jansExtUid_json_4 1 None YES jansPerson 1 jansPerson_CustomIdx1 1 None YES jansPerson 1 jansPerson_CustomIdx2 1 None YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#janspushapp","title":"jansPushApp","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansPushApp 0 PRIMARY 1 doc_id jansPushApp 0 doc_id 1 doc_id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#janspushdevice","title":"jansPushDevice","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansPushDevice 0 PRIMARY 1 doc_id jansPushDevice 0 doc_id 1 doc_id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansrp","title":"jansRp","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansRp 0 PRIMARY 1 doc_id jansRp 0 doc_id 1 doc_id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansscope","title":"jansScope","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansScope 0 PRIMARY 1 doc_id jansScope 0 doc_id 1 doc_id jansScope 1 jansScope_description 1 description YES jansScope 1 jansScope_displayName 1 displayName YES jansScope 1 jansScope_jansId 1 jansId YES jansScope 1 jansScope_CustomIdx1 1 del YES jansScope 1 jansScope_CustomIdx1 2 exp YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansscr","title":"jansScr","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansScr 0 PRIMARY 1 doc_id jansScr 0 doc_id 1 doc_id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#janssectoridentifier","title":"jansSectorIdentifier","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansSectorIdentifier 0 PRIMARY 1 doc_id jansSectorIdentifier 0 doc_id 1 doc_id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#janssessid","title":"jansSessId","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansSessId 0 PRIMARY 1 doc_id jansSessId 0 doc_id 1 doc_id jansSessId 1 jansSessId_sid 1 sid YES jansSessId 1 jansSessId_jansUsrDN 1 jansUsrDN YES jansSessId 1 jansSessId_deviceSecret 1 deviceSecret YES jansSessId 1 jansSessId_CustomIdx1 1 del YES jansSessId 1 jansSessId_CustomIdx1 2 exp YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansssa","title":"jansSsa","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansSsa 0 PRIMARY 1 doc_id jansSsa 0 doc_id 1 doc_id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansstatentry","title":"jansStatEntry","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansStatEntry 0 PRIMARY 1 doc_id jansStatEntry 0 doc_id 1 doc_id jansStatEntry 1 jansStatEntry_jansId 1 jansId YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#janstoken","title":"jansToken","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansToken 0 PRIMARY 1 doc_id jansToken 0 doc_id 1 doc_id jansToken 1 jansToken_authzCode 1 authzCode YES jansToken 1 jansToken_grtId 1 grtId YES jansToken 1 jansToken_tknCde 1 tknCde YES jansToken 1 jansToken_ssnId 1 ssnId YES jansToken 1 jansToken_CustomIdx1 1 del YES jansToken 1 jansToken_CustomIdx1 2 exp YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansu2freq","title":"jansU2fReq","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansU2fReq 0 PRIMARY 1 doc_id jansU2fReq 0 doc_id 1 doc_id jansU2fReq 1 jansU2fReq_creationDate 1 creationDate YES jansU2fReq 1 jansU2fReq_CustomIdx1 1 del YES jansU2fReq 1 jansU2fReq_CustomIdx1 2 exp YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansumapct","title":"jansUmaPCT","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansUmaPCT 0 PRIMARY 1 doc_id jansUmaPCT 0 doc_id 1 doc_id jansUmaPCT 1 jansUmaPCT_tknCde 1 tknCde YES jansUmaPCT 1 jansUmaPCT_CustomIdx1 1 del YES jansUmaPCT 1 jansUmaPCT_CustomIdx1 2 exp YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansumarpt","title":"jansUmaRPT","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansUmaRPT 0 PRIMARY 1 doc_id jansUmaRPT 0 doc_id 1 doc_id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansumaresource","title":"jansUmaResource","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansUmaResource 0 PRIMARY 1 doc_id jansUmaResource 0 doc_id 1 doc_id jansUmaResource 1 jansUmaResource_displayName 1 displayName YES jansUmaResource 1 jansUmaResource_jansUmaScope 1 jansUmaScope YES jansUmaResource 1 jansUmaResource_jansId 1 jansId YES jansUmaResource 1 jansUmaResource_CustomIdx1 1 del YES jansUmaResource 1 jansUmaResource_CustomIdx1 2 exp YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema-indexes/#jansumaresourcepermission","title":"jansUmaResourcePermission","text":"Table Non_unique Key_name Seq_in_index Column_name Null Comment Index_comment jansUmaResourcePermission 0 PRIMARY 1 doc_id jansUmaResourcePermission 0 doc_id 1 doc_id jansUmaResourcePermission 1 jansUmaResourcePermission_jansTicket 1 jansTicket YES","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/","title":"MySQL Schema","text":"","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#tables","title":"Tables","text":"Table names adsPrjDeployment agmFlow agmFlowRun jansAppConf jansAttr jansCache jansCibaReq jansClnt jansClntAuthz jansCustomScr jansDeviceRegistration jansDocument jansFido2AuthnEntry jansFido2RegistrationEntry jansGrant jansGrp jansInumMap jansMetric jansOrganization jansPairwiseIdentifier jansPar jansPassResetReq jansPerson jansPushApp jansPushDevice jansRp jansScope jansScr jansSectorIdentifier jansSessId jansSsa jansStatEntry jansToken jansU2fReq jansUmaPCT jansUmaRPT jansUmaResource jansUmaResourcePermission","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#adsprjdeployment","title":"adsPrjDeployment","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansId varchar(128) YES None Identifier jansStartDate datetime(3) YES None Start date jansActive smallint YES None jansEndDate datetime(3) YES None End date adsPrjAssets longtext YES None Assets of an ADS project adsPrjDeplDetails text YES None Misc details associated to an ADS project","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#agmflow","title":"agmFlow","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None agFlowQname varchar(64) YES None Full name of an agama flow agFlowMeta text YES None Metadata of an agama flow jansScr text YES None Attr that contains script (python, java script) jansEnabled smallint YES None Status of the entry, used by many objectclasses jansScrError text YES None Attr that contains first error which application get during it execution agFlowTrans text YES None Transpiled code of an agama flow jansRevision int YES None Revision jansCustomMessage varchar(128) YES None exclude custom welcome message","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#agmflowrun","title":"agmFlowRun","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansId varchar(128) YES None Identifier agFlowSt text YES None Details of a running agama flow instance agFlowEncCont mediumtext YES None Continuation associated to a running agama flow instance jansCustomMessage varchar(128) YES None exclude custom welcome message exp datetime(3) YES None jans Exp","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansappconf","title":"jansAppConf","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None c varchar(2) YES None ou varchar(64) YES None description varchar(768) YES None displayName varchar(128) YES None preferred name of a person to be used when displaying entries jansHostname varchar(64) YES None The hostname of the Jans Server instance jansLastUpd datetime(3) YES None Monitors last time the server was able to connect to  the monitoring system. jansManager varchar(64) YES None Used to specify if a person has the manager role jansOrgProfileMgt smallint YES None enable or disable profile management feature in exclude jansScimEnabled smallint YES None exclude SCIM feature - enabled or disabled jansEmail json YES None jansSmtpConf json YES None SMTP configuration jansSslExpiry varchar(64) YES None SAML Trust Relationship configuration jansStatus varchar(16) YES None Status of the entry, used by many objectclasses jansUrl varchar(64) YES None Jans instance URL inum varchar(64) YES None XRI i-number o varchar(64) YES None jansAuthMode varchar(64) YES None jansDbAuth json YES None Custom IDP authentication configuration jansLogViewerConfig varchar(64) YES None Log viewer configuration jansLogConfigLocation varchar(64) YES None Path to external log4j2.xml jansCacheConf text YES None Cache configuration jansDocStoreConf text YES None jansDocStoreConf jansSoftVer varchar(64) YES None userPassword varchar(256) YES None jansConfDyn text YES None jans Dyn Conf jansConfErrors text YES None jans Errors Conf jansConfStatic text YES None jans Static Conf jansConfWebKeys text YES None jans Web Keys Conf jansWebKeysSettings varchar(64) YES None jans Web Keys Conf jansConfApp text YES None jans App Conf jansRevision int YES None Revision","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansattr","title":"jansAttr","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None description varchar(768) YES MUL None displayName varchar(128) YES MUL None preferred name of a person to be used when displaying entries jansAttrEditTyp json YES None Specify in exclude who can update an attribute, admin or user jansAttrName varchar(64) YES MUL None Specify an identifier for an attribute. May be multi-value  where an attribute has two names, like givenName and first-name. jansAttrOrigin varchar(64) YES MUL None Specify the person objectclass associated with the attribute,  used for display purposes in exclude. jansAttrSystemEditTyp varchar(64) YES None TODO - still required? jansAttrTyp varchar(64) YES None Data type of attribute. Values can be string, photo, numeric, date jansClaimName varchar(64) YES None Used by jans in conjunction with jansttributeName to map claims to attributes in datastore. jansAttrUsgTyp varchar(64) YES None TODO - Usg? Value can be OpenID jansAttrViewTyp json YES None Specify in exclude who can view an attribute, admin or user jansSAML1URI varchar(64) YES None SAML 1 uri of attribute jansSAML2URI varchar(64) YES None SAML 2 uri of attribute jansStatus varchar(16) YES None Status of the entry, used by many objectclasses inum varchar(64) YES MUL None XRI i-number jansMultivaluedAttr smallint YES None jansHideOnDiscovery smallint YES None jansNameIdTyp varchar(64) YES None NameId Typ jansScimCustomAttr smallint YES None jansSourceAttr varchar(64) YES None Source Attr for this Attr seeAlso varchar(64) YES None urn varchar(128) YES None jansRegExp varchar(64) YES None Regular expression used to validate attribute data jansTooltip varchar(64) YES None Custom tooltip to be shown on the UI jansValidation tinytext YES None This data has information about attribute Validation","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#janscache","title":"jansCache","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None uuid varchar(64) YES None Unique identifier iat datetime(3) YES None jans Creation exp datetime(3) YES None jans Exp del smallint YES MUL None del dat text YES None OX data","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#janscibareq","title":"jansCibaReq","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None authReqId varchar(64) YES None Authn request id clnId varchar(64) YES None jans Clnt id usrId varchar(64) YES None jans user id creationDate datetime(3) YES None Creation Date used for password reset requests exp datetime(3) YES None jans Exp jansStatus varchar(16) YES MUL None Status of the entry, used by many objectclasses","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansclnt","title":"jansClnt","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None o varchar(64) YES None jansGrp varchar(64) YES None Group displayName varchar(128) YES MUL None preferred name of a person to be used when displaying entries displayNameLocalized json YES None jans Display Name Localized description varchar(768) YES MUL None inum varchar(64) YES MUL None XRI i-number jansAppTyp varchar(64) YES None jans App Typ jansClntIdIssuedAt datetime(3) YES None jans Clnt Issued At jansClntSecret varchar(64) YES None jans Clnt Secret jansClntSecretExpAt datetime(3) YES MUL None Date client expires exp datetime(3) YES None jans Exp del smallint YES MUL None del jansClntURI tinytext YES None jans Clnt URI jansClntURILocalized json YES None jans Clnt URI localized jansContact json YES None jans Contact jansDefAcrValues json YES None jans Def Acr Values jansDefMaxAge int YES None jans Def Max Age jansGrantTyp json YES None jans Grant Typ jansIdTknEncRespAlg varchar(64) YES None jans ID Tkn Enc Resp Alg jansIdTknEncRespEnc varchar(64) YES None jans ID Tkn Enc Resp Enc jansIdTknSignedRespAlg varchar(64) YES None jans ID Tkn Signed Resp Alg jansInitiateLoginURI tinytext YES None jans Initiate Login URI jansJwksURI tinytext YES None jans JWKs URI jansJwks text YES None jans JWKs jansLogoURI tinytext YES None jans Logo URI jansLogoURILocalized json YES None jans Logo URI localized jansPolicyURI tinytext YES None jans Policy URI jansPolicyURILocalized json YES None jans Policy URI localized jansPostLogoutRedirectURI json YES None jans Post Logout Redirect URI jansRedirectURI json YES None jans Redirect URI jansRegistrationAccessTkn varchar(64) YES MUL None jans Registration Access Tkn jansReqObjSigAlg varchar(64) YES None jans Req Obj Sig Alg jansReqObjEncAlg varchar(64) YES None jans Req Obj Enc Alg jansReqObjEncEnc varchar(64) YES None jans Req Obj Enc Enc jansReqURI json YES None jans Req URI jansRespTyp json YES None jans Resp Typ jansScope json YES None jans Attr Scope jansClaim json YES None jans Attr Claim jansSectorIdentifierURI tinytext YES None jans Sector Identifier URI jansSignedRespAlg varchar(64) YES None jans Signed Resp Alg jansSubjectTyp varchar(64) YES None jans Subject Typ jansTknEndpointAuthMethod varchar(64) YES None jans Tkn Endpoint Auth Method jansTknEndpointAuthSigAlg varchar(64) YES None jans Tkn Endpoint Auth Sig Alg jansTosURI tinytext YES None jans TOS URI jansTosURILocalized json YES None jans Tos URI localized jansTrustedClnt smallint YES None jans Trusted Clnt jansUsrInfEncRespAlg varchar(64) YES None jans Usr Inf Enc Resp Alg jansUsrInfEncRespEnc varchar(64) YES None jans Usr Inf Enc Resp Enc jansExtraConf varchar(64) YES None jans additional configuration jansClaimRedirectURI json YES None Claim Redirect URI jansLastAccessTime datetime(3) YES None Last access time jansLastLogonTime datetime(3) YES None Last logon time jansPersistClntAuthzs smallint YES None jans Persist Clnt Authzs jansInclClaimsInIdTkn smallint YES None jans Incl Claims In Id Tkn jansRefreshTknLife int YES None Life of refresh token jansDisabled smallint YES None Status of client jansLogoutURI json YES None jans Policy URI jansLogoutSessRequired smallint YES None jans Policy URI jansdId varchar(64) YES None jansd Id jansAuthorizedOrigins json YES None jans Authorized Origins tknBndCnf tinytext YES None jansauth - Tkn Binding Id Hash jansAccessTknAsJwt smallint YES None jansauth - indicator whether to return access token as JWT jansAccessTknSigAlg varchar(64) YES None jansauth - access token signing algorithm jansAccessTknLife int YES None Life of access token jansSoftId varchar(64) YES None Soft Identifier jansSoftVer varchar(64) YES None jansSoftStatement text YES None Soft Statement jansRptAsJwt smallint YES None jansRptAsJwt jansAttrs text YES None Attrs jansBackchannelTknDeliveryMode varchar(64) YES None jans Backchannel Tkn Delivery Mode jansBackchannelClntNotificationEndpoint varchar(64) YES None jans Backchannel Clnt Notification Endpoint jansBackchannelAuthnReqSigAlg varchar(64) YES None jans Backchannel Authn Req Sig Alg jansBackchannelUsrCodeParameter smallint YES None jans Backchannel Usr Code Parameter","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansclntauthz","title":"jansClntAuthz","text":"Field Type Null Key Default Comment doc_id varchar(100) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansId varchar(128) YES None Identifier jansClntId json YES None jans Clnt id jansUsrId varchar(64) YES MUL None jans user id exp datetime(3) YES None jans Exp del smallint YES MUL None del jansScope json YES None jans Attr Scope","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#janscustomscr","title":"jansCustomScr","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None inum varchar(64) YES MUL None XRI i-number displayName varchar(128) YES None preferred name of a person to be used when displaying entries description varchar(768) YES None jansScr text YES None Attr that contains script (python, java script) jansScrTyp varchar(64) YES MUL None Attr that contains script type (e.g. python, java script) jansProgLng varchar(64) YES None programming language jansModuleProperty json YES None Module property jansConfProperty json YES None Conf property jansLevel int YES None Level jansRevision int YES None Revision jansEnabled smallint YES None Status of the entry, used by many objectclasses jansScrError text YES None Attr that contains first error which application get during it execution jansAlias json YES None jansAlias","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansdeviceregistration","title":"jansDeviceRegistration","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansId varchar(128) YES None Identifier displayName varchar(128) YES None preferred name of a person to be used when displaying entries description varchar(768) YES None jansDeviceKeyHandle varchar(128) YES MUL None jansDeviceKeyHandle jansDeviceHashCode int YES MUL None jansDeviceHashCode jansApp varchar(96) YES MUL None jansApp jansDeviceRegistrationConf text YES None jansDeviceRegistrationConf jansDeviceNotificationConf varchar(64) YES None Extended push notification configuration jansNickName varchar(64) YES None jansNickName jansDeviceData tinytext YES None jansDeviceData jansCounter int YES None jansCounter jansStatus varchar(16) YES MUL None Status of the entry, used by many objectclasses del smallint YES MUL None del exp datetime(3) YES None jans Exp personInum varchar(64) YES MUL None Inum of a person creationDate datetime(3) YES MUL None Creation Date used for password reset requests jansLastAccessTime datetime(3) YES None Last access time jansMetaLastMod varchar(64) YES None jansMetaLocation tinytext YES None jansMetaVer varchar(64) YES None","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansdocument","title":"jansDocument","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None inum varchar(64) YES None XRI i-number ou varchar(64) YES None displayName varchar(128) YES None preferred name of a person to be used when displaying entries description varchar(768) YES None document varchar(64) YES None Save Document in DB creationDate datetime(3) YES None Creation Date used for password reset requests jansModuleProperty json YES None Module property jansLevel int YES None Level jansRevision int YES None Revision jansEnabled smallint YES None Status of the entry, used by many objectclasses","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansfido2authnentry","title":"jansFido2AuthnEntry","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansId varchar(128) YES None Identifier creationDate datetime(3) YES MUL None Creation Date used for password reset requests jansApp varchar(96) YES MUL None jansApp jansSessStateId varchar(64) YES None jansSessStateId jansCodeChallenge varchar(64) YES MUL None OX PKCE code challenge jansCodeChallengeHash int YES MUL None OX code challenge hash personInum varchar(64) YES MUL None Inum of a person jansAuthData text YES None jansAuthData jansStatus varchar(16) YES MUL None Status of the entry, used by many objectclasses exp datetime(3) YES None jans Exp del smallint YES MUL None del","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansfido2registrationentry","title":"jansFido2RegistrationEntry","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansId varchar(128) YES None Identifier creationDate datetime(3) YES MUL None Creation Date used for password reset requests displayName varchar(128) YES None preferred name of a person to be used when displaying entries jansApp varchar(96) YES MUL None jansApp jansSessStateId varchar(64) YES None jansSessStateId jansCodeChallenge varchar(64) YES MUL None OX PKCE code challenge jansCodeChallengeHash int YES MUL None OX code challenge hash jansPublicKeyId varchar(96) YES MUL None jansPublicKeyId jansPublicKeyIdHash int YES MUL None jansPublicKeyIdHash personInum varchar(64) YES MUL None Inum of a person jansRegistrationData text YES None jansRegistrationData jansDeviceData tinytext YES None jansDeviceData jansDeviceNotificationConf varchar(64) YES None Extended push notification configuration jansCounter int YES None jansCounter jansStatus varchar(16) YES MUL None Status of the entry, used by many objectclasses exp datetime(3) YES None jans Exp del smallint YES MUL None del","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansgrant","title":"jansGrant","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None grtId varchar(64) YES None jans grant id iat datetime(3) YES None jans Creation","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansgrp","title":"jansGrp","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None c varchar(2) YES None description varchar(768) YES MUL None displayName varchar(128) YES MUL None preferred name of a person to be used when displaying entries jansStatus varchar(16) YES None Status of the entry, used by many objectclasses inum varchar(64) YES MUL None XRI i-number member json YES None o varchar(64) YES None owner varchar(64) YES None seeAlso varchar(64) YES None jansMetaCreated varchar(64) YES None jansMetaLastMod varchar(64) YES None jansMetaLocation tinytext YES None jansMetaVer varchar(64) YES None","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansinummap","title":"jansInumMap","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansStatus varchar(16) YES MUL None Status of the entry, used by many objectclasses inum varchar(64) YES MUL None XRI i-number jansPrimaryKeyAttrName varchar(64) YES None Primary Key Attribute Name jansPrimaryKeyValue varchar(64) YES None Primary Key Value jansSecondaryKeyAttrName varchar(64) YES None Secondary Key Attribute Name jansSecondaryKeyValue varchar(64) YES None Secondary Key Value jansTertiaryKeyAttrName varchar(64) YES None Tertiary Key Attribute Name jansTertiaryKeyValue varchar(64) YES None Tertiary Key Value","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansmetric","title":"jansMetric","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None uniqueIdentifier varchar(64) YES None jansStartDate datetime(3) YES MUL None Start date jansEndDate datetime(3) YES MUL None End date jansAppTyp varchar(64) YES MUL None jans App Typ jansMetricTyp varchar(64) YES MUL None Metric type creationDate datetime(3) YES None Creation Date used for password reset requests del smallint YES MUL None del exp datetime(3) YES None jans Exp jansData text YES None OX data jansHost varchar(64) YES None jans host","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansorganization","title":"jansOrganization","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None c varchar(2) YES None description varchar(768) YES None displayName varchar(128) YES None preferred name of a person to be used when displaying entries jansCustomMessage varchar(128) YES None exclude custom welcome message jansFaviconImage varchar(64) YES None TODO - Stores URL of favicon jansLogoImage varchar(64) YES None Logo used by exclude for default look and feel. jansManager varchar(64) YES None Used to specify if a person has the manager role jansManagerGrp tinytext YES None Used in organizatoin entry to specifies the dn of the group that  has admin priviledges in exclude. jansOrgShortName varchar(64) YES None Short description, as few letters as possible, no spaces. jansThemeColor varchar(64) YES None exclude login page configuration inum varchar(64) YES None XRI i-number l varchar(64) YES None mail varchar(96) YES None memberOf json YES None o varchar(64) YES None jansCreationTimestamp datetime(3) YES None Registration time jansRegistrationConf varchar(64) YES None Registration Conf postalCode varchar(16) YES None st varchar(64) YES None street tinytext YES None telephoneNumber varchar(20) YES None title varchar(64) YES None uid varchar(64) YES MUL None jansLogoPath varchar(64) YES None jansLogoPath jansStatus varchar(16) YES None Status of the entry, used by many objectclasses jansFaviconPath varchar(64) YES None jansFaviconPath","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#janspairwiseidentifier","title":"jansPairwiseIdentifier","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansId varchar(128) YES None Identifier jansSectorIdentifier varchar(64) YES None jans Sector Identifier jansClntId json YES None jans Clnt id jansUsrId varchar(64) YES None jans user id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#janspar","title":"jansPar","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansId varchar(128) YES MUL None Identifier jansAttrs text YES None Attrs exp datetime(3) YES None jans Exp del smallint YES MUL None del","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#janspassresetreq","title":"jansPassResetReq","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None creationDate datetime(3) YES MUL None Creation Date used for password reset requests jansGuid varchar(64) YES None A random string to mark temporary tokens personInum varchar(64) YES None Inum of a person","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansperson","title":"jansPerson","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansAssociatedClnt json YES None Associate the dn of an OAuth2 client with a person or UMA Resource Set. c varchar(2) YES None displayName varchar(128) YES MUL None preferred name of a person to be used when displaying entries givenName varchar(128) YES MUL None jansManagedOrganizations varchar(64) YES None Used to track with which organizations a person is associated jansOptOuts json YES None White pages attributes restricted by person in exclude profile management jansStatus varchar(16) YES None Status of the entry, used by many objectclasses inum varchar(64) YES MUL None XRI i-number mail varchar(96) YES MUL None memberOf json YES None o varchar(64) YES None jansPersistentJWT json YES None jans Persistent JWT jansCreationTimestamp datetime(3) YES None Registration time jansExtUid json YES None jansOTPCache json YES None Stores a used OTP to prevent a hacker from using it again. Complementary to jansExtUid attribute jansLastLogonTime datetime(3) YES None Last logon time jansActive smallint YES None jansAddress json YES None jansEmail json YES None jansEntitlements json YES None jansExtId varchar(128) YES None jansImsValue json YES None jansMetaCreated varchar(64) YES None jansMetaLastMod varchar(64) YES None jansMetaLocation tinytext YES None jansMetaVer varchar(64) YES None jansNameFormatted tinytext YES None jansPhoneValue json YES None jansPhotos json YES None jansProfileURL varchar(256) YES None jansRole json YES None jansTitle varchar(64) YES None jansUsrTyp varchar(64) YES None jansHonorificPrefix varchar(64) YES None jansHonorificSuffix varchar(64) YES None jans509Certificate json YES None jansPassExpDate datetime(3) YES None Pass Exp date, represented as an ISO 8601 (YYYY-MM-DD) format persistentId varchar(64) YES None PersistentId middleName varchar(64) YES None Middle name(s) nickname varchar(64) YES None Casual name of the End-Usr jansPrefUsrName varchar(64) YES None Shorthand Name profile varchar(64) YES None Profile page URL of the person picture tinytext YES None Profile picture URL of the person website varchar(64) YES None Web page or blog URL of the person emailVerified smallint YES None True if the e-mail address of the person has been verified; otherwise false gender varchar(32) YES None Gender of the person either female or male birthdate datetime(3) YES None Birthday of the person, represented as an ISO 8601:2004 [ISO8601-2004] YYYY-MM-DD format zoneinfo varchar(64) YES None Time zone database representing the End-Usrs time zone. For example, Europe/Paris or America/Los_Angeles locale varchar(64) YES None Locale of the person, represented as a BCP47 [RFC5646] language tag phoneNumberVerified smallint YES None True if the phone number of the person has been verified, otherwise false address tinytext YES None OpenID Connect formatted JSON object representing the address of the person updatedAt datetime(3) YES None Time the information of the person was last updated. Seconds from 1970-01-01T0:0:0Z preferredLanguage varchar(64) YES None preferred written or spoken language for a person role json YES None Role secretAnswer tinytext YES None Secret Answer secretQuestion tinytext YES None Secret Question seeAlso varchar(64) YES None sn varchar(128) YES MUL None cn varchar(128) YES None transientId varchar(64) YES None TransientId uid varchar(64) YES MUL None userPassword varchar(256) YES None st varchar(64) YES None street tinytext YES None l varchar(64) YES None jansCountInvalidLogin varchar(64) YES None Invalid login attempts count jansEnrollmentCode varchar(64) YES None jansEnrollmentCode jansIMAPData varchar(64) YES None This data has information about your imap connection jansPPID json YES None Persistent Pairwise ID for OpenID Connect jansGuid varchar(64) YES None A random string to mark temporary tokens jansPreferredMethod varchar(64) YES None Casa - Preferred method to use for user authentication userCertificate blob YES None jansOTPDevices varchar(512) YES None Casa - Json representation of OTP devices. Complementary to jansExtUid attribute jansMobileDevices varchar(512) YES None Casa - Json representation of mobile devices. Complementary to mobile attribute jansTrustedDevices text YES None Casa - Devices with which strong authentication may be skipped jansStrongAuthPolicy varchar(64) YES None Casa - 2FA Enforcement Policy for User jansUnlinkedExternalUids varchar(64) YES None Casa - List of unlinked social accounts (ie disabled jansExtUids) jansBackchannelDeviceRegistrationTkn varchar(64) YES None jans Backchannel Device Registration Tkn jansBackchannelUsrCode varchar(64) YES None jans Backchannel Usr Code telephoneNumber varchar(20) YES None mobile json YES None carLicense varchar(64) YES None vehicle license or registration plate facsimileTelephoneNumber varchar(20) YES None departmentNumber varchar(64) YES None identifies a department within an organization employeeType varchar(64) YES None type of employment for a person manager tinytext YES None postOfficeBox varchar(64) YES None employeeNumber varchar(64) YES None numerically identifies an employee within an organization preferredDeliveryMethod varchar(50) YES None roomNumber varchar(64) YES None secretary tinytext YES None homePostalAddress tinytext YES None postalCode varchar(16) YES None description varchar(768) YES None title varchar(64) YES None jansAdminUIRole json YES None jansAdminUIRole","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#janspushapp","title":"jansPushApp","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None displayName varchar(128) YES None preferred name of a person to be used when displaying entries jansId varchar(128) YES None Identifier jansName varchar(64) YES None Name jansPushAppConf varchar(64) YES None jansPush application configuration","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#janspushdevice","title":"jansPushDevice","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansUsrId varchar(64) YES None jans user id jansId varchar(128) YES None Identifier jansPushApp tinytext YES None jansPush application DN jansPushDeviceConf varchar(64) YES None jansPush device configuration jansTyp varchar(64) YES None jans type","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansrp","title":"jansRp","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansId varchar(128) YES None Identifier dat text YES None OX data","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansscope","title":"jansScope","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansDefScope smallint YES None Track the default scope for an custom OAuth2 Scope. description varchar(768) YES MUL None displayName varchar(128) YES MUL None preferred name of a person to be used when displaying entries inum varchar(64) YES None XRI i-number jansScopeTyp varchar(64) YES None OX Attr Scope type creatorId varchar(64) YES None Creator Id creatorTyp varchar(64) YES None Creator type creatorAttrs varchar(64) YES None Creator Attrs creationDate datetime(3) YES None Creation Date used for password reset requests jansClaim json YES None jans Attr Claim jansScrDn json YES None Script object DN jansGrpClaims smallint YES None jans Grp Attr Claims (true or false) jansId varchar(128) YES MUL None Identifier jansIconUrl varchar(64) YES None jans icon url jansUmaPolicyScrDn tinytext YES None OX policy script Dn jansAttrs text YES None Attrs exp datetime(3) YES None jans Exp del smallint YES MUL None del","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansscr","title":"jansScr","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None inum varchar(64) YES None XRI i-number jansScr text YES None Attr that contains script (python, java script) jansScrTyp varchar(64) YES None Attr that contains script type (e.g. python, java script)","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#janssectoridentifier","title":"jansSectorIdentifier","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansId varchar(128) YES None Identifier description varchar(768) YES None jansRedirectURI json YES None jans Redirect URI jansClntId json YES None jans Clnt id","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#janssessid","title":"jansSessId","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansId varchar(128) YES None Identifier sid varchar(64) YES MUL None Sess Identifier creationDate datetime(3) YES None Creation Date used for password reset requests exp datetime(3) YES None jans Exp del smallint YES MUL None del jansLastAccessTime datetime(3) YES None Last access time jansUsrDN varchar(128) YES MUL None jans Usr DN authnTime datetime(3) YES None jans Authn Time jansState varchar(64) YES None jansState jansSessState text YES None jans Sess State jansPermissionGranted smallint YES None jans Permission Granted jansAsJwt smallint YES None Boolean field to indicate whether object is used as JWT jansJwt text YES None JWT representation of the object or otherwise jwt associated with the object jansPermissionGrantedMap text YES None jans Permission Granted Map jansInvolvedClnts text YES None Involved clients deviceSecret varchar(64) YES MUL None deviceSecret jansSessAttr text YES None jansSessAttr - generic attributes expressed as key-value map jansAttrs text YES None jansAttrs - predefined attributes (e.g. index in status list)","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansssa","title":"jansSsa","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None inum varchar(64) YES None XRI i-number o varchar(64) YES None jansAttrs text YES None Attrs description varchar(768) YES None exp datetime(3) YES None jans Exp del smallint YES None del jansState varchar(64) YES None jansState creatorId varchar(64) YES None Creator Id creatorTyp varchar(64) YES None Creator type creationDate datetime(3) YES None Creation Date used for password reset requests","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansstatentry","title":"jansStatEntry","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansId varchar(128) YES MUL None Identifier dat text YES None OX data jansData text YES None OX data attr text YES None Attrs","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#janstoken","title":"jansToken","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None authnTime datetime(3) YES None jans Authn Time authzCode varchar(64) YES MUL None jans authorization code iat datetime(3) YES None jans Creation exp datetime(3) YES None jans Exp del smallint YES MUL None del grtId varchar(64) YES MUL None jans grant id grtTyp varchar(64) YES None jans Grant Typ jwtReq text YES None jans JWT Req nnc text YES None jans nonce scp text YES None jans Attr Scope tknCde varchar(80) YES MUL None jans Tkn Code tknTyp varchar(32) YES None jans Tkn Typ usrId varchar(64) YES None jans user id jansUsrDN varchar(128) YES None jans Usr DN clnId varchar(64) YES None jans Clnt id acr varchar(48) YES None uuid varchar(64) YES None Unique identifier chlng varchar(64) YES None OX PKCE code challenge chlngMth varchar(64) YES None OX PKCE code challenge method clms varchar(64) YES None jans Claims ssnId varchar(64) YES MUL None jans Sess DN attr text YES None Attrs tknBndCnf tinytext YES None jansauth - Tkn Binding Id Hash dpop varchar(64) YES None DPoP Proof","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansu2freq","title":"jansU2fReq","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None jansId varchar(128) YES None Identifier jansReqId varchar(64) YES None jansReqId jansReq text YES None jansReq jansSessStateId varchar(64) YES None jansSessStateId del smallint YES MUL None del exp datetime(3) YES None jans Exp personInum varchar(64) YES None Inum of a person creationDate datetime(3) YES MUL None Creation Date used for password reset requests","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansumapct","title":"jansUmaPCT","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None clnId varchar(64) YES None jans Clnt id iat datetime(3) YES None jans Creation exp datetime(3) YES None jans Exp del smallint YES MUL None del tknCde varchar(80) YES MUL None jans Tkn Code ssnId varchar(64) YES None jans Sess DN jansClaimValues varchar(64) YES None Claim Values dpop varchar(64) YES None DPoP Proof authnTime datetime(3) YES None jans Authn Time authzCode varchar(64) YES None jans authorization code grtId varchar(64) YES None jans grant id grtTyp varchar(64) YES None jans Grant Typ jwtReq text YES None jans JWT Req nnc text YES None jans nonce scp text YES None jans Attr Scope tknTyp varchar(32) YES None jans Tkn Typ usrId varchar(64) YES None jans user id jansUsrDN varchar(128) YES None jans Usr DN acr varchar(48) YES None uuid varchar(64) YES None Unique identifier chlng varchar(64) YES None OX PKCE code challenge chlngMth varchar(64) YES None OX PKCE code challenge method clms varchar(64) YES None jans Claims attr text YES None Attrs tknBndCnf tinytext YES None jansauth - Tkn Binding Id Hash","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansumarpt","title":"jansUmaRPT","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None authnTime datetime(3) YES None jans Authn Time clnId varchar(64) YES None jans Clnt id iat datetime(3) YES None jans Creation exp datetime(3) YES None jans Exp del smallint YES None del tknCde varchar(80) YES None jans Tkn Code usrId varchar(64) YES None jans user id ssnId varchar(64) YES None jans Sess DN jansUmaPermission json YES None jans uma permission uuid varchar(64) YES None Unique identifier dpop varchar(64) YES None DPoP Proof authzCode varchar(64) YES None jans authorization code grtId varchar(64) YES None jans grant id grtTyp varchar(64) YES None jans Grant Typ jwtReq text YES None jans JWT Req nnc text YES None jans nonce scp text YES None jans Attr Scope tknTyp varchar(32) YES None jans Tkn Typ jansUsrDN varchar(128) YES None jans Usr DN acr varchar(48) YES None chlng varchar(64) YES None OX PKCE code challenge chlngMth varchar(64) YES None OX PKCE code challenge method clms varchar(64) YES None jans Claims attr text YES None Attrs tknBndCnf tinytext YES None jansauth - Tkn Binding Id Hash","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansumaresource","title":"jansUmaResource","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None displayName varchar(128) YES MUL None preferred name of a person to be used when displaying entries inum varchar(64) YES None XRI i-number owner varchar(64) YES None jansAssociatedClnt json YES None Associate the dn of an OAuth2 client with a person or UMA Resource Set. jansUmaScope varchar(768) YES MUL None URI reference of scope descriptor jansFaviconImage varchar(64) YES None TODO - Stores URL of favicon jansGrp varchar(64) YES None Group jansId varchar(128) YES MUL None Identifier jansResource tinytext YES None Host path jansRevision int YES None Revision jansTyp varchar(64) YES None jans type jansScopeExpression text YES None Scope expression iat datetime(3) YES None jans Creation exp datetime(3) YES None jans Exp del smallint YES MUL None del description varchar(768) YES None","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/mysql-schema/#jansumaresourcepermission","title":"jansUmaResourcePermission","text":"Field Type Null Key Default Comment doc_id varchar(64) NO PRI None objectClass varchar(48) YES None dn varchar(128) YES None exp datetime(3) YES None jans Exp del smallint YES None del jansUmaScope varchar(768) YES None URI reference of scope descriptor jansConfCode varchar(64) YES None jans configuration code jansResourceSetId varchar(64) YES None jans resource set id jansAttrs text YES None Attrs jansTicket varchar(64) YES MUL None jans ticket jansStatus varchar(16) YES None Status of the entry, used by many objectclasses","tags":["administration","database","MySQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-config/","title":"PostgreSQL ORM persistence layer","text":"<p>The recommended PostgreSQL versions are 14.x, 15.x or newer. Before running installation the administrator can pre-install DB and provide credentials to access it or he can select option to install PostgreSQL on same server during setup.</p> <p>During installation setup generates default /etc/jans/conf/jans-sql.properties and creates jansdb schema with tables and  initial data set.</p> <p></p>","tags":["administration","reference","database","remote database"]},{"location":"janssen-server/reference/database/pgsql-config/#configuration-properties","title":"Configuration properties","text":"<p>List of specific for PostgreSQL default setting from <code>jans-sql.properties</code>:</p> <pre><code>db.schema.name=public\n\nconnection.uri=jdbc:postgresql://localhost:5432/jansdb\n\n# Prefix connection.driver-property.key=value will be coverterd to key=value JDBC driver properties\n#connection.driver-property.driverProperty=driverPropertyValue\n\n\nauth.userName=jans\nauth.userPassword=CC0NHhtXW78=\n\n# Password hash method\npassword.encryption.method=SSHA-256\n\n# Connection pool size\nconnection.pool.max-total=40\nconnection.pool.max-idle=15\nconnection.pool.min-idle=5\n\n# Max time needed to create connection pool in milliseconds\nconnection.pool.create-max-wait-time-millis=20000\n\n# Max wait 20 seconds\nconnection.pool.max-wait-time-millis=20000\n\n# Allow to evict connection in pool after 30 minutes\nconnection.pool.min-evictable-idle-time-millis=1800000\n\n# Sets whether objects created for the pool will be validated before being returned from it\n#connection.pool.test-on-create=true\n\n# Sets whether objects borrowed from the pool will be validated when they are returned to the pool\n#connection.pool.test-on-return=true\n</code></pre> <p>The rest of properties are static for all other supported DB:</p> <pre><code>binaryAttributes=objectGUID\ncertificateAttributes=userCertificate\n</code></pre>","tags":["administration","reference","database","remote database"]},{"location":"janssen-server/reference/database/pgsql-config/#doc_id-building-rules","title":"<code>doc_id</code> building rules","text":"<p>In order to support transparency for end applications and allow data migration from one DB to another ORM requires <code>DN</code> attribute in each entry. This attribute it also uses to build <code>doc_id</code>. Here is example of this <code>DN</code> -&gt; <code>doc_id</code> conversion:</p> <p></p> <p><code>doc_id</code> is primary key. In order to build unique document identifier ORM uses another unique attribute <code>DN</code>. <code>doc_id</code> is last <code>RDN</code> value.</p>","tags":["administration","reference","database","remote database"]},{"location":"janssen-server/reference/database/pgsql-config/#generic-tables-structure","title":"Generic tables structure","text":"<p>Each table in jansdb PostgreSQL database follow next rules:</p> <ol> <li>one table for every objectClass</li> <li>has 2 mandatory column <code>DN</code> and <code>doc_id</code></li> <li>Index for primary key</li> </ol> <p></p>","tags":["administration","reference","database","remote database"]},{"location":"janssen-server/reference/database/pgsql-config/#data-mapping-rules","title":"Data mapping rules","text":"<p>ORM uses CHARACTER VARYING / TIMESTAMP / INT64 / BYTEA / BOOLEAN / TEXT / JSONB data types.</p> <p></p> <p><code>JSONB</code> it uses to store multi-valued attribute values. The generic format of such values is:</p> <p><pre><code>[\"value_1\", \"value_2\", ...]\n</code></pre> If in schema specified in schema that application can do search in multi-valued attribute setup add next indexes for each column:</p> <pre><code>CREATE INDEX IF NOT EXISTS \"jansPerson_jsonb_path_query_array_idx\"\n    ON public.\"jansPerson\" USING gin\n    (jsonb_path_query_array(\"jansExtUid\", '$[*]'::jsonpath))\n    TABLESPACE pg_default;\n</code></pre> <p>For user password field ORM on persist/update operations automatically create hash. On authentication ORM compares hashes.</p> <p></p> <p>To store attributes defined in java beans with <code>@JsonObject</code> annotation ORM uses TEXT column type.</p> <p></p>","tags":["administration","reference","database","remote database"]},{"location":"janssen-server/reference/database/pgsql-config/#java-example","title":"Java example","text":"<p>This example shows how to use ORM. It opens connection to PostgreSQL DB and add user entry to it:</p> <pre><code>    public static void main(String[] args) {\n        // Create Sql entry manager\n        SqlEntryManager couchbaseEntryManager = createSqlEntryManager();\n\n        // Create and fill user bean\n        SimpleUser newUser = new SimpleUser();\n        newUser.setDn(String.format(\"inum=%s,ou=people,o=jans\", System.currentTimeMillis()));\n        newUser.setUserId(\"sample_user_\" + System.currentTimeMillis());\n        newUser.setUserPassword(\"test\");\n        newUser.getCustomAttributes().add(new CustomObjectAttribute(\"jansAddress\", Arrays.asList(\"London\", \"Texas\", \"New York\")));\n        newUser.getCustomAttributes().add(new CustomObjectAttribute(\"jansGuid\", \"test_value\"));\n\n        // Call ORM API to store entry\n        couchbaseEntryManager.persist(newUser);\n\n        couchbaseEntryManager.destroy();\n    }\n\n    public static SqlEntryManager createSqlEntryManager() {\n        SqlEntryManagerFactory couchbaseEntryManagerFactory = new SqlEntryManagerFactory();\n        couchbaseEntryManagerFactory.create();\n        Properties connectionProperties = getSampleConnectionProperties();\n\n        SqlEntryManager couchbaseEntryManager = couchbaseEntryManagerFactory.createEntryManager(connectionProperties);\n\n        return couchbaseEntryManager;\n    }\n\n    private static Properties getSampleConnectionProperties() {\n        Properties connectionProperties = new Properties();\n\n        connectionProperties.put(\"sql#db.schema.name\", \"public\");\n        connectionProperties.put(\"sql#connection.uri\", \"jdbc:postgresql://localhost:5432/jansdb\");\n\n        connectionProperties.put(\"sql#auth.userName\", \"jans\");\n        connectionProperties.put(\"sql#auth.userPassword\", \"secret\");\n\n        connectionProperties.put(\"sql#connection.pool.max-total\", \"300\");\n        connectionProperties.put(\"sql#connection.pool.max-idle\", \"300\");\n\n        connectionProperties.put(\"sql#auth.userName\", \"jans\");\n        connectionProperties.put(\"sql#auth.userPassword\", \"Secret1!\");\n\n        // Password hash method\n        connectionProperties.put(\"sql#password.encryption.method\", \"SSHA-256\");\n\n        // Max time needed to create connection pool in milliseconds\n        connectionProperties.put(\"sql#connection.pool.create-max-wait-time-millis\", \"20000\");\n\n        // Max wait 20 seconds\n        connectionProperties.put(\"sql#connection.pool.max-wait-time-millis\", \"20000\");\n\n        // Allow to evict connection in pool after 30 minutes\n        connectionProperties.put(\"sql#connection.pool.min-evictable-idle-time-millis\", \"1800000\");\n\n        connectionProperties.put(\"sql#binaryAttributes\", \"objectGUID\");\n        connectionProperties.put(\"sql#certificateAttributes\", \"userCertificate\");\n\n        return connectionProperties;\n    }\n</code></pre> <p>More MySQL ORM examples is in this sample module.</p>","tags":["administration","reference","database","remote database"]},{"location":"janssen-server/reference/database/pgsql-ops/","title":"PostgreSQL Operations","text":"<p>PostgreSQL is a versatile and reliable database management system that empowers developers and organizations to build robust and efficient applications.</p>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/pgsql-ops/#establish-connection-to-jans-postgresql-server","title":"Establish Connection to Jans PostgreSQL Server","text":"<p>Connect to PostgreSQL workspace: <code>sudo -u postgres psql</code></p> <p>Show all Database list : <code>\\list</code> or <code>\\l</code></p> <p>You will see <code>jansdb</code> in the list of database.</p> <p>Let's make a connection with <code>jansdb</code> : <code>\\c jansdb</code></p>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/pgsql-ops/#search-user","title":"Search user","text":"<ul> <li>Change database: <code>\\c jansdb</code></li> <li>Search for user <code>testUser</code>: <code>SELECT * FROM \"jansPerson\" WHERE uid = 'testuser';</code></li> <li>If you want pretty output, enable display mode with <code>\\x</code> </li> <li>Re-run search query. </li> </ul>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/pgsql-ops/#change-password-for-user-jans","title":"Change password for user jans","text":"<ul> <li>Changing user 'jans' password to \"secret\": <code>ALTER USER jans WITH PASSWORD 'secret';</code> </li> </ul>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/pgsql-ops/#add-user-in-jans-group","title":"Add user in Jans Group","text":"<ul> <li>Get DN of target user. i.e. we are searching for DN of user 'testUser' with: <code>SELECT * FROM \"jansPerson\" WHERE uid = 'testuser';</code></li> <li>Get DN of Jans Admin Group. i.e. <code>SELECT * FROM \"jansGrp\";</code></li> <li>Add ( actually append ) new user in <code>member</code> of this group:  <pre><code>UPDATE \"jansGrp\" SET member = '[\"inum=d33a2ce9-e9de-4f74-8a7d-2519f73635b7,ou=people,o=jans\", \"inum=618d7792-caca-4915-8b92-9955bf94affb,ou=people,o=jans\"]';\n</code></pre></li> </ul>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/pgsql-ops/#list-users-with-specific-filter","title":"List users with specific filter","text":"<p>To search for users with a filter using PostgreSQL's command-line tool psql, you can use the <code>SELECT</code> statement with the <code>WHERE</code> clause to apply filters to the query. Here's the query to find specific user:</p> <pre><code>SELECT * FROM \"jansPerson\" WHERE uid= '&lt;uid&gt;';\n</code></pre>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/pgsql-ops/#modify-column-size-of-jans-postgresql","title":"Modify column size of Jans postgresql","text":"<p>The psql command-line tool, you can use the <code>\\d+</code> command to display detailed information about a table, including its columns. Lets see the details of <code>jansPerson</code> table:</p> <pre><code>\\d+ \"jansPerson\";\n</code></pre> <p>To modify the size of a column in a PostgreSQL table, you will need to use the <code>ALTER TABLE</code> statement along with the <code>ALTER COLUMN</code> clause. Here's how you can modify the size of a column:</p> <pre><code>ALTER TABLE \"jansPerson\" \nALTER COLUMN mail TYPE VARCHAR(100);\n</code></pre>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/pgsql-ops/#add-custom-attribute","title":"Add custom attribute","text":"<p>To add a custom attribute to an existing PostgreSQL table, you can use the <code>ALTER TABLE</code> statement with the <code>ADD COLUMN</code> clause. Here's how you can add a custom attribute in <code>jansPerson</code> table:</p> <p><pre><code>ALTER TABLE \"jansPerson\"\nADD COLUMN membership_level VARCHAR(50);\n</code></pre> You can also specify additional constraints, defaults, or other attributes for the new column as needed. Here's an example with a <code>default</code> value:</p> <pre><code>ALTER TABLE \"jansPerson\"\nADD COLUMN membership_level VARCHAR DEFAULT 'Basic';\n</code></pre>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/pgsql-ops/#output-column-data-into-txt","title":"Output column data into txt","text":"<p>If you want to output the data from a PostgreSQL table's column into a text file, you can use the <code>COPY</code> command. This command allows you to copy the contents of a table or query result into an external file. Here's how you can do it:</p> <pre><code>COPY (SELECT * FROM \"jansPerson\") TO '/tmp/output.txt';\n</code></pre> <p>After executing the command, the data from the specified column will be copied into the specified text file.</p>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/pgsql-ops/#back-up-and-re-store","title":"Back-up and re-store","text":"<p>PostgreSQL is a popular open-source relational database management system used for web applications, business intelligence, and other data-intensive applications. A critical aspect of managing a PostgreSQL database is ensuring data protection by having a backup and restore strategy in place.</p>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/pgsql-ops/#back-up","title":"Back-up","text":"<p>To <code>dump</code> the PostgreSQL database, you can use the <code>pg_dump</code> command-line utility. To back-up your database</p> <pre><code>pg_dump -h localhost -U \"&lt;user&gt;\" \"&lt;dbName&gt;\" -Fc &gt; /tmp/back-up.sql\n</code></pre>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/pgsql-ops/#re-store","title":"Re-store","text":"<p>To restore the backup file you need to use <code>pg_restore</code>.</p> <pre><code>pg_restore -h localhost -U \"&lt;user&gt;\" -d &lt;db_name&gt; &lt;back-up.sql&gt;\n</code></pre>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/pgsql-ops/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","reference","database"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/","title":"PostgreSQL Indexes","text":"","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#janspairwiseidentifier","title":"jansPairwiseIdentifier","text":"tablename indexname indexdef jansPairwiseIdentifier jansPairwiseIdentifier_pkey CREATE UNIQUE INDEX \"jansPairwiseIdentifier_pkey\" ON public.\"jansPairwiseIdentifier\" USING btree (doc_id)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansperson","title":"jansPerson","text":"tablename indexname indexdef jansPerson jansPerson_pkey CREATE UNIQUE INDEX \"jansPerson_pkey\" ON public.\"jansPerson\" USING btree (doc_id) jansPerson jansPerson_givenName_idx CREATE INDEX \"jansPerson_givenName_idx\" ON public.\"jansPerson\" USING btree (\"givenName\") jansPerson jansPerson_mail_idx CREATE INDEX \"jansPerson_mail_idx\" ON public.\"jansPerson\" USING btree (mail) jansPerson jansPerson_sn_idx CREATE INDEX \"jansPerson_sn_idx\" ON public.\"jansPerson\" USING btree (sn) jansPerson jansPerson_lower_idx CREATE INDEX \"jansPerson_lower_idx\" ON public.\"jansPerson\" USING btree (lower((uid)::text)) jansPerson jansPerson_displayName_idx CREATE INDEX \"jansPerson_displayName_idx\" ON public.\"jansPerson\" USING btree (\"displayName\") jansPerson jansPerson_inum_idx CREATE INDEX \"jansPerson_inum_idx\" ON public.\"jansPerson\" USING btree (inum) jansPerson jansPerson_jsonb_path_query_array_idx CREATE INDEX \"jansPerson_jsonb_path_query_array_idx\" ON public.\"jansPerson\" USING gin (jsonb_path_query_array(\"jansExtUid\", '$[*]'::jsonpath)) jansPerson jansPerson_uid_idx CREATE INDEX \"jansPerson_uid_idx\" ON public.\"jansPerson\" USING btree (uid) jansPerson jansPerson_lower_idx1 CREATE INDEX \"jansPerson_lower_idx1\" ON public.\"jansPerson\" USING btree (lower((mail)::text))","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansorganization","title":"jansOrganization","text":"tablename indexname indexdef jansOrganization jansOrganization_pkey CREATE UNIQUE INDEX \"jansOrganization_pkey\" ON public.\"jansOrganization\" USING btree (doc_id) jansOrganization jansOrganization_uid_idx CREATE INDEX \"jansOrganization_uid_idx\" ON public.\"jansOrganization\" USING btree (uid)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansssa","title":"jansSsa","text":"tablename indexname indexdef jansSsa jansSsa_pkey CREATE UNIQUE INDEX \"jansSsa_pkey\" ON public.\"jansSsa\" USING btree (doc_id)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansappconf","title":"jansAppConf","text":"tablename indexname indexdef jansAppConf jansAppConf_pkey CREATE UNIQUE INDEX \"jansAppConf_pkey\" ON public.\"jansAppConf\" USING btree (doc_id)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansclnt","title":"jansClnt","text":"tablename indexname indexdef jansClnt jansClnt_pkey CREATE UNIQUE INDEX \"jansClnt_pkey\" ON public.\"jansClnt\" USING btree (doc_id) jansClnt jansClnt_description_idx CREATE INDEX \"jansClnt_description_idx\" ON public.\"jansClnt\" USING btree (description) jansClnt jansClnt_jansClntSecretExpAt_idx CREATE INDEX \"jansClnt_jansClntSecretExpAt_idx\" ON public.\"jansClnt\" USING btree (\"jansClntSecretExpAt\") jansClnt jansClnt_del_exp_idx CREATE INDEX \"jansClnt_del_exp_idx\" ON public.\"jansClnt\" USING btree (del, exp) jansClnt jansClnt_displayName_idx CREATE INDEX \"jansClnt_displayName_idx\" ON public.\"jansClnt\" USING btree (\"displayName\") jansClnt jansClnt_inum_idx CREATE INDEX \"jansClnt_inum_idx\" ON public.\"jansClnt\" USING btree (inum) jansClnt jansClnt_jansRegistrationAccessTkn_idx CREATE INDEX \"jansClnt_jansRegistrationAccessTkn_idx\" ON public.\"jansClnt\" USING btree (\"jansRegistrationAccessTkn\")","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansscope","title":"jansScope","text":"tablename indexname indexdef jansScope jansScope_pkey CREATE UNIQUE INDEX \"jansScope_pkey\" ON public.\"jansScope\" USING btree (doc_id) jansScope jansScope_displayName_idx CREATE INDEX \"jansScope_displayName_idx\" ON public.\"jansScope\" USING btree (\"displayName\") jansScope jansScope_del_exp_idx CREATE INDEX \"jansScope_del_exp_idx\" ON public.\"jansScope\" USING btree (del, exp) jansScope jansScope_description_idx CREATE INDEX \"jansScope_description_idx\" ON public.\"jansScope\" USING btree (description) jansScope jansScope_jansId_idx CREATE INDEX \"jansScope_jansId_idx\" ON public.\"jansScope\" USING btree (\"jansId\")","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansumaresource","title":"jansUmaResource","text":"tablename indexname indexdef jansUmaResource jansUmaResource_pkey CREATE UNIQUE INDEX \"jansUmaResource_pkey\" ON public.\"jansUmaResource\" USING btree (doc_id) jansUmaResource jansUmaResource_jansUmaScope_idx CREATE INDEX \"jansUmaResource_jansUmaScope_idx\" ON public.\"jansUmaResource\" USING btree (\"jansUmaScope\") jansUmaResource jansUmaResource_del_exp_idx CREATE INDEX \"jansUmaResource_del_exp_idx\" ON public.\"jansUmaResource\" USING btree (del, exp) jansUmaResource jansUmaResource_displayName_idx CREATE INDEX \"jansUmaResource_displayName_idx\" ON public.\"jansUmaResource\" USING btree (\"displayName\") jansUmaResource jansUmaResource_jansId_idx CREATE INDEX \"jansUmaResource_jansId_idx\" ON public.\"jansUmaResource\" USING btree (\"jansId\")","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansumaresourcepermission","title":"jansUmaResourcePermission","text":"tablename indexname indexdef jansUmaResourcePermission jansUmaResourcePermission_pkey CREATE UNIQUE INDEX \"jansUmaResourcePermission_pkey\" ON public.\"jansUmaResourcePermission\" USING btree (doc_id) jansUmaResourcePermission jansUmaResourcePermission_jansTicket_idx CREATE INDEX \"jansUmaResourcePermission_jansTicket_idx\" ON public.\"jansUmaResourcePermission\" USING btree (\"jansTicket\")","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansgrant","title":"jansGrant","text":"tablename indexname indexdef jansGrant jansGrant_pkey CREATE UNIQUE INDEX \"jansGrant_pkey\" ON public.\"jansGrant\" USING btree (doc_id)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#janstoken","title":"jansToken","text":"tablename indexname indexdef jansToken jansToken_pkey CREATE UNIQUE INDEX \"jansToken_pkey\" ON public.\"jansToken\" USING btree (doc_id) jansToken jansToken_authzCode_idx CREATE INDEX \"jansToken_authzCode_idx\" ON public.\"jansToken\" USING btree (\"authzCode\") jansToken jansToken_grtId_idx CREATE INDEX \"jansToken_grtId_idx\" ON public.\"jansToken\" USING btree (\"grtId\") jansToken jansToken_ssnId_idx CREATE INDEX \"jansToken_ssnId_idx\" ON public.\"jansToken\" USING btree (\"ssnId\") jansToken jansToken_tknCde_idx CREATE INDEX \"jansToken_tknCde_idx\" ON public.\"jansToken\" USING btree (\"tknCde\") jansToken jansToken_del_exp_idx CREATE INDEX \"jansToken_del_exp_idx\" ON public.\"jansToken\" USING btree (del, exp)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansgrp","title":"jansGrp","text":"tablename indexname indexdef jansGrp jansGrp_pkey CREATE UNIQUE INDEX \"jansGrp_pkey\" ON public.\"jansGrp\" USING btree (doc_id) jansGrp jansGrp_description_idx CREATE INDEX \"jansGrp_description_idx\" ON public.\"jansGrp\" USING btree (description) jansGrp jansGrp_inum_idx CREATE INDEX \"jansGrp_inum_idx\" ON public.\"jansGrp\" USING btree (inum) jansGrp jansGrp_displayName_idx CREATE INDEX \"jansGrp_displayName_idx\" ON public.\"jansGrp\" USING btree (\"displayName\")","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansattr","title":"jansAttr","text":"tablename indexname indexdef jansAttr jansAttr_pkey CREATE UNIQUE INDEX \"jansAttr_pkey\" ON public.\"jansAttr\" USING btree (doc_id) jansAttr jansAttr_description_idx CREATE INDEX \"jansAttr_description_idx\" ON public.\"jansAttr\" USING btree (description) jansAttr jansAttr_jansAttrName_idx CREATE INDEX \"jansAttr_jansAttrName_idx\" ON public.\"jansAttr\" USING btree (\"jansAttrName\") jansAttr jansAttr_inum_idx CREATE INDEX \"jansAttr_inum_idx\" ON public.\"jansAttr\" USING btree (inum) jansAttr jansAttr_displayName_idx CREATE INDEX \"jansAttr_displayName_idx\" ON public.\"jansAttr\" USING btree (\"displayName\") jansAttr jansAttr_jansAttrOrigin_idx CREATE INDEX \"jansAttr_jansAttrOrigin_idx\" ON public.\"jansAttr\" USING btree (\"jansAttrOrigin\")","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#janspassresetreq","title":"jansPassResetReq","text":"tablename indexname indexdef jansPassResetReq jansPassResetReq_pkey CREATE UNIQUE INDEX \"jansPassResetReq_pkey\" ON public.\"jansPassResetReq\" USING btree (doc_id) jansPassResetReq jansPassResetReq_creationDate_idx CREATE INDEX \"jansPassResetReq_creationDate_idx\" ON public.\"jansPassResetReq\" USING btree (\"creationDate\")","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#janssessid","title":"jansSessId","text":"tablename indexname indexdef jansSessId jansSessId_pkey CREATE UNIQUE INDEX \"jansSessId_pkey\" ON public.\"jansSessId\" USING btree (doc_id) jansSessId jansSessId_sid_idx CREATE INDEX \"jansSessId_sid_idx\" ON public.\"jansSessId\" USING btree (sid) jansSessId jansSessId_deviceSecret_idx CREATE INDEX \"jansSessId_deviceSecret_idx\" ON public.\"jansSessId\" USING btree (\"deviceSecret\") jansSessId jansSessId_jansUsrDN_idx CREATE INDEX \"jansSessId_jansUsrDN_idx\" ON public.\"jansSessId\" USING btree (\"jansUsrDN\") jansSessId jansSessId_del_exp_idx CREATE INDEX \"jansSessId_del_exp_idx\" ON public.\"jansSessId\" USING btree (del, exp)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansumarpt","title":"jansUmaRPT","text":"tablename indexname indexdef jansUmaRPT jansUmaRPT_pkey CREATE UNIQUE INDEX \"jansUmaRPT_pkey\" ON public.\"jansUmaRPT\" USING btree (doc_id)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#janspushapp","title":"jansPushApp","text":"tablename indexname indexdef jansPushApp jansPushApp_pkey CREATE UNIQUE INDEX \"jansPushApp_pkey\" ON public.\"jansPushApp\" USING btree (doc_id)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansscr","title":"jansScr","text":"tablename indexname indexdef jansScr jansScr_pkey CREATE UNIQUE INDEX \"jansScr_pkey\" ON public.\"jansScr\" USING btree (doc_id)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#janscustomscr","title":"jansCustomScr","text":"tablename indexname indexdef jansCustomScr jansCustomScr_pkey CREATE UNIQUE INDEX \"jansCustomScr_pkey\" ON public.\"jansCustomScr\" USING btree (doc_id) jansCustomScr jansCustomScr_inum_idx CREATE INDEX \"jansCustomScr_inum_idx\" ON public.\"jansCustomScr\" USING btree (inum) jansCustomScr jansCustomScr_jansScrTyp_idx CREATE INDEX \"jansCustomScr_jansScrTyp_idx\" ON public.\"jansCustomScr\" USING btree (\"jansScrTyp\")","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansdeviceregistration","title":"jansDeviceRegistration","text":"tablename indexname indexdef jansDeviceRegistration jansDeviceRegistration_pkey CREATE UNIQUE INDEX \"jansDeviceRegistration_pkey\" ON public.\"jansDeviceRegistration\" USING btree (doc_id) jansDeviceRegistration jansDeviceRegistration_jansDeviceKeyHandle_idx CREATE INDEX \"jansDeviceRegistration_jansDeviceKeyHandle_idx\" ON public.\"jansDeviceRegistration\" USING btree (\"jansDeviceKeyHandle\") jansDeviceRegistration jansDeviceRegistration_jansApp_idx CREATE INDEX \"jansDeviceRegistration_jansApp_idx\" ON public.\"jansDeviceRegistration\" USING btree (\"jansApp\") jansDeviceRegistration jansDeviceRegistration_personInum_idx CREATE INDEX \"jansDeviceRegistration_personInum_idx\" ON public.\"jansDeviceRegistration\" USING btree (\"personInum\") jansDeviceRegistration jansDeviceRegistration_del_exp_idx CREATE INDEX \"jansDeviceRegistration_del_exp_idx\" ON public.\"jansDeviceRegistration\" USING btree (del, exp) jansDeviceRegistration jansDeviceRegistration_jansDeviceHashCode_idx CREATE INDEX \"jansDeviceRegistration_jansDeviceHashCode_idx\" ON public.\"jansDeviceRegistration\" USING btree (\"jansDeviceHashCode\") jansDeviceRegistration jansDeviceRegistration_jansStatus_idx CREATE INDEX \"jansDeviceRegistration_jansStatus_idx\" ON public.\"jansDeviceRegistration\" USING btree (\"jansStatus\") jansDeviceRegistration jansDeviceRegistration_creationDate_idx CREATE INDEX \"jansDeviceRegistration_creationDate_idx\" ON public.\"jansDeviceRegistration\" USING btree (\"creationDate\")","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansu2freq","title":"jansU2fReq","text":"tablename indexname indexdef jansU2fReq jansU2fReq_pkey CREATE UNIQUE INDEX \"jansU2fReq_pkey\" ON public.\"jansU2fReq\" USING btree (doc_id) jansU2fReq jansU2fReq_del_exp_idx CREATE INDEX \"jansU2fReq_del_exp_idx\" ON public.\"jansU2fReq\" USING btree (del, exp) jansU2fReq jansU2fReq_creationDate_idx CREATE INDEX \"jansU2fReq_creationDate_idx\" ON public.\"jansU2fReq\" USING btree (\"creationDate\")","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansmetric","title":"jansMetric","text":"tablename indexname indexdef jansMetric jansMetric_pkey CREATE UNIQUE INDEX \"jansMetric_pkey\" ON public.\"jansMetric\" USING btree (doc_id) jansMetric jansMetric_jansEndDate_idx CREATE INDEX \"jansMetric_jansEndDate_idx\" ON public.\"jansMetric\" USING btree (\"jansEndDate\") jansMetric jansMetric_jansMetricTyp_idx CREATE INDEX \"jansMetric_jansMetricTyp_idx\" ON public.\"jansMetric\" USING btree (\"jansMetricTyp\") jansMetric jansMetric_jansStartDate_idx CREATE INDEX \"jansMetric_jansStartDate_idx\" ON public.\"jansMetric\" USING btree (\"jansStartDate\") jansMetric jansMetric_jansAppTyp_idx CREATE INDEX \"jansMetric_jansAppTyp_idx\" ON public.\"jansMetric\" USING btree (\"jansAppTyp\") jansMetric jansMetric_del_exp_idx CREATE INDEX \"jansMetric_del_exp_idx\" ON public.\"jansMetric\" USING btree (del, exp)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansumapct","title":"jansUmaPCT","text":"tablename indexname indexdef jansUmaPCT jansUmaPCT_pkey CREATE UNIQUE INDEX \"jansUmaPCT_pkey\" ON public.\"jansUmaPCT\" USING btree (doc_id) jansUmaPCT jansUmaPCT_tknCde_idx CREATE INDEX \"jansUmaPCT_tknCde_idx\" ON public.\"jansUmaPCT\" USING btree (\"tknCde\") jansUmaPCT jansUmaPCT_del_exp_idx CREATE INDEX \"jansUmaPCT_del_exp_idx\" ON public.\"jansUmaPCT\" USING btree (del, exp)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#janscache","title":"jansCache","text":"tablename indexname indexdef jansCache jansCache_pkey CREATE UNIQUE INDEX \"jansCache_pkey\" ON public.\"jansCache\" USING btree (doc_id) jansCache jansCache_del_exp_idx CREATE INDEX \"jansCache_del_exp_idx\" ON public.\"jansCache\" USING btree (del, exp)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansfido2registrationentry","title":"jansFido2RegistrationEntry","text":"tablename indexname indexdef jansFido2RegistrationEntry jansFido2RegistrationEntry_pkey CREATE UNIQUE INDEX \"jansFido2RegistrationEntry_pkey\" ON public.\"jansFido2RegistrationEntry\" USING btree (doc_id) jansFido2RegistrationEntry jansFido2RegistrationEntry_jansApp_idx CREATE INDEX \"jansFido2RegistrationEntry_jansApp_idx\" ON public.\"jansFido2RegistrationEntry\" USING btree (\"jansApp\") jansFido2RegistrationEntry jansFido2RegistrationEntry_jansCodeChallengeHash_idx CREATE INDEX \"jansFido2RegistrationEntry_jansCodeChallengeHash_idx\" ON public.\"jansFido2RegistrationEntry\" USING btree (\"jansCodeChallengeHash\") jansFido2RegistrationEntry jansFido2RegistrationEntry_jansPublicKeyIdHash_idx CREATE INDEX \"jansFido2RegistrationEntry_jansPublicKeyIdHash_idx\" ON public.\"jansFido2RegistrationEntry\" USING btree (\"jansPublicKeyIdHash\") jansFido2RegistrationEntry jansFido2RegistrationEntry_jansStatus_idx CREATE INDEX \"jansFido2RegistrationEntry_jansStatus_idx\" ON public.\"jansFido2RegistrationEntry\" USING btree (\"jansStatus\") jansFido2RegistrationEntry jansFido2RegistrationEntry_creationDate_idx CREATE INDEX \"jansFido2RegistrationEntry_creationDate_idx\" ON public.\"jansFido2RegistrationEntry\" USING btree (\"creationDate\") jansFido2RegistrationEntry jansFido2RegistrationEntry_jansCodeChallenge_idx CREATE INDEX \"jansFido2RegistrationEntry_jansCodeChallenge_idx\" ON public.\"jansFido2RegistrationEntry\" USING btree (\"jansCodeChallenge\") jansFido2RegistrationEntry jansFido2RegistrationEntry_jansPublicKeyId_idx CREATE INDEX \"jansFido2RegistrationEntry_jansPublicKeyId_idx\" ON public.\"jansFido2RegistrationEntry\" USING btree (\"jansPublicKeyId\") jansFido2RegistrationEntry jansFido2RegistrationEntry_personInum_idx CREATE INDEX \"jansFido2RegistrationEntry_personInum_idx\" ON public.\"jansFido2RegistrationEntry\" USING btree (\"personInum\") jansFido2RegistrationEntry jansFido2RegistrationEntry_del_exp_idx CREATE INDEX \"jansFido2RegistrationEntry_del_exp_idx\" ON public.\"jansFido2RegistrationEntry\" USING btree (del, exp)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#janspushdevice","title":"jansPushDevice","text":"tablename indexname indexdef jansPushDevice jansPushDevice_pkey CREATE UNIQUE INDEX \"jansPushDevice_pkey\" ON public.\"jansPushDevice\" USING btree (doc_id)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansclntauthz","title":"jansClntAuthz","text":"tablename indexname indexdef jansClntAuthz jansClntAuthz_pkey CREATE UNIQUE INDEX \"jansClntAuthz_pkey\" ON public.\"jansClntAuthz\" USING btree (doc_id) jansClntAuthz jansClntAuthz_jsonb_path_query_array_idx CREATE INDEX \"jansClntAuthz_jsonb_path_query_array_idx\" ON public.\"jansClntAuthz\" USING gin (jsonb_path_query_array(\"jansClntId\", '$[*]'::jsonpath)) jansClntAuthz jansClntAuthz_del_exp_idx CREATE INDEX \"jansClntAuthz_del_exp_idx\" ON public.\"jansClntAuthz\" USING btree (del, exp) jansClntAuthz jansClntAuthz_jansUsrId_idx CREATE INDEX \"jansClntAuthz_jansUsrId_idx\" ON public.\"jansClntAuthz\" USING btree (\"jansUsrId\")","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#janssectoridentifier","title":"jansSectorIdentifier","text":"tablename indexname indexdef jansSectorIdentifier jansSectorIdentifier_pkey CREATE UNIQUE INDEX \"jansSectorIdentifier_pkey\" ON public.\"jansSectorIdentifier\" USING btree (doc_id)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansfido2authnentry","title":"jansFido2AuthnEntry","text":"tablename indexname indexdef jansFido2AuthnEntry jansFido2AuthnEntry_pkey CREATE UNIQUE INDEX \"jansFido2AuthnEntry_pkey\" ON public.\"jansFido2AuthnEntry\" USING btree (doc_id) jansFido2AuthnEntry jansFido2AuthnEntry_jansApp_idx CREATE INDEX \"jansFido2AuthnEntry_jansApp_idx\" ON public.\"jansFido2AuthnEntry\" USING btree (\"jansApp\") jansFido2AuthnEntry jansFido2AuthnEntry_jansCodeChallengeHash_idx CREATE INDEX \"jansFido2AuthnEntry_jansCodeChallengeHash_idx\" ON public.\"jansFido2AuthnEntry\" USING btree (\"jansCodeChallengeHash\") jansFido2AuthnEntry jansFido2AuthnEntry_jansStatus_idx CREATE INDEX \"jansFido2AuthnEntry_jansStatus_idx\" ON public.\"jansFido2AuthnEntry\" USING btree (\"jansStatus\") jansFido2AuthnEntry jansFido2AuthnEntry_creationDate_idx CREATE INDEX \"jansFido2AuthnEntry_creationDate_idx\" ON public.\"jansFido2AuthnEntry\" USING btree (\"creationDate\") jansFido2AuthnEntry jansFido2AuthnEntry_jansCodeChallenge_idx CREATE INDEX \"jansFido2AuthnEntry_jansCodeChallenge_idx\" ON public.\"jansFido2AuthnEntry\" USING btree (\"jansCodeChallenge\") jansFido2AuthnEntry jansFido2AuthnEntry_personInum_idx CREATE INDEX \"jansFido2AuthnEntry_personInum_idx\" ON public.\"jansFido2AuthnEntry\" USING btree (\"personInum\") jansFido2AuthnEntry jansFido2AuthnEntry_del_exp_idx CREATE INDEX \"jansFido2AuthnEntry_del_exp_idx\" ON public.\"jansFido2AuthnEntry\" USING btree (del, exp)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansrp","title":"jansRp","text":"tablename indexname indexdef jansRp jansRp_pkey CREATE UNIQUE INDEX \"jansRp_pkey\" ON public.\"jansRp\" USING btree (doc_id)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#janscibareq","title":"jansCibaReq","text":"tablename indexname indexdef jansCibaReq jansCibaReq_pkey CREATE UNIQUE INDEX \"jansCibaReq_pkey\" ON public.\"jansCibaReq\" USING btree (doc_id) jansCibaReq jansCibaReq_jansStatus_exp_idx CREATE INDEX \"jansCibaReq_jansStatus_exp_idx\" ON public.\"jansCibaReq\" USING btree (\"jansStatus\", exp)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansstatentry","title":"jansStatEntry","text":"tablename indexname indexdef jansStatEntry jansStatEntry_pkey CREATE UNIQUE INDEX \"jansStatEntry_pkey\" ON public.\"jansStatEntry\" USING btree (doc_id) jansStatEntry jansStatEntry_jansId_idx CREATE INDEX \"jansStatEntry_jansId_idx\" ON public.\"jansStatEntry\" USING btree (\"jansId\")","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#janspar","title":"jansPar","text":"tablename indexname indexdef jansPar jansPar_pkey CREATE UNIQUE INDEX \"jansPar_pkey\" ON public.\"jansPar\" USING btree (doc_id) jansPar jansPar_jansId_idx CREATE INDEX \"jansPar_jansId_idx\" ON public.\"jansPar\" USING btree (\"jansId\") jansPar jansPar_del_exp_idx CREATE INDEX \"jansPar_del_exp_idx\" ON public.\"jansPar\" USING btree (del, exp)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansinummap","title":"jansInumMap","text":"tablename indexname indexdef jansInumMap jansInumMap_pkey CREATE UNIQUE INDEX \"jansInumMap_pkey\" ON public.\"jansInumMap\" USING btree (doc_id) jansInumMap jansInumMap_jansStatus_idx CREATE INDEX \"jansInumMap_jansStatus_idx\" ON public.\"jansInumMap\" USING btree (\"jansStatus\") jansInumMap jansInumMap_inum_idx CREATE INDEX \"jansInumMap_inum_idx\" ON public.\"jansInumMap\" USING btree (inum)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#agmflowrun","title":"agmFlowRun","text":"tablename indexname indexdef agmFlowRun agmFlowRun_pkey CREATE UNIQUE INDEX \"agmFlowRun_pkey\" ON public.\"agmFlowRun\" USING btree (doc_id)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#agmflow","title":"agmFlow","text":"tablename indexname indexdef agmFlow agmFlow_pkey CREATE UNIQUE INDEX \"agmFlow_pkey\" ON public.\"agmFlow\" USING btree (doc_id)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#adsprjdeployment","title":"adsPrjDeployment","text":"tablename indexname indexdef adsPrjDeployment adsPrjDeployment_pkey CREATE UNIQUE INDEX \"adsPrjDeployment_pkey\" ON public.\"adsPrjDeployment\" USING btree (doc_id)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema-indexes/#jansdocument","title":"jansDocument","text":"tablename indexname indexdef jansDocument jansDocument_pkey CREATE UNIQUE INDEX \"jansDocument_pkey\" ON public.\"jansDocument\" USING btree (doc_id)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/","title":"PostgreSQL Schema","text":"","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#tables","title":"Tables","text":"Table names jansPairwiseIdentifier jansPerson jansOrganization jansSsa jansAppConf jansClnt jansScope jansUmaResource jansUmaResourcePermission jansGrant jansToken jansGrp jansAttr jansPassResetReq jansSessId jansUmaRPT jansPushApp jansScr jansCustomScr jansDeviceRegistration jansU2fReq jansMetric jansUmaPCT jansCache jansFido2RegistrationEntry jansPushDevice jansClntAuthz jansSectorIdentifier jansFido2AuthnEntry jansRp jansCibaReq jansStatEntry jansPar jansInumMap agmFlowRun agmFlow adsPrjDeployment jansDocument","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#janspairwiseidentifier","title":"jansPairwiseIdentifier","text":"Field Type Character Maximum Length Null Default Comment jansId character varying 128 YES None Identifier jansSectorIdentifier character varying 64 YES None jans Sector Identifier jansClntId jsonb None YES None jans Clnt id jansUsrId character varying 64 YES None jans user id","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansperson","title":"jansPerson","text":"Field Type Character Maximum Length Null Default Comment jansAssociatedClnt jsonb None YES None Associate the dn of an OAuth2 client with a person or UMA Resource Set. displayName character varying 128 YES None preferred name of a person to be used when displaying entries jansManagedOrganizations character varying 64 YES None Used to track with which organizations a person is associated jansOptOuts jsonb None YES None White pages attributes restricted by person in exclude profile management jansStatus character varying 16 YES None Status of the entry, used by many objectclasses inum character varying 64 YES None XRI i-number jansPersistentJWT jsonb None YES None jans Persistent JWT jansCreationTimestamp timestamp without time zone None YES None Registration time jansOTPCache jsonb None YES None Stores a used OTP to prevent a hacker from using it again. Complementary to jansExtUid attribute jansLastLogonTime timestamp without time zone None YES None Last logon time jansPassExpDate timestamp without time zone None YES None Pass Exp date, represented as an ISO 8601 (YYYY-MM-DD) format persistentId character varying 64 YES None PersistentId middleName character varying 64 YES None Middle name(s) nickname character varying 64 YES None Casual name of the End-Usr jansPrefUsrName character varying 64 YES None Shorthand Name profile character varying 64 YES None Profile page URL of the person picture text None YES None Profile picture URL of the person website character varying 64 YES None Web page or blog URL of the person emailVerified boolean None YES None True if the e-mail address of the person has been verified; otherwise false gender character varying 32 YES None Gender of the person either female or male birthdate timestamp without time zone None YES None Birthday of the person, represented as an ISO 8601:2004 [ISO8601-2004] YYYY-MM-DD format zoneinfo character varying 64 YES None Time zone database representing the End-Usrs time zone. For example, Europe/Paris or America/Los_Angeles locale character varying 64 YES None Locale of the person, represented as a BCP47 [RFC5646] language tag phoneNumberVerified boolean None YES None True if the phone number of the person has been verified, otherwise false address text None YES None OpenID Connect formatted JSON object representing the address of the person updatedAt timestamp without time zone None YES None Time the information of the person was last updated. Seconds from 1970-01-01T0:0:0Z preferredLanguage character varying 64 YES None preferred written or spoken language for a person role jsonb None YES None Role secretAnswer text None YES None Secret Answer secretQuestion text None YES None Secret Question transientId character varying 64 YES None TransientId jansCountInvalidLogin character varying 64 YES None Invalid login attempts count jansEnrollmentCode character varying 64 YES None jansEnrollmentCode jansIMAPData character varying 64 YES None This data has information about your imap connection jansPPID jsonb None YES None Persistent Pairwise ID for OpenID Connect jansGuid character varying 64 YES None A random string to mark temporary tokens jansPreferredMethod character varying 64 YES None Casa - Preferred method to use for user authentication jansOTPDevices character varying 512 YES None Casa - Json representation of OTP devices. Complementary to jansExtUid attribute jansMobileDevices character varying 512 YES None Casa - Json representation of mobile devices. Complementary to mobile attribute jansTrustedDevices text None YES None Casa - Devices with which strong authentication may be skipped jansStrongAuthPolicy character varying 64 YES None Casa - 2FA Enforcement Policy for User jansUnlinkedExternalUids character varying 64 YES None Casa - List of unlinked social accounts (ie disabled jansExtUids) jansBackchannelDeviceRegistrationTkn character varying 64 YES None jans Backchannel Device Registration Tkn jansBackchannelUsrCode character varying 64 YES None jans Backchannel Usr Code carLicense character varying 64 YES None vehicle license or registration plate departmentNumber character varying 64 YES None identifies a department within an organization employeeType character varying 64 YES None type of employment for a person employeeNumber character varying 64 YES None numerically identifies an employee within an organization jansAdminUIRole jsonb None YES None jansAdminUIRole","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansorganization","title":"jansOrganization","text":"Field Type Character Maximum Length Null Default Comment displayName character varying 128 YES None preferred name of a person to be used when displaying entries jansCustomMessage character varying 128 YES None exclude custom welcome message jansFaviconImage character varying 64 YES None TODO - Stores URL of favicon jansLogoImage character varying 64 YES None Logo used by exclude for default look and feel. jansManager character varying 64 YES None Used to specify if a person has the manager role jansManagerGrp text None YES None Used in organizatoin entry to specifies the dn of the group that  has admin priviledges in exclude. jansOrgShortName character varying 64 YES None Short description, as few letters as possible, no spaces. jansThemeColor character varying 64 YES None exclude login page configuration inum character varying 64 YES None XRI i-number jansCreationTimestamp timestamp without time zone None YES None Registration time jansRegistrationConf character varying 64 YES None Registration Conf jansLogoPath character varying 64 YES None jansLogoPath jansStatus character varying 16 YES None Status of the entry, used by many objectclasses jansFaviconPath character varying 64 YES None jansFaviconPath","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansssa","title":"jansSsa","text":"Field Type Character Maximum Length Null Default Comment inum character varying 64 YES None XRI i-number jansAttrs text None YES None Attrs exp timestamp without time zone None YES None jans Exp del boolean None YES None del jansState character varying 64 YES None jansState creatorId character varying 64 YES None Creator Id creatorTyp character varying 64 YES None Creator type creationDate timestamp without time zone None YES None Creation Date used for password reset requests","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansappconf","title":"jansAppConf","text":"Field Type Character Maximum Length Null Default Comment displayName character varying 128 YES None preferred name of a person to be used when displaying entries jansHostname character varying 64 YES None The hostname of the Jans Server instance jansLastUpd timestamp without time zone None YES None Monitors last time the server was able to connect to  the monitoring system. jansManager character varying 64 YES None Used to specify if a person has the manager role jansOrgProfileMgt boolean None YES None enable or disable profile management feature in exclude jansScimEnabled boolean None YES None exclude SCIM feature - enabled or disabled jansSmtpConf jsonb None YES None SMTP configuration jansSslExpiry character varying 64 YES None SAML Trust Relationship configuration jansStatus character varying 16 YES None Status of the entry, used by many objectclasses jansUrl character varying 64 YES None Jans instance URL inum character varying 64 YES None XRI i-number jansDbAuth jsonb None YES None Custom IDP authentication configuration jansLogViewerConfig character varying 64 YES None Log viewer configuration jansLogConfigLocation character varying 64 YES None Path to external log4j2.xml jansCacheConf text None YES None Cache configuration jansDocStoreConf text None YES None jansDocStoreConf jansConfDyn text None YES None jans Dyn Conf jansConfErrors text None YES None jans Errors Conf jansConfStatic text None YES None jans Static Conf jansConfWebKeys text None YES None jans Web Keys Conf jansWebKeysSettings character varying 64 YES None jans Web Keys Conf jansConfApp text None YES None jans App Conf jansRevision integer None YES None Revision","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansclnt","title":"jansClnt","text":"Field Type Character Maximum Length Null Default Comment jansGrp character varying 64 YES None Group displayName character varying 128 YES None preferred name of a person to be used when displaying entries displayNameLocalized jsonb None YES None jans Display Name Localized inum character varying 64 YES None XRI i-number jansAppTyp character varying 64 YES None jans App Typ jansClntIdIssuedAt timestamp without time zone None YES None jans Clnt Issued At jansClntSecret character varying 64 YES None jans Clnt Secret jansClntSecretExpAt timestamp without time zone None YES None Date client expires exp timestamp without time zone None YES None jans Exp del boolean None YES None del jansClntURI text None YES None jans Clnt URI jansClntURILocalized jsonb None YES None jans Clnt URI localized jansContact jsonb None YES None jans Contact jansDefAcrValues jsonb None YES None jans Def Acr Values jansDefMaxAge integer None YES None jans Def Max Age jansGrantTyp jsonb None YES None jans Grant Typ jansIdTknEncRespAlg character varying 64 YES None jans ID Tkn Enc Resp Alg jansIdTknEncRespEnc character varying 64 YES None jans ID Tkn Enc Resp Enc jansIdTknSignedRespAlg character varying 64 YES None jans ID Tkn Signed Resp Alg jansInitiateLoginURI text None YES None jans Initiate Login URI jansJwksURI text None YES None jans JWKs URI jansJwks text None YES None jans JWKs jansLogoURI text None YES None jans Logo URI jansLogoURILocalized jsonb None YES None jans Logo URI localized jansPolicyURI text None YES None jans Policy URI jansPolicyURILocalized jsonb None YES None jans Policy URI localized jansPostLogoutRedirectURI jsonb None YES None jans Post Logout Redirect URI jansRedirectURI jsonb None YES None jans Redirect URI jansRegistrationAccessTkn character varying 64 YES None jans Registration Access Tkn jansReqObjSigAlg character varying 64 YES None jans Req Obj Sig Alg jansReqObjEncAlg character varying 64 YES None jans Req Obj Enc Alg jansReqObjEncEnc character varying 64 YES None jans Req Obj Enc Enc jansReqURI jsonb None YES None jans Req URI jansRespTyp jsonb None YES None jans Resp Typ jansScope jsonb None YES None jans Attr Scope jansClaim jsonb None YES None jans Attr Claim jansSectorIdentifierURI text None YES None jans Sector Identifier URI jansSignedRespAlg character varying 64 YES None jans Signed Resp Alg jansSubjectTyp character varying 64 YES None jans Subject Typ jansTknEndpointAuthMethod character varying 64 YES None jans Tkn Endpoint Auth Method jansTknEndpointAuthSigAlg character varying 64 YES None jans Tkn Endpoint Auth Sig Alg jansTosURI text None YES None jans TOS URI jansTosURILocalized jsonb None YES None jans Tos URI localized jansTrustedClnt boolean None YES None jans Trusted Clnt jansUsrInfEncRespAlg character varying 64 YES None jans Usr Inf Enc Resp Alg jansUsrInfEncRespEnc character varying 64 YES None jans Usr Inf Enc Resp Enc jansExtraConf character varying 64 YES None jans additional configuration jansClaimRedirectURI jsonb None YES None Claim Redirect URI jansLastAccessTime timestamp without time zone None YES None Last access time jansLastLogonTime timestamp without time zone None YES None Last logon time jansPersistClntAuthzs boolean None YES None jans Persist Clnt Authzs jansInclClaimsInIdTkn boolean None YES None jans Incl Claims In Id Tkn jansRefreshTknLife integer None YES None Life of refresh token jansDisabled boolean None YES None Status of client jansLogoutURI jsonb None YES None jans Policy URI jansLogoutSessRequired boolean None YES None jans Policy URI jansdId character varying 64 YES None jansd Id jansAuthorizedOrigins jsonb None YES None jans Authorized Origins tknBndCnf text None YES None jansauth - Tkn Binding Id Hash jansAccessTknAsJwt boolean None YES None jansauth - indicator whether to return access token as JWT jansAccessTknSigAlg character varying 64 YES None jansauth - access token signing algorithm jansAccessTknLife integer None YES None Life of access token jansSoftId character varying 64 YES None Soft Identifier jansSoftStatement text None YES None Soft Statement jansRptAsJwt boolean None YES None jansRptAsJwt jansAttrs text None YES None Attrs jansBackchannelTknDeliveryMode character varying 64 YES None jans Backchannel Tkn Delivery Mode jansBackchannelClntNotificationEndpoint character varying 64 YES None jans Backchannel Clnt Notification Endpoint jansBackchannelAuthnReqSigAlg character varying 64 YES None jans Backchannel Authn Req Sig Alg jansBackchannelUsrCodeParameter boolean None YES None jans Backchannel Usr Code Parameter","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansscope","title":"jansScope","text":"Field Type Character Maximum Length Null Default Comment jansDefScope boolean None YES None Track the default scope for an custom OAuth2 Scope. displayName character varying 128 YES None preferred name of a person to be used when displaying entries inum character varying 64 YES None XRI i-number jansScopeTyp character varying 64 YES None OX Attr Scope type creatorId character varying 64 YES None Creator Id creatorTyp character varying 64 YES None Creator type creatorAttrs character varying 64 YES None Creator Attrs creationDate timestamp without time zone None YES None Creation Date used for password reset requests jansClaim jsonb None YES None jans Attr Claim jansScrDn jsonb None YES None Script object DN jansGrpClaims boolean None YES None jans Grp Attr Claims (true or false) jansId character varying 128 YES None Identifier jansIconUrl character varying 64 YES None jans icon url jansUmaPolicyScrDn text None YES None OX policy script Dn jansAttrs text None YES None Attrs exp timestamp without time zone None YES None jans Exp del boolean None YES None del","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansumaresource","title":"jansUmaResource","text":"Field Type Character Maximum Length Null Default Comment displayName character varying 128 YES None preferred name of a person to be used when displaying entries inum character varying 64 YES None XRI i-number jansAssociatedClnt jsonb None YES None Associate the dn of an OAuth2 client with a person or UMA Resource Set. jansUmaScope character varying 768 YES None URI reference of scope descriptor jansFaviconImage character varying 64 YES None TODO - Stores URL of favicon jansGrp character varying 64 YES None Group jansId character varying 128 YES None Identifier jansResource text None YES None Host path jansRevision integer None YES None Revision jansTyp character varying 64 YES None jans type jansScopeExpression text None YES None Scope expression iat timestamp without time zone None YES None jans Creation exp timestamp without time zone None YES None jans Exp del boolean None YES None del","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansumaresourcepermission","title":"jansUmaResourcePermission","text":"Field Type Character Maximum Length Null Default Comment exp timestamp without time zone None YES None jans Exp del boolean None YES None del jansUmaScope character varying 768 YES None URI reference of scope descriptor jansConfCode character varying 64 YES None jans configuration code jansResourceSetId character varying 64 YES None jans resource set id jansAttrs text None YES None Attrs jansTicket character varying 64 YES None jans ticket jansStatus character varying 16 YES None Status of the entry, used by many objectclasses","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansgrant","title":"jansGrant","text":"Field Type Character Maximum Length Null Default Comment grtId character varying 64 YES None jans grant id iat timestamp without time zone None YES None jans Creation","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#janstoken","title":"jansToken","text":"Field Type Character Maximum Length Null Default Comment authnTime timestamp without time zone None YES None jans Authn Time authzCode character varying 64 YES None jans authorization code iat timestamp without time zone None YES None jans Creation exp timestamp without time zone None YES None jans Exp del boolean None YES None del grtId character varying 64 YES None jans grant id grtTyp character varying 64 YES None jans Grant Typ jwtReq text None YES None jans JWT Req nnc text None YES None jans nonce scp text None YES None jans Attr Scope tknCde character varying 80 YES None jans Tkn Code tknTyp character varying 32 YES None jans Tkn Typ usrId character varying 64 YES None jans user id jansUsrDN character varying 128 YES None jans Usr DN clnId character varying 64 YES None jans Clnt id uuid character varying 64 YES None Unique identifier chlng character varying 64 YES None OX PKCE code challenge chlngMth character varying 64 YES None OX PKCE code challenge method clms character varying 64 YES None jans Claims ssnId character varying 64 YES None jans Sess DN attr text None YES None Attrs tknBndCnf text None YES None jansauth - Tkn Binding Id Hash dpop character varying 64 YES None DPoP Proof","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansgrp","title":"jansGrp","text":"Field Type Character Maximum Length Null Default Comment displayName character varying 128 YES None preferred name of a person to be used when displaying entries jansStatus character varying 16 YES None Status of the entry, used by many objectclasses inum character varying 64 YES None XRI i-number","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansattr","title":"jansAttr","text":"Field Type Character Maximum Length Null Default Comment displayName character varying 128 YES None preferred name of a person to be used when displaying entries jansAttrEditTyp jsonb None YES None Specify in exclude who can update an attribute, admin or user jansAttrName character varying 64 YES None Specify an identifier for an attribute. May be multi-value  where an attribute has two names, like givenName and first-name. jansAttrOrigin character varying 64 YES None Specify the person objectclass associated with the attribute,  used for display purposes in exclude. jansAttrSystemEditTyp character varying 64 YES None TODO - still required? jansAttrTyp character varying 64 YES None Data type of attribute. Values can be string, photo, numeric, date jansClaimName character varying 64 YES None Used by jans in conjunction with jansttributeName to map claims to attributes in LDAP. jansAttrUsgTyp character varying 64 YES None TODO - Usg? Value can be OpenID jansAttrViewTyp jsonb None YES None Specify in exclude who can view an attribute, admin or user jansSAML1URI character varying 64 YES None SAML 1 uri of attribute jansSAML2URI character varying 64 YES None SAML 2 uri of attribute jansStatus character varying 16 YES None Status of the entry, used by many objectclasses inum character varying 64 YES None XRI i-number jansNameIdTyp character varying 64 YES None NameId Typ jansSourceAttr character varying 64 YES None Source Attr for this Attr jansRegExp character varying 64 YES None Regular expression used to validate attribute data jansTooltip character varying 64 YES None Custom tooltip to be shown on the UI jansValidation text None YES None This data has information about attribute Validation","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#janspassresetreq","title":"jansPassResetReq","text":"Field Type Character Maximum Length Null Default Comment creationDate timestamp without time zone None YES None Creation Date used for password reset requests jansGuid character varying 64 YES None A random string to mark temporary tokens personInum character varying 64 YES None Inum of a person","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#janssessid","title":"jansSessId","text":"Field Type Character Maximum Length Null Default Comment jansId character varying 128 YES None Identifier sid character varying 64 YES None Sess Identifier creationDate timestamp without time zone None YES None Creation Date used for password reset requests exp timestamp without time zone None YES None jans Exp del boolean None YES None del jansLastAccessTime timestamp without time zone None YES None Last access time jansUsrDN character varying 128 YES None jans Usr DN authnTime timestamp without time zone None YES None jans Authn Time jansState character varying 64 YES None jansState jansSessState text None YES None jans Sess State jansPermissionGranted boolean None YES None jans Permission Granted jansAsJwt boolean None YES None Boolean field to indicate whether object is used as JWT jansJwt text None YES None JWT representation of the object or otherwise jwt associated with the object jansPermissionGrantedMap text None YES None jans Permission Granted Map jansInvolvedClnts text None YES None Involved clients deviceSecret character varying 64 YES None deviceSecret jansSessAttr text None YES None jansSessAttr - generic attributes in form of key-value jansAttrs text None YES None jansAttrs - predefined attributes (e.g. index in status list)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansumarpt","title":"jansUmaRPT","text":"Field Type Character Maximum Length Null Default Comment authnTime timestamp without time zone None YES None jans Authn Time clnId character varying 64 YES None jans Clnt id iat timestamp without time zone None YES None jans Creation exp timestamp without time zone None YES None jans Exp del boolean None YES None del tknCde character varying 80 YES None jans Tkn Code usrId character varying 64 YES None jans user id ssnId character varying 64 YES None jans Sess DN jansUmaPermission jsonb None YES None jans uma permission uuid character varying 64 YES None Unique identifier dpop character varying 64 YES None DPoP Proof authzCode character varying 64 YES None jans authorization code grtId character varying 64 YES None jans grant id grtTyp character varying 64 YES None jans Grant Typ jwtReq text None YES None jans JWT Req nnc text None YES None jans nonce scp text None YES None jans Attr Scope tknTyp character varying 32 YES None jans Tkn Typ jansUsrDN character varying 128 YES None jans Usr DN chlng character varying 64 YES None OX PKCE code challenge chlngMth character varying 64 YES None OX PKCE code challenge method clms character varying 64 YES None jans Claims attr text None YES None Attrs tknBndCnf text None YES None jansauth - Tkn Binding Id Hash","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#janspushapp","title":"jansPushApp","text":"Field Type Character Maximum Length Null Default Comment displayName character varying 128 YES None preferred name of a person to be used when displaying entries jansId character varying 128 YES None Identifier jansName character varying 64 YES None Name jansPushAppConf character varying 64 YES None jansPush application configuration","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansscr","title":"jansScr","text":"Field Type Character Maximum Length Null Default Comment inum character varying 64 YES None XRI i-number jansScr text None YES None Attr that contains script (python, java script) jansScrTyp character varying 64 YES None Attr that contains script type (e.g. python, java script)","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#janscustomscr","title":"jansCustomScr","text":"Field Type Character Maximum Length Null Default Comment inum character varying 64 YES None XRI i-number displayName character varying 128 YES None preferred name of a person to be used when displaying entries jansScr text None YES None Attr that contains script (python, java script) jansScrTyp character varying 64 YES None Attr that contains script type (e.g. python, java script) jansProgLng character varying 64 YES None programming language jansModuleProperty jsonb None YES None Module property jansConfProperty jsonb None YES None Conf property jansLevel integer None YES None Level jansRevision integer None YES None Revision jansEnabled boolean None YES None Status of the entry, used by many objectclasses jansScrError text None YES None Attr that contains first error which application get during it execution jansAlias jsonb None YES None jansAlias","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansdeviceregistration","title":"jansDeviceRegistration","text":"Field Type Character Maximum Length Null Default Comment jansId character varying 128 YES None Identifier displayName character varying 128 YES None preferred name of a person to be used when displaying entries jansDeviceKeyHandle character varying 128 YES None jansDeviceKeyHandle jansDeviceHashCode integer None YES None jansDeviceHashCode jansApp character varying 96 YES None jansApp jansDeviceRegistrationConf text None YES None jansDeviceRegistrationConf jansDeviceNotificationConf character varying 64 YES None Extended push notification configuration jansNickName character varying 64 YES None jansNickName jansDeviceData text None YES None jansDeviceData jansCounter integer None YES None jansCounter jansStatus character varying 16 YES None Status of the entry, used by many objectclasses del boolean None YES None del exp timestamp without time zone None YES None jans Exp personInum character varying 64 YES None Inum of a person creationDate timestamp without time zone None YES None Creation Date used for password reset requests jansLastAccessTime timestamp without time zone None YES None Last access time","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansu2freq","title":"jansU2fReq","text":"Field Type Character Maximum Length Null Default Comment jansId character varying 128 YES None Identifier jansReqId character varying 64 YES None jansReqId jansReq text None YES None jansReq jansSessStateId character varying 64 YES None jansSessStateId del boolean None YES None del exp timestamp without time zone None YES None jans Exp personInum character varying 64 YES None Inum of a person creationDate timestamp without time zone None YES None Creation Date used for password reset requests","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansmetric","title":"jansMetric","text":"Field Type Character Maximum Length Null Default Comment jansStartDate timestamp without time zone None YES None Start date jansEndDate timestamp without time zone None YES None End date jansAppTyp character varying 64 YES None jans App Typ jansMetricTyp character varying 64 YES None Metric type creationDate timestamp without time zone None YES None Creation Date used for password reset requests del boolean None YES None del exp timestamp without time zone None YES None jans Exp jansData text None YES None OX data jansHost character varying 64 YES None jans host","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansumapct","title":"jansUmaPCT","text":"Field Type Character Maximum Length Null Default Comment clnId character varying 64 YES None jans Clnt id iat timestamp without time zone None YES None jans Creation exp timestamp without time zone None YES None jans Exp del boolean None YES None del tknCde character varying 80 YES None jans Tkn Code ssnId character varying 64 YES None jans Sess DN jansClaimValues character varying 64 YES None Claim Values dpop character varying 64 YES None DPoP Proof authnTime timestamp without time zone None YES None jans Authn Time authzCode character varying 64 YES None jans authorization code grtId character varying 64 YES None jans grant id grtTyp character varying 64 YES None jans Grant Typ jwtReq text None YES None jans JWT Req nnc text None YES None jans nonce scp text None YES None jans Attr Scope tknTyp character varying 32 YES None jans Tkn Typ usrId character varying 64 YES None jans user id jansUsrDN character varying 128 YES None jans Usr DN uuid character varying 64 YES None Unique identifier chlng character varying 64 YES None OX PKCE code challenge chlngMth character varying 64 YES None OX PKCE code challenge method clms character varying 64 YES None jans Claims attr text None YES None Attrs tknBndCnf text None YES None jansauth - Tkn Binding Id Hash","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#janscache","title":"jansCache","text":"Field Type Character Maximum Length Null Default Comment uuid character varying 64 YES None Unique identifier iat timestamp without time zone None YES None jans Creation exp timestamp without time zone None YES None jans Exp del boolean None YES None del dat text None YES None OX data","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansfido2registrationentry","title":"jansFido2RegistrationEntry","text":"Field Type Character Maximum Length Null Default Comment jansId character varying 128 YES None Identifier creationDate timestamp without time zone None YES None Creation Date used for password reset requests displayName character varying 128 YES None preferred name of a person to be used when displaying entries jansApp character varying 96 YES None jansApp jansSessStateId character varying 64 YES None jansSessStateId jansCodeChallenge character varying 64 YES None OX PKCE code challenge jansCodeChallengeHash integer None YES None OX code challenge hash jansPublicKeyId character varying 96 YES None jansPublicKeyId jansPublicKeyIdHash integer None YES None jansPublicKeyIdHash personInum character varying 64 YES None Inum of a person jansRegistrationData text None YES None jansRegistrationData jansDeviceData text None YES None jansDeviceData jansDeviceNotificationConf character varying 64 YES None Extended push notification configuration jansCounter integer None YES None jansCounter jansStatus character varying 16 YES None Status of the entry, used by many objectclasses exp timestamp without time zone None YES None jans Exp del boolean None YES None del","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#janspushdevice","title":"jansPushDevice","text":"Field Type Character Maximum Length Null Default Comment jansUsrId character varying 64 YES None jans user id jansId character varying 128 YES None Identifier jansPushApp text None YES None jansPush application DN jansPushDeviceConf character varying 64 YES None jansPush device configuration jansTyp character varying 64 YES None jans type","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansclntauthz","title":"jansClntAuthz","text":"Field Type Character Maximum Length Null Default Comment jansId character varying 128 YES None Identifier jansClntId jsonb None YES None jans Clnt id jansUsrId character varying 64 YES None jans user id exp timestamp without time zone None YES None jans Exp del boolean None YES None del jansScope jsonb None YES None jans Attr Scope","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#janssectoridentifier","title":"jansSectorIdentifier","text":"Field Type Character Maximum Length Null Default Comment jansId character varying 128 YES None Identifier jansRedirectURI jsonb None YES None jans Redirect URI jansClntId jsonb None YES None jans Clnt id","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansfido2authnentry","title":"jansFido2AuthnEntry","text":"Field Type Character Maximum Length Null Default Comment jansId character varying 128 YES None Identifier creationDate timestamp without time zone None YES None Creation Date used for password reset requests jansApp character varying 96 YES None jansApp jansSessStateId character varying 64 YES None jansSessStateId jansCodeChallenge character varying 64 YES None OX PKCE code challenge jansCodeChallengeHash integer None YES None OX code challenge hash personInum character varying 64 YES None Inum of a person jansAuthData text None YES None jansAuthData jansStatus character varying 16 YES None Status of the entry, used by many objectclasses exp timestamp without time zone None YES None jans Exp del boolean None YES None del","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansrp","title":"jansRp","text":"Field Type Character Maximum Length Null Default Comment jansId character varying 128 YES None Identifier dat text None YES None OX data","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#janscibareq","title":"jansCibaReq","text":"Field Type Character Maximum Length Null Default Comment authReqId character varying 64 YES None Authn request id clnId character varying 64 YES None jans Clnt id usrId character varying 64 YES None jans user id creationDate timestamp without time zone None YES None Creation Date used for password reset requests exp timestamp without time zone None YES None jans Exp jansStatus character varying 16 YES None Status of the entry, used by many objectclasses","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansstatentry","title":"jansStatEntry","text":"Field Type Character Maximum Length Null Default Comment jansId character varying 128 YES None Identifier dat text None YES None OX data jansData text None YES None OX data attr text None YES None Attrs","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#janspar","title":"jansPar","text":"Field Type Character Maximum Length Null Default Comment jansId character varying 128 YES None Identifier jansAttrs text None YES None Attrs exp timestamp without time zone None YES None jans Exp del boolean None YES None del","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansinummap","title":"jansInumMap","text":"Field Type Character Maximum Length Null Default Comment jansStatus character varying 16 YES None Status of the entry, used by many objectclasses inum character varying 64 YES None XRI i-number jansPrimaryKeyAttrName character varying 64 YES None Primary Key Attribute Name jansPrimaryKeyValue character varying 64 YES None Primary Key Value jansSecondaryKeyAttrName character varying 64 YES None Secondary Key Attribute Name jansSecondaryKeyValue character varying 64 YES None Secondary Key Value jansTertiaryKeyAttrName character varying 64 YES None Tertiary Key Attribute Name jansTertiaryKeyValue character varying 64 YES None Tertiary Key Value","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#agmflowrun","title":"agmFlowRun","text":"Field Type Character Maximum Length Null Default Comment jansId character varying 128 YES None Identifier agFlowSt text None YES None Details of a running agama flow instance agFlowEncCont text None YES None Continuation associated to a running agama flow instance jansCustomMessage character varying 128 YES None exclude custom welcome message exp timestamp without time zone None YES None jans Exp","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#agmflow","title":"agmFlow","text":"Field Type Character Maximum Length Null Default Comment agFlowQname character varying 64 YES None Full name of an agama flow agFlowMeta text None YES None Metadata of an agama flow jansScr text None YES None Attr that contains script (python, java script) jansEnabled boolean None YES None Status of the entry, used by many objectclasses jansScrError text None YES None Attr that contains first error which application get during it execution agFlowTrans text None YES None Transpiled code of an agama flow jansRevision integer None YES None Revision jansCustomMessage character varying 128 YES None exclude custom welcome message","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#adsprjdeployment","title":"adsPrjDeployment","text":"Field Type Character Maximum Length Null Default Comment jansId character varying 128 YES None Identifier jansStartDate timestamp without time zone None YES None Start date jansEndDate timestamp without time zone None YES None End date adsPrjAssets text None YES None Assets of an ADS project adsPrjDeplDetails text None YES None Misc details associated to an ADS project","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/pgsql-schema/#jansdocument","title":"jansDocument","text":"Field Type Character Maximum Length Null Default Comment inum character varying 64 YES None XRI i-number displayName character varying 128 YES None preferred name of a person to be used when displaying entries document character varying 64 YES None Save Document in DB creationDate timestamp without time zone None YES None Creation Date used for password reset requests jansModuleProperty jsonb None YES None Module property jansLevel integer None YES None Level jansRevision integer None YES None Revision jansEnabled boolean None YES None Status of the entry, used by many objectclasses","tags":["administration","database","PostgreSQL","Indexes"]},{"location":"janssen-server/reference/database/rdbms-erwin/","title":"Generic tables structure","text":"","tags":["administration","reference","database"]},{"location":"janssen-server/reference/json/","title":"Properties And Feature Flags","text":"<p>Janssen Server configuration is driven by properties and feature flags. While properties drive behaviour of Janssen Server at more granular level, the feature flags are used to enable/disable functionalities at the server level.</p> <p>Janssen Server uses JSON format to store properties and feature flag configuration for any deployment. Administrators can use CLI or TUI to configure available properties and feature flags.</p> <p>Use the left navigation panel to browse complete list of available properties and feature flags across all Janssen Server modules.</p> <p>Contribute</p> <p>If you\u2019d like to contribute to this document, get started with the Contribution Guide</p>","tags":["administration","reference","json","properties","feature flags"]},{"location":"janssen-server/reference/json/feature-flags/","title":"Feature Flags","text":"<p>Janssen Server provides feature flags that the administrator can use to enable or disable the entire feature. For example, many endpoints exposed by Janssen Server can be disabled by the administrator using feature flags.</p> <p>Navigate through the left navigation panel to see the complete list of feature flags available in Janssen Server.</p>","tags":["administration","auth-server","reference","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/#using-feature-flags","title":"Using Feature Flags","text":"<p>An administrator can enable or disable feature flags using TUI. New value of the feature flag will be dynamically loaded at an interval of 30 seconds.</p>","tags":["administration","auth-server","reference","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/#updating-feature-flags-using-tui","title":"Updating Feature Flags Using TUI","text":"<ol> <li>Open TUI as instructed here</li> <li>Navigate to <code>Auth Server</code>-&gt;<code>Properties</code></li> <li>In the <code>Search</code> box, type <code>featureflags</code> and hit enter. Result should show     <code>featureFlag</code> property. Hitting enter will open a dialogue box where it is    possible to edit feature flags list</li> <li>Add or Remove the feature flags as needed</li> <li>Select <code>Save</code></li> <li>Wait for 30 seconds and changes should be effective</li> </ol>","tags":["administration","auth-server","reference","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/#updating-feature-flags-using-cli","title":"Updating Feature Flags Using CLI","text":"<p>Contribute</p> <p>If you\u2019d like to contribute to this document, get started with the Contribution Guide</p>","tags":["administration","auth-server","reference","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/","title":"Janssen Auth Server Feature Flags","text":"Feature Flag Name Description ACTIVE_SESSION Enable/Disable active session endpoint Details CIBA Enable/Disable OpenID Connect Client Initiated Backchannel Authentication Flow(CIBA) flow support Details CLIENTINFO Enable/Disable client info endpoint Details DEVICE_AUTHZ Enable/Disable support for device authorization Details END_SESSION Enable/Disable end session endpoint Details HEALTH_CHECK Enable/Disable health-check endpoint Details ID_GENERATION Enable/Disable ID Generation endpoint Details INTROSPECTION Enable/Disable token introspection endpoint Details JANS_CONFIGURATION Enable/Disable .well-known configuration endpoint Details METRIC Enable/Disable metric reporter feature Details PAR Enable/Disable Pushed Authorization Requests(PAR) feature Details REGISTRATION Enable/Disable client registration endpoint Details REVOKE_SESSION Enable/Disable session revocation endpoint Details REVOKE_TOKEN Enable/Disable token revocation endpoint Details SSA Enable/Disable Software Statement Assertion(SSA) feature Details STAT Enable/Disable Stat service Details STATUS_SESSION Enable/Disable session status check endpoint Details U2F Enable/Disable support for Universal 2nd Factor(U2F) protocol Details UMA Enable/Disable support for User-Managed Access (UMA) Details USERINFO Enable/Disable OpenID Connect userinfo endpoint Details","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#active_session","title":"ACTIVE_SESSION","text":"<ul> <li> <p>Description: Enable/Disable active session endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#ciba","title":"CIBA","text":"<ul> <li> <p>Description: Enable/Disable OpenID Connect Client Initiated Backchannel Authentication Flow(CIBA) flow support</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#clientinfo","title":"CLIENTINFO","text":"<ul> <li> <p>Description: Enable/Disable client info endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#device_authz","title":"DEVICE_AUTHZ","text":"<ul> <li> <p>Description: Enable/Disable support for device authorization</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#end_session","title":"END_SESSION","text":"<ul> <li> <p>Description: Enable/Disable end session endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#health_check","title":"HEALTH_CHECK","text":"<ul> <li> <p>Description: Enable/Disable health-check endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#id_generation","title":"ID_GENERATION","text":"<ul> <li> <p>Description: Enable/Disable ID Generation endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#introspection","title":"INTROSPECTION","text":"<ul> <li> <p>Description: Enable/Disable token introspection endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#jans_configuration","title":"JANS_CONFIGURATION","text":"<ul> <li> <p>Description: Enable/Disable .well-known configuration endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#metric","title":"METRIC","text":"<ul> <li> <p>Description: Enable/Disable metric reporter feature</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#par","title":"PAR","text":"<ul> <li> <p>Description: Enable/Disable Pushed Authorization Requests(PAR) feature</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#registration","title":"REGISTRATION","text":"<ul> <li> <p>Description: Enable/Disable client registration endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#revoke_session","title":"REVOKE_SESSION","text":"<ul> <li> <p>Description: Enable/Disable session revocation endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#revoke_token","title":"REVOKE_TOKEN","text":"<ul> <li> <p>Description: Enable/Disable token revocation endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#ssa","title":"SSA","text":"<ul> <li> <p>Description: Enable/Disable Software Statement Assertion(SSA) feature</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#stat","title":"STAT","text":"<ul> <li> <p>Description: Enable/Disable Stat service</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#status_session","title":"STATUS_SESSION","text":"<ul> <li> <p>Description: Enable/Disable session status check endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#u2f","title":"U2F","text":"<ul> <li> <p>Description: Enable/Disable support for Universal 2nd Factor(U2F) protocol</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#uma","title":"UMA","text":"<ul> <li> <p>Description: Enable/Disable support for User-Managed Access (UMA)</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/feature-flags/janssenauthserver-feature-flags/#userinfo","title":"USERINFO","text":"<ul> <li> <p>Description: Enable/Disable OpenID Connect userinfo endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","feature-flags"]},{"location":"janssen-server/reference/json/properties/","title":"Properties","text":"<p>Janssen Server modules are configured using properties. Each module has its own set of properties (navigate through the left navigation panel).</p>","tags":["administration","auth-server","reference","properties"]},{"location":"janssen-server/reference/json/properties/#setting-property-values","title":"Setting Property Values","text":"<p>An administrator can set properties using TUI. Each module has its own property configuration section in TUI.</p> <p>Properties are primarily of two types based on how the change in the value is loaded in the module at runtime.</p> <ul> <li>Static Properties: To load the changed property value, the respective Janssen Server module or server itself needs to be   restarted manually</li> <li>Dynamic Properties: Changes to the dynamic property values get reloaded automatically. Reload process triggers after   every 30 seconds. This does not need a restart of any server module.</li> </ul> <p>Contribute</p> <p>If you\u2019d like to contribute to this document, get started with the Contribution Guide</p>","tags":["administration","auth-server","reference","properties"]},{"location":"janssen-server/reference/json/properties/config-api-properties/","title":"Config API","text":"<p>Please use the left navigation menu to browse the content of this section while we are still working on developing content for <code>Overview</code> page.</p> <p>Contribute</p> <p>If you\u2019d like to contribute to this document, get started with the Contribution Guide</p>"},{"location":"janssen-server/reference/json/properties/fido2-properties/","title":"Fido2 Configuration Properties","text":"Property Name Description authenticationHistoryExpiration Expiration time in seconds for approved authentication requests Details authenticatorCertsFolder Authenticators certificates folder Details baseEndpoint The base URL for Fido2 endpoints Details checkU2fAttestations Boolean value indicating if U2f attestation needs to be checked Details cleanServiceBatchChunkSize Each clean up iteration fetches chunk of expired data per base dn and removes it from storage Details cleanServiceInterval Time interval for the Clean Service in seconds Details disableJdkLogger Boolean value specifying whether to enable JDK Loggers Details externalLoggerConfiguration Path to external Fido2 logging configuration Details issuer URL using the https scheme for Issuer identifier Details loggingLayout Logging layout used for Fido2 Details loggingLevel Logging level for Fido2 logger Details <p>| mdsCertsFolder                  | MDS TOC root certificates folder                                                              | Details                  | | mdsTocsFolder                   | MDS TOC files folder                                                                          | Details                   | | metadataUrlsProvider            | String value to provide source of URLs with external metadata                                 | Details            | | metricReporterEnabled           | Boolean value specifying whether metric reporter is enabled                                   | Details           | | metricReporterInterval          | The interval for metric reporter in seconds                                                   | Details          | | metricReporterKeepDataDays      | The days to keep report data                                                                  | Details      | | personCustomObjectClassList     | Custom object class list for dynamic person enrolment                                         | Details     | | enabledFidoAlgorithms           | List of Requested Credential Types                                                            | Details           | | rp                              | Requested Parties Authenticators metadata in json format                                      | Details                              | | serverMetadataFolder            | Authenticators metadata in json format                                                        | Details            |</p> <p>| unfinishedRequestExpiration     | Expiration time in seconds for pending enrollment/authentication requests                     | Details     | | useLocalCache                   | Boolean value to indicate if Local Cache is to be used                                        | Details                   | | debugUserAutoEnrollment         | Allow to enroll users on enrollment/authentication requests                                   | Details              |</p>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#authenticationhistoryexpiration","title":"authenticationHistoryExpiration","text":"<ul> <li> <p>Description: Expiration time in seconds for approved authentication requests</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#authenticatorcertsfolder","title":"authenticatorCertsFolder","text":"<ul> <li> <p>Description: Authenticators certificates folder</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#baseendpoint","title":"baseEndpoint","text":"<ul> <li> <p>Description: The base URL for Fido2 endpoints</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#checku2fattestations","title":"checkU2fAttestations","text":"<ul> <li> <p>Description: Boolean value indicating if U2f attestation needs to be checked</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#cleanservicebatchchunksize","title":"cleanServiceBatchChunkSize","text":"<ul> <li> <p>Description: Each clean up iteration fetches chunk of expired data per base dn and removes it from storage</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#cleanserviceinterval","title":"cleanServiceInterval","text":"<ul> <li> <p>Description: Time interval for the Clean Service in seconds</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#disablejdklogger","title":"disableJdkLogger","text":"<ul> <li> <p>Description: Boolean value specifying whether to enable JDK Loggers</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#externalloggerconfiguration","title":"externalLoggerConfiguration","text":"<ul> <li> <p>Description: Path to external Fido2 logging configuration</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#issuer","title":"issuer","text":"<ul> <li> <p>Description: URL using the https scheme for Issuer identifier</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#logginglayout","title":"loggingLayout","text":"<ul> <li> <p>Description: Logging layout used for Fido2</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#logginglevel","title":"loggingLevel","text":"<ul> <li> <p>Description: Logging level for Fido2 logger</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#mdscertsfolder","title":"mdsCertsFolder","text":"<ul> <li> <p>Description: MDS TOC root certificates folder</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#mdstocsfolder","title":"mdsTocsFolder","text":"<ul> <li> <p>Description: MDS TOC files folder</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#metadataurlsprovider","title":"metadataUrlsProvider","text":"<ul> <li> <p>Description: String value to provide source of URLs with external metadata</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#metricreporterenabled","title":"metricReporterEnabled","text":"<ul> <li> <p>Description: Boolean value specifying whether metric reporter is enabled</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#metricreporterinterval","title":"metricReporterInterval","text":"<ul> <li> <p>Description: The interval for metric reporter in seconds</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#metricreporterkeepdatadays","title":"metricReporterKeepDataDays","text":"<ul> <li> <p>Description: The days to keep report data</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#personcustomobjectclasslist","title":"personCustomObjectClassList","text":"<ul> <li> <p>Description: Custom object class list for dynamic person enrolment</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#enabledfidoalgorithms","title":"enabledFidoAlgorithms","text":"<ul> <li> <p>Description: List of Requested Credential Types</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#rp","title":"rp","text":"<ul> <li> <p>Description: Requested Parties Authenticators metadata in json format</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#servermetadatafolder","title":"serverMetadataFolder","text":"<ul> <li> <p>Description: Authenticators metadata in json format</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#unfinishedrequestexpiration","title":"unfinishedRequestExpiration","text":"<ul> <li> <p>Description: Expiration time in seconds for pending enrollment/authentication requests</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#uselocalcache","title":"useLocalCache","text":"<ul> <li> <p>Description: Boolean value to indicate if Local Cache is to be used</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/fido2-properties/#debuguserautoenrollment","title":"debugUserAutoEnrollment","text":"<ul> <li> <p>Description: Allow to enroll users on enrollment/authentication requests</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/","title":"Janssen Auth Server Configuration Properties","text":"Property Name Description accessTokenLifetime The lifetime of the short lived Access Token Details accessTokenSigningAlgValuesSupported A list of the JWS signing algorithms (alg values) supported by the OP for the access token to encode the Claims in a JWT Details activeSessionAuthorizationScope Authorization Scope for active session Details agamaConfiguration Engine Config which offers an alternative way to build authentication flows in Janssen server Details allowAllValueForRevokeEndpoint Boolean value true allow all value for revoke endpoint Details allowBlankValuesInDiscoveryResponse Boolean value specifying whether to allow blank values in discovery response Details allowEndSessionWithUnmatchedSid default value false. If true, sid check will be skipped Details allowIdTokenWithoutImplicitGrantType Specifies if a token without implicit grant types is allowed Details allowPostLogoutRedirectWithoutValidation Allows post-logout redirect without validation for the End Session endpoint (still AS validates it against clientWhiteList url pattern property) Details allowSpontaneousScopes Specifies whether to allow spontaneous scopes Details authenticationFilters This list details filters for user authentication Details authenticationFiltersEnabled Boolean value specifying whether to enable user authentication filters Details authenticationProtectionConfiguration Authentication Brute Force Protection Configuration Details authorizationCodeLifetime The lifetime of the Authorization Code Details authorizationEncryptionAlgValuesSupported List of authorization encryption algorithms supported by this OP Details authorizationEncryptionEncValuesSupported A list of the authorization encryption algorithms supported Details authorizationEndpoint The authorization endpoint URL Details authorizationRequestCustomAllowedParameters This list details the allowed custom parameters for authorization requests Details authorizationSigningAlgValuesSupported List of authorization signing algorithms supported by this OP Details backchannelAuthenticationEndpoint Backchannel Authentication Endpoint Details backchannelAuthenticationRequestSigningAlgValuesSupported Backchannel Authentication Request Signing Alg Values Supported Details backchannelAuthenticationResponseExpiresIn Backchannel Authentication Response Expires In Details backchannelAuthenticationResponseInterval Backchannel Authentication Response Interval Details backchannelBindingMessagePattern Backchannel Binding Message Pattern Details backchannelClientId Backchannel Client Id Details backchannelDeviceRegistrationEndpoint Backchannel Device Registration Endpoint Details backchannelLoginHintClaims Backchannel Login Hint Claims Details backchannelRedirectUri Backchannel Redirect Uri Details backchannelRequestsProcessorJobChunkSize Each backchannel request processor iteration fetches chunk of data to be processed Details backchannelRequestsProcessorJobIntervalSec Specifies the allowable elapsed time in seconds backchannel request processor executes Details backchannelTokenDeliveryModesSupported Backchannel Token Delivery Modes Supported Details backchannelUserCodeParameterSupported Backchannel User Code Parameter Supported Details baseEndpoint The base URL for endpoints Details blockWebviewAuthorizationEnabled Enable/Disable block authorizations that originate from Webview (Mobile apps). Details changeSessionIdOnAuthentication Boolean value specifying whether change session_id on authentication. Default value is true Details checkSessionIFrame URL for an OP IFrame that supports cross-origin communications for session state information with the RP Client using the HTML5 postMessage API Details checkUserPresenceOnRefreshToken Check whether user exists and is active before creating RefreshToken. Set it to true if check is needed(Default value is false - don't check. Details cibaEndUserNotificationConfig CIBA End User Notification Config Details cibaGrantLifeExtraTimeSec Specifies the CIBA Grant life extra time in seconds Details cibaMaxExpirationTimeAllowedSec Specifies the CIBA token expiration time in seconds Details claimsLocalesSupported This list details the languages and scripts supported for values in the claims being returned Details claimsParameterSupported Specifies whether the OP supports use of the claims parameter Details claimTypesSupported A list of the Claim Types that the OpenID Provider supports Details clientAuthenticationFilters This list details filters for client authentication Details clientAuthenticationFiltersEnabled Boolean value specifying whether to enable client authentication filters Details clientBlackList This list specified which client redirection URIs are black-listed Details clientInfoEndpoint The Client Info endpoint URL Details clientRegDefaultToCodeFlowWithRefresh Boolean value specifying whether to add Authorization Code Flow with Refresh grant during client registratio Details clientWhiteList This list specifies which client redirection URIs are white-listed Details configurationUpdateInterval The interval for configuration update in seconds Details consentGatheringScriptBackwardCompatibility Boolean value specifying whether to turn on Consent Gathering Script backward compatibility mode. If true AS will pick up script with higher level globally. If false (default) AS will pick up script based on client configuration Details cookieDomain Sets cookie domain for all cookies created by OP Details corsConfigurationFilters This list specifies the CORS configuration filters Details cssLocation The location for CSS files Details customHeadersWithAuthorizationResponse Choose whether to enable the custom response header parameter to return custom headers with the authorization response Details dateFormatterPatterns List of key value date formatters, e.g. 'userinfo: 'yyyy-MM-dd', etc. Details dcrAuthorizationWithClientCredentials Boolean value indicating if DCR authorization to be performed using client credentials Details dcrAuthorizationWithMTLS Boolean value indicating if DCR authorization allowed with MTLS Details dcrForbidExpirationTimeInRequest Boolean value specifying whether to allow to set client's expiration time in seconds during dynamic registration. Details dcrSignatureValidationEnabled Boolean value enables DCR signature validation. Default is false Details dcrSignatureValidationJwks Specifies JWKS for all DCR's validations Details dcrSignatureValidationJwksUri Specifies JWKS URI for all DCR's validations Details dcrSignatureValidationSharedSecret Specifies shared secret for Dynamic Client Registration Details dcrSignatureValidationSoftwareStatementJwksClaim Specifies claim name inside software statement. Value of claim should point to inlined JWKS Details dcrSignatureValidationSoftwareStatementJwksURIClaim Specifies claim name inside software statement. Value of claim should point to JWKS URI Details dcrSsaValidationConfigs DCR SSA Validation configurations used to perform validation of SSA or DCR Details defaultSignatureAlgorithm The default signature algorithm to sign ID Tokens Details defaultSubjectType The default subject type used for dynamic client registration Details deviceAuthzAcr Device authz acr Details deviceAuthzEndpoint URL for the Device Authorization Details deviceAuthzRequestExpiresIn Expiration time given for device authorization requests Details deviceAuthzResponseTypeToProcessAuthz Response type used to process device authz requests Details deviceAuthzTokenPollInterval Default interval returned to the client to process device token requests Details disableAuthnForMaxAgeZero Boolean value specifying whether to disable authentication when max_age=0 Details disableJdkLogger Choose whether to disable JDK loggers Details disablePromptConsent Boolean value specifying whether to disable prompt=consent Details disablePromptLogin Boolean value specifying whether to disable prompt=login Details disableU2fEndpoint Choose whether to disable U2F endpoints Details discoveryAllowedKeys List of configuration response claim allowed to be displayed in discovery endpoint Details discoveryCacheLifetimeInMinutes Lifetime of discovery cache Details discoveryDenyKeys List of configuration response claims which must not be displayed in discovery endpoint response Details displayValuesSupported A list of the display parameter values that the OpenID Provider supports Details dnName DN of certificate issuer Details dpopJtiCacheTime Demonstration of Proof-of-Possession (DPoP) cache time Details dpopNonceCacheTime Demonstration of Proof-of-Possession (DPoP) nonce cache time Details dpopSigningAlgValuesSupported Demonstration of Proof-of-Possession (DPoP) authorization signing algorithms supported Details dpopTimeframe Demonstration of Proof-of-Possession (DPoP) timeout Details dpopUseNonce Demonstration of Proof-of-Possession (DPoP) use nonce Details grantTypesSupportedByDynamicRegistration This list details which OAuth 2.0 grant types can be set up with the client registration API Details dynamicRegistrationAllowedPasswordGrantScopes List of grant scopes for dynamic registration Details dynamicRegistrationCustomAttributes This list details the custom attributes allowed for dynamic registration Details dynamicRegistrationCustomObjectClass LDAP custom object class for dynamic registration Details dynamicRegistrationDefaultCustomAttributes This map provides default custom attributes with values for dynamic registration Details dynamicRegistrationExpirationTime Expiration time in seconds for clients created with dynamic registration, 0 or -1 means never expire Details dynamicRegistrationPasswordGrantTypeEnabled Boolean value specifying whether to enable Password Grant Type during Dynamic Registration Details dynamicRegistrationPersistClientAuthorizations Boolean value specifying whether to persist client authorizations Details dynamicRegistrationScopesParamEnabled Boolean value specifying whether to enable scopes parameter in dynamic registration Details enableClientGrantTypeUpdate Choose if client can update Grant Type values Details enabledOAuthAuditLogging enable OAuth Audit Logging Details endSessionEndpoint URL at the OP to which an RP can perform a redirect to request that the end user be logged out at the OP Details endSessionWithAccessToken Choose whether to accept access tokens to call end_session endpoint Details errorHandlingMethod A list of possible error handling methods. Possible values: remote (send error back to RP), internal (show error page) Details errorReasonEnabled Boolean value specifying whether to return detailed reason of the error from AS. Default value is false Details expirationNotificatorEnabled Boolean value specifying whether expiration notificator is enabled (used to identify expiration for persistence that support TTL, like Couchbase) Details expirationNotificatorIntervalInSeconds The expiration notificator interval in second Details expirationNotificatorMapSizeLimit The expiration notificator maximum size limit Details externalLoggerConfiguration The path to the external log4j2 logging configuration Details externalUriWhiteList This list specifies which external URIs can be called by AS (if empty any URI can be called) Details fapiCompatibility Boolean value specifying whether to turn on FAPI compatibility mode. If true AS behaves in more strict mode Details featureFlags List of enabled feature flags Details forceIdTokenHintPresence Boolean value specifying whether force id_token_hint parameter presence Details forceOfflineAccessScopeToEnableRefreshToken Boolean value specifying whether force offline_access scope to enable refresh_token grant type. Default value is true Details forceSignedRequestObject Boolean value true indicates that signed request object is mandatory Details frontChannelLogoutSessionSupported Choose whether to support front channel session logout Details grantTypesAndResponseTypesAutofixEnabled Boolean value specifying whether to Grant types and Response types can be auto fixed Details grantTypesSupported This list details which OAuth 2.0 grant types are supported by this OP Details httpLoggingEnabled Enable/disable request/response logging filter Details httpLoggingExcludePaths This list details the base URIs for which the request/response logging filter will not record activity Details httpLoggingResponseBodyContent Defines if Response body will be logged. Default value is false Details idGenerationEndpoint ID Generation endpoint URL Details idTokenEncryptionAlgValuesSupported A list of the JWE encryption algorithms (alg values) supported by the OP for the ID Token to encode the Claims in a JWT Details idTokenEncryptionEncValuesSupported A list of the JWE encryption algorithms (enc values) supported by the OP for the ID Token to encode the Claims in a JWT Details idTokenFilterClaimsBasedOnAccessToken Boolean value specifying whether idToken filters claims based on accessToken Details idTokenLifetime The lifetime of the ID Token Details idTokenSigningAlgValuesSupported A list of the JWS signing algorithms (alg values) supported by the OP for the ID Token to encode the Claims in a JWT Details idTokenTokenBindingCnfValuesSupported Array containing a list of the JWT Confirmation Method member names supported by the OP for Token Binding of ID Tokens. The presence of this parameter indicates that the OpenID Provider supports Token Binding of ID Tokens. If omitted, the default is that the OpenID Provider does not support Token Binding of ID Tokens Details imgLocation The location for image files Details includeSidInResponse Boolean value specifying whether to include sessionId in response Details introspectionAccessTokenMustHaveIntrospectionScope If True, rejects introspection requests if access_token does not have the 'introspection' scope in its authorization header. Comparing to 'uma_protection', 'introspection' scope is not allowed for dynamic registration' Details introspectionAccessTokenMustHaveUmaProtectionScope If True, rejects introspection requests if access_token does not have the uma_protection scope in its authorization header Details introspectionEndpoint Introspection endpoint URL Details introspectionResponseScopesBackwardCompatibility Boolean value specifying introspection response backward compatibility mode Details introspectionScriptBackwardCompatibility Boolean value specifying whether switch off client's introspection scripts (true value) and run all scripts that exists on server. Default value is false Details introspectionSkipAuthorization Specifies if authorization to be skipped for introspection Details invalidateSessionCookiesAfterAuthorizationFlow Boolean value to specify whether to invalidate session_id and consent_session_id cookies right after successful or unsuccessful authorization Details issuer URL using the https scheme that OP asserts as Issuer identifier Details jansId URL for the Inum generator Service Details jansOpenIdConnectVersion OpenID Connect Version Details jmsBrokerURISet JMS Broker URI Set Details jmsPassword JMS Password Details jmsUserName JMS UserName Details jsLocation The location for JavaScript files Details jwksAlgorithmsSupported A list of algorithms that will be used in JWKS endpoint Details jwksUri URL of the OP's JSON Web Key Set (JWK) document. This contains the signing key(s) the RP uses to validate signatures from the OP Details keepAuthenticatorAttributesOnAcrChange Boolean value specifying whether to keep authenticator attributes on ACR change Details keyAlgsAllowedForGeneration List of algorithm allowed to be used for key generation Details keyRegenerationEnabled Boolean value specifying whether to regenerate keys Details keyRegenerationInterval The interval for key regeneration in hours Details keySelectionStrategy Key Selection Strategy : OLDER, NEWER, FIRST Details keySignWithSameKeyButDiffAlg Specifies if signing to be done with same key but apply different algorithms Details keyStoreFile The Key Store File (JKS) Details keyStoreSecret The Key Store password Details legacyIdTokenClaims Choose whether to include claims in ID tokens Details logClientIdOnClientAuthentication Choose if application should log the Client ID on client authentication Details logClientNameOnClientAuthentication Choose if application should log the Client Name on client authentication Details loggingLayout Logging layout used for Jans Authorization Server loggers Details loggingLevel Specify the logging level of loggers Details logNotFoundEntityAsError Boolean value specifying whether to log not_found entity exception as error or as trace. Default value is false (trace). Details metricReporterInterval The interval for metric reporter in seconds Details metricReporterKeepDataDays The days to keep metric reported data Details mtlsAuthorizationEndpoint URL for Mutual TLS (mTLS) Client Authentication and Certificate-Bound Access Tokens (MTLS) Endpoint Details mtlsCheckSessionIFrame URL for Mutual TLS (mTLS) IFrame that supports cross-origin communications for session state information with the RP Client using the HTML5 postMessage API Details mtlsClientInfoEndpoint URL for Mutual TLS (mTLS) Client Info endpoint Details mtlsDeviceAuthzEndpoint Mutual TLS (mTLS) device authorization endpoint URL Details mtlsEndSessionEndpoint URL for Mutual TLS (mTLS) to which an RP can perform a redirect to request that the end user be logged out at the OP Details mtlsIdGenerationEndpoint Mutual TLS (mTLS) ID generation endpoint URL Details mtlsIntrospectionEndpoint Mutual TLS (mTLS) introspection endpoint URL Details mtlsJwksUri URL for Mutual TLS (mTLS) of the OP's JSON Web Key Set (JWK) document Details mtlsParEndpoint Mutual TLS (mTLS) Pushed Authorization Requests(PAR) endpoint URL Details mtlsRegistrationEndpoint Mutual TLS (mTLS) registration endpoint URL Details mtlsTokenEndpoint URL for Mutual TLS (mTLS) Authorization token Endpoint Details mtlsTokenRevocationEndpoint URL for Mutual TLS (mTLS) Authorization token revocation endpoint Details mtlsUserInfoEndpoint Mutual TLS (mTLS) user info endpoint URL Details openIdConfigurationEndpoint URL for the Open ID Connect Configuration Endpoint Details openIdDiscoveryEndpoint Discovery endpoint URL Details openidScopeBackwardCompatibility Set to false to only allow token endpoint request for openid scope with grant type equals to authorization_code, restrict access to userinfo to scope openid and only return id_token if scope contains openid Details openidSubAttribute Specifies which LDAP attribute is used for the subject identifier claim Details opPolicyUri URL that the OpenID Provider provides to the person registering the Client to read about the OP's requirements on how the Relying Party can use the data provided by the OP Details opTosUri URL that the OpenID Provider provides to the person registering the Client to read about OpenID Provider's terms of service Details pairwiseCalculationKey Key to calculate algorithmic pairwise IDs Details pairwiseCalculationSalt Salt to calculate algorithmic pairwise IDs Details pairwiseIdType the pairwise ID type Details parEndpoint URL for Pushed Authorisation Request (PAR) Endpoint Details persistIdToken Specifies whether to persist id_token (otherwise saves into cache) Details persistRefreshToken Specifies whether to persist refresh_token (otherwise saves into cache) Details personCustomObjectClassList This list details LDAP custom object classes for dynamic person enrollment Details publicSubjectIdentifierPerClientEnabled Specifies whether public subject identifier is allowed per client Details redirectUrisRegexEnabled Enable/Disable redirect uris validation using regular expression Details refreshTokenExtendLifetimeOnRotation Boolean value specifying whether to extend refresh tokens on rotation Details refreshTokenLifetime The lifetime of the Refresh Token Details registrationEndpoint Registration endpoint URL Details rejectEndSessionIfIdTokenExpired default value false. If true and id_token is not found in db, request is rejected Details rejectJwtWithNoneAlg Boolean value specifying whether reject JWT requested or validated with algorithm None. Default value is true Details removeRefreshTokensForClientOnLogout Boolean value specifying whether to remove Refresh Tokens on logout. Default value is true Details requestObjectEncryptionAlgValuesSupported A list of the JWE encryption algorithms (alg values) supported by the OP for Request Objects Details requestObjectEncryptionEncValuesSupported A list of the JWE encryption algorithms (enc values) supported by the OP for Request Objects Details requestObjectSigningAlgValuesSupported A list of the JWS signing algorithms (alg values) supported by the OP for Request Objects Details requestParameterSupported Boolean value specifying whether the OP supports use of the request parameter Details requestUriBlockList Block list for requestUri that can come to Authorization Endpoint (e.g. localhost) Details requestUriHashVerificationEnabled Boolean value specifying whether the OP supports use of the request_uri hash verification Details requestUriParameterSupported Boolean value specifying whether the OP supports use of the request_uri parameter Details requirePar Boolean value to indicate of Pushed Authorisation Request(PAR)is required Details requirePkce Boolean value true check for Proof Key for Code Exchange (PKCE) Details requireRequestObjectEncryption Boolean value true encrypts request object Details requireRequestUriRegistration Boolean value specifying whether the OP requires any request_uri values used to be pre-registered using the request_uris registration parameter Details responseModesSupported This list details which OAuth 2.0 response modes are supported by this OP Details responseTypesSupported This list details which OAuth 2.0 response_type values are supported by this OP. Details returnClientSecretOnRead Boolean value specifying whether a client_secret is returned on client GET or PUT. Set to true by default which means to return secret Details returnDeviceSecretFromAuthzEndpoint Details rotateClientRegistrationAccessTokenOnUsage Boolean value specifying whether to rotate client registration access token after each usage Details rotateDeviceSecret Details sectorIdentifierCacheLifetimeInMinutes Sector Identifier cache lifetime in minutes Details serverSessionIdLifetime Dedicated property to control lifetime of the server side OP session object in seconds. Overrides sessionIdLifetime. By default value is 0, so object lifetime equals sessionIdLifetime (which sets both cookie and object expiration). It can be useful if goal is to keep different values for client cookie and server object Details serviceDocumentation URL of a page containing human-readable information that developers might want or need to know when using the OpenID Provider Details sessionIdLifetime The lifetime of session id in seconds. If 0 or -1 then expiration is not set. session_id cookie expires when browser session ends Details sessionIdPersistInCache Boolean value specifying whether to persist session_id in cache Details sessionIdPersistOnPromptNone Boolean value specifying whether to persist session ID on prompt none Details sessionIdRequestParameterEnabled Boolean value specifying whether to enable session_id HTTP request parameter Details sessionIdUnauthenticatedUnusedLifetime The lifetime for unused unauthenticated session states Details sessionIdUnusedLifetime The lifetime for unused session states Details shareSubjectIdBetweenClientsWithSameSectorId When true, clients with the same Sector ID also share the same Subject ID Details skipAuthenticationFilterOptionsMethod Force Authentication Filtker to process OPTIONS request Details skipAuthorizationForOpenIdScopeAndPairwiseId Choose whether to skip authorization if a client has an OpenId scope and a pairwise ID Details skipRefreshTokenDuringRefreshing Boolean value specifying whether to skip refreshing tokens on refreshing Details softwareStatementValidationClaimName Validation claim name for software statement Details softwareStatementValidationType Validation type used for software statement Details spontaneousScopeLifetime The lifetime of spontaneous scope in seconds Details ssaConfiguration SSA Configuration Details statAuthorizationScope Scope required for Statistical Authorization Details staticDecryptionKid Specifies static decryption Kid Details staticKid Specifies static Kid Details statTimerIntervalInSeconds Statistical data capture time interval Details subjectIdentifiersPerClientSupported A list of the subject identifiers supported per client Details subjectTypesSupported This list details which Subject Identifier types that the OP supports. Valid types include pairwise and public. Details tokenEndpoint The token endpoint URL Details tokenEndpointAuthMethodsSupported A list of Client Authentication methods supported by this Token Endpoint Details tokenEndpointAuthSigningAlgValuesSupported A list of the JWS signing algorithms (alg values) supported by the Token Endpoint for the signature on the JWT used to authenticate the Client at the Token Endpoint for the private_key_jwt and client_secret_jwt authentication methods Details tokenRevocationEndpoint The URL for the access_token or refresh_token revocation endpoint Details trustedClientEnabled Boolean value specifying whether a client is trusted and no authorization is required Details trustedSsaIssuers List of trusted SSA issuers with configuration (e.g. automatically granted scopes). Details uiLocalesSupported This list details the languages and scripts supported for the user interface Details umaAddScopesAutomatically Add UMA scopes automatically if it is not registered yet Details umaConfigurationEndpoint UMA Configuration endpoint URL Details umaGrantAccessIfNoPolicies Specify whether to grant access to resources if there is no any policies associated with scopes Details umaPctLifetime UMA PCT lifetime Details umaResourceLifetime UMA Resource lifetime Details umaRestrictResourceToAssociatedClient Restrict access to resource by associated client Details umaRptAsJwt Issue RPT as JWT or as random string Details umaRptLifetime UMA RPT lifetime Details umaTicketLifetime UMA ticket lifetime Details umaValidateClaimToken Validate claim_token as id_token assuming it is issued by local id Details updateClientAccessTime Choose if application should update oxLastAccessTime/oxLastLogonTime attributes upon client authentication Details updateUserLastLogonTime Choose if application should update oxLastLogonTime attribute upon user authentication Details useHighestLevelScriptIfAcrScriptNotFound Enable/Disable usage of highest level script in case ACR script does not exist Details useLocalCache Cache in local memory cache attributes, scopes, clients and organization entry with expiration 60 seconds Details useNestedJwtDuringEncryption Boolean value specifying whether to use nested Jwt during encryption Details userInfoEncryptionAlgValuesSupported This JSON Array lists which JWS encryption algorithms (alg values) [JWA] can be used by for the UserInfo endpoint to encode the claims in a JWT Details userInfoEncryptionEncValuesSupported This JSON Array lists which JWS encryption algorithms (enc values) [JWA] can be used by for the UserInfo endpoint to encode the claims in a JWT Details userInfoEndpoint The User Info endpoint URL Details userInfoSigningAlgValuesSupported This JSON Array lists which JWS signing algorithms (alg values) [JWA] can be used by for the UserInfo endpoint to encode the claims in a JWT Details webKeysStorage Web Key Storage Type Details connectionServiceConfiguration Group for HttpService2 network configuration Details - maxTotal Set the maximum number of total open connections Details - maxPerRoute Set the maximum number of concurrent connections per route Details - validateAfterInactivity Defines period of inactivity in milliseconds after which persistent connections must be re-validated prior to being leased to the consumer Details","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#accesstokenlifetime","title":"accessTokenLifetime","text":"<ul> <li> <p>Description: The lifetime of the short lived Access Token</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#accesstokensigningalgvaluessupported","title":"accessTokenSigningAlgValuesSupported","text":"<ul> <li> <p>Description: A list of the JWS signing algorithms (alg values) supported by the OP for the access token to encode the Claims in a JWT</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#activesessionauthorizationscope","title":"activeSessionAuthorizationScope","text":"<ul> <li> <p>Description: Authorization Scope for active session</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#agamaconfiguration","title":"agamaConfiguration","text":"<ul> <li> <p>Description: Engine Config which offers an alternative way to build authentication flows in Janssen server</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#allowallvalueforrevokeendpoint","title":"allowAllValueForRevokeEndpoint","text":"<ul> <li> <p>Description: Boolean value true allow all value for revoke endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#allowblankvaluesindiscoveryresponse","title":"allowBlankValuesInDiscoveryResponse","text":"<ul> <li> <p>Description: Boolean value specifying whether to allow blank values in discovery response</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#allowendsessionwithunmatchedsid","title":"allowEndSessionWithUnmatchedSid","text":"<ul> <li> <p>Description: default value false. If true, sid check will be skipped</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#allowidtokenwithoutimplicitgranttype","title":"allowIdTokenWithoutImplicitGrantType","text":"<ul> <li> <p>Description: Specifies if a token without implicit grant types is allowed</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#allowpostlogoutredirectwithoutvalidation","title":"allowPostLogoutRedirectWithoutValidation","text":"<ul> <li> <p>Description: Allows post-logout redirect without validation for the End Session endpoint (still AS validates it against clientWhiteList url pattern property)</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#allowspontaneousscopes","title":"allowSpontaneousScopes","text":"<ul> <li> <p>Description: Specifies whether to allow spontaneous scopes</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#authenticationfilters","title":"authenticationFilters","text":"<ul> <li> <p>Description: This list details filters for user authentication</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#authenticationfiltersenabled","title":"authenticationFiltersEnabled","text":"<ul> <li> <p>Description: Boolean value specifying whether to enable user authentication filters</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#authenticationprotectionconfiguration","title":"authenticationProtectionConfiguration","text":"<ul> <li> <p>Description: Authentication Brute Force Protection Configuration</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#authorizationcodelifetime","title":"authorizationCodeLifetime","text":"<ul> <li> <p>Description: The lifetime of the Authorization Code</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#authorizationencryptionalgvaluessupported","title":"authorizationEncryptionAlgValuesSupported","text":"<ul> <li> <p>Description: List of authorization encryption algorithms supported by this OP</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#authorizationencryptionencvaluessupported","title":"authorizationEncryptionEncValuesSupported","text":"<ul> <li> <p>Description: A list of the authorization encryption algorithms supported</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#authorizationendpoint","title":"authorizationEndpoint","text":"<ul> <li> <p>Description: The authorization endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#authorizationrequestcustomallowedparameters","title":"authorizationRequestCustomAllowedParameters","text":"<ul> <li> <p>Description: This list details the allowed custom parameters for authorization requests</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#authorizationsigningalgvaluessupported","title":"authorizationSigningAlgValuesSupported","text":"<ul> <li> <p>Description: List of authorization signing algorithms supported by this OP</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#backchannelauthenticationendpoint","title":"backchannelAuthenticationEndpoint","text":"<ul> <li> <p>Description: Backchannel Authentication Endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#backchannelauthenticationrequestsigningalgvaluessupported","title":"backchannelAuthenticationRequestSigningAlgValuesSupported","text":"<ul> <li> <p>Description: Backchannel Authentication Request Signing Alg Values Supported</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#backchannelauthenticationresponseexpiresin","title":"backchannelAuthenticationResponseExpiresIn","text":"<ul> <li> <p>Description: Backchannel Authentication Response Expires In</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#backchannelauthenticationresponseinterval","title":"backchannelAuthenticationResponseInterval","text":"<ul> <li> <p>Description: Backchannel Authentication Response Interval</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#backchannelbindingmessagepattern","title":"backchannelBindingMessagePattern","text":"<ul> <li> <p>Description: Backchannel Binding Message Pattern</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#backchannelclientid","title":"backchannelClientId","text":"<ul> <li> <p>Description: Backchannel Client Id</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#backchanneldeviceregistrationendpoint","title":"backchannelDeviceRegistrationEndpoint","text":"<ul> <li> <p>Description: Backchannel Device Registration Endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#backchannelloginhintclaims","title":"backchannelLoginHintClaims","text":"<ul> <li> <p>Description: Backchannel Login Hint Claims</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#backchannelredirecturi","title":"backchannelRedirectUri","text":"<ul> <li> <p>Description: Backchannel Redirect Uri</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#backchannelrequestsprocessorjobchunksize","title":"backchannelRequestsProcessorJobChunkSize","text":"<ul> <li> <p>Description: Each backchannel request processor iteration fetches chunk of data to be processed</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#backchannelrequestsprocessorjobintervalsec","title":"backchannelRequestsProcessorJobIntervalSec","text":"<ul> <li> <p>Description: Specifies the allowable elapsed time in seconds backchannel request processor executes</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#backchanneltokendeliverymodessupported","title":"backchannelTokenDeliveryModesSupported","text":"<ul> <li> <p>Description: Backchannel Token Delivery Modes Supported</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#backchannelusercodeparametersupported","title":"backchannelUserCodeParameterSupported","text":"<ul> <li> <p>Description: Backchannel User Code Parameter Supported</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#baseendpoint","title":"baseEndpoint","text":"<ul> <li> <p>Description: The base URL for endpoints</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#blockwebviewauthorizationenabled","title":"blockWebviewAuthorizationEnabled","text":"<ul> <li> <p>Description: Enable/Disable block authorizations that originate from Webview (Mobile apps).</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#changesessionidonauthentication","title":"changeSessionIdOnAuthentication","text":"<ul> <li> <p>Description: Boolean value specifying whether change session_id on authentication. Default value is true</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: true</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#checksessioniframe","title":"checkSessionIFrame","text":"<ul> <li> <p>Description: URL for an OP IFrame that supports cross-origin communications for session state information with the RP Client using the HTML5 postMessage API</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#checkuserpresenceonrefreshtoken","title":"checkUserPresenceOnRefreshToken","text":"<ul> <li> <p>Description: Check whether user exists and is active before creating RefreshToken. Set it to true if check is needed(Default value is false - don't check.</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#cibaendusernotificationconfig","title":"cibaEndUserNotificationConfig","text":"<ul> <li> <p>Description: CIBA End User Notification Config</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#cibagrantlifeextratimesec","title":"cibaGrantLifeExtraTimeSec","text":"<ul> <li> <p>Description: Specifies the CIBA Grant life extra time in seconds</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#cibamaxexpirationtimeallowedsec","title":"cibaMaxExpirationTimeAllowedSec","text":"<ul> <li> <p>Description: Specifies the CIBA token expiration time in seconds</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#claimslocalessupported","title":"claimsLocalesSupported","text":"<ul> <li> <p>Description: This list details the languages and scripts supported for values in the claims being returned</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#claimsparametersupported","title":"claimsParameterSupported","text":"<ul> <li> <p>Description: Specifies whether the OP supports use of the claims parameter</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#claimtypessupported","title":"claimTypesSupported","text":"<ul> <li> <p>Description: A list of the Claim Types that the OpenID Provider supports</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#clientauthenticationfilters","title":"clientAuthenticationFilters","text":"<ul> <li> <p>Description: This list details filters for client authentication</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#clientauthenticationfiltersenabled","title":"clientAuthenticationFiltersEnabled","text":"<ul> <li> <p>Description: Boolean value specifying whether to enable client authentication filters</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#clientblacklist","title":"clientBlackList","text":"<ul> <li> <p>Description: This list specified which client redirection URIs are black-listed</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#clientinfoendpoint","title":"clientInfoEndpoint","text":"<ul> <li> <p>Description: The Client Info endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#clientregdefaulttocodeflowwithrefresh","title":"clientRegDefaultToCodeFlowWithRefresh","text":"<ul> <li> <p>Description: Boolean value specifying whether to add Authorization Code Flow with Refresh grant during client registratio</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#clientwhitelist","title":"clientWhiteList","text":"<ul> <li> <p>Description: This list specifies which client redirection URIs are white-listed</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#configurationupdateinterval","title":"configurationUpdateInterval","text":"<ul> <li> <p>Description: The interval for configuration update in seconds</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#consentgatheringscriptbackwardcompatibility","title":"consentGatheringScriptBackwardCompatibility","text":"<ul> <li> <p>Description: Boolean value specifying whether to turn on Consent Gathering Script backward compatibility mode. If true AS will pick up script with higher level globally. If false (default) AS will pick up script based on client configuration</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#cookiedomain","title":"cookieDomain","text":"<ul> <li> <p>Description: Sets cookie domain for all cookies created by OP</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#corsconfigurationfilters","title":"corsConfigurationFilters","text":"<ul> <li> <p>Description: This list specifies the CORS configuration filters</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#csslocation","title":"cssLocation","text":"<ul> <li> <p>Description: The location for CSS files</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#customheaderswithauthorizationresponse","title":"customHeadersWithAuthorizationResponse","text":"<ul> <li> <p>Description: Choose whether to enable the custom response header parameter to return custom headers with the authorization response</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dateformatterpatterns","title":"dateFormatterPatterns","text":"<ul> <li> <p>Description: List of key value date formatters, e.g. 'userinfo: 'yyyy-MM-dd', etc.</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dcrauthorizationwithclientcredentials","title":"dcrAuthorizationWithClientCredentials","text":"<ul> <li> <p>Description: Boolean value indicating if DCR authorization to be performed using client credentials</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dcrauthorizationwithmtls","title":"dcrAuthorizationWithMTLS","text":"<ul> <li> <p>Description: Boolean value indicating if DCR authorization allowed with MTLS</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dcrforbidexpirationtimeinrequest","title":"dcrForbidExpirationTimeInRequest","text":"<ul> <li> <p>Description: Boolean value specifying whether to allow to set client's expiration time in seconds during dynamic registration.</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dcrsignaturevalidationenabled","title":"dcrSignatureValidationEnabled","text":"<ul> <li> <p>Description: Boolean value enables DCR signature validation. Default is false</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dcrsignaturevalidationjwks","title":"dcrSignatureValidationJwks","text":"<ul> <li> <p>Description: Specifies JWKS for all DCR's validations</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dcrsignaturevalidationjwksuri","title":"dcrSignatureValidationJwksUri","text":"<ul> <li> <p>Description: Specifies JWKS URI for all DCR's validations</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dcrsignaturevalidationsharedsecret","title":"dcrSignatureValidationSharedSecret","text":"<ul> <li> <p>Description: Specifies shared secret for Dynamic Client Registration</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dcrsignaturevalidationsoftwarestatementjwksclaim","title":"dcrSignatureValidationSoftwareStatementJwksClaim","text":"<ul> <li> <p>Description: Specifies claim name inside software statement. Value of claim should point to inlined JWKS</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dcrsignaturevalidationsoftwarestatementjwksuriclaim","title":"dcrSignatureValidationSoftwareStatementJwksURIClaim","text":"<ul> <li> <p>Description: Specifies claim name inside software statement. Value of claim should point to JWKS URI</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dcrssavalidationconfigs","title":"dcrSsaValidationConfigs","text":"<ul> <li> <p>Description: DCR SSA Validation configurations used to perform validation of SSA or DCR</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#defaultsignaturealgorithm","title":"defaultSignatureAlgorithm","text":"<ul> <li> <p>Description: The default signature algorithm to sign ID Tokens</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#defaultsubjecttype","title":"defaultSubjectType","text":"<ul> <li> <p>Description: The default subject type used for dynamic client registration</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#deviceauthzacr","title":"deviceAuthzAcr","text":"<ul> <li> <p>Description: Device authz acr</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#deviceauthzendpoint","title":"deviceAuthzEndpoint","text":"<ul> <li> <p>Description: URL for the Device Authorization</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#deviceauthzrequestexpiresin","title":"deviceAuthzRequestExpiresIn","text":"<ul> <li> <p>Description: Expiration time given for device authorization requests</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#deviceauthzresponsetypetoprocessauthz","title":"deviceAuthzResponseTypeToProcessAuthz","text":"<ul> <li> <p>Description: Response type used to process device authz requests</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#deviceauthztokenpollinterval","title":"deviceAuthzTokenPollInterval","text":"<ul> <li> <p>Description: Default interval returned to the client to process device token requests</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#disableauthnformaxagezero","title":"disableAuthnForMaxAgeZero","text":"<ul> <li> <p>Description: Boolean value specifying whether to disable authentication when max_age=0</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#disablejdklogger","title":"disableJdkLogger","text":"<ul> <li> <p>Description: Choose whether to disable JDK loggers</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: true</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#disablepromptconsent","title":"disablePromptConsent","text":"<ul> <li> <p>Description: Boolean value specifying whether to disable prompt=consent</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#disablepromptlogin","title":"disablePromptLogin","text":"<ul> <li> <p>Description: Boolean value specifying whether to disable prompt=login</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#disableu2fendpoint","title":"disableU2fEndpoint","text":"<ul> <li> <p>Description: Choose whether to disable U2F endpoints</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#discoveryallowedkeys","title":"discoveryAllowedKeys","text":"<ul> <li> <p>Description: List of configuration response claim allowed to be displayed in discovery endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#discoverycachelifetimeinminutes","title":"discoveryCacheLifetimeInMinutes","text":"<ul> <li> <p>Description: Lifetime of discovery cache</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: 60</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#discoverydenykeys","title":"discoveryDenyKeys","text":"<ul> <li> <p>Description: List of configuration response claims which must not be displayed in discovery endpoint response</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#displayvaluessupported","title":"displayValuesSupported","text":"<ul> <li> <p>Description: A list of the display parameter values that the OpenID Provider supports</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dnname","title":"dnName","text":"<ul> <li> <p>Description: DN of certificate issuer</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dpopjticachetime","title":"dpopJtiCacheTime","text":"<ul> <li> <p>Description: Demonstration of Proof-of-Possession (DPoP) cache time</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: 3600</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dpopnoncecachetime","title":"dpopNonceCacheTime","text":"<ul> <li> <p>Description: Demonstration of Proof-of-Possession (DPoP) nonce cache time</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: 3600</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dpopsigningalgvaluessupported","title":"dpopSigningAlgValuesSupported","text":"<ul> <li> <p>Description: Demonstration of Proof-of-Possession (DPoP) authorization signing algorithms supported</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dpoptimeframe","title":"dpopTimeframe","text":"<ul> <li> <p>Description: Demonstration of Proof-of-Possession (DPoP) timeout</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: 5</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dpopusenonce","title":"dpopUseNonce","text":"<ul> <li> <p>Description: Demonstration of Proof-of-Possession (DPoP) use nonce</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#granttypessupportedbydynamicregistration","title":"grantTypesSupportedByDynamicRegistration","text":"<ul> <li> <p>Description: This list details which OAuth 2.0 grant types can be set up with the client registration API</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dynamicregistrationallowedpasswordgrantscopes","title":"dynamicRegistrationAllowedPasswordGrantScopes","text":"<ul> <li> <p>Description: List of grant scopes for dynamic registration</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dynamicregistrationcustomattributes","title":"dynamicRegistrationCustomAttributes","text":"<ul> <li> <p>Description: This list details the custom attributes allowed for dynamic registration</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dynamicregistrationcustomobjectclass","title":"dynamicRegistrationCustomObjectClass","text":"<ul> <li> <p>Description: LDAP custom object class for dynamic registration</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dynamicregistrationdefaultcustomattributes","title":"dynamicRegistrationDefaultCustomAttributes","text":"<ul> <li> <p>Description: This map provides default custom attributes with values for dynamic registration</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dynamicregistrationexpirationtime","title":"dynamicRegistrationExpirationTime","text":"<ul> <li> <p>Description: Expiration time in seconds for clients created with dynamic registration, 0 or -1 means never expire</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: -1</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dynamicregistrationpasswordgranttypeenabled","title":"dynamicRegistrationPasswordGrantTypeEnabled","text":"<ul> <li> <p>Description: Boolean value specifying whether to enable Password Grant Type during Dynamic Registration</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dynamicregistrationpersistclientauthorizations","title":"dynamicRegistrationPersistClientAuthorizations","text":"<ul> <li> <p>Description: Boolean value specifying whether to persist client authorizations</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#dynamicregistrationscopesparamenabled","title":"dynamicRegistrationScopesParamEnabled","text":"<ul> <li> <p>Description: Boolean value specifying whether to enable scopes parameter in dynamic registration</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#enableclientgranttypeupdate","title":"enableClientGrantTypeUpdate","text":"<ul> <li> <p>Description: Choose if client can update Grant Type values</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#enabledoauthauditlogging","title":"enabledOAuthAuditLogging","text":"<ul> <li> <p>Description: enable OAuth Audit Logging</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#endsessionendpoint","title":"endSessionEndpoint","text":"<ul> <li> <p>Description: URL at the OP to which an RP can perform a redirect to request that the end user be logged out at the OP</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#endsessionwithaccesstoken","title":"endSessionWithAccessToken","text":"<ul> <li> <p>Description: Choose whether to accept access tokens to call end_session endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#errorhandlingmethod","title":"errorHandlingMethod","text":"<ul> <li> <p>Description: A list of possible error handling methods. Possible values: remote (send error back to RP), internal (show error page)</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: remote</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#errorreasonenabled","title":"errorReasonEnabled","text":"<ul> <li> <p>Description: Boolean value specifying whether to return detailed reason of the error from AS. Default value is false</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#expirationnotificatorenabled","title":"expirationNotificatorEnabled","text":"<ul> <li> <p>Description: Boolean value specifying whether expiration notificator is enabled (used to identify expiration for persistence that support TTL, like Couchbase)</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#expirationnotificatorintervalinseconds","title":"expirationNotificatorIntervalInSeconds","text":"<ul> <li> <p>Description: The expiration notificator interval in second</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#expirationnotificatormapsizelimit","title":"expirationNotificatorMapSizeLimit","text":"<ul> <li> <p>Description: The expiration notificator maximum size limit</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#externalloggerconfiguration","title":"externalLoggerConfiguration","text":"<ul> <li> <p>Description: The path to the external log4j2 logging configuration</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#externaluriwhitelist","title":"externalUriWhiteList","text":"<ul> <li> <p>Description: This list specifies which external URIs can be called by AS (if empty any URI can be called)</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#fapicompatibility","title":"fapiCompatibility","text":"<ul> <li> <p>Description: Boolean value specifying whether to turn on FAPI compatibility mode. If true AS behaves in more strict mode</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#featureflags","title":"featureFlags","text":"<ul> <li> <p>Description: List of enabled feature flags</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#forceidtokenhintpresence","title":"forceIdTokenHintPresence","text":"<ul> <li> <p>Description: Boolean value specifying whether force id_token_hint parameter presence</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#forceofflineaccessscopetoenablerefreshtoken","title":"forceOfflineAccessScopeToEnableRefreshToken","text":"<ul> <li> <p>Description: Boolean value specifying whether force offline_access scope to enable refresh_token grant type. Default value is true</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: true</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#forcesignedrequestobject","title":"forceSignedRequestObject","text":"<ul> <li> <p>Description: Boolean value true indicates that signed request object is mandatory</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#frontchannellogoutsessionsupported","title":"frontChannelLogoutSessionSupported","text":"<ul> <li> <p>Description: Choose whether to support front channel session logout</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#granttypesandresponsetypesautofixenabled","title":"grantTypesAndResponseTypesAutofixEnabled","text":"<ul> <li> <p>Description: Boolean value specifying whether to Grant types and Response types can be auto fixed</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#granttypessupported","title":"grantTypesSupported","text":"<ul> <li> <p>Description: This list details which OAuth 2.0 grant types are supported by this OP</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#httploggingenabled","title":"httpLoggingEnabled","text":"<ul> <li> <p>Description: Enable/disable request/response logging filter</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#httploggingexcludepaths","title":"httpLoggingExcludePaths","text":"<ul> <li> <p>Description: This list details the base URIs for which the request/response logging filter will not record activity</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#httploggingresponsebodycontent","title":"httpLoggingResponseBodyContent","text":"<ul> <li> <p>Description: Defines if Response body will be logged. Default value is false</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#idgenerationendpoint","title":"idGenerationEndpoint","text":"<ul> <li> <p>Description: ID Generation endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#idtokenencryptionalgvaluessupported","title":"idTokenEncryptionAlgValuesSupported","text":"<ul> <li> <p>Description: A list of the JWE encryption algorithms (alg values) supported by the OP for the ID Token to encode the Claims in a JWT</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#idtokenencryptionencvaluessupported","title":"idTokenEncryptionEncValuesSupported","text":"<ul> <li> <p>Description: A list of the JWE encryption algorithms (enc values) supported by the OP for the ID Token to encode the Claims in a JWT</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#idtokenfilterclaimsbasedonaccesstoken","title":"idTokenFilterClaimsBasedOnAccessToken","text":"<ul> <li> <p>Description: Boolean value specifying whether idToken filters claims based on accessToken</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#idtokenlifetime","title":"idTokenLifetime","text":"<ul> <li> <p>Description: The lifetime of the ID Token</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#idtokensigningalgvaluessupported","title":"idTokenSigningAlgValuesSupported","text":"<ul> <li> <p>Description: A list of the JWS signing algorithms (alg values) supported by the OP for the ID Token to encode the Claims in a JWT</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#idtokentokenbindingcnfvaluessupported","title":"idTokenTokenBindingCnfValuesSupported","text":"<ul> <li> <p>Description: Array containing a list of the JWT Confirmation Method member names supported by the OP for Token Binding of ID Tokens. The presence of this parameter indicates that the OpenID Provider supports Token Binding of ID Tokens. If omitted, the default is that the OpenID Provider does not support Token Binding of ID Tokens</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#imglocation","title":"imgLocation","text":"<ul> <li> <p>Description: The location for image files</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#includesidinresponse","title":"includeSidInResponse","text":"<ul> <li> <p>Description: Boolean value specifying whether to include sessionId in response</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#introspectionaccesstokenmusthaveintrospectionscope","title":"introspectionAccessTokenMustHaveIntrospectionScope","text":"<ul> <li> <p>Description: If True, rejects introspection requests if access_token does not have the 'introspection' scope in its authorization header. Comparing to 'uma_protection', 'introspection' scope is not allowed for dynamic registration'</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#introspectionaccesstokenmusthaveumaprotectionscope","title":"introspectionAccessTokenMustHaveUmaProtectionScope","text":"<ul> <li> <p>Description: If True, rejects introspection requests if access_token does not have the uma_protection scope in its authorization header</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#introspectionendpoint","title":"introspectionEndpoint","text":"<ul> <li> <p>Description: Introspection endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#introspectionresponsescopesbackwardcompatibility","title":"introspectionResponseScopesBackwardCompatibility","text":"<ul> <li> <p>Description: Boolean value specifying introspection response backward compatibility mode</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#introspectionscriptbackwardcompatibility","title":"introspectionScriptBackwardCompatibility","text":"<ul> <li> <p>Description: Boolean value specifying whether switch off client's introspection scripts (true value) and run all scripts that exists on server. Default value is false</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#introspectionskipauthorization","title":"introspectionSkipAuthorization","text":"<ul> <li> <p>Description: Specifies if authorization to be skipped for introspection</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#invalidatesessioncookiesafterauthorizationflow","title":"invalidateSessionCookiesAfterAuthorizationFlow","text":"<ul> <li> <p>Description: Boolean value to specify whether to invalidate session_id and consent_session_id cookies right after successful or unsuccessful authorization</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#issuer","title":"issuer","text":"<ul> <li> <p>Description: URL using the https scheme that OP asserts as Issuer identifier</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#jansid","title":"jansId","text":"<ul> <li> <p>Description: URL for the Inum generator Service</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#jansopenidconnectversion","title":"jansOpenIdConnectVersion","text":"<ul> <li> <p>Description: OpenID Connect Version</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#jmsbrokeruriset","title":"jmsBrokerURISet","text":"<ul> <li> <p>Description: JMS Broker URI Set</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#jmspassword","title":"jmsPassword","text":"<ul> <li> <p>Description: JMS Password</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#jmsusername","title":"jmsUserName","text":"<ul> <li> <p>Description: JMS UserName</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#jslocation","title":"jsLocation","text":"<ul> <li> <p>Description: The location for JavaScript files</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#jwksalgorithmssupported","title":"jwksAlgorithmsSupported","text":"<ul> <li> <p>Description: A list of algorithms that will be used in JWKS endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#jwksuri","title":"jwksUri","text":"<ul> <li> <p>Description: URL of the OP's JSON Web Key Set (JWK) document. This contains the signing key(s) the RP uses to validate signatures from the OP</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#keepauthenticatorattributesonacrchange","title":"keepAuthenticatorAttributesOnAcrChange","text":"<ul> <li> <p>Description: Boolean value specifying whether to keep authenticator attributes on ACR change</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#keyalgsallowedforgeneration","title":"keyAlgsAllowedForGeneration","text":"<ul> <li> <p>Description: List of algorithm allowed to be used for key generation</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#keyregenerationenabled","title":"keyRegenerationEnabled","text":"<ul> <li> <p>Description: Boolean value specifying whether to regenerate keys</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#keyregenerationinterval","title":"keyRegenerationInterval","text":"<ul> <li> <p>Description: The interval for key regeneration in hours</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#keyselectionstrategy","title":"keySelectionStrategy","text":"<ul> <li> <p>Description: Key Selection Strategy : OLDER, NEWER, FIRST</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: OLDER</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#keysignwithsamekeybutdiffalg","title":"keySignWithSameKeyButDiffAlg","text":"<ul> <li> <p>Description: Specifies if signing to be done with same key but apply different algorithms</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#keystorefile","title":"keyStoreFile","text":"<ul> <li> <p>Description: The Key Store File (JKS)</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#keystoresecret","title":"keyStoreSecret","text":"<ul> <li> <p>Description: The Key Store password</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#legacyidtokenclaims","title":"legacyIdTokenClaims","text":"<ul> <li> <p>Description: Choose whether to include claims in ID tokens</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#logclientidonclientauthentication","title":"logClientIdOnClientAuthentication","text":"<ul> <li> <p>Description: Choose if application should log the Client ID on client authentication</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#logclientnameonclientauthentication","title":"logClientNameOnClientAuthentication","text":"<ul> <li> <p>Description: Choose if application should log the Client Name on client authentication</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#logginglayout","title":"loggingLayout","text":"<ul> <li> <p>Description: Logging layout used for Jans Authorization Server loggers</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#logginglevel","title":"loggingLevel","text":"<ul> <li> <p>Description: Specify the logging level of loggers</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#lognotfoundentityaserror","title":"logNotFoundEntityAsError","text":"<ul> <li> <p>Description: Boolean value specifying whether to log not_found entity exception as error or as trace. Default value is false (trace).</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#metricreporterinterval","title":"metricReporterInterval","text":"<ul> <li> <p>Description: The interval for metric reporter in seconds</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#metricreporterkeepdatadays","title":"metricReporterKeepDataDays","text":"<ul> <li> <p>Description: The days to keep metric reported data</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#mtlsauthorizationendpoint","title":"mtlsAuthorizationEndpoint","text":"<ul> <li> <p>Description: URL for Mutual TLS (mTLS) Client Authentication and Certificate-Bound Access Tokens (MTLS) Endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#mtlschecksessioniframe","title":"mtlsCheckSessionIFrame","text":"<ul> <li> <p>Description: URL for Mutual TLS (mTLS) IFrame that supports cross-origin communications for session state information with the RP Client using the HTML5 postMessage API</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#mtlsclientinfoendpoint","title":"mtlsClientInfoEndpoint","text":"<ul> <li> <p>Description: URL for Mutual TLS (mTLS) Client Info endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#mtlsdeviceauthzendpoint","title":"mtlsDeviceAuthzEndpoint","text":"<ul> <li> <p>Description: Mutual TLS (mTLS) device authorization endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#mtlsendsessionendpoint","title":"mtlsEndSessionEndpoint","text":"<ul> <li> <p>Description: URL for Mutual TLS (mTLS) to which an RP can perform a redirect to request that the end user be logged out at the OP</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#mtlsidgenerationendpoint","title":"mtlsIdGenerationEndpoint","text":"<ul> <li> <p>Description: Mutual TLS (mTLS) ID generation endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#mtlsintrospectionendpoint","title":"mtlsIntrospectionEndpoint","text":"<ul> <li> <p>Description: Mutual TLS (mTLS) introspection endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#mtlsjwksuri","title":"mtlsJwksUri","text":"<ul> <li> <p>Description: URL for Mutual TLS (mTLS) of the OP's JSON Web Key Set (JWK) document</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#mtlsparendpoint","title":"mtlsParEndpoint","text":"<ul> <li> <p>Description: Mutual TLS (mTLS) Pushed Authorization Requests(PAR) endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#mtlsregistrationendpoint","title":"mtlsRegistrationEndpoint","text":"<ul> <li> <p>Description: Mutual TLS (mTLS) registration endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#mtlstokenendpoint","title":"mtlsTokenEndpoint","text":"<ul> <li> <p>Description: URL for Mutual TLS (mTLS) Authorization token Endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#mtlstokenrevocationendpoint","title":"mtlsTokenRevocationEndpoint","text":"<ul> <li> <p>Description: URL for Mutual TLS (mTLS) Authorization token revocation endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#mtlsuserinfoendpoint","title":"mtlsUserInfoEndpoint","text":"<ul> <li> <p>Description: Mutual TLS (mTLS) user info endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#openidconfigurationendpoint","title":"openIdConfigurationEndpoint","text":"<ul> <li> <p>Description: URL for the Open ID Connect Configuration Endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#openiddiscoveryendpoint","title":"openIdDiscoveryEndpoint","text":"<ul> <li> <p>Description: Discovery endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#openidscopebackwardcompatibility","title":"openidScopeBackwardCompatibility","text":"<ul> <li> <p>Description: Set to false to only allow token endpoint request for openid scope with grant type equals to authorization_code, restrict access to userinfo to scope openid and only return id_token if scope contains openid</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#openidsubattribute","title":"openidSubAttribute","text":"<ul> <li> <p>Description: Specifies which LDAP attribute is used for the subject identifier claim</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#oppolicyuri","title":"opPolicyUri","text":"<ul> <li> <p>Description: URL that the OpenID Provider provides to the person registering the Client to read about the OP's requirements on how the Relying Party can use the data provided by the OP</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#optosuri","title":"opTosUri","text":"<ul> <li> <p>Description: URL that the OpenID Provider provides to the person registering the Client to read about OpenID Provider's terms of service</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#pairwisecalculationkey","title":"pairwiseCalculationKey","text":"<ul> <li> <p>Description: Key to calculate algorithmic pairwise IDs</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#pairwisecalculationsalt","title":"pairwiseCalculationSalt","text":"<ul> <li> <p>Description: Salt to calculate algorithmic pairwise IDs</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#pairwiseidtype","title":"pairwiseIdType","text":"<ul> <li> <p>Description: the pairwise ID type</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#parendpoint","title":"parEndpoint","text":"<ul> <li> <p>Description: URL for Pushed Authorisation Request (PAR) Endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#persistidtoken","title":"persistIdToken","text":"<ul> <li> <p>Description: Specifies whether to persist id_token (otherwise saves into cache)</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#persistrefreshtoken","title":"persistRefreshToken","text":"<ul> <li> <p>Description: Specifies whether to persist refresh_token (otherwise saves into cache)</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: true</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#personcustomobjectclasslist","title":"personCustomObjectClassList","text":"<ul> <li> <p>Description: This list details LDAP custom object classes for dynamic person enrollment</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#publicsubjectidentifierperclientenabled","title":"publicSubjectIdentifierPerClientEnabled","text":"<ul> <li> <p>Description: Specifies whether public subject identifier is allowed per client</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#redirecturisregexenabled","title":"redirectUrisRegexEnabled","text":"<ul> <li> <p>Description: Enable/Disable redirect uris validation using regular expression</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#refreshtokenextendlifetimeonrotation","title":"refreshTokenExtendLifetimeOnRotation","text":"<ul> <li> <p>Description: Boolean value specifying whether to extend refresh tokens on rotation</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#refreshtokenlifetime","title":"refreshTokenLifetime","text":"<ul> <li> <p>Description: The lifetime of the Refresh Token</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#registrationendpoint","title":"registrationEndpoint","text":"<ul> <li> <p>Description: Registration endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#rejectendsessionifidtokenexpired","title":"rejectEndSessionIfIdTokenExpired","text":"<ul> <li> <p>Description: default value false. If true and id_token is not found in db, request is rejected</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#rejectjwtwithnonealg","title":"rejectJwtWithNoneAlg","text":"<ul> <li> <p>Description: Boolean value specifying whether reject JWT requested or validated with algorithm None. Default value is true</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: true</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#removerefreshtokensforclientonlogout","title":"removeRefreshTokensForClientOnLogout","text":"<ul> <li> <p>Description: Boolean value specifying whether to remove Refresh Tokens on logout. Default value is true</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: true</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#requestobjectencryptionalgvaluessupported","title":"requestObjectEncryptionAlgValuesSupported","text":"<ul> <li> <p>Description: A list of the JWE encryption algorithms (alg values) supported by the OP for Request Objects</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#requestobjectencryptionencvaluessupported","title":"requestObjectEncryptionEncValuesSupported","text":"<ul> <li> <p>Description: A list of the JWE encryption algorithms (enc values) supported by the OP for Request Objects</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#requestobjectsigningalgvaluessupported","title":"requestObjectSigningAlgValuesSupported","text":"<ul> <li> <p>Description: A list of the JWS signing algorithms (alg values) supported by the OP for Request Objects</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#requestparametersupported","title":"requestParameterSupported","text":"<ul> <li> <p>Description: Boolean value specifying whether the OP supports use of the request parameter</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#requesturiblocklist","title":"requestUriBlockList","text":"<ul> <li> <p>Description: Block list for requestUri that can come to Authorization Endpoint (e.g. localhost)</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#requesturihashverificationenabled","title":"requestUriHashVerificationEnabled","text":"<ul> <li> <p>Description: Boolean value specifying whether the OP supports use of the request_uri hash verification</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#requesturiparametersupported","title":"requestUriParameterSupported","text":"<ul> <li> <p>Description: Boolean value specifying whether the OP supports use of the request_uri parameter</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#requirepar","title":"requirePar","text":"<ul> <li> <p>Description: Boolean value to indicate of Pushed Authorisation Request(PAR)is required</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#requirepkce","title":"requirePkce","text":"<ul> <li> <p>Description: Boolean value true check for Proof Key for Code Exchange (PKCE)</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#requirerequestobjectencryption","title":"requireRequestObjectEncryption","text":"<ul> <li> <p>Description: Boolean value true encrypts request object</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#requirerequesturiregistration","title":"requireRequestUriRegistration","text":"<ul> <li> <p>Description: Boolean value specifying whether the OP requires any request_uri values used to be pre-registered using the request_uris registration parameter</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#responsemodessupported","title":"responseModesSupported","text":"<ul> <li> <p>Description: This list details which OAuth 2.0 response modes are supported by this OP</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#responsetypessupported","title":"responseTypesSupported","text":"<ul> <li> <p>Description: This list details which OAuth 2.0 response_type values are supported by this OP.</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: By default, every combination of code, token and id_token is supported.</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#returnclientsecretonread","title":"returnClientSecretOnRead","text":"<ul> <li> <p>Description: Boolean value specifying whether a client_secret is returned on client GET or PUT. Set to true by default which means to return secret</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#returndevicesecretfromauthzendpoint","title":"returnDeviceSecretFromAuthzEndpoint","text":"<ul> <li> <p>Description: </p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#rotateclientregistrationaccesstokenonusage","title":"rotateClientRegistrationAccessTokenOnUsage","text":"<ul> <li> <p>Description: Boolean value specifying whether to rotate client registration access token after each usage</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#rotatedevicesecret","title":"rotateDeviceSecret","text":"<ul> <li> <p>Description: </p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#sectoridentifiercachelifetimeinminutes","title":"sectorIdentifierCacheLifetimeInMinutes","text":"<ul> <li> <p>Description: Sector Identifier cache lifetime in minutes</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: 1440</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#serversessionidlifetime","title":"serverSessionIdLifetime","text":"<ul> <li> <p>Description: Dedicated property to control lifetime of the server side OP session object in seconds. Overrides sessionIdLifetime. By default value is 0, so object lifetime equals sessionIdLifetime (which sets both cookie and object expiration). It can be useful if goal is to keep different values for client cookie and server object</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#servicedocumentation","title":"serviceDocumentation","text":"<ul> <li> <p>Description: URL of a page containing human-readable information that developers might want or need to know when using the OpenID Provider</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#sessionidlifetime","title":"sessionIdLifetime","text":"<ul> <li> <p>Description: The lifetime of session id in seconds. If 0 or -1 then expiration is not set. session_id cookie expires when browser session ends</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#sessionidpersistincache","title":"sessionIdPersistInCache","text":"<ul> <li> <p>Description: Boolean value specifying whether to persist session_id in cache</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#sessionidpersistonpromptnone","title":"sessionIdPersistOnPromptNone","text":"<ul> <li> <p>Description: Boolean value specifying whether to persist session ID on prompt none</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#sessionidrequestparameterenabled","title":"sessionIdRequestParameterEnabled","text":"<ul> <li> <p>Description: Boolean value specifying whether to enable session_id HTTP request parameter</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#sessionidunauthenticatedunusedlifetime","title":"sessionIdUnauthenticatedUnusedLifetime","text":"<ul> <li> <p>Description: The lifetime for unused unauthenticated session states</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#sessionidunusedlifetime","title":"sessionIdUnusedLifetime","text":"<ul> <li> <p>Description: The lifetime for unused session states</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#sharesubjectidbetweenclientswithsamesectorid","title":"shareSubjectIdBetweenClientsWithSameSectorId","text":"<ul> <li> <p>Description: When true, clients with the same Sector ID also share the same Subject ID</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#skipauthenticationfilteroptionsmethod","title":"skipAuthenticationFilterOptionsMethod","text":"<ul> <li> <p>Description: Force Authentication Filtker to process OPTIONS request</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: true</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#skipauthorizationforopenidscopeandpairwiseid","title":"skipAuthorizationForOpenIdScopeAndPairwiseId","text":"<ul> <li> <p>Description: Choose whether to skip authorization if a client has an OpenId scope and a pairwise ID</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#skiprefreshtokenduringrefreshing","title":"skipRefreshTokenDuringRefreshing","text":"<ul> <li> <p>Description: Boolean value specifying whether to skip refreshing tokens on refreshing</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#softwarestatementvalidationclaimname","title":"softwareStatementValidationClaimName","text":"<ul> <li> <p>Description: Validation claim name for software statement</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#softwarestatementvalidationtype","title":"softwareStatementValidationType","text":"<ul> <li> <p>Description: Validation type used for software statement</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#spontaneousscopelifetime","title":"spontaneousScopeLifetime","text":"<ul> <li> <p>Description: The lifetime of spontaneous scope in seconds</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#ssaconfiguration","title":"ssaConfiguration","text":"<ul> <li> <p>Description: SSA Configuration</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#statauthorizationscope","title":"statAuthorizationScope","text":"<ul> <li> <p>Description: Scope required for Statistical Authorization</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#staticdecryptionkid","title":"staticDecryptionKid","text":"<ul> <li> <p>Description: Specifies static decryption Kid</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#statickid","title":"staticKid","text":"<ul> <li> <p>Description: Specifies static Kid</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#stattimerintervalinseconds","title":"statTimerIntervalInSeconds","text":"<ul> <li> <p>Description: Statistical data capture time interval</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#subjectidentifiersperclientsupported","title":"subjectIdentifiersPerClientSupported","text":"<ul> <li> <p>Description: A list of the subject identifiers supported per client</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#subjecttypessupported","title":"subjectTypesSupported","text":"<ul> <li> <p>Description: This list details which Subject Identifier types that the OP supports. Valid types include pairwise and public.</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#tokenendpoint","title":"tokenEndpoint","text":"<ul> <li> <p>Description: The token endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#tokenendpointauthmethodssupported","title":"tokenEndpointAuthMethodsSupported","text":"<ul> <li> <p>Description: A list of Client Authentication methods supported by this Token Endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#tokenendpointauthsigningalgvaluessupported","title":"tokenEndpointAuthSigningAlgValuesSupported","text":"<ul> <li> <p>Description: A list of the JWS signing algorithms (alg values) supported by the Token Endpoint for the signature on the JWT used to authenticate the Client at the Token Endpoint for the private_key_jwt and client_secret_jwt authentication methods</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#tokenrevocationendpoint","title":"tokenRevocationEndpoint","text":"<ul> <li> <p>Description: The URL for the access_token or refresh_token revocation endpoint</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#trustedclientenabled","title":"trustedClientEnabled","text":"<ul> <li> <p>Description: Boolean value specifying whether a client is trusted and no authorization is required</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#trustedssaissuers","title":"trustedSsaIssuers","text":"<ul> <li> <p>Description: List of trusted SSA issuers with configuration (e.g. automatically granted scopes).</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#uilocalessupported","title":"uiLocalesSupported","text":"<ul> <li> <p>Description: This list details the languages and scripts supported for the user interface</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#umaaddscopesautomatically","title":"umaAddScopesAutomatically","text":"<ul> <li> <p>Description: Add UMA scopes automatically if it is not registered yet</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#umaconfigurationendpoint","title":"umaConfigurationEndpoint","text":"<ul> <li> <p>Description: UMA Configuration endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#umagrantaccessifnopolicies","title":"umaGrantAccessIfNoPolicies","text":"<ul> <li> <p>Description: Specify whether to grant access to resources if there is no any policies associated with scopes</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#umapctlifetime","title":"umaPctLifetime","text":"<ul> <li> <p>Description: UMA PCT lifetime</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#umaresourcelifetime","title":"umaResourceLifetime","text":"<ul> <li> <p>Description: UMA Resource lifetime</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#umarestrictresourcetoassociatedclient","title":"umaRestrictResourceToAssociatedClient","text":"<ul> <li> <p>Description: Restrict access to resource by associated client</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#umarptasjwt","title":"umaRptAsJwt","text":"<ul> <li> <p>Description: Issue RPT as JWT or as random string</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#umarptlifetime","title":"umaRptLifetime","text":"<ul> <li> <p>Description: UMA RPT lifetime</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#umaticketlifetime","title":"umaTicketLifetime","text":"<ul> <li> <p>Description: UMA ticket lifetime</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#umavalidateclaimtoken","title":"umaValidateClaimToken","text":"<ul> <li> <p>Description: Validate claim_token as id_token assuming it is issued by local id</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#updateclientaccesstime","title":"updateClientAccessTime","text":"<ul> <li> <p>Description: Choose if application should update oxLastAccessTime/oxLastLogonTime attributes upon client authentication</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#updateuserlastlogontime","title":"updateUserLastLogonTime","text":"<ul> <li> <p>Description: Choose if application should update oxLastLogonTime attribute upon user authentication</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#usehighestlevelscriptifacrscriptnotfound","title":"useHighestLevelScriptIfAcrScriptNotFound","text":"<ul> <li> <p>Description: Enable/Disable usage of highest level script in case ACR script does not exist</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#uselocalcache","title":"useLocalCache","text":"<ul> <li> <p>Description: Cache in local memory cache attributes, scopes, clients and organization entry with expiration 60 seconds</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: false</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#usenestedjwtduringencryption","title":"useNestedJwtDuringEncryption","text":"<ul> <li> <p>Description: Boolean value specifying whether to use nested Jwt during encryption</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: true</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#userinfoencryptionalgvaluessupported","title":"userInfoEncryptionAlgValuesSupported","text":"<ul> <li> <p>Description: This JSON Array lists which JWS encryption algorithms (alg values) [JWA] can be used by for the UserInfo endpoint to encode the claims in a JWT</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#userinfoencryptionencvaluessupported","title":"userInfoEncryptionEncValuesSupported","text":"<ul> <li> <p>Description: This JSON Array lists which JWS encryption algorithms (enc values) [JWA] can be used by for the UserInfo endpoint to encode the claims in a JWT</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#userinfoendpoint","title":"userInfoEndpoint","text":"<ul> <li> <p>Description: The User Info endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#userinfosigningalgvaluessupported","title":"userInfoSigningAlgValuesSupported","text":"<ul> <li> <p>Description: This JSON Array lists which JWS signing algorithms (alg values) [JWA] can be used by for the UserInfo endpoint to encode the claims in a JWT</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#webkeysstorage","title":"webKeysStorage","text":"<ul> <li> <p>Description: Web Key Storage Type</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#connectionserviceconfiguration","title":"connectionserviceconfiguration","text":"<ul> <li> <p>Description: Group for HttpService2 network configuration</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#maxtotal","title":"maxtotal","text":"<ul> <li> <p>Description: Set the maximum number of total open connections</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: 200</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#maxperroute","title":"maxperroute","text":"<ul> <li> <p>Description: Set the maximum number of concurrent connections per route</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: 50</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/janssenauthserver-properties/#validateafterinactivity","title":"validateafterinactivity","text":"<ul> <li> <p>Description: Defines period of inactivity in milliseconds after which persistent connections must be re-validated prior to being leased to the consumer</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: 2000</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/","title":"SCIM Configuration Properties","text":"Property Name Description applicationUrl Application base URL Details baseDN Application config Base DN Details baseEndpoint SCIM base endpoint URL Details bulkMaxOperations Specifies maximum bulk operations Details bulkMaxPayloadSize Specifies maximum payload size of bulk operations Details disableJdkLogger Boolean value specifying whether to enable JDK Loggers Details externalLoggerConfiguration Path to external log4j2 logging configuration Details loggingLayout Logging layout used for Server loggers Details loggingLevel Logging level for scim logger Details maxCount Maximum number of results per page Details metricReporterEnabled Metric reported data enabled flag Details metricReporterInterval The interval for metric reporter in seconds Details metricReporterKeepDataDays The days to keep metric reported data Details oxAuthIssuer Jans Auth - Issuer identifier Details personCustomObjectClass Person Object Class Details protectionMode SCIM Protection Mode Details useLocalCache Boolean value specifying whether to enable local in-memory cache Details userExtensionSchemaURI User Extension Schema URI Details","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#applicationurl","title":"applicationUrl","text":"<ul> <li> <p>Description: Application base URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#basedn","title":"baseDN","text":"<ul> <li> <p>Description: Application config Base DN</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#baseendpoint","title":"baseEndpoint","text":"<ul> <li> <p>Description: SCIM base endpoint URL</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#bulkmaxoperations","title":"bulkMaxOperations","text":"<ul> <li> <p>Description: Specifies maximum bulk operations</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#bulkmaxpayloadsize","title":"bulkMaxPayloadSize","text":"<ul> <li> <p>Description: Specifies maximum payload size of bulk operations</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#disablejdklogger","title":"disableJdkLogger","text":"<ul> <li> <p>Description: Boolean value specifying whether to enable JDK Loggers</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#externalloggerconfiguration","title":"externalLoggerConfiguration","text":"<ul> <li> <p>Description: Path to external log4j2 logging configuration</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#logginglayout","title":"loggingLayout","text":"<ul> <li> <p>Description: Logging layout used for Server loggers</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#logginglevel","title":"loggingLevel","text":"<ul> <li> <p>Description: Logging level for scim logger</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#maxcount","title":"maxCount","text":"<ul> <li> <p>Description: Maximum number of results per page</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#metricreporterenabled","title":"metricReporterEnabled","text":"<ul> <li> <p>Description: Metric reported data enabled flag</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#metricreporterinterval","title":"metricReporterInterval","text":"<ul> <li> <p>Description: The interval for metric reporter in seconds</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#metricreporterkeepdatadays","title":"metricReporterKeepDataDays","text":"<ul> <li> <p>Description: The days to keep metric reported data</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#oxauthissuer","title":"oxAuthIssuer","text":"<ul> <li> <p>Description: Jans Auth - Issuer identifier</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#personcustomobjectclass","title":"personCustomObjectClass","text":"<ul> <li> <p>Description: Person Object Class</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#protectionmode","title":"protectionMode","text":"<ul> <li> <p>Description: SCIM Protection Mode</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#uselocalcache","title":"useLocalCache","text":"<ul> <li> <p>Description: Boolean value specifying whether to enable local in-memory cache</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/json/properties/scim-properties/#userextensionschemauri","title":"userExtensionSchemaURI","text":"<ul> <li> <p>Description: User Extension Schema URI</p> </li> <li> <p>Required: No</p> </li> <li> <p>Default value: None</p> </li> </ul>","tags":["administration","reference","json","properties"]},{"location":"janssen-server/reference/kubernetes/","title":"Kubernetes","text":"<p>This Reference guide helps you learn about the components and architecture of Janssen.</p>","tags":["administration","reference","kubernetes","architecture","components"]},{"location":"janssen-server/reference/kubernetes/#janssen-components","title":"Janssen components","text":"<ul> <li>auth-server: The OAuth Authorization Server, the OpenID Connect Provider, the UMA Authorization Server--this is the main Internet facing component of Janssen. It's the service that returns tokens, JWT's and identity assertions. This service must be Internet facing.</li> <li>auth-key-rotation: Responsible for regenerating auth-keys per x hours.</li> <li>config-api: The API to configure the auth-server and other components is consolidated in this component. This service should not be Internet-facing.</li> <li>Fido: Provides the server side endpoints to enroll and validate devices that use FIDO. It provides both FIDO U2F (register, authenticate) and FIDO 2 (attestation, assertion) endpoints. This service must be internet facing.</li> <li>SCIM: a JSON/REST API to manage user data. Use it to add, edit and update user information. This service should not be Internet facing.</li> <li>Casa: self-service web portal for end-users to manage authentication and authorization preferences for their account in a Jannsen Server.</li> </ul>","tags":["administration","reference","kubernetes","architecture","components"]},{"location":"janssen-server/reference/kubernetes/#image-references","title":"Image references","text":"Image jans-all-in-one jans-auth-server jans-casa jans-cloudtools jans-config-api jans-configurator jans-fido2 jans-monolith jans-persistence jans-saml jans-scim","tags":["administration","reference","kubernetes","architecture","components"]},{"location":"janssen-server/reference/kubernetes/#helm-chart-references","title":"Helm Chart references","text":"Helm Chart All In One Chart Microservices Chart","tags":["administration","reference","kubernetes","architecture","components"]},{"location":"janssen-server/reference/kubernetes/#architectural-diagram-of-janssen","title":"Architectural diagram of Janssen","text":"","tags":["administration","reference","kubernetes","architecture","components"]},{"location":"janssen-server/reference/kubernetes/config-secret-keys/","title":"Configmap and Secret Configuration Keys","text":"<p>The <code>config</code> job creates a set of configurations (contains <code>secrets</code> and <code>configmaps</code>) used by all Janssen services.</p> <p>Note</p> <p>We assume Janssen is installed in a namespace called <code>jans</code></p>","tags":["administration","reference","kubernetes","configmap","secret"]},{"location":"janssen-server/reference/kubernetes/config-secret-keys/#configmaps","title":"Configmaps","text":"<p>The <code>configmaps</code> store non-sensitive data as key-value pairs.</p> <p>To check the values of the configmaps on the current deployment run:</p> <pre><code>kubectl get configmap -n jans -o yaml\n</code></pre> <p>Note that each key in configmaps is based on the schema below:</p> <pre><code>{\n  \"city\": {\n    \"type\": \"string\",\n    \"description\": \"Locality name (e.g. city)\",\n    \"example\": \"Austin\"\n  },\n  \"country_code\": {\n    \"type\": \"string\",\n    \"minLength\": 2,\n    \"maxLength\": 2,\n    \"description\": \"Country name (2 letter code)\",\n    \"example\": \"US\"\n  },\n  \"admin_email\": {\n    \"type\": \"string\",\n    \"format\": \"email\",\n    \"description\": \"Email address\",\n    \"example\": \"support@jans.io\"\n  },\n  \"hostname\": {\n    \"type\": \"string\",\n    \"description\": \"Fully qualified domain name (FQDN)\",\n    \"example\": \"demoexample.jans.io\"\n  },\n  \"orgName\": {\n    \"type\": \"string\",\n    \"description\": \"Organization name\",\n    \"example\": \"Janssen\"\n  },\n  \"state\": {\n    \"type\": \"string\",\n    \"description\": \"State or Province Name\",\n    \"example\": \"TX\"\n  },\n  \"optional_scopes\": {\n    \"type\": \"string\",\n    \"default\": \"[]\",\n    \"description\": \"List of optional scopes of components as string\",\n    \"example\": \"[\\\"redis\\\", \\\"sql\\\"]\"\n  },\n  \"auth_sig_keys\": {\n    \"type\": \"string\",\n    \"default\": \"RS256 RS384 RS512 ES256 ES384 ES512 PS256 PS384 PS512\",\n    \"description\": \"Signature keys to generate\",\n    \"example\": \"RS256 RS384 RS512 ES256 ES384 ES512 PS256 PS384 PS512\"\n  },\n  \"auth_enc_keys\": {\n    \"type\": \"string\",\n    \"default\": \"RSA1_5 RSA-OAEP ECDH-ES\",\n    \"description\": \"Encryption keys to generate\",\n    \"example\": \"RSA1_5 RSA-OAEP ECDH-ES\"\n  },\n  \"init_keys_exp\": {\n    \"type\": \"integer\",\n    \"default\": 48,\n    \"minimum\": 1,\n    \"description\": \"Initial expiration time (in hours) for generated keys\",\n    \"example\": 24\n  },\n  \"admin_inum\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Inum for admin user\",\n    \"example\": \"631e2b84-1d3d-4f28-9a9a-026a25febf44\"\n  },\n  \"admin_ui_client_id\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client ID of admin-ui app\",\n    \"example\": \"631e2b84-1d3d-4f28-9a9a-026a25febf44\"\n  },\n  \"casa_client_id\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client ID of jans-casa app\",\n    \"example\": \"1902.66bc89a1-075f-4a18-9349-a2908c1040e6\"\n  },\n  \"jans_idp_client_id\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client ID of jans-idp app\",\n    \"example\": \"jans-f13013e3-e4a7-4709-8b50-df459f489cd3\"\n  },\n  \"jca_client_id\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client ID of jans-config-api app\",\n    \"example\": \"1800.ca41fad2-6ab6-46b1-b4a9-3387992a8cb0\"\n  },\n  \"scim_client_id\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client ID of jans-scim app\",\n    \"example\": \"1201.dd7e7733-b548-45ee-aed1-74e7b4065801\"\n  },\n  \"tui_client_id\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client ID of jans-tui app\",\n    \"example\": \"2000.4a67fad3-24cd-4d56-b5a3-7cfb2e9fbb05\"\n  },\n  \"test_client_id\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client ID of test app\",\n    \"example\": \"174143d2-f7f6-4bda-baa0-a6a8fd01b77a\"\n  },\n  \"kc_master_auth_client_id\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client ID of Keycloak master auth app\",\n    \"example\": \"2103.22abf39d-f78f-4fb0-871e-dcb80bc1e43c\"\n  },\n  \"kc_saml_openid_client_id\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client ID of Keycloak SAML OpenID app\",\n    \"example\": \"2101.70394974-82ec-481e-9493-e96d3cf8072f\"\n  },\n  \"kc_scheduler_api_client_id\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client ID of Keycloak scheduler API app\",\n    \"example\": \"2102.d424af33-2069-4803-8426-4787af5fd933\"\n  },\n  \"token_server_admin_ui_client_id\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client ID of token server app\",\n    \"example\": \"631e2b84-1d3d-4f28-9a9a-026a25febf44\"\n  },\n  \"auth_key_rotated_at\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Timestamp of last auth keys regeneration\",\n    \"example\": \"631e2b84-1d3d-4f28-9a9a-026a25febf44\"\n  },\n  \"auth_legacyIdTokenClaims\": {\n    \"type\": \"string\",\n    \"default\": \"false\",\n    \"enum\": [\n      \"false\",\n      \"true\"\n    ],\n    \"description\": \"Enable legacy ID token claim\",\n    \"example\": \"false\"\n  },\n  \"auth_openidScopeBackwardCompatibility\": {\n    \"type\": \"string\",\n    \"default\": \"false\",\n    \"enum\": [\n      \"false\",\n      \"true\"\n    ],\n    \"description\": \"Enable backward-compat OpenID scope\",\n    \"example\": \"false\"\n  },\n  \"auth_openid_jks_fn\": {\n    \"type\": \"string\",\n    \"default\": \"/etc/certs/auth-keys.jks\",\n    \"description\": \"Path to keystore file contains private keys for jans-auth\"\n  },\n  \"auth_openid_jwks_fn\": {\n    \"type\": \"string\",\n    \"default\": \"/etc/certs/auth-keys.json\",\n    \"description\": \"Path to JSON file contains public keys for jans-auth\"\n  },\n  \"default_openid_jks_dn_name\": {\n    \"type\": \"string\",\n    \"default\": \"CN=Janssen Auth CA Certificates\",\n    \"description\": \"CommonName for jans-auth CA certificate\"\n  },\n  \"kc_admin_username\": {\n    \"type\": \"string\",\n    \"default\": \"admin\",\n    \"description\": \"Admin username of Keycloak\",\n    \"example\": \"admin\"\n  },\n  \"smtp_alias\": {\n    \"type\": \"string\",\n    \"default\": \"smtp_sig_ec256\",\n    \"description\": \"Alias for SMTP entry in truststore\",\n    \"example\": \"smtp_sig_ec256\"\n  },\n  \"smtp_signing_alg\": {\n    \"type\": \"string\",\n    \"default\": \"SHA256withECDSA\",\n    \"description\": \"SMTP signing algorithm\",\n    \"example\": \"SHA256withECDSA\"\n  }\n}\n</code></pre>","tags":["administration","reference","kubernetes","configmap","secret"]},{"location":"janssen-server/reference/kubernetes/config-secret-keys/#secrets","title":"Secrets","text":"<p>The <code>secrets</code> store sensitive data as key-value pairs.</p> <p>To check the values of the secrets on the current deployment run :</p> <pre><code>kubectl get secret -n jans -o yaml\n</code></pre> <p>Note that each key in secrets is based on the schema below:</p> <pre><code>{\n  \"admin_password\": {\n    \"type\": \"string\",\n    \"description\": \"Password for admin user\"\n  },\n  \"sql_password\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Password for SQL (RDBMS) user\"\n  },\n  \"encoded_salt\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Salt for encoding/decoding sensitive secret\",\n    \"example\": \"hR8kBUtTxB25pDPCSHVRktAz\"\n  },\n  \"google_credentials\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"String contains Google application credentials\",\n    \"example\": \"{\\n  \\\"type\\\": \\\"service_account\\\",\\n  \\\"project_id\\\": \\\"testing-project\\\"\\n}\\n\"\n  },\n  \"aws_credentials\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"String contains AWS shared credentials\",\n    \"example\": \"[default]\\naws_access_key_id = FAKE_ACCESS_KEY_ID\\naws_secret_access_key = FAKE_SECRET_ACCESS_KEY\\n\"\n  },\n  \"aws_config\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"String contains AWS config\",\n    \"example\": \"[default]\\nregion = us-west-1\\n\"\n  },\n  \"aws_replica_regions\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"String contains AWS replica regions config\",\n    \"example\": \"[{\\\"Region\\\": \\\"us-west-1\\\"}, {\\\"Region\\\": \\\"us-west-2\\\"}]\\n\"\n  },\n  \"vault_role_id\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Vault RoleID\"\n  },\n  \"vault_secret_id\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Vault SecretID\"\n  },\n  \"kc_db_password\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Password for Keycloak RDBMS user\"\n  },\n  \"admin_ui_client_encoded_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Encoded password for admin-ui client\",\n    \"x-encoding\": \"3DES\"\n  },\n  \"admin_ui_client_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Password for admin-ui client\"\n  },\n  \"auth_jks_base64\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Private keys (keystore) of jans-auth\"\n  },\n  \"auth_openid_jks_pass\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Password of jans-auth keystore\"\n  },\n  \"auth_openid_key_base64\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Public keys (JWKS) of jans-auth\"\n  },\n  \"casa_client_encoded_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Encoded password for jans-casa client\",\n    \"x-encoding\": \"3DES\"\n  },\n  \"casa_client_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Password for jans-casa client\"\n  },\n  \"encoded_admin_password\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Encoded password of admin\",\n    \"x-encoding\": \"ldap_encode\"\n  },\n  \"jans_idp_client_secret\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client secret of jans-idp app\"\n  },\n  \"jans_idp_user_password\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"User password for jans-idp\"\n  },\n  \"jca_client_encoded_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Encoded password for jans-config-api client\",\n    \"x-encoding\": \"3DES\"\n  },\n  \"jca_client_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Password for jans-config-api client\"\n  },\n  \"kc_admin_password\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Admin password of Keycloak\"\n  },\n  \"kc_master_auth_client_encoded_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client encoded secret of Keycloak master auth app\",\n    \"x-encoding\": \"3DES\"\n  },\n  \"kc_master_auth_client_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client secret of Keycloak master auth app\"\n  },\n  \"kc_saml_openid_client_encoded_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client encoded secret of Keycloak SAML app\",\n    \"x-encoding\": \"3DES\"\n  },\n  \"kc_saml_openid_client_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client secret of Keycloak SAML app\"\n  },\n  \"kc_scheduler_api_client_encoded_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client encoded secret of Keycloak scheduler API app\",\n    \"x-encoding\": \"3DES\"\n  },\n  \"kc_scheduler_api_client_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Client secret of Keycloak scheduler API app\"\n  },\n  \"otp_configuration\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"OTP configuration string\"\n  },\n  \"pairwiseCalculationKey\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Pairwise calculation key\"\n  },\n  \"pairwiseCalculationSalt\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Pairwise calculation salt\"\n  },\n  \"scim_client_encoded_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Encoded password for jans-scim client\",\n    \"x-encoding\": \"3DES\"\n  },\n  \"scim_client_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Password for jans-scim client\"\n  },\n  \"smtp_jks_base64\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Private keys (keystore) of SMTP\"\n  },\n  \"smtp_jks_pass\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Password of SMTP keystore\"\n  },\n  \"smtp_jks_pass_enc\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Encoded password of SMTP keystore\"\n  },\n  \"ssl_ca_cert\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"SSL certificate for CA\"\n  },\n  \"ssl_ca_key\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"SSL key for CA\"\n  },\n  \"ssl_cert\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"SSL certificate for the FQDN\"\n  },\n  \"ssl_csr\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"SSL certificate signing request for the FQDN\"\n  },\n  \"ssl_key\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"SSL key for the FQDN\"\n  },\n  \"super_gluu_creds\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"SuperGluu credentials string\"\n  },\n  \"test_client_encoded_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Encoded password for test client\",\n    \"x-encoding\": \"3DES\"\n  },\n  \"test_client_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Password for test client\"\n  },\n  \"token_server_admin_ui_client_encoded_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Encoded password for token server client\",\n    \"x-encoding\": \"3DES\"\n  },\n  \"token_server_admin_ui_client_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Password for token server client\"\n  },\n  \"tui_client_encoded_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Encoded password for TUI client\",\n    \"x-encoding\": \"3DES\"\n  },\n  \"tui_client_pw\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Password for TUI client\"\n  },\n  \"redis_password\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"Password for Redis user\"\n  },\n  \"sql_ssl_ca_cert\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"SSL root (CA) certificate for the SQL persistence\"\n  },\n  \"sql_ssl_client_cert\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"SSL client certificate for the SQL persistence\"\n  },\n  \"sql_ssl_client_key\": {\n    \"type\": \"string\",\n    \"default\": \"\",\n    \"description\": \"SSL client key for the SQL persistence\"\n  }\n}\n</code></pre>","tags":["administration","reference","kubernetes","configmap","secret"]},{"location":"janssen-server/reference/kubernetes/config-secret-keys/#example-decoding-secrets","title":"Example decoding secrets","text":"","tags":["administration","reference","kubernetes","configmap","secret"]},{"location":"janssen-server/reference/kubernetes/config-secret-keys/#opening-base64-decoded-secrets","title":"Opening <code>base64-decoded</code> secrets","text":"<ol> <li> <p>Get the <code>tls-certificate</code> from the backend secret</p> <pre><code>kubectl get secret tls-certificate -n jans -o yaml\n</code></pre> </li> <li> <p>Copy the value of the key you want to decode. For example:     <pre><code>data:\n  tls.crt: &lt;encodedValue&gt;\n</code></pre></p> </li> <li> <p>Base64 decode the value</p> <pre><code>echo &lt;encodedValue&gt; | base64 -d #replace encodedValue with the value from the previous command\n</code></pre> </li> </ol>","tags":["administration","reference","kubernetes","configmap","secret"]},{"location":"janssen-server/reference/kubernetes/config-secret-keys/#using-configuration-schema","title":"Using Configuration Schema","text":"<p>As mentioned earlier, the <code>config</code> job creates a set of configurations.</p> <p>This happens by using a Kubernetes secret named <code>&lt;janssen-release-name&gt;-configuration-file</code> that gets created during the helm chart installation.</p> <p>It contains a JSON schema with the necessary <code>secrets</code> and <code>configmaps</code> to install Janssen services.</p> <p>This secret is then mounted by the <code>config</code> job.</p>","tags":["administration","reference","kubernetes","configmap","secret"]},{"location":"janssen-server/reference/kubernetes/config-secret-keys/#default-configuration","title":"Default configuration","text":"<pre><code>apiVersion: v1\nkind: Secret\nmetadata:\n  name: janssen-configuration-file\n  namespace: jans\n  labels:\n    APP_NAME: configurator\ntype: Opaque\nstringData:\n  configuration.json: |-\n    {\n      \"_configmap\": {\n        \"hostname\": \"demoexample.jans.io\",\n        \"country_code\": \"US\",\n        \"state\": \"TX\",\n        \"city\": \"Austin\",\n        \"admin_email\": \"support@jans.io\",\n        \"orgName\": \"Janssen\",\n        \"auth_sig_keys\": \"RS256 RS384 RS512 ES256 ES384 ES512 PS256 PS384 PS512\",\n        \"auth_enc_keys\": \"RSA1_5 RSA-OAEP ECDH-ES\",\n        \"optional_scopes\": \"[\\\"redis\\\", \\\"sql\\\"]\",\n        \"init_keys_exp\": 48\n      },\n      \"_secret\": {\n        \"admin_password\": \"Test1234#\",\n        \"sql_password\": \"Test1234#\",\n        \"encoded_salt\": \"hR8kBUtTxB25pDPCSHVRktAz\"\n      }\n    }\n</code></pre> <p>Note that\u00a0<code>_secret</code>\u00a0may contain other keys depending on the persistence used, the backend of the secrets/configmaps, etc. For example:</p> <ol> <li> <p>Secrets/configmaps backend is set to <code>google</code>:</p> <pre><code>\"_secret\": {\n    \"google_credentials\": \"{\\n  \\\"type\\\": \\\"service_account\\\",\\n  \\\"project_id\\\": \\\"testing-project\\\"\\n}\"\n}\n</code></pre> </li> <li> <p>Secrets backend is set to <code>vault</code>:</p> <pre><code>\"_secret\": {\n    \"vault_role_id\": \"c41a15f4-abcd-1234-abcd-d306bf9f3eb6\",\n    \"vault_secret_id\": \"a7ae191c-abcd-1234-abcd-3733dc6b0813\"\n}\n</code></pre> </li> <li> <p>Secrets/configmaps backend is set to <code>aws</code>:</p> <pre><code>\"_secret\": {\n    \"aws_config\": \"[default]\\nregion = us-west-1\\n\",\n    \"aws_credentials\": \"[default]\\naws_access_key_id = FAKE_ACCESS_KEY_ID\\naws_secret_access_key = FAKE_SECRET_ACCESS_KEY\\n\",\n    \"aws_replica_regions\": \"[{\\\"Region\\\": \\\"us-west-1\\\"}, {\\\"Region\\\": \\\"us-west-2\\\"}]\\n\"\n}\n</code></pre> </li> </ol>","tags":["administration","reference","kubernetes","configmap","secret"]},{"location":"janssen-server/reference/kubernetes/config-secret-keys/#custom-configuration","title":"Custom configuration","text":"<p>The default configuration schema is sufficient for most of the time. However, if there's a requirement to use a custom configuration or reusing an existing configuration, you can create a Kubernetes secret with the custom configuration schema.</p> <p>Warning</p> <p>The custom configuration schema is a BETA feature.</p> <ol> <li> <p>Prepare the YAML file containing the custom configuration schema. We will name it <code>custom-configuration-schema.yaml</code>:</p> <pre><code>apiVersion: v1\nkind: Secret\nmetadata:\n  name: custom-configuration-schema\n  namespace: jans\ntype: Opaque\nstringData:\n  configuration.json: |-\n    {\n      \"_configmap\": {\n        \"hostname\": \"demoexample.jans.io\",\n        \"country_code\": \"US\",\n        \"state\": \"TX\",\n        \"city\": \"Houston\",\n        \"admin_email\": \"custom@example.com\",\n        \"orgName\": \"custom-org\",\n        \"optional_scopes\": \"[\\\"sql\\\"]\"\n      },\n      \"_secret\": {\n        \"admin_password\": \"Custom1234#\",\n        \"sql_password\": \"Custom1234#\"\n      }\n    }\n</code></pre> </li> <li> <p>Create the Kubernetes secret:</p> <pre><code>kubectl -n jans apply -f custom-configuration-schema.yaml\n</code></pre> </li> <li> <p>Specify the secret in <code>values.yaml</code>:</p> <pre><code>global:\n  cnConfiguratorCustomSchema:\n    secretName: custom-configuration-schema\n</code></pre> </li> <li> <p>Install the Janssen helm chart.</p> </li> </ol>","tags":["administration","reference","kubernetes","configmap","secret"]},{"location":"janssen-server/reference/kubernetes/config-secret-keys/#encrypting-configuration-schema","title":"Encrypting Configuration Schema","text":"<p>The encryption uses Helm-specific implementation of AES-256 CBC mode.</p>","tags":["administration","reference","kubernetes","configmap","secret"]},{"location":"janssen-server/reference/kubernetes/config-secret-keys/#default-configuration_1","title":"Default configuration","text":"<p>The default configuration schema can be encrypted by specifying 32 alphanumeric characters to <code>cnConfiguratorKey</code> attribute (the default value is an empty string).</p> <pre><code>global:\n  cnConfiguratorKey: \"VMtVyFha8CfppdDGQSw8zEnfKXRvksAD\"\n</code></pre> <p>The following example is what an encrypted default configuration looks like:</p> <pre><code>apiVersion: v1\nkind: Secret\nmetadata:\n  name: janssen-configuration-file\n  namespace: jans\nstringData:\n  configuration.json: |-\n    sxySo+redacted+generated+by+helm/TNpE5PoUR2+JxXiHiLq8X5ibexJcfjAN0fKlqRvU=\n</code></pre>","tags":["administration","reference","kubernetes","configmap","secret"]},{"location":"janssen-server/reference/kubernetes/config-secret-keys/#custom-configuration_1","title":"Custom configuration","text":"<p>If you are using a custom configuration schema, you will need to generate the string using sprig-aes CLI and paste it into a YAML manifest.</p> <pre><code># custom-configuration-schema.yaml\napiVersion: v1\nkind: Secret\nmetadata:\n  name: custom-configuration-schema\n  namespace: jans\ntype: Opaque\nstringData:\n  configuration.json: |-\n    sxySo+redacted+generated+by+sprigaes+JxXiHiLq8X5ibexJcfjAN0fKlqRvU=\n</code></pre> <p>Add the <code>key</code> used when encrypting using sprig-aes.</p> <pre><code>global:\n  cnConfiguratorKey: \"VMtVyFha8CfppdDGQSw8zEnfKXRvksAD\"\n</code></pre>","tags":["administration","reference","kubernetes","configmap","secret"]},{"location":"janssen-server/scim/","title":"SCIM Admin Guide","text":"<p>System for Cross-domain Identity Management, in short SCIM, is a specification that simplifies the exchange of user identity information across different domains. The Janssen Server provides an implementation for the SCIM specification.</p> <p>The specification defines reference schemas for users and groups along with REST API to manage them. For more details, refer to the current version of the specification governed by the following documents: RFC 7642, RFC 7643, and RFC 7644.</p> <p>Developers can think of SCIM merely as a REST API with endpoints exposing CRUD functionality (create, read, update, and delete).</p> <p>This section covers how to configure, protect, and monitor the Janssen Server SCIM module and its APIs.</p>","tags":["administration","scim"]},{"location":"janssen-server/scim/#installation","title":"Installation","text":"<p>The API is available as a component of the Janssen Server. Upon installation you can select if you want SCIM included in your environment. To add SCIM post-install do the following:</p> Command<pre><code>python3 /opt/jans/jans-setup/setup.py --install-scim\n</code></pre>","tags":["administration","scim"]},{"location":"janssen-server/scim/#about-api-endpoints","title":"About API endpoints","text":"<p>Throughout this document, you will notice endpoints are prefixed with path: <code>/jans-scim/restv1/v2</code></p>","tags":["administration","scim"]},{"location":"janssen-server/scim/#api-protection","title":"API Protection","text":"<p>Clearly, this API must not be anonymously accessed. However, the basic SCIM standard does not define a specific mechanism to prevent unauthorized requests to endpoints. There are just a few guidelines in section 2 of RFC 7644 concerned with authentication and authorization.</p> <ul> <li>OAUTH, This is the default and recommended mechanism</li> <li>BYPASS</li> </ul> <p>To know more about OAuth protection mode please visit here. The SCIM API endpoints are by default protected by (Bearer) OAuth 2.0 tokens. Depending on the operation, these tokens must have certain scopes for the operations to be authorized. We need a client to get Bearer token.</p>","tags":["administration","scim"]},{"location":"janssen-server/scim/#api-documentation-at-a-glance","title":"API documentation at a glance","text":"<p>SCIM API doc page describes about our implementation of SCIM. The API has also been documented using OpenAPI (swagger) specification for the interested.</p>","tags":["administration","scim"]},{"location":"janssen-server/scim/#potential-performance-issues-with-group-endpoints","title":"Potential performance issues with Group endpoints","text":"<p>In SCIM a group resource basically consists of an identifier, a display name, and a collection of members associated to it. Also, every member is made up of a user identifier, his display name, and other attributes. As a consequence, retrieving group information requires making a correlation with existing user data. Since Gluu database model does not follow a relational database pattern this may entail a considerable amount of user queries when groups contain thousands of members.</p> <p>While this could have been workarounded by storing members' display names inside group entries, this brings additional problems to deal with.</p> <p>Another source of potential overhead stems from creation and modification of groups where many new users are associated to a given group: by default checks are made to guarantee only existing users are attached to groups, thus requiring continuous database queries.</p> <p>Currently there are two ways to lower the amount of database lookups required for SCIM group operations:</p> <ul> <li>Explicitly excluding display names from responses</li> <li>Pass the overhead bypass flag to skip members validations</li> </ul> <p>The first approach consists of using the query parameter <code>excludedAttributes</code> (see RFC 7644) so that display names are neither retrieved from database nor sent in responses. A value like <code>members.display</code> does the job. Note the query parameter attributes can also be used for this purpose, for example with a value like <code>members.value</code> that will output only members' identifiers and ignore other non-required attributes.</p> <p>This approach is particularly useful in search and retrievals when users' display names are not needed.</p> <p>The second is a stronger approach that turns off validation of incoming members data: if the usage of a POST/PUT/PATCH operation implies adding members, their existence is not verified, they will simply get added. Here, the client application is responsible for sending accurate data. To use this approach add a query or header parameter named <code>Group-Overhead-Bypass</code> with any value. Note under this mode of operation:</p> <ul> <li>Display names are never returned regardless of <code>attributes</code> or <code>excludedAttributes</code> parameters values</li> <li>Remove/replace patch operations that involve display names in path filters are ignored, eg: <code>\"path\": \"members[value eq \\\"2819c223\\\" or display eq \\\"Joe\\\"]\"</code></li> </ul>","tags":["administration","scim"]},{"location":"janssen-server/scim/#user-registration-process-with-scim","title":"User Registration Process with SCIM","text":"<p>SCIM service has many use cases. One interesting and often arising is that of coding your own user registration process. With your SCIM endpoints you can build a custom application to maintain user entries in your database.</p>","tags":["administration","scim"]},{"location":"janssen-server/scim/#important-considerations","title":"Important Considerations","text":"<p>Here, you have some useful tips before you start:</p> <ol> <li> <p>Choose a toolset you feel comfortable to work with. Keep in mind that you have to leverage the capabilities of your language/framework to issue complex HTTPS requests. Be sure that:</p> <ul> <li> <p>You will be able to use at least the following verbs: GET, POST, PUT, and DELETE</p> </li> <li> <p>You can send headers in your requests as well as reading them from the service response</p> </li> </ul> </li> <li> <p>If not supported natively, choose a library to facilitate JSON content manipulation. As you have already noticed we have been dealing with JSON for requests as well as for responses. Experience shows that being able to map from objects (or data structures) of your language to Json and viceversa helps saving hours of coding.</p> </li> <li> <p>Shape your data model early. List the attributes your application will operate upon and correlate with those found in the SCIM user schema. You can learn about the schema in RFC 7644. At least, take a look at the JSON-formatted schema that your Jans Server shows: visit <code>https://&lt;host-name&gt;/jans-scim/restv1/v2/Schemas/urn:ietf:params:scim:schemas:core:2.0:User</code></p> </li> <li> <p>You will have to manipulate database contents very often as you develop and run tests, thus, find a suitable tool for the task. In the case of LDAP, a TUI client is a good choice.</p> </li> <li> <p>Always check your logs.</p> </li> <li> <p>In this user management guide with SCIM, we have already touched upon the fundamentals of SCIM in Jans Server and shown a good amount of sample requests for manipulation of user information. However, keep in mind the SCIM spec documents are definitely the key reference to build working request messages, specially RFC 7643, and RFC 7644.</p> </li> </ol>","tags":["administration","scim"]},{"location":"janssen-server/scim/bulk-users/","title":"Bulk Adding Users via SCIM","text":"","tags":["administration","scim","bulk-users"]},{"location":"janssen-server/scim/bulk-users/#adding-user-in-bulk","title":"Adding user in bulk","text":"<p>SCIM supports a bulk operation allowing consumers of the service to send multiple resource operations in a single request. This means the body of a bulk operation may contain one or more operations belonging to any of the supported HTTP verbs, e.g., POST, PUT, DELETE, etc.</p> <p>This feature is useful, for instance, to create several users at once as we'll see below.</p>","tags":["administration","scim","bulk-users"]},{"location":"janssen-server/scim/bulk-users/#endpoint","title":"Endpoint","text":"<p>The bulk endpoint is accessible at <code>https://&lt;your-server-mame&gt;/jans-scim/restv1/v2/Bulk</code>. Requests must be sent with a bearer token having scope <code>https://jans.io/scim/bulk</code></p>","tags":["administration","scim","bulk-users"]},{"location":"janssen-server/scim/bulk-users/#bulk-payload","title":"Bulk payload","text":"<p>A bulk is structured as a JSON document with two required properties:</p> <ul> <li>schemas: A list with the single string value <code>urn:ietf:params:scim:api:messages:2.0:BulkRequest</code></li> <li>Operations: A JSON array describing every operation to perform in the order provided</li> </ul> <p>An operation is a JSON document with the following:</p> <ul> <li>method: The HTTP verb of the operation to perform</li> <li>path: The path of the actual endpoint to hit relative to the SCIM root. For instance, to create a user, it will be <code>/Users</code></li> <li>data: The payload of the actual operation. This is required only for POST, PUT, or PATCH</li> </ul>","tags":["administration","scim","bulk-users"]},{"location":"janssen-server/scim/bulk-users/#payload-example-for-adding-users","title":"Payload example for adding users","text":"<pre><code>{\n  \"schemas\": [\n    \"urn:ietf:params:scim:api:messages:2.0:BulkRequest\"\n  ],\n  \"Operations\": [\n    {\n      \"method\": \"POST\",\n      \"path\": \"/Users\",\n      \"data\": {\n        \"schemas\": [\"urn:ietf:params:scim:schemas:core:2.0:User\"],\n        \"userName\": \"alanis\"\n      }\n    },\n    {\n      \"method\": \"POST\",\n      \"path\": \"/Users\",\n      \"data\": {\n        \"schemas\": [\"urn:ietf:params:scim:schemas:core:2.0:User\"],\n        \"userName\": \"sheryl\",\n        \"active\": true,\n        \"password\": \"top-secret\",\n        \"roles\": [{ \"value\" : \"Master of puppets\" }]\n      }\n    },\n    {\n      \"method\": \"POST\",\n      \"path\": \"/Users\",\n      \"data\": {\n        \"schemas\": [\"urn:ietf:params:scim:schemas:core:2.0:User\"],\n        \"userName\": \"becca\",\n        \"externalId\":\"becca_ponx_1234\",\n        \"name\":{\n          \"familyName\": \"Cadalzo\",\n          \"givenName\": \"Rebecca\"\n        }\n      }\n    }\n  ]\n}\n</code></pre> <p>The above payload illustrates how to insert three users with different details each.</p>","tags":["administration","scim","bulk-users"]},{"location":"janssen-server/scim/bulk-users/#bulk-response","title":"Bulk response","text":"<p>The result of a bulk operation is likewise retrieved in JSON object format:</p> <ul> <li>schemas: A list with the single string value <code>urn:ietf:params:scim:api:messages:2.0:BulkResponse</code></li> <li>Operations: A JSON array describing the response of every operation performed whether failed or successful</li> </ul> <p>An operation is a JSON document with the following:</p> <ul> <li>method: The HTTP verb of the operation performed</li> <li>location: The resource endpoint URL. For example, in the case of user creation, this will be the URL where the user's details can be retrieved</li> <li>status: A string value reporting the HTTP response code obtained for the given operation</li> <li>response: A JSON object only present when the status does not belong to the 2XX (success) family. It contains details of the error that occurred</li> </ul>","tags":["administration","scim","bulk-users"]},{"location":"janssen-server/scim/bulk-users/#response-example","title":"Response example","text":"<p>The following contains a potential response obtained for the bulk request mentioned earlier:</p> <pre><code>{\n  \"schemas\": [\"urn:ietf:params:scim:api:messages:2.0:BulkResponse\"],\n  \"Operations\": [\n     {\n        \"method\": \"POST\",\n        \"location\": \"https://acme.co/jans-scim/restv1/v2/Users/92b725cd\",\n        \"status\": \"201\"\n     },\n     {\n        \"method\": \"POST\",\n        \"location\": \"https://acme.co/jans-scim/restv1/v2/Users/a27725cf\",\n        \"status\": \"201\"\n     },\n     {\n        \"method\": \"POST\",\n        \"status\": \"409\",        \n        \"response\":{\n           \"schemas\": [\"urn:ietf:params:scim:api:messages:2.0:Error\"],\n           \"scimType\": \"uniqueness\"\n           \"detail\": \"User 'becca' already exists\"\n        }\n     }       \n  ]\n}\n</code></pre>","tags":["administration","scim","bulk-users"]},{"location":"janssen-server/scim/bulk-users/#bulk-operation-configuration","title":"Bulk operation configuration","text":"<p>SCIM Jans server has a couple of configuration properties related to bulk operations:</p> <ul> <li>bulkMaxOperations: The maximum number of operations per bulk request. Default is 30</li> <li>bulkMaxPayloadSize:  The maximum payload size in bytes. Default value is 3072000</li> </ul>","tags":["administration","scim","bulk-users"]},{"location":"janssen-server/scim/config/","title":"SCIM configuration","text":"<p>Relevant configuration properties of the Jans SCIM server are summarized in the table below:</p> Property Default value Description maxCount 200 Maximum number of results per page in search endpoints bulkMaxOperations 30 Maximum number of operations admitted in a single bulk request bulkMaxPayloadSize 3072000 Maximum payload size in bytes admitted in a single bulk request userExtensionSchemaURI <code>urn:ietf:params:scim:schemas:extension:gluu:2.0:User</code> URI schema associated to the User Extension skipDefinedPasswordValidation false Whether the validation rules defined for the password attribute in the server should be bypassed when a user is created/updated loggingLevel <code>INFO</code> The logging level","tags":["administration","scim","configuration"]},{"location":"janssen-server/scim/config/#configuration-management-using-cli","title":"Configuration management using CLI","text":"<p>To retrieve the current server configuration run the command <pre><code>python3 jans cli --operation-id get-scim-config\n</code></pre></p> <p>To modify some aspect of the retrieved configuration prepare a PATCH request in JSON format. For instance:</p> PATCH<pre><code>[\n{ \n  \"op\":\"replace\",\n  \"path\": \"bulkMaxOperations\",\n  \"value\": 100\n},\n{ \n  \"op\":\"replace\",\n  \"path\": \"loggingLevel\",\n  \"value\": \"DEBUG\"\n}\n]\n</code></pre> <p>These contents should be then passed to the <code>patch-scim-config</code> operation, e.g.</p> <pre><code>python3 jans cli --operation-id patch-scim-config --data &lt;path-to-JSON-file&gt;\n</code></pre>","tags":["administration","scim","configuration"]},{"location":"janssen-server/scim/config/#configuration-management-using-tui","title":"Configuration management using TUI","text":"<p>To retrieve the current server configuration using TUI proceed as below:</p> <ol> <li>Launch TUI, e.g. by running <code>jans tui</code>, and follow the prompts</li> <li>Highlight the SCIM tab using your keyboard's left/right arrow key</li> <li>Highlight the \"Get Scim Configuration\" button using the tab key</li> <li>Press enter</li> </ol> <p>You can modify the configuration in place by editing the fields of your interest. To persist the changes, highlight the \"Save\" button at the bottom and press enter.</p>","tags":["administration","scim","configuration"]},{"location":"janssen-server/scim/config/#scim-operations-guide-using-cli-tui-and-api","title":"SCIM Operations Guide using CLI, TUI and API","text":"<p>SCIM operations support mutiple options. Please check out this documentation for guidelines of scim operations.</p>","tags":["administration","scim","configuration"]},{"location":"janssen-server/scim/config/#when-will-changes-take-effect","title":"When will changes take effect?","text":"<p>Any configuration update will take effect one minute after it has been applied whether via CLI or TUI.</p>","tags":["administration","scim","configuration"]},{"location":"janssen-server/scim/custom-attributes/","title":"Custom Attributes","text":"<p>RFC 7643 defines the schema for resource types in SCIM (see section 3.3). In other words, it defines structures in terms of attributes to represent users and groups as well as attribute types, mutability, cardinality, and so on.</p> <p>Although the schema covers many attributes one might think of, at times you will need to add your own attributes for specific needs. This is where user extensions pitch in, they allow you to create custom attributes for SCIM. To do so, you will have to:</p> <ul> <li> <p>Add an attribute to Database schema</p> </li> <li> <p>Include the new attribute in an object class such as jansPerson</p> </li> <li> <p>Register and activate your new attribute through Jans TUI.</p> </li> </ul> <p>Please visit this page for a more detailed explanation. When registering the attribute in the TUI, please ensure you have set the <code>Include in SCIM Extension</code> parameter to <code>true</code>.</p> <p></p> <p>Once you submit this form, your attribute will be part of the <code>User Extension</code>. You can verify this by inspecting the <code>Schema</code> endpoint:</p> Command<pre><code>https://&lt;host-name&gt;/jans-scim/restv1/v2/Schemas/urn:ietf:params:scim:schemas:extension:gluu:2.0:User\n</code></pre> <p></p> <p>In the JSON response, your new added attribute will appear.</p> <p>To customize the URI associated to the extension (whose default value is <code>urn:ietf:params:scim:schemas:extension:gluu:2.0:User</code> ), you can use TUI:</p> <ul> <li>Navigate to <code>SCIM</code> using Jans TUI <code>jans tui</code></li> <li>Locate the Scim properties section</li> <li>Set a value in the field <code>User Extension Schema URI</code></li> <li>Save the changes</li> </ul> <p></p>","tags":["administration","scim","custom-attributes"]},{"location":"janssen-server/scim/logs/","title":"SCIM Logs","text":"<p>Logs can be found under <code>/opt/jans/jetty/jans-scim/logs</code> in your Janssen Server. The default logging level is <code>INFO</code> but this can be changed to any of <code>TRACE</code>, <code>DEBUG</code>, <code>WARN</code>, OR <code>ERROR</code> via TUI.</p> <p>To do so launch TUI, e.g. <code>jans tui</code>, and navigate to SCIM tab. Then in \"Logging Level\" select the desired option. Finally hit \"Save\".</p>","tags":["administration","scim"]},{"location":"janssen-server/scim/monitoring/","title":"How is SCIM data stored?","text":"<p>SCIM schema spec does not use LDAP attribute names but a different naming convention for resource attributes (note this is not the case of custom attributes where the SCIM name used is that of the LDAP attribute).</p> <p>It is possible to determine if a given LDAP attribute is being mapped to a SCIM attribute. For that you need to check in Jans TUI <code>Auth-Server &gt;&gt; Attributes</code> and click on any attributes. Check <code>Include in SCIM Extension:</code> is <code>true</code> or <code>false</code>. Whenever you try to map any LDAP attribute to a SCIM attribute keep it's value <code>true</code>.</p>","tags":["administration","scim"]},{"location":"janssen-server/scim/monitoring/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","scim"]},{"location":"janssen-server/scim/monitoring/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","scim"]},{"location":"janssen-server/scim/oauth-protection/","title":"OAuth protection","text":"<p>The SCIM API endpoints are by default protected by (Bearer) OAuth 2.0 tokens. Depending on the operation, these tokens must have certain scopes for the operations to be authorized. The table below summarizes this fact:</p> Scope Description <code>https://jans.io/scim/users.read</code> Query/Search user resources <code>https://jans.io/scim/users.write</code> Modify user resources <code>https://jans.io/scim/groups.read</code> Query group resources <code>https://jans.io/scim/groups.write</code> Modify group resources <code>https://jans.io/scim/fido.read</code> Query fido resources <code>https://jans.io/scim/fido.write</code> Modify fido resources <code>https://jans.io/scim/fido2.read</code> Query fido 2 resources <code>https://jans.io/scim/fido2.write</code> Modify fido 2 resources <code>https://jans.io/scim/bulk</code> Send requests to the bulk endpoint <code>https://jans.io/scim/all-resources.search</code> Access the root <code>.search</code> endpoint <p>Correspondence of endpoints vs. scopes can be found in the SCIM OpenAPI descriptor you can find here.</p>","tags":["administration","scim"]},{"location":"janssen-server/scim/oauth-protection/#client-details","title":"Client details","text":"<p>To obtain valid tokens, you would normally have to register a client (in the server) capable of obtaining tokens with the scopes needed. Registration is out of the scope of this document, however you can leverage the client that is already bundled in your server for SCIM interaction. With this client you can issue tokens with any SCIM-related scope.</p> <p>Let's obtain the credentials of this client first. In TUI, navigate to <code>Auth Server</code> &gt; <code>Clients</code>. In the search field type SCIM (uppercase). Highlight the row that matches a client named \"SCIM Client\" and press Enter.</p> <p>From the \"Basic\" section, grab the \"client id\" and \"client secret\". This secret is encrypted, to decrypt it, in a terminal run <code>/opt/jans/bin/encode.py -D ENCRYPTED-SECRET-HERE</code>.</p>","tags":["administration","scim"]},{"location":"janssen-server/scim/oauth-protection/#getting-a-token","title":"Getting a token","text":"<p>This is a <code>curl</code> example of how to get a token valid for retrieving and modifying users (line breaks added for readability). Note the use of white space to separate scope names.</p> Command<pre><code>curl -k -u 'CLIENT_ID:DECRYPTED_CLIENT_SECRET' -k -d grant_type=client_credentials -d \n    scope='https://jans.io/scim/users.read https://jans.io/scim/users.write' \n    https://your-jans-server/jans-auth/restv1/token\n</code></pre> <p>Grab the \"access_token\" from the obtained response.</p>","tags":["administration","scim"]},{"location":"janssen-server/scim/oauth-protection/#issue-a-request-to-the-service","title":"Issue a request to the service","text":"<p>The below is a curl example of how to call an operation by passing the previously obtained token (line breaks added for readability):</p> Command<pre><code>curl -k -G -H 'Authorization: Bearer ACCESS_TOKEN' --data-urlencode 'filter=displayName co \"Admin\"' \n    https://your-jans-server/jans-scim/restv1/v2/Users\n</code></pre> <p>The output should show valid SCIM (JSON) output. Account the access token is short-lived: once it expires you will get a status response of 401 and need to re-request the token as in the previous step.</p>","tags":["administration","scim"]},{"location":"janssen-server/scim/oauth-protection/#deactivating-oauth-mode","title":"Deactivating OAuth mode","text":"<p>OAuth tokens usage is a safe, standardized approach for controlling access to resources. If for some reason you want to turn off protection you can do so by activating bypass mode: in TUI, navigate to SCIM tab and under \"Protection Mode\" select \"BYPASS\". Finally press \"Save\".</p> <p>Caution: keep in mind that with \"BYPASS\" you should add some sort of protection to your endpoints, say, at the network level to avoid anyone to mess with your user base among other resources.</p>","tags":["administration","scim"]},{"location":"janssen-server/scim/security/","title":"Security","text":"","tags":["administration","scim"]},{"location":"janssen-server/scim/security/#security-considerations","title":"Security considerations","text":"<p>SCIM API allows administrators and developers manage a key asset in an IAM deployment, namely users. Additionally, other resources like groups and registered fido devices can be managed in Janssen Server via SCIM.</p> <p>Clearly, this kind of API must not be anonymously accessible. However, the SCIM standard does not define a specific mechanism to prevent unauthorized requests to endpoints. There are just a few guidelines in section 2 of RFC 7644 concerned with authentication and authorization.</p> <p>Currently, the Janssen server supports an OAuth-based mechanism to protect these endpoints; you can find more information in this regard here. Nonetheless, it is recommended not to expose this API outside the organization's network. Ideally administrators should block any external attempt to access URLs under the path <code>https://your-jans-server/jans-scim</code>.</p>","tags":["administration","scim"]},{"location":"janssen-server/shibboleth-idp/","title":"Shibboleth Identity Provider","text":"","tags":["administration","shibboleth","saml","identity-provider"]},{"location":"janssen-server/shibboleth-idp/#overview","title":"Overview","text":"<p>The Janssen Shibboleth IDP module provides SAML 2.0 Identity Provider functionality integrated with the Janssen Auth Server. This integration enables organizations to provide SAML-based Single Sign-On (SSO) while leveraging Janssen's powerful authentication capabilities including multi-factor authentication, adaptive authentication, and customizable authentication flows.</p>","tags":["administration","shibboleth","saml","identity-provider"]},{"location":"janssen-server/shibboleth-idp/#key-features","title":"Key Features","text":"<ul> <li>SAML 2.0 Identity Provider: Full SAML 2.0 SSO support based on Shibboleth IDP 5.1.6</li> <li>Janssen Auth Integration: Authentication delegates to Janssen Auth Server via OAuth 2.0/OIDC</li> <li>Flexible Deployment: Available as Docker container, Helm chart, or Linux VM installation</li> <li>Centralized Management: Configure via Config API, CLI-TUI, or Terraform</li> <li>Multi-factor Authentication: Leverage all Janssen authentication methods for SAML SSO</li> </ul>","tags":["administration","shibboleth","saml","identity-provider"]},{"location":"janssen-server/shibboleth-idp/#architecture","title":"Architecture","text":"<p>The Shibboleth IDP acts as a SAML Identity Provider while delegating actual user authentication to the Janssen Auth Server. This architecture provides:</p> <ol> <li>Separation of Concerns: SAML protocol handling is separate from authentication logic</li> <li>Unified Authentication: All authentication methods available in Janssen work with SAML SPs</li> <li>Centralized User Management: User data remains in Janssen's LDAP/database</li> </ol>","tags":["administration","shibboleth","saml","identity-provider"]},{"location":"janssen-server/shibboleth-idp/#authentication-flow","title":"Authentication Flow","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   SAML SP   \u2502\u2500\u2500\u2500\u2500\u25b6\u2502  Shibboleth IDP \u2502\u2500\u2500\u2500\u2500\u25b6\u2502 Janssen Auth    \u2502\n\u2502             \u2502     \u2502                 \u2502     \u2502 Server          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502                    \u2502                       \u2502\n       \u2502  1. SAML Request   \u2502                       \u2502\n       \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502                       \u2502\n       \u2502                    \u2502  2. OAuth Redirect    \u2502\n       \u2502                    \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502\n       \u2502                    \u2502                       \u2502\n       \u2502                    \u2502  3. User Authenticates\u2502\n       \u2502                    \u2502                       \u2502\n       \u2502                    \u2502  4. OAuth Callback    \u2502\n       \u2502                    \u2502\u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n       \u2502                    \u2502                       \u2502\n       \u2502  5. SAML Response  \u2502                       \u2502\n       \u2502\u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                       \u2502\n</code></pre> <ol> <li>Service Provider sends SAML AuthnRequest to Shibboleth IDP</li> <li>IDP redirects user to Janssen Auth Server for authentication</li> <li>User authenticates using configured authentication method</li> <li>Auth Server returns OAuth tokens to IDP via callback</li> <li>IDP issues SAML assertion to Service Provider</li> </ol>","tags":["administration","shibboleth","saml","identity-provider"]},{"location":"janssen-server/shibboleth-idp/#components","title":"Components","text":"Component Description <code>jans-shibboleth-idp</code> Maven module with IDP configuration and authentication integration <code>docker-jans-shibboleth</code> Docker container image for containerized deployment Helm Chart Kubernetes deployment via <code>charts/janssen/charts/shibboleth-idp</code> Config API Plugin REST API for managing IDP configuration Terraform Resources Infrastructure as Code support Linux Installer VM-based installation support","tags":["administration","shibboleth","saml","identity-provider"]},{"location":"janssen-server/shibboleth-idp/#version-information","title":"Version Information","text":"<ul> <li>Shibboleth IDP Version: 5.1.6 (released August 26, 2024)</li> <li>Servlet Container: Jetty 12.0.25</li> <li>Java Version: OpenJDK 11</li> </ul>","tags":["administration","shibboleth","saml","identity-provider"]},{"location":"janssen-server/shibboleth-idp/#quick-start","title":"Quick Start","text":"","tags":["administration","shibboleth","saml","identity-provider"]},{"location":"janssen-server/shibboleth-idp/#docker-deployment","title":"Docker Deployment","text":"<pre><code>docker run -d \\\n  -p 8080:8080 \\\n  -e CN_HOSTNAME=your-hostname.example.com \\\n  -e CN_AUTH_SERVER_URL=https://your-hostname.example.com \\\n  janssenproject/shibboleth:5.1.6_dev\n</code></pre>","tags":["administration","shibboleth","saml","identity-provider"]},{"location":"janssen-server/shibboleth-idp/#helm-deployment","title":"Helm Deployment","text":"<pre><code>helm install janssen janssen/janssen \\\n  --set shibboleth-idp.enabled=true \\\n  --set global.fqdn=your-hostname.example.com\n</code></pre>","tags":["administration","shibboleth","saml","identity-provider"]},{"location":"janssen-server/shibboleth-idp/#documentation","title":"Documentation","text":"<ul> <li>Installation Guide - Detailed installation instructions</li> <li>Configuration - IDP and authentication configuration</li> <li>Helm Deployment - Kubernetes deployment guide</li> <li>Config API - REST API for configuration management</li> <li>Terraform - Infrastructure as Code deployment</li> </ul>","tags":["administration","shibboleth","saml","identity-provider"]},{"location":"janssen-server/shibboleth-idp/#related-documentation","title":"Related Documentation","text":"<ul> <li>SAML Recipes - SAML integration recipes</li> <li>Auth Server - Janssen Auth Server documentation</li> <li>Kubernetes Operations - Kubernetes deployment guide</li> </ul>","tags":["administration","shibboleth","saml","identity-provider"]},{"location":"janssen-server/shibboleth-idp/config-api/","title":"Shibboleth IDP Config API","text":"<p>The Janssen Config API provides REST endpoints for managing Shibboleth IDP configuration and trusted Service Providers.</p>","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#authentication","title":"Authentication","text":"<p>All endpoints require OAuth 2.0 authentication with appropriate scopes.</p>","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#required-scopes","title":"Required Scopes","text":"Scope Description <code>https://jans.io/oauth/config/shibboleth.readonly</code> Read IDP configuration <code>https://jans.io/oauth/config/shibboleth.write</code> Modify IDP configuration","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#example-token-request","title":"Example Token Request","text":"<pre><code>ACCESS_TOKEN=$(curl -s -X POST \\\n  \"https://auth.example.com/jans-auth/restv1/token\" \\\n  -H \"Content-Type: application/x-www-form-urlencoded\" \\\n  -d \"grant_type=client_credentials\" \\\n  -d \"client_id=your-client-id\" \\\n  -d \"client_secret=your-client-secret\" \\\n  -d \"scope=https://jans.io/oauth/config/shibboleth.readonly https://jans.io/oauth/config/shibboleth.write\" \\\n  | jq -r '.access_token')\n</code></pre>","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#api-endpoints","title":"API Endpoints","text":"","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#get-idp-configuration","title":"Get IDP Configuration","text":"<p>Retrieve the current Shibboleth IDP configuration.</p> <p>Request: <pre><code>GET /jans-config-api/shibboleth/config\nAuthorization: Bearer {access_token}\n</code></pre></p> <p>Response: <pre><code>{\n  \"entityId\": \"https://idp.example.com/idp/shibboleth\",\n  \"scope\": \"example.com\",\n  \"enabled\": true,\n  \"metadataUrl\": \"https://idp.example.com/idp/shibboleth\",\n  \"signingKeyAlias\": \"idp-signing\",\n  \"encryptionKeyAlias\": \"idp-encryption\",\n  \"jansAuthEnabled\": true,\n  \"jansAuthClientId\": \"shibboleth-client\",\n  \"jansAuthScopes\": \"openid,profile,email\"\n}\n</code></pre></p> <p>cURL Example: <pre><code>curl -X GET \\\n  \"https://api.example.com/jans-config-api/shibboleth/config\" \\\n  -H \"Authorization: Bearer ${ACCESS_TOKEN}\" \\\n  -H \"Accept: application/json\"\n</code></pre></p>","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#update-idp-configuration","title":"Update IDP Configuration","text":"<p>Update the Shibboleth IDP configuration.</p> <p>Request: <pre><code>PUT /jans-config-api/shibboleth/config\nAuthorization: Bearer {access_token}\nContent-Type: application/json\n\n{\n  \"entityId\": \"https://idp.example.com/idp/shibboleth\",\n  \"scope\": \"example.com\",\n  \"enabled\": true,\n  \"signingKeyAlias\": \"idp-signing\",\n  \"encryptionKeyAlias\": \"idp-encryption\",\n  \"jansAuthEnabled\": true,\n  \"jansAuthClientId\": \"shibboleth-client-updated\",\n  \"jansAuthScopes\": \"openid,profile,email,address\"\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"entityId\": \"https://idp.example.com/idp/shibboleth\",\n  \"scope\": \"example.com\",\n  \"enabled\": true,\n  \"metadataUrl\": \"https://idp.example.com/idp/shibboleth\",\n  \"signingKeyAlias\": \"idp-signing\",\n  \"encryptionKeyAlias\": \"idp-encryption\",\n  \"jansAuthEnabled\": true,\n  \"jansAuthClientId\": \"shibboleth-client-updated\",\n  \"jansAuthScopes\": \"openid,profile,email,address\"\n}\n</code></pre></p>","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#list-trusted-service-providers","title":"List Trusted Service Providers","text":"<p>Get all configured trusted Service Providers.</p> <p>Request: <pre><code>GET /jans-config-api/shibboleth/trust\nAuthorization: Bearer {access_token}\n</code></pre></p> <p>Response: <pre><code>[\n  {\n    \"entityId\": \"https://sp1.example.org\",\n    \"name\": \"Example SP 1\",\n    \"description\": \"First example service provider\",\n    \"enabled\": true,\n    \"metadataUrl\": \"https://sp1.example.org/metadata\",\n    \"releasedAttributes\": [\"uid\", \"mail\", \"displayName\"]\n  },\n  {\n    \"entityId\": \"https://sp2.example.org\",\n    \"name\": \"Example SP 2\",\n    \"description\": \"Second example service provider\",\n    \"enabled\": true,\n    \"metadataUrl\": \"https://sp2.example.org/metadata\",\n    \"releasedAttributes\": [\"uid\", \"mail\"]\n  }\n]\n</code></pre></p>","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#get-trusted-service-provider","title":"Get Trusted Service Provider","text":"<p>Get a specific trusted Service Provider by entity ID.</p> <p>Request: <pre><code>GET /jans-config-api/shibboleth/trust/{entityId}\nAuthorization: Bearer {access_token}\n</code></pre></p> <p>Response: <pre><code>{\n  \"entityId\": \"https://sp1.example.org\",\n  \"name\": \"Example SP 1\",\n  \"description\": \"First example service provider\",\n  \"enabled\": true,\n  \"metadataUrl\": \"https://sp1.example.org/metadata\",\n  \"releasedAttributes\": [\"uid\", \"mail\", \"displayName\"],\n  \"assertionLifetime\": 300,\n  \"signAssertions\": true,\n  \"encryptAssertions\": false\n}\n</code></pre></p>","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#add-trusted-service-provider","title":"Add Trusted Service Provider","text":"<p>Add a new trusted Service Provider.</p> <p>Request: <pre><code>POST /jans-config-api/shibboleth/trust\nAuthorization: Bearer {access_token}\nContent-Type: application/json\n\n{\n  \"entityId\": \"https://new-sp.example.org\",\n  \"name\": \"New Service Provider\",\n  \"description\": \"A new service provider\",\n  \"enabled\": true,\n  \"metadataUrl\": \"https://new-sp.example.org/metadata\",\n  \"releasedAttributes\": [\"uid\", \"mail\", \"displayName\", \"eduPersonPrincipalName\"],\n  \"assertionLifetime\": 300,\n  \"signAssertions\": true,\n  \"encryptAssertions\": true\n}\n</code></pre></p> <p>Response (201 Created): <pre><code>{\n  \"entityId\": \"https://new-sp.example.org\",\n  \"name\": \"New Service Provider\",\n  \"description\": \"A new service provider\",\n  \"enabled\": true,\n  \"metadataUrl\": \"https://new-sp.example.org/metadata\",\n  \"releasedAttributes\": [\"uid\", \"mail\", \"displayName\", \"eduPersonPrincipalName\"],\n  \"assertionLifetime\": 300,\n  \"signAssertions\": true,\n  \"encryptAssertions\": true\n}\n</code></pre></p>","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#update-trusted-service-provider","title":"Update Trusted Service Provider","text":"<p>Update an existing trusted Service Provider.</p> <p>Request: <pre><code>PUT /jans-config-api/shibboleth/trust/{entityId}\nAuthorization: Bearer {access_token}\nContent-Type: application/json\n\n{\n  \"name\": \"Updated Service Provider\",\n  \"description\": \"Updated description\",\n  \"enabled\": true,\n  \"metadataUrl\": \"https://new-sp.example.org/metadata\",\n  \"releasedAttributes\": [\"uid\", \"mail\"],\n  \"assertionLifetime\": 600,\n  \"signAssertions\": true,\n  \"encryptAssertions\": false\n}\n</code></pre></p>","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#delete-trusted-service-provider","title":"Delete Trusted Service Provider","text":"<p>Remove a trusted Service Provider.</p> <p>Request: <pre><code>DELETE /jans-config-api/shibboleth/trust/{entityId}\nAuthorization: Bearer {access_token}\n</code></pre></p> <p>Response: <code>204 No Content</code></p>","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#error-responses","title":"Error Responses","text":"","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#401-unauthorized","title":"401 Unauthorized","text":"<pre><code>{\n  \"error\": \"unauthorized\",\n  \"error_description\": \"Invalid or expired access token\"\n}\n</code></pre>","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#404-not-found","title":"404 Not Found","text":"<pre><code>{\n  \"error\": \"not_found\",\n  \"error_description\": \"Service provider with entity ID not found\"\n}\n</code></pre>","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#409-conflict","title":"409 Conflict","text":"<pre><code>{\n  \"error\": \"conflict\",\n  \"error_description\": \"Service Provider with this entity ID already exists\"\n}\n</code></pre>","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/config-api/#openapi-specification","title":"OpenAPI Specification","text":"<p>The complete OpenAPI specification is available at:</p> <pre><code>https://api.example.com/jans-config-api/openapi.json\n</code></pre> <p>Filter for Shibboleth endpoints: <pre><code>curl -s \"https://api.example.com/jans-config-api/openapi.json\" | \\\n  jq '.paths | with_entries(select(.key | contains(\"shibboleth\")))'\n</code></pre></p>","tags":["administration","shibboleth","config-api","rest-api"]},{"location":"janssen-server/shibboleth-idp/configuration/","title":"Shibboleth IDP Configuration","text":"<p>This guide covers configuration of the Janssen Shibboleth IDP.</p>","tags":["administration","shibboleth","configuration"]},{"location":"janssen-server/shibboleth-idp/configuration/#configuration-files","title":"Configuration Files","text":"<p>The Shibboleth IDP uses several configuration files located in <code>/opt/shibboleth-idp/conf/</code>:</p> File Purpose <code>idp.properties</code> Main IDP properties <code>ldap.properties</code> LDAP connection settings <code>authn/jans-authn.properties</code> Janssen authentication settings <code>attribute-resolver.xml</code> Attribute definitions <code>attribute-filter.xml</code> Attribute release policies <code>metadata-providers.xml</code> SP metadata configuration <code>relying-party.xml</code> Relying party configuration","tags":["administration","shibboleth","configuration"]},{"location":"janssen-server/shibboleth-idp/configuration/#janssen-authentication-configuration","title":"Janssen Authentication Configuration","text":"","tags":["administration","shibboleth","configuration"]},{"location":"janssen-server/shibboleth-idp/configuration/#basic-configuration","title":"Basic Configuration","text":"<p>Edit <code>/opt/shibboleth-idp/conf/authn/jans-authn.properties</code>:</p> <pre><code># Janssen Auth Server URL\njans.auth.server.url=https://auth.example.com\n\n# OAuth Client Credentials\njans.auth.client.id=your-client-id\njans.auth.client.secret=your-client-secret\n\n# OAuth Scopes\njans.auth.scopes=openid,profile,email\n\n# Redirect URI\njans.auth.redirect.uri=https://idp.example.com/idp/Authn/Jans/callback\n</code></pre>","tags":["administration","shibboleth","configuration"]},{"location":"janssen-server/shibboleth-idp/configuration/#advanced-options","title":"Advanced Options","text":"<pre><code># Authentication timeout (seconds)\njans.auth.timeout=30\n\n# Token validation\njans.auth.validate.tokens=true\n\n# PKCE enabled\njans.auth.pkce.enabled=true\n\n# Additional authentication parameters\njans.auth.acr.values=simple_password_auth\n\n# Session binding\njans.auth.session.binding=true\n</code></pre>","tags":["administration","shibboleth","configuration"]},{"location":"janssen-server/shibboleth-idp/configuration/#idp-properties","title":"IDP Properties","text":"","tags":["administration","shibboleth","configuration"]},{"location":"janssen-server/shibboleth-idp/configuration/#entity-id-and-scope","title":"Entity ID and Scope","text":"<p>Edit <code>/opt/shibboleth-idp/conf/idp.properties</code>:</p> <pre><code># IDP Entity ID\nidp.entityID=https://idp.example.com/idp/shibboleth\n\n# Scope for attributes\nidp.scope=example.com\n\n# Signing credential\nidp.signing.key=/opt/shibboleth-idp/credentials/idp-signing.key\nidp.signing.cert=/opt/shibboleth-idp/credentials/idp-signing.crt\n\n# Encryption credential\nidp.encryption.key=/opt/shibboleth-idp/credentials/idp-encryption.key\nidp.encryption.cert=/opt/shibboleth-idp/credentials/idp-encryption.crt\n</code></pre>","tags":["administration","shibboleth","configuration"]},{"location":"janssen-server/shibboleth-idp/configuration/#session-configuration","title":"Session Configuration","text":"<pre><code># Session timeout (minutes)\nidp.session.timeout=PT60M\n\n# Secondary session timeout\nidp.session.secondaryServiceIndex=true\n\n# Cookie settings\nidp.cookie.secure=true\nidp.cookie.httpOnly=true\nidp.cookie.sameSite=Lax\n</code></pre>","tags":["administration","shibboleth","configuration"]},{"location":"janssen-server/shibboleth-idp/configuration/#attribute-resolver","title":"Attribute Resolver","text":"<p>Configure attribute resolution in <code>/opt/shibboleth-idp/conf/attribute-resolver.xml</code>:</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;AttributeResolver xmlns=\"urn:mace:shibboleth:2.0:resolver\"&gt;\n\n    &lt;!-- Attributes from Janssen OAuth token --&gt;\n    &lt;AttributeDefinition id=\"uid\" xsi:type=\"Simple\"&gt;\n        &lt;InputDataConnector ref=\"jansToken\" attributeNames=\"sub\"/&gt;\n    &lt;/AttributeDefinition&gt;\n\n    &lt;AttributeDefinition id=\"mail\" xsi:type=\"Simple\"&gt;\n        &lt;InputDataConnector ref=\"jansToken\" attributeNames=\"email\"/&gt;\n    &lt;/AttributeDefinition&gt;\n\n    &lt;AttributeDefinition id=\"displayName\" xsi:type=\"Simple\"&gt;\n        &lt;InputDataConnector ref=\"jansToken\" attributeNames=\"name\"/&gt;\n    &lt;/AttributeDefinition&gt;\n\n    &lt;AttributeDefinition id=\"givenName\" xsi:type=\"Simple\"&gt;\n        &lt;InputDataConnector ref=\"jansToken\" attributeNames=\"given_name\"/&gt;\n    &lt;/AttributeDefinition&gt;\n\n    &lt;AttributeDefinition id=\"sn\" xsi:type=\"Simple\"&gt;\n        &lt;InputDataConnector ref=\"jansToken\" attributeNames=\"family_name\"/&gt;\n    &lt;/AttributeDefinition&gt;\n\n    &lt;!-- eduPerson attributes --&gt;\n    &lt;AttributeDefinition id=\"eduPersonPrincipalName\" xsi:type=\"Scoped\" scope=\"%{idp.scope}\"&gt;\n        &lt;InputDataConnector ref=\"jansToken\" attributeNames=\"sub\"/&gt;\n    &lt;/AttributeDefinition&gt;\n\n    &lt;!-- Janssen Token Data Connector --&gt;\n    &lt;DataConnector id=\"jansToken\" xsi:type=\"JansToken\"/&gt;\n\n&lt;/AttributeResolver&gt;\n</code></pre>","tags":["administration","shibboleth","configuration"]},{"location":"janssen-server/shibboleth-idp/configuration/#attribute-filter","title":"Attribute Filter","text":"<p>Configure attribute release in <code>/opt/shibboleth-idp/conf/attribute-filter.xml</code>:</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;AttributeFilterPolicyGroup xmlns=\"urn:mace:shibboleth:2.0:afp\"&gt;\n\n    &lt;!-- Release basic attributes to all SPs --&gt;\n    &lt;AttributeFilterPolicy id=\"releaseToAllSPs\"&gt;\n        &lt;PolicyRequirementRule xsi:type=\"ANY\"/&gt;\n        &lt;AttributeRule attributeID=\"uid\"&gt;\n            &lt;PermitValueRule xsi:type=\"ANY\"/&gt;\n        &lt;/AttributeRule&gt;\n        &lt;AttributeRule attributeID=\"mail\"&gt;\n            &lt;PermitValueRule xsi:type=\"ANY\"/&gt;\n        &lt;/AttributeRule&gt;\n        &lt;AttributeRule attributeID=\"displayName\"&gt;\n            &lt;PermitValueRule xsi:type=\"ANY\"/&gt;\n        &lt;/AttributeRule&gt;\n    &lt;/AttributeFilterPolicy&gt;\n\n    &lt;!-- Additional attributes for specific SPs --&gt;\n    &lt;AttributeFilterPolicy id=\"releaseToSpecificSP\"&gt;\n        &lt;PolicyRequirementRule xsi:type=\"Requester\" value=\"https://sp.example.org\"/&gt;\n        &lt;AttributeRule attributeID=\"givenName\"&gt;\n            &lt;PermitValueRule xsi:type=\"ANY\"/&gt;\n        &lt;/AttributeRule&gt;\n        &lt;AttributeRule attributeID=\"sn\"&gt;\n            &lt;PermitValueRule xsi:type=\"ANY\"/&gt;\n        &lt;/AttributeRule&gt;\n        &lt;AttributeRule attributeID=\"eduPersonPrincipalName\"&gt;\n            &lt;PermitValueRule xsi:type=\"ANY\"/&gt;\n        &lt;/AttributeRule&gt;\n    &lt;/AttributeFilterPolicy&gt;\n\n&lt;/AttributeFilterPolicyGroup&gt;\n</code></pre>","tags":["administration","shibboleth","configuration"]},{"location":"janssen-server/shibboleth-idp/configuration/#metadata-providers","title":"Metadata Providers","text":"<p>Configure SP metadata sources in <code>/opt/shibboleth-idp/conf/metadata-providers.xml</code>:</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;MetadataProvider xmlns=\"urn:mace:shibboleth:2.0:metadata\"&gt;\n\n    &lt;!-- Local metadata file --&gt;\n    &lt;MetadataProvider id=\"LocalMetadata\" xsi:type=\"FilesystemMetadataProvider\"\n                      metadataFile=\"/opt/shibboleth-idp/metadata/sp-metadata.xml\"/&gt;\n\n    &lt;!-- Remote metadata URL --&gt;\n    &lt;MetadataProvider id=\"RemoteMetadata\" xsi:type=\"FileBackedHTTPMetadataProvider\"\n                      metadataURL=\"https://sp.example.org/metadata\"\n                      backingFile=\"/opt/shibboleth-idp/metadata/sp-example-metadata.xml\"/&gt;\n\n    &lt;!-- InCommon Federation --&gt;\n    &lt;MetadataProvider id=\"InCommon\" xsi:type=\"FileBackedHTTPMetadataProvider\"\n                      metadataURL=\"https://mdq.incommon.org/entities\"\n                      backingFile=\"/opt/shibboleth-idp/metadata/incommon-metadata.xml\"&gt;\n        &lt;MetadataFilter xsi:type=\"SignatureValidation\"\n                        certificateFile=\"/opt/shibboleth-idp/credentials/inc-md-cert.pem\"/&gt;\n    &lt;/MetadataProvider&gt;\n\n&lt;/MetadataProvider&gt;\n</code></pre>","tags":["administration","shibboleth","configuration"]},{"location":"janssen-server/shibboleth-idp/configuration/#logging-configuration","title":"Logging Configuration","text":"<p>Configure logging in <code>/opt/shibboleth-idp/conf/logback.xml</code>:</p> <pre><code>&lt;configuration&gt;\n    &lt;appender name=\"IDP_PROCESS\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\"&gt;\n        &lt;File&gt;/opt/shibboleth-idp/logs/idp-process.log&lt;/File&gt;\n        &lt;rollingPolicy class=\"ch.qos.logback.core.rolling.TimeBasedRollingPolicy\"&gt;\n            &lt;fileNamePattern&gt;/opt/shibboleth-idp/logs/idp-process-%d{yyyy-MM-dd}.log&lt;/fileNamePattern&gt;\n            &lt;maxHistory&gt;30&lt;/maxHistory&gt;\n        &lt;/rollingPolicy&gt;\n        &lt;encoder&gt;\n            &lt;pattern&gt;%date{ISO8601} %-5level %logger{36} - %msg%n&lt;/pattern&gt;\n        &lt;/encoder&gt;\n    &lt;/appender&gt;\n\n    &lt;!-- Janssen authentication logging --&gt;\n    &lt;logger name=\"io.jans.idp.authn\" level=\"DEBUG\"/&gt;\n\n    &lt;root level=\"INFO\"&gt;\n        &lt;appender-ref ref=\"IDP_PROCESS\"/&gt;\n    &lt;/root&gt;\n&lt;/configuration&gt;\n</code></pre>","tags":["administration","shibboleth","configuration"]},{"location":"janssen-server/shibboleth-idp/configuration/#restart-after-configuration-changes","title":"Restart After Configuration Changes","text":"<p>After making configuration changes:</p> <pre><code># Docker\ndocker restart jans-shibboleth\n\n# Kubernetes\nkubectl rollout restart deployment/shibboleth-idp\n\n# Linux VM\nsystemctl restart shibboleth-idp\n# or\n/opt/jetty/bin/jetty.sh restart\n</code></pre>","tags":["administration","shibboleth","configuration"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/","title":"Shibboleth IDP Helm Deployment","text":"<p>This guide covers deploying the Janssen Shibboleth IDP on Kubernetes using Helm.</p>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#prerequisites","title":"Prerequisites","text":"<ul> <li>Kubernetes 1.25+</li> <li>Helm 3.x</li> <li>Janssen Helm repository configured</li> <li>PersistentVolume provisioner (for configuration storage)</li> <li>Ingress controller (nginx, traefik, etc.)</li> </ul> <p>Note: The ingress-nginx project (kubernetes/ingress-nginx) is in maintenance mode and will not receive new releases after March 2026. For new deployments, consider using Gateway API implementations or maintained controllers such as Traefik, Contour, or service meshes (e.g., Istio).</p>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#add-janssen-helm-repository","title":"Add Janssen Helm Repository","text":"<pre><code>helm repo add janssen https://docs.jans.io/charts\nhelm repo update\n</code></pre>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#basic-deployment","title":"Basic Deployment","text":"","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#enable-shibboleth-idp-in-janssen-chart","title":"Enable Shibboleth IDP in Janssen Chart","text":"<pre><code>helm install janssen janssen/janssen \\\n  --namespace janssen \\\n  --create-namespace \\\n  --set global.fqdn=auth.example.com \\\n  --set global.shibboleth-idp.enabled=true\n</code></pre>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#custom-values-file","title":"Custom Values File","text":"<p>Create a <code>values.yaml</code> file:</p> <pre><code>global:\n  fqdn: auth.example.com\n  isFqdnRegistered: true\n\n  persistence:\n    enabled: true\n    storageClass: standard\n\nconfig:\n  countryCode: US\n  email: admin@example.com\n  orgName: Example Org\n  city: Austin\n  state: TX\n\nshibboleth-idp:\n  enabled: true\n\n  replicaCount: 2\n\n  image:\n    repository: ghcr.io/janssenproject/jans/shibboleth\n    tag: 5.1.6_dev\n    pullPolicy: IfNotPresent\n\n  resources:\n    limits:\n      cpu: 2000m\n      memory: 1024Mi\n    requests:\n      cpu: 500m\n      memory: 512Mi\n\n  hpa:\n    enabled: true\n    minReplicas: 2\n    maxReplicas: 10\n    targetCPUUtilizationPercentage: 80\n\n  shibboleth:\n    entityId: \"https://auth.example.com/idp/shibboleth\"\n    scope: \"example.com\"\n    jansAuth:\n      enabled: true\n      clientId: \"shibboleth-client-id\"\n      scopes: \"openid,profile,email\"\n</code></pre> <p>Deploy with custom values:</p> <pre><code>helm install janssen janssen/janssen \\\n  --namespace janssen \\\n  --create-namespace \\\n  -f values.yaml\n</code></pre>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#configuration-options","title":"Configuration Options","text":"","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#shibboleth-idp-values","title":"Shibboleth IDP Values","text":"Parameter Description Default <code>shibboleth-idp.enabled</code> Enable Shibboleth IDP <code>false</code> <code>shibboleth-idp.replicaCount</code> Number of replicas <code>1</code> <code>shibboleth-idp.image.repository</code> Image repository <code>ghcr.io/janssenproject/jans/shibboleth</code> <code>shibboleth-idp.image.tag</code> Image tag <code>5.1.6_dev</code> <code>shibboleth-idp.resources.limits.cpu</code> CPU limit <code>2000m</code> <code>shibboleth-idp.resources.limits.memory</code> Memory limit <code>1024Mi</code> <code>shibboleth-idp.resources.requests.cpu</code> CPU request <code>500m</code> <code>shibboleth-idp.resources.requests.memory</code> Memory request <code>512Mi</code>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#autoscaling","title":"Autoscaling","text":"Parameter Description Default <code>shibboleth-idp.hpa.enabled</code> Enable HPA <code>false</code> <code>shibboleth-idp.hpa.minReplicas</code> Minimum replicas <code>1</code> <code>shibboleth-idp.hpa.maxReplicas</code> Maximum replicas <code>10</code> <code>shibboleth-idp.hpa.targetCPUUtilizationPercentage</code> Target CPU <code>80</code>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#shibboleth-configuration","title":"Shibboleth Configuration","text":"Parameter Description Default <code>shibboleth-idp.shibboleth.entityId</code> IDP Entity ID Auto-generated <code>shibboleth-idp.shibboleth.scope</code> IDP scope Domain from FQDN <code>shibboleth-idp.shibboleth.signingKeyAlias</code> Signing key alias <code>idp-signing</code> <code>shibboleth-idp.shibboleth.encryptionKeyAlias</code> Encryption key alias <code>idp-encryption</code> <code>shibboleth-idp.shibboleth.jansAuth.enabled</code> Enable Janssen auth <code>true</code> <code>shibboleth-idp.shibboleth.jansAuth.clientId</code> OAuth client ID Required <code>shibboleth-idp.shibboleth.jansAuth.scopes</code> OAuth scopes <code>openid,profile,email</code>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#service-configuration","title":"Service Configuration","text":"Parameter Description Default <code>shibboleth-idp.service.type</code> Service type <code>ClusterIP</code> <code>shibboleth-idp.service.port</code> Service port <code>8080</code>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#ingress-configuration","title":"Ingress Configuration","text":"Parameter Description Default <code>shibboleth-idp.ingress.enabled</code> Enable ingress <code>true</code> <code>shibboleth-idp.ingress.hosts[0].paths[0].path</code> Ingress path <code>/idp</code>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#high-availability-configuration","title":"High Availability Configuration","text":"<p>For production deployments, configure high availability:</p> <pre><code>shibboleth-idp:\n  enabled: true\n  replicaCount: 3\n\n  hpa:\n    enabled: true\n    minReplicas: 3\n    maxReplicas: 20\n    targetCPUUtilizationPercentage: 70\n    behavior:\n      scaleDown:\n        stabilizationWindowSeconds: 300\n        policies:\n          - type: Percent\n            value: 10\n            periodSeconds: 60\n      scaleUp:\n        stabilizationWindowSeconds: 0\n        policies:\n          - type: Percent\n            value: 100\n            periodSeconds: 15\n\n  resources:\n    limits:\n      cpu: 4000m\n      memory: 2048Mi\n    requests:\n      cpu: 1000m\n      memory: 1024Mi\n\n  affinity:\n    podAntiAffinity:\n      preferredDuringSchedulingIgnoredDuringExecution:\n        - weight: 100\n          podAffinityTerm:\n            labelSelector:\n              matchLabels:\n                app: shibboleth-idp\n            topologyKey: kubernetes.io/hostname\n\n  topologySpreadConstraints:\n    - maxSkew: 1\n      topologyKey: topology.kubernetes.io/zone\n      whenUnsatisfiable: ScheduleAnyway\n      labelSelector:\n        matchLabels:\n          app: shibboleth-idp\n</code></pre>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#verify-deployment","title":"Verify Deployment","text":"<p>Check deployment status:</p> <pre><code># Check pods\nkubectl get pods -n janssen -l app=shibboleth-idp\n\n# Check service\nkubectl get svc -n janssen -l app=shibboleth-idp\n\n# Check ingress\nkubectl get ingress -n janssen\n\n# View logs\nkubectl logs -n janssen -l app=shibboleth-idp -f\n</code></pre> <p>Test IDP status:</p> <pre><code># Port forward for testing\nkubectl port-forward -n janssen svc/shibboleth-idp 8080:8080\n\n# Check status\ncurl http://localhost:8080/idp/status\n</code></pre>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#upgrade","title":"Upgrade","text":"<p>Upgrade the deployment:</p> <pre><code>helm upgrade janssen janssen/janssen \\\n  --namespace janssen \\\n  -f values.yaml\n</code></pre>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#uninstall","title":"Uninstall","text":"<p>Remove the deployment:</p> <pre><code>helm uninstall janssen --namespace janssen\n</code></pre>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#troubleshooting","title":"Troubleshooting","text":"","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#pod-not-starting","title":"Pod Not Starting","text":"<p>Check pod events:</p> <pre><code>kubectl describe pod -n janssen -l app.kubernetes.io/name=shibboleth-idp\n</code></pre>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#configuration-issues","title":"Configuration Issues","text":"<p>Check configuration:</p> <pre><code>kubectl exec -n janssen -it deployment/shibboleth-idp -- cat /opt/shibboleth-idp/conf/idp.properties\n</code></pre>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/helm-deployment/#authentication-failures","title":"Authentication Failures","text":"<p>Check logs for authentication errors:</p> <pre><code>kubectl logs -n janssen -l app.kubernetes.io/name=shibboleth-idp | grep -i \"authn\\|error\"\n</code></pre>","tags":["administration","shibboleth","kubernetes","helm"]},{"location":"janssen-server/shibboleth-idp/installation/","title":"Shibboleth IDP Installation","text":"<p>This guide covers installation of the Janssen Shibboleth IDP on various platforms.</p>","tags":["administration","shibboleth","installation"]},{"location":"janssen-server/shibboleth-idp/installation/#prerequisites","title":"Prerequisites","text":"<p>Before installing the Shibboleth IDP, ensure you have:</p> <ol> <li>Janssen Auth Server - A running Janssen Auth Server instance</li> <li>OAuth Client - An OAuth client configured in Janssen for the IDP</li> <li>SSL Certificate - Valid SSL certificate for the IDP hostname</li> </ol>","tags":["administration","shibboleth","installation"]},{"location":"janssen-server/shibboleth-idp/installation/#oauth-client-configuration","title":"OAuth Client Configuration","text":"<p>Create an OAuth client in Janssen Auth Server with the following settings:</p> Setting Value Client Type Confidential Grant Types authorization_code Response Types code Scopes openid, profile, email Redirect URI https://your-idp-hostname/idp/Authn/Jans/callback","tags":["administration","shibboleth","installation"]},{"location":"janssen-server/shibboleth-idp/installation/#docker-installation","title":"Docker Installation","text":"","tags":["administration","shibboleth","installation"]},{"location":"janssen-server/shibboleth-idp/installation/#quick-start","title":"Quick Start","text":"<pre><code>docker run -d \\\n  --name jans-shibboleth \\\n  -p 8080:8080 \\\n  -e CN_HOSTNAME=idp.example.com \\\n  -e CN_AUTH_SERVER_URL=https://auth.example.com \\\n  -e CN_CONFIG_ADAPTER=consul \\\n  -e CN_CONSUL_HOST=consul:8500 \\\n  janssenproject/shibboleth:&lt;version&gt;\n</code></pre>","tags":["administration","shibboleth","installation"]},{"location":"janssen-server/shibboleth-idp/installation/#environment-variables","title":"Environment Variables","text":"Variable Description Required <code>CN_HOSTNAME</code> IDP hostname Yes <code>CN_AUTH_SERVER_URL</code> Janssen Auth Server URL Yes <code>CN_CONFIG_ADAPTER</code> Configuration adapter (consul/kubernetes) Yes <code>CN_CONSUL_HOST</code> Consul server address If using Consul <code>CN_SECRET_ADAPTER</code> Secret adapter (vault/kubernetes) Yes <code>SHIBBOLETH_ENTITY_ID</code> IDP Entity ID (defaults to https://hostname/idp/shibboleth) No <code>SHIBBOLETH_SCOPE</code> IDP scope for attributes No","tags":["administration","shibboleth","installation"]},{"location":"janssen-server/shibboleth-idp/installation/#docker-compose-example","title":"Docker Compose Example","text":"<pre><code>services:\n  shibboleth:\n    image: janssenproject/shibboleth:&lt;version&gt;\n    container_name: jans-shibboleth\n    ports:\n      - \"8080:8080\"\n    environment:\n      CN_HOSTNAME: idp.example.com\n      CN_AUTH_SERVER_URL: https://auth.example.com\n      CN_CONFIG_ADAPTER: consul\n      CN_CONSUL_HOST: consul:8500\n      CN_SECRET_ADAPTER: vault\n      CN_VAULT_URL: http://vault:8200\n    volumes:\n      - ./certs:/etc/certs\n    depends_on:\n      - consul\n      - vault\n</code></pre>","tags":["administration","shibboleth","installation"]},{"location":"janssen-server/shibboleth-idp/installation/#kubernetes-installation","title":"Kubernetes Installation","text":"<p>See the Helm Deployment Guide for detailed Kubernetes installation instructions.</p>","tags":["administration","shibboleth","installation"]},{"location":"janssen-server/shibboleth-idp/installation/#linux-vm-installation","title":"Linux VM Installation","text":"","tags":["administration","shibboleth","installation"]},{"location":"janssen-server/shibboleth-idp/installation/#system-requirements","title":"System Requirements","text":"<ul> <li>Ubuntu 22.04 LTS or RHEL 8/9</li> <li>4 GB RAM minimum (8 GB recommended)</li> <li>20 GB disk space</li> <li>Java 17 (installed automatically)</li> </ul>","tags":["administration","shibboleth","installation"]},{"location":"janssen-server/shibboleth-idp/installation/#installation-steps","title":"Installation Steps","text":"<ol> <li>Download the Janssen Installer</li> </ol> <pre><code>wget https://github.com/JanssenProject/jans/releases/download/v5.1.6/jans-installer.pyz\nchmod +x jans-installer.pyz\n</code></pre> <ol> <li>Run the Installer</li> </ol> <pre><code>sudo python3 jans-installer.pyz --install-shibboleth\n</code></pre> <ol> <li>Configure During Installation</li> </ol> <p>The installer will prompt for: - Janssen Auth Server URL - OAuth client credentials - IDP hostname and scope</p>","tags":["administration","shibboleth","installation"]},{"location":"janssen-server/shibboleth-idp/installation/#manual-installation","title":"Manual Installation","text":"<p>For manual installation on Linux:</p> <ol> <li>Install Java 17</li> </ol> <pre><code># Ubuntu\napt-get install openjdk-17-jdk\n\n# RHEL\ndnf install java-17-openjdk\n</code></pre> <ol> <li>Download Shibboleth IDP</li> </ol> <pre><code>cd /opt\nwget https://shibboleth.net/downloads/identity-provider/5.2.0/shibboleth-identity-provider-5.2.0.tar.gz\ntar xzf shibboleth-identity-provider-5.2.0.tar.gz\n</code></pre> <ol> <li>Install Jetty 12</li> </ol> <pre><code>wget https://repo1.maven.org/maven2/org/eclipse/jetty/jetty-home/12.0.31/jetty-home-12.0.31.tar.gz\ntar xzf jetty-home-12.0.31.tar.gz -C /opt\n</code></pre> <ol> <li>Deploy Janssen Integration</li> </ol> <p>Copy the Janssen authentication plugin and configuration files from the <code>jans-shibboleth-idp</code> module.</p> <ol> <li>Configure and Start</li> </ol> <pre><code># Configure IDP\n/opt/shibboleth-idp/bin/install.sh\n\n# Start Jetty\n/opt/jetty/bin/jetty.sh start\n</code></pre>","tags":["administration","shibboleth","installation"]},{"location":"janssen-server/shibboleth-idp/installation/#post-installation-configuration","title":"Post-Installation Configuration","text":"<p>After installation, configure:</p> <ol> <li>IDP Metadata - Download from https://your-idp/idp/shibboleth</li> <li>Attribute Release - Configure attribute-filter.xml</li> <li>Trusted SPs - Add Service Provider metadata</li> </ol> <p>See the Configuration Guide for detailed configuration instructions.</p>","tags":["administration","shibboleth","installation"]},{"location":"janssen-server/shibboleth-idp/installation/#verification","title":"Verification","text":"<p>Verify the installation:</p> <pre><code># Check IDP status\ncurl -k https://your-idp-hostname/idp/status\n\n# View IDP metadata\ncurl -k https://your-idp-hostname/idp/shibboleth\n</code></pre> <p>Expected status response: <pre><code>{\"status\": \"ok\", \"version\": \"5.1.6\"}\n</code></pre></p>","tags":["administration","shibboleth","installation"]},{"location":"janssen-server/shibboleth-idp/terraform/","title":"Shibboleth IDP Terraform Provider","text":"<p>The Janssen Terraform Provider includes resources for managing Shibboleth IDP configuration as Infrastructure as Code.</p>","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#provider-configuration","title":"Provider Configuration","text":"<p>Configure the Janssen provider:</p> <pre><code>terraform {\n  required_providers {\n    jans = {\n      source  = \"JanssenProject/jans\"\n      version = \"~&gt; 1.0\"\n    }\n  }\n}\n\nprovider \"jans\" {\n  url           = \"https://auth.example.com\"\n  client_id     = var.jans_client_id\n  client_secret = var.jans_client_secret\n}\n</code></pre>","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#resources","title":"Resources","text":"","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#jans_shibboleth_configuration","title":"jans_shibboleth_configuration","text":"<p>Manages the Shibboleth IDP configuration.</p>","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#example-usage","title":"Example Usage","text":"<pre><code>resource \"jans_shibboleth_configuration\" \"idp\" {\n  entity_id            = \"https://idp.example.com/idp/shibboleth\"\n  scope                = \"example.com\"\n  enabled              = true\n  signing_key_alias    = \"idp-signing\"\n  encryption_key_alias = \"idp-encryption\"\n\n  jans_auth {\n    enabled   = true\n    client_id = \"shibboleth-client\"\n    scopes    = [\"openid\", \"profile\", \"email\"]\n  }\n}\n</code></pre>","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#argument-reference","title":"Argument Reference","text":"Argument Type Required Description <code>entity_id</code> string Yes IDP entity ID (SAML EntityDescriptor entityID) <code>scope</code> string Yes IDP scope for scoped attributes <code>enabled</code> bool No Whether IDP is enabled (default: true) <code>signing_key_alias</code> string No Alias for signing key (default: idp-signing) <code>encryption_key_alias</code> string No Alias for encryption key (default: idp-encryption) <code>jans_auth</code> block No Janssen Auth Server integration settings","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#jans_auth-block","title":"jans_auth Block","text":"Argument Type Required Description <code>enabled</code> bool No Enable Janssen authentication (default: true) <code>client_id</code> string Yes OAuth client ID <code>client_secret</code> string No OAuth client secret (sensitive) <code>scopes</code> list(string) No OAuth scopes (default: [\"openid\", \"profile\", \"email\"]) <code>redirect_uri</code> string No OAuth redirect URI","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#attributes-reference","title":"Attributes Reference","text":"Attribute Type Description <code>id</code> string Configuration ID <code>metadata_url</code> string URL to IDP metadata","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#jans_shibboleth_trusted_sp","title":"jans_shibboleth_trusted_sp","text":"<p>Manages trusted SAML Service Providers.</p>","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#example-usage_1","title":"Example Usage","text":"<pre><code>resource \"jans_shibboleth_trusted_sp\" \"example_sp\" {\n  entity_id   = \"https://sp.example.org\"\n  name        = \"Example Service Provider\"\n  description = \"Production service provider for example.org\"\n  enabled     = true\n\n  metadata_url = \"https://sp.example.org/metadata\"\n\n  released_attributes = [\n    \"uid\",\n    \"mail\",\n    \"displayName\",\n    \"eduPersonPrincipalName\"\n  ]\n\n  assertion_lifetime = 300\n  sign_assertions    = true\n  encrypt_assertions = true\n}\n</code></pre>","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#argument-reference_1","title":"Argument Reference","text":"Argument Type Required Description <code>entity_id</code> string Yes SP entity ID <code>name</code> string Yes Display name <code>description</code> string No Description <code>enabled</code> bool No Whether SP is enabled (default: true) <code>metadata_url</code> string No URL to SP metadata <code>metadata_file</code> string No Local path to metadata file <code>released_attributes</code> list(string) No Attributes to release <code>assertion_lifetime</code> number No Assertion validity in seconds (default: 300) <code>sign_assertions</code> bool No Sign SAML assertions (default: true) <code>encrypt_assertions</code> bool No Encrypt SAML assertions (default: false)","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#attributes-reference_1","title":"Attributes Reference","text":"Attribute Type Description <code>id</code> string Trusted SP ID <code>created_at</code> string Creation timestamp <code>updated_at</code> string Last update timestamp","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#data-sources","title":"Data Sources","text":"","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#jans_shibboleth_configuration_1","title":"jans_shibboleth_configuration","text":"<p>Read the current IDP configuration.</p> <pre><code>data \"jans_shibboleth_configuration\" \"current\" {}\n\noutput \"idp_entity_id\" {\n  value = data.jans_shibboleth_configuration.current.entity_id\n}\n</code></pre>","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#jans_shibboleth_trusted_sps","title":"jans_shibboleth_trusted_sps","text":"<p>List all trusted Service Providers.</p> <pre><code>data \"jans_shibboleth_trusted_sps\" \"all\" {}\n\noutput \"trusted_sp_count\" {\n  value = length(data.jans_shibboleth_trusted_sps.all.service_providers)\n}\n</code></pre>","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#complete-example","title":"Complete Example","text":"<pre><code>terraform {\n  required_providers {\n    jans = {\n      source  = \"JanssenProject/jans\"\n      version = \"~&gt; 1.0\"\n    }\n  }\n}\n\nprovider \"jans\" {\n  url           = var.jans_url\n  client_id     = var.jans_client_id\n  client_secret = var.jans_client_secret\n}\n\n# Variables\nvariable \"jans_url\" {\n  description = \"Janssen Auth Server URL\"\n  type        = string\n}\n\nvariable \"jans_client_id\" {\n  description = \"OAuth client ID\"\n  type        = string\n}\n\nvariable \"jans_client_secret\" {\n  description = \"OAuth client secret\"\n  type        = string\n  sensitive   = true\n}\n\nvariable \"environment\" {\n  description = \"Environment name\"\n  type        = string\n  default     = \"production\"\n}\n\n# Shibboleth IDP Configuration\nresource \"jans_shibboleth_configuration\" \"idp\" {\n  entity_id            = \"https://idp.${var.environment}.example.com/idp/shibboleth\"\n  scope                = \"example.com\"\n  enabled              = true\n  signing_key_alias    = \"idp-signing\"\n  encryption_key_alias = \"idp-encryption\"\n\n  jans_auth {\n    enabled   = true\n    client_id = \"shibboleth-${var.environment}\"\n    scopes    = [\"openid\", \"profile\", \"email\"]\n  }\n}\n\n# Trusted Service Providers\nresource \"jans_shibboleth_trusted_sp\" \"internal_app\" {\n  entity_id   = \"https://app.example.com\"\n  name        = \"Internal Application\"\n  description = \"Main internal application\"\n  enabled     = true\n\n  metadata_url = \"https://app.example.com/saml/metadata\"\n\n  released_attributes = [\n    \"uid\",\n    \"mail\",\n    \"displayName\"\n  ]\n\n  sign_assertions = true\n}\n\nresource \"jans_shibboleth_trusted_sp\" \"partner_app\" {\n  entity_id   = \"https://partner.external.com\"\n  name        = \"Partner Application\"\n  description = \"External partner application\"\n  enabled     = true\n\n  metadata_url = \"https://partner.external.com/metadata\"\n\n  released_attributes = [\n    \"uid\",\n    \"mail\"\n  ]\n\n  sign_assertions    = true\n  encrypt_assertions = true\n}\n\n# Outputs\noutput \"idp_metadata_url\" {\n  description = \"IDP metadata URL\"\n  value       = jans_shibboleth_configuration.idp.metadata_url\n}\n\noutput \"trusted_sp_ids\" {\n  description = \"Trusted SP entity IDs\"\n  value = [\n    jans_shibboleth_trusted_sp.internal_app.entity_id,\n    jans_shibboleth_trusted_sp.partner_app.entity_id\n  ]\n}\n</code></pre>","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#import","title":"Import","text":"","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#import-idp-configuration","title":"Import IDP Configuration","text":"<pre><code>terraform import jans_shibboleth_configuration.idp shibboleth-config\n</code></pre>","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#import-trusted-sp","title":"Import Trusted SP","text":"<pre><code>terraform import jans_shibboleth_trusted_sp.example \"https://sp.example.org\"\n</code></pre>","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/terraform/#state-management","title":"State Management","text":"<p>For production deployments, use remote state:</p> <pre><code>terraform {\n  backend \"s3\" {\n    bucket = \"terraform-state\"\n    key    = \"janssen/shibboleth.tfstate\"\n    region = \"us-east-1\"\n  }\n}\n</code></pre>","tags":["administration","shibboleth","terraform","infrastructure-as-code"]},{"location":"janssen-server/shibboleth-idp/testing/","title":"Shibboleth IDP Testing Guide","text":"<p>This guide covers testing procedures for the Janssen Shibboleth IDP integration.</p>","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#test-types","title":"Test Types","text":"<ol> <li>Unit Tests - Java unit tests for Config API plugin</li> <li>Integration Tests - API endpoint testing with REST Assured</li> <li>Helm Chart Tests - Template rendering validation</li> <li>End-to-End Tests - Full authentication flow testing</li> </ol>","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#running-unit-tests","title":"Running Unit Tests","text":"","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#config-api-plugin-tests","title":"Config API Plugin Tests","text":"<pre><code>cd jans-config-api/plugins/shibboleth-plugin\nmvn test\n</code></pre>","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#test-configuration","title":"Test Configuration","text":"<p>Configure test properties in <code>src/test/resources/test.properties</code>:</p> <pre><code>shibbolethUrl=http://localhost:8080/jans-config-api\ntokenEndpoint=https://your-server/jans-auth/restv1/token\nclientId=your-test-client\nclientSecret=your-test-secret\nscopes=https://jans.io/oauth/config/shibboleth.readonly https://jans.io/oauth/config/shibboleth.write\n</code></pre>","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#helm-chart-validation","title":"Helm Chart Validation","text":"","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#template-rendering","title":"Template Rendering","text":"<p>Validate the Shibboleth IDP chart renders correctly:</p> <pre><code># Standalone subchart\nhelm template test charts/janssen/charts/shibboleth-idp \\\n  --set replicaCount=2 \\\n  --set hpa.enabled=true\n\n# With parent chart\nhelm template janssen charts/janssen \\\n  --set global.shibboleth-idp.enabled=true \\\n  --set global.cnPersistenceType=sql \\\n  --set global.fqdn=test.example.com\n</code></pre>","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#lint-chart","title":"Lint Chart","text":"<pre><code>helm lint charts/janssen/charts/shibboleth-idp\nhelm lint charts/janssen --set global.shibboleth-idp.enabled=true\n</code></pre>","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#end-to-end-testing","title":"End-to-End Testing","text":"","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#prerequisites","title":"Prerequisites","text":"<ol> <li>Running Janssen Auth Server</li> <li>Configured OAuth client for Shibboleth IDP</li> <li>Test Service Provider with SAML support</li> </ol>","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#test-scenario-1-sp-initiated-sso","title":"Test Scenario 1: SP-Initiated SSO","text":"<ol> <li>Access SP Application</li> <li>Navigate to a protected resource on the SP</li> <li> <p>SP generates SAML AuthnRequest</p> </li> <li> <p>Redirect to IDP</p> </li> <li>SP redirects to Shibboleth IDP SSO endpoint</li> <li> <p>IDP receives SAML request</p> </li> <li> <p>Janssen Auth Authentication</p> </li> <li>IDP redirects to Janssen Auth Server</li> <li>User authenticates (password, MFA, etc.)</li> <li> <p>Auth Server returns OAuth tokens</p> </li> <li> <p>SAML Response</p> </li> <li>IDP creates SAML assertion with user attributes</li> <li> <p>IDP POSTs SAML response to SP ACS</p> </li> <li> <p>Verify Access</p> </li> <li>SP validates SAML response</li> <li>User gains access to protected resource</li> </ol>","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#test-scenario-2-config-api-operations","title":"Test Scenario 2: Config API Operations","text":"<pre><code># Get access token\nACCESS_TOKEN=$(curl -s -X POST \\\n  \"https://your-server/jans-auth/restv1/token\" \\\n  -d \"grant_type=client_credentials\" \\\n  -d \"client_id=test-client\" \\\n  -d \"client_secret=test-secret\" \\\n  -d \"scope=https://jans.io/oauth/config/shibboleth.readonly\" \\\n  | jq -r '.access_token')\n\n# Get IDP configuration\ncurl -H \"Authorization: Bearer $ACCESS_TOKEN\" \\\n  https://your-server/jans-config-api/shibboleth/config\n\n# List trusted SPs\ncurl -H \"Authorization: Bearer $ACCESS_TOKEN\" \\\n  https://your-server/jans-config-api/shibboleth/trust\n</code></pre>","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#test-scenario-3-add-trusted-sp","title":"Test Scenario 3: Add Trusted SP","text":"<pre><code># Create trusted SP\ncurl -X POST \\\n  -H \"Authorization: Bearer $ACCESS_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"entityId\": \"https://sp.example.org\",\n    \"name\": \"Test SP\",\n    \"enabled\": true,\n    \"metadataUrl\": \"https://sp.example.org/metadata\",\n    \"releasedAttributes\": [\"uid\", \"mail\", \"displayName\"]\n  }' \\\n  https://your-server/jans-config-api/shibboleth/trust\n\n# Verify SP was added\ncurl -H \"Authorization: Bearer $ACCESS_TOKEN\" \\\n  https://your-server/jans-config-api/shibboleth/trust/https%3A%2F%2Fsp.example.org\n</code></pre>","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#kubernetes-testing","title":"Kubernetes Testing","text":"","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#deploy-test-environment","title":"Deploy Test Environment","text":"<pre><code># Create namespace\nkubectl create namespace jans-test\n\n# Deploy with Shibboleth enabled\nhelm install janssen charts/janssen \\\n  --namespace jans-test \\\n  --set global.shibboleth-idp.enabled=true \\\n  --set global.fqdn=test.example.com \\\n  --set global.cnPersistenceType=sql\n\n# Wait for pods\nkubectl wait --for=condition=ready pod -l app.kubernetes.io/name=shibboleth-idp -n jans-test --timeout=300s\n\n# Check status\nkubectl get pods -n jans-test -l app.kubernetes.io/name=shibboleth-idp\n</code></pre>","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#verify-idp-status","title":"Verify IDP Status","text":"<pre><code># Port forward\nkubectl port-forward -n jans-test svc/shibboleth-idp 8080:8080 &amp;\n\n# Check IDP status\ncurl http://localhost:8080/idp/status\n\n# Get IDP metadata\ncurl http://localhost:8080/idp/shibboleth\n</code></pre>","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#troubleshooting","title":"Troubleshooting","text":"","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#common-issues","title":"Common Issues","text":"<ol> <li>IDP Status Returns 503</li> <li>Check pod logs: <code>kubectl logs -l app=shibboleth-idp</code></li> <li>Verify Janssen Auth Server is accessible</li> <li> <p>Check OAuth client configuration</p> </li> <li> <p>SAML Response Invalid</p> </li> <li>Verify IDP signing certificate</li> <li>Check attribute release policies</li> <li> <p>Validate SP metadata registration</p> </li> <li> <p>Authentication Fails</p> </li> <li>Check Janssen Auth Server logs</li> <li>Verify OAuth redirect URI configuration</li> <li>Confirm OAuth client scopes</li> </ol>","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#debug-logging","title":"Debug Logging","text":"<p>Enable debug logging in Shibboleth:</p> <pre><code># Kubernetes\nkubectl set env deployment/shibboleth-idp -n jans-test \\\n  IDP_LOG_LEVEL=DEBUG\n\n# Docker\ndocker run -e IDP_LOG_LEVEL=DEBUG janssenproject/shibboleth:5.1.6_dev\n</code></pre>","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/shibboleth-idp/testing/#test-coverage","title":"Test Coverage","text":"Component Test Type Status Config API - GET /config Integration Ready Config API - PUT /config Integration Ready Config API - GET /trust Integration Ready Config API - POST /trust Integration Ready Config API - DELETE /trust Integration Ready Helm Chart Rendering Unit Ready SAML SSO Flow E2E Manual Janssen Auth Integration E2E Manual","tags":["administration","shibboleth","testing"]},{"location":"janssen-server/terraform/","title":"Index","text":"","tags":["administration","terraform","operations","automation","IaC","Infrastructure as Code"]},{"location":"janssen-server/terraform/#benefits-of-terraform-and-iac","title":"Benefits of Terraform and IaC","text":"<p>Consistency: you create one Terraform configuration and use it to configure environments repeatedly.</p> <p>Minimized human error: the configuration is now <code>as code</code> and is deployed automatically.</p> <p>Fast: with a single command, you can have all your configuration provisioned.</p> <p>Observability: the configuration are made <code>as code</code>, you now have one place to review all the configuration and who changed what.</p>","tags":["administration","terraform","operations","automation","IaC","Infrastructure as Code"]},{"location":"janssen-server/terraform/#janssen-terraform-provider","title":"Janssen Terraform provider","text":"<p>Note</p> <p>Every instance of Janssen comes with a set of configurations, which are valid for the whole instance. These resources cannot be created or destroyed, as they are always present in a Janssen instance. Instead, they can be imported and updated. The creation of such a resource will result in an error. Deletion on the other hand will result in the resource being removed from the state file.</p> <p>The Janssen Terraform provider is used to manage resources in a Janssen deployment. This includes all configurations, users, groups, OIDC clients, and more.</p>","tags":["administration","terraform","operations","automation","IaC","Infrastructure as Code"]},{"location":"janssen-server/terraform/#directory-structure","title":"Directory structure","text":"<p>The directory holding Terraform configuration files may look like the following:</p> <pre><code>|-- versions.tf: specify the required providers, i.e. Janssen, with their respective version \n|-- backend.tf: defines where the state file of the current infrastructure will be stored. Terraform keeps track of the managed resources using the Terraform state file.\n|-- variables.tf: specify the variables, with their type and optionally the default values.\n|-- configurations.tf: using the Jans provider and creating other resources.\n|-- clients.tf: file that holds the configuration for Janssen clients creation if needed.\n|-- scopes.tf: file that holds the configuration for Janssen scopes creation if needed.\n|-- scripts.tf: file that holds the configuration for Janssen scripts creation if needed.\n</code></pre>","tags":["administration","terraform","operations","automation","IaC","Infrastructure as Code"]},{"location":"janssen-server/terraform/#example-configure-janssen","title":"Example - Configure Janssen","text":"<p>Let's have an example on <code>importing</code> the current <code>logging level</code> of a deployment and <code>changing</code> it using Terraform.</p> <ol> <li> <p>Configure Terraform to install the required plugins for the <code>Janssen provider</code>. Add this to your <code>versions.tf</code> file:</p> <pre><code>terraform {\n required_providers {\n    jans = {\n    source = \"JanssenProject/jans\"\n    version = \"1.1.5\" #update based on your targeted version\n    }\n }\n}\n</code></pre> </li> <li> <p>Now we can run <code>terraform init</code>, which will fetch the plugins needed.</p> </li> <li> <p>In <code>backend.tf</code> we define where we store the Terraform state file. By default it's stored locally. However, configuring a remote backend like S3 to store the state file allows multiple people to collaborate and work on the same infrastructure.</p> <pre><code>terraform {\n    backend \"local\" {\n        path = \"relative/path/to/terraform.tfstate\"\n    }\n}\n</code></pre> </li> <li> <p>Have a <code>client_id</code> and <code>client_secret</code> with sufficient scopes and permissions.</p> <ul> <li> <p>VM: grab <code>client_id</code> and <code>client_pw</code> from <code>/opt/jans/jans-setup/setup.properties.last</code> file.</p> </li> <li> <p>K8s: </p> <ol> <li> <p>client_id: <code>kubectl get cm cn -n &lt;namespace&gt;  --template={{.data.test_client_id}}</code> </p> </li> <li> <p>client_secret: <code>kubectl get secret cn -n &lt;namespace&gt; --template={{.data.test_client_pw}} | base64 -d</code></p> </li> </ol> </li> </ul> </li> <li> <p>In your <code>variables.tf</code> file, add your <code>client_id</code>, <code>client_secret</code> and <code>FQDN</code> <pre><code>variable \"jans_fqdn\" {\n    description = \"Jans FQQN\"\n    type        = string\n    default     = \"https://demoexample.jans.io\" #Replace with https://&lt;YOUR_DOMAIN&gt;\n    }  \n\n    variable \"jans_client_id\" {\n    description = \"The Jans client id with sufficient scopes\"\n    type        = string\n    default     = \"1800.b8c31be4-952b-4770-b1e8-824187e940c9\" #Replace with your client id \n    }\n\n    variable \"jans_client_secret\" {\n    description = \"The Jans client secret with sufficient scopes\"\n    type        = string\n    default     = \"mf7ELLeF6JSI\" #Replace with your client secret \n    }\n</code></pre></p> </li> <li> <p>Configure the provider section in <code>configurations.tf</code> file:</p> <pre><code>provider \"jans\" {\n    url           = var.jans_fqdn\n    client_id     = var.jans_client_id\n    client_secret = var.jans_client_secret\n    insecure_client = true # Optional. If set to `true`, the provider will not verify the TLS certificate of the Janssen server. This is useful for testing purposes and should not be used in production, unless absolutely unavoidable.\n}\n</code></pre> </li> <li> <p>Before importing, we have to define a <code>resource</code> configuration in <code>configurations.tf</code>:</p> <pre><code>resource \"jans_logging_configuration\" \"global\" {\n\n}\n</code></pre> </li> <li> <p>Import:    <code>terraform import jans_logging_configuration.global global</code></p> <p>Now after importing, the logging configuration is in the Terraform state file, i.e. terraform.tfstate, and it's under Terraform management.</p> <p><code>terraform state list</code> will output: <pre><code>jans_logging_configuration.global\n</code></pre></p> <p>You can see the current logging configuration details using <code>terraform state show jans_logging_configuration.global</code> which will output something like that:  <pre><code># jans_logging_configuration.global:\nresource \"jans_logging_configuration\" \"global\" {\n    disable_jdk_logger          = true\n    enabled_oauth_audit_logging = false\n    http_logging_enabled        = false\n    http_logging_exclude_paths  = []\n    id                          = \"jans_logging_configuration\"\n    logging_layout              = \"text\"\n    logging_level               = \"INFO\"\n}\n</code></pre></p> <p>As you can see the current logging level is <code>INFO</code>. We can double-check that in the <code>TUI</code> </p> </li> <li> <p>Add configuration to your <code>configuration.tf file</code> <pre><code>resource \"jans_logging_configuration\" \"global\" {\nlogging_level = \"TRACE\"\n}\n</code></pre></p> </li> <li> <p>You can run <code>terraform fmt</code> to rewrite Terraform configuration files to a canonical format and style.</p> </li> <li> <p>You can validate your Terraform syntax using <code>terraform validate</code></p> </li> <li> <p>Plan and then apply changes using <code>terraform plan</code> and <code>terraform apply</code> respectivley.</p> </li> <li> <p>Review the changes now using <code>terraform state show jans_logging_configuration.global</code>.      Now it should show <code>logging_level               = \"TRACE\"</code>.</p> </li> <li> <p>We can double-check the <code>logging level</code> in the TUI        </p> </li> </ol> <p>Note</p> <p>You can find the full list of resources you can import and manage using Terraform under the <code>Resources</code> sidebar in the Janssen Terraform documentation</p>","tags":["administration","terraform","operations","automation","IaC","Infrastructure as Code"]},{"location":"janssen-server/test-debug/","title":"Test &amp; Debug","text":"<p>This section provides guidance on testing, debugging, and troubleshooting your Janssen deployment.</p>","tags":["administration","debugging","testing"]},{"location":"janssen-server/test-debug/#logging","title":"Logging","text":"<p>Comprehensive logging helps you monitor and debug your deployment:</p> <ul> <li>Standard Logs - Application and service logs</li> <li>Audit Logs - Security and access audit trails</li> <li>Custom Logs - Configure logging for specific components</li> </ul>","tags":["administration","debugging","testing"]},{"location":"janssen-server/test-debug/#debugging","title":"Debugging","text":"<p>Tools and techniques for troubleshooting:</p> <ul> <li>Script Debugging - Debug custom authentication scripts</li> <li>Remote Debugging - Connect debuggers to running services</li> <li>Health Checks - Monitor service health and availability</li> </ul>","tags":["administration","debugging","testing"]},{"location":"janssen-server/test-debug/#testing","title":"Testing","text":"<ul> <li>Testing Guide - Best practices for testing your deployment</li> <li>Integration Tests - Run automated integration tests</li> </ul>","tags":["administration","debugging","testing"]},{"location":"janssen-server/test-debug/#faq-troubleshooting","title":"FAQ &amp; Troubleshooting","text":"<p>Common issues and solutions for installation, development, and component-specific problems.</p> <p>Use the navigation menu to explore specific topics.</p>","tags":["administration","debugging","testing"]},{"location":"janssen-server/to-be-placed/add-custom-ldifs/","title":"Add custom ldifs","text":""},{"location":"janssen-server/to-be-placed/add-custom-ldifs/#contents","title":"Contents:","text":"<ul> <li>Overview</li> <li>Using Kubernetes?</li> </ul> <p>This guide describes steps to load custom work to Janssen IDP.</p>"},{"location":"janssen-server/to-be-placed/add-custom-ldifs/#hardware-configuration","title":"Hardware configuration","text":"<p>For development and POC purposes, 4GB RAM and 10 GB HDD should be available for Janssen Server. For PROD deployments, please refer installation guide.</p>"},{"location":"janssen-server/to-be-placed/add-custom-ldifs/#prerequisites","title":"Prerequisites","text":"<ul> <li>Existing Janssen server installed</li> </ul>"},{"location":"janssen-server/to-be-placed/add-custom-ldifs/#kubernetes","title":"Kubernetes","text":"<p>If you are using Kubernetes please follow this section. You may create several ldif files denoting each type such as <code>custom_attributes.ldif</code>, <code>custom_clients.ldif</code>..etc. Refer to the built-in <code>ldifs</code> for examples.</p> <ol> <li>Create your custom ldif files. These can be clients, attributes, scopes or whatever custom work you need. The example will be adding a custom attribute and we will call this file <code>custom_attributes.ldif</code>.</li> </ol> <pre><code>dn: inum=C9B1,ou=attributes,o=jans\ndescription: Maiden name of the End-User.Note that in some cultures, people can have multiple given names;all can be present, with the names being separated by space characters.\ndisplayName: Maiden Name\ninum: C9B1\njansAttrEditTyp: user\njansAttrEditTyp: admin\njansAttrName: givenName\njansAttrOrigin: jansPerson\njansAttrTyp: string\njansAttrViewTyp: user\njansAttrViewTyp: admin\njansClaimName: maiden_name\njansSAML1URI: urn:mace:dir:attribute-def:maidenName\njansSAML2URI: urn:oid:2.5.4.42\njansStatus: active\nobjectClass: top\nobjectClass: jansAttr\nurn: urn:mace:dir:attribute-def:maidenName\n</code></pre> <ol> <li>Create a configmap or secret depending on the if the ldif holds and secret data such as a client secret. Here, we will be creating a configmap. </li> </ol> <pre><code>kubectl create cm custom-attributes -n &lt;namespace-of-jans&gt; -f custom_attributes.ldif\n# kubectl create cm custom-attributes -n jans -f custom_attributes.ldif\n# using a secret\n# kubectl create secret generic custom-attributes -n jans -f custom_attributes.ldif\n</code></pre> <ol> <li>Mount the created configmap or secret inside your <code>values.yaml</code></li> </ol> <pre><code>persistence:\n  volumes:\n   - name: custom-attributes\n      configMap:\n        name:  custom-attributes\n  #- name: custom-attributes\n  #  secret:\n  #    secretName: custom-attributes\n  # -- Configure any additional volumesMounts that need to be attached to the containers\n  volumeMounts:\n     - mountPath: \"/app/custom_ldif/custom_attributes.ldif\"\n       name:  custom-attributes\n       subPath: custom_attributes.ldif\n</code></pre> <ol> <li>Run helm upgrade to activate the persistence job.</li> </ol> <pre><code>helm upgrade &lt;release-name&gt; janssen/janssen -f values.yaml -n &lt;jans-namespace&gt;\n</code></pre> <p>Your custom work should be loaded to your persistence. This also persists any changes going forward as you upgrade.</p>"},{"location":"janssen-server/to-be-placed/google/","title":"Sign-in using Google Account","text":"<p>Google's OAuth 2.0 APIs can be used for both authentication and authorization. This document describes how to integrate Google's OAuth 2.0 implementation for authentication thus allowing a user to sign in using his Google account.</p>"},{"location":"janssen-server/to-be-placed/google/#prerequisites","title":"Prerequisites","text":"<ul> <li>A Jans-auth Server (installation instructions)</li> <li>The Google authentication script (included in the default Gluu Server distribution);</li> <li>A Google account.</li> <li>Google API jars namely google-api-client, google-oauth-client and google-http-client-jackson2 added to jans-auth-server</li> </ul>"},{"location":"janssen-server/to-be-placed/google/#google-configuration","title":"Google Configuration","text":"<p>You need OAuth 2.0 credentials, including a client ID and client secret, to authenticate users and gain access to Google's APIs. The following steps explain how to create credentials for your project. Your applications can then use the credentials to access APIs that you have enabled for that project.</p> <ol> <li>Go to the Credentials page.</li> <li>Click Create credentials &gt; OAuth client ID.</li> <li>Select the Web application application type.</li> <li>Name your OAuth 2.0 client and click Create</li> </ol>"},{"location":"janssen-server/to-be-placed/google/#configure-jans-auth-server","title":"Configure jans-auth server","text":""},{"location":"janssen-server/to-be-placed/google/#download-google-client-json-file","title":"Download Google Client JSON file","text":"<p>On the following page, https://console.cloud.google.com/apis/credentials, you will see a table containing your recently created client. Click on the download button and download the JSON file containing details of the Client. Place this file in <code>/etc/certs/google_client_secret.json</code></p>"},{"location":"janssen-server/to-be-placed/google/#add-google-libraries-to-jans-auth-server","title":"Add Google libraries to jans-auth-server","text":"<ul> <li> <p>Copy the google-api-client, google-oauth-client and google-http-client-jackson2 to the following folder inside the jans-auth Server : <code>/opt/jans/jetty/jans-auth/custom/libs</code></p> </li> <li> <p>Edit <code>/opt/jans/jetty/jans-auth/webapps/oxauth.xml</code> and add the following line:</p> <pre><code>&lt;Set name=\"extraClasspath\"&gt;./custom/libs/google-oauth-client-1.33.1.jar,./custom/libs/google-api-client-1.33.2.jar,./custom/libs/google-http-client-jackson2-1.41.5.jar&lt;/Set&gt;&lt;/Configure&gt;\n</code></pre> </li> <li> <p>Restart the <code>jans-auth</code> service <code>systemctl status jans-auth</code></p> </li> </ul>"},{"location":"janssen-server/to-be-placed/google/#properties","title":"Properties","text":"<p>The custom script has the following properties:</p> Property Description Input value google_creds_file Details of the client created on https://console.cloud.google.com/apis/credentials /etc/certs/google_client_secret.json"},{"location":"janssen-server/to-be-placed/google/#enable-google-script-using-admin-console","title":"Enable Google Script using Admin Console","text":"<p>Follow the steps below to enable Google authentication:</p> <ol> <li> <p>Navigate to <code>Admin</code> &gt; <code>Scripts</code></p> </li> <li> <p>Find the <code>google</code> script.</p> </li> <li> <p>Populate the properties table :</p> </li> <li> <p><code>google_creds_file</code>: <code>/etc/certs/google_client_secret.json</code>.</p> </li> <li> <p>Enable the script by checking the box</p> </li> <li> <p>Scroll to the bottom of the page and click <code>Update</code></p> </li> </ol> <p>Note</p> <p>To make sure Google has been enabled successfully, you can check your Gluu Server's OpenID Connect configuration by navigating to the following URL: <code>https://&lt;hostname&gt;/.well-known/openid-configuration</code>. Find <code>\"acr_values_supported\":</code> and you should see <code>\"google\"</code>.</p>"},{"location":"janssen-server/to-be-placed/google/#make-google-the-default-authentication-mechanism","title":"Make Google the Default Authentication mechanism","text":"<p>If <code>google</code> should be the default authentication mechanism, follow these instructions:</p> <ol> <li> <p>Navigate to <code>OAuth Server</code> &gt; <code>Configuration</code> &gt; <code>Defaults</code> &gt; <code>ACR and Logging</code>.</p> </li> <li> <p>Select the <code>Default Authentication Method(Acr):</code> to <code>google</code>.</p> </li> <li> <p>Click Save</p> </li> </ol>"},{"location":"janssen-server/usermgmt/","title":"Local User Management","text":"<p>In this document we will cover managing people in the Jans Server's LDAP Directory, Jans CLI / TUI and using SCIM.</p> Manage Data using DB BrowserUser Management using SCIMManage External Data Sources Using Link <p>You can manage your Janssen Server's data using external tool provided by specific DB. Jump into Manage RDBMS Data section for guidelines to explore Janssen Server's data using pgAdmin.</p> <p>SCIM allows many ways to manage users data. Jump into the SCIM User Management for guidelines of SCIM operations. To know how SCIM works in Janssen Server, read more from here.</p> <p>Janssen Server allows connecting external data sources using Jans Link. Syncing people and attributes from a backend server speeds up authentication transactions. It is possible to perform attribute transformations, changing the name of attributes, or even using an interception script to change the values. Transformations are stored locally in Janssen Server. Read out Link Guide to know more details on it.</p>","tags":["administration","user management"]},{"location":"janssen-server/usermgmt/#manage-data-in-rdbms","title":"Manage Data in RDBMS","text":"<p>During the Janssen server installation, you can choose any of the supported RDBMS from the list; like mysql, or postgreSQL. In this article, We will connect postgreSQL database locally to explore <code>jansDB</code>. Let's see how we can connect PostgreSQL DB from jans server to your local PC.</p>","tags":["administration","user management"]},{"location":"janssen-server/usermgmt/#get-postgresql-db-information","title":"Get PostgreSQL DB Information","text":"<p>Let's get the postgreSQL databse information from the Janssen server properties which is located in <code>/opt/jans/jans-setup/setup.properties.last</code>. Run the following command:</p> Command<pre><code>cat /opt/jans/jans-setup/setup.properties.last | grep 'rdbm_'\n</code></pre> <p>It should print details like below:</p> Output<pre><code>rdbm_db=jansdb\nrdbm_host=localhost\nrdbm_install=True\nrdbm_install_type=1\nrdbm_password=xxxxxxxx\nrdbm_password_enc=xxxxxxxxxxxxx\\=\\=\nrdbm_port=5432\nrdbm_type=pgsql\nrdbm_user=jans\nstatic_rdbm_dir=/opt/jans/jans-setup/static/rdbm\n</code></pre>","tags":["administration","user management"]},{"location":"janssen-server/usermgmt/#create-ssh-tunnel","title":"Create SSH Tunnel","text":"<p>You can create a SSH tunnel with the Janssen Server's database using the following command:</p> <pre><code>ssh -fNL 5432:localhost:5432 [user]@[janssen-server-host]\n</code></pre> <p>Or using <code>pgAdmin</code>'s SSH tunnel option:</p> <p></p>","tags":["administration","user management"]},{"location":"janssen-server/usermgmt/#add-database-in-pgadmin","title":"Add Database in <code>pgAdmin</code>","text":"<p>Let's open pgAdmin in your local pc, and add a server.</p> <p></p> <p>Go to <code>Connection</code> tab add the database as following in the image below:</p> <p></p> <p>Finally, save it and explore.</p>","tags":["administration","user management"]},{"location":"janssen-server/usermgmt/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","user management"]},{"location":"janssen-server/usermgmt/usermgmt-cli-tui/","title":"Jans CLI/TUI User Management","text":"<p>In this document we will cover managing people in the Jans Server's Jans CLI and Jans TUI.</p>","tags":["administration","user management","cli","tui"]},{"location":"janssen-server/usermgmt/usermgmt-cli-tui/#manage-data-in-jans-tui","title":"Manage data in Jans TUI","text":"<p>We can easily add a user using Jans TUI. To do that, run the TUI using <code>jans tui</code> for example, and click on the <code>Users</code> tab.</p> <p></p> <p>Let's see at a glance user attributes.</p> Attributes Username Password First Name Middle Name Last Name Display Name Email Active Nickname CIBA Device Registration Token CIBA User code Locale Website URL IMAP Data jansAdminUIRole Enrollment code User Permission Preferred Language Profile URL Secret Question Email Verified Birthdate Time zone info Phone Number verified Preferred Username TransientId PersistentId Country Secret Answer OpenID Connect JSON formatted address User certificate Organization Picture URL <p>Let's add an user by selecting <code>Add Users</code> tab. Initially we can provide bellow attributes value,</p> <p></p> <p>We can add extra claims simple by slecting <code>Add Claim</code></p> <p></p> <p>Finally <code>save</code> and exit. We will get an unique <code>inum</code></p>","tags":["administration","user management","cli","tui"]},{"location":"janssen-server/usermgmt/usermgmt-cli-tui/#change-user-password","title":"Change User Password","text":"<p>No chance to recover user password, but you can change. To change password of a user navigate/or search user and press key p when the target user is higlighted. In the figure below, passowrd of user sakamura is being changed.</p> <p></p> <p>Once you write new password (it will be displayed while you type), go to button <code>&lt; Save &gt;</code> and press Enter.</p>","tags":["administration","user management","cli","tui"]},{"location":"janssen-server/usermgmt/usermgmt-cli-tui/#manage-user-fido-devices","title":"Manage User FIDO Devices","text":"<p>To view and manage users registered FIDO devices, first navigate/or search user and press key f on the keyboard. If user has any registered FIDO device, a popup will appears as in image below:</p> <p></p> <p>You can veiw details of a device by pressing Enter. To delete a device press key d, you will be prompted for confirmation.</p>","tags":["administration","user management","cli","tui"]},{"location":"janssen-server/usermgmt/usermgmt-jans-link/","title":"Jans Link User Management","text":"","tags":["administration","user management","jans-link"]},{"location":"janssen-server/usermgmt/usermgmt-jans-link/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","user management","jans-link"]},{"location":"janssen-server/usermgmt/usermgmt-jans-link/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","user management","jans-link"]},{"location":"janssen-server/usermgmt/usermgmt-jans-link/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","user management","jans-link"]},{"location":"janssen-server/usermgmt/usermgmt-scim/","title":"SCIM User Management","text":"<p>SCIM is a specification designed to reduce the complexity of user management operations by providing a common user schema and the patterns for exchanging such schema using HTTP in a platform-neutral fashion. The aim of SCIM is achieving interoperability, security, and scalability in the context of identity management.</p> <p>For your reference, the current version of the standard is governed by the following documents: RFC 7642, RFC 7643, and RFC 7644.</p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#installation","title":"Installation","text":"<p>The API is available as a component of Jans Server. Upon installation you can select if you want SCIM included in your environment. To add SCIM post-install do the following:</p> <ol> <li>Run <code>python3 /opt/jans/jans-setup/setup.py --install-scim</code></li> </ol>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#about-api-endpoints","title":"About API endpoints","text":"<p>Throughout this document, you will notice endpoints are prefixed with path: <code>/jans-scim/restv1/v2</code></p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#api-protection","title":"API Protection","text":"<p>Clearly, this API must not be anonymously accessed. However, the basic SCIM standard does not define a specific mechanism to prevent unauthorized requests to endpoints. There are just a few guidelines in section 2 of RFC 7644 concerned with authentication and authorization.</p> <ul> <li>OAUTH, This is the default and recommended mechanism</li> <li>BYPASS</li> </ul> <p>Depending on the scopes associated to a token, you will be granted (or denied) access to perform certain operations. The following lists the available scopes:</p> Scope Actions allowed <code>https://jans.io/scim/users.read</code> Query user resources <code>https://jans.io/scim/users.write</code> Modify user resources <code>https://jans.io/scim/groups.read</code> Query group resources <code>https://jans.io/scim/groups.write</code> Modify group resources <code>https://jans.io/scim/fido.read</code> Query fido resources <code>https://jans.io/scim/fido.write</code> Modify fido resources <code>https://jans.io/scim/fido2.read</code> Query fido 2 resources <code>https://jans.io/scim/fido2.write</code> Modify fido 2 resources <code>https://jans.io/scim/all-resources.search</code> Access the root .search endpoint <code>https://jans.io/scim/bulk</code> Send requests to the bulk endpoint <p>In order to facilitate the process of getting, your Janssen installation already bundles an OAuth client named \"SCIM client\" with support for all the scopes above. This client uses the <code>client_credentials</code> grant type and <code>client_secret_basic</code> mechanism to authenticate to the token endpoint.</p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#where-to-locate-scim-related-logs","title":"Where to locate SCIM-related logs","text":"<p>Please see Janssen SCIM logs documentation for additional logs:</p> <ul> <li>SCIM log is located at <code>/opt/jans/jetty/jans-scim/logs/scim.log</code></li> <li>If you use SCIM custom script aslo see <code>/opt/jans/jetty/jans-scim/logs/scim_script.log</code></li> </ul>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#api-documentation-at-a-glance","title":"API documentation at a glance","text":"<p>SCIM API doc page describes about our implementation of SCIM. The API has also been documented using OpenAPI (swagger) specification for the interested. Find yaml files here.</p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#working-in-oauth-mode","title":"Working in OAuth mode","text":"<p>To know more about OAuth protection mode please visit here. The SCIM API endpoints are by default protected by (Bearer) OAuth 2.0 tokens. Depending on the operation, these tokens must have certain scopes for the operations to be authorized. We need a client to get Bearer token.</p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#get-scim-client","title":"Get SCIM Client","text":"<p>You can refer to here for this topic</p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#get-access-token","title":"Get Access token","text":"<p>You can refer to here for this topic</p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#retrieve-existing-user","title":"Retrieve existing User","text":"<p>You can refer to here for this topic</p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#creating-resource","title":"Creating Resource","text":"","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#create-an-user","title":"Create an User","text":"<p>You can refer to here for this topic</p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#updating-a-userput","title":"Updating a User(PUT)","text":"<p>You can refer to here for this topic</p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#updating-a-user-patch","title":"Updating a User (PATCH)","text":"<p>You can refer to here for this topic</p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#deleting-users","title":"Deleting Users","text":"<p>You can refer to here for this topic</p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#how-is-scim-data-stored","title":"How is SCIM data stored?","text":"<p>You can refer to here for this topic</p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#fido-devices","title":"FIDO Devices","text":"<p>You can refer to here for this topic.</p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#fido-2-devices","title":"FIDO 2 devices","text":"<p>You can refer to here for this topic.</p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#potential-performance-issues-with-group-endpoints","title":"Potential performance issues with Group endpoints","text":"<p>In SCIM a group resource basically consists of an identifier, a display name, and a collection of members associated to it. Also, every member is made up of a user identifier, his display name, and other attributes. As a consequence, retrieving group information requires making a correlation with existing user data. Since Gluu database model does not follow a relational database pattern this may entail a considerable amount of user queries when groups contain thousands of members.</p> <p>While this could have been workarounded by storing members' display names inside group entries, this brings additional problems to deal with.</p> <p>Another source of potential overhead stems from creation and modification of groups where many new users are associated to a given group: by default checks are made to guarantee only existing users are attached to groups, thus requiring continuous database queries.</p> <p>Currently there are two ways to lower the amount of database lookups required for SCIM group operations:</p> <ul> <li>Explicitly excluding display names from responses</li> <li>Pass the overhead bypass flag to skip members validations</li> </ul> <p>The first approach consists of using the query parameter <code>excludedAttributes</code> (see RFC 7644) so that display names are neither retrieved from database nor sent in responses. A value like <code>members.display</code> does the job. Note the query parameter attributes can also be used for this purpose, for example with a value like <code>members.value</code> that will output only members' identifiers and ignore other non-required attributes.</p> <p>This approach is particularly useful in search and retrievals when users' display names are not needed.</p> <p>The second is a stronger approach that turns off validation of incoming members data: if the usage of a POST/PUT/PATCH operation implies adding members, their existence is not verified, they will simply get added. Here, the client application is responsible for sending accurate data. To use this approach add a query or header parameter named <code>Group-Overhead-Bypass</code> with any value. Note under this mode of operation:</p> <ul> <li>Display names are never returned regardless of <code>attributes</code> or <code>excludedAttributes</code> parameters values</li> <li>Remove/replace patch operations that involve display names in path filters are ignored, eg: <code>\"path\": \"members[value eq \\\"2819c223\\\" or display eq \\\"Joe\\\"]\"</code></li> </ul>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#user-registration-process-with-scim","title":"User Registration Process with SCIM","text":"<p>SCIM service has many use cases. One interesting and often arising is that of coding your own user registration process. With your SCIM endpoints you can build a custom application to maintain user entries in your database.</p>","tags":["administration","user management","scim"]},{"location":"janssen-server/usermgmt/usermgmt-scim/#important-considerations","title":"Important Considerations","text":"<p>Here, you have some useful tips before you start:</p> <ol> <li> <p>Choose a toolset you feel comfortable to work with. Keep in mind that you have to leverage the capabilities of your language/framework to issue complex HTTPS requests. Be sure that:</p> <ul> <li> <p>You will be able to use at least the following verbs: GET, POST, PUT, and DELETE</p> </li> <li> <p>You can send headers in your requests as well as reading them from the service response</p> </li> </ul> </li> <li> <p>If not supported natively, choose a library to facilitate JSON content manipulation. As you have already noticed we have been dealing with JSON for requests as well as for responses. Experience shows that being able to map from objects (or data structures) of your language to Json and viceversa helps saving hours of coding.</p> </li> <li> <p>Shape your data model early. List the attributes your application will operate upon and correlate with those found in the SCIM user schema. You can learn about the schema in RFC 7644. At least, take a look at the JSON-formatted schema that your Jans Server shows: visit <code>https://&lt;host-name&gt;/jans-scim/restv1/v2/Schemas/urn:ietf:params:scim:schemas:core:2.0:User</code></p> </li> <li> <p>You will have to manipulate database contents very often as you develop and run tests, thus, find a suitable tool for the task. In the case of LDAP, a TUI client is a good choice.</p> </li> <li> <p>Always check your logs.</p> </li> <li> <p>In this user management guide with SCIM, we have already touched upon the fundamentals of SCIM in Jans Server and shown a good amount of sample requests for manipulation of user information. However, keep in mind the SCIM spec documents are definitely the key reference to build working request messages, specially RFC 7643, and RFC 7644.</p> </li> </ol>","tags":["administration","user management","scim"]},{"location":"janssen-server/vm-ops/","title":"Janssen VM Operations Guide","text":"<p>While fancy container orchestrated deployments are all the rage, there are still lots of reasons to deploy Janssen on a good, old-fashioned, virtual machine, or even an actual bare-metal server! Here is a partial list:</p> <ol> <li>Lower bar for system administration - Cloud native requires specialized training which your operational staff doesn't need if you stick with plain Linux packages.</li> <li>Operational simplicity - Simplicity = lower cost of ownership and in many cases, better security. Running one server, doing a good job at monitoring and backup--this will enable you to achieve 99.9% uptime (8 hours of downtime per year), which may be enough to meet the SLA you've negotiated with your management.</li> <li>Air-gapped deployments - Maybe you don't have a cloud because you are deploying your server on a small air-gapped network.</li> <li>Developer - If you are a developer who is used to running a bunch of VM's on your workstation, this is still a nice option to have.</li> <li>Linux Zealot - You love Linux and you're happy with it! Enough said.</li> </ol> <p>If you fit into any of the above categories, or another one that leads you to deploy Janssen Linux packages, this operational guide is a quick reference for some of the things you need to do for the \"care and feeding\" of a healthy federated identity platform.</p>","tags":["administration","vm","operations"]},{"location":"janssen-server/vm-ops/backup/","title":"Janssen VM Backup","text":"<p>Best method of Janssen Backup is \"VM Snapshot\" backup. That means, backup / take snapshot of whole virtual machine / droplet / instance which is hosting your Gluu Janssen software. In the event of a production outage, a proper snapshot of the last working condition will help rapidly restore service.</p> <p>Most platform virtualization software and cloud vendors have snapshot backup features. For instance, Digital Ocean has Live Snapshot and Droplet Snapshot; VMWare has Snapshot Manager, etc.</p> <p>The Gluu Server should be backed up frequently--we recommend at least one daily and one weekly backup of Gluu's data and/or VM.</p> <p>It's also good to have some partial configuration backup as well. Such as:</p> <ul> <li>Tarball <code>/opt</code></li> <li>Tarball <code>/etc/jans</code></li> <li>Tarball <code>/etc/apache2</code></li> <li>Tarball <code>/var/jans</code></li> </ul>","tags":["administration","vm","operations","backup"]},{"location":"janssen-server/vm-ops/backup/#tarball-method","title":"Tarball Method","text":"<p>All Jans Server files live in a single folder: /opt. The entire Jans Server folder can be archived using the tar command:</p> <ul> <li> <p>Stop the server: <code>systemctl stop list-units --all \"jans*\"</code></p> </li> <li> <p>Use tar to take a backup: <code>tar cvf jans-backup.tar /opt/jans/</code></p> </li> <li> <p>Start the server again: <code>systemctl start list-units --all \"jans*\"</code></p> </li> </ul>","tags":["administration","vm","operations","backup"]},{"location":"janssen-server/vm-ops/certificates/","title":"Janssen Certificates","text":"<p>Janssen components have cryptographic keys and X.509 certificates that are stored on the filesystem at the time of installation. Details for certificates associated with each component are provided below. The following certificates are available in the <code>/etc/certs</code> folder.</p> APACHE Jans Auth CA Certificates httpd.crt jans-auth-keys.p12 https.csr httpd.key httpd.key.orig","tags":["administration","vm","operations","certificates"]},{"location":"janssen-server/vm-ops/certificates/#custom-script-json-files","title":"Custom Script JSON Files","text":"<p>Additionally the following json files are available which are used in different custom scripts for multi-factor authentication.</p> <ul> <li><code>cert_creds.json</code></li> <li><code>duo_creds.json</code></li> <li><code>gplus_client_secrets.json</code></li> <li><code>otp_configuration.json</code></li> <li><code>super_gluu_creds.json</code></li> <li><code>vericloud_jans_creds.json</code></li> </ul>","tags":["administration","vm","operations","certificates"]},{"location":"janssen-server/vm-ops/certificates/#updating-certificates","title":"Updating certificates","text":"<p>On a fresh VM installation, Janssen generates self signed certificates. You will want to change these to real certificates. For this documentation we will use certbot using Let's Encrypt certificates. Certbot recommends using <code>snap</code> to install certbot and obtain certificates. The following instructions are for Ubuntu 20; however, any platform supporting <code>snap</code> should work.</p> <ul> <li>Backup the <code>/etc/certs</code> folder on your server</li> <li>Install snap    <pre><code>sudo snap install core; sudo snap refresh core\n</code></pre></li> <li>Remove any certbot OS packages. This varies across distributions.     For Ubuntu:     <pre><code>sudo apt remove certbot\n</code></pre></li> <li>Update repo:    For Ubuntu:    <pre><code>sudo apt update\n</code></pre></li> <li>Install python package for apache:     For Ubuntu:     <pre><code>sudo apt-get install python3-certbot-apache\n</code></pre></li> <li>Issue certificate:     <pre><code>certbot --apache -d fqdn_of_Gluu_server\n</code></pre></li> <li>Full certificate chain and key are available in: <code>/etc/letsencrypt/live/</code> location.</li> <li>Reboot your server</li> </ul>","tags":["administration","vm","operations","certificates"]},{"location":"janssen-server/vm-ops/certificates/#installing-intermediate-certificates","title":"Installing intermediate certificates","text":"<p>Please follow these steps to install intermediate certificates:</p> <ul> <li>Place your intermediate certificate file in <code>/etc/certs</code></li> <li>Modify <code>/etc/apache2/sites-available/https_jans.conf</code> and add <code>SSLCertificateChainFile /etc/certs/name_of_your_interm_root_cert.crt</code> under the line containing <code>SSLCertificateKeyFile</code></li> <li>Restart the <code>httpd/apache2</code> service</li> </ul>","tags":["administration","vm","operations","certificates"]},{"location":"janssen-server/vm-ops/checking-service-status/","title":"Janssen System Services","text":"<p>In order to debug issues, checking the Jans services may be necessary. The process to do this differs slightly between operating systems. The following examples are shown on Ubuntu 20.04; however, they should work on any operating system using systemd.</p>","tags":["administration","vm","operations","services","status"]},{"location":"janssen-server/vm-ops/checking-service-status/#getting-list-of-jans-services","title":"Getting list of Jans services","text":"<pre><code>$ sudo systemctl list-units --all \"jans*\"\nUNIT                    LOAD   ACTIVE SUB     DESCRIPTION               \njans-auth.service       loaded active running Janssen OAauth service    \njans-config-api.service loaded active running Janssen Config API service\njans-fido2.service      loaded active running Janssen Fido2 Service     \njans-scim.service       loaded active running Janssen Scim service      \n\nLOAD   = Reflects whether the unit definition was properly loaded.\nACTIVE = The high-level unit activation state, i.e. generalization of SUB.\nSUB    = The low-level unit activation state, values depend on unit type.\n\n5 loaded units listed.\n</code></pre>","tags":["administration","vm","operations","services","status"]},{"location":"janssen-server/vm-ops/checking-service-status/#other-services","title":"Other Services","text":"<p>There are more services other than Jans services like Apache. To get the status of those services make sure you use command like</p> <pre><code>sudo systemctl list-units --all \"apache2*\"\n</code></pre> <p>Note: depending on your OS and the components of Jans installed, the output may be different.</p>","tags":["administration","vm","operations","services","status"]},{"location":"janssen-server/vm-ops/checking-service-status/#checking-status-of-a-service","title":"Checking status of a service","text":"<pre><code>$ sudo systemctl status jans-auth.service\n\u25cf jans-auth.service - Janssen OAauth service\n     Loaded: loaded (/etc/systemd/system/jans-auth.service; enabled; vendor preset: enabled)\n     Active: active (running) since Tue 2022-11-01 15:03:23 UTC; 1h 38min ago\n    Process: 44700 ExecStart=/opt/dist/scripts/jans-auth start (code=exited, status=0/SUCCESS)\n   Main PID: 44727 (java)\n      Tasks: 60 (limit: 4677)\n     Memory: 889.2M\n     CGroup: /system.slice/jans-auth.service\n             \u2514\u250044727 /opt/jre/bin/java -server -Xms256m -Xmx928m -XX:+DisableExplicitGC -Djans.base=/etc/jans -Dserver.base=/opt/jans/jetty/jan&gt;\n</code></pre> <p>In case of an error or a non-functional component, this is where you would find information about the component.</p>","tags":["administration","vm","operations","services","status"]},{"location":"janssen-server/vm-ops/data-cleaning/","title":"Data Cleaning","text":"<p>Janssen setup creates a crontab for cleaning data from database backend. The data cleaning process cleans those expired data from SQL tables. In general temporary data has the following fields set:</p> <p>__del__This is a boolean field indicating that the data can be deleted when it expires.</p> <p>__exp__This is a datetime field indicating expire time.</p> <p>The cleaning script examines the following tables and deletes row whose <code>del</code> field is <code>TRUE</code> and <code>exp</code> field contains a date-time that is older than current time. The following tables are examined:</p> <ul> <li>jansSsa</li> <li>jansClnt</li> <li>jansScope</li> <li>jansSessId</li> <li>jansAuthChallSess</li> <li>jansArchJwk</li> <li>jansUmaResource</li> <li>jansUmaResourcePermission</li> <li>jansToken</li> <li>jansUmaRPT</li> <li>jansDeviceRegistration</li> <li>jansU2fReq</li> <li>jansMetric</li> <li>jansClntAuthz</li> <li>jansUmaPCT</li> <li>jansCache</li> <li>jansFido2AuthnEntry</li> <li>jansFido2RegistrationEntry</li> <li>jansPar</li> </ul> <p>Setup creates a crontab entry named <code>/etc/cron.d/jans-session</code> with the following content:</p> <pre><code>@hourly root python3 /opt/jans/data-cleaner/clean-data.py --yes -limit=1000\n</code></pre> <p>This means, script <code>/opt/jans/data-cleaner/clean-data.py</code> is executed hourly with the deletion limit set to <code>1000</code>. You can change the content of crontab entry if you know what to do, but rather we recommend using a script.</p> Command<pre><code>/opt/jans/data-cleaner/jans-clean-data-crontab.py\n</code></pre> <p>This script creates a crontab entry with the following argument:</p> <pre><code>__-limit__Limit to delete entry per execution\n\n__-interval__{everyminute, hourly, daily, weekly, monthly, midnight}\n</code></pre> <p>For example, to create a crontab entry that is executed daily with deleting 5000 data, you can execute the following command:</p> Command<pre><code>/opt/jans/data-cleaner/jans-clean-data-crontab.py -interval daily -limit 5000\n</code></pre> <p>The data cleaning script <code>clean-data.py</code> determines the number of entries deleted from its argument <code>-limit</code> and reads configuration from <code>/opt/jans/data-cleaner/data-clean.ini</code>. Example configuration:</p> <pre><code>[main]\ntables = jansSsa jansClnt jansScope jansSessId jansAuthChallSess jansArchJwk jansUmaResource jansUmaResourcePermission jansToken jansUmaRPT jansDeviceRegistration jansU2fReq jansMetric jansClntAuthz jansUmaPCT jansCache jansFido2AuthnEntry jansFido2RegistrationEntry jansPar\ncleanUpInactiveClientAfterHoursOfInactivity=2\n</code></pre> <p>As you can infer, the script deletes expired data from tables listed in key <code>tables</code>. Tables should be separated by space. There is one more cleaning process for table <code>jansClnt</code>. This table contains clients that may be deleted if the last access time is older than the current time before a specific hour that is determined from <code>cleanUpInactiveClientAfterHoursOfInactivity</code>. For example, if <code>del</code> is set to <code>TRUE</code> for the client and <code>jansLastAccessTime</code> is 2 hours older than current time, the client is deleted.</p> <p>The data cleaning script logs all its operations as well as SQL queries and query outputs to <code>/opt/jans/data-cleaner/logs/data-clean.log</code></p> <p>You can safely execute <code>clean-data.py</code> script manually whenever you need cleaning data.</p>","tags":["administration","vm","operations"]},{"location":"janssen-server/vm-ops/jans-command/","title":"Jans Command Overview","text":"<p>The <code>jans</code> command is a top-level wrapper script for managing the Janssen Server. This guide provides an overview of its usage and available commands. List of available commands may change as more commands are added. To see the current list of commands available in your installation, run following command at the Janssen Server:</p> Command<pre><code>jans\n</code></pre>","tags":["administration","vm","operations","jans wrapper command"]},{"location":"janssen-server/vm-ops/jans-command/#available-commands","title":"Available Commands","text":"","tags":["administration","vm","operations","jans wrapper command"]},{"location":"janssen-server/vm-ops/jans-command/#version-and-build-information","title":"Version and build information","text":"<p>Displays the version and build information of the currently installed Janssen Server.</p> <p>Command<pre><code>jans version\n</code></pre> </p>","tags":["administration","vm","operations","jans wrapper command"]},{"location":"janssen-server/vm-ops/jans-command/#cli","title":"CLI","text":"<p>Invokes the Janssen Command-Line Interface.</p> Command<pre><code>jans cli\n</code></pre>","tags":["administration","vm","operations","jans wrapper command"]},{"location":"janssen-server/vm-ops/jans-command/#tui","title":"TUI","text":"<p>Launches the text-based user interface for Janssen.</p> Command<pre><code>jans tui\n</code></pre>","tags":["administration","vm","operations","jans wrapper command"]},{"location":"janssen-server/vm-ops/jans-command/#logs","title":"Logs","text":"<p>Shows the log file paths for various Janssen Server modules.</p> <p>Command<pre><code>jans logs\n</code></pre> </p>","tags":["administration","vm","operations","jans wrapper command"]},{"location":"janssen-server/vm-ops/jans-command/#status","title":"Status","text":"<p>Displays the status of Janssen Server module services.</p> <p>Command<pre><code>jans status\n</code></pre> </p>","tags":["administration","vm","operations","jans wrapper command"]},{"location":"janssen-server/vm-ops/jans-command/#start","title":"Start","text":"<p>Starts services for the Janssen Server.</p> <p>Command<pre><code>     jans start\n</code></pre> </p> <p>Start a specific service.</p> sample command<pre><code>jans start -service=jans-config-api\n</code></pre> Sample Output<pre><code>Executing sudo systemctl start jans-config-api\n</code></pre>","tags":["administration","vm","operations","jans wrapper command"]},{"location":"janssen-server/vm-ops/jans-command/#stop","title":"Stop","text":"<p>Stops services for the Janssen Server. Command<pre><code>jans stop\n</code></pre></p> <p></p> <p>Stop a specific service.</p> <p>Command<pre><code>jans stop -service=jans-config-api\n</code></pre> Sample Output<pre><code>Executing sudo systemctl stop jans-config-api\n</code></pre></p>","tags":["administration","vm","operations","jans wrapper command"]},{"location":"janssen-server/vm-ops/jans-command/#restart","title":"Restart","text":"<p>Restart services for the Janssen Server.</p> <p>Command<pre><code>jans restart\n</code></pre> </p> <p>Restart a specific service.</p> Sample Command<pre><code>jans restart -service=jans-config-api\n</code></pre> Sample Output<pre><code>Executing sudo systemctl restart jans-config-api\n</code></pre>","tags":["administration","vm","operations","jans wrapper command"]},{"location":"janssen-server/vm-ops/jans-command/#health","title":"Health","text":"<p>Retrieves health status from the Janssen services health-check endpoint.</p> <p>Command<pre><code>jans health\n</code></pre> </p> <p>Health check for specific service.</p> Command<pre><code>jans health -service=&lt;service-name&gt;\n</code></pre> sample Output<pre><code>Checking health status for jans-config-api\n  Executing curl -s http://localhost:8074/jans-config-api/api/v1/health/live\n  Command output: {\"name\":\"jans-config-api liveness\",\"status\":\"UP\"}\n</code></pre>","tags":["administration","vm","operations","jans wrapper command"]},{"location":"janssen-server/vm-ops/jans-command/#info","title":"Info","text":"<p>Lists important URLs such as <code>.well-known</code> endpoints.</p> <p>Command<pre><code>jans info\n</code></pre> </p>","tags":["administration","vm","operations","jans wrapper command"]},{"location":"janssen-server/vm-ops/logs/","title":"Janssen Log Configuration","text":"<p>The Janssen logs can be viewed via SSH access to the server running the Janssen installation.</p>","tags":["administration","vm","operations","log-levels"]},{"location":"janssen-server/vm-ops/logs/#log-levels","title":"Log Levels","text":"<p>The following log levels can be configured through the configuration CLI:</p> Log Level Messages Logged Trace All messages Debug Debug level and above Info Informational level and above Warn Warning level and above Error Error level and above Fatal Only fatal errors Off Logging is disabled","tags":["administration","vm","operations","log-levels"]},{"location":"janssen-server/vm-ops/logs/#configuring-log-levels","title":"Configuring Log Levels","text":"<p>Use the following commands to get information on the logging module configuration:</p> <ul> <li>To get the logging configuration operation ID: <code>jans cli --info ConfigurationLogging</code></li> <li>Output would be:      <pre><code># Log configuration operations\nOperation ID: get-config-logging\nDescription: Returns Jans Authorization Server logging settings.\nOperation ID: put-config-logging\nDescription: Updates Jans Authorization Server logging settings.\nSchema: /components/schemas/LoggingConfiguration\n</code></pre></li> <li>To get sample schema type <code>jans cli --schema &lt;schma&gt;</code>,    for example <code>jans cli --schema /components/schemas/LoggingConfiguration</code></li> <li>Output:      <pre><code># Generic configuration schema\n {\n   \"loggingLevel\": \"TRACE\",\n   \"loggingLayout\": \"json\",\n   \"httpLoggingEnabled\": true,\n   \"disableJdkLogger\": false,\n   \"enabledOAuthAuditLogging\": true,\n   \"externalLoggerConfiguration\": null,\n   \"httpLoggingExcludePaths\": [\n     \"/auth/img\",\n     \"/auth/stylesheet\"\n   ]\n }\n</code></pre></li> <li>Status of current configuration logging: <code>jans cli --operation-id get-config-logging</code></li> <li>Output:      <pre><code>  # Current log configuration\n  {\n    \"loggingLevel\": \"INFO\",\n    \"loggingLayout\": \"text\",\n    \"httpLoggingEnabled\": false,\n    \"disableJdkLogger\": true,\n    \"enabledOAuthAuditLogging\": false,\n    \"externalLoggerConfiguration\": null,\n    \"httpLoggingExcludePaths\": null\n  }\n</code></pre></li> </ul> <p>Let's assume we want to update logging configuration to <code>TRACE</code>. To do this, create a file <code>/tmp/log.json</code> with the following content: <pre><code>{\n  \"loggingLevel\": \"TRACE\",\n  \"loggingLayout\": \"text\",\n  \"httpLoggingEnabled\": false,\n  \"disableJdkLogger\": true,\n  \"enabledOAuthAuditLogging\": false,\n  \"externalLoggerConfiguration\": null,\n  \"httpLoggingExcludePaths\": null\n}\n</code></pre> And use the PUT operation with this file as the payload: <pre><code>jans cli --operation-id put-config-logging --data /tmp/log.json\n</code></pre> The server will now have logs set to TRACE.</p>","tags":["administration","vm","operations","log-levels"]},{"location":"janssen-server/vm-ops/logs/#setup-logs","title":"Setup Logs","text":"<p>The Jans setup logs are available under <code>/opt/jans/jans-setup/logs/</code>. There are several log files available involving the setup process:</p> <ol> <li>mysql.log (Only used if MySQL backend is chosen during setup)</li> <li>os-changes.log</li> <li>setup.log</li> <li>setup_error.log</li> </ol>","tags":["administration","vm","operations","log-levels"]},{"location":"janssen-server/vm-ops/logs/#core-logs","title":"Core Logs","text":"<p>The available logs for Jans server are listed below:</p>","tags":["administration","vm","operations","log-levels"]},{"location":"janssen-server/vm-ops/logs/#config-api-logs","title":"Config API logs","text":"<p><code>/opt/jans/jetty/jans-config-api/logs/</code></p> Log File Description configapi.log Config API main log configapi_persistence.log Config API persistence log configapi_persistence_duration.log Config API persistence operation duration log [date].jetty.log Config API Jetty log configapi_script.log Config API custom script log","tags":["administration","vm","operations","log-levels"]},{"location":"janssen-server/vm-ops/logs/#jans-auth-server-logs","title":"Jans Auth server logs","text":"<p><code>/opt/jans/jetty/jans-auth/logs/</code></p> <p>The most important log files here are described below:</p> <ol> <li><code>jans-auth.log</code>: This log file contains most authentication related information. Generally this is the first log to review for any authentication-related troubleshooting, like authentication failure or missing clients etc.</li> <li><code>jans-auth_persistence.log</code>: This log file contains information about the Jans Auth server communicating with the persistence backend. </li> <li><code>jans-auth_script.log</code>: This log file contains debug messages printed from interception scripts.</li> </ol>","tags":["administration","vm","operations","log-levels"]},{"location":"janssen-server/vm-ops/logs/#jans-fido2-server-logs","title":"Jans Fido2 server logs","text":"<p><code>/opt/jans/jetty/jans-fido2/logs/</code> 1. <code>jetty.log</code>: Logs web server activity and HTTP request handling by the Jetty server. 1. <code>fido2.log</code>: Logs FIDO2 authentication and registration events. 1. <code>fido2_persistence.log</code>: Logs database operations for storing FIDO2 credentials and metadata. 1. <code>fido2_persistence_duration.log</code>:  Logs the time taken for FIDO2 data persistence operations (database-related action when storing &amp; retrieving data). 1. <code>fido2_script.log</code>: Logs execution and outcomes of custom scripts used in FIDO2 flows. we can change logging level of fido server from TUI or CLI as well , check more details here</p>","tags":["administration","vm","operations","log-levels"]},{"location":"janssen-server/vm-ops/logs/#server-logs","title":"Server Logs","text":"<p>In some cases, it may be necessary to examine the server logs themselves.</p>","tags":["administration","vm","operations","log-levels"]},{"location":"janssen-server/vm-ops/logs/#os-logs","title":"OS Logs","text":"<ul> <li>For Debian based systems: <code>/var/log/syslog</code></li> <li>For RPM based systems: <code>/var/log/messages</code></li> </ul>","tags":["administration","vm","operations","log-levels"]},{"location":"janssen-server/vm-ops/logs/#apache2-server-logs","title":"Apache2 Server Logs","text":"<ul> <li>For Debian based systems: <code>/var/log/apache2/</code></li> <li>For RPM based systems: <code>/var/log/httpd/</code></li> </ul> <p>Apache2 logs are as follows:</p> <ol> <li> <p><code>access_log</code>: This log contains information about requests coming into the Jans Server, success status or requests, execution time for any request etc.     </p> </li> <li> <p><code>error_log</code>: This log shows error messages if the web server encounter any issue while processing incoming requests.    </p> </li> <li> <p><code>other_vhosts_access.log</code>: This log is specific to the Jans Server setup and those links which are being requested by a user from a web browser.</p> </li> </ol>","tags":["administration","vm","operations","log-levels"]},{"location":"janssen-server/vm-ops/managing-key-rotation/","title":"Managing Key Rotation","text":"<p>\"Key-rotation\" is a standard procedure for all OpenID Connect deployment. \"Key-rotation\" means replacing existing signing key with newer cryptographic key. For Janssen server, that specific cryptographic key is <code>jans-auth-keys.pkcs12</code>.</p> <p>There are two possible ways to manage key rotation: - built-in key rotation - external key rotation</p> <p>For VM by default built-in key rotation is on.</p> <p>Key alias or <code>kid</code> has following format (example <code>connect_76297462-a3f8-498e-afc2-670285292553_sig_rs256</code>):</p> <pre><code>&lt;operation_type&gt;_&lt;guid&gt;_&lt;use&gt;_&lt;algorithm&gt;\n</code></pre> <ul> <li>operation_type - specifies operation type of the key, possible values:</li> <li>connect - used for OpenID Connect - usually expirable key</li> <li>ssa - used for SSA - usually with very big expiration date (almost non-expirable)</li> <li>all - key can be use for both <code>connect</code> and <code>ssa</code> </li> <li>guid - unique identifier</li> <li>use - use purpose, possible values are <code>sig</code> for signature and <code>enc</code> for encryption  </li> <li>algorithm - algorithm use with given key</li> <li>in signature case it can be <code>RS256</code>, <code>RS384</code>, <code>RS512</code>, <code>ES256</code>, <code>ES384</code>, <code>ES512</code>, <code>PS256</code>, <code>PS384</code>, <code>PS512</code></li> <li>in encryption case it can be <code>RSA1_5</code>, <code>RSA-OAEP</code></li> </ul> <p>Key rotation means that new keys are generated and old ones are removed for given algorithm (full replacement).</p> <p>Keys are stored in: - key store file (specified by <code>keyStoreFile</code>) - on persistence level jwks representation of the key are stored in <code>jansConfWebKeys</code> attribute of <code>jansAppConf</code> entity</p> <p>It's important to note that key inside key store file must have representation in jwks and vice versa. It must be always in sync otherwise AS will throw error.</p> <p>Configuration properties related to key store file: - <code>keyStoreFile</code> - The Key Store File (JKS or PKCS12) - <code>keyStoreSecret</code> - The Key Store password</p>","tags":["administration","vm","operations"]},{"location":"janssen-server/vm-ops/managing-key-rotation/#built-in-key-rotation","title":"Built-in key rotation","text":"<p><code>jans-auth-server</code> has KeyGeneratorTimer which is responsible for key rotation. Built-in rotation can be switch on/off via <code>keyRegenerationEnabled</code> AS configuration property (by setting <code>true</code> or <code>false</code> value).</p> <pre><code>graph LR\nA[Auth Server] --&gt; V(Properties)\n</code></pre> <pre><code>erDiagram\n    keyRotation {\n        string keyRegenerationEnabled \"True\"\n        string keyRenerationInterval  \"48\"\n        string keySelectionStrategy \"OLDER\"\n        string keySignWithSameKeyButDiffAlg \"False\"\n        string keyStoreFile \"/etc/certs/jans-auth-keys.pkcs12\"\n    }</code></pre> <p>Configuration properties relation to built-in rotation: - <code>keyRegenerationEnabled</code> - boolean value specifying whether to turn on (<code>true</code> value) or off (<code>false</code> value) built-in key rotation - <code>keyRegenerationInterval</code> - the interval for key regeneration in hours - <code>keyAlgsAllowedForGeneration</code> - List of algorithm allowed to be used for key generation</p> <p>Expiration date during built-in rotation is set as <code>now</code> + <code>keyRegenerationInterval</code>.</p>","tags":["administration","vm","operations"]},{"location":"janssen-server/vm-ops/managing-key-rotation/#external-key-rotation","title":"External key rotation","text":"<p>External rotation means that keys are rotated by script. In this case <code>keyRegenerationEnabled</code> must be set to <code>false</code> value. Script can be scheduled to run periodically. Such script must invoke <code>KeyGenerator</code> class from <code>jans-auth-client-jar-with-dependencies.jar</code> which will keep keys in key store and in AS persistence consistent. See Key Generation page for more details how to generate keys externally.</p> <pre><code>/opt/jre/bin/java -Dlog4j.defaultInitOverride=true -cp /opt/dist/jans/jans-auth-client-jar-with-dependencies.jar io.jans.as.client.util.KeyGenerator -keystore /etc/certs/jans-auth-keys.p12 -keypasswd &lt;Password&gt; -sig_keys RS256 RS384 -enc_keys RSA1_5 RSA-OAEP -key_ops_type ALL -dnname \"CN=jansAuth CA Certificates\" -expiration 2 &gt; /etc/certs/jans-auth-keys.json\n</code></pre>","tags":["administration","vm","operations"]},{"location":"janssen-server/vm-ops/managing-key-rotation/#useful-references","title":"Useful references","text":"<ul> <li>Key Generation</li> </ul>","tags":["administration","vm","operations"]},{"location":"janssen-server/vm-ops/restarting-services/","title":"Janssen System Services Lifecycle Management","text":"","tags":["administration","vm","operations","services","lifecycle"]},{"location":"janssen-server/vm-ops/restarting-services/#getting-list-of-jans-services","title":"Getting list of Jans services","text":"<pre><code>sudo systemctl list-units --all \"jans*\"\n</code></pre> <p>Output should be like below: <pre><code>UNIT                    LOAD   ACTIVE SUB     DESCRIPTION               \njans-auth.service       loaded active running Janssen OAauth service    \njans-config-api.service loaded active running Janssen Config API service\njans-fido2.service      loaded active running Janssen Fido2 Service     \njans-scim.service       loaded active running Janssen Scim service      \n\nLOAD   = Reflects whether the unit definition was properly loaded.\nACTIVE = The high-level unit activation state, i.e. generalization of SUB.\nSUB    = The low-level unit activation state, values depend on unit type.\n\n5 loaded units listed.\n</code></pre></p>","tags":["administration","vm","operations","services","lifecycle"]},{"location":"janssen-server/vm-ops/restarting-services/#other-services","title":"Other Services","text":"<p>There are more services other than Jans services like  Apache. To get the status of those services make sure you use command like</p> <pre><code>sudo systemctl list-units --all \"apache2*\"\n</code></pre>","tags":["administration","vm","operations","services","lifecycle"]},{"location":"janssen-server/vm-ops/restarting-services/#commands-ubuntu-2004-rhel-8-suse-15","title":"Commands (Ubuntu 20.04, RHEL 8, SUSE 15)","text":"","tags":["administration","vm","operations","services","lifecycle"]},{"location":"janssen-server/vm-ops/restarting-services/#start","title":"Start","text":"<pre><code>systemctl start [service name]\n</code></pre>","tags":["administration","vm","operations","services","lifecycle"]},{"location":"janssen-server/vm-ops/restarting-services/#stop","title":"Stop","text":"<pre><code>systemctl stop [service name]\n</code></pre>","tags":["administration","vm","operations","services","lifecycle"]},{"location":"janssen-server/vm-ops/restarting-services/#status","title":"Status","text":"<pre><code>systemctl status [service name]\n</code></pre>","tags":["administration","vm","operations","services","lifecycle"]},{"location":"janssen-server/vm-ops/restarting-services/#restart","title":"Restart","text":"<pre><code>systemctl restart [service name]\n</code></pre>","tags":["administration","vm","operations","services","lifecycle"]},{"location":"janssen-server/vm-ops/restarting-services/#reload","title":"Reload","text":"<p>This command is used for the <code>apache2</code> and <code>httpd</code> services.</p> <pre><code>systemctl reload [service name]\n</code></pre>","tags":["administration","vm","operations","services","lifecycle"]},{"location":"janssen-server/vm-ops/upgrade/","title":"Upgrade","text":"<p>This guide shows how to upgrade a Janssen VM deployment.</p> <p>Note</p> <p>VM deployments don't provide automatic upgrade/update support. Uninstalling and re-installing with newer binaries is the only option that requires re-configuration of auth-server. Though this is made easy using Terraform. We recommend using Kubernetes installations over VM, to avail smooth upgrades and better HA support.</p> <p>Note</p> <p>Custom scripts are considered external configuration and are not updated automatically during an upgrade. Please review and adapt your custom scripts to work with the newer version of the Janssen Server.</p> <p>Let's assume we are upgrading Jans VM installation from <code>current version</code> to <code>nightly</code></p> <ol> <li> <p>Keep the old VM installation running.</p> </li> <li> <p>Install on a separate VM the target new Jans installation, i.e. <code>nightly</code>.</p> <p>You can install with a test client. For example:</p> <p><code>sudo python3 /opt/jans/jans-setup/setup.py -test-client-id 6382c9da-f25d-435f-ac63-6acde36f4859 -test-client-pw secret1172023</code></p> <p>This <code>client-id</code> and <code>client-pw</code> will then be used to import Terraform configurations</p> </li> <li> <p>Use our Terraform docs on the new installation, i.e. <code>nightly</code> to:</p> <ul> <li>import all the global configurations from the new installation using <code>terraform import</code></li> <li>define all the custom IDP configurations and apply them using <code>terraform apply</code></li> </ul> </li> <li> <p>At this point there should be two versions up, <code>old version</code> and <code>nightly</code>.</p> </li> <li> <p>Traffic should be switched gradually from the old setup to the new setup.    Once confidence is gained, drain the old VM.</p> </li> </ol>","tags":["administration","VM","operations","upgrade"]},{"location":"script-catalog/access_evaluation/access-evaluation-discovery/","title":"Access Evaluation Discovery Custom Script","text":"<p>This script is used to control the Access Evaluation Discovery Endpoint (<code>/.well-known/authzen-configuration</code>).</p> <p>The AuthZEN discovery endpoint publishes PDP (Policy Decision Point) metadata per the AuthZEN specification, including all available endpoints and capabilities.</p> <p>Sample Request</p> <pre><code>GET /.well-known/authzen-configuration HTTP/1.1\nHost: janssen.server.host\n</code></pre> <p>Sample Response</p> <pre><code>{\n  \"policy_decision_point\": \"https://janssen.server.host\",\n  \"access_evaluation_endpoint\": \"https://janssen.server.host/jans-auth/restv1/access/v1/evaluation\",\n  \"access_evaluations_endpoint\": \"https://janssen.server.host/jans-auth/restv1/access/v1/evaluations\",\n  \"subject_search_endpoint\": \"https://janssen.server.host/jans-auth/restv1/access/v1/search/subject\",\n  \"resource_search_endpoint\": \"https://janssen.server.host/jans-auth/restv1/access/v1/search/resource\",\n  \"action_search_endpoint\": \"https://janssen.server.host/jans-auth/restv1/access/v1/search/action\",\n  \"capabilities\": [],\n  \"access_evaluation_v1_endpoint\": \"https://janssen.server.host/jans-auth/restv1/access/v1\"\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation-discovery/#discovery-response-fields","title":"Discovery Response Fields","text":"Field Description <code>policy_decision_point</code> The issuer URL identifying the PDP <code>access_evaluation_endpoint</code> URL for single evaluation requests <code>access_evaluations_endpoint</code> URL for batch evaluation requests <code>subject_search_endpoint</code> URL for subject search requests <code>resource_search_endpoint</code> URL for resource search requests <code>action_search_endpoint</code> URL for action search requests <code>capabilities</code> Array of supported capabilities (extensible via script) <code>access_evaluation_v1_endpoint</code> Legacy base endpoint URL for backward compatibility","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation-discovery/#interface","title":"Interface","text":"<p>The Access Evaluation Discovery script implements the AccessEvaluationDiscoveryType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation-discovery/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation-discovery/#new-methods","title":"New Methods","text":"Method header Method description <code>def modifyResponse(self, responseAsJsonObject, context)</code> This method is called after discovery response is ready. This method can modify discovery response.<code>responseAsJsonObject</code> is <code>org.json.JSONObject</code> <code>context</code> is <code>io.jans.as.server.model.common.ExecutionContext</code> <p><code>modifyResponse</code> method returns <code>true</code> to accept modifications or <code>false</code> to revert all changes.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation-discovery/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>context</code> Reference","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation-discovery/#use-cases","title":"Use Cases","text":"<p>The discovery script can be used to:</p> <ol> <li>Add custom capabilities - Advertise PDP-specific features</li> <li>Add custom endpoints - Include additional proprietary endpoints</li> <li>Add metadata - Include organization-specific information</li> <li>Conditional responses - Modify response based on request context</li> </ol>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation-discovery/#sample-demo-custom-script","title":"Sample Demo Custom Script","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation-discovery/#script-type-java","title":"Script Type: Java","text":"<pre><code>import io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.authzen.AccessEvaluationDiscoveryType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.json.JSONArray;\nimport org.json.JSONObject;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\n\npublic class AccessEvaluationDiscovery implements AccessEvaluationDiscoveryType {\n\n    private static final Logger log = LoggerFactory.getLogger(AccessEvaluationDiscovery.class);\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Init of AccessEvaluationDiscovery Java custom script\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Init of AccessEvaluationDiscovery Java custom script\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Destroy of AccessEvaluationDiscovery Java custom script\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        log.info(\"getApiVersion AccessEvaluationDiscovery Java custom script: 11\");\n        return 11;\n    }\n\n    @Override\n    public boolean modifyResponse(Object responseAsJsonObject, Object context) {\n        scriptLogger.info(\"Modifying AuthZEN discovery response\");\n        JSONObject response = (JSONObject) responseAsJsonObject;\n\n        // Add custom capabilities\n        JSONArray capabilities = response.optJSONArray(\"capabilities\");\n        if (capabilities == null) {\n            capabilities = new JSONArray();\n            response.put(\"capabilities\", capabilities);\n        }\n\n        // Add custom metadata\n        response.put(\"organization\", \"Acme Corp\");\n        response.put(\"pdp_version\", \"1.0.0\");\n\n        // Add custom endpoint\n        response.put(\"custom_endpoint\", \"https://example.com/custom\");\n\n        return true; // Accept modifications\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation-discovery/#example-adding-capabilities","title":"Example: Adding Capabilities","text":"<pre><code>@Override\npublic boolean modifyResponse(Object responseAsJsonObject, Object context) {\n    JSONObject response = (JSONObject) responseAsJsonObject;\n\n    // Add supported capabilities per AuthZEN spec\n    JSONArray capabilities = new JSONArray();\n\n    response.put(\"capabilities\", capabilities);\n\n    return true;\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation-discovery/#sample-scripts","title":"Sample Scripts","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation-discovery/#access-evaluation-discovery-script","title":"Access Evaluation Discovery Script","text":"<pre><code>/* Copyright (c) 2024, Gluu\n Author: Yuriy Z\n */\n\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.authzen.AccessEvaluationDiscoveryType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.json.JSONObject;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\n\npublic class AccessEvaluationDiscovery implements AccessEvaluationDiscoveryType {\n\n    private static final Logger log = LoggerFactory.getLogger(AccessEvaluationDiscovery.class);\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Init of AccessEvaluationDiscovery Java custom script\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Init of AccessEvaluationDiscovery Java custom script\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Destroy of AccessEvaluationDiscovery Java custom script\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        log.info(\"getApiVersion AccessEvaluationDiscovery Java custom script: 11\");\n        return 11;\n    }\n\n    @Override\n    public boolean modifyResponse(Object responseAsJsonObject, Object context) {\n        scriptLogger.info(\"write to script logger\");\n        JSONObject response = (JSONObject) responseAsJsonObject;\n        response.accumulate(\"key_from_java\", \"value_from_script_on_java\");\n        return true;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/","title":"Access Evaluation Custom Script","text":"<p>The Jans-Auth server implements OpenID AuthZEN Authorization API 1.0. The AuthZEN Authorization API 1.0 specification defines a standardized interface for communication between Policy Enforcement Points (PEPs) and Policy Decision Points (PDPs) to facilitate consistent authorization decisions across diverse systems. It introduces an Access Evaluation API that allows PEPs to query PDPs about specific access requests, enhancing interoperability and scalability in authorization processes. The specification is transport-agnostic, with an initial focus on HTTPS bindings, and emphasizes secure, fine-grained, and dynamic authorization mechanisms.</p> <p>This script is used to control Access Evaluation Endpoints described in specification.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#behavior","title":"Behavior","text":"<p>The Access Evaluation Endpoint in the AuthZEN specification serves as a mechanism for Policy Enforcement Points (PEPs) to request access decisions from a Policy Decision Point (PDP) for specific resources and actions. Upon receiving a request, the endpoint evaluates the subject, resource, and action against defined policies to determine if access should be granted, denied, or if additional information is needed. The endpoint's responses are typically concise, aiming to provide a rapid decision that PEPs can enforce in real-time. The goal is to provide a scalable, secure interface for dynamic and fine-grained access control across applications.</p> <p>During Access Evaluation request processing the <code>Access Evaluation</code> custom script is executed. Name of the script must be specified by <code>accessEvaluationScriptName</code> configuration property. If AS can't find such script or if configuration property is not specified then server executes first script it finds on database. AS comes with sample demo script which shows simple example of custom validation and granting access.</p> <p>Sample Single Evaluation Request <pre><code>POST /jans-auth/restv1/access/v1/evaluation HTTP/1.1\nHost: happy-example.gluu.info\nContent-Type: application/json\nAuthorization: Basic &lt;encoded_credentials&gt;\n\n{\n  \"subject\": {\n    \"type\": \"super_admin\",\n    \"id\": \"alice@acmecorp.com\"\n  },\n  \"resource\": {\n    \"type\": \"account\",\n    \"id\": \"123\"\n  },\n  \"action\": {\n    \"name\": \"can_read\"\n  },\n  \"context\": {\n    \"ip_address\": \"192.168.1.1\",\n    \"time\": \"2024-01-15T10:30:00Z\"\n  }\n}\n</code></pre></p> <p>Sample Batch Evaluations Request <pre><code>POST /jans-auth/restv1/access/v1/evaluations HTTP/1.1\nHost: happy-example.gluu.info\nContent-Type: application/json\nAuthorization: Basic &lt;encoded_credentials&gt;\n\n{\n  \"subject\": {\n    \"type\": \"user\",\n    \"id\": \"alice@acmecorp.com\"\n  },\n  \"evaluations\": [\n    {\"action\": {\"name\": \"read\"}},\n    {\"action\": {\"name\": \"write\"}},\n    {\"action\": {\"name\": \"delete\"}}\n  ],\n  \"options\": {\n    \"evaluations_semantic\": \"deny_on_first_deny\"\n  }\n}\n</code></pre></p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#interface","title":"Interface","text":"<p>The Access Evaluation script implements the AccessEvaluationType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#new-methods","title":"New Methods","text":"Method header Method description <code>evaluate(request, context)</code> Called for single evaluation requests. Must return <code>AccessEvaluationResponse</code>. <code>searchSubject(request, context)</code> Called for subject search requests. Returns <code>SearchResponse&lt;Subject&gt;</code> or <code>null</code> for empty response. <code>searchResource(request, context)</code> Called for resource search requests. Returns <code>SearchResponse&lt;Resource&gt;</code> or <code>null</code> for empty response. <code>searchAction(request, context)</code> Called for action search requests. Returns <code>SearchResponse&lt;Action&gt;</code> or <code>null</code> for empty response.","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#method-details","title":"Method Details","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#evaluaterequest-context","title":"evaluate(request, context)","text":"<p>The main evaluation method called when a single evaluation or batch evaluation request is received.</p> <p>Parameters: - <code>request</code> - <code>AccessEvaluationRequest</code> containing subject, resource, action, and context - <code>context</code> - <code>ExternalScriptContext</code> providing access to HTTP request and other contextual data</p> <p>Returns: <code>AccessEvaluationResponse</code> indicating the access decision (true/false) with optional context</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#searchsubjectrequest-context","title":"searchSubject(request, context)","text":"<p>Called when a subject search request is received at <code>/access/v1/search/subject</code>.</p> <p>Parameters: - <code>request</code> - <code>SearchSubjectRequest</code> containing search criteria - <code>context</code> - Script context</p> <p>Returns: <code>SearchResponse&lt;Subject&gt;</code> with matching subjects, or <code>null</code> for default empty response</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#searchresourcerequest-context","title":"searchResource(request, context)","text":"<p>Called when a resource search request is received at <code>/access/v1/search/resource</code>.</p> <p>Parameters: - <code>request</code> - <code>SearchResourceRequest</code> containing search criteria - <code>context</code> - Script context</p> <p>Returns: <code>SearchResponse&lt;Resource&gt;</code> with matching resources, or <code>null</code> for default empty response</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#searchactionrequest-context","title":"searchAction(request, context)","text":"<p>Called when an action search request is received at <code>/access/v1/search/action</code>.</p> <p>Parameters: - <code>request</code> - <code>SearchActionRequest</code> containing search criteria - <code>context</code> - Script context</p> <p>Returns: <code>SearchResponse&lt;Action&gt;</code> with matching actions, or <code>null</code> for default empty response</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>context</code> Reference <code>AccessEvaluationRequest</code> Request containing subject, resource, action, context, evaluations (for batch), and options <code>AccessEvaluationResponse</code> Response with decision (boolean) and optional context <code>SearchResponse</code> Paginated response for search operations","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#sample-demo-custom-script","title":"Sample Demo Custom Script","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#script-type-java","title":"Script Type: Java","text":"<pre><code>import com.fasterxml.jackson.databind.ObjectMapper;\nimport com.fasterxml.jackson.databind.node.ObjectNode;\nimport io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.authzen.*;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.authzen.AccessEvaluationType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport jakarta.ws.rs.WebApplicationException;\nimport jakarta.ws.rs.core.Response;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\nimport java.util.UUID;\n\n/**\n * Sample AccessEvaluation script demonstrating:\n * - Single evaluation with custom validation\n * - Search method stubs (return null for default empty response)\n *\n * @author Yuriy Z\n */\npublic class AccessEvaluation implements AccessEvaluationType {\n\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n    private static final ObjectMapper objectMapper = new ObjectMapper();\n\n    @Override\n    public AccessEvaluationResponse evaluate(AccessEvaluationRequest request, Object scriptContext) {\n\n        ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n        // 1. access http request via context.getHttpRequest()\n        // 2. access all access evaluation specific data directly with 'request', e.g. request.getSubject()\n\n        // 3. perform custom validation if needed\n        validateResource(request.getResource());\n\n        // typically some internal validation must be performed here\n        // request data alone must not be trusted, it's just sample to demo script with endpoint\n        if (\"super_admin\".equalsIgnoreCase(request.getSubject().getType())) {\n            final ObjectNode reasonAdmin = objectMapper.createObjectNode();\n            reasonAdmin.put(\"reason\", \"super_admin\");\n\n            final AccessEvaluationResponseContext responseContext = new AccessEvaluationResponseContext();\n            responseContext.setId(UUID.randomUUID().toString());\n            responseContext.setReasonAdmin(reasonAdmin);\n\n            return new AccessEvaluationResponse(true, responseContext);\n        }\n        return AccessEvaluationResponse.FALSE;\n    }\n\n    private void validateResource(Resource resource) {\n        // sample for custom validation\n        if (resource.getType().equalsIgnoreCase(\"file\")) {\n            throw new WebApplicationException(Response\n                    .status(Response.Status.BAD_REQUEST)\n                    .entity(\"{\\n\" +\n                            \"  \\\"error\\\": \\\"invalid_resource_type\\\",\\n\" +\n                            \"  \\\"error_description\\\": \\\"Resource type 'file' is not allowed.\\\"\\n\" +\n                            \"}\")\n                    .build());\n        }\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized AccessEvaluation Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized AccessEvaluation Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed AccessEvaluation Java custom script.\");\n        return false;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n\n    @Override\n    public SearchResponse&lt;Subject&gt; searchSubject(SearchSubjectRequest request, Object context) {\n        // Implement subject search logic here\n        // Return null to use default empty response\n        return null;\n    }\n\n    @Override\n    public SearchResponse&lt;Resource&gt; searchResource(SearchResourceRequest request, Object context) {\n        // Implement resource search logic here\n        // Return null to use default empty response\n        return null;\n    }\n\n    @Override\n    public SearchResponse&lt;Action&gt; searchAction(SearchActionRequest request, Object context) {\n        // Implement action search logic here\n        // Return null to use default empty response\n        return null;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#search-implementation-example","title":"Search Implementation Example","text":"<p>Here's an example of implementing a search method that returns actual results:</p> <pre><code>@Override\npublic SearchResponse&lt;Subject&gt; searchSubject(SearchSubjectRequest request, Object context) {\n    // Example: Return users who have access to the requested resource/action\n    List&lt;Subject&gt; subjects = new ArrayList&lt;&gt;();\n\n    // Query your authorization backend/database here\n    // This is just a sample - implement your actual logic\n    subjects.add(new Subject().setType(\"user\").setId(\"alice@acmecorp.com\"));\n    subjects.add(new Subject().setType(\"user\").setId(\"bob@acmecorp.com\"));\n\n    SearchResponse&lt;Subject&gt; response = new SearchResponse&lt;&gt;();\n    response.setResults(subjects);\n\n    // Set pagination info\n    PageResponse page = new PageResponse();\n    page.setCount(subjects.size());\n    page.setTotal(subjects.size());\n    response.setPage(page);\n\n    return response;\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#context-object","title":"Context Object","text":"<p>The <code>context</code> field in requests is fully dynamic and accepts any key-value pairs per AuthZEN specification:</p> <pre><code>{\n  \"context\": {\n    \"ip_address\": \"192.168.1.100\",\n    \"time\": \"2024-01-15T10:30:00Z\",\n    \"device_type\": \"mobile\",\n    \"region\": \"us-east-1\",\n    \"custom_field\": \"any_value\"\n  }\n}\n</code></pre> <p>Access context values in your script:</p> <pre><code>Context ctx = request.getContext();\nString ipAddress = (String) ctx.get(\"ip_address\");\nString region = (String) ctx.get(\"region\");\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#batch-evaluation-options","title":"Batch Evaluation Options","text":"<p>When handling batch evaluations, the <code>options.evaluations_semantic</code> field controls processing:</p> Value Behavior <code>execute_all</code> Process all evaluations regardless of results (default) <code>deny_on_first_deny</code> Stop on first deny result <code>permit_on_first_permit</code> Stop on first permit result <p>The AS handles semantic logic automatically - your <code>evaluate()</code> method is called for each individual evaluation.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#sample-scripts","title":"Sample Scripts","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/access_evaluation/access-evaluation/#access-evaluation-script","title":"Access Evaluation Script","text":"<pre><code>import com.fasterxml.jackson.databind.ObjectMapper;\nimport com.fasterxml.jackson.databind.node.ObjectNode;\nimport io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.authzen.*;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.authzen.AccessEvaluationType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport jakarta.ws.rs.WebApplicationException;\nimport jakarta.ws.rs.core.Response;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\nimport java.util.UUID;\n\n/**\n * @author Yuriy Z\n */\npublic class AccessEvaluation implements AccessEvaluationType {\n\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n    private static final ObjectMapper objectMapper = new ObjectMapper();\n\n    @Override\n    public AccessEvaluationResponse evaluate(AccessEvaluationRequest request, Object scriptContext) {\n\n        ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n        // 1. access http request via context.getHttpRequest()\n        // 2. access all access evaluation specific data directly with 'request', e.g. request.getSubject()\n\n        // 3. perform custom validation if needed\n        validateResource(request.getResource());\n\n        // typically some internal validation must be performed here\n        // request data alone must not be trusted, it's just sample to demo script with endpoint\n        if (\"super_admin\".equalsIgnoreCase(request.getSubject().getType())) {\n            final ObjectNode reasonAdmin = objectMapper.createObjectNode();\n            reasonAdmin.put(\"reason\", \"super_admin\");\n\n            final AccessEvaluationResponseContext responseContext = new AccessEvaluationResponseContext();\n            responseContext.setId(UUID.randomUUID().toString());\n            responseContext.setReasonAdmin(reasonAdmin);\n\n            return new AccessEvaluationResponse(true, responseContext);\n        }\n        return AccessEvaluationResponse.FALSE;\n    }\n\n    private void validateResource(Resource resource) {\n        // sample for custom validation\n        if (resource.getType().equalsIgnoreCase(\"file\")) {\n            throw new WebApplicationException(Response\n                    .status(Response.Status.BAD_REQUEST)\n                    .entity(\"{\\n\" +\n                            \"  \\\"error\\\": \\\"invalid_resource_type\\\",\\n\" +\n                            \"  \\\"error_description\\\": \\\"Resource type 'file' is not allowed.\\\"\\n\" +\n                            \"}\")\n                    .build());\n        }\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized AccessEvaluation Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized AccessEvaluation Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed AccessEvaluation Java custom script.\");\n        return false;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n\n    @Override\n    public SearchResponse&lt;Subject&gt; searchSubject(SearchSubjectRequest request, Object context) {\n        // Not implemented - return null to use default empty response\n        return null;\n    }\n\n    @Override\n    public SearchResponse&lt;Resource&gt; searchResource(SearchResourceRequest request, Object context) {\n        // Not implemented - return null to use default empty response\n        return null;\n    }\n\n    @Override\n    public SearchResponse&lt;Action&gt; searchAction(SearchActionRequest request, Object context) {\n        // Not implemented - return null to use default empty response\n        return null;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/application_session/application-session/","title":"Application Session Script Guide","text":"<p>The Jans-Auth server allows you to modify the session flow through this script.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/application_session/application-session/#interface","title":"Interface","text":"<p>The Application Session script implement the ApplicationSessionType interface. This extends methods form the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/application_session/application-session/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/application_session/application-session/#new-methods","title":"New methods","text":"Method header Method description <code>def startSession(self, httpRequest, sessionId, configurationAttributes)</code> Called when a session is started. <code>def endSession(self, httpRequest, sessionId, configurationAttributes)</code> Called when a session is ended. <code>def onEvent(self, event)</code> Called when a specific session event occurs.. <code>def modifyActiveSessionsResponse(self, jsonArray, context)</code> Called it during /session/active endpoint call to modify response if needed. <p>All methods return <code>true</code>/<code>false</code>, the server issues an error if this response is <code>false</code>.</p> <p>If parameters is not present then error has to be created and <code>false</code> returned. If all is good script has to return <code>true</code>.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/application_session/application-session/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> io.jans.model.custom.script.model.CustomScript <code>context</code> io.jans.as.server.service.external.context.ExternalScriptContext <code>sessionId</code> io.jans.as.common.model.session.SessionId <code>event</code> io.jans.as.server.service.external.session.SessionEvent <code>httpRequest</code> jakarta.servlet.http.HttpServletRequest <code>jsonArray</code> org.json.JSONArray <code>configurationAttributes</code> java.util.MapSimpleCustomProperty&gt;","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/application_session/application-session/#common-use-cases","title":"Common Use Cases","text":"<ul> <li><code>startSession</code>: Validate first session</li> <li><code>endSession</code>: Print logs</li> <li><code>onEvent</code>: If event type is AUTHENTICATED, print sessionId in logs</li> <li><code>modifyActiveSessionsResponse</code>: Print logs</li> </ul>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/application_session/application-session/#script-type-python","title":"Script type: Python","text":"<pre><code>from io.jans.model.custom.script.type.session import ApplicationSessionType\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.orm import PersistenceEntryManager\nfrom io.jans.as.model.config import StaticConfiguration\nfrom io.jans.as.server.model.ldap import TokenEntity\nfrom jakarta.faces.application import FacesMessage\nfrom io.jans.jsf2.message import FacesMessages\nfrom io.jans.util import StringHelper, ArrayHelper\nfrom io.jans.as.server.model.config import Constants\nfrom java.util import Arrays, ArrayList\nfrom io.jans.as.server.service.external.session import SessionEventType\n\nimport java\n\nclass ApplicationSession(ApplicationSessionType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Application session. Initialization\"\n\n        self.entryManager = CdiUtil.bean(PersistenceEntryManager)\n        self.staticConfiguration = CdiUtil.bean(StaticConfiguration)\n\n        print \"Application session. Initialized successfully\"\n\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print \"Application session. Destroy\"\n        print \"Application session. Destroyed successfully\"\n        return True   \n\n    def getApiVersion(self):\n        return 11\n\n    def onEvent(self, event):\n        if event.getType() == SessionEventType.AUTHENTICATED:\n            print \"Session is authenticated, session: \" + event.getSessionId().getId()\n        return\n\n    def startSession(self, httpRequest, sessionId, configurationAttributes):\n        print \"Application session. Starting external session\"\n\n        user_name = sessionId.getSessionAttributes().get(Constants.AUTHENTICATED_USER)\n\n        first_session = self.isFirstSession(user_name)\n        if not first_session:\n            facesMessages = CdiUtil.bean(FacesMessages)\n            facesMessages.add(FacesMessage.SEVERITY_ERROR, \"Please, end active session first!\")\n            return False\n\n        print \"Application session. External session started successfully\"\n        return True\n\n    def endSession(self, httpRequest, sessionId, configurationAttributes):\n        print \"Application session. Starting external session end\"\n\n        print \"Application session. External session ended successfully\"\n        return True\n\n    def modifyActiveSessionsResponse(self, jsonArray, context):\n        print \"Application session. Starting external modify active session\"\n\n        print \"Application session. External modify active session successfully\"\n        return False\n\n    def isFirstSession(self, user_name):\n        tokenLdap = TokenEntity()\n        tokenLdap.setDn(self.staticConfiguration.getBaseDn().getClients())\n        tokenLdap.setUserId(user_name)\n\n        tokenLdapList = self.entryManager.findEntries(tokenLdap, 1)\n        print \"Application session. isFirstSession. Get result: '%s'\" % tokenLdapList\n\n        if (tokenLdapList != None) and (tokenLdapList.size() &gt; 0):\n            print \"Application session. isFirstSession: False\"\n            return False\n\n        print \"Application session. isFirstSession: True\"\n        return True\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/application_session/application-session/#sample-script","title":"Sample Script","text":"<p>jans-session-audit.py - This script performs advanced session auditing for monitoring and tracking user sessions.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/application_session/jans-session-audit/","title":"Index","text":""},{"location":"script-catalog/application_session/jans-session-audit/#readme-auditing-authentication-attempts","title":"README Auditing Authentication Attempts","text":"<p>Name of the script in janssen (for example, using /opt/jans/jans-cli/config-cli.py or /opt/jans/jans-cli/config-cli-tui.py): jans-session-audit. Script type:  Application Sessions.</p> <p>The script generates audit report and creates record in DB. Also jansData field (in JSON format), that contains summary info of session audit will be generated.</p> <p>Following are the configuration properties for the jans-session-audit.py script (jans-session-audit):</p> <p>Parameters of the script:</p> <ul> <li> <p>metric_audit_ou_name: Name of the audit OU. For example: jans_auth.  </p> </li> <li> <p>metric_audit_conf_json_file_path: configuration file. For example: /etc/jans/conf/jans-session-audit.json </p> </li> </ul> <p>File should contain the following properties: 1. event_types.     Type of Session event(s), that will be saved in the DB:     - AUTHENTICATED     - UNAUTHENTICATED     - UPDATED     - GONE     .</p> <ol> <li> <p>audit_data.     List of properties of Session (SessionId):</p> <ul> <li>userDn</li> <li>id</li> <li>outsideSid</li> <li>lastUsedAt</li> <li>authenticationTime</li> <li>state</li> <li>expirationDate</li> <li>sessionState</li> <li>permissionGranted</li> <li>permissionGrantedMap</li> <li>deviceSecrets .</li> </ul> </li> <li> <p>audit_cust_data.     List of Extra Session Attributes (SessionId):</p> <ul> <li>auth_external_attributes</li> <li>opbs</li> <li>response_type</li> <li>client_id</li> <li>auth_step</li> <li>acr</li> <li>casa_logoUrl</li> <li>remote_ip</li> <li>scope</li> <li>acr_values</li> <li>casa_faviconUrl</li> <li>redirect_uri</li> <li>state</li> <li>casa_prefix</li> <li>casa_contextPath</li> <li>casa_extraCss .</li> </ul> </li> <li> <p>audit_cust_data Can contain only one attribute:</p> <ul> <li>sessionAttributes .</li> </ul> <p>The value (sessionAttributes) covers list of all Extra Session Attributes (SessionId): - auth_external_attributes - opbs - response_type - client_id - auth_step - acr - casa_logoUrl - remote_ip - scope - acr_values - casa_faviconUrl - redirect_uri - state - casa_prefix - casa_contextPath - casa_extraCss</p> </li> </ol> <p>Generated value jansData in JSON format will contain type of event (one of AUTHENTICATED, UNAUTHENTICATED, UPDATED, GONE) and all properties/attributes defined by audit_data and audit_cust_data.</p> <p>Examples of /etc/jans/conf/jans-session-audit.json file:</p>"},{"location":"script-catalog/application_session/jans-session-audit/#_1","title":"Index","text":"<pre><code>{\n    \"event_types\": [ \"AUTHENTICATED\", \"UNAUTHENTICATED\", \"UPDATED\", \"GONE\" ],\n    \"audit_data\": [\n        \"userDn\",\n        \"id\",\n        \"outsideSid\",\n        \"lastUsedAt\",\n        \"authenticationTime\",\n        \"state\",\n        \"expirationDate\",\n        \"sessionState\",\n        \"permissionGranted\",\n        \"permissionGrantedMap\",\n        \"deviceSecrets\"\n    ],\n    \"audit_cust_data\": [\n        \"auth_external_attributes\",\n        \"opbs\",\n        \"response_type\",\n        \"client_id\",\n        \"auth_step\",\n        \"acr\",\n        \"casa_logoUrl\",\n        \"remote_ip\",\n        \"scope\",\n        \"acr_values\",\n        \"casa_faviconUrl\",\n        \"redirect_uri\",\n        \"state\",\n        \"casa_prefix\",\n        \"casa_contextPath\",\n        \"casa_extraCss\"\n    ]\n}\n</code></pre>"},{"location":"script-catalog/application_session/jans-session-audit/#_2","title":"Index","text":"<pre><code>{\n    \"event_types\": [ \"AUTHENTICATED\",\"GONE\" ],\n    \"audit_data\": [\n        \"userDn\",\n        \"id\",\n        \"outsideSid\",\n        \"lastUsedAt\",\n        \"authenticationTime\",\n        \"state\",\n        \"expirationDate\",\n        \"sessionState\",\n        \"permissionGranted\",\n        \"permissionGrantedMap\",\n        \"deviceSecrets\"\n    ],\n    \"audit_cust_data\": [\n        \"sessionAttributes\"\n    ]\n}\n</code></pre>"},{"location":"script-catalog/application_session/jans-session-audit/#_3","title":"Index","text":"<ul> <li>log_level: level of log out in the file: /opt/jans/jetty/jans-auth/logs/jans-auth_script.log.     Values:<ul> <li>DEBUG</li> <li>INFO</li> <li>ERROR</li> </ul> </li> </ul> <p>.</p> <p>Examples of generated jansData (JSON format):</p>"},{"location":"script-catalog/application_session/jans-session-audit/#_4","title":"Index","text":"<p>/etc/jans/conf/jans-session-audit.json:</p> <pre><code>{\n    \"event_types\": [ \"AUTHENTICATED\",\"GONE\" ],\n    \"audit_data\": [\n        \"userDn\",\n        \"id\",\n        \"outsideSid\",\n        \"lastUsedAt\",\n        \"authenticationTime\",\n        \"state\",\n        \"expirationDate\",\n        \"sessionState\",\n        \"permissionGranted\",\n        \"permissionGrantedMap\",\n        \"deviceSecrets\"\n    ],\n    \"audit_cust_data\": [\n        \"auth_external_attributes\",\n        \"opbs\",\n        \"response_type\",\n        \"client_id\",\n        \"auth_step\",\n        \"acr\",\n        \"casa_logoUrl\",\n        \"remote_ip\",\n        \"scope\",\n        \"acr_values\",\n        \"casa_faviconUrl\",\n        \"redirect_uri\",\n        \"state\",\n        \"casa_prefix\",\n        \"casa_contextPath\",\n        \"casa_extraCss\"\n    ]\n}\n</code></pre> <p>jansData:</p> <pre><code>{\n    \"type\": \"AUTHENTICATED\",\n    \"authenticationTime\": \"Sun Jul 16 10:17:48 CDT 2023\",\n    \"deviceSecrets\": \"[]\",\n    \"permissionGranted\": \"None\",\n    \"sessionState\": \"bc85eaccff71f7145057405363f60bbc7d7d9733faed52a84ca79eaca56248c3.b8eafaa1-b08d-414c-b15d-883ca0eb363c\",\n    \"lastUsedAt\": \"Sun Jul 16 10:17:48 CDT 2023\",\n    \"outsideSid\": \"3f2e08a6-06c2-4444-a2dd-1368da4e22da\",\n    \"id\": \"cb9a92d2-e1e7-4754-943e-354b976938bc\",\n    \"authState\": \"authenticated\",\n    \"userDn\": \"inum=32c32267-6f8a-4cac-88e4-643e3abcfe6c,ou=people,o=jans\",\n    \"expirationDate\": \"Mon Jul 17 10:17:31 CDT 2023\",\n    \"permissionGrantedMap\": {\n        \"3000.79c97b57-0bf8-4d5b-8f9c-918eff96e8b8\": false\n    },\n    \"opbs\": \"a8e3a9fb-f9f6-42b1-a42b-795f195407b7\",\n    \"responseType\": \"code\",\n    \"clientId\": \"3000.79c97b57-0bf8-4d5b-8f9c-918eff96e8b8\",\n    \"authStep\": \"1\",\n    \"acr\": \"casa\",\n    \"casaLogoUrl\": \"/casa/images/logo.png\",\n    \"remoteIp\": \"192.168.64.2\",\n    \"scope\": \"openid profile user_name clientinfo\",\n    \"acrValues\": \"casa\",\n    \"casaFaviconUrl\": \"/casa/images/favicon.ico\",\n    \"redirectUri\": \"https://gluu-1.smansoft.net/casa\",\n    \"state\": \"Hr9ZeBdWVBQTyAMKna-GROKaLeqnpFkIngYImTmSIdk\",\n    \"casaPrefix\": \"\",\n    \"casaContextPath\": \"/casa\",\n    \"casaExtraCss\": \"None\",\n    \"authExternalAttributes\": [\n        {\n            \"casa_logoUrl\": \"java.lang.String\"\n        },\n        {\n            \"casa_faviconUrl\": \"java.lang.String\"\n        },\n        {\n            \"casa_prefix\": \"java.lang.String\"\n        },\n        {\n            \"casa_contextPath\": \"java.lang.String\"\n        }\n    ]\n}\n</code></pre>"},{"location":"script-catalog/application_session/jans-session-audit/#_5","title":"Index","text":"<p>/etc/jans/conf/jans-session-audit.json:</p> <pre><code>{\n    \"event_types\": [ \"AUTHENTICATED\",\"GONE\" ],\n    \"audit_data\": [\n    ],\n    \"audit_cust_data\": [\n    ]\n}\n</code></pre> <p>jansData:</p> <pre><code>{\n    \"type\": \"GONE\"\n}\n</code></pre>"},{"location":"script-catalog/application_session/jans-session-audit/#_6","title":"Index","text":"<p>/etc/jans/conf/jans-session-audit.json:</p> <pre><code>{\n    \"event_types\": [ \"AUTHENTICATED\",\"GONE\" ],\n    \"audit_data\": [\n        \"userDn\",\n        \"id\",\n        \"state\",\n        \"permissionGrantedMap\",\n        \"deviceSecrets\"\n    ],\n    \"audit_cust_data\": [\n    ]\n}\n</code></pre> <p>jansData:</p> <pre><code>{\n    \"type\": \"AUTHENTICATED\",\n    \"deviceSecrets\": \"[]\",\n    \"id\": \"8103b097-964c-4e66-8dea-c0edcfdb0438\",\n    \"authState\": \"authenticated\",\n    \"userDn\": \"inum=32c32267-6f8a-4cac-88e4-643e3abcfe6c,ou=people,o=jans\",\n    \"permissionGrantedMap\": {\n        \"3000.79c97b57-0bf8-4d5b-8f9c-918eff96e8b8\": false\n    }\n}\n</code></pre>"},{"location":"script-catalog/application_session/jans-session-audit/#_7","title":"Index","text":"<p>/etc/jans/conf/jans-session-audit.json:</p> <pre><code>{\n    \"event_types\": [ \"AUTHENTICATED\",\"GONE\" ],\n    \"audit_data\": [\n        \"userDn\",\n        \"id\"\n    ],\n    \"audit_cust_data\": [\n        \"sessionAttributes\"\n    ]\n}\n</code></pre> <p>jansData:</p> <pre><code>{\n    \"type\": \"AUTHENTICATED\",\n    \"id\": \"426d82e8-3182-4f5e-9b1a-54fa1d9fc295\",\n    \"userDn\": \"inum=32c32267-6f8a-4cac-88e4-643e3abcfe6c,ou=people,o=jans\",\n    \"opbs\": \"c8727cf7-f136-4555-be86-5313039f874b\",\n    \"responseType\": \"code\",\n    \"clientId\": \"3000.79c97b57-0bf8-4d5b-8f9c-918eff96e8b8\",\n    \"authStep\": \"1\",\n    \"acr\": \"casa\",\n    \"casaLogoUrl\": \"/casa/images/logo.png\",\n    \"remoteIp\": \"192.168.64.2\",\n    \"scope\": \"openid profile user_name clientinfo\",\n    \"acrValues\": \"casa\",\n    \"casaFaviconUrl\": \"/casa/images/favicon.ico\",\n    \"redirectUri\": \"https://gluu-1.smansoft.net/casa\",\n    \"state\": \"PEIbloYE4OUy4hkaT75uzDUuiRtQO0v5P_uy0q8iBss\",\n    \"casaPrefix\": \"\",\n    \"casaContextPath\": \"/casa\",\n    \"casaExtraCss\": \"None\",\n    \"authExternalAttributes\": [\n        {\n            \"casa_logoUrl\": \"java.lang.String\"\n        },\n        {\n            \"casa_faviconUrl\": \"java.lang.String\"\n        },\n        {\n            \"casa_prefix\": \"java.lang.String\"\n        },\n        {\n            \"casa_contextPath\": \"java.lang.String\"\n        }\n    ]\n}\n</code></pre>"},{"location":"script-catalog/authorization_challenge/authorization-challenge/","title":"Authorization Challenge Custom Script","text":"<p>The Jans-Auth server implements OAuth 2.0 for First-Party Applications. This script is used to control/customize Authorization Challenge Endpoint.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/authorization_challenge/authorization-challenge/#behavior","title":"Behavior","text":"<p>In request to Authorization Challenge Endpoint to is expected to have <code>acr_values</code> request parameter which specifies name of the custom script. If parameter is absent or AS can't find script with this name then it falls back to script with name <code>default_challenge</code>.</p> <p>This script is provided during installation and performs basic <code>username</code>/<code>password</code> authentication.</p> <pre><code>POST /jans-auth/restv1/authorize-challenge HTTP/1.1\nHost: yuriyz-fond-skink.gluu.info\n\nclient_id=999e13b8-f4a2-4fed-ad3c-6c88bd2c92ea&amp;scope=openid+profile+address+email+phone+user_name&amp;state=b4a41b29-51c8-4354-9c8c-fda38b4dbd43&amp;nonce=3a56f8d0-f78e-4b15-857c-3e792801be68&amp;acr_values=&amp;request_session_id=false&amp;password=secret&amp;username=admin\n</code></pre> <p>There is authorizationChallengeDefaultAcr AS configuration property which allows to change fallback script name from <code>default_challenge</code> to some other value (value must be valid script name present on AS).</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/authorization_challenge/authorization-challenge/#interface","title":"Interface","text":"<p>The Authorization Challenage script implements the AuthorizationChallenageType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/authorization_challenge/authorization-challenge/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/authorization_challenge/authorization-challenge/#new-methods","title":"New methods","text":"Method header Method description <code>def authorize(self, context)</code> Called when the request is received. <code>def getAuthenticationMethodClaims(self, context)</code> Called to get authn method claims. It is injected into <code>id_token</code>. Returns key-value map. <code>def prepareAuthzRequest(self, context)</code> Prepared authorization request before <code>authorize</code> method. It's good place to restore data from session if needed. <p><code>authorize</code> method returns true/false which indicates to server whether to issue <code>authorization_code</code> in response or not.</p> <p>If parameters is not present then error has to be created and <code>false</code> returned. If all is good script has to return <code>true</code> and it's strongly recommended to set user <code>context.getExecutionContext().setUser(user);</code> so AS can keep tracking what exactly user is authenticated.</p> <p>The <code>prepareAuthzRequest</code> method should typically be used to manipulate the authorization request before the authorize method is invoked. If your flow is multi-step and stores data in the session object, restore that data into the request inside prepareAuthzRequest (see sample below).</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/authorization_challenge/authorization-challenge/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>context</code> Reference","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/authorization_challenge/authorization-challenge/#common-use-case-authorize-user-by-usernamepassword","title":"Common Use Case: Authorize user by username/password","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/authorization_challenge/authorization-challenge/#script-type-java","title":"Script Type: Java","text":"<pre><code>import io.jans.as.common.model.common.User;\nimport io.jans.as.common.model.session.DeviceSession;\nimport io.jans.as.server.authorize.ws.rs.DeviceSessionService;\nimport io.jans.as.server.service.UserService;\nimport io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.authzchallenge.AuthorizationChallengeType;\nimport io.jans.orm.PersistenceEntryManager;\nimport io.jans.service.cdi.util.CdiUtil;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.apache.commons.lang3.StringUtils;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\nimport java.util.HashMap;\nimport java.util.UUID;\n\n/**\n * @author Yuriy Z\n */\npublic class AuthorizationChallenge implements AuthorizationChallengeType {\n\n    public static final String USERNAME_PARAMETER = \"username\";\n    public static final String PASSWORD_PARAMETER = \"password\";\n\n    private static final Logger log = LoggerFactory.getLogger(AuthorizationChallenge.class);\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    /**\n     * Return true if Authorization Challenge Endpoint should return code successfully or otherwise false if error should be returned.\n     * &lt;p&gt;\n     * Implementation of this method should consist of 3 main parts:\n     * 1. validate all parameters are present and if not -&gt; set error and return false\n     * 2. main authorization logic, if ok -&gt; set authorized user into \"context.getExecutionContext().setUser(user);\" and return true\n     * 3. if not ok -&gt; set error which explains what is wrong and return false\n     *\n     * @param scriptContext ExternalScriptContext, see https://github.com/JanssenProject/jans/blob/main/jans-auth-server/server/src/main/java/io/jans/as/server/service/external/context/ExternalScriptContext.java\n     * @return true if Authorization Challenge Endpoint should return code successfully or otherwise false if error should be returned.\n     */\n    @Override\n    public boolean authorize(Object scriptContext) {\n        ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n\n        // 1. validate all required parameters are present\n        final String username = getParameterOrCreateError(context, USERNAME_PARAMETER);\n        if (StringUtils.isBlank(username)) {\n            return false;\n        }\n\n        final String password = getParameterOrCreateError(context, PASSWORD_PARAMETER);\n        if (StringUtils.isBlank(password)) {\n            return false;\n        }\n\n        scriptLogger.trace(\"All required parameters are present\");\n\n        // 2. main authorization logic, if ok -&gt; set authorized user into \"context.getExecutionContext().setUser(user);\" and return true\n        UserService userService = CdiUtil.bean(UserService.class);\n        PersistenceEntryManager entryManager = CdiUtil.bean(PersistenceEntryManager.class);\n\n        final User user = userService.getUser(username);\n        if (user == null) {\n            scriptLogger.trace(\"User is not found by username {}\", username);\n            createError(context, \"username_invalid\");\n            return false;\n        }\n\n        final boolean ok = entryManager.authenticate(user.getDn(), User.class, password);\n        if (ok) {\n            context.getExecutionContext().setUser(user); // &lt;- IMPORTANT : without user set, user relation will not be associated with token\n            scriptLogger.trace(\"User {} is authenticated successfully.\", username);\n            return true;\n        }\n\n        // 3. not ok -&gt; set error which explains what is wrong and return false\n        scriptLogger.trace(\"Failed to authenticate user {}. Please check username and password.\", username);\n        createError(context, \"username_or_password_invalid\");\n        return false;\n    }\n\n    private String getParameterOrCreateError(ExternalScriptContext context, String parameterName) {\n        String value = context.getHttpRequest().getParameter(parameterName);\n\n        if (StringUtils.isBlank(value)) {\n            scriptLogger.trace(\"No '{}' parameter in request\", parameterName);\n            value = getParameterFromDeviceSession(context, parameterName);\n        }\n\n        if (StringUtils.isBlank(value)) {\n            scriptLogger.trace(\"{} is not provided\", parameterName);\n            createError(context, String.format(\"%s_required\", parameterName));\n            return null;\n        }\n\n        return value;\n    }\n\n    private void createError(ExternalScriptContext context, String errorCode) {\n        String deviceSessionPart = prepareDeviceSessionSubJson(context);\n\n        final String entity = String.format(\"{\\\"error\\\": \\\"%s\\\"%s}\", errorCode, deviceSessionPart);\n        context.createWebApplicationException(401, entity);\n    }\n\n    private String prepareDeviceSessionSubJson(ExternalScriptContext context) {\n        DeviceSession authorizationChallengeSessionObject = context.getAuthzRequest().getDeviceSessionObject();\n        if (authorizationChallengeSessionObject != null) {\n            prepareDeviceSession(context, authorizationChallengeSessionObject);\n            return String.format(\",\\\"auth_session\\\":\\\"%s\\\"\", authorizationChallengeSessionObject.getId());\n        } else if (context.getAuthzRequest().isUseDeviceSession()) {\n            authorizationChallengeSessionObject = prepareDeviceSession(context, null);\n            return String.format(\",\\\"auth_session\\\":\\\"%s\\\"\", authorizationChallengeSessionObject.getId());\n        }\n        return \"\";\n    }\n\n    private DeviceSession prepareDeviceSession(ExternalScriptContext context, DeviceSession authorizationChallengeSessionObject) {\n        DeviceSessionService deviceSessionService = CdiUtil.bean(DeviceSessionService.class);\n        boolean newSave = authorizationChallengeSessionObject == null;\n        if (newSave) {\n            authorizationChallengeSessionObject = deviceSessionService.newDeviceSession();\n        }\n\n        String username = context.getHttpRequest().getParameter(USERNAME_PARAMETER);\n        if (StringUtils.isNotBlank(username)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(USERNAME_PARAMETER, username);\n        }\n\n        String password = context.getHttpRequest().getParameter(PASSWORD_PARAMETER);\n        if (StringUtils.isNotBlank(password)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(PASSWORD_PARAMETER, password);\n        }\n\n        String clientId = context.getHttpRequest().getParameter(\"client_id\");\n        if (StringUtils.isNotBlank(clientId)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(\"client_id\", clientId);\n        }\n\n        String acrValues = context.getHttpRequest().getParameter(\"acr_values\");\n        if (StringUtils.isNotBlank(acrValues)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(\"acr_values\", acrValues);\n        }\n\n        if (newSave) {\n            deviceSessionService.persist(authorizationChallengeSessionObject);\n        } else {\n            deviceSessionService.merge(authorizationChallengeSessionObject);\n        }\n\n        return authorizationChallengeSessionObject;\n    }\n\n    private String getParameterFromDeviceSession(ExternalScriptContext context, String parameterName) {\n        final DeviceSession authorizationChallengeSessionObject = context.getAuthzRequest().getDeviceSessionObject();\n        if (authorizationChallengeSessionObject != null) {\n            return authorizationChallengeSessionObject.getAttributes().getAttributes().get(parameterName);\n        }\n        return null;\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized Default AuthorizationChallenge Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized Default AuthorizationChallenge Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed Default AuthorizationChallenge Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n\n    @Override\n    public Map&lt;String, String&gt; getAuthenticationMethodClaims(Object context) {\n        return new HashMap&lt;&gt;();\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/authorization_challenge/authorization-challenge/#multi-step-authorization-by-username-and-otp","title":"Multi-step authorization by username and OTP","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/authorization_challenge/authorization-challenge/#script-type-java_1","title":"Script Type: Java","text":"<pre><code>import io.jans.as.common.model.common.User;\nimport io.jans.as.common.model.session.DeviceSession;\nimport io.jans.as.server.authorize.ws.rs.DeviceSessionService;\nimport io.jans.as.server.service.UserService;\nimport io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.authzchallenge.AuthorizationChallengeType;\nimport io.jans.orm.PersistenceEntryManager;\nimport io.jans.service.cdi.util.CdiUtil;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.apache.commons.lang3.StringUtils;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\nimport java.util.HashMap;\nimport java.util.UUID;\n\n/**\n * Script is to demo 2 steps flow:\n * 1) First step -&gt; send username\n * 2) Second step -&gt; send OTP\n *\n * AS tracks data by 'auth_session'. See \"prepareDeviceSession()\" method implemention for details.\n *\n * @author Yuriy Z\n */\npublic class AuthorizationChallenge implements AuthorizationChallengeType {\n\n    public static final String USERNAME_PARAMETER = \"username\";\n    public static final String OTP_PARAMETER = \"otp\";\n\n    private static final Logger log = LoggerFactory.getLogger(AuthorizationChallenge.class);\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    /**\n     * Return true if Authorization Challenge Endpoint should return code successfully or otherwise false if error should be returned.\n     * &lt;p&gt;\n     * Implementation of this method should consist of 3 main parts:\n     * 1. validate all parameters are present and if not -&gt; set error and return false\n     * 2. main authorization logic, if ok -&gt; set authorized user into \"context.getExecutionContext().setUser(user);\" and return true\n     * 3. if not ok -&gt; set error which explains what is wrong and return false\n     *\n     * @param scriptContext ExternalScriptContext, see https://github.com/JanssenProject/jans/blob/main/jans-auth-server/server/src/main/java/io/jans/as/server/service/external/context/ExternalScriptContext.java\n     * @return true if Authorization Challenge Endpoint should return code successfully or otherwise false if error should be returned.\n     */\n    @Override\n    public boolean authorize(Object scriptContext) {\n        ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n\n        // 1. As first step we get username\n        final String username = getParameterOrCreateError(context, USERNAME_PARAMETER);\n        if (StringUtils.isBlank(username)) {\n            return false;\n        }\n\n        // 2. During first execution OTP is not present, so error will be returned with auth_session (which has saved username)\n        //    Note: prepareDeviceSession method implemention\n        final String otp = getParameterOrCreateError(context, OTP_PARAMETER);\n        if (StringUtils.isBlank(otp)) {\n            return false;\n        }\n\n        scriptLogger.trace(\"All required parameters are present\");\n\n        // 2. main authorization logic, if ok -&gt; set authorized user into \"context.getExecutionContext().setUser(user);\" and return true\n        UserService userService = CdiUtil.bean(UserService.class);\n        PersistenceEntryManager entryManager = CdiUtil.bean(PersistenceEntryManager.class);\n\n        final User user = userService.getUser(username);\n        if (user == null) {\n            scriptLogger.trace(\"User is not found by username {}\", username);\n            createError(context, \"username_invalid\");\n            return false;\n        }\n\n        // for simplicity OTP is here just username password but in real world scenario real OTP validation is needed.\n        final boolean ok = entryManager.authenticate(user.getDn(), User.class, otp);\n        if (ok) {\n            context.getExecutionContext().setUser(user); // &lt;- IMPORTANT : without user set, user relation will not be associated with token\n            scriptLogger.trace(\"User {} is authenticated successfully.\", username);\n            return true;\n        }\n\n        // 3. not ok -&gt; set error which explains what is wrong and return false\n        scriptLogger.trace(\"Failed to authenticate user {}. Please check username and OTP.\", username);\n        createError(context, \"username_or_otp_invalid\");\n        return false;\n    }\n\n    private String getParameterOrCreateError(ExternalScriptContext context, String parameterName) {\n        String value = context.getHttpRequest().getParameter(parameterName);\n\n        if (StringUtils.isBlank(value)) {\n            scriptLogger.trace(\"No '{}' parameter in request\", parameterName);\n            value = getParameterFromDeviceSession(context, parameterName);\n        }\n\n        if (StringUtils.isBlank(value)) {\n            scriptLogger.trace(\"{} is not provided\", parameterName);\n            createError(context, String.format(\"%s_required\", parameterName));\n            return null;\n        }\n\n        return value;\n    }\n\n    private void createError(ExternalScriptContext context, String errorCode) {\n        String deviceSessionPart = prepareDeviceSessionSubJson(context);\n\n        final String entity = String.format(\"{\\\"error\\\": \\\"%s\\\"%s}\", errorCode, deviceSessionPart);\n        context.createWebApplicationException(401, entity);\n    }\n\n    private String prepareDeviceSessionSubJson(ExternalScriptContext context) {\n        DeviceSession authorizationChallengeSessionObject = context.getAuthzRequest().getDeviceSessionObject();\n        if (authorizationChallengeSessionObject != null) {\n            prepareDeviceSession(context, authorizationChallengeSessionObject);\n            return String.format(\",\\\"auth_session\\\":\\\"%s\\\"\", authorizationChallengeSessionObject.getId());\n        } else if (context.getAuthzRequest().isUseDeviceSession()) {\n            authorizationChallengeSessionObject = prepareDeviceSession(context, null);\n            return String.format(\",\\\"auth_session\\\":\\\"%s\\\"\", authorizationChallengeSessionObject.getId());\n        }\n        return \"\";\n    }\n\n    private DeviceSession prepareDeviceSession(ExternalScriptContext context, DeviceSession authorizationChallengeSessionObject) {\n        DeviceSessionService deviceSessionService = CdiUtil.bean(DeviceSessionService.class);\n        boolean newSave = authorizationChallengeSessionObject == null;\n        if (newSave) {\n            authorizationChallengeSessionObject = deviceSessionService.newDeviceSession();\n        }\n\n        String username = context.getHttpRequest().getParameter(USERNAME_PARAMETER);\n        if (StringUtils.isNotBlank(username)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(USERNAME_PARAMETER, username);\n        }\n\n        String otp = context.getHttpRequest().getParameter(OTP_PARAMETER);\n        if (StringUtils.isNotBlank(otp)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(OTP_PARAMETER, otp);\n        }\n\n        String clientId = context.getHttpRequest().getParameter(\"client_id\");\n        if (StringUtils.isNotBlank(clientId)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(\"client_id\", clientId);\n        }\n\n        String acrValues = context.getHttpRequest().getParameter(\"acr_values\");\n        if (StringUtils.isNotBlank(acrValues)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(\"acr_values\", acrValues);\n        }\n\n        if (newSave) {\n            deviceSessionService.persist(authorizationChallengeSessionObject);\n        } else {\n            deviceSessionService.merge(authorizationChallengeSessionObject);\n        }\n\n        return authorizationChallengeSessionObject;\n    }\n\n    private String getParameterFromDeviceSession(ExternalScriptContext context, String parameterName) {\n        final DeviceSession authorizationChallengeSessionObject = context.getAuthzRequest().getDeviceSessionObject();\n        if (authorizationChallengeSessionObject != null) {\n            return authorizationChallengeSessionObject.getAttributes().getAttributes().get(parameterName);\n        }\n        return null;\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized Default AuthorizationChallenge Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized Default AuthorizationChallenge Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed Default AuthorizationChallenge Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n\n    @Override\n    public Map&lt;String, String&gt; getAuthenticationMethodClaims(Object context) {\n        return new HashMap&lt;&gt;();\n    }    \n\n    @Override\n    public void prepareAuthzRequest(Object scriptContext) {\n        ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n        final AuthorizationChallengeSession sessionObject = context.getAuthzRequest().getAuthorizationChallengeSessionObject();\n        if (sessionObject != null) {\n            final Map&lt;String, String&gt; sessionAttributes = sessionObject.getAttributes().getAttributes();\n            final String scopeFromSession = sessionAttributes.get(\"scope\");\n            if (StringUtils.isNotBlank(scopeFromSession) &amp;&amp; StringUtils.isBlank(context.getAuthzRequest().getScope())) {\n                context.getAuthzRequest().setScope(scopeFromSession);\n            }\n        }\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/authorization_challenge/authorization-challenge/#sample-scripts","title":"Sample Scripts","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/authorization_challenge/authorization-challenge/#authorization-challenge-script","title":"Authorization Challenge Script","text":"<pre><code>import io.jans.as.common.model.common.User;\nimport io.jans.as.common.model.session.AuthorizationChallengeSession;\nimport io.jans.as.server.auth.DpopService;\nimport io.jans.as.server.authorize.ws.rs.AuthorizationChallengeSessionService;\nimport io.jans.as.server.service.UserService;\nimport io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.GluuStatus;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.authzchallenge.AuthorizationChallengeType;\nimport io.jans.orm.PersistenceEntryManager;\nimport io.jans.service.cdi.util.CdiUtil;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.apache.commons.lang3.StringUtils;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.HashMap;\nimport java.util.Map;\n\n/**\n * @author Yuriy Z\n */\npublic class AuthorizationChallenge implements AuthorizationChallengeType {\n\n    public static final String USERNAME_PARAMETER = \"username\";\n    public static final String PASSWORD_PARAMETER = \"password\";\n\n    private static final Logger log = LoggerFactory.getLogger(AuthorizationChallenge.class);\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    /**\n     * Return true if Authorization Challenge Endpoint should return code successfully or otherwise false if error should be returned.\n     * &lt;p&gt;\n     * Implementation of this method should consist of 3 main parts:\n     * 1. validate all parameters are present and if not -&gt; set error and return false\n     * 2. main authorization logic, if ok -&gt; set authorized user into \"context.getExecutionContext().setUser(user);\" and return true\n     * 3. if not ok -&gt; set error which explains what is wrong and return false\n     *\n     * @param scriptContext ExternalScriptContext, see https://github.com/JanssenProject/jans/blob/main/jans-auth-server/server/src/main/java/io/jans/as/server/service/external/context/ExternalScriptContext.java\n     * @return true if Authorization Challenge Endpoint should return code successfully or otherwise false if error should be returned.\n     */\n    @Override\n    public boolean authorize(Object scriptContext) {\n        ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n\n        // 1. validate all required parameters are present\n        final String username = getParameterOrCreateError(context, USERNAME_PARAMETER);\n        if (StringUtils.isBlank(username)) {\n            return false;\n        }\n\n        final String password = getParameterOrCreateError(context, PASSWORD_PARAMETER);\n        if (StringUtils.isBlank(password)) {\n            return false;\n        }\n\n        scriptLogger.trace(\"All required parameters are present\");\n\n        // 2. main authorization logic, if ok -&gt; set authorized user into \"context.getExecutionContext().setUser(user);\" and return true\n        UserService userService = CdiUtil.bean(UserService.class);\n        PersistenceEntryManager entryManager = CdiUtil.bean(PersistenceEntryManager.class);\n\n        final User user = userService.getUser(username);\n        if (user == null) {\n            scriptLogger.trace(\"User is not found by username {}\", username);\n            createError(context, \"username_invalid\");\n            return false;\n        }\n\n        boolean isUserActive = user.getStatus() == GluuStatus.ACTIVE;\n        if (!isUserActive){\n            scriptLogger.trace(\"User is not active, username {}\", username);\n            createError(context, \"username_inactive\");\n            return false;\n        }\n\n        // for simplicity OTP is here just username password but in real world scenario real OTP validation is needed.\n        final boolean ok = entryManager.authenticate(user.getDn(), User.class, password);\n        if (ok) {\n            context.getExecutionContext().setUser(user); // &lt;- IMPORTANT : without user set, user relation will not be associated with token\n            scriptLogger.trace(\"User {} is authenticated successfully.\", username);\n            return true;\n        }\n\n        // 3. not ok -&gt; set error which explains what is wrong and return false\n        scriptLogger.trace(\"Failed to authenticate user {}. Please check username and password.\", username);\n        createError(context, \"username_or_password_invalid\");\n        return false;\n    }\n\n    private String getParameterOrCreateError(ExternalScriptContext context, String parameterName) {\n        String value = context.getHttpRequest().getParameter(parameterName);\n\n        if (StringUtils.isBlank(value)) {\n            scriptLogger.trace(\"No '{}' parameter in request\", parameterName);\n            value = getParameterFromAuthorizationChallengeSession(context, parameterName);\n        }\n\n        if (StringUtils.isBlank(value)) {\n            scriptLogger.trace(\"{} is not provided\", parameterName);\n            createError(context, String.format(\"%s_required\", parameterName));\n            return null;\n        }\n\n        return value;\n    }\n\n    private void createError(ExternalScriptContext context, String errorCode) {\n        String sessionPart = prepareAuthorizationChallengeSessionSubJson(context);\n\n        final String entity = String.format(\"{\\\"error\\\": \\\"%s\\\"%s}\", errorCode, sessionPart);\n        context.createWebApplicationException(401, entity);\n    }\n\n    private String prepareAuthorizationChallengeSessionSubJson(ExternalScriptContext context) {\n        AuthorizationChallengeSession sessionObject = context.getAuthzRequest().getAuthorizationChallengeSessionObject();\n        if (sessionObject != null) {\n            prepareAuthorizationChallengeSession(context, sessionObject);\n            return String.format(\",\\\"auth_session\\\":\\\"%s\\\"\", sessionObject.getId());\n        } else if (context.getAuthzRequest().isUseAuthorizationChallengeSession()) {\n            sessionObject = prepareAuthorizationChallengeSession(context, null);\n            return String.format(\",\\\"auth_session\\\":\\\"%s\\\"\", sessionObject.getId());\n        }\n        return \"\";\n    }\n\n    private AuthorizationChallengeSession prepareAuthorizationChallengeSession(ExternalScriptContext context, AuthorizationChallengeSession authorizationChallengeSessionObject) {\n        AuthorizationChallengeSessionService authorizationChallengeSessionService = CdiUtil.bean(AuthorizationChallengeSessionService.class);\n        boolean newSave = authorizationChallengeSessionObject == null;\n        if (newSave) {\n            authorizationChallengeSessionObject = authorizationChallengeSessionService.newAuthorizationChallengeSession();\n            context.getAuthzRequest().setAuthorizationChallengeSessionObject(authorizationChallengeSessionObject);\n            context.getAuthzRequest().setAuthorizationChallengeSession(authorizationChallengeSessionObject.getId());\n        }\n\n        final String dpop = context.getHttpRequest().getHeader(DpopService.DPOP);\n        if (StringUtils.isNotBlank(dpop)) {\n            authorizationChallengeSessionObject.getAttributes().setJkt(getDpopJkt(dpop));\n        }\n\n\n        String username = context.getHttpRequest().getParameter(USERNAME_PARAMETER);\n        if (StringUtils.isNotBlank(username)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(USERNAME_PARAMETER, username);\n        }\n\n        String password = context.getHttpRequest().getParameter(PASSWORD_PARAMETER);\n        if (StringUtils.isNotBlank(password)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(PASSWORD_PARAMETER, password);\n        }\n\n        String clientId = context.getHttpRequest().getParameter(\"client_id\");\n        if (StringUtils.isNotBlank(clientId)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(\"client_id\", clientId);\n        }\n\n        String acrValues = context.getHttpRequest().getParameter(\"acr_values\");\n        if (StringUtils.isNotBlank(acrValues)) {\n            authorizationChallengeSessionObject.getAttributes().getAttributes().put(\"acr_values\", acrValues);\n        }\n\n        if (newSave) {\n            authorizationChallengeSessionService.persist(authorizationChallengeSessionObject);\n        } else {\n            authorizationChallengeSessionService.merge(authorizationChallengeSessionObject);\n        }\n\n        return authorizationChallengeSessionObject;\n    }\n\n    public String getDpopJkt(String dpop) {\n        if (StringUtils.isBlank(dpop)) {\n            return null;\n        }\n\n        try {\n            return DpopService.getDpopJwkThumbprint(dpop);\n        } catch (Exception e) {\n            scriptLogger.error(\"Failed to get jkt from DPoP: \" + dpop,e);\n            return null;\n        }\n    }\n\n    private String getParameterFromAuthorizationChallengeSession(ExternalScriptContext context, String parameterName) {\n        final AuthorizationChallengeSession sessionObject = context.getAuthzRequest().getAuthorizationChallengeSessionObject();\n        if (sessionObject != null) {\n            return sessionObject.getAttributes().getAttributes().get(parameterName);\n        }\n        return null;\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized Default AuthorizationChallenge Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized Default AuthorizationChallenge Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed Default AuthorizationChallenge Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n\n    /**\n     * Returns claims represented by key-value map. Claims are added to id_token jwt.\n     *\n     * @param context external script context\n     * @return authentication method claims represented by key-value map.\n     */\n    @Override\n    public Map&lt;String, String&gt; getAuthenticationMethodClaims(Object context) {\n        return new HashMap&lt;&gt;();\n    }\n\n    @Override\n    public void prepareAuthzRequest(Object scriptContext) {\n        ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n        final AuthorizationChallengeSession sessionObject = context.getAuthzRequest().getAuthorizationChallengeSessionObject();\n        if (sessionObject != null) {\n            final Map&lt;String, String&gt; sessionAttributes = sessionObject.getAttributes().getAttributes();\n\n            // set scope from session into request object\n            final String scopeFromSession = sessionAttributes.get(\"scope\");\n            if (StringUtils.isNotBlank(scopeFromSession) &amp;&amp; StringUtils.isBlank(context.getAuthzRequest().getScope())) {\n                context.getAuthzRequest().setScope(scopeFromSession);\n            }\n        }\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/authorization_challenge/authorization-challenge/#multi-step-authorization-challenge-script","title":"Multi-step Authorization Challenge Script","text":"<pre><code>import io.jans.as.common.model.common.User;\nimport io.jans.as.common.model.session.AuthorizationChallengeSession;\nimport io.jans.as.server.authorize.ws.rs.AuthorizationChallengeSessionService;\nimport io.jans.as.server.service.UserService;\nimport io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.authzchallenge.AuthorizationChallengeType;\nimport io.jans.orm.PersistenceEntryManager;\nimport io.jans.service.cdi.util.CdiUtil;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.apache.commons.lang3.StringUtils;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\nimport java.util.HashMap;\nimport java.util.UUID;\n\n/**\n * Script is to demo 2 steps flow:\n * 1) First step -&gt; send username\n * 2) Second step -&gt; send OTP\n *\n * AS tracks data by 'auth_session'. See \"prepareAuthorizationChallengeSession()\" method implemention for details.\n *\n * @author Yuriy Z\n */\npublic class AuthorizationChallenge implements AuthorizationChallengeType {\n\n    public static final String USERNAME_PARAMETER = \"username\";\n    public static final String OTP_PARAMETER = \"otp\";\n\n    private static final Logger log = LoggerFactory.getLogger(AuthorizationChallenge.class);\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    /**\n     * Return true if Authorization Challenge Endpoint should return code successfully or otherwise false if error should be returned.\n     * &lt;p&gt;\n     * Implementation of this method should consist of 3 main parts:\n     * 1. validate all parameters are present and if not -&gt; set error and return false\n     * 2. main authorization logic, if ok -&gt; set authorized user into \"context.getExecutionContext().setUser(user);\" and return true\n     * 3. if not ok -&gt; set error which explains what is wrong and return false\n     *\n     * @param scriptContext ExternalScriptContext, see https://github.com/JanssenProject/jans/blob/main/jans-auth-server/server/src/main/java/io/jans/as/server/service/external/context/ExternalScriptContext.java\n     * @return true if Authorization Challenge Endpoint should return code successfully or otherwise false if error should be returned.\n     */\n    @Override\n    public boolean authorize(Object scriptContext) {\n        ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n\n        // 1. As first step we get username\n        final String username = getParameterOrCreateError(context, USERNAME_PARAMETER);\n        if (StringUtils.isBlank(username)) {\n            return false;\n        }\n\n        // 2. During first execution OTP is not present, so error will be returned with auth_session (which has saved username)\n        //    Note: prepareAuthorizationChallengeSession method implemention\n        final String otp = getParameterOrCreateError(context, OTP_PARAMETER);\n        if (StringUtils.isBlank(otp)) {\n            return false;\n        }\n\n        scriptLogger.trace(\"All required parameters are present\");\n\n        // 2. main authorization logic, if ok -&gt; set authorized user into \"context.getExecutionContext().setUser(user);\" and return true\n        UserService userService = CdiUtil.bean(UserService.class);\n        PersistenceEntryManager entryManager = CdiUtil.bean(PersistenceEntryManager.class);\n\n        final User user = userService.getUser(username);\n        if (user == null) {\n            scriptLogger.trace(\"User is not found by username {}\", username);\n            createError(context, \"username_invalid\");\n            return false;\n        }\n\n        // for simplicity OTP is here just username password but in real world scenario real OTP validation is needed.\n        final boolean ok = entryManager.authenticate(user.getDn(), User.class, otp);\n        if (ok) {\n            context.getExecutionContext().setUser(user); // &lt;- IMPORTANT : without user set, user relation will not be associated with token\n            scriptLogger.trace(\"User {} is authenticated successfully.\", username);\n            return true;\n        }\n\n        // 3. not ok -&gt; set error which explains what is wrong and return false\n        scriptLogger.trace(\"Failed to authenticate user {}. Please check username and OTP.\", username);\n        createError(context, \"username_or_otp_invalid\");\n        return false;\n    }\n\n    private String getParameterOrCreateError(ExternalScriptContext context, String parameterName) {\n        String value = context.getHttpRequest().getParameter(parameterName);\n\n        if (StringUtils.isBlank(value)) {\n            scriptLogger.trace(\"No '{}' parameter in request\", parameterName);\n            value = getParameterFromAuthorizationChallengeSession(context, parameterName);\n        }\n\n        if (StringUtils.isBlank(value)) {\n            scriptLogger.trace(\"{} is not provided\", parameterName);\n            createError(context, String.format(\"%s_required\", parameterName));\n            return null;\n        }\n\n        return value;\n    }\n\n    private void createError(ExternalScriptContext context, String errorCode) {\n        String sessionPart = prepareAuthorizationChallengeSessionSubJson(context);\n\n        final String entity = String.format(\"{\\\"error\\\": \\\"%s\\\"%s}\", errorCode, sessionPart);\n        context.createWebApplicationException(401, entity);\n    }\n\n    private String prepareAuthorizationChallengeSessionSubJson(ExternalScriptContext context) {\n        AuthorizationChallengeSession sessionObject = context.getAuthzRequest().getAuthorizationChallengeSessionObject();\n        if (sessionObject != null) {\n            prepareAuthorizationChallengeSession(context, sessionObject);\n            return String.format(\",\\\"auth_session\\\":\\\"%s\\\"\", sessionObject.getId());\n        } else if (context.getAuthzRequest().isUseAuthorizationChallengeSession()) {\n            sessionObject = prepareAuthorizationChallengeSession(context, null);\n            return String.format(\",\\\"auth_session\\\":\\\"%s\\\"\", sessionObject.getId());\n        }\n        return \"\";\n    }\n\n    private AuthorizationChallengeSession prepareAuthorizationChallengeSession(ExternalScriptContext context, AuthorizationChallengeSession sessionObject) {\n        AuthorizationChallengeSessionService authorizationChallengeSessionService = CdiUtil.bean(AuthorizationChallengeSessionService.class);\n        boolean newSave = sessionObject == null;\n        if (newSave) {\n            sessionObject = authorizationChallengeSessionService.newAuthorizationChallengeSession();\n            context.getAuthzRequest().setAuthorizationChallengeSessionObject(authorizationChallengeSessionObject);\n            context.getAuthzRequest().setAuthorizationChallengeSession(authorizationChallengeSessionObject.getId());\n        }\n\n        String username = context.getHttpRequest().getParameter(USERNAME_PARAMETER);\n        if (StringUtils.isNotBlank(username)) {\n            sessionObject.getAttributes().getAttributes().put(USERNAME_PARAMETER, username);\n        }\n\n        String otp = context.getHttpRequest().getParameter(OTP_PARAMETER);\n        if (StringUtils.isNotBlank(otp)) {\n            sessionObject.getAttributes().getAttributes().put(OTP_PARAMETER, otp);\n        }\n\n        String clientId = context.getHttpRequest().getParameter(\"client_id\");\n        if (StringUtils.isNotBlank(clientId)) {\n            sessionObject.getAttributes().getAttributes().put(\"client_id\", clientId);\n        }\n\n        String acrValues = context.getHttpRequest().getParameter(\"acr_values\");\n        if (StringUtils.isNotBlank(acrValues)) {\n            sessionObject.getAttributes().getAttributes().put(\"acr_values\", acrValues);\n        }\n\n        if (newSave) {\n            authorizationChallengeSessionService.persist(sessionObject);\n        } else {\n            authorizationChallengeSessionService.merge(sessionObject);\n        }\n\n        return sessionObject;\n    }\n\n    private String getParameterFromAuthorizationChallengeSession(ExternalScriptContext context, String parameterName) {\n        final AuthorizationChallengeSession sessionObject = context.getAuthzRequest().getAuthorizationChallengeSessionObject();\n        if (sessionObject != null) {\n            return sessionObject.getAttributes().getAttributes().get(parameterName);\n        }\n        return null;\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized Default AuthorizationChallenge Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized Default AuthorizationChallenge Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed Default AuthorizationChallenge Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n\n    @Override\n    public Map&lt;String, String&gt; getAuthenticationMethodClaims(Object context) {\n        return new HashMap&lt;&gt;();\n    }\n\n    @Override\n    public void prepareAuthzRequest(Object scriptContext) {\n        ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n        final AuthorizationChallengeSession sessionObject = context.getAuthzRequest().getAuthorizationChallengeSessionObject();\n        if (sessionObject != null) {\n            final Map&lt;String, String&gt; sessionAttributes = sessionObject.getAttributes().getAttributes();\n\n            // set scope from session into request object\n            final String scopeFromSession = sessionAttributes.get(\"scope\");\n            if (StringUtils.isNotBlank(scopeFromSession) &amp;&amp; StringUtils.isBlank(context.getAuthzRequest().getScope())) {\n                context.getAuthzRequest().setScope(scopeFromSession);\n            }\n        }\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/authz_detail/authz-detail/","title":"Authorization Detail Custom Script (AuthzDetail)","text":"<p>The Jans-Auth server implements OAuth 2.0 Rich Authorization Requests. This script is used to control/customize single authorization detail from <code>authorization_details</code> array.</p>","tags":["administration","developer","scripts"]},{"location":"script-catalog/authz_detail/authz-detail/#behavior","title":"Behavior","text":"<p>In request to Authorization Endpoint and to Token Endpoint RP can specify <code>authorization_details</code> request parameter which specifies JSON array.</p> <pre><code>[\n   {\n      \"type\": \"demo_authz_detail\",\n      \"actions\": [\n          \"list_accounts\",\n          \"read_balances\"\n      ],\n      \"locations\": [\n          \"https://example.com/accounts\"\n      ],\n      \"ui_representation\": \"Read balances and list accounts at https://example.com/accounts\"\n   },\n   {\n       \"type\":\"financial-transaction\",\n       \"actions\":[\n           \"withdraw\"\n       ],\n       \"identifier\":\"account-14-32-32-3\",\n       \"currency\":\"USD\",\n       \"ui_representation\": \"Withdraw money from account-14-32-32-3\"\n   }\n]\n</code></pre> <p><code>type</code> defines type of authorization detail. Each such type is represented by AS <code>AuthzDetailType</code> custom scripts. It means that for example above administrator must define two <code>AuthzDetailType</code> custom scripts with names: <code>demo_authz_detail</code> and <code>financial-transaction</code>.</p> <p>If <code>authorization_details</code> parameter is absent in request then <code>AuthzDetailType</code> custom scripts are not invoked.</p> <p><code>demo_authz_detail</code> and <code>financial-transaction</code> <code>AuthzDetailType</code> custom scripts must be provided by administrator.</p> <ul> <li><code>demo_authz_detail</code> is called for all authorization details with <code>\"type\": \"demo_authz_detail\"</code></li> <li><code>financial-transaction</code> is called for all authorization details with <code>\"type\": \"financial-transaction\"</code></li> </ul> <p>Sample Authorization Request <pre><code>POST /jans-auth/restv1/authorize HTTP/1.1\nHost: yuriyz-fond-skink.gluu.info\n\nresponse_type=code&amp;client_id=7a29bf35-96ec-4bbd-a05c-15e1ff9f07cc&amp;scope=openid+profile+address+email+phone+user_name&amp;redirect_uri=https%3A%2F%2Fyuriyz-relaxed-jawfish.gluu.info%2Fjans-auth-rp%2Fhome.htm&amp;state=6cdc7701-178c-4653-adac-5c1e9c6c4aba&amp;nonce=b9a1ecc4-548e-475c-8b29-f019417e1aef&amp;prompt=&amp;ui_locales=&amp;claims_locales=&amp;acr_values=&amp;request_session_id=false&amp;authorization_details=%5B%0A++%7B%0A++++%22type%22%3A+%22demo_authz_detail%22%2C%0A++++%22actions%22%3A+%5B%0A++++++%22list_accounts%22%2C%0A++++++%22read_balances%22%0A++++%5D%2C%0A++++%22locations%22%3A+%5B%0A++++++%22https%3A%2F%2Fexample.com%2Faccounts%22%0A++++%5D%2C%0A++++%22ui_representation%22%3A+%22Read+balances+and+list+accounts+at+https%3A%2F%2Fexample.com%2Faccounts%22%0A++%7D%0A%5D\n</code></pre></p>","tags":["administration","developer","scripts"]},{"location":"script-catalog/authz_detail/authz-detail/#interface","title":"Interface","text":"<p>The Authorization Details script implements the AuthzDetailType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","scripts"]},{"location":"script-catalog/authz_detail/authz-detail/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","scripts"]},{"location":"script-catalog/authz_detail/authz-detail/#new-methods","title":"New methods","text":"Method header Method description <code>def validateDetail(self, context)</code> Called when the request is received. Method validates single authorization detail from <code>authorization_details</code>. <code>def getUiRepresentation(self, context)</code> Called when single authorization detail from <code>authorization_details</code> has to be represented on UI as string. For example on authorization page. <p><code>validateDetail</code> method returns true/false which indicates to server whether the validation of single authorization detail (from <code>authorization_details</code> array) is passed or failed. If at least one element from <code>authorization_details</code> array fails validation error is returned by AS.</p> <p><code>getUiRepresentation</code> method returns string and represents single authorization detail as string on UI. Authorization detail can have \"ui_representation\" json key which makes implementation as simple as following:</p> <pre><code> @Override\n    public String getUiRepresentation(Object scriptContext) {\n        ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n        return context.getAuthzDetail().getJsonObject().optString(\"ui_representation\");\n    }\n</code></pre>","tags":["administration","developer","scripts"]},{"location":"script-catalog/authz_detail/authz-detail/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>context</code> Reference <ul> <li>Get Authz Detail - <code>context.getAuthzDetail()</code></li> <li>Get Authz Detail Type - <code>context.getAuthzDetail().getType()</code></li> <li>Get Authz Detail JSON Object (<code>org.json.JSONObject</code>) for manipulation - <code>context.getAuthzDetail().getJsonObject()</code></li> <li>Get full HTTP Request - <code>context.getHttpRequest()</code></li> </ul>","tags":["administration","developer","scripts"]},{"location":"script-catalog/authz_detail/authz-detail/#simple-use-case-validate-that-authz-details-are-present-and-return-string-representation","title":"Simple Use Case: validate that authz details are present and return string representation","text":"","tags":["administration","developer","scripts"]},{"location":"script-catalog/authz_detail/authz-detail/#script-type-java","title":"Script Type: Java","text":"<pre><code>/*\n Copyright (c) 2023, Gluu\n Author: Yuriy Z\n */\n\nimport io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.authzdetails.AuthzDetailType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\n\n/**\n * @author Yuriy Z\n */\npublic class AuthzDetail implements AuthzDetailType {\n\n    private static final Logger log = LoggerFactory.getLogger(AuthzDetail.class);\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    /**\n     * All validation logic of single authorization detail must take place in this method.\n     * If method returns \"false\" AS returns error to RP. If \"true\" processing of request goes on.\n     *\n     * @param scriptContext script context. Authz detail can be taken as \"context.getAuthzDetail()\".\n     * @return whether single authorization detail is valid or not\n     */\n    @Override\n    public boolean validateDetail(Object scriptContext) {\n        ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n        return context.getAuthzDetail() != null;\n    }\n\n    /**\n     * Method returns single authorization detail string representation which is shown on authorization page by AS.\n     *\n     * @param scriptContext script context. Authz detail can be taken as \"context.getAuthzDetail()\".\n     * @return returns single authorization details string representation which is shown on authorization page by AS.\n     */\n    @Override\n    public String getUiRepresentation(Object scriptContext) {\n        ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n        return context.getAuthzDetail().getJsonObject().optString(\"ui_representation\");\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized AuthzDetail Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized AuthzDetail Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed AuthzDetail Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n}\n</code></pre>","tags":["administration","developer","scripts"]},{"location":"script-catalog/authz_detail/authz-detail/#sample-scripts","title":"Sample Scripts","text":"","tags":["administration","developer","scripts"]},{"location":"script-catalog/authz_detail/authz-detail/#authorization-details-script","title":"Authorization Details Script","text":"<pre><code>/*\n Copyright (c) 2023, Gluu\n Author: Yuriy Z\n */\n\nimport io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.authzdetails.AuthzDetailType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\n\n/**\n * @author Yuriy Z\n */\npublic class AuthzDetail implements AuthzDetailType {\n\n    private static final Logger log = LoggerFactory.getLogger(AuthzDetail.class);\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    /**\n     * All validation logic of single authorization detail must take place in this method.\n     * If method returns \"false\" AS returns error to RP. If \"true\" processing of request goes on.\n     *\n     * @param scriptContext script context. Authz detail can be taken as \"context.getAuthzDetail()\".\n     * @return whether single authorization detail is valid or not\n     */\n    @Override\n    public boolean validateDetail(Object scriptContext) {\n        ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n        return context.getAuthzDetail() != null;\n    }\n\n    /**\n     * Method returns single authorization detail string representation which is shown on authorization page by AS.\n     *\n     * @param scriptContext script context. Authz detail can be taken as \"context.getAuthzDetail()\".\n     * @return returns single authorization details string representation which is shown on authorization page by AS.\n     */\n    @Override\n    public String getUiRepresentation(Object scriptContext) {\n        ExternalScriptContext context = (ExternalScriptContext) scriptContext;\n        return context.getAuthzDetail().getJsonObject().optString(\"ui_representation\");\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized AuthzDetail Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized AuthzDetail Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed AuthzDetail Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n}\n</code></pre>","tags":["administration","developer","scripts"]},{"location":"script-catalog/ciba/ciba/","title":"CIBA End User Notification Script (EndUserNotification)","text":"<p>The Jans-Auth server implements OAuth 2.0 Rich Authorization Requests. This script is used to control/customize CIBA notifications.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/ciba/ciba/#interface","title":"Interface","text":"<p>The CIBA end user script implements the EndUserNotificationType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/ciba/ciba/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/ciba/ciba/#new-methods","title":"New methods","text":"Method header Method description <code>notifyEndUser(self, context)</code> Returns boolean true or false depending on the process, if the notification is sent successfully or not","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/ciba/ciba/#script-type-python","title":"Script Type: Python","text":"<pre><code>from io.jans.as.client.fcm import FirebaseCloudMessagingResponse\nfrom io.jans.as.client.fcm import FirebaseCloudMessagingClient\nfrom io.jans.as.client.fcm import FirebaseCloudMessagingRequest\nfrom io.jans.as.util import RedirectUri\nfrom io.jans.model.custom.script.type.ciba import EndUserNotificationType\nfrom java.lang import String\nfrom java.util import UUID\n\nclass EndUserNotification(EndUserNotificationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, configurationAttributes):\n        print \"Firebase EndUserNotification script. Initializing ...\"\n        print \"Firebase EndUserNotification script. Initialized successfully\"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"Firebase EndUserNotification script. Destroying ...\"\n        print \"Firebase EndUserNotification script. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 1\n\n    # Returns boolean true or false depending on the process, if the notification\n    # is sent successfully or not.\n    def notifyEndUser(self, context):\n        print 'Sending push notification using Firebase Cloud Messaging'\n        appConfiguration = context.getAppConfiguration()\n        encryptionService = context.getEncryptionService()\n        clientId = appConfiguration.getBackchannelClientId()\n        redirectUri = appConfiguration.getBackchannelRedirectUri()\n        url = appConfiguration.getCibaEndUserNotificationConfig().getNotificationUrl()\n        key = encryptionService.decrypt(appConfiguration.getCibaEndUserNotificationConfig().getNotificationKey(), True)\n        to = context.getDeviceRegistrationToken()\n        title = \"oxAuth Authentication Request\"\n        body = \"Client Initiated Backchannel Authentication (CIBA)\"\n\n        authorizationRequestUri = RedirectUri(appConfiguration.getAuthorizationEndpoint())\n        authorizationRequestUri.addResponseParameter(\"client_id\", clientId)\n        authorizationRequestUri.addResponseParameter(\"response_type\", \"id_token\")\n        authorizationRequestUri.addResponseParameter(\"scope\", context.getScope())\n        authorizationRequestUri.addResponseParameter(\"acr_values\", context.getAcrValues())\n        authorizationRequestUri.addResponseParameter(\"redirect_uri\", redirectUri)\n        authorizationRequestUri.addResponseParameter(\"state\", UUID.randomUUID().toString())\n        authorizationRequestUri.addResponseParameter(\"nonce\", UUID.randomUUID().toString())\n        authorizationRequestUri.addResponseParameter(\"prompt\", \"consent\")\n        authorizationRequestUri.addResponseParameter(\"auth_req_id\", context.getAuthReqId())\n\n        clickAction = authorizationRequestUri.toString()\n\n        firebaseCloudMessagingRequest = FirebaseCloudMessagingRequest(key, to, title, body, clickAction)\n        firebaseCloudMessagingClient = FirebaseCloudMessagingClient(url)\n        firebaseCloudMessagingClient.setRequest(firebaseCloudMessagingRequest)\n        firebaseCloudMessagingResponse = firebaseCloudMessagingClient.exec()\n\n        responseStatus = firebaseCloudMessagingResponse.getStatus()\n        print \"CIBA: firebase cloud messaging result status \" + str(responseStatus)\n        return (responseStatus &gt;= 200 and responseStatus &lt; 300 )\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/ciba/ciba/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page, you can get started with our Contribution guide.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_authn/client-authn/","title":"Client Authentication Custom Script","text":"<p>AS support different types of client authentications such as :</p> <ul> <li>client_secret_basic</li> <li>client_secret_post</li> <li>client_secret_jwt</li> <li>private_key_jwt</li> </ul> <p>Sometimes it's convenient to customize default AS client authentication process. For this reason Client Authentication custom script was introduced.</p> <p>If script successfully authenticated client, it should return it in <code>authenticateClient</code>. If client is not returned then AS performs built-in authentication.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_authn/client-authn/#interface","title":"Interface","text":"<p>The Client Authentication script implements the ClientAuthnType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_authn/client-authn/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_authn/client-authn/#new-methods","title":"New methods","text":"Method header Method description <code>def authenticateClient(self, context)</code> Called when the request is received. <p><code>authenticateClient</code> method returns authenticated <code>Client</code> object or null if authentication failed.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_authn/client-authn/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>context</code> Reference","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_authn/client-authn/#sample-script-which-demonstrates-basic-client-authentication","title":"Sample script which demonstrates basic client authentication","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_authn/client-authn/#script-type-java","title":"Script Type: Java","text":"<pre><code>import io.jans.as.common.model.registration.Client;\nimport io.jans.as.model.config.Constants;\nimport io.jans.as.server.service.ClientService;\nimport io.jans.as.server.service.external.context.ExternalClientAuthnContext;\nimport io.jans.as.server.service.token.TokenService;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.client.ClientAuthnType;\nimport io.jans.service.cdi.util.CdiUtil;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport jakarta.servlet.http.HttpServletRequest;\nimport jakarta.servlet.http.HttpServletResponse;\nimport org.apache.commons.codec.binary.Base64;\nimport org.apache.commons.lang.StringUtils;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.net.URLDecoder;\nimport java.nio.charset.StandardCharsets;\nimport java.util.Map;\n\n/**\n * @author Yuriy Z\n */\npublic class ClientAuthn implements ClientAuthnType {\n\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    @Override\n    public Object authenticateClient(Object clientAuthnContext) {\n        final ExternalClientAuthnContext context = (ExternalClientAuthnContext) clientAuthnContext;\n\n        final HttpServletRequest request = context.getHttpRequest();\n        final HttpServletResponse response = context.getHttpResponse();\n\n        String authorization = request.getHeader(Constants.AUTHORIZATION);\n        if (!StringUtils.startsWith(authorization, \"Basic\")) {\n            context.sendUnauthorizedError();\n            return null;\n        }\n\n        TokenService tokenService = CdiUtil.bean(TokenService.class);\n        ClientService clientService = CdiUtil.bean(ClientService.class);\n\n        String base64Token = tokenService.getBasicToken(authorization);\n        String token = new String(Base64.decodeBase64(base64Token), StandardCharsets.UTF_8);\n\n        int delim = token.indexOf(\":\");\n\n        if (delim != -1) {\n            String clientId = URLDecoder.decode(token.substring(0, delim), StandardCharsets.UTF_8);\n            String clientSecret = URLDecoder.decode(token.substring(delim + 1), StandardCharsets.UTF_8);\n\n            final boolean authenticated = clientService.authenticate(clientId, clientSecret);\n            if (authenticated) {\n                final Client client = clientService.getClient(clientId);\n                scriptLogger.debug(\"Successfully performed basic client authentication, clientId: {}\", clientId);\n                return client;\n            }\n        }\n\n        context.sendUnauthorizedError();\n        return null;\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized ClientAuthn Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized ClientAuthn Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed ClientAuthn Java custom script.\");\n        return false;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_registration/client-registration/","title":"Client Registration scripts","text":"<p>The Jans-Auth server implements the OpenID Connect Dynamic Client Registration specification. This allows developers to register a client with the Authorization Server (AS) without any intervention from the administrator. By default, all clients are given the same default scopes and attributes. Through the use of an interception script, this behavior can be modified. These scripts can be used to analyze the registration request and apply customizations to the registered client. For example, a client can be given specific scopes by analyzing the Software Statement that is sent with the registration request.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_registration/client-registration/#behavior","title":"Behavior","text":"<p>By default, Jans server has no dynamic client registration scripts enabled, and all clients are given the same attributes. When a script is added and enabled, the script will run and return a <code>boolean</code> after applying logic to the registration request. If <code>true</code>, the client is registered and client credentials are returned. Generally, the script is global for all registration requests, and only one script is enabled at a time.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_registration/client-registration/#registration-flow","title":"Registration flow","text":"<pre><code>sequenceDiagram\ntitle Client Registration script\nautonumber 1\nRP-&gt;&gt;Jans AS: /register request\nJans AS-&gt;&gt;Jans AS: Is there a client registration script enabled?\nJans AS-&gt;&gt;Jans AS: run script\nnote  right of Jans AS: Apply custom logic e.g &lt;br/&gt; Add scopes &lt;br/&gt; Set attributes &lt;br/&gt; validate SSA\nJans AS-&gt;&gt;RP: return client credentials</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_registration/client-registration/#interface","title":"Interface","text":"<p>The client registration script implements the ClientRegistrationType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_registration/client-registration/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_registration/client-registration/#new-methods","title":"New methods","text":"Method header Method description <code>def createClient(self, context)</code> Called when the dynamic client registration request is received. <code>def updateClient(self, context)</code> Called when the PUT method is called on registration endpoint to update client details. <code>def getSoftwareStatementHmacSecret(self, context)</code> Returns secret key which will be used to validate Software Statement if HMAC algorithm is used (e.g. HS256, HS512) <code>def getSoftwareStatementJwks(self, context)</code> Returns JWKS which will be used to validate Software Statement if keys are used (e.g. RS256) <code>def modifyPutResponse(self, responseAsJsonObject, executionContext)</code> Modifies the response from the PUT request to registration endpoint <code>def modifyReadResponse(self, responseAsJsonObject, executionContext)</code> Modifies the response from the GET request to registration endpoint <code>def modifyPostResponse(self, responseAsJsonObject, executionContext)</code> Modifies the response from the POST request to registration endpoint","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_registration/client-registration/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>SimpleCustomProperty</code> Map of configuration properties. Reference <code>context</code> Reference <code>responseAsJsonObject</code> Java JSONObject. Reference <code>executionContext</code> Reference","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_registration/client-registration/#common-use-case-adding-scopes-defined-in-the-script-configuration-parameters","title":"Common Use Case: Adding scopes defined in the script configuration parameters","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_registration/client-registration/#script-type-python","title":"Script Type: Python","text":"<pre><code># oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.model.custom.script.type.client import ClientRegistrationType\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.service import ScopeService\nfrom io.jans.util import StringHelper, ArrayHelper\nfrom java.util import Arrays, ArrayList, HashSet\n\nimport java\n\nclass ClientRegistration(ClientRegistrationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Client registration. Initialization\"\n\n        self.clientRedirectUrisSet = self.prepareClientRedirectUris(configurationAttributes)\n\n        print \"Client registration. Initialized successfully\"\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print \"Client registration. Destroy\"\n        print \"Client registration. Destroyed successfully\"\n        return True   \n\n    # Update client entry before persistent it\n    # context refers to io.jans.as.server.service.external.context.DynamicClientRegistrationContext - see https://github.com/JanssenProject/jans-auth-server/blob/nightly/server/src/main/java/io/jans/as/server/service/external/context/DynamicClientRegistrationContext.java#L24\n    def createClient(self, context):\n        print \"Client registration. CreateClient method\"\n        registerRequest = context.getRegisterRequest()\n        configurationAttributes = context.getConfigurationAttibutes()\n        client = context.getClient()\n\n        redirectUris = client.getRedirectUris()\n        print \"Client registration. Redirect Uris: %s\" % redirectUris\n\n        addAddressScope = False\n        for redirectUri in redirectUris:\n            if (self.clientRedirectUrisSet.contains(redirectUri)):\n                addAddressScope = True\n                break\n\n        print \"Client registration. Is add address scope: %s\" % addAddressScope\n\n        if addAddressScope:\n            currentScopes = client.getScopes()\n            print \"Client registration. Current scopes: %s\" % currentScopes\n\n            scopeService = CdiUtil.bean(ScopeService)\n            addressScope = scopeService.getScopeByDisplayName(\"address\")\n            newScopes = ArrayHelper.addItemToStringArray(currentScopes, addressScope.getDn())\n\n            print \"Client registration. Result scopes: %s\" % newScopes\n            client.setScopes(newScopes)\n\n        return True\n\n    # Update client entry before persistent it\n    # context refers to io.jans.as.server.service.external.context.DynamicClientRegistrationContext - see https://github.com/JanssenProject/jans-auth-server/blob/nightly/server/src/main/java/io/jans/as/server/service/external/context/DynamicClientRegistrationContext.java#L24\n    def updateClient(self, context):\n        print \"Client registration. UpdateClient method\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    def prepareClientRedirectUris(self, configurationAttributes):\n        clientRedirectUrisSet = HashSet()\n        if not configurationAttributes.containsKey(\"client_redirect_uris\"):\n            return clientRedirectUrisSet\n\n        clientRedirectUrisList = configurationAttributes.get(\"client_redirect_uris\").getValue2()\n        if StringHelper.isEmpty(clientRedirectUrisList):\n            print \"Client registration. The property client_redirect_uris is empty\"\n            return clientRedirectUrisSet    \n\n        clientRedirectUrisArray = StringHelper.split(clientRedirectUrisList, \",\")\n        if ArrayHelper.isEmpty(clientRedirectUrisArray):\n            print \"Client registration. No clients specified in client_redirect_uris property\"\n            return clientRedirectUrisSet\n\n        # Convert to HashSet to quick search\n        i = 0\n        count = len(clientRedirectUrisArray)\n        while i &lt; count:\n            uris = clientRedirectUrisArray[i]\n            clientRedirectUrisSet.add(uris)\n            i = i + 1\n\n        return clientRedirectUrisSet\n\n    # Returns secret key which will be used to validate Software Statement if HMAC algorithm is used (e.g. HS256, HS512). Invoked if oxauth conf property softwareStatementValidationType=SCRIPT which is default/fallback value.\n    # context is reference of io.jans.as.service.external.context.DynamicClientRegistrationContext (in https://github.com/JanssenFederation/oxauth project )\n    def getSoftwareStatementHmacSecret(self, context):\n        return \"\"\n\n    # Returns JWKS which will be used to validate Software Statement if keys are used (e.g. RS256). Invoked if oxauth conf property softwareStatementValidationType=SCRIPT which is default/fallback value.\n    # context is reference of io.jans.as.service.external.context.DynamicClientRegistrationContext (in https://github.com/JanssenFederation/oxauth project )\n    def getSoftwareStatementJwks(self, context):\n        return \"\"\n\n    # cert - java.security.cert.X509Certificate\n    # context refers to io.jans.as.server.service.external.context.DynamicClientRegistrationContext - see https://github.com/JanssenProject/jans-auth-server/blob/nightly/server/src/main/java/io/jans/as/server/service/external/context/DynamicClientRegistrationContext.java#L24\n    def isCertValidForClient(self, cert, context):\n        return False\n\n        # responseAsJsonObject - is org.json.JSONObject, you can use any method to manipulate json\n    # context is reference of io.jans.as.server.model.common.ExecutionContext\n    def modifyPutResponse(self, responseAsJsonObject, executionContext):\n        return False\n\n    # responseAsJsonObject - is org.json.JSONObject, you can use any method to manipulate json\n    # context is reference of io.jans.as.server.model.common.ExecutionContext\n    def modifyReadResponse(self, responseAsJsonObject, executionContext):\n        return False\n\n    # responseAsJsonObject - is org.json.JSONObject, you can use any method to manipulate json\n    # context is reference of io.jans.as.server.model.common.ExecutionContext\n    def modifyPostResponse(self, responseAsJsonObject, executionContext):\n        return False\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_registration/client-registration/#script-type-java","title":"Script Type: Java","text":"<pre><code>import io.jans.as.common.model.registration.Client;\nimport io.jans.as.persistence.model.Scope;\nimport io.jans.as.server.service.ScopeService;\nimport io.jans.as.server.service.external.context.DynamicClientRegistrationContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.client.ClientRegistrationType;\nimport io.jans.orm.util.ArrayHelper;\nimport io.jans.service.cdi.util.CdiUtil;\nimport org.json.JSONArray;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\n\npublic class ClientRegistration implements ClientRegistrationType {\n    private static final Logger log = LoggerFactory.getLogger(ClientRegistration.class);\n\n    JSONArray json_array = null;\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        if (!configurationAttributes.containsKey(\"scope_list\")) {\n            log.info(\"Client registration. Initialization failed. Scope List not found.\");\n            return false;\n        }\n        String scope_list = configurationAttributes.get(\"scope_list\").getValue2();\n        json_array = new JSONArray(scope_list);\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Client registration. Initialization.\");\n        log.info(configurationAttributes.toString());\n        if (!configurationAttributes.containsKey(\"scope_list\")) {\n            log.info(\"Client registration. Initialization failed. Scope List not found.\");\n            return false;\n        }\n        String scope_list = configurationAttributes.get(\"scope_list\").getValue2();\n        json_array = new JSONArray(scope_list);\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Client registration. Destroy.\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n\n    @Override\n    public boolean createClient(Object context) {\n        log.info(\"Client registration. CreateClient method\");\n        DynamicClientRegistrationContext regContext = (DynamicClientRegistrationContext) context;\n        Client client = regContext.getClient();\n        ScopeService scopeService = CdiUtil.bean(ScopeService.class);\n\n        String[] currentScopes = client.getScopes();\n        String[] newScopes = currentScopes.clone();\n\n        for (int i = 0; i &lt; json_array.length(); i++) {\n            String scopeName = (String) json_array.get(i);\n            Scope foundScope = scopeService.getScopeById(scopeName);\n            if (foundScope == null) {\n                log.info(\"Client registration. Scope not found\");\n                return false;\n            }\n            newScopes = ArrayHelper.addItemToStringArray(newScopes, foundScope.getDn());\n        }\n\n        client.setScopes(newScopes);\n        log.info(\"Client registration. Scopes added.\");\n\n        return true;\n    }\n\n    @Override\n    public boolean updateClient(Object context) {\n        return true;\n    }\n\n    // This method needs to be overridden if client is providing an SSA with HMAC\n    @Override\n    public String getSoftwareStatementHmacSecret(Object context) {\n        return \"\";\n    }\n\n    // This method needs to be overridden if client is providing an SSA and RS256 validation\n    @Override\n    public String getSoftwareStatementJwks(Object context) {\n        return \"\";\n    }\n\n    @Override\n    public String getDcrHmacSecret(Object o) {\n        return \"\";\n    }\n\n    @Override\n    public String getDcrJwks(Object o) {\n        return \"\";\n    }\n\n    @Override\n    public boolean isCertValidForClient(Object o, Object o1) {\n        return false;\n    }\n\n    @Override\n    public boolean modifyPutResponse(Object responseAsJsonObject, Object executionContext) {\n        return true;\n    }\n\n    @Override\n    public boolean modifyReadResponse(Object responseAsJsonObject, Object executionContext) {\n        return true;\n    }\n\n    @Override\n    public boolean modifyPostResponse(Object responseAsJsonObject, Object executionContext) {\n        return true;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_registration/client-registration/#sample-scripts","title":"Sample Scripts","text":"<ul> <li>OpenBanking</li> </ul>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/client_registration/OpenBanking/client-registration/","title":"Client Registration Interception Script","text":"<p>The Janssen Authorization Server uses interception scripts to enable you to customize the behavior of the OpenID Provider. During client registration, custom interception scripts can be used to implement custom business logic. For instance, data could be validated, extra client claims could be populated, scopes could be modified, or APIs could be called to determine whether the client should get registered at all.</p>"},{"location":"script-catalog/client_registration/OpenBanking/client-registration/#configuration-prerequisites","title":"Configuration Prerequisites","text":"<ul> <li>A Janssen Authorization Server installation</li> <li>Client Registration script - included in the default Janssen OpenBanking distribution</li> <li>Setting configuration parameters</li> <li>Setting third party library (Jose4j) in classpath </li> </ul>"},{"location":"script-catalog/client_registration/OpenBanking/client-registration/#adding-the-custom-script","title":"Adding the custom script","text":"<ol> <li>To add or update custom scripts, you can use either jans-cli or curl. jans-cli in interactive mode, option 13 enables you manage custom scripts. For more info, see the docs.</li> <li>jans-cli in command-line argument mode is more conducive to scripting and automation. To display the available operations for custom scripts, use config-cli.py --info CustomScripts. See the docs for more info.</li> <li>To use <code>curl</code> see these docs</li> </ol> <p>Note</p> <p>You can normally find <code>jans-cli.py</code> in the <code>/opt/jans/jans-cli/</code> folder.</p>"},{"location":"script-catalog/client_registration/OpenBanking/client-registration/#configuring-keys-certificates-and-ssa-validation-endpoints","title":"Configuring keys, certificates and SSA validation endpoints","text":"<p>The client registration custom script will use configuration parameters like SSA Validation endpoint, JWKS endpoints, keystores, trust stores etc which are listed in the tabular format below.</p> Property Description Example clientScopes Used in SSA validation ASPSPReadAccess AuthoritiesReadAccess TPPReadAccess keyId Used in SSA Validation, kid used while encoding a JWT sent to token URL XkwIzWy44xWSlcWnMiEc8iq9s2G signingCert Used in SSA Validation, location of cert used for signing /etc/certs/obieDir/obsigning-axV5umCvTMBMjPwjFQgEvb_NO_UPLOAD.key signingKey Used in SSA Validation, location of key used for signing /etc/certs/obieDir/obsigning-axV5umCvTMBMjPwjFQgEvb_NO_UPLOAD.key trustKeyStore Used in SSA Validation, Trust store /etc/certs/obieDir/ob_transport_root.p12 trustKeyStorePassword Used in SSA Validation, Trust store Password, currently plaintext, but should be encrypted abcdefg transportKeyStore Used in SSA validation, a .p12 file presented by AS to the token URL /etc/certs/obieDir/axv5umcvtmbmjpwjfqgevb_openbanking_pre_production_issuing_ca_.p12 transportKeyStorePassword Used in SSA validation abcdefg tokenUrl Used in SSA validation to obtain token to query SCIM endpoint. Details here - https://openbanking.atlassian.net/wiki/spaces/DZ/pages/1150124033/Directory+2.0+Technical+Overview+v1.5#Directory2.0TechnicalOverviewv1.5-ManageDirectoryInformation https://matls-sso.openbankingtest.org.uk/as/token.oauth2 tppUrl Used in SSA validation to query SCIM endpoint. Details here - https://openbanking.atlassian.net/wiki/spaces/DZ/pages/1150124033/Directory+2.0+Technical+Overview+v1.5#Directory2.0TechnicalOverviewv1.5-ManageDirectoryInformation https://matls-api.openbankingtest.org.uk/scim/v2/OBThirdPartyProviders/ jwks_endpoint Used for signing software statement and request object for DCR https://keystore.openbankingtest.org.uk/keystore/openbanking.jwks <p>Steps to add / edit / delete configuration parameters:</p> <ol> <li> <p>Place a JSON file containing the above configuration parameters and the custom script in a folder. </p> </li> <li> <p>From this folder, run the following command: </p> <pre><code>python3 jans-cli-linux-amd64.pyz --operation-id post-config-scripts --data /clientregistration.json \\\n--cert-file jans_cli_client.crt --key-file jans_cli_client.key\n</code></pre> </li> </ol>"},{"location":"script-catalog/client_registration/OpenBanking/client-registration/#adding-jose4j-library-in-classpath","title":"Adding Jose4j library in classpath","text":"<p>This script uses jose4j library for JavaScript object signing and encryption.</p> <p>If using the VM distribution:</p> <ol> <li> <p>Download the <code>jose4j-0.7.7.jar</code> and  Place  in <code>/opt/jans/jetty/jans-auth/custom/libs/</code></p> </li> <li> <p>Change your current working directory to <code>/opt/jans/jetty/jans-auth/webapps</code> and edit <code>jans-auth.xml</code> to add this line:  </p> <pre><code>&lt;Set name=\"extraClasspath\"&gt;/opt/jans/jetty/jans-auth/custom/libs/jose4j-0.7.7.jar&lt;/Set&gt;\n</code></pre> </li> <li> <p>Restart the Auth Server, <code>systemctl restart jans-auth</code> </p> </li> </ol> <p>If using the cloud-native distribution:</p> <ol> <li> <p>Download the <code>jose4j-0.7.7.jar</code></p> </li> <li> <p>Create a <code>ConfigMap</code> containing the jar.</p> <pre><code>kubectl create cm jose4j -n &lt;gluu-namespace&gt; --from-file=jose4j-0.7.7.jar\n</code></pre> </li> <li> <p>Add the volume and volume mount to <code>auth-server</code> in your <code>override.yaml</code> helm configuration.</p> <pre><code>volumes:\n    - name: jose4j\n      configMap:\n        name: jose4j\nvolumeMounts:\n    - name: jose4j\n      mountPath: \"/opt/jans/jetty/jans-auth/custom/libs/jose4j-0.7.7.jar\"\n        subPath: jose4j-0.7.7.jar\n</code></pre> </li> <li> <p>Run helm upgrade.</p> <pre><code>helm upgrade gluu gluu/gluu -n &lt;gluu-namespace&gt; --version=5.0.0 -f override.yaml\n</code></pre> </li> </ol>"},{"location":"script-catalog/client_registration/OpenBanking/client-registration/#understanding-the-script","title":"Understanding the Script","text":"<p>The Client Registration script is available at the link above.</p> <p>The following are the mandatory functions which need to be implemented in order to perform registration:</p> <ol> <li> <p>Create a class of the type <code>ClientRegistrationType</code> and initialize the script</p> <pre><code>class ClientRegistration(ClientRegistrationType):\n\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Client registration. Initialization\"\n\n        if (not configurationAttributes.containsKey(\"param\")):\n       print \"Client registration. Initialization. Property keyId is not specified\"\n       return False\n        else: \n           self.param = configurationAttributes.get(\"param\").getValue2() \n\n        print \"Client registration. Initialized successfully\"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"Client registration. Destroy\"\n        print \"Client registration. Destroyed successfully\"\n        return True\n</code></pre> </li> <li> <p>The createClient method contains the main business logic, here the context refers to io.jans.as.server.service.external.context.DynamicClientRegistrationContext. It has several useful methods for SSA validations and options to create and throw custom exception (http status, error and error description):</p> <pre><code>def createClient(self, context):\n\n    # 1. obtain client id. certProperty contains the httpRequest.getHeader(\"X-ClientCert\"), inshort client certificate passed to the /register endpoint\n    cert = CertUtils.x509CertificateFromPem(configurationAttributes.get(\"certProperty\").getValue1())\n    cn = CertUtils.getCN(cert)\n\n    # 2. validate SSA \n    valid = self.validateSoftwareStatement(cn)\n    if valid == False:\n         print \"Invalid software statement\"\n         return False\n    print \"Client registration. cn: \" + cn\n    client.setDn(\"inum=\" + cn + \",ou=clients,o=jans\")\n\n    # 3. Used to indicate that only this is a trusted client (note that consent is managed by Internal OP / consent app)\n    client.setTrustedClient(True)\n    client.setPersistClientAuthorizations(False)\n\n    # 4. in order to run introspection script, assign it to run for this client\n    client.setAccessTokenAsJwt(True)\n    client.getAttributes().setRunIntrospectionScriptBeforeJwtCreation(True)  \n    dnOfIntrospectionScript = \"inum=CABA-2222,ou=scripts,o=jans\"\n    client.getAttributes().getIntrospectionScripts().add(dnOfIntrospectionScript)\n\n    # 5. mandatory fields which should be set in the script\n    client.setClientId(cn)\n    client.setJwksUri(Jwt.parse(registerRequest.getSoftwareStatement()).getClaims().getClaimAsString(\"org_jwks_endpoint\"))\n\n    return True \n</code></pre> </li> <li> <p>Miscellaneous mandatory functions</p> </li> </ol> <p>Used for signing the software statement:</p> <pre><code>def getSoftwareStatementJwks(self, context):\n    return JwtUtil.getJSONWebKeys(self.jwks_endpoint).toString()\n</code></pre> <p>HMAC not applicable, return an empty string:  </p> <pre><code>def getDcrHmacSecret(self, context):\n    return \"\"\n</code></pre> <p>Used for signing the request object (DCR): </p> <pre><code>def getDcrJwks(self, context):\n    return JwtUtil.getJSONWebKeys(self.jwks_endpoint).toString()\n</code></pre> <ol> <li> <p>An important method of DCR flow to update the client details </p> </li> <li> <p>The updateClient method</p> </li> </ol> <p>This updateClient method is called when the PUT method is called on registration endpoint to update client details. This method should return True for successful update and to reject any update request this method should return False when the request fulfills the condition to reject it:</p> <pre><code>def   updateClient(self, context):\n     print \"Client registration. UpdateClient method\"\n     return True\n</code></pre>"},{"location":"script-catalog/config_api/config-api/","title":"Config Api interception Script","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/config_api/config-api/#interface","title":"Interface","text":"<p>The Config Api Interception script implements the ConfigApiType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/config_api/config-api/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/config_api/config-api/#new-methods","title":"New methods","text":"Method header Method description <code>authorize(self, responseAsJsonObject, context)</code> responseAsJsonObject - is <code>org.codehaus.jettison.json.JSONObject</code>, you can use any method to manipulate <code>json</code>. context is reference of <code>io.jans.as.service.external.context.ExternalIntrospectionContext</code> (in https://github.com/JanssenFederation/oxauth project,)","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/config_api/config-api/#sample-script-which-demonstrates-basic-client-authentication","title":"Sample script which demonstrates basic client authentication","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/config_api/config-api/#script-type-python","title":"Script Type: Python","text":"<pre><code># oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2018, Janssen\n#\n# Author: Puja Sharma\n#\n#\n\nfrom io.jans.as.model.jwt import Jwt\nfrom io.jans.as.model.crypto import AuthCryptoProvider\nfrom io.jans.model.custom.script.conf import CustomScriptConfiguration\nfrom io.jans.model.custom.script.type.configapi import ConfigApiType\nfrom io.jans.orm import PersistenceEntryManager\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.util import StringHelper, ArrayHelper\nfrom io.jans.configapi.model.configuration import ApiAppConfiguration\n\nfrom org.json import JSONObject\nfrom java.lang import String\nfrom jakarta.servlet.http import HttpServletRequest\nfrom jakarta.servlet.http import HttpServletResponse\n\n\nclass ConfigApiAuthorization(ConfigApiType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, configurationAttributes):\n        print \"ConfigApiType script. Initializing ...\"\n        print \"ConfigApiType script. Initialized successfully\"\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"ConfigApiType script. Destroying ...\"\n        print \"ConfigApiType script. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 1\n\n\n    # Returns boolean true or false depending on the process, if the client is authorized\n    # or not.\n    # This method is called after introspection response is ready. This method can modify introspection response.\n    # Note :\n    # responseAsJsonObject - is org.codehaus.jettison.json.JSONObject, you can use any method to manipulate json\n    # context is reference of io.jans.as.service.external.context.ExternalIntrospectionContext (in https://github.com/JanssenFederation/oxauth project, )\n    def authorize(self, responseAsJsonObject, context):\n        print \" responseAsJsonObject: %s\" % responseAsJsonObject\n        print \" context: %s\" % context\n\n        print \"Config Authentication process\"\n        request = context.httpRequest\n        response = context.httpResponse\n        print \" request = : %s\" % request\n        print \" response = : %s\" % response\n\n        appConfiguration = context.getApiAppConfiguration()\n        customScriptConfiguration = context.getScript()\n        issuer = context.getRequestParameters().get(\"ISSUER\")\n        token =  context.getRequestParameters().get(\"TOKEN\")\n        method = context.getRequestParameters().get(\"METHOD\")\n        path = context.getRequestParameters().get(\"PATH\")\n\n        print \" requese2: %s\" % request\n        print \" response2 new: %s\" % response\n        print \"ConfigApiType.appConfiguration: %s\" % appConfiguration\n        print \"ConfigApiType.customScriptConfiguration: %s\" % customScriptConfiguration\n        print \"ConfigApiType.issuer: %s\" % issuer\n        print \"ConfigApiType.token: %s\" % token\n        print \"ConfigApiType.method: %s\" % method\n        print \"ConfigApiType.path: %s\" % path\n\n        #Example to validate method\n        if (\"GET\" == StringHelper.toUpperCase(method) ):\n          print \"Validate method: %s\" % method\n\n        if (\"attributes\" == StringHelper.toLowerCase(path) ):\n          print \"ConfigApiType.path: %s\" % path\n\n        responseAsJsonObject.accumulate(\"key_from_script\", \"value_from_script\")\n        print \" final responseAsJsonObject: %s\" % responseAsJsonObject\n\n        return True\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/config_api/config-api/#sample-scripts","title":"Sample Scripts","text":"<p>ConfigApiInterception</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/consent_gathering/consent-gathering/","title":"Consent Gathering","text":"<p>OAuth 2.0 allows providers to prompt users for consent before releasing their personal information to a client (application). The standard consent process is binary: approve or deny. Using the consent gathering interception script, the consent flow can be customized to meet unique business requirements, for instance to support payment authorization, where you need to present transactional information, or where you need to step-up authentication to add security.</p>","tags":["administration","developer","script-catalog","consent"]},{"location":"script-catalog/consent_gathering/consent-gathering/#script-identification-during-execution","title":"Script identification during execution","text":"<p>Consent script is executed during authorization step. AS identifies consent gathering script to invoke in following order: - if <code>consentGatheringScriptBackwardCompatibility</code> is <code>true</code> (<code>false</code> by default) - invoke first consent gathering script found in database. - if <code>acrToConsentScriptNameMapping</code> has mapping, try to find consent script by that mapping and invoke it. - if client has <code>consentGatheringScripts</code> that points to valid consent script, invoke it. - if nothing from above worked try to invoke first script found in database </p> <p><code>acrToConsentScriptNameMapping</code> is simple acr to consent script mapping <pre><code>acr1 - consentScript1\nacr2 - consentScript2\n..\nacrN - consentScriptN\n</code></pre></p>","tags":["administration","developer","script-catalog","consent"]},{"location":"script-catalog/consent_gathering/consent-gathering/#interface","title":"Interface","text":"<p>The consent gathering script implements the ConsentGathering interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog","consent"]},{"location":"script-catalog/consent_gathering/consent-gathering/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog","consent"]},{"location":"script-catalog/consent_gathering/consent-gathering/#new-methods","title":"New Methods","text":"Method header Method description <code>def authorize(self, step, consentContext)</code> Main consent-gather method. Must return True (if consent gathered successfully) or False (if failed). <code>def getNextStep(self, step, context)</code> <code>def getStepsCount(self, context)</code> Return total number of consent gathering steps <code>def getPageForStep(self, step, context)</code> Returns the consent page corresponding to the current step of consent gathering","tags":["administration","developer","script-catalog","consent"]},{"location":"script-catalog/consent_gathering/consent-gathering/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>SimpleCustomProperty</code> Map of configuration properties. Reference <code>context</code> Reference","tags":["administration","developer","script-catalog","consent"]},{"location":"script-catalog/consent_gathering/consent-gathering/#use-case-dummy-consent-gathering-form","title":"Use case: Dummy Consent Gathering Form","text":"<p>This script has been adapted from the Gluu Server sample consent gathering script.</p>","tags":["administration","developer","script-catalog","consent"]},{"location":"script-catalog/consent_gathering/consent-gathering/#script-type-python","title":"Script Type: Python","text":"<pre><code># oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2017, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.server.security import Identity\nfrom io.jans.model.custom.script.type.authz import ConsentGatheringType\nfrom io.jans.util import StringHelper\n\nimport java\nimport random\n\nclass ConsentGathering(ConsentGatheringType):\n\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Consent-Gathering. Initializing ...\"\n        print \"Consent-Gathering. Initialized successfully\"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"Consent-Gathering. Destroying ...\"\n        print \"Consent-Gathering. Destroyed successfully\"\n\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Main consent-gather method. Must return True (if gathering performed successfully) or False (if fail).\n    # All user entered values can be access via Map&lt;String, String&gt; context.getPageAttributes()\n    def authorize(self, step, context): # context is reference of io.jans.as.service.external.context.ConsentGatheringContext\n        print \"Consent-Gathering. Authorizing...\"\n\n        if step == 1:\n            allowButton = context.getRequestParameters().get(\"authorizeForm:allowButton\")\n            if (allowButton != None) and (len(allowButton) &gt; 0):\n                print \"Consent-Gathering. Authorization success for step 1\"\n                return True\n\n            print \"Consent-Gathering. Authorization declined for step 1\"\n        elif step == 2:\n            allowButton = context.getRequestParameters().get(\"authorizeForm:allowButton\")\n            if (allowButton != None) and (len(allowButton) &gt; 0):\n                print \"Consent-Gathering. Authorization success for step 2\"\n                return True\n\n            print \"Consent-Gathering. Authorization declined for step 2\"\n\n        return False\n\n    def getNextStep(self, step, context):\n        return -1\n\n    def prepareForStep(self, step, context):\n        if not context.isAuthenticated():\n            print \"User is not authenticated. Aborting authorization flow ...\"\n            return False\n\n        if step == 2:\n            pageAttributes = context.getPageAttributes()\n\n            # Generate random consent gathering request\n            consentRequest = \"Requested transaction #%s approval for the amount of sum $ %s.00\" % ( random.randint(100000, 1000000), random.randint(1, 100) )\n            pageAttributes.put(\"consent_request\", consentRequest)\n            return True\n\n        return True\n\n    def getStepsCount(self, context):\n        return 2\n\n    def getPageForStep(self, step, context):\n        if step == 1:\n            return \"/authz/authorize.xhtml\"\n        elif step == 2:\n            return \"/authz/transaction.xhtml\"\n\n        return \"\"\n</code></pre>","tags":["administration","developer","script-catalog","consent"]},{"location":"script-catalog/consent_gathering/consent-gathering/#script-type-java","title":"Script Type: Java","text":"<pre><code>import io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.authz.ConsentGatheringType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport io.jans.as.server.service.external.context.ConsentGatheringContext;\n\nimport java.util.Map;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\npublic class ConsentGathering implements ConsentGatheringType {\n\n    private static final Logger log = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Consent gathering. Initializing...\");\n        log.info(\"Consent gathering. Initialized\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Consent gathering. Initializing...\");\n        log.info(\"Consent gathering. Initialized\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Consent gathering. Destroying...\");\n        log.info(\"Consent gathering. Destroyed.\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n\n    @Override\n    public boolean authorize(int step, Object consentContext) {\n        log.info(\"Consent gathering. Authorizing...\");\n        ConsentGatheringContext gatheringContext = (ConsentGatheringContext) consentContext;\n        String[] allowButton = gatheringContext.getRequestParameters().get(\"authorizeForm:allowButton\");\n        if (step == 1) {\n            if (allowButton != null &amp;&amp; allowButton.length &gt; 0) {\n                log.info(\"Consent gathering. Authorization success for step 1\");\n                return true;\n            }\n            log.info(\"Consent gathering. Authorization declined for step 1\");\n        }\n        else if (step == 2) {\n            if (allowButton != null &amp;&amp; allowButton.length &gt; 0) {\n                log.info(\"Consent gathering. Authorization success for step 2\");\n                return true;\n            }\n            log.info(\"Consent gathering. Authorization declined for step 2\");\n        }\n        return false;\n    }\n\n    @Override\n    public int getNextStep(int step, Object consentContext) {\n        return -1;\n    }\n\n    @Override\n    public boolean prepareForStep(int step, Object consentContext) {\n        ConsentGatheringContext gatheringContext = (ConsentGatheringContext) consentContext;\n        if (!gatheringContext.isAuthenticated()) {\n            log.info(\"User is not authenticated. Aborting authorization flow...\");\n            return false;\n        }\n        if(step == 2) {\n            Map&lt;String, String&gt; pageAttributes = gatheringContext.getPageAttributes();\n\n            String consentRequest = \"This is a random consent request\";\n            pageAttributes.put(\"consent_request\", consentRequest);\n            return true;\n        }\n        return false;\n    }\n\n    @Override\n    public int getStepsCount(Object consentContext) {\n        return 2;\n    }\n\n    @Override\n    public String getPageForStep(int step, Object consentContext) {\n        if(step == 1) {\n            return \"/authz/authorize.xhtml\";\n        } else if (step == 2) {\n            return \"/authz/transaction.xhtml\";\n        }\n        return \"\";\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog","consent"]},{"location":"script-catalog/consent_gathering/consent-gathering/#writing-consent-flows-using-agama","title":"Writing consent flows using Agama","text":"<p>Besides scripts, developers can also use Agama for writing consent flows. For this, enable the custom script named <code>agama_consent</code> and update the authentication server configuration accordingly using  <code>acrToConsentScriptNameMapping</code> and <code>acrToAgamaConsentFlowMapping</code> properties. Suppose the below configuration:</p> <pre><code>\"consentGatheringScriptBackwardCompatibility\": false,\n\"acrToConsentScriptNameMapping\": {\n   \"basic\": \"consent_gathering\",\n   \"otp\": \"agama_consent\",\n   \"agama_co.acme.myflow\": \"my_consent_gathering\",\n   \"agama_co.acme.mysuperflow\": \"agama_consent\"\n},\n\"acrToAgamaConsentFlowMapping\": {\n   \"otp\": \"io.jans.consent.A\",\n   \"agama_co.acme.mysuperflow\": \"io.jans.consent.B\",\n}\n</code></pre> <p>This is how consent will work depending on the authentication request issued:</p> <ul> <li>With <code>acr_values=basic</code>, the consent script named <code>consent_gathering</code> will be executed - as long as it is already enabled, of course. This is the default Consent script bundled with the server</li> <li>With <code>acr_values=otp</code>, the Agama flow <code>io.jans.consent.A</code> will be launched for consent</li> <li>With <code>acr_values=agama_co.acme.myflow</code>, the consent script named <code>my_consent_gathering</code> will be executed - assuming it exists and is enabled</li> <li>With <code>agama_co.acme.mysuperflow</code>, the Agama flow <code>io.jans.consent.B</code> will be launched for consent</li> </ul> <p>Agama flows used for consent can be built using the same approach and tooling used for regular authentication flows. Note however there is no need to pass a user identity in the <code>Finish</code> instruction. If passed, it will be ignored, thus, it suffices to end a consent flow with <code>Finish false/true</code>.</p>","tags":["administration","developer","script-catalog","consent"]},{"location":"script-catalog/consent_gathering/consent-gathering/#getting-contextual-data","title":"Getting contextual data","text":"<p>To access information in your Agama consent flow related to the user attempting login, scopes requested, etc., get an instance of managed bean <code>io.jans.as.server.util.AgamaConsentUtil</code> and use the available methods as summarized below:</p> Method Description Reference class <code>getClient</code> Gets a reference to the OAuth client associated to the authentication request Client <code>getScopes</code> A list of OAuth scopes requested Scope <code>getUser</code> A reference to the user attempting authentication User / SimpleUser <code>getSessionAttributes</code> A map containing the parameters of the OAuth authentication request issued <p>Java example code:</p> <pre><code>import io.jans.as.server.util.AgamaConsentUtil;\nimport io.jans.service.cdi.util.CdiUtil;\n...\nAgamaConsentUtil acu = CdiUtil.bean(AgamaConsentUtil.class);\nString name = acu.getClient().getClientName(); //retrieves the client's display name\n</code></pre> <p>Agama DSL example:</p> <pre><code>acuCls = Call io.jans.as.server.util.AgamaConsentUtil#class\nacu = Call io.jans.service.cdi.util.CdiUtil#bean acuCls\nname = acu.client.clientName        //retrieves the client's display name\n</code></pre>","tags":["administration","developer","script-catalog","consent"]},{"location":"script-catalog/cookie/cookie/","title":"Cookie Script","text":"<p>This script is used to modify the \"Set-Cookie\" cookie header value. Any cookie created by AS can be modified by using this custom script.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/cookie/cookie/#interface","title":"Interface","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/cookie/cookie/#methods","title":"Methods","text":"<p>The cookie interception script extends the base script type with the <code>init</code>, <code>destroy</code> and <code>getApiVersion</code> methods:</p> Inherited Methods Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10 <p>The <code>configurationAttributes</code> parameter is <code>java.util.Map&lt;String, SimpleCustomProperty&gt;</code>.</p> <p>The cookie interception script also adds the following method(s):</p> Method <code>def modifyCookieHeader(self, cookieName, cookieHeader)</code> Method Paramater <code>cookieName</code> is <code>String</code> <code>cookieHeader</code> is <code>String</code> representing header value (e.g. <code>sessionId=abc123; Expires=Wed, 09 Jun 2021 10:18:14 GMT</code>)","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/cookie/cookie/#common-use-case","title":"Common Use Case","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/cookie/cookie/#script-type-java","title":"Script Type: Java","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/cookie/cookie/#addmodify-cookie-value-attribute","title":"Add/Modify cookie value attribute","text":"<pre><code>/* Copyright (c) 2025, Gluu\n */\n\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.cookie.CookieType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\n\n/**\n * @author Yuriy Z\n */\npublic class Cookie implements CookieType {\n\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    @Override\n    public String modifyCookieHeader(String cookieName, String cookieHeader) {\n\n        // append \"Secure\" attribute to session_id cookie if it's not present yet\n        if (cookieName.equals(\"session_id\") &amp;&amp; !cookieHeader.contains(\"Secure\")) {\n            cookieHeader = cookieHeader + \"; Secure\";\n        }\n\n        return cookieHeader;\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Cookie Java script. Initialized successfully\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Cookie Java script. Initialized successfully\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Cookie Java script. Destroyed successfully\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/create_user/create-user/","title":"Create User Custom Script","text":"<p>\"CreateUser\" custom script is used when Authorization Endpoint is called with <code>prompt=create</code> parameter. In this case AS shows user registration form instead of authn/authz UI. \"CreateUser\" custom script allows inject/modify user registration process.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/create_user/create-user/#behavior","title":"Behavior","text":"<p>When AS receives request on Authorization Endpoint with <code>prompt=create</code> it redirect to user creation page.</p> <p>Example of initial request (line breaks are for display purpose only) <pre><code>https://sample.as.com/jans-auth/restv1/authorize?\n    response_type=code+token&amp;\n    client_id=9999&amp;\n    scope=openid+profile&amp;\n    redirect_uri=https://cb.example.com&amp;\n    state=0ba6bba8-d2a4-44e6-8192-57012e41d506&amp;\n    nonce=963ecc9f-b1d8-4bb0-a0b5-d53be34e7e4e&amp;\n    acr_values=simple_password_auth\n    &amp;prompt=create\n</code></pre></p> <p>Sample redirect to user creation page (line breaks are for display purpose only) <pre><code>https://sample.as.com/jans-auth/createUser.htm?\n    scope=openid+profile&amp;\n    acr_values=simple_password_auth&amp;\n    response_type=code+token&amp;\n    redirect_uri=https%3A%2F%2Fcb.example.com&amp;\n    state=0ba6bba8-d2a4-44e6-8192-57012e41d506&amp;\n    nonce=963ecc9f-b1d8-4bb0-a0b5-d53be34e7e4e&amp;\n    client_id=9999\n</code></pre></p> <p>It's possible to redirect to custom page instead of built-in <code>/createUser.htm</code>. For this use <code>getCreateUserPage</code> method.</p> <pre><code>    public String getCreateUserPage(Object context) {\n        return \"/customCreateUser\";\n    }\n</code></pre> <p>Once user is redirected, it enters all details and hits action button. At this point <code>prepare</code> method is called. It can be used to make preparetions needed for business logic. <code>prepare</code> method must return <code>true</code>. If <code>false</code> is returned, AS will show error and user registration will be interrupted.</p> <pre><code>    public boolean prepare(Object context) {\n        // make some preparations\n        return true;\n    }\n</code></pre> <p>If <code>prepare</code> method returned <code>true</code>, then <code>createUser</code> method is called. It can be used to prepare <code>user</code> object for persistence.</p> <pre><code>    public boolean createUser(Object context) {\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n        final User user = scriptContext.getExecutionContext().getUser();\n        final Map&lt;String, String[]&gt; parameterMap = scriptContext.getExecutionContext().getHttpRequest().getParameterMap();\n        return true;\n    }\n</code></pre> <p><code>createUser</code> method must return <code>true</code> to proceed with persistence. If <code>false</code> is returned, new user is not created. Process is interrupted.</p> <p>After successful user creation, user-agent is redirect to Authorization Endpoint which is same url as original request except <code>prompt=create</code> in it. Redirect url to Authorization Endpoint after user creation can be customized with <code>buildPostAuthorizeUrl</code> method.</p> <pre><code>    public String buildPostAuthorizeUrl(Object context) {\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n        final User user = scriptContext.getExecutionContext().getUser();\n        final HttpServletRequest httpRequest = scriptContext.getExecutionContext().getHttpRequest();\n        final Map&lt;String, String[]&gt; requestParameters = httpRequest.getParameterMap();\n\n        final Map&lt;String, String&gt; parameters = new HashMap&lt;&gt;();\n        // construct/fill parameters here\n\n        try {\n            RequestParameterService requestParameterService = CdiUtil.bean(RequestParameterService.class);\n            return httpRequest.getContextPath() + \"/restv1/authorize?\" + requestParameterService.parametersAsString(parameters);\n        } catch (Exception e) {\n            scriptLogger.error(\"Failed to build post authorization url.\", e);\n            return null;\n        }\n    }\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/create_user/create-user/#interface","title":"Interface","text":"<p>The CreateUser script implements the CreateUserType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/create_user/create-user/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/create_user/create-user/#new-methods","title":"New methods","text":"Method header Method description <code>def getCreateUserPage(self, context)</code> Called when the prompt=create authorization request is send and AS figuring out the right page to land the end-user <code>def prepare(self, context)</code> Called when the form is filled and user hit submit button <code>def createUser(self, context)</code> Called right before user object persistence which allows to modify user object <code>def buildPostAuthorizeUrl(self, context)</code> Called after user persistence and construct authorization url to redirect end-user to","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/create_user/create-user/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>context</code> Reference","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/create_user/create-user/#saample-scrip-in-java","title":"Saample Scrip in Java","text":"<pre><code>import io.jans.as.common.model.common.User;\nimport io.jans.as.server.service.RequestParameterService;\nimport io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.createuser.CreateUserType;\nimport io.jans.service.cdi.util.CdiUtil;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport jakarta.servlet.http.HttpServletRequest;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.HashMap;\nimport java.util.Map;\n\n/**\n * Sample custom script for user creation on prompt=create\n *\n * @author Yuriy Z\n */\npublic class CreateUser implements CreateUserType {\n\n    private static final Logger log = LoggerFactory.getLogger(CreateUser.class);\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    /**\n     * Returns custom page for user creation\n     *\n     * @param context ExternalScriptContext, see https://github.com/JanssenProject/jans/blob/main/jans-auth-server/server/src/main/java/io/jans/as/server/service/external/context/ExternalScriptContext.java\n     * @return custom page\n     */\n    @Override\n    public String getCreateUserPage(Object context) {\n        return \"/customCreateUser\";\n    }\n\n    /**\n     * Preparetion of user create action (called right before page is shown)\n     *\n     * @param context ExternalScriptContext, see https://github.com/JanssenProject/jans/blob/main/jans-auth-server/server/src/main/java/io/jans/as/server/service/external/context/ExternalScriptContext.java\n     * @return whether preparetion is successful or not. If \"false\" is returned then error is shown.\n     */\n    @Override\n    public boolean prepare(Object context) {\n        // make some preparations\n        return true;\n    }\n\n    /**\n     * Method is called before user creation (persistence to DB).\n     * \"context.getExecutionContext().getUser()\" allows to access and modify user object that\n     * will be persisted.\n     *\n     * @param context ExternalScriptContext, see https://github.com/JanssenProject/jans/blob/main/jans-auth-server/server/src/main/java/io/jans/as/server/service/external/context/ExternalScriptContext.java\n     * @return whether user is created successfully. If \"false\" is returned, user creation is interrupted.\n     */\n    @Override\n    public boolean createUser(Object context) {\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n        final User user = scriptContext.getExecutionContext().getUser();\n        final Map&lt;String, String[]&gt; parameterMap = scriptContext.getExecutionContext().getHttpRequest().getParameterMap();\n        return true;\n    }\n\n    /**\n     * Returns post authorization url. After user is created, user-agent is redirected to Authorization Endpoint. Here it can be customized/modified.\n     *\n     * @param context ExternalScriptContext, see https://github.com/JanssenProject/jans/blob/main/jans-auth-server/server/src/main/java/io/jans/as/server/service/external/context/ExternalScriptContext.java\n     * @return authorization url\n     */\n    @Override\n    public String buildPostAuthorizeUrl(Object context) {\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n        final User user = scriptContext.getExecutionContext().getUser();\n        final HttpServletRequest httpRequest = scriptContext.getExecutionContext().getHttpRequest();\n        final Map&lt;String, String[]&gt; requestParameters = httpRequest.getParameterMap();\n\n        final Map&lt;String, String&gt; parameters = new HashMap&lt;&gt;();\n        // construct/fill parameters here\n\n        try {\n            RequestParameterService requestParameterService = CdiUtil.bean(RequestParameterService.class);\n            return httpRequest.getContextPath() + \"/restv1/authorize?\" + requestParameterService.parametersAsString(parameters);\n        } catch (Exception e) {\n            scriptLogger.error(\"Failed to build post authorization url.\", e);\n            return null;\n        }\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized CreateUser Java custom script.\");\n        return false;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized CreateUser Java custom script.\");\n        return false;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed CreateUser Java custom script.\");\n        return false;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/discovery/discovery/","title":"Discovery Script","text":"<p>This script is used to modify the response of the OpenID well-known discovery endpoint, <code>/.well-known/openid-configuration</code>. The specification for this endpoint is defined in the OpenID Connect documentation.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/discovery/discovery/#interface","title":"Interface","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/discovery/discovery/#methods","title":"Methods","text":"<p>The discovery interception script extends the base script type with the <code>init</code>, <code>destroy</code> and <code>getApiVersion</code> methods:</p> Inherited Methods Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10 <p>The <code>configurationAttributes</code> parameter is <code>java.util.Map&lt;String, SimpleCustomProperty&gt;</code>.</p> <p>The discovery interception script also adds the following method(s):</p> Method <code>def modifyResponse(self, responseAsJsonObject, context)</code> Method Paramater <code>responseAsJsonObject</code> is <code>org.json.JSONObject</code> <code>context</code> is <code>io.jans.as.server.model.common.ExecutionContext</code>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/discovery/discovery/#objects","title":"Objects","text":"<p>Definitions of all objects used in the script</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/discovery/discovery/#objects_1","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>SimpleCustomProperty</code> Map of configuration properties. Reference <code>context</code> Reference","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/discovery/discovery/#common-use-case","title":"Common Use Case","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/discovery/discovery/#script-type-python","title":"Script Type: Python","text":"<pre><code># Copyright (c) 2022, Janssen Project\n#\n# Author: Gluu\n#    1. Filter out a value\n#    2. Add a value\n#    3. Get ip address of the client making the request\n#\nfrom io.jans.model.custom.script.type.discovery import DiscoveryType\nfrom java.lang import String\n\nclass Discovery(DiscoveryType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Custom Discovery script. Initializing ...\"\n        print \"Custom Discovery script. Initialized successfully\"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"Custom Discovery script. Destroying ...\"\n        print \"Custom Discovery script. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Returns boolean, true - apply Discovery method, false - ignore it.\n    # This method is called after Discovery response is ready. This method can modify Discovery response.\n    # Note :\n    # responseAsJsonObject - is org.json.JSONObject, you can use any method to manipulate json\n    # context is reference of io.jans.as.server.model.common.ExecutionContext (in https://github.com/JanssenProject project, )\n    def modifyResponse(self, responseAsJsonObject, context):\n\n        print \"Custom - Inside modifyResponse method of Discovery script ....\"\n\n        # Add a value to Discovery Response\n        responseAsJsonObject.accumulate(\"key_from_script\", \"value_from_script\")\n\n        # Filter out a value from Discovery Response\n        responseAsJsonObject.remove(\"pushed_authorization_request_endpoint\")\n\n        # Get an IP Address of the Client making the request\n        responseAsJsonObject.accumulate(\"Client IP Address\", context.getHttpRequest().getHeader(\"X-Forwarded-For\"))\n\n        return True\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/discovery/discovery/#script-type-java","title":"Script Type: Java","text":"<pre><code>/* Copyright (c) 2022, Gluu\n Author: Yuriy Z\n */\n\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.discovery.DiscoveryType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.json.JSONObject;\n\nimport java.util.Map;\n\npublic class Discovery implements DiscoveryType {\n\n    private static final Logger log = LoggerFactory.getLogger(Discovery.class);\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Init of Discovery Java custom script\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Init of Discovery Java custom script\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Destroy of Discovery Java custom script\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        log.info(\"getApiVersion Discovery Java custom script: 11\");\n        return 11;\n    }\n\n    @Override\n    public boolean modifyResponse(Object responseAsJsonObject, Object context) {\n        scriptLogger.info(\"write to script logger\");\n        JSONObject response = (JSONObject) responseAsJsonObject;\n        response.accumulate(\"key_from_java\", \"value_from_script_on_java\");\n        return true;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/discovery/discovery/","title":"Discovery Script Guide","text":"<p>The Authorization Server Metadata spec RFC8414 (also known as OAuth Discovery) defines a format for clients to use to look up the information needed to interact with a particular OAuth server. This includes things like:- - finding the authorization endpoint, - listing the supported scopes and client authentication mechanisms.</p> <p>The \"OpenID Connect Discovery 1.0\" defines the metadata in such a way that is compatible with OpenID Connect Discovery while being applicable to a wider set of OAuth 2.0 use cases.</p> <p>This is intentionally parallel to the way that \"OAuth 2.0 Dynamic Client Registration Protocol\" RFC7591 defines the dynamic client registration mechanisms \"OpenID Connect Dynamic Client Registration 1.0 OpenID.Registration so that is compatible with it.</p> <p>The metadata for an authorization server is retrieved from a know location as a JSON object RFC8259 , which defines its endpoint locations and authorization server capabilities.</p> <p>This metadata can be passed either:- - in a self-asserted fashion from the server origin via HTTPS  - or as a set of signed metadata values represented as claims in a JSON Web Token JWT.  </p> <p>In the JWT case, the issuer is vouching for the validity of the data coming from the authorization server.  This is analogous to the role that the Software Statement plays in OAuth Dynamic Client Registration RFC7591.</p> <p>Note: The means by which the client chooses an authorization server is out of scope.  In some cases, the issuer identifier may be manually configured into the client.  In other cases, it may be dynamically discovered, for instance, through the use of WebFinger.</p> <p>Discovery script allows to modify response of OpenID Connect Discovery RFC8414.</p>"},{"location":"script-catalog/discovery/discovery/#methods","title":"Methods","text":"<p>The discovery interception script extends the base script type with the methods -</p> Method Method description <code>def init(self, customScript, configurationAttributes)</code> Inherited Method This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> Inherited Method This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> Inherited Method The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10 <code>def modifyResponse(self, responseAsJsonObject, context)</code> This method is called after discovery response is ready. This method can modify discovery response.<code>responseAsJsonObject</code> is <code>org.codehaus.jettison.json.JSONObject</code> <code>context</code> is <code>io.jans.as.server.model.common.ExecutionContext</code> <p>The <code>configurationAttributes</code> parameter is <code>java.util.Map&lt;String, SimpleCustomProperty&gt;</code>.</p> <pre><code>configurationAttributes = new HashMap&lt;String, SimpleCustomProperty&gt;();\nconfigurationAttributes.put(\"Location Type\", new SimpleCustomProperty(\"location_type\", \"db\", \"Storage Location for the script\"));\n</code></pre>"},{"location":"script-catalog/discovery/discovery/#snippet","title":"Snippet","text":"<pre><code># Returns boolean, true - apply discovery method, false - ignore it.\n# This method is called after discovery response is ready. This method can modify discovery response.\n# Note :\n# responseAsJsonObject - is org.codehaus.jettison.json.JSONObject, you can use any method to manipulate json\n# context is reference of io.jans.as.server.model.common.ExecutionContext (in https://github.com/JanssenProject project)\ndef modifyResponse(self, responseAsJsonObject, context):\n    responseAsJsonObject.accumulate(\"key_from_script\", \"value_from_script\")\n    return True\n</code></pre>"},{"location":"script-catalog/discovery/discovery/#common-use-cases","title":"Common Use Cases","text":""},{"location":"script-catalog/discovery/discovery/#script-type-python","title":"Script Type: Python","text":""},{"location":"script-catalog/discovery/discovery/#add-a-value-client-ip-address-and-filter-out-a-value-from-discovery-response","title":"Add a value (Client IP Address) and Filter out a value from Discovery Response","text":"<p>The sample code snippet shows how to add and filter out a value from Discovery Response.</p>"},{"location":"script-catalog/discovery/discovery/#script-type-java","title":"Script Type: Java","text":""},{"location":"script-catalog/discovery/discovery/#add-a-value-client-ip-address-and-filter-out-a-value-from-discovery-response_1","title":"Add a value (Client IP Address) and Filter out a value from Discovery Response","text":"<p>The sample code snippet shows how to add and filter out a value from Discovery Response.</p>"},{"location":"script-catalog/dynamic_scope/dynamic-scope/","title":"Dynamic Scope","text":"<p>The dynamic scope custom script allows the authorization server to generate a list of claims (and their values) on the fly, depending on circumstances such as the ID of the client requesting it, authenticated user's session parameters, values of other users' attributes, results of some calculations implementing specific business logic and/or requests to remote APIs or databases. Claims are then returned the usual way in a response to a call to the <code>/userinfo</code> endpoint.</p>","tags":["administration","developer","script-catalog","DynamicScope"]},{"location":"script-catalog/dynamic_scope/dynamic-scope/#interface","title":"Interface","text":"<p>The dynamic scope script implements the DynamicScopeType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog","DynamicScope"]},{"location":"script-catalog/dynamic_scope/dynamic-scope/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog","DynamicScope"]},{"location":"script-catalog/dynamic_scope/dynamic-scope/#new-methods","title":"New Methods","text":"Method header Method description <code>def update(self, dynamicScopeContext, configurationAttributes)</code> Main dynamic scope method. Peforms any needed logic, updates JSON Web Token and returns True if dynamic scope was added successfully, false otherwise. <code>def getSupportedClaims(self, configurationAttributes)</code> Returns an array of claims that are allowed to be added by the custom script","tags":["administration","developer","script-catalog","DynamicScope"]},{"location":"script-catalog/dynamic_scope/dynamic-scope/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>SimpleCustomProperty</code> Map of configuration properties. Reference <code>dynamicScopeContext</code> Reference","tags":["administration","developer","script-catalog","DynamicScope"]},{"location":"script-catalog/dynamic_scope/dynamic-scope/#use-case-add-dynamic-scope-with-the-org_name-claim","title":"Use case: Add dynamic scope with the <code>org_name</code> claim","text":"<p>This script has been adapted from the Gluu Server sample dynamic scope script</p>","tags":["administration","developer","script-catalog","DynamicScope"]},{"location":"script-catalog/dynamic_scope/dynamic-scope/#script-type-python","title":"Script Type: Python","text":"<pre><code># oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.model.custom.script.type.scope import DynamicScopeType\nfrom io.jans.as.server.service import UserService\nfrom io.jans.util import StringHelper, ArrayHelper\nfrom java.util import Arrays, ArrayList\n\nimport java\n\nclass DynamicScope(DynamicScopeType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Dynamic scope. Initialization\"\n\n        print \"Dynamic scope. Initialized successfully\"\n\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print \"Dynamic scope. Destroy\"\n        print \"Dynamic scope. Destroyed successfully\"\n        return True   \n\n    # Update Json Web token before signing/encrypring it\n    #   dynamicScopeContext is io.jans.as.service.external.context.DynamicScopeExternalContext\n    #   configurationAttributes is java.util.Map&lt;String, SimpleCustomProperty&gt;\n    def update(self, dynamicScopeContext, configurationAttributes):\n        print \"Dynamic scope. Update method\"\n\n        dynamicScopes = dynamicScopeContext.getDynamicScopes()\n        authorizationGrant = dynamicScopeContext.getAuthorizationGrant()\n        user = dynamicScopeContext.getUser()\n        jsonWebResponse = dynamicScopeContext.getJsonWebResponse()\n        claims = jsonWebResponse.getClaims()\n\n        # Add organization name if there is scope = org_name\n        claims.setClaim(\"org_name\", \"Janssen, Inc.\")\n\n        return True\n\n    def getSupportedClaims(self, configurationAttributes):\n        return Arrays.asList(\"org_name\")\n\n    def getApiVersion(self):\n        return 11\n</code></pre>","tags":["administration","developer","script-catalog","DynamicScope"]},{"location":"script-catalog/dynamic_scope/dynamic-scope/#script-type-java","title":"Script Type: Java","text":"<pre><code>import java.util.List;\nimport java.util.Map;\nimport java.util.Arrays;\nimport java.util.ArrayList;\n\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport io.jans.model.custom.script.type.scope.DynamicScopeType;\nimport io.jans.as.server.service.external.context.DynamicScopeExternalContext;\nimport io.jans.as.model.token.JsonWebResponse;\nimport io.jans.as.model.jwt.JwtClaims;\nimport io.jans.util.StringHelper;\n\n\n\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\npublic class DynamicScope implements DynamicScopeType {\n\n  private static final Logger log = LoggerFactory.getLogger(DynamicScope.class);\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n      log.info(\"Dynamic Scope. Initializing...\");\n      log.info(\"Dynamic Scope. Initialized\");\n      return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Dynamic Scope. Initializing...\");\n        log.info(\"Dynamic Scope. Initialized\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Dynamic Scope. Destroying...\");\n        log.info(\"Dynamic Scope. Destroyed.\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n\n    @Override\n    public boolean update(Object dynamicScopeContext, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Dynamic Scope. Updating...\");\n        DynamicScopeExternalContext dynamicContext = (DynamicScopeExternalContext) dynamicScopeContext;\n        ArrayList&lt;String&gt; dynamicScopes = (ArrayList&lt;String&gt;) dynamicContext.getDynamicScopes();\n        JsonWebResponse jwt = dynamicContext.getJsonWebResponse();\n        JwtClaims claims = jwt.getClaims();\n\n        log.info(\"Dynamic Scope. Dynamic scopes: \" + dynamicScopes.toString());\n        for (String dynamicScope : dynamicScopes) {\n            if (StringHelper.equalsIgnoreCase(dynamicScope, \"org_name\")) {\n                claims.setClaim(\"org_name\", \"Test Value\");\n                continue;\n            }\n        }\n\n\n        return true;\n    }\n\n    @Override\n    public List&lt;String&gt; getSupportedClaims(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        return Arrays.asList(\"org_name\");\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog","DynamicScope"]},{"location":"script-catalog/dynamic_scope/dynamic-scope/#sample-scripts","title":"Sample Scripts","text":"<ul> <li>Dynamic Permission</li> <li>MemberOf Attribute</li> <li>Organization Name</li> <li>Session Parameter</li> <li>Work Phone</li> </ul>","tags":["administration","developer","script-catalog","DynamicScope"]},{"location":"script-catalog/end_session/end-session/","title":"End Session","text":"<p>End Session scripts allows the administrator to modify HTML response for OpenID Connect Frontchannel logout (spec).</p>","tags":["administration","developer","script-catalog","EndSession"]},{"location":"script-catalog/end_session/end-session/#interface","title":"Interface","text":"<p>The end session script implements the EndSessionType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog","EndSession"]},{"location":"script-catalog/end_session/end-session/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog","EndSession"]},{"location":"script-catalog/end_session/end-session/#new-methods","title":"New Methods","text":"Method header Method description <code>def getFrontchannelHtml(self, context)</code> Returns string, it must be valid HTML (with iframes according to specification). This method is called on <code>/end_session</code> after actual session is killed and authorization server constructs HTML to return to RP.","tags":["administration","developer","script-catalog","EndSession"]},{"location":"script-catalog/end_session/end-session/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>context</code> Reference","tags":["administration","developer","script-catalog","EndSession"]},{"location":"script-catalog/end_session/end-session/#use-case-dummy-logout-page","title":"Use case: Dummy Logout Page","text":"<p>This script has been adapted from the Gluu Server sample end session script.</p> <p>Note</p> <p>The example script is a proof of concept, as the <code>getFrontchannelHtml()</code> must return an actual HTML string.</p>","tags":["administration","developer","script-catalog","EndSession"]},{"location":"script-catalog/end_session/end-session/#script-type-python","title":"Script Type: Python","text":"<pre><code># Copyright (c) 2020, Janssen\n#\n# Author: Yuriy Zabrovarnyy\n#\n\nfrom io.jans.model.custom.script.type.logout import EndSessionType\nfrom java.lang import String\n\nclass EndSession(EndSessionType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"EndSession script. Initializing ...\"\n        print \"EndSession script. Initialized successfully\"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"EndSession script. Destroying ...\"\n        print \"EndSession script. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Returns string, it must be valid HTML (with iframes according to spec http://openid.net/specs/openid-connect-frontchannel-1_0.html)\n    # This method is called on `/end_session` after actual session is killed and oxauth construct HTML to return to RP.\n    # Note :\n    # context is reference of io.jans.as.service.external.context.EndSessionContext (in https://github.com/JanssenFederation/oxauth project, )\n    def getFrontchannelHtml(self, context):\n        return \"\"\n</code></pre>","tags":["administration","developer","script-catalog","EndSession"]},{"location":"script-catalog/end_session/end-session/#script-type-java","title":"Script Type: Java","text":"<pre><code>import java.util.Map;\n\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.logout.EndSessionType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport io.jans.as.server.service.external.context.EndSessionContext;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\n\npublic class EndSession implements EndSessionType {\n\n        private static final Logger log = LoggerFactory.getLogger(CustomScriptManager.class);\n\n        @Override\n        public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"ROPC Script. Initializing...\");\n        log.info(\"ROPC Script. Initialized\");\n        return true;\n        }\n\n        @Override\n        public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"ROPC Script. Initializing...\");\n        log.info(\"ROPC Script. Initialized\");\n        return true;\n        }\n\n        @Override\n        public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"ROPC Script. Destroying...\");\n        log.info(\"ROPC Script. Destroyed.\");\n        return true;\n        }\n\n        @Override\n        public int getApiVersion() {\n                return 11;\n        }\n\n        @Override\n        public String getFrontchannelHtml(Object context) {\n                EndSessionContext endSessionContext = (EndSessionContext) context;\n                // Must return a real HTML string as per OIDC front channel logout spec\n                return \"\";\n        }\n\n}\n</code></pre>","tags":["administration","developer","script-catalog","EndSession"]},{"location":"script-catalog/fido2_extension/fido2-extension/","title":"Fido2 Extension","text":"<p>FIDO2 implements attestation and assertion with next endpoints:</p> <p><pre><code>https://&lt;myjans-server&gt;/jans-fido2/restv1/attestation/options   (register)\nhttps://&lt;myjans-server&gt;/jans-fido2/restv1/attestation/result   (verify registration)\nhttps://&lt;myjans-server&gt;/jans-fido2/restv1/assertion/options   (authenticate)\nhttps://&lt;myjans-server&gt;/jans-fido2/restv1/assertion/result   (verify authentication)\n</code></pre> each one can be customized just in the moment the endpoint is called, just before to execute the method as usual. You could execute validations, verifications, and modify the params received.</p>","tags":["administration","developer","script-catalog","fido2","Fido2Interception"]},{"location":"script-catalog/fido2_extension/fido2-extension/#interface","title":"Interface","text":"<p>The Fido2 extension script implements the Fido2ExtensionType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog","fido2","Fido2Interception"]},{"location":"script-catalog/fido2_extension/fido2-extension/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog","fido2","Fido2Interception"]},{"location":"script-catalog/fido2_extension/fido2-extension/#new-methods","title":"New Methods","text":"Method header Method description <code>def registerAttestationStart(self, paramAsJsonNode, context)</code> This method is called in Attestation register endpoint before start the registration process. Method 'throwBadRequestException' could be used to create a BadRequest Exception Response. <code>def registerAttestationFinish(self, paramAsJsonNode, context)</code> This method is called in Attestation register endpoint after start the registration process. Method 'throwBadRequestException' could be used to create a BadRequest Exception Response. <code>def verifyAttestationStart(self, paramAsJsonNode, context)</code> This method is called in Attestation verify endpoint before finish the registration verification process. Method 'throwBadRequestException' could be used to create a BadRequest Exception Response. <code>def verifyAttestationFinish(self, paramAsJsonNode, context)</code> This method is called in Attestation verify endpoint after finish the registration verification process. Method 'throwBadRequestException' could be used to create a BadRequest Exception Response. <code>def authenticateAssertionStart(self, paramAsJsonNode, context)</code> This method is called in Assertion authenticate endpoint before start the authentication process. Method 'throwBadRequestException' could be used to create a BadRequest Exception Response. <code>def authenticateAssertionFinish(self, paramAsJsonNode, context)</code> This method is called in Assertion authenticate endpoint after start the authentication process. Method 'throwBadRequestException' could be used to create a BadRequest Exception Response. <code>def verifyAssertionStart(self, paramAsJsonNode, context)</code> This method is called in Assertion verify endpoint before finish the authentication verification process. Method 'throwBadRequestException' could be used to create a BadRequest Exception Response. <code>def verifyAssertionFinish(self, paramAsJsonNode, context)</code> This method is called in Assertion verify endpoint after finish the authentication verification process. Method 'throwBadRequestException' could be used to create a BadRequest Exception Response.","tags":["administration","developer","script-catalog","fido2","Fido2Interception"]},{"location":"script-catalog/fido2_extension/fido2-extension/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>SimpleCustomProperty</code> Map of configuration properties. Reference <code>context</code> Reference","tags":["administration","developer","script-catalog","fido2","Fido2Interception"]},{"location":"script-catalog/fido2_extension/fido2-extension/#use-case-dummy-fido2-interception-form","title":"Use case: Dummy Fido2 Interception Form","text":"<p>This script has been adapted from the Jans Server sample fido2 interception script.</p>","tags":["administration","developer","script-catalog","fido2","Fido2Interception"]},{"location":"script-catalog/fido2_extension/fido2-extension/#script-type-python","title":"Script Type: Python","text":"<pre><code># Janssen Project software is available under the Apache 2.0 License (2004). See http://www.apache.org/licenses/ for full text.\n# Copyright (c) 2023, Janssen Project\n#\n# Author: Jorge Munoz\n# Author: Yuriy Movchan\n#\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.model.custom.script.type.fido2 import Fido2ExtensionType\nfrom io.jans.fido2.service.operation import AttestationService\nfrom io.jans.fido2.service.operation import AssertionService\nfrom io.jans.util import StringHelper\nfrom org.json import JSONObject\nfrom com.fasterxml.jackson.databind import JsonNode\nfrom org.apache.logging.log4j import ThreadContext\nfrom io.jans.fido2.model.u2f.error import Fido2ErrorResponseFactory\nfrom io.jans.fido2.model.u2f.error import Fido2ErrorResponseType\nfrom io.jans.as.model.config import Constants\n\nfrom java.lang import String\n\nclass Fido2Extension(Fido2ExtensionType):\n\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Fido2Extension. Initialization\"\n        print \"Fido2Extension. Initialized successfully\"\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print \"Fido2Extension. Destroy\"\n        print \"Fido2Extension. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # To generate a bad request WebApplicationException giving a message. This method is to be called inside (interceptRegisterAttestation, interceptVerifyAttestation, interceptAuthenticateAssertion, interceptVerifyAssertion)\n    def throwBadRequestException(self, title, message, context):\n        print \"Fido2Extension. Setting Bad request exception\"\n\n        errorClaimException = Fido2ErrorResponseFactory.createBadRequestException(Fido2ErrorResponseType.BAD_REQUEST_INTERCEPTION, title, message, ThreadContext.get(Constants.CORRELATION_ID_HEADER))\n        context.setWebApplicationException(errorClaimException)\n\n    # This method is called in Attestation register endpoint before start the registration process\n    def registerAttestationStart(self, paramAsJsonNode, context):\n        print \"Fido2Extension. registerAttestationStart\"\n        attestationService = CdiUtil.bean(AttestationService)\n\n        return True\n\n    # This method is called in Attestation register endpoint after start the registration process\n    def registerAttestationFinish(self, paramAsJsonNode, context):\n        print \"Fido2Extension. registerAttestationFinish\"\n        attestationService = CdiUtil.bean(AttestationService)\n\n        return True\n\n    # This method is called in Attestation verify endpoint before finish the registration verification process\n    def verifyAttestationStart(self, paramAsJsonNode, context):\n        print \"Fido2Extension. verifyAttestationStart\"\n        attestationService = CdiUtil.bean(AttestationService)\n\n        return True\n\n    # This method is called in Attestation verify endpoint after finish the registration verification process\n    def verifyAttestationFinish(self, paramAsJsonNode, context):\n        print \"Fido2Extension. verifyAttestationFinish\"\n        attestationService = CdiUtil.bean(AttestationService)\n\n        return True\n\n    # This method is called in Assertion authenticate endpoint before start the authentication process\n    def authenticateAssertionStart(self, paramAsJsonNode, context):\n        print \"Fido2Extension. authenticateAssertionStart\"\n\n        assertionService = CdiUtil.bean(AssertionService)\n\n        if paramAsJsonNode.hasNonNull(\"username\"):\n            print \"Fido2Extension. Username: '%s'\" % paramAsJsonNode.get(\"username\").asText()\n            if paramAsJsonNode.get(\"username\").asText() == 'test_user':\n                self.throwBadRequestException(\"Fido2Extension authenticateAssertionStart : test_user\", \"Description Error from script : test_user\", context)\n        else:\n            self.throwBadRequestException(\"Fido2Extension authenticateAssertionStart. Username is missing.\", \"Description Error from script. Username is missing.\", context)\n\n        return True\n\n    # This method is called in Assertion authenticate endpoint after start the authentication process\n    def authenticateAssertionFinish(self, paramAsJsonNode, context):\n        print \"Fido2Extension. authenticateAssertionFinish\"\n        assertionService = CdiUtil.bean(AssertionService)\n\n        return True\n\n    # This method is called in Assertion verify endpoint before finish the authentication verification process\n    def verifyAssertionStart(self, paramAsJsonNode, context):\n        print \"Fido2Extension. verifyAssertionStart\"\n        assertionService = CdiUtil.bean(AssertionService)\n\n        return True\n\n    # This method is called in Assertion verify endpoint after finish the authentication verification process\n    def verifyAssertionFinish(self, paramAsJsonNode, context):\n        print \"Fido2Extension. verifyAssertionFinish\"\n        assertionService = CdiUtil.bean(AssertionService)\n\n        return True\n</code></pre>","tags":["administration","developer","script-catalog","fido2","Fido2Interception"]},{"location":"script-catalog/fido2_extension/fido2-extension/#script-type-java","title":"Script Type: Java","text":"<pre><code>import io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.fido2.Fido2ExtensionType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport io.jans.fido2.service.external.context.ExternalFido2Context;\nimport com.fasterxml.jackson.databind.JsonNode;\nimport org.apache.logging.log4j.ThreadContext;\nimport org.jboss.resteasy.spi.NoLogWebApplicationException;\n\nimport java.util.Map;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\npublic class Fido2Extension implements Fido2ExtensionType {\n\n    private static final Logger log = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Fido2Interception Script. Initializing...\");\n        log.info(\"Fido2Interception Script. Initialized\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Fido2Interception Script. Initializing...\");\n        log.info(\"Fido2Interception Script. Initialized\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Fido2Interception Script. Destroying...\");\n        log.info(\"Fido2Interception Script. Destroyed.\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n\n    @Override\n    public boolean registerAttestationStart(JsonNode paramsAsJsonNode, ExternalFido2InterceptionContext context) {\n        log.info(\"Fido2Interception Script. Attestation Register (start)...\");\n\n        return true;\n    }\n\n    @Override\n    public boolean registerAttestationFinish(JsonNode paramsAsJsonNode, ExternalFido2InterceptionContext context) {\n        log.info(\"Fido2Interception Script. Attestation Register (finish)...\");\n\n        return true;\n    }\n\n    @Override\n    public boolean verifyAttestationStart(JsonNode paramsAsJsonNode, ExternalFido2InterceptionContext context) {\n        log.info(\"Fido2Interception Script. Attestation Verify (start)...\");\n\n        return true;\n    }\n\n    @Override\n    public boolean verifyAttestationFinish(JsonNode paramsAsJsonNode, ExternalFido2InterceptionContext context) {\n        log.info(\"Fido2Interception Script. Attestation Verify (finish)...\");\n\n        return true;\n    }\n\n    @Override\n    public boolean authenticateAssertionStart(JsonNode paramsAsJsonNode, ExternalFido2InterceptionContext context) {\n        log.info(\"Fido2Interception Script. Assertion Authenticate (start)...\");\n\n        JsonNode jsonNodeUser = paramsAsJsonNode.get(\"username\");\n        if (jsonNodeUser != null) {\n            log.info(\"Fido2Interception. printing username: {}\", jsonNodeUser.asText());\n            if (jsonNodeUser.asText().equals(\"test_user\")) {\n                throwBadRequestException(\"Fido2Interception interceptAuthenticateAssertion : test_user\", \"Description Error from script : test_user\", context);\n            }\n        }\n\n        return true;\n    }\n\n    @Override\n    public boolean authenticateAssertionFinish(JsonNode paramsAsJsonNode, ExternalFido2InterceptionContext context) {\n        log.info(\"Fido2Interception Script. Assertion Authenticate (finish)...\");\n\n        return true;\n    }\n\n    @Override\n    public boolean verifyAssertionStart(JsonNode paramsAsJsonNode, ExternalFido2InterceptionContext context) {\n        log.info(\"Fido2Interception Script. Assertion Verify (start)...\");\n\n        return true;\n    }\n\n    @Override\n    public boolean verifyAssertionFinish(JsonNode paramsAsJsonNode, ExternalFido2InterceptionContext context) {\n        log.info(\"Fido2Interception Script. Assertion Verify (finish)...\");\n\n        return true;\n    }\n\n    private void throwBadRequestException(String title, String message, ExternalFido2InterceptionContext context) {\n        log.info(\"Fido2Interception. setting Bad request exception\");\n        WebApplicationException errorClaimException = Fido2ErrorResponseFactory.createBadRequestException(Fido2ErrorResponseType.BAD_REQUEST_INTERCEPTION, title, message, ThreadContext.get(Constants.CORRELATION_ID_HEADER));\n        context.setWebApplicationException((NoLogWebApplicationException) errorClaimException);\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog","fido2","Fido2Interception"]},{"location":"script-catalog/health_check/health-check/","title":"Create User Custom Script","text":"<p>\"HealthCheck\" custom script is used when Health Check Endpoint is called. Custom script allows inject/modify response from Health Check Endpoint.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/health_check/health-check/#interface","title":"Interface","text":"<p>The HealthCheck script implements the HealthCheckType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/health_check/health-check/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/health_check/health-check/#new-methods","title":"New methods","text":"Method header Method description <code>def healthCheck(self, context)</code> Returns response for health check endpoint","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/health_check/health-check/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>context</code> Reference","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/health_check/health-check/#saample-scrip-in-java","title":"Saample Scrip in Java","text":"<pre><code>package io.jans.as.server._scripts;\n\nimport io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.health.HealthCheckType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport jakarta.servlet.http.HttpServletRequest;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\n\n/**\n * @author Yuriy Z\n */\npublic class HealthCheck implements HealthCheckType {\n\n    private static final Logger log = LoggerFactory.getLogger(HealthCheck.class);\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    @Override\n    public String healthCheck(Object context) {\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n        HttpServletRequest httpRequest = scriptContext.getExecutionContext().getHttpRequest();\n\n        String appStatus = \"running\";\n        String dbStatus = \"online\";\n        return String.format(\"{\\\"status\\\": \\\"%s\\\", \\\"db_status\\\":\\\"%s\\\"}\", appStatus, dbStatus);\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized HealthCheck Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized HealthCheck Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed HealthCheck Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/health_check/health-check/#sample-scripts","title":"Sample Scripts","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/health_check/health-check/#health-check-script","title":"Health Check Script","text":"<pre><code>package io.jans.as.server._scripts;\n\nimport io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.health.HealthCheckType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport jakarta.servlet.http.HttpServletRequest;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\n\n/**\n * @author Yuriy Z\n */\npublic class HealthCheck implements HealthCheckType {\n\n    private static final Logger log = LoggerFactory.getLogger(HealthCheck.class);\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    @Override\n    public String healthCheck(Object context) {\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n        HttpServletRequest httpRequest = scriptContext.getExecutionContext().getHttpRequest();\n\n        String appStatus = \"running\";\n        String dbStatus = \"online\";\n        return String.format(\"{\\\"status\\\": \\\"%s\\\", \\\"db_status\\\":\\\"%s\\\"}\", appStatus, dbStatus);\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized HealthCheck Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized HealthCheck Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed HealthCheck Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/id_generator/id-generator/","title":"ID Generator","text":"<p>By default Janssen Auth Server uses an internal method to generate unique identifiers for new person/client, etc. entries. In most cases the format of the ID is:</p> <p><code>'!' + idType.getInum() + '!' + four_random_HEX_characters + '.' + four_random_HEX_characters.</code></p> <p>The ID generation script enables an admin to implement custom ID generation rules.</p>","tags":["administration","developer","script-catalog","IdGenerator"]},{"location":"script-catalog/id_generator/id-generator/#interface","title":"Interface","text":"<p>The ID Generator script implements the IdGeneratorType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog","IdGenerator"]},{"location":"script-catalog/id_generator/id-generator/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog","IdGenerator"]},{"location":"script-catalog/id_generator/id-generator/#new-methods","title":"New Methods","text":"Method header Method description <code>def generateId(self, appId, idType, idPrefix, configurationAttributes)</code> <code>appId</code> is application ID, <code>idType</code> is ID Type, <code>idPrefix</code> is ID Prefix","tags":["administration","developer","script-catalog","IdGenerator"]},{"location":"script-catalog/id_generator/id-generator/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code>","tags":["administration","developer","script-catalog","IdGenerator"]},{"location":"script-catalog/id_generator/id-generator/#use-case-sample-id-generator","title":"Use case: Sample ID generator","text":"<p>This script has been adapted from the Gluu Server sample ID generator script.</p>","tags":["administration","developer","script-catalog","IdGenerator"]},{"location":"script-catalog/id_generator/id-generator/#script-type-python","title":"Script Type: Python","text":"<pre><code># oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.model.custom.script.type.id import IdGeneratorType\nfrom io.jans.util import StringHelper, ArrayHelper\nfrom java.util import Arrays, ArrayList\n\nimport java\n\nclass IdGenerator(IdGeneratorType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Id generator. Initialization\"\n        print \"Id generator. Initialized successfully\"\n\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print \"Id generator. Destroy\"\n        print \"Id generator. Destroyed successfully\"\n        return True   \n\n    def getApiVersion(self):\n        return 11\n\n    # Id generator init method\n    #   appId is application Id\n    #   idType is Id Type\n    #   idPrefix is Id Prefix\n    #   user is io.jans.oxtrust.model.JanssenCustomPerson\n    #   configurationAttributes is java.util.Map&lt;String, SimpleCustomProperty&gt;\n    def generateId(self, appId, idType, idPrefix, configurationAttributes):\n        print \"Id generator. Generate Id\"\n        print \"Id generator. Generate Id. AppId: '\", appId, \"', IdType: '\", idType, \"', IdPrefix: '\", idPrefix, \"'\"\n\n        # Return None or empty string to trigger default Id generation method\n        return None\n</code></pre>","tags":["administration","developer","script-catalog","IdGenerator"]},{"location":"script-catalog/id_generator/id-generator/#script-type-java","title":"Script Type: Java","text":"<pre><code>import java.util.Map;\n\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.id.IdGeneratorType;\nimport io.jans.service.custom.script.CustomScriptManager;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\npublic class EndSession implements EndSessionType {\n\n    private static final Logger log = LoggerFactory.getLogger(CustomScriptManager.class);\n\n        @Override\n        public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"ID Generator. Initializing...\");\n        log.info(\"ID Generator. Initialized\");\n        return true;\n        }\n\n        @Override\n        public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"ID Generator. Initializing...\");\n        log.info(\"ID Generator. Initialized\");\n        return true;\n        }\n\n        @Override\n        public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"ID Generator. Destroying...\");\n        log.info(\"ID Generator. Destroyed.\");\n        return true;\n        }\n\n        @Override\n        public int getApiVersion() {\n                return 11;\n        }\n\n    @Override\n    public String generateId(String appId, String idType, String idPrefix, Map&lt;String SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"ID Generator. Generate Id\");\n        // Return None or empty string to trigger default Id generation method\n        return \"\";\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog","IdGenerator"]},{"location":"script-catalog/idp/idp-extension/","title":"IDP","text":"","tags":["administration","developer","script-catalog","IdpExtension"]},{"location":"script-catalog/idp/idp-extension/#interface","title":"Interface","text":"<p>The IdpExtension script implements the IdpType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog","IdpExtension"]},{"location":"script-catalog/idp/idp-extension/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog","IdpExtension"]},{"location":"script-catalog/idp/idp-extension/#new-methods","title":"New Methods","text":"Method header Method description <code>def translateAttributes(self, context, configurationAttributes)</code> context is <code>io.jans.idp.externalauth.TranslateAttributesContext</code> <code>(https://github.com/JanssenFederation/shib-oxauth-authn3/blob/master/src/main/java/io.jans.idp/externalauth/TranslateAttributesContext.java)</code>. configurationAttributes is <code>java.util.Map&lt;String, SimpleCustomProperty&gt;</code> <code>def updateAttributes(self, context, configurationAttributes)</code> context is <code>io.jans.idp.externalauth.TranslateAttributesContext</code> <code>(https://github.com/JanssenFederation/shib-oxauth-authn3/blob/master/src/main/java/io.jans.idp/externalauth/TranslateAttributesContext.java)</code>. configurationAttributes is <code>java.util.Map&lt;String, SimpleCustomProperty&gt;</code>","tags":["administration","developer","script-catalog","IdpExtension"]},{"location":"script-catalog/idp/idp-extension/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code>","tags":["administration","developer","script-catalog","IdpExtension"]},{"location":"script-catalog/idp/idp-extension/#script-type-python","title":"Script Type: Python","text":"<pre><code># oxShibboleth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2020, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.model.custom.script.type.idp import IdpType\nfrom io.jans.util import StringHelper\nfrom io.jans.idp.externalauth import AuthenticatedNameTranslator\nfrom net.shibboleth.idp.authn.principal import UsernamePrincipal, IdPAttributePrincipal\nfrom net.shibboleth.idp.authn import ExternalAuthentication\nfrom net.shibboleth.idp.attribute import IdPAttribute, StringAttributeValue\nfrom net.shibboleth.idp.authn.context import AuthenticationContext, ExternalAuthenticationContext\nfrom net.shibboleth.idp.attribute.context import AttributeContext\nfrom javax.security.auth import Subject\nfrom java.util import Collections, HashMap, HashSet, ArrayList, Arrays\n\nimport java\n\nclass IdpExtension(IdpType):\n\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Idp extension. Initialization\"\n\n        self.defaultNameTranslator = AuthenticatedNameTranslator()\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"Idp extension. Destroy\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Translate attributes from user profile\n    #   context is io.jans.idp.externalauth.TranslateAttributesContext (https://github.com/JanssenFederation/shib-oxauth-authn3/blob/master/src/main/java/io.jans.idp/externalauth/TranslateAttributesContext.java)\n    #   configurationAttributes is java.util.Map&lt;String, SimpleCustomProperty&gt;\n    def translateAttributes(self, context, configurationAttributes):\n        print \"Idp extension. Method: translateAttributes\"\n\n        # Return False to use default method\n        #return False\n\n        request = context.getRequest()\n        userProfile = context.getUserProfile()\n        principalAttributes = self.defaultNameTranslator.produceIdpAttributePrincipal(userProfile.getAttributes())\n        print \"Idp extension. Converted user profile: '%s' to attribute principal: '%s'\" % (userProfile, principalAttributes)\n\n        if not principalAttributes.isEmpty():\n            print \"Idp extension. Found attributes from oxAuth. Processing...\"\n\n            # Start: Custom part\n            # Add givenName attribute\n            givenNameAttribute = IdPAttribute(\"jansEnrollmentCode\")\n            givenNameAttribute.setValues(ArrayList(Arrays.asList(StringAttributeValue(\"Dummy\"))))\n            principalAttributes.add(IdPAttributePrincipal(givenNameAttribute))\n            print \"Idp extension. Updated attribute principal: '%s'\" % principalAttributes\n            # End: Custom part\n\n            principals = HashSet()\n            principals.addAll(principalAttributes)\n            principals.add(UsernamePrincipal(userProfile.getId()))\n\n            request.setAttribute(ExternalAuthentication.SUBJECT_KEY, Subject(False, Collections.singleton(principals),\n                Collections.emptySet(), Collections.emptySet()))\n\n            print \"Created an IdP subject instance with principals containing attributes for: '%s'\" % userProfile.getId()\n\n            if False:\n                idpAttributes = ArrayList()\n                for principalAttribute in principalAttributes:\n                    idpAttributes.add(principalAttribute.getAttribute())\n\n                request.setAttribute(ExternalAuthentication.ATTRIBUTES_KEY, idpAttributes)\n\n                authenticationKey = context.getAuthenticationKey()\n                profileRequestContext = ExternalAuthentication.getProfileRequestContext(authenticationKey, request)\n                authContext = profileRequestContext.getSubcontext(AuthenticationContext)\n                extContext = authContext.getSubcontext(ExternalAuthenticationContext)\n\n                extContext.setSubject(Subject(False, Collections.singleton(principals), Collections.emptySet(), Collections.emptySet()));\n\n                extContext.getSubcontext(AttributeContext, True).setUnfilteredIdPAttributes(idpAttributes)\n                extContext.getSubcontext(AttributeContext).setIdPAttributes(idpAttributes)\n        else:\n            print \"No attributes released from oxAuth. Creating an IdP principal for: '%s'\" % userProfile.getId()\n            request.setAttribute(ExternalAuthentication.PRINCIPAL_NAME_KEY, userProfile.getId())\n\n        #Return True to specify that default method is not needed\n        return False\n\n    # Update attributes before releasing them\n    #   context is io.jans.idp.consent.processor.PostProcessAttributesContext (https://github.com/JanssenProject/shib-oxauth-authn3/blob/nightly/src/main/java/io.jans.idp/consent/processor/PostProcessAttributesContext.java)\n    #   configurationAttributes is java.util.Map&lt;String, SimpleCustomProperty&gt;\n    def updateAttributes(self, context, configurationAttributes):\n        print \"Idp extension. Method: updateAttributes\"\n        attributeContext = context.getAttributeContext()\n\n        customAttributes = HashMap()\n        customAttributes.putAll(attributeContext.getIdPAttributes())\n\n        # Remove givenName attribute\n        customAttributes.remove(\"givenName\")\n\n        # Update surname attribute\n        if customAttributes.containsKey(\"sn\"):\n            customAttributes.get(\"sn\").setValues(ArrayList(Arrays.asList(StringAttributeValue(\"Dummy\"))))\n\n        # Set updated attributes\n        attributeContext.setIdPAttributes(customAttributes.values())\n\n        return True\n</code></pre>","tags":["administration","developer","script-catalog","IdpExtension"]},{"location":"script-catalog/idp/idp-extension/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","developer","script-catalog","IdpExtension"]},{"location":"script-catalog/idp/idp-extension/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","developer","script-catalog","IdpExtension"]},{"location":"script-catalog/idp/idp-extension/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","developer","script-catalog","IdpExtension"]},{"location":"script-catalog/introspection/","title":"Introspection Script Guide","text":"<p>OAuth reference tokens don't convey any information. They are by their very nature, unguessable strings that meet the prescribed OAuth security guidelines for lack of order or predictability (entropy). However, there is still a large amount of data that may be attached to a token, such as:-  - its current validity,  - approved scopes,   - information about the context in which the token was issued. </p> <p>Access token data is essential for the resource server to evaluate policies that determine whether to allow the request. Token introspection therefore enables a client to trade an OAuth reference token for its JSON equivalent by making a request per OAuth 2.0 Token Introspection Guide - (RFC 7662).</p> <p>The use of Introspection scripts allows the ability to modify the response of Introspection Endpoint spec and provide additional information in the JSON response.</p>"},{"location":"script-catalog/introspection/#interface","title":"Interface","text":"<p>In order to be run and Introspection script should be associated with an OpenID Client (used for obtaining the token). Another way of doing this is by setting the <code>introspectionScriptBackwardCompatibility</code> global Auth Server JSON Configuration Property to true. In this case the Auth Server will run all scripts and will do so by ignoring client configuration.</p>"},{"location":"script-catalog/introspection/#methods","title":"Methods","text":"<p>The introspection interception script extends the base script type with the methods -</p> Method Method description <code>def init(self, customScript, configurationAttributes)</code> Inherited Method This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> Inherited Method This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> Inherited Method The <code>getApiVersion</code> method allows API changes in order to do transparent migration from an old script to a new API. NOTE: - Only include the customScript variable if the value for <code>getApiVersion</code> is greater than 10 <code>def modifyResponse(self, responseAsJsonObject, context)</code> This method is called after the introspection response is ready. This method can modify the introspection response.<code>responseAsJsonObject</code> is <code>org.codehaus.jettison.json.JSONObject</code> <code>context</code> is <code>io.jans.as.service.external.context.ExternalIntrospectionContext</code> <p>The <code>configurationAttributes</code> parameter is <code>java.util.Map&lt;String, SimpleCustomProperty&gt;</code>.</p> <pre><code>configurationAttributes = new HashMap&lt;String, SimpleCustomProperty&gt;();\nconfigurationAttributes.put(\"Location Type\", new SimpleCustomProperty(\"location_type\", \"db\", \"Storage Location for the script\"));\n</code></pre>"},{"location":"script-catalog/introspection/#snippet","title":"Snippet","text":"<pre><code># Returns boolean, true - apply introspection method, false - ignore it.\n# This method is called after introspection response is ready. This method can modify the introspection response.\n# Note :\n# responseAsJsonObject - is org.codehaus.jettison.json.JSONObject, you can use any method to manipulate json\n# context is reference of io.jans.as.server.service.external.context.ExternalIntrospectionContext (in https://github.com/JanssenProject project)\ndef modifyResponse(self, responseAsJsonObject, context):\n    responseAsJsonObject.accumulate(\"key_from_script\", \"value_from_script\")\n    return True\n</code></pre> <p>Note - The preferred way to modify an access token is with the Update Token script.</p> <p>It is also possible to run an introspection script during <code>access_token</code> creation as JWT. It can be controlled by <code>run_introspection_script_before_jwt_creation</code> OpenID Client property which is set to false by default.</p> <p>If OpenID Client properties <code>run_introspection_script_before_jwt_creation</code> and <code>access_token_as_jwt</code> are set to true then an introspection script will be run before JWT (<code>access_token</code>) is created and all JSON values will be transfered to JWT. Also <code>context</code> inside the script has additional method which allows you to cancel transfering of claims if needed <code>context.setTranferIntrospectionPropertiesIntoJwtClaims(false)</code></p>"},{"location":"script-catalog/introspection/#common-use-cases","title":"Common Use Cases","text":""},{"location":"script-catalog/introspection/#script-type-python","title":"Script Type: Python","text":""},{"location":"script-catalog/introspection/#retrieve-grant-session-and-user-details-from-access-token","title":"Retrieve Grant, Session and User Details from Access Token","text":"<p>The sample code snippet shows how to work backwards from an AccessToken to Grant, Session and User information.</p>"},{"location":"script-catalog/introspection/#script-type-java","title":"Script Type: Java","text":""},{"location":"script-catalog/introspection/#retrieve-grant-session-and-user-details-from-access-token_1","title":"Retrieve Grant, Session and User Details from Access Token","text":"<p>The sample code snippet shows how to work backwards from an AccessToken to Grant, Session and User information.</p>"},{"location":"script-catalog/introspection/interception-scripts-debug/","title":"Script Debugging","text":"","tags":["administration","developer"]},{"location":"script-catalog/introspection/interception-scripts-debug/#setup","title":"Setup","text":"<p>For development the kubernetes setup must be local and accessible to the debug server address. The following steps will walk you through a setup using Minikube with docker driver, and ksync for syncing the files between local, and the container. The following instructions assume a fresh ubuntu 20.04, however the setup can be done on a different operating systems such as macOS or Windows.</p>","tags":["administration","developer"]},{"location":"script-catalog/introspection/interception-scripts-debug/#system-requirements","title":"System Requirements","text":"<p>The minimum system requirement for running all jans services are <code>8GB RAM</code>, <code>4 CPU</code>, and <code>50GB disk</code>. This can be dropped to <code>4GB RAM</code>, <code>4CPU</code> and <code>20GB</code> disk space if operating with required services auth-server, and LDAP.</p>","tags":["administration","developer"]},{"location":"script-catalog/introspection/interception-scripts-debug/#setup-minikube","title":"Setup Minikube","text":"<ol> <li> <p>Install Docker 18.09 or higher. For other operating systems follow the appropriate docs.</p> </li> <li> <p>Install minikube, but do not start it yet.</p> </li> <li> <p>Install kubectl.</p> </li> <li> <p>Once Minikube is installed start it with the docker driver.</p> <pre><code>minikube start --driver=docker\n</code></pre> </li> <li> <p>If not automatically set configure <code>kubectl</code> to use the cluster:</p> <pre><code>kubectl config use-context minikube\n</code></pre> </li> <li> <p>Enable ingress on minikube</p> <pre><code>minikube addons enable ingress\n</code></pre> </li> </ol>","tags":["administration","developer"]},{"location":"script-catalog/introspection/interception-scripts-debug/#install-janssen","title":"Install Janssen","text":"<ol> <li> <p>Install Helm3</p> </li> <li> <p>Install Janssen</p> <pre><code>helm repo add jans https://janssenproject.github.io/jans-cloud-native/charts\nkubectl create ns jans\nhelm install jans-auth jans/jans -n jans --set global.lbIp=\"$(minikube ip)\" --set global.provisioner=\"k8s.io/minikube-hostpath\" --devel\n</code></pre> </li> </ol>","tags":["administration","developer"]},{"location":"script-catalog/introspection/interception-scripts-debug/#install-ksync","title":"Install Ksync","text":"<p>Once Janssen is fully running we want to create an active sync between a local folder, and the folder that will hold the interception scripts inside the auth server container.</p> <ol> <li> <p>Create a folder that will hold the interception script inside the auth server container. Place the namespace where jans is installed in the env <code>JANS_NAMESPACE</code> and execute:</p> <pre><code>JANS_NAMESPACE=&lt;jans-namespace&gt;\nfor pod in $(kubectl get pods -n $JANS_NAMESPACE --selector=APP_NAME=auth-server --output=jsonpath={.items..metadata.name}); do\n    kubectl exec -ti $pod -n $JANS_NAMESPACE -- mkdir -p /deploy/interception-scripts-ksync\ndone\n</code></pre> </li> <li> <p>Install ksync</p> <pre><code>curl https://ksync.github.io/gimme-that/gimme.sh | bash\n</code></pre> </li> <li> <p>Initialize ksync</p> <pre><code>ksync init -n &lt;jans-namespace&gt;\n</code></pre> </li> <li> <p>Start ksync.</p> <pre><code>ksync watch -n &lt;jans-namespace&gt; &amp;\n</code></pre> </li> <li> <p>Open a new terminal and create a folder called <code>interception-scripts-ksync</code></p> <pre><code>mkdir -p $(pwd)/interception-scripts-ksync\n</code></pre> </li> <li> <p>Create a spec to start syncing folders between the local system and auth server container.</p> <pre><code>ksync create --selector=APP_NAME=auth-server $(pwd)/interception-scripts-ksync /deploy/interception-scripts-ksync -n &lt;jans-namespace&gt;\n</code></pre> </li> <li> <p>Check the status. Also check the terminal where the <code>watch</code> command is running.</p> <p><pre><code>ksync get\n</code></pre> 1. Move the interception script to the local folder <code>$(pwd)/interception-scripts-ksync</code>. In the below example we copied the following script as <code>basic.py</code>:</p> <pre><code># oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.server.security import Identity\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\nfrom io.jans.as.server.service import AuthenticationService\nfrom io.jans.util import StringHelper\n\nimport java\n\nclass PersonAuthentication(PersonAuthenticationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript,  configurationAttributes):\n        print \"Basic. Initialization\"\n        print \"Basic. Initialized successfully\"\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"Basic. Destroy\"\n        print \"Basic. Destroyed successfully\"\n        return True\n\n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n\n    def getApiVersion(self):\n        return 11\n\n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n        return True\n\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n        return None\n\n    def authenticate(self, configurationAttributes, requestParameters, step):\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        if (step == 1):\n            print \"Basic. Authenticate for step 1\"\n\n            identity = CdiUtil.bean(Identity)\n            credentials = identity.getCredentials()\n\n            user_name = credentials.getUsername()\n            user_password = credentials.getPassword()\n\n            logged_in = False\n            if (StringHelper.isNotEmptyString(user_name) and StringHelper.isNotEmptyString(user_password)):\n                logged_in = authenticationService.authenticate(user_name, user_password)\n\n            if (not logged_in):\n                return False\n\n            return True\n        else:\n            return False\n\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\n        if (step == 1):\n            print \"Basic. Prepare for Step 1\"\n            return True\n        else:\n            return False\n\n    def getExtraParametersForStep(self, configurationAttributes, step):\n        return None\n\n    def getCountAuthenticationSteps(self, configurationAttributes):\n        return 1\n\n    def getPageForStep(self, configurationAttributes, step):\n        return \"\"\n\n    def getNextStep(self, configurationAttributes, requestParameters, step):\n        return -1\n\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n        print \"Get external logout URL call\"\n        return None\n\n    def logout(self, configurationAttributes, requestParameters):\n        return True\n</code></pre> </li> </ol>","tags":["administration","developer"]},{"location":"script-catalog/introspection/interception-scripts-debug/#install-an-ide","title":"Install an IDE","text":"<p>The IDE can be of choice but must contain PyDev. We chose Liclipse for this demonstration.</p> <p>Once complete, start the PyDev debug server:</p> <ol> <li> <p>Open Liclipse</p> </li> <li> <p>Install the jython jar for the interpreter. </p> <pre><code>wget https://repo1.maven.org/maven2/org/python/jython-standalone/2.7.2/jython-standalone-2.7.2.jar\n</code></pre> </li> <li> <p>From the menu: go to <code>File</code> -&gt; <code>Open File</code> and choose the interception script that will be debugged in <code>$(pwd)/interception-scripts-ksync</code>.</p> </li> <li> <p>When opening the Python file for the first time, we need to instruct Liclipse to use a specific interpreter. Follow these steps:</p> <ul> <li> <p>Press the \"Manual Config\" button in the dialog box after opening the Python file</p> </li> <li> <p>Open \"PyDev-&gt;Interpreters-&gt;Jython Interpreters\"</p> </li> <li> <p>Click the \"New...\" button in the right panel. Name it \"Jython\" and specify the interpreter executable that was downloaded previously \"jython-standalone-2.7.2.jar\"</p> </li> <li> <p>Click \"OK\", then confirm the settings by clicking \"OK\" again, then \"Apply and Close\"</p> </li> <li> <p>In the final dialog, confirm the settings by clicking \"OK\"</p> </li> </ul> </li> <li> <p>From the menu: go to <code>Window</code> -&gt; <code>Perspective</code> -&gt; <code>Open Perspective</code> -&gt; <code>Other..</code> -&gt; <code>Debug</code></p> </li> <li> <p>From the menu: go to <code>Pydev</code> &gt; <code>Start Debug Server</code>. Now the server should have started at port <code>5678</code>. Take a note of the ip of the computer running Liclipse and save it for later use. Remember that the auth server pod must be able to communicate with this ip. If you have followed the instructions above and installed minikube on your local computer which is the same computer Liclipse is operating on you should be able to reach it from within the pods.</p> </li> </ol>","tags":["administration","developer"]},{"location":"script-catalog/introspection/interception-scripts-debug/#development-debugging","title":"Development &amp; Debugging","text":"<p>Now we are ready to perform script development and debugging. Here is a quick overview:</p> <ol> <li> <p>Enable remote debugging on the <code>jans-auth</code> service.</p> </li> <li> <p>Instruct the auth server to load the script from the file system instead of LDAP.</p> </li> <li> <p>Add debug instructions to the script.</p> </li> <li> <p>Execute the script.</p> </li> </ol>","tags":["administration","developer"]},{"location":"script-catalog/introspection/interception-scripts-debug/#enable-remote-debugging-in-jans-auth","title":"Enable Remote Debugging in jans-auth","text":"<p>In order to enable remote debugging in the <code>jans-auth</code> process, open <code>/etc/default/jans-auth</code> in your favorite text editor. The default <code>JAVA_OPTIONS</code> variable is as follows:</p> <pre><code>JAVA_OPTIONS=\"-server \n    -Xms256m -Xmx928m -XX:+DisableExplicitGC \n    -Djans.base=/etc/jans -Dserver.base=/opt/jans/jetty/jans-auth \n    -Dlog.base=/opt/jans/jetty/jans-auth -Dpython.home=/opt/jython\"\n</code></pre> <p>Modify to this:</p> <pre><code>JAVA_OPTIONS=\"-server -Xms256m -Xmx928m -XX:+DisableExplicitGC \n    -Djans.base=/etc/jans -Dserver.base=/opt/jans/jetty/jans-auth \n    -Dlog.base=/opt/jans/jetty/jans-auth -Dpython.home=/opt/jython \n    -Dorg.eclipse.jetty.server.Request.maxFormContentSize=50000000 \n    -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=5005\"\n</code></pre> <p>The last line will enable remote debug on port 5005. Now restart the <code>jans-auth</code> service.</p> <pre><code># To list all jans processes\nsystemctl list-units --all \"jans*\"\n# On Ubuntu, the service name is jans-auth.service\nsystemctl restart jans-auth.service\n</code></pre> <p>If you are running Jans on a local VM or anywhere that is not the same as the machine that will be debugging, you will need to set up an SSH tunnel on port 5005. Execute the following command:</p> <pre><code>ssh -L 5005:localhost:5005 &lt;username&gt;@&lt;host&gt;\n</code></pre> <p>This will cause your local host's port 5005 to listen on the remote server's port 5005. Now you can use your favorite IDE and set up the remote debugger to connect to <code>localhost:5005</code>.</p>","tags":["administration","developer"]},{"location":"script-catalog/introspection/interception-scripts-debug/#enable-remote-debug-in-jython-custom-script","title":"Enable remote debug in Jython Custom Script","text":"<p>For Jython scripts, we need additional steps to enable breakpoints.</p> <ol> <li> <p>After the import section, add:   </p> <pre><code>REMOTE_DEBUG = True\n\nif REMOTE_DEBUG:\n    try:\n        import sys\n        import pydevd\n    except ImportError as ex:\n        print \"Failed to import pydevd: %s\" % ex\n        raise\n</code></pre> </li> <li> <p>Add the following lines wherever breakpoints are needed:   </p> <pre><code>if REMOTE_DEBUG:\n    pydevd.settrace('localhost', port=5678, stdoutToServer=True, stderrToServer=True)\n</code></pre> </li> </ol>","tags":["administration","developer"]},{"location":"script-catalog/introspection/interception-scripts-debug/#sample-scenario","title":"Sample Scenario","text":"<ol> <li> <p>Copy the below script to <code>$(pwd)/interception-scripts-ksync/basic.py</code> </p> <pre><code># oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.as.server.security import Identity\nfrom io.jans.model.custom.script.type.auth import PersonAuthenticationType\nfrom io.jans.as.server.service import AuthenticationService\nfrom io.jans.util import StringHelper\n\nimport java\n\nclass PersonAuthentication(PersonAuthenticationType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript,  configurationAttributes):\n        print \"Basic. Initialization\"\n        print \"Basic. Initialized successfully\"\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print \"Basic. Destroy\"\n        print \"Basic. Destroyed successfully\"\n        return True\n\n    def getAuthenticationMethodClaims(self, requestParameters):\n        return None\n\n    def getApiVersion(self):\n        return 11\n\n    def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n        return True\n\n    def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n        return None\n\n    def authenticate(self, configurationAttributes, requestParameters, step):\n        authenticationService = CdiUtil.bean(AuthenticationService)\n\n        if (step == 1):\n            print \"Basic. Authenticate for step 1\"\n\n            identity = CdiUtil.bean(Identity)\n            credentials = identity.getCredentials()\n\n            user_name = credentials.getUsername()\n            user_password = credentials.getPassword()\n\n            logged_in = False\n            if (StringHelper.isNotEmptyString(user_name) and StringHelper.isNotEmptyString(user_password)):\n                logged_in = authenticationService.authenticate(user_name, user_password)\n\n            if (not logged_in):\n                return False\n\n            return True\n        else:\n            return False\n\n    def prepareForStep(self, configurationAttributes, requestParameters, step):\n        if (step == 1):\n            print \"Basic. Prepare for Step 1\"\n            return True\n        else:\n            return False\n\n    def getExtraParametersForStep(self, configurationAttributes, step):\n        return None\n\n    def getCountAuthenticationSteps(self, configurationAttributes):\n        return 1\n\n    def getPageForStep(self, configurationAttributes, step):\n        return \"\"\n\n    def getNextStep(self, configurationAttributes, requestParameters, step):\n        return -1\n\n    def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n        print \"Get external logout URL call\"\n        return None\n\n    def logout(self, configurationAttributes, requestParameters):\n        return True\n</code></pre> </li> <li> <p>Make sure to have an LDAP browser available. We recommend Apache Directory Studio.</p> </li> <li> <p>Port forward the opendj pod. </p> <pre><code>kubectl port-forward jans-opendj-0 -n &lt;jans-namespace&gt; 1636:1636 --address 0.0.0.0\n</code></pre> </li> <li> <p>Create a connection to the ldap browser. The default password will be <code>Test1234#</code> if not changed in the helm install command.</p> <p></p> </li> <li> <p>Inside the browser navigate to <code>o=jans, ou=scripts</code>. Right click on <code>ou=scripts</code> and click on <code>Quick Search</code>. Inside the pop up box that appears fill <code>Returning Attributes</code> with <code>displayName</code>, and press <code>Apply and Close</code></p> </li> <li> <p>In the results that appear click on the <code>Dn</code> that has a <code>displayName</code> of <code>basic</code>.</p> <p></p> </li> <li> <p>Choose to load the script from file instead of db. Inside the browser change <code>jansModuleProperty</code> with value <code>{\"value1\":\"location_type\",\"value2\":\"db\",\"description\":\"\"}</code> to <code>{\"value1\":\"location_type\",\"value2\":\"file\",\"description\":\"\"}</code></p> </li> <li> <p>Specify the <code>Script Path</code> location to the location of the folder inside auth server pods: <code>/deploy/interception-scripts-ksync/basic.py</code>. Right-click the upper <code>jansModuleProperty</code> and click <code>New Value</code>. A new entry for <code>jansModuleProperty</code> will be created. Insert the following for the value: <code>{\"value1\":\"location_path\",\"value2\":\"/deploy/interception-scripts-ksync/basic.py\",\"description\":\"\"}</code></p> </li> <li> <p>Enable the script by settings <code>jansEnabled</code> to <code>true</code>. The following is an example of how the basic script entry should look.  </p> <p></p> </li> <li> <p>Check the following log inside the the auth-server container to verify that auth server loaded the script properly: <code>/opt/jans/jetty/jans-auth/logs/jans-auth_script.log</code>. It should look like this:    </p> <pre><code>kubectl exec -ti &lt;auth-server-pod-name&gt; -n &lt;jans-namespace&gt; -- tail -f /opt/jans/jetty/jans-auth/logs/jans-auth_script.log\n</code></pre> <p>You should find the following in the log:</p> <pre><code>... (PythonService.java:239) - Basic. Initialization\n\n... (PythonService.java:239) - Basic. Initialized successfully\n</code></pre> </li> <li> <p>Download the jython jar for the interpreter. </p> <pre><code>wget https://repo1.maven.org/maven2/org/python/jython-standalone/2.7.2/jython-standalone-2.7.2.jar\n</code></pre> </li> <li> <p>From the IDE (Liclipse) menu: navigate  to <code>File</code> -&gt; <code>Open File</code> and choose the interception script that will be debugged in <code>$(pwd)/interception-scripts-ksync/basic.py</code></p> </li> <li> <p>When opening the Python file for the first time, we need to instruct Liclipse to use a specific interpreter. Follow these steps:</p> <ul> <li> <p>Press the \"Manual Config\" button in the dialog box after opening the Python file</p> </li> <li> <p>Open \"PyDev-&gt;Interpreters-&gt;Jython Interpreters\"</p> </li> <li> <p>Click the \"New...\" button in the right panel. Name it \"Jython\" and specify the interpreter executable that was downloaded previously \"jython-standalone-2.7.2.jar\"</p> </li> <li> <p>Click \"OK\", then confirm the settings by clicking \"OK\" again, then \"Apply and Close\"</p> </li> <li> <p>In the final dialog, confirm the settings by clicking \"OK\"</p> </li> </ul> </li> <li> <p>Open basic.py in a file editor. After the import section, add the following lines to load the PyDev libraries:</p> <pre><code>REMOTE_DEBUG = True  \n\nif REMOTE_DEBUG:  \n    try:  \n        import sys  \n        import pydevd  \n    except ImportError as ex:  \n        print \"Failed to import pydevd: %s\" % ex  \n        raise  \n</code></pre> </li> <li> <p>Add this break condition to the first line in the authenticate method. Place the ip of the maching running the ide , here liclipse i.e <code>192.168.140.2</code>.</p> <pre><code>if REMOTE_DEBUG:   \n    pydevd.settrace('&lt;ip-of-machine-running-ide&gt;', port=5678, stdoutToServer=True, stderrToServer=True)  \n</code></pre> </li> <li> <p>Save <code>basic.py</code></p> </li> <li> <p>Within one minute, the auth server should load the changed file. Check the following log file again to make sure there are no load errors: <code>/opt/jans/jetty/jans-auth/logs/jans-auth_script.log</code></p> </li> <li> <p>To check if the script works, update the default authentication method to Basic Authentication. Preform this in the LDAP browser. Navigate to <code>o=jans,ou=configuration</code>. Change the <code>jansAuthMode</code> to <code>basic</code> instead of <code>simple_password_auth</code>.</p> </li> <li> <p>After executing <code>pydevd.settrace</code> the script will transfer execution control to the PyDev server in Liclipse. You can use any debug commands. For example: Step Over (F6), Resume (F8), etc</p> </li> <li> <p>After debugging is finished, resume script execution to transfer execution control back to the auth server. </p> </li> </ol>","tags":["administration","developer"]},{"location":"script-catalog/introspection/introspection/","title":"Introspection Script Guide","text":"<p>In OAuth 2.0 [RFC6749], the contents of tokens are opaque to clients. However, there is still a large amount of metadata that may be attached to a token, such as its current validity, approved scopes, and information about the context in which the token was issued. These pieces of information are often vital to protected resources making authorization decisions based on the tokens being presented. Token introspection allows a protected resource to query this information. Introspection scripts allows to modify response of Introspection Endpoint spec and present additional meta information surrounding the token.</p>","tags":["administration","developer","script-catalog","Introspection"]},{"location":"script-catalog/introspection/introspection/#interface","title":"Interface","text":"<p>Introspection script should be associated with client (used for obtaining the token) in order to be run. Otherwise it's possible to set <code>introspectionScriptBackwardCompatibility</code> global AS configuration property to true, in this case AS will run all scripts (ignoring client configuration).</p>","tags":["administration","developer","script-catalog","Introspection"]},{"location":"script-catalog/introspection/introspection/#methods","title":"Methods","text":"<p>The introspection interception script extends the base script type with the <code>init</code>, <code>destroy</code> and <code>getApiVersion</code> methods:</p> Inherited Methods Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10 <p>The <code>configurationAttributes</code> parameter is <code>java.util.Map&lt;String, SimpleCustomProperty&gt;</code>.</p> <p>The introspection interception script also adds the following method(s):</p> Method <code>def modifyResponse(self, responseAsJsonObject, context)</code> Method Paramater <code>responseAsJsonObject</code> is <code>org.codehaus.jettison.json.JSONObject</code> <code>context</code> is <code>io.jans.as.service.external.context.ExternalIntrospectionContext</code>","tags":["administration","developer","script-catalog","Introspection"]},{"location":"script-catalog/introspection/introspection/#snippet","title":"Snippet","text":"<pre><code># Returns boolean, true - apply introspection method, false - ignore it.\n# This method is called after introspection response is ready. This method can modify introspection response.\n# Note :\n# responseAsJsonObject - is org.codehaus.jettison.json.JSONObject, you can use any method to manipulate json\n# context is reference of io.jans.as.server.service.external.context.ExternalIntrospectionContext (in https://github.com/JanssenProject project)\ndef modifyResponse(self, responseAsJsonObject, context):\n    responseAsJsonObject.accumulate(\"key_from_script\", \"value_from_script\")\n    return True\n</code></pre> <p>It is also possible to run introspection script during <code>access_token</code> creation as JWT. It can be controlled by <code>run_introspection_script_before_jwt_creation</code> client property which is set to false by default.</p> <p>If <code>run_introspection_script_before_jwt_creation</code> set to true and <code>access_token_as_jwt</code> set to true then introspection script will be run before JWT (<code>access_token</code>) is created and all JSON values will be transfered to JWT. Also <code>context</code> inside script has additional method which allows to cancel transfering of claims if needed <code>context.setTranferIntrospectionPropertiesIntoJwtClaims(false)</code></p>","tags":["administration","developer","script-catalog","Introspection"]},{"location":"script-catalog/introspection/introspection/#common-use-cases","title":"Common Use Cases","text":"","tags":["administration","developer","script-catalog","Introspection"]},{"location":"script-catalog/introspection/introspection/#script-type-python","title":"Script Type: Python","text":"","tags":["administration","developer","script-catalog","Introspection"]},{"location":"script-catalog/introspection/introspection/#retrieve-grant-session-and-user-details-from-access-token","title":"Retrieve Grant, Session and User Details from Access Token","text":"<p>Following sample code snippet shows how to work backwards from an AccessToken to Grant, Session and User information.</p> <pre><code>from io.jans.model.custom.script.type.introspection import IntrospectionType\nfrom io.jans.as.server.service import SessionIdService\nfrom io.jans.service.cdi.util import CdiUtil\n\nclass Introspection(IntrospectionType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Introspection script. Initializing ...\"\n        print \"Introspection script. Initialized successfully\"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"Introspection script. Destroying ...\"\n        print \"Introspection script. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Returns boolean, true - apply introspection method, false - ignore it.\n    # This method is called after introspection response is ready. This method can modify introspection response.\n    # Note :\n    # responseAsJsonObject - is org.codehaus.jettison.json.JSONObject, you can use any method to manipulate json\n    # context is reference of io.jans.as.server.service.external.context.ExternalIntrospectionContext (in https://github.com/JanssenProject project, )\n    def modifyResponse(self, responseAsJsonObject, context):\n        authorizationGrant = context.getTokenGrant()\n        if authorizationGrant is None:\n            print \"Introspection. Failed to load authorization grant by context\"\n            return False\n\n        # Put user_id into response\n        responseAsJsonObject.accumulate(\"user_id\", authorizationGrant.getUser().getUserId())\n\n        # Put custom parameters into response\n        sessionDn = authorizationGrant.getSessionDn()\n        if sessionDn is None:\n            # There is no session\n            print \"Introspection. Failed to load session DN\"\n            return True\n\n        # Return session_id\n        responseAsJsonObject.accumulate(\"session_id\", sessionDn)\n\n        sessionIdService = CdiUtil.bean(SessionIdService)\n        session = sessionIdService.getSessionById(sessionDn, False)\n        if session is None:\n            print \"Introspection. Failed to load session '%s'\" % sessionDn\n            return True\n\n        sessionAttributes = session.getSessionAttributes()\n        if sessionAttributes is None:\n            # There is no session attributes\n            return True\n\n        # Append custom claims\n        if sessionAttributes.containsKey(\"custom1\"):\n            responseAsJsonObject.accumulate(\"custom1\", sessionAttributes.get(\"custom1\"))\n        if sessionAttributes.containsKey(\"custom2\"):\n            responseAsJsonObject.accumulate(\"custom2\", sessionAttributes.get(\"custom2\"))\n\n        return True\n</code></pre>","tags":["administration","developer","script-catalog","Introspection"]},{"location":"script-catalog/introspection/introspection/#script-type-java","title":"Script Type: Java","text":"","tags":["administration","developer","script-catalog","Introspection"]},{"location":"script-catalog/introspection/introspection/#retrieve-grant-session-and-user-details-from-access-token_1","title":"Retrieve Grant, Session and User Details from Access Token","text":"<p>Following sample code snippet shows how to work backwards from an AccessToken to Grant, Session and User information.</p> <pre><code>import io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.introspection.IntrospectionType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport io.jans.as.server.service.external.context.ExternalIntrospectionContext;\nimport io.jans.as.server.model.common.AuthorizationGrant;\nimport io.jans.as.server.service.SessionIdService;\nimport io.jans.service.cdi.util.CdiUtil;\nimport io.jans.as.server.model.common.SessionId;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.json.JSONObject;\n\nimport java.util.Map;\n\n\npublic class Introspection implements IntrospectionType {\n\n    private static final Logger log = LoggerFactory.getLogger(Introspection.class);\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Init of Introspection Java custom script\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Init of Introspection Java custom script\");\n        scriptLogger.info(\"Introspection Java script. Initializing ...\");\n        scriptLogger.info(\"Introspection Java script. Initialized successfully\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Destroy of Introspection Java custom script\");\n        scriptLogger.info(\"Introspection Java script. Destroying ...\");\n        scriptLogger.info(\"Introspection Java script. Destroyed successfully\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n\n    // Returns boolean, true - apply introspection method, false - ignore it.\n    // This method is called after introspection response is ready. This method can modify introspection response.\n    // Note :\n    // responseAsJsonObject - is org.json.JSONObject, you can use any method to manipulate json\n    // context is reference of io.jans.as.server.service.external.context.ExternalIntrospectionContext (in https://github.com/JanssenProject project, )\n\n    @Override\n    public boolean modifyResponse(Object responseAsJsonObject, Object context) {\n\n        JSONObject response = (JSONObject) responseAsJsonObject;\n        ExternalIntrospectionContext ctx = (ExternalIntrospectionContext) context;\n\n        response.accumulate(\"key_from_java\", \"value_from_script_on_java\");\n\n        AuthorizationGrant authorizationGrant = ctx.getTokenGrant();\n        if(authorizationGrant == null) {\n            scriptLogger.info(\"Introspection Java script. Failed to load authorization grant by context\");\n            return false;\n        }\n\n        // Put user_id into response\n        response.accumulate(\"user_id\", authorizationGrant.getUser().getUserId());\n\n        // Put custom parameters into response\n        String sessionDn = authorizationGrant.getSessionDn();\n        if(sessionDn == null) {\n            // There is no session\n            scriptLogger.info(\"Introspection Java script. Failed to load session DN\");\n            return true;\n        }\n\n        // Return session_id\n        response.accumulate(\"session_id\", sessionDn);\n\n        SessionIdService sessionIdService = CdiUtil.bean(SessionIdService.class);\n        SessionId session = sessionIdService.getSessionById(sessionDn, false);\n        if(session == null) {\n            scriptLogger.info(\"Introspection Java script. Failed to load session\");\n            return true;\n        }\n\n        Map&lt;String, String&gt; sessionAttributes = session.getSessionAttributes();\n        if(sessionAttributes == null) {\n            // There is no session attributes\n            return true;\n        }\n\n        // Append custom claims\n        if(sessionAttributes.containsKey(\"custom1\")) {\n            response.accumulate(\"custom1\", sessionAttributes.get(\"custom1\"));\n        }\n        if(sessionAttributes.containsKey(\"custom2\")) {\n            response.accumulate(\"custom2\", sessionAttributes.get(\"custom2\"));\n        }\n\n        return true;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog","Introspection"]},{"location":"script-catalog/link_interception/link-interception/","title":"Link Interception Detail Custom Script (LinkInterception)","text":"","tags":["administration","developer","script-catalog","Jans-link"]},{"location":"script-catalog/link_interception/link-interception/#overview","title":"Overview","text":"<p>In order to integrate your Jans instance with backend LDAP servers handling authentication in your existing network environment, Janssen provides a mechanism called Jans Link to copy user data to the Jans local LDAP server. During this process it is possible to specify key attribute(s) and specify attribute name transformations. There are also cases when it can be used to overwrite attribute values or to add new attributes based on other attribute values.</p>","tags":["administration","developer","script-catalog","Jans-link"]},{"location":"script-catalog/link_interception/link-interception/#interface","title":"Interface","text":"<p>The Jans Link (Link Interception) script implements the LinkInterceptionType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog","Jans-link"]},{"location":"script-catalog/link_interception/link-interception/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog","Jans-link"]},{"location":"script-catalog/link_interception/link-interception/#new-methods","title":"New Methods","text":"Method header Method description <code>def isStartProcess(self, configurationAttributes)</code> This method is called during start of jans link process. <code>def getBindCredentials(self, configId, configurationAttributes)</code> Get bind credentials required to access source server <code>def updateUser(self, user, configurationAttributes)</code> Update user entry before persist it","tags":["administration","developer","script-catalog","Jans-link"]},{"location":"script-catalog/link_interception/link-interception/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>SimpleCustomProperty</code> Map of configuration properties. Reference <code>configId</code> ConfigId is the source server. <code>user</code> Reference","tags":["administration","developer","script-catalog","Jans-link"]},{"location":"script-catalog/link_interception/link-interception/#use-case-dummy-jans-link-link-interception-script","title":"Use case: Dummy Jans Link (Link Interception) script","text":"<p>This was adapted from Jans link (Link Interception) script example.</p>","tags":["administration","developer","script-catalog","Jans-link"]},{"location":"script-catalog/link_interception/link-interception/#script-type-python","title":"Script Type: Python","text":"<pre><code># oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2016, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.model.custom.script.type.user import LinkInterceptionType\nfrom io.jans.util import StringHelper, ArrayHelper\nfrom java.util import Arrays, ArrayList\nfrom io.jans.oxtrust.model import JanssenCustomAttribute\nfrom io.jans.model.custom.script.model.bind import BindCredentials\n\nimport java\n\nclass LinkInterception(LinkInterceptionType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Link Interception. Initialization\"\n        print \"Link Interception. Initialized successfully\"\n\n        return True   \n\n    def destroy(self, configurationAttributes):\n        print \"Link Interception. Destroy\"\n        print \"Link Interception. Destroyed successfully\"\n        return True\n\n    # Check if this instance conform starting conditions \n    #   configurationAttributes is java.util.Map&lt;String, SimpleCustomProperty&gt;\n    #   return True/False\n    def isStartProcess(self, configurationAttributes):\n        print \"Link Interception. Is start process method\"\n\n        return False\n\n    # Get bind credentials required to access source server \n    #   configId is the source server\n    #   configurationAttributes is java.util.Map&lt;String, SimpleCustomProperty&gt;\n    #   return None (use password from configuration) or io.jans.model.custom.script.model.bind.BindCredentials\n    def getBindCredentials(self, configId, configurationAttributes):\n        print \"Link Interception. GetBindCredentials method\"\n#        if configId == \"source\":\n#            return BindCredentials(\"cn=Directory Manager\", \"password\")\n\n        return None\n\n    # Update user entry before persist it\n    #   user is io.jans.oxtrust.model.JanssenCustomPerson\n    #   configurationAttributes is java.util.Map&lt;String, SimpleCustomProperty&gt;\n    def updateUser(self, user, configurationAttributes):\n        print \"Link Interception. UpdateUser method\"\n\n        attributes = user.getCustomAttributes()\n\n        # Add new attribute preferredLanguage\n        attrPrefferedLanguage = JanssenCustomAttribute(\"preferredLanguage\", \"en-us\")\n        attributes.add(attrPrefferedLanguage)\n\n        # Add new attribute userPassword\n        attrUserPassword = JanssenCustomAttribute(\"userPassword\", \"test\")\n        attributes.add(attrUserPassword)\n\n        # Update givenName attribute\n        for attribute in attributes:\n            attrName = attribute.getName()\n            if ((\"givenname\" == StringHelper.toLowerCase(attrName)) and StringHelper.isNotEmpty(attribute.getValue())):\n                attribute.setValue(StringHelper.removeMultipleSpaces(attribute.getValue()) + \" (updated)\")\n\n        return True\n\n    def getApiVersion(self):\n        return 11\n</code></pre>","tags":["administration","developer","script-catalog","Jans-link"]},{"location":"script-catalog/logout_status_jwt/logout-status-jwt/","title":"Logout Status Jwt","text":"<p>By overriding the interface methods in <code>LogoutStatusJwtType</code> inside a custom script you can</p> <ol> <li> <p>Enable transformation of claims and values in logout_status_jwt, e.g. add a custom claim to an <code>logout_status_jwt</code>, change the <code>sub</code> value, or remove the <code>nonce</code>.  </p> </li> <li> <p>Set a specific logout_status_jwt lifetime</p> </li> </ol>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/logout_status_jwt/logout-status-jwt/#interface","title":"Interface","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/logout_status_jwt/logout-status-jwt/#methods","title":"Methods","text":"<p>The LogoutStatusJwtType interception script extends the base script type with the <code>init</code>, <code>destroy</code> and <code>getApiVersion</code> methods:</p> Inherited Methods Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10 <p>The <code>configurationAttributes</code> parameter is <code>java.util.Map&lt;String, SimpleCustomProperty&gt;</code>.</p> <p>The LogoutStatusJwtType interception script also adds the following method(s):</p> Method Method description <code>def modifyPayload(self, jsonWebResponse, context)</code> Used to modify logout_status_jwt claims. <code>jsonWebResponse</code> is <code>io.jans.as.model.token.JsonWebResponse</code> <code>context</code> is <code>io.jans.as.server.service.external.context.ExternalScriptContext</code> <code>def getLifetimeInSeconds(self, context)</code> Used to provide lifetime of logout_status_jwt. Value must be more then 0 or otherwise it's ignored by AS. (Lifetime will be set by <code>logoutStatusJwtLiftime</code> global AS configuration property.) <code>context</code> is <code>io.jans.as.server.service.external.context.ExternalScriptContext</code>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/logout_status_jwt/logout-status-jwt/#common-use-case","title":"Common Use Case","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/logout_status_jwt/logout-status-jwt/#script-type-java","title":"Script Type: Java","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/logout_status_jwt/logout-status-jwt/#addmodify-claims-inside-logout_status_jwt","title":"Add/Modify claims inside logout_status_jwt","text":"<pre><code>import io.jans.as.model.token.JsonWebResponse;\nimport io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.token.LogoutStatusJwtType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\n\n/**\n * @author Yuriy Z\n */\npublic class LogoutStatusJwt implements LogoutStatusJwtType {\n\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    /**\n     *\n     * @param jsonWebResponse refers to io.jans.as.model.token.JsonWebResponse\n     * @param context refers to io.jans.as.server.service.external.context.ExternalScriptContext\n     * @return true if logout_status_jwt should be created or false to forbid logout_status_jwt creation.\n     */\n    @Override\n    public boolean modifyPayload(Object jsonWebResponse, Object context) {\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n        JsonWebResponse jwr = (JsonWebResponse) jsonWebResponse;\n        jwr.getClaims().setClaim(\"custom_claim\", \"custom_value\");\n\n        return true;\n    }\n\n    /**\n     *\n     * @param context context refers to io.jans.as.server.service.external.context.ExternalScriptContext\n     * @return lifetime of logout_status_jwt in seconds. It must be more then 0 or otherwise it will be ignored by server.\n     */\n    @Override\n    public int getLifetimeInSeconds(Object context) {\n        boolean condition = false; // under some condition return 1 day lifetime\n        if (condition) {\n            return 86400;\n        }\n        return 0;\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized LogoutStatusJwt Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized LogoutStatusJwt Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed LogoutStatusJwt Java custom script.\");\n        return false;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/par/par/","title":"PAR Script","text":"<p>By overriding the interface methods in <code>ParType</code> inside a custom script you can</p> <ol> <li> <p>Modify all 'Par' object values before it is persisted.  e.g. modify scopes.  </p> </li> <li> <p>Modify response from <code>/par</code> endpoint</p> </li> </ol>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/par/par/#interface","title":"Interface","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/par/par/#methods","title":"Methods","text":"<p>The ParType interception script extends the base script type with the <code>init</code>, <code>destroy</code> and <code>getApiVersion</code> methods:</p> Inherited Methods Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10 <p>The <code>configurationAttributes</code> parameter is <code>java.util.Map&lt;String, SimpleCustomProperty&gt;</code>.</p> <p>The ParType interception script also adds the following method(s):</p> Method Method description <code>def createPar(self, par, context)</code> Used to modify PAR object before it is persisted. <code>par</code> is <code>io.jans.as.persistence.model.Par</code> <code>context</code> is <code>io.jans.as.server.service.external.context.ExternalScriptContext</code> <code>def modifyParResponse(self, response, context)</code> Used to modify response from <code>/par</code> endpoint. <code>response</code> is <code>org.json.JSONObject</code> <code>context</code> is <code>io.jans.as.server.service.external.context.ExternalScriptContext</code>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/par/par/#common-use-case","title":"Common Use Case","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/par/par/#script-type-java","title":"Script Type: Java","text":"<pre><code>import io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.par.ParType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport jakarta.ws.rs.core.Response;\nimport org.jboss.resteasy.spi.NoLogWebApplicationException;\nimport org.json.JSONObject;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\n\n/**\n * @author Yuriy Z\n */\npublic class Par implements ParType {\n\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    @Override\n    public boolean createPar(Object par, Object context) {\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n\n        io.jans.as.persistence.model.Par parObject = (io.jans.as.persistence.model.Par) par;\n        parObject.getAttributes().setScope(\"openid profile\");\n\n        if (\"bad\".equalsIgnoreCase(scriptContext.getExecutionContext().getClient().getClientId())) {\n            scriptContext.setWebApplicationException(\n                    new NoLogWebApplicationException(Response\n                            .status(Response.Status.FORBIDDEN)\n                            .entity(\"Forbidden by custom script.\")\n                            .build()));\n        }\n\n        return true;\n    }\n\n    @Override\n    public boolean modifyParResponse(Object responseAsJsonObject, Object context) {\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n\n        JSONObject json = (JSONObject) responseAsJsonObject;\n        json.accumulate(\"custom_key\", \"custom_value\");\n        return true;\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized PAR Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized PAR Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed PAR Java custom script.\");\n        return false;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/persistence_extension/persistence/","title":"Persistence Script","text":"<p>By overriding the interface methods in PersistenceType inside a custom script you can</p> <ol> <li>Load initialization data from DB or initialize services after the creation of Entry Manager. </li> <li>Release resources, terminate services etc. after the destruction of Entry Manager.</li> <li>Create hashed passwords</li> <li>Compare hashed passwords</li> </ol> <p>What is an Entry Manager?</p> <p>The Janssen server's Persistence Layer can be MySQL database. Information about an entity (person, session, client, scripts etc.) constitutes an Entry. The Entry Manager (CRUD operations) implementation for each type of Persistence is available in the Janssen server and the relevant Entry Manager (SQLEntryManager, etc.) is created when the server starts up.</p>","tags":["administration","developer","script-catalog","Hashed Passwords","Entry manager","Persistence Extension"]},{"location":"script-catalog/persistence_extension/persistence/#usage","title":"Usage","text":"<p>The Jans-Auth server contains a <code>PersistenceType</code> script.</p>","tags":["administration","developer","script-catalog","Hashed Passwords","Entry manager","Persistence Extension"]},{"location":"script-catalog/persistence_extension/persistence/#hashed-passwords","title":"Hashed Passwords","text":"<p>Hashed passwords can be created using any method from this enum, instead of the native/default SSHA256. The ORM module of the Janssen server does the following:</p> <ol> <li>When User entry is persisted and <code>userPassword</code> is specified, ORM calls <code>createHashedPassword</code></li> <li>User authenticates and the password is checked, the ORM module invokes <code>compareHashedPasswords</code> </li> <li>We need to specify which one to use in <code>/etc/gluu/conf/jans-sql.properties</code> <pre><code>password.encryption.method: SSHA-256\n</code></pre></li> <li> <p>Implementation <code>createHashedPassword</code> and <code>compareHashedPasswords</code> the script: </p> <ul> <li> <p>Creation <pre><code>    def createHashedPassword(self, credential):\n        hashed_password= PasswordEncryptionHelper.createStoragePassword(credential, PasswordEncryptionMethod.HASH_METHOD_PKCS5S2)\n        return hashed_password\n</code></pre></p> </li> <li> <p>Comparing Hashed Password: <pre><code>    def compareHashedPasswords(self, credential, storedCredential):\n        auth_result = PasswordEncryptionHelper.compareCredentials(credential, storedCredential)\n        return auth_result \n</code></pre></p> </li> </ul> </li> </ol>","tags":["administration","developer","script-catalog","Hashed Passwords","Entry manager","Persistence Extension"]},{"location":"script-catalog/persistence_extension/persistence/#script-type-python","title":"Script Type: Python","text":"","tags":["administration","developer","script-catalog","Hashed Passwords","Entry manager","Persistence Extension"]},{"location":"script-catalog/persistence_extension/persistence/#retrieve-grant-session-and-user-details-from-access-token","title":"Retrieve Grant, Session and User Details from Access Token","text":"<p>Following sample code snippet shows how to work backwards from an AccessToken to Grant, Session and User information. <pre><code># oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2020, Janssen\n#\n# Author: Yuriy Movchan\n#\n\nfrom io.jans.service.cdi.util import CdiUtil\nfrom io.jans.model.custom.script.type.persistence import PersistenceType\nfrom io.jans.util import StringHelper\nfrom io.jans.orm.operation.auth import PasswordEncryptionHelper\nfrom io.jans.orm.operation.auth import PasswordEncryptionMethod\n\nimport java\n\nclass PersistenceExtension(PersistenceType):\n\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Persistence extension. Initialization\"\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"Persistence extension. Destroy\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    def onAfterCreate(self, context, configurationAttributes):\n        print \"Persistence extension. Method: onAfterCreate\"\n\n    def onAfterDestroy(self, context, configurationAttributes):\n        print \"Persistence extension. Method: onAfterDestroy\"\n\n    def createHashedPassword(self, credential):\n        print \"Persistence extension. Method: createHashedPassword\"\n\n        hashed_password= PasswordEncryptionHelper.createStoragePassword(credential, PasswordEncryptionMethod.HASH_METHOD_PKCS5S2)\n\n        return hashed_password\n\n    def compareHashedPasswords(self, credential, storedCredential):\n        print \"Persistence extension. Method: compareHashedPasswords\"\n\n        auth_result = PasswordEncryptionHelper.compareCredentials(credential, storedCredential)\n\n        return auth_result \n</code></pre></p>","tags":["administration","developer","script-catalog","Hashed Passwords","Entry manager","Persistence Extension"]},{"location":"script-catalog/person_authentication/","title":"2FA authentication scripts","text":"<p>Jython files contained in the top level of this folder are already added as authentication scripts in your Janssen installation.</p> <p>Inside <code>other</code> directory you may find extra information about these scripts as well as additional (non curated) scripts that you may use as a guide to integrate third party authentication services or APIs with Janssen server.</p>"},{"location":"script-catalog/person_authentication/person-authentication-interface/","title":"Person authentication interface","text":"","tags":["administration","developer","script-catalog","PersonAuthenticationType","authentication","authentication workflow"]},{"location":"script-catalog/person_authentication/person-authentication-interface/#person-authentication-interface","title":"Person Authentication interface","text":"<p>The PersonAuthenticationType script is described by a java interface whose methods should be overridden to implement an authentication workflow.</p>","tags":["administration","developer","script-catalog","PersonAuthenticationType","authentication","authentication workflow"]},{"location":"script-catalog/person_authentication/person-authentication-interface/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog","PersonAuthenticationType","authentication","authentication workflow"]},{"location":"script-catalog/person_authentication/person-authentication-interface/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>SimpleCustomProperty</code> Map of configuration properties. Reference <p>Pseudo code: <pre><code>    def init(self, customScript,  configurationAttributes):\n        # an example of initializing global variables from script configuration\n        if configurationAttributes.containsKey(\"registration_uri\"):\n            self.registrationUri = configurationAttributes.get(\"registration_uri\").getValue2()\n        return True   \n</code></pre></p> <pre><code>    def destroy(self, configurationAttributes):\n            print \"ACR_NAME. Destroy\"\n            # cleanup code here\n            return True\n</code></pre> <pre><code>     def getApiVersion(self):   \n            return 11\n</code></pre>","tags":["administration","developer","script-catalog","PersonAuthenticationType","authentication","authentication workflow"]},{"location":"script-catalog/person_authentication/person-authentication-interface/#person-authentication-interface-methods","title":"Person Authentication interface Methods","text":"Method header Method description 1. <code>prepareForStep(self, configurationAttributes, requestParameters, step)</code> This method can be used to prepare variables needed to render the UI page and store them in a suitable context. 2. <code>authenticate(self, configurationAttributes, requestParameters, step)</code> The most important method which will encapsulate the logic for user credential verification / validation 3. <code>getExtraParametersForStep</code> Used to save session variables between steps.  The Jans-auth Server persists these variables to support stateless, two-step authentications even in a clustered environment. 4. <code>getCountAuthenticationSteps</code> This method normally just returns 1, 2, or 3. In some cases, depending on the context like based on the user's country or department, you can decide to go for multistep or single step authentication. 5. <code>getPageForStep</code> Used to specify the UI page you want to show for a given step. 6. <code>getNextStep</code> Steps usually go incrementally as 1, 2, 3... unless you specify a case where it can be reset to a previous step, or skip a particular step based on business case. 7. <code>getAuthenticationMethodClaims</code> Array of strings that are identifiers for authentication methods used in the authentication. In OpenID Connect, if the identity provider supplies an \"amr\" claim in the ID Token resulting from a successful authentication, the relying party can inspect the values returned and thereby learn details about how the authentication was performed. 8. <code>isValidAuthenticationMethod</code> This method is used to check if the authentication method is in a valid state. For example we can check there if a 3rd party mechanism is available to authenticate users. As a result it should either return True or False. 9. <code>getAlternativeAuthenticationMethod</code> This method is called only if the current authentication method is in an invalid state. Hence authenticator calls it only if isValidAuthenticationMethod returns False. As a result it should return the reserved authentication method name. 10. <code>getLogoutExternalUrl</code> Returns the 3rd-party URL that is used to end session routines. The control from this Third party URL should re-direct user back to /oxauth/logout.htm again with empty URL query string. Jans-Auth server will then continue of the extended logout flow, restore the original URL query string, and send user to <code>/jans-auth/end_session</code> to complete it. 11. <code>logout</code> This method is not mandatory. It can be used in cases when you need to execute specific logout logic in the authentication script when jans-auth receives an end session request to the /oxauth/logout.htm endpoint (which receives the same set of parameters than the usual end_session endpoint). This method should return True or False; when False jans-auth stops processing the end session request workflow.","tags":["administration","developer","script-catalog","PersonAuthenticationType","authentication","authentication workflow"]},{"location":"script-catalog/person_authentication/person-authentication-interface/#objects_1","title":"Objects","text":"Object name Object description <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>SimpleCustomProperty</code> Map of configuration properties. Reference usageType AuthenticationScriptUsageType step Integer indicating step number requestParameters Request parameters stored as Map <p>Pseudocode: <pre><code>def prepareForStep(self, configurationAttributes, requestParameters, step):\n    if (step == 1):\n        # do this\n    if (step == 2):\n        # do something else\n    return True # or False\n\ndef authenticate(self, configurationAttributes, requestParameters, step):\n   authenticationService = CdiUtil.bean(AuthenticationService)\n\n   if (step == 1):\n       # 1. obtain user name and password from UI\n       # 2. verify if entry exists in database\n       # 3. authenticationService.authenticate(user_name, user_password)\n       # 4. return True or False\n\n    elif step == 2:\n       # 1. obtain credentials from UI\n       # 2. validate the credentials\n       # 3. return True or False\n\ndef getExtraParametersForStep(self, configurationAttributes, step):\n       return Arrays.asList(\"paramName1\", \"paramName2\", \"paramName3\")\n\ndef getCountAuthenticationSteps(self, configurationAttributes):\n        return 1\n\ndef getPageForStep(self, configurationAttributes, step):\n    # Used to specify the page you want to return for a given step\n    if (step == 1):\n        return \"/auth/login.xhtml\"\n    if (step == 2)\n        return \"/auth/enterOTP.xhtml\"\n\n def getNextStep(self, configurationAttributes, requestParameters, step):\n# steps usually are incremented 1, 2, 3... unless you specify a case where it can be reset to a previous step, or skip a particular step based on business case.\n    return -1\n\n def getAuthenticationMethodClaims(self, requestParameters):\n    return Arrays.asList(\"pwd\", \"otp\")\n\n def isValidAuthenticationMethod(self, usageType, configurationAttributes):\n    return True\n\n def getAlternativeAuthenticationMethod(self, usageType, configurationAttributes):\n    return None\n\n def getLogoutExternalUrl(self, configurationAttributes, requestParameters):\n     return None\n\n def logout(self, configurationAttributes, requestParameters):\n    return True\n</code></pre></p>","tags":["administration","developer","script-catalog","PersonAuthenticationType","authentication","authentication workflow"]},{"location":"script-catalog/person_authentication/person-authentication-interface/#example-scripts","title":"Example scripts:","text":"<ol> <li> <p>Basic script</p> </li> <li> <p>Script catalog</p> </li> </ol>","tags":["administration","developer","script-catalog","PersonAuthenticationType","authentication","authentication workflow"]},{"location":"script-catalog/person_authentication/person-authentication/","title":"Person Authentication scripts","text":"<p>The Janssen Server leverages interception scripts of PersonAuthenticationType which when implemented can facilitate complex multi-step, multi-factor authentication workflows.</p> <p>The authentication flow in the Janssen Server is driven by the OpenID Connect specification. The authorization request to the OP (the Janssen Server) contains an optional query parameter called <code>acr_values</code> which is used by the OP to pick an interception script which will be run when <code>/authorize</code> endpoint (Authentication flow) is invoked.</p> <p>Each authentication method, whose name is the <code>acr</code> value, is tied to a <code>PersonAuthenticationType</code> script which offers the authentication workflow.</p> <p>Typically, a <code>PersonAuthenticationType</code> script can be used to:</p> <ul> <li>Introduce a new 2FA authentication mechanism</li> <li>Customize multi-step authentication</li> <li>Offer Social logins</li> <li>Proactively perform fraud detection and block a fraudulent user</li> </ul> <p>Authentication mechanisms offered by Jans can be confirmed by checking the Janssen Server OP configuration URL:</p> <pre><code>https://&lt;hostname&gt;/.well-known/openid-configuration\n</code></pre> <p>under the claim <code>acr_values_supported</code>.</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#building-blocks-of-an-authentication-workflow","title":"Building blocks of an authentication workflow","text":"<p>Jans-auth server comprises of a number of beans, configuration files and Facelets (JSF) views, packaged as a WAR module. That means custom scripts and custom pages (JSF facelets) can make use of business logic already encapsulated in the Weld managed beans.</p> <p>The following sections explain how authentication flow can be built using a custom script.</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#a-custom-script","title":"A. Custom script","text":"<p>The PersonAuthenticationType script is described by a java interface whose methods should be overridden to implement an authentication workflow. The article talks about these methods in detail and the pseudo code for each method.</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#b-ui-pages","title":"B. UI pages:","text":"<p>All web pages are xhtml files. The Command-Action offering by JSF framework is used by the Jans-auth server to implement authentication flows.</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#a-server-side-actions-implemented-by-custom-script","title":"a. Server-side actions implemented by custom script:","text":"<p>The custom script's <code>authenticate</code> and <code>prepareForStep</code> implementations are called by the following java class - Authenticator. These methods are mapped as command actions and view actions respectively in the web page.</p> <p>Relevant methods:</p> Signature Description boolean authenticate() Makes the authentication flow proceed by calling the <code>authenticate</code> method of the custom script String prepareAuthenticationForStep() Makes the authentication flow proceed by calling the <code>prepareForStep</code> method of the custom script","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#b-web-page-in-xhtml","title":"b. Web page in xhtml:","text":"<ol> <li>The <code>f:metadata</code> and <code>f:viewAction</code> tags are used to load variables (prepared in the <code>prepareForStep</code> method of the custom script). These variables are rendered on the UI page. <pre><code>&lt;f:metadata&gt;\n   &lt;f:viewAction action=\"#{authenticator.prepareAuthenticationForStep}\"\n     if=\"#{not identity.loggedIn}\" /&gt;\n &lt;/f:metadata&gt;\n</code></pre></li> <li>A form submit takes the flow to the <code>authenticate()</code> method of the custom script. <pre><code>&lt;h:commandButton id=\"updateButton\" value=\"Update\"\n               styleClass=\"btn btn-primary col-sm-4\"\n               action=\"#{authenticator.authenticate}\" style=\"margin:5px;\" /&gt;\n</code></pre></li> </ol>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#c-page-customizations","title":"c. Page customizations:","text":"<p>The Jans-auth server comes with a default set of pages for login, logout, errors, authorizations. You can easily override these pages or write new ones. You can easily apply your own stylesheet, images and resource-bundles to your pages.</p> <p>This article covers all the details you need to write your own web page.</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#c-business-logic-in-custom-script","title":"C. Business logic in Custom script:","text":"<p>Jans-auth server uses Weld 3.0 (JSR-365 aka CDI 2.0) for managed beans. The most important aspects of business logic are implemented through a set of beans. Details and examples of this can be found in this article</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#d-third-party-libraries-for-use-in-the-custom-script","title":"D. Third-party libraries for use in the custom script","text":"<p>Java or Python libraries to be imported and used with ease. Remember, you can import a python library only if it has been written in \"pure python\". More details of this mentioned here</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#e-configuring-the-acr-parameter-in-the-jans-auth-server","title":"E. Configuring the <code>acr</code> parameter in the Jans-auth server:","text":"<p>The <code>acr</code> parameter can be configured in the following ways :</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#default-authentication-method","title":"Default authentication method:","text":"<p><code>default_acr</code>: This is the default authentication mechanism exposed to all applications that send users to the Janssen Server for sign-in. Unless an app specifically requests a different form of authentication using the OpenID Connect acr_values parameter (as specified below), users will receive the form of authentication specified in this field.</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#internal-acr","title":"Internal ACR","text":"<p>If a default ACR is not specified, Janssen will determine it based on enabled scripts and the internal user/password ACR. This internal ACR, <code>simple_password_auth</code>, is set to level -1. This means that it has lower priority than any scripts, so Janssen server will use it only if no other authentication method is set.</p> <p>Use the jans-cli to update / look-up the default authentication method.</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#authentication-method-for-a-client-rp","title":"Authentication method for a client (RP):","text":"<p>A client may also specify <code>default_acr_values</code> during registration (and omit the parameter <code>acr_values</code> while making an authentication request).</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#multiple-authentication-mechanisms","title":"Multiple Authentication Mechanisms","text":"<p>The Jans Server can concurrently support multiple authentication mechanisms, enabling Web and mobile apps (clients) to request a specific type of authentication using the standard OpenID Connect request parameter: <code>acr_values</code>. Learn more about acr_values in the OpenID Connect core spec.</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#enabling-an-authentication-mechanism","title":"Enabling an authentication mechanism","text":"<p>An Authentication method is offered by the AS if its ACR value i.e. its corresponding custom script is <code>enabled</code>.</p> <p>By default, users will get the default authentication mechanism as specified above. However, using the OpenID Connect acr_values parameter, web and mobile clients can request any enabled authentication mechanism.</p> <ol> <li> <p>Obtain the json contents of a custom script by using a jans-cli command like <code>get-config-scripts-by-type</code>, <code>get-config-scripts-by-inum</code> etc.         Example :          - <code>/opt/jans/jans-cli/config-cli.py --operation-id get-config-scripts-by-type --url-suffix type:PERSON_AUTHENTICATION</code>          - <code>/opt/jans/jans-cli/config-cli.py --operation-id get-config-scripts-by-inum --url-suffix inum:6122281b-b55d-4dd0-8115-b098eeeee2b7</code></p> </li> <li> <p>Update the custom script and change the <code>enabled</code> attribute to <code>true</code></p> </li> </ol>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#level-rank-of-an-authentication-mechanism","title":"Level (rank) of an Authentication mechanism :","text":"<p>Each authentication mechanism (script) has a \"Level\" assigned to it which describes how secure and reliable it is. The higher the \"Level\", higher is the reliability represented by the script. Though several mechanisms can be enabled at the same Janssen server instance at the same time, for any specific user's session only one of them can be set as the current one (and will be returned as <code>acr</code> claim of id_token for them). If after initial session is created a new authorization request from a RP comes in specifying another authentication method, its \"Level\" will be compared to that of the method currently associated with this session. If requested method's \"Level\" is lower or equal to it, nothing is changed and the usual SSO behavior is observed. If it's higher (i.e. a more secure method is requested), it's not possible to serve such request using the existing session's context, and user must re-authenticate themselves to continue. If they succeed, a new session becomes associated with that requested mechanism instead.</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#f-using-person-authenticator-jansauthenticator-attribute","title":"F. Using person authenticator <code>jansAuthenticator</code> attribute :","text":"<p>The <code>jansAuthenticator</code> attribute can be used in cases when person authenticator need to persist data between person logins. For example script can have enrollment and authentication flows. And after enrollment it needs to store data into user entry for later use in authentication flow. To search by enrolled authenticator there is another multi-valued attribute <code>jansExtUid</code>. This attribute has default DB index to quick search. Both attributes are recommended to use in Jans since 1.1.1 version for better compatibility in future.</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#1-format-of-attributes","title":"1. Format of attributes","text":"<pre><code>jansExtUid: [otp:xyz1, cert:xyz2, duo:xyz3, ...]\njansAuthenticator: {\n   \"xyz1\": {\"id\": \"xyz1\", \"type\": \"otp\", \"custom\": {...}},\n   \"xyz2\": {\"id\": \"xyz2\", \"type\": \"cert\", \"custom\": {...}},\n   \"xyz3\": {\"id\": \"xyz3\", \"type\": \"duo\", \"custom\": {...}},\n    ...\n}\n</code></pre>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#2-sample-data","title":"2. Sample data:","text":"<pre><code>jansExtUid: [hotp:S9dO_qKQoOcpPk9GuStlNO9seoA=, cert:totp, duo:Nv7Dg7aP0wRPJd6NHjx1ai9bN9Y=]\njansAuthenticator:\n{\n  \"S9dO_qKQoOcpPk9GuStlNO9seoA=\": {\n    \"id\": \"S9dO_qKQoOcpPk9GuStlNO9seoA=\",\n    \"type\": \"hotp\",\n    \"custom\": {\n      \"movingFactor\": 3\n    }\n  },\n  \"Nv7Dg7aP0wRPJd6NHjx1ai9bN9Y=\": {\n    \"id\": \"Nv7Dg7aP0wRPJd6NHjx1ai9bN9Y=\",\n    \"type\": \"totp\"\n  }\n}\n</code></pre>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#2-access-jansauthenticator-and-jansextuid-from-generic-bean","title":"2. Access <code>jansAuthenticator</code> and <code>jansExtUid</code> from generic bean","text":"<p>For both attributes there are get/set methods in <code>User</code> entry. After loading user object script can call these methods to get required data.</p> <pre><code>...\n    @AttributeName(name = \"jansExtUid\")\n    private String[] externalUid;\n\n    @JsonObject\n    @AttributeName(name = \"jansAuthenticator\")\n    private UserAuthenticatorList authenticator\n...\n        public String[] getExternalUid() {\n                return externalUid;\n        }\n\n        public void setExternalUid(String[] externalUid) {\n                this.externalUid = externalUid;\n        }\n\n        public UserAuthenticatorList getAuthenticator() {\n                return authenticator;\n        }\n\n        public void setAuthenticator(UserAuthenticatorList authenticator) {\n                this.authenticator = authenticator;\n        }\n...\n</code></pre> <p><code>UserAuthenticatorList</code> is defined here. It contains list of <code>UserAuthenticator</code> objects. <code>UserAuthenticator</code> is defined here</p> <p>For convenience in 1.1.1 there is new service <code>UserAuthenticator</code>. See it's code here</p> <p>It provides next API methods:</p> <pre><code>        public UserAuthenticatorList getUserAuthenticatorList(SimpleUser user);\n\n        public List&lt;UserAuthenticator&gt; getUserAuthenticatorsByType(SimpleUser user, String type);\n\n        public UserAuthenticator getUserAuthenticatorById(SimpleUser user, String id);\n\n        public void addUserAuthenticator(SimpleUser user, UserAuthenticator userAuthenticator);\n\n        public void removeUserAuthenticator(SimpleUser user, UserAuthenticator userAuthenticator);\n\n        public void removeUserAuthenticator(SimpleUser user, String type);\n\n        public UserAuthenticator createUserAuthenticator(String id, String type);\n\n        public UserAuthenticator createUserAuthenticator(String id, String type, Map&lt;String, Object&gt; custom);\n\n        public String formatExternalUid(String id, String type);\n\n        public boolean checkAndMigrateToAuthenticatorList(SimpleUser user);\n</code></pre> <p>All these methods update both <code>jansAuthenticator</code> and <code>jansExtUid</code> attributes without persisting changes to DB. After calling these methods script should persist user entry. It's expected behaviour because script might update other fields too. Hence it's better to persist all changes in one update request to DB.</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#usage-scenarios","title":"Usage scenarios","text":"","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#a-implementing-2fa-authentication-mechanisms","title":"A. Implementing 2FA authentication mechanisms","text":"<ol> <li> <p>FIDO2 : Authentications using platform authenticators embedded into a person's device or physical USB, NFC or Bluetooth security keys that are inserted into a USB slot of a computer</p> </li> <li> <p>OTP authentication : Authentication mechanism using an app like Google authenticator, FreeOTP or Authy that implements the open standards HOTP and TOTP</p> </li> <li> <p>SMS OTP :</p> </li> <li> <p>Email OTP:</p> </li> </ol>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#b-implementing-multistep-authentication","title":"B. Implementing Multistep authentication","text":"<ol> <li>Redirect to previous step: The script here is an example of how the number of steps can be varied depending on the context or business requirement.</li> </ol>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#c-implementing-social-logins","title":"C. Implementing Social logins","text":"<p>You can use a <code>PersonAuthenticationType</code> script to allow users to sign using credentials from popular Social Identity providers or Inbound Identity Providers like Facebook, Google and Apple. After users authenticate, their Social Identity Provider credentials are provisioned into the Jans-auth server. More on this topic in this article</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#d-proactively-perform-fraud-detection","title":"D. Proactively perform fraud detection","text":"<ol> <li>Impossible travel</li> </ol>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#testing-an-authentication-flow","title":"Testing an authentication flow","text":"<p>An example of a complete URL looks like this -                 ```</p> <pre><code>            https://&lt;your.jans.server&gt;/jans-auth/authorize.htm? \\\n            response_type=code&amp;redirect_uri=https://&lt;your.jans.server&gt;/admin \\\n            &amp;client_id=17b8b82e-b3ec-42a2-bd90-097028a37f3 \\\n            &amp;scope=openid+profile+email+user_name \\\n            &amp;state=faad2cdjfdddjfkdf&amp;nonce=dajdffdfsdcfff\n    ```\n</code></pre> <p>To test , enter the complete URL for authorization in a browser or create a simple webpage with a link that simulates the user sign-in attempt. If the server is configured properly, the first page for the selected authentication method will be displayed to the user.</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#faqs","title":"FAQs","text":"","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#1-how-can-error-messages-be-displayed-on-a-web-page","title":"1. How can error messages be displayed on a web page?","text":"<ol> <li>FacesMessage bean is used for this purpose.         <pre><code>from org.jans.jsf2.message import FacesMessages\nfrom org.jans.service.cdi.util import CdiUtil\nfrom javax.faces.application import FacesMessage\n...\n\nfacesMessages = CdiUtil.bean(FacesMessages)\nfacesMessages.setKeepMessages()\nfacesMessages.add(FacesMessage.SEVERITY_ERROR, \"Please enter a valid username\")\n</code></pre></li> <li>The error will appear in the associated template using the following markup:         <pre><code>...\n&lt;h:messages /&gt;\n...\n</code></pre>         See an example here</li> </ol>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#2-how-is-redirection-to-a-third-party-application-for-authentication-handled-in-a-script","title":"2. How is redirection to a third party application for authentication handled in a script?","text":"<p>For user authentication or consent gathering, there might be a need to redirect to a third-party application to perform some operation and return control to authentication steps of the custom script. Please apply these steps to a person authentication script in such a scenario:</p> <ul> <li>Return from def getPageForStep(self, step, context), a page /auth/method_name/redirect.html ; with content similar to the code snippet below -         <code>def getPageForStep(self, step, context):         return \"/auth/method_name/redirect.html\"</code></li> <li>Contents of redirect.xhtml should take the flow to prepareForStep method         <pre><code>...\n    &lt;f:metadata&gt;\n        &lt;f:viewAction action=\"#{authenticator.prepareForStep}\" if=\"#{not identity.loggedIn}\" /&gt;\n    &lt;/f:metadata&gt;\n</code></pre></li> <li>In method prepareForStep prepare data needed for redirect and perform the redirection to the external service.         <pre><code>def prepareForStep(self, step, context):\n        .....\n    facesService = CdiUtil.bean(FacesService)\n    facesService.redirectToExternalURL(third_party_URL )\n\n    return True\n</code></pre></li> <li>In order to resume flow after the redirection, invoke a similar URL to https://my.gluu.server/postlogin.htm?param=123 from the third party app which takes the flow back to the authenticate method of the custom script. So create an xhtml page postlogin.xhtml which will look like this :         <pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n   \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"\n      xmlns:f=\"http://xmlns.jcp.org/jsf/core\"&gt;\n\n&lt;f:view transient=\"true\" contentType=\"text/html\"&gt;\n    &lt;f:metadata&gt;\n        &lt;f:viewAction action=\"#{authenticator.authenticateWithOutcome}\" /&gt;\n    &lt;/f:metadata&gt;\n&lt;/f:view&gt;\n\n&lt;/html&gt;\n</code></pre> The <code>&lt;f:viewAction action=\"#{authenticator.authenticateWithOutcome}\" /&gt;</code> in step 4 takes us to the authenticate method inside the custom script <code>def authenticate(self, configurationAttributes, requestParameters, step):</code>. Here you can</li> <li>use parameters from request         <pre><code>param = ServerUtil.getFirstValue(requestParameters, \"param-name\"))\n</code></pre></li> <li> <p>perform the <code>state</code> check (state : Opaque value used to maintain state between the request and the callback.)</p> </li> <li> <p>finally, return true or false from this method.</p> </li> </ul>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/person-authentication/#3-why-is-the-browser-taken-to-the-redirect-uri-even-if-the-authentication-was-not-successful","title":"3. Why is the browser taken to the redirect URI even if the authentication was not successful?","text":"<p>By default, regardless of the authentication outcome, the redirect URI will be hit. You can control this behavior through the Authentication Server property errorHandlingMethod. Set its value to <code>internal</code> for the default error page to be shown instead.</p>","tags":["administration","developer","script-catalog","acr_values_supported","2FA","PersonAuthenticationType","acr","weld"]},{"location":"script-catalog/person_authentication/apple-external-authenticator/","title":"Index","text":"","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/apple-external-authenticator/#social-login-with-apple","title":"Social Login with Apple","text":"<p>An out-of-the-box feature, the Sign-in with Apple Authentication script is a <code>PersonAuthenticationType</code> script which enables a user to sign-in using Apple credentials. After users authenticate using their Apple credentials, their Apple credentials are provisioned into the Jans-auth server.</p>","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/apple-external-authenticator/#prerequisites","title":"Prerequisites","text":"<ul> <li>A Jans-auth Server installation</li> <li>The Sign-in with Apple authentication script (included in the default Jans-auth Server distribution);   </li> <li>An Apple developer account.     </li> </ul>","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/apple-external-authenticator/#configurations-at-apple-identity-provider","title":"Configurations at Apple Identity Provider:","text":"<p>You will need to configure a service id, linked to your App identifier. For each website that uses Sign In with Apple, register a services identifier (Services ID) and configure your domain and return URL. 1. Under <code>Certificates, Identifiers and Profiles</code> --&gt; <code>Identifiers</code> --&gt; Click on the <code>+</code> button 2. In the <code>Register a new identifier</code> select <code>Service ID</code> 3. After filling out the description and identifier name, save the Service ID 4. Now edit the saved Service ID and enable the <code>Sign in with Apple</code> checkbox and click <code>Configure</code> button 5. Configure the Janssen's server's callback url <code>https://&lt;your.janssen.server&gt;/postlogin.htm</code> as a <code>Website URL</code></p>","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/apple-external-authenticator/#configure-jans-auth-server","title":"Configure jans-auth server","text":"<p>Configure the custom script:</p>","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/apple-external-authenticator/#properties","title":"Properties","text":"<p>The custom script has the following properties:</p> Property Description Input value <code>apple_client_id</code> Name of Service ID on developer.apple.com. <code>com.company.name</code> <code>apple_jwks</code> Apple\u2019s public JWK to validate Apple Identity Token <code>https://appleid.apple.com/auth/keys</code> <p>To update this setting in Jans persistence, follow this link</p>","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/apple-external-authenticator/#enable-sign-in-with-apple-authentication-script","title":"Enable Sign-in with Apple Authentication script","text":"<p>By default, users will get the default authentication mechanism as specified above. However, using the OpenID Connect acr_values parameter, web and mobile clients can request any enabled authentication mechanism.</p> <p>Obtain the json contents of <code>apple</code> custom script by using a jans-cli command like get-config-scripts-by-type, get-config-scripts-by-inum etc. <pre><code>e.g : /opt/jans/jans-cli/config-cli.py --operation-id get-config-scripts-by-type --url-suffix type:PERSON_AUTHENTICATION , /opt/jans/jans-cli/config-cli.py --operation-id get-config-scripts-by-inum --url-suffix inum:6122281b-b55d-4dd0-8115-b098eeeee2b7\n</code></pre> Update the custom script and change the enabled attribute to <code>true</code> Now Sign-in with Apple is an available authentication mechanism for your Janssen Server. This means that, using OpenID Connect acr_values, applications can now request Apple authentication for users.</p> <p>!!! Note To make sure <code>apple</code> has been enabled successfully, you can check your Janssen's Auth Server OpenID Connect configuration by navigating to the following URL: https:///.well-known/openid-configuration. Find \"acr_values_supported\": and you should see \"apple\".","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/apple-external-authenticator/#make-sign-in-with-apple-script-as-default-authentication-script","title":"Make Sign-in with Apple Script as default authentication script:","text":"<p>Use this link as a reference.</p> <p>Steps: 1. Create a file say <code>apple-auth-default.json</code> with the following contents <pre><code>{\n  \"defaultAcr\": \"apple\"\n}\n</code></pre> 2.Update the default authentication method to Apple Sign-in <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id put-acrs --data /tmp/apple-auth-default.json\n</code></pre></p> <p> NOTE</p> <p>To make sure <code>apple</code> has been enabled successfully as a default authentication method, you can check your Janssen Server's OpenID Connect configuration by navigating to the following URL: <code>https://&lt;hostname&gt;/.well-known/openid-configuration</code>. Find <code>\"acr_values_supported\":</code> and you should see <code>\"apple\"</code>.</p>","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/apple-external-authenticator/#test-the-feature-sign-in-with-apple","title":"Test the feature - Sign-in with Apple","text":"<p>To test , enter the complete URL for authorization in a browser or create a simple webpage with a link that simulates the user sign-in attempt. If the server is configured properly, the first page for the selected authentication method will be displayed to the user.</p> <p>An example of a complete URL looks like this - <pre><code>https://&lt;your.jans.server&gt;/jans-auth/authorize.htm?response_type=code&amp;redirect_uri=https://&lt;your.jans.server&gt;/admin&amp;client_id=&lt;replace_with_inum_client_id&gt;&amp;scope=openid+profile+email+user_name&amp;state=faad2cdjfdddjfkdf&amp;nonce=dajdffdfsdcfff\n</code></pre></p>","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/duo-external-authenticator/","title":"Index","text":""},{"location":"script-catalog/person_authentication/duo-external-authenticator/#integrating-duos-universal-prompt-as-an-authentication-method-in-janssen-server","title":"Integrating DUO's Universal Prompt as an authentication method in Janssen server","text":"<p>Duo Security is a SaaS authentication provider. This document will explain how to use Janssen's Duo interception script to configure the Janssen Server for a two-step authentication process with username and password as the first step, and Duo as the second step. The script invokes the Universal Prompt which is a redesign of Duo\u2019s traditional authentication prompt.</p>"},{"location":"script-catalog/person_authentication/duo-external-authenticator/#authentication-flow","title":"Authentication flow","text":"<pre><code>sequenceDiagram\ntitle Integrating DUO's Universal Prompt as an authentication method in Janssen server\nautonumber 1\nRP-&gt;&gt;Jans AS: Invoke /authorize endpoint\nJans AS-&gt;&gt;RP: Present Username password screen\nRP-&gt;&gt;Jans AS: Submit credentials\nJans AS-&gt;&gt;DUO Security Service: Redirects login request to IDP\nloop n times - (multistep authentication)\nDUO Security Service-&gt;&gt;RP: Present universal prompt screen\nRP-&gt;&gt;DUO Security Service: Present credentials\nend\nDUO Security Service-&gt;&gt;Jans AS: return state, code(duo_code)\nJans AS-&gt;&gt;Jans AS: check state\nJans AS-&gt;&gt;DUO Security Service: send code (duo_code) in exchange for token\nDUO Security Service -&gt;&gt;   Jans AS: token\nJans AS-&gt;&gt;Jans AS: inspect token if (token.getAuth_result().getStatus() == success), \\nmark user as authenticated\nopt if new user\nJans AS-&gt;&gt;Jans AS: 9. Dynamic enrollment or registration\nend\nJans AS-&gt;&gt;RP: 10. write Jans session cookie</code></pre>"},{"location":"script-catalog/person_authentication/duo-external-authenticator/#administrator-prerequisites","title":"Administrator prerequisites","text":"<ul> <li>Duo interception script (included in the default Janssen Server distribution);</li> <li>An account with Duo Security.   </li> </ul>"},{"location":"script-catalog/person_authentication/duo-external-authenticator/#user-prerequisites","title":"User prerequisites","text":"<ul> <li>Users should download the DUO mobile app</li> </ul>"},{"location":"script-catalog/person_authentication/duo-external-authenticator/#configure-duo-account","title":"Configure Duo Account","text":"<ol> <li> <p>Sign up for a Duo account.</p> </li> <li> <p>Log in to the Duo Admin Panel and navigate to Applications.</p> </li> <li> <p>Click Protect an Application and locate Web SDK in the applications list. Click Protect this Application to get your client ID, secret key, and API hostname.</p> </li> </ol> <p>For additional info for the steps refer to Duo's Web SDK 4, check this article.</p>"},{"location":"script-catalog/person_authentication/duo-external-authenticator/#configure-jans-auth-server-as","title":"Configure Jans-auth server (AS)","text":""},{"location":"script-catalog/person_authentication/duo-external-authenticator/#1-add-the-duo-universal-dependency-to-your-jans-auth-server","title":"1. Add the duo-universal Dependency to your jans-auth server","text":"<p>The dependencies have to be added separately as mentioned in the steps below. Using a fat jar (duo-universal-sdk-1.0.3-with-dependencies.jar leads to conflicts.)</p> <ul> <li>[ ] Copy these jar files to the following jans-auth folder inside the Janssen Server chroot: <code>/opt/jans/jetty/jans-auth/custom/libs</code> Dependency jars:           duo-universal-sdk-1.0.3.jar ,                  converter-jackson-2.1.0.jar ,                  java-jwt-3.3.0.jar,                  logging-interceptor-3.3.1.jar,                  lombok-1.18.16.jar,                  retrofit-2.5.0.jar,                  okio-2.9.0.jar,                  okhttp-3.12.0.jar,                 * kotlin-stdlib-1.4.21.jar </li> <li>[ ] Edit /opt/jans/jetty/jans-auth/webapps/jans-auth.xml and add the following line: <code>&lt;Set name=\"extraClasspath\"&gt;./custom/libs/duo-universal-sdk-1.0.3.jar,./custom/libs/converter-jackson-2.1.0.jar,./custom/libs/java-jwt-3.3.0.jar,./custom/libs/logging-interceptor-3.3.1.jar,./custom/libs/lombok-1.18.16.jar,./custom/libs/retrofit-2.5.0.jar,./custom/libs/okio-2.9.0.jar,./custom/libs/okhttp-3.12.0.jar,./custom/libs/kotlin-stdlib-1.4.21.jar&lt;/Set&gt;</code></li> <li>[ ] Restart the <code>jans-auth</code> service</li> </ul>"},{"location":"script-catalog/person_authentication/duo-external-authenticator/#2-add-custom-script","title":"2. Add custom script","text":"<ol> <li>Create <code>cs.json</code> with the contents of a CUSTOM script. To do that, run the following command. <pre><code>/opt/jans/jans-cli/config-cli.py --schema CustomScript &gt; /tmp/cs.json\n</code></pre></li> <li>Edit the file's contents to reflect the addition of the duo custom script. </li> <li>Set enabled flag <code>true</code></li> <li> <p>Configure the api_hostname, client_id and client_secret      |  Property    |Status     |   Description |   Example     |      |-----------------------|---------------|-----------------------|-----------------------|      |api_hostname      |Mandatory     |URL of the Duo API Server|api-random.duosecurity.com|      |client_id     |Mandatory    |Value from the Duo application using Web SDK 4 that was registered using DUO Admin console|DI3ICTTJKLL8PPPNGH7YI|      |client_secret |Mandatory|Value from the Duo application using Web SDK 4 that was registered using DUO Admin console|eEbJdi3hg42zxyFYbHArU5RuioPP|   </p> </li> <li> <p><code>name</code> field should reflect the use case</p> </li> <li><code>script_type</code> should be <code>PERSON_AUTHENTICATION</code></li> </ol> <p><pre><code>{\n  \"dn\": null,\n  \"inum\": null,\n  \"name\": \"duo\",\n  \"aliases\": [],\n  \"description\": \"DUO's custom script\",\n  \"script\": \"_file /root/script.py\",\n  \"scriptType\": \"PERSON_AUTHENTICATION\",\n  \"programmingLanguage\": \"JYTHON\",\n  \"moduleProperties\": {\n    \"value1\": null,\n    \"value2\": null,\n    \"description\": null\n  },\n  \"configurationProperties\": \n\n[{\n    \"value1\": \"api_hostname\",\n    \"value2\": \"api-random.duosecurity.com\",\n    \"description\": \"URL of the Duo API Server\",\n    \"hide\": true\n  },\n{\n    \"value1\": \"client_id\",\n    \"value2\": \"DI3ICTTJKLL8PPPNGH7YI\",\n    \"description\": \"Value from the Duo application using Web SDK 4 that was registered using DUO Admin console\",\n    \"hide\": true\n  },\n  {\n    \"value1\": \"client_secret\",\n    \"value2\": \"eEbJdi3hg42zxyFYbHArU5RuioPP\",\n    \"description\": \"Value from the Duo application using Web SDK 4 that was registered using DUO Admin console\",\n    \"hide\": true\n  }\n]\n,\n  \"level\": \"integer\",\n  \"revision\": 0,\n  \"enabled\": true,\n  \"scriptError\": {\n    \"raisedAt\": null,\n    \"stackTrace\": null\n  },\n  \"modified\": false,\n  \"internal\": false\n}\n</code></pre> 3. Add the custom script  <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id post-config-scripts --data /tmp/cs.json\n</code></pre></p> <p>Now Duo is an available authentication mechanism for your Janssen Server. This means that, using OpenID Connect <code>acr_values</code>, applications can now request Duo authentication for users.</p> <p>Note</p> <p>To make sure Duo has been enabled successfully, you can check your Janssen Server's OpenID Connect configuration by navigating to the following URL: <code>https://&lt;hostname&gt;/.well-known/openid-configuration</code>. Find <code>\"acr_values_supported\":</code> and you should see <code>\"duo\"</code>.</p>"},{"location":"script-catalog/person_authentication/duo-external-authenticator/#make-duo-the-default-authentication-mechanism","title":"Make Duo the Default Authentication Mechanism","text":"<p>For CURL commands, use this link as a reference.</p> <p>Steps: 1. Create a file say <code>duo-auth-default.json</code> with the following contents <pre><code>{\n  \"defaultAcr\": \"duo\"\n}\n</code></pre> 2.Update the default authentication method to Google Sign-in <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id put-acrs --data /tmp/duo-auth-default.json\n</code></pre> NOTE</p> <p>To make sure <code>duo</code> has been enabled successfully as a default authentication method, you can check your Janssen Server's OpenID Connect configuration by navigating to the following URL: <code>https://&lt;hostname&gt;/.well-known/openid-configuration</code>. Find <code>\"acr_values_supported\":</code> and you should see <code>\"duo\"</code>.</p>"},{"location":"script-catalog/person_authentication/duo-external-authenticator/#test-the-feature","title":"Test the feature","text":"<p>To test , enter the complete URL for authorization in a browser or create a simple web page with a link that simulates the user sign-in attempt. If the server is configured properly, the first page for the selected authentication method will be displayed to the user.</p> <p>An example of a complete URL looks like this - <pre><code>https://&lt;your.jans.server&gt;/jans-auth/authorize.htm?response_type=code&amp;redirect_uri=https://&lt;your.jans.server&gt;/admin&amp;client_id=&lt;replace_with_inum_client_id&gt;&amp;scope=openid+profile+email+user_name&amp;state=faad2cdjfdddjfkdf&amp;nonce=dajdffdfsdcfff\n</code></pre></p>"},{"location":"script-catalog/person_authentication/fido2-external-authenticator/","title":"FIDO2","text":"<p>FIDO 2.0 (FIDO2) , an open authentication standard that enables people to leverage common devices to authenticate to online services in both mobile and desktop environments. The Janssen server includes a FIDO2 server implementation. This enables authentications by using  platform authenticators embedded into a person's device or  physical USB, NFC or Bluetooth security keys that are inserted into a USB slot of a computer.</p> <p>FIDO2 is comprised of the W3C\u2019s Web Authentication specification (WebAuthn) and FIDO\u2019s corresponding Client-to-Authenticator Protocol (CTAP). WebAuthn defines a standard web API that can be built into browsers and related web platform infrastructure to enable online services to use FIDO Authentication. CTAP enables external devices such as mobile handsets or FIDO Security Keys to work with WebAuthn and serve as authenticators to desktop applications and web services.</p> <p>This document explains how to use the Janssen Auth Server's built-in FIDO2 interception script to implement a two-step, two-factor authentication (2FA) with username / password as the first step, and any FIDO2 device as the second step.</p>"},{"location":"script-catalog/person_authentication/fido2-external-authenticator/#prerequisites","title":"Prerequisites","text":"<ul> <li>A Janssen Server (installation instructions)      </li> <li>FIDO2 interception script (included in the default Janssen Server distribution);     </li> <li>At least one FIDO2 device for testing, like one of the devices listed below.</li> </ul>"},{"location":"script-catalog/person_authentication/fido2-external-authenticator/#fido2-devices","title":"FIDO2 devices","text":"<p>Some well-known FIDO2 devices and manufacturers include:</p> <ul> <li>Yubico </li> <li>Vasco DIGIPASS SecureClick </li> <li>HyperFIDO </li> <li>Feitian Technologies </li> <li>AuthenTrend</li> <li>Apple's built-in Touch ID</li> </ul> <p>Purchase FIDO2 devices on Amazon. Or, check FIDO's certified products for a comprehensive list of FIDO2 devices (sort by <code>Specification</code> == <code>FIDO2</code>).</p>"},{"location":"script-catalog/person_authentication/fido2-external-authenticator/#properties","title":"Properties","text":"<p>The script has the following properties</p> Property Description Example fido2_server_uri URL of the Janssen's FIDO2 server <code>https://idp.mycompany.com</code>"},{"location":"script-catalog/person_authentication/fido2-external-authenticator/#enable-fido2-script","title":"Enable FIDO2 script","text":"<p>By default, users will get the default authentication mechanism as specified above. However, using the OpenID Connect acr_values parameter, web and mobile clients can request any enabled authentication mechanism.</p> <ol> <li>Obtain the json contents of <code>fido2</code> custom script by using a jans-cli command like <code>get-config-scripts-by-type</code>, <code>get-config-scripts-by-inum</code> etc.</li> </ol> <p>e.g : <code>/opt/jans/jans-cli/config-cli.py --operation-id get-config-scripts-by-type --url-suffix type:PERSON_AUTHENTICATION</code> , <code>/opt/jans/jans-cli/config-cli.py --operation-id get-config-scripts-by-inum --url-suffix inum:6122281b-b55d-4dd0-8115-b098eeeee2b7</code></p> <ol> <li>Update the custom script and change the <code>enabled</code> attribute to <code>true</code> </li> </ol> <p>Now FIDO2 is an available authentication mechanism for your Janssen Server. This means that, using OpenID Connect <code>acr_values</code>, applications can now request FIDO2 authentication for users.</p> <p>Note</p> <p>To make sure FIDO2 has been enabled successfully, you can check your Janssen's Auth Server OpenID Connect configuration by navigating to the following URL: <code>https://&lt;hostname&gt;/.well-known/openid-configuration</code>. Find <code>\"acr_values_supported\":</code> and you should see <code>\"fido2\"</code>.</p>"},{"location":"script-catalog/person_authentication/fido2-external-authenticator/#enable-fido2-script-as-default-authentication-script","title":"Enable FIDO2 Script as default authentication script:","text":"<p>Use this link as a reference. Follow the steps below to enable FIDO2 authentication: 1. Create a file say <code>fido2-auth-default.json</code> with the following contents <pre><code>{\n  \"defaultAcr\": \"fido2\"\n}\n</code></pre> 2.Update the default authentication method to <code>fido2</code> <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id put-acrs --data /tmp/fido2-auth-default.json\n</code></pre></p> <p>Note</p> <p>If FIDO2 is set as a default authentication mechanism users will not be able to access the protected resource(s) while using a mobile device or a browser that does not support FIDO2 (e.g. Internet Explorer).</p>"},{"location":"script-catalog/person_authentication/fido2-external-authenticator/#test-the-feature","title":"Test the feature","text":"<p>To test, enter the complete URL for authorization in a browser or create a simple webpage with a link that simulates the user sign-in attempt. If the server is configured properly, the first page for the selected authentication method will be displayed to the user.</p> <p>An example of a complete URL looks like this - <pre><code>https://&lt;your.jans.server&gt;/jans-auth/authorize.htm?response_type=code&amp;redirect_uri=https://&lt;your.jans.server&gt;/admin&amp;client_id=&lt;replace_with_inum_client_id&gt;&amp;scope=openid+profile+email+user_name&amp;state=faad2cdjfdddjfkdf&amp;nonce=dajdffdfsdcfff\n</code></pre></p>"},{"location":"script-catalog/person_authentication/fido2-external-authenticator/#fido2-login-page","title":"FIDO2 login page","text":"<p>Below is an illustration of the Janssen Server's default FIDO2 login page:</p> <p></p> <p>The design is being rendered from the FIDO2 xhtml page. To customize the look and feel of this page, follow the customization guide.</p>"},{"location":"script-catalog/person_authentication/fido2-external-authenticator/#using-fido2-tokens","title":"Using FIDO2 tokens","text":""},{"location":"script-catalog/person_authentication/fido2-external-authenticator/#credential-enrollment","title":"Credential enrollment","text":"<p>FIDO2 device enrollment happens during the first authentication attempt.</p>"},{"location":"script-catalog/person_authentication/fido2-external-authenticator/#subsequent-authentications","title":"Subsequent authentications","text":"<p>All subsequent FIDO2 authentications for that user account will require the enrolled FIDO2 key.</p>"},{"location":"script-catalog/person_authentication/fido2-external-authenticator/#fido2-credential-management","title":"FIDO2 credential management","text":"<p>A user's FIDO2 devices can be removed by a Janssen administrator in LDAP under the user entry as shown in the below screenshot.</p> <p> Diagram source in mermaid.live <pre><code>graph TD\n\n    A[ou=jans] --&gt; K(ou=people)\n    K --&gt; K1[inum=....]\n    K1 --&gt; K11[ou=fido2_register]\n    K11 --&gt; K111[jansId=....]\n    K11 --&gt; K112[jansId=....]\n    K11 --&gt; K112[jansId=....]\n\n    K1 --&gt; K12[ou=fido2_auth]\n    K12 --&gt; K121[jansId=....]\n    K12 --&gt; K122[jansId=....]\n    K12 --&gt; K123[jansId=....]\n\n    K --&gt; K2[inum=....]\n    K2 --&gt; K21[ou=fido2_register]\n    K21 --&gt; K211[jansId=....]\n    K21 --&gt; K212[jansId=....]\n    K21 --&gt; K212[jansId=....]\n\n    K2 --&gt; K22[ou=fido2_auth]\n    K22 --&gt; K221[jansId=....]\n    K22 --&gt; K222[jansId=....]\n    K22 --&gt; K223[oxId=....]\n\n    K --&gt; K3[inum=....]\n    K3 --&gt; K31[ou=fido2_register]\n    K31 --&gt; K311[jansId=....]\n    K31 --&gt; K312[jansId=....]\n    K31 --&gt; K312[jansId=....]\n\n    K3 --&gt; K32[ou=fido2_auth]\n    K32 --&gt; K321[jansId=....]\n    K32 --&gt; K322[jansId=....]\n    K32 --&gt; K323[jansId=....]\n</code></pre></p>"},{"location":"script-catalog/person_authentication/fido2-external-authenticator/#fido2-discovery-endpoint","title":"FIDO2 discovery endpoint","text":"<p>A discovery document for FIDO2 is published by the Janssen Server at: https://your.hostname/.well-known/fido2-configuration This document specifies the URL of the registration and authentication endpoints.</p>"},{"location":"script-catalog/person_authentication/forgot_password/","title":"Forgot Password 2FA Token Interception Script","text":""},{"location":"script-catalog/person_authentication/forgot_password/#description","title":"Description","text":"<p>This script is a 2 in 1. It can be used to enable user to reset its password or to enable 2FA sending a token to user's email :</p> <p>How they work:</p>"},{"location":"script-catalog/person_authentication/forgot_password/#forgot-password","title":"Forgot Password","text":"<ul> <li>Step 1: User enters e-mail and if e-mail exists, user receive a token via email</li> <li>Step 2: User enters token received by e-mail</li> <li>Step 3: User enters new password</li> </ul>"},{"location":"script-catalog/person_authentication/forgot_password/#emai-2fa","title":"Emai 2FA","text":"<ul> <li>Step 1: User enters username and password</li> <li>Step 2: User enters token received by e-mail</li> </ul>"},{"location":"script-catalog/person_authentication/forgot_password/#instalation","title":"Instalation","text":"<ul> <li>Make sure you have your SMTP settings correctly Gluu Server - Navigate to Configuration &gt; Organization Configuration &gt; SMTP Server Configuration</li> <li>Set up the script function (Forgot Password or Email 2FA) - Navigate to Configuration &gt; Manage Custom Scripts, choose the script and set a custom attribute with key <code>SCRIPT_FUNCTION</code> and value <code>forgot_password</code> for Forgot Password mode, or <code>email_2FA</code> for Email 2FA mode.</li> <li>Enable the custom script. </li> </ul> <p>Please notice the xhtml files for this script are currently located at <code>oxAuth/Server/src/main/webapp/auth/forgot_password/</code></p> <p>Note: If you want to use both scripts, you'll need to copy it and change the custom attribute from the copied script.</p>"},{"location":"script-catalog/person_authentication/google-external-authenticator/","title":"Index","text":"","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/google-external-authenticator/#social-login-with-google","title":"Social Login with Google","text":"<p>An out-of-the-box feature, the Google Authentication script is a <code>PersonAuthenticationType</code> script which enables a user to sign-in using Google credentials. Google's OAuth 2.0 APIs are used for this. After users authenticate using their Google credentials, their Google credentials are provisioned into the Jans-auth server.</p>","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/google-external-authenticator/#prerequisites","title":"Prerequisites","text":"<ul> <li>A Jans-auth Server (installation instructions here)    </li> <li>The Google authentication script (included in the default Jans-auth Server distribution);   </li> <li>A Google account.     </li> <li>Google API jars namely google-api-client, google-oauth-client and google-http-client-jackson2 added to jans-auth-server</li> </ul>","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/google-external-authenticator/#configuring-google-api-keys","title":"Configuring Google API keys:","text":"<p>On the Google side, you need OAuth 2.0 credentials, including a client ID and client secret, to authenticate users and gain access to Google's APIs. The following steps explain how to create credentials for your project. Your applications can then use the credentials to access APIs that you have enabled for that project.</p> <ol> <li>Go to the Credentials page.</li> <li>Click Create credentials &gt; OAuth client ID.</li> <li>Select the Web application application type.</li> <li>Name your OAuth 2.0 client and click Create</li> <li>Configure Authorized redirect URIs , click ADD URI to add the Janssen's <code>https://my.auth.server/postlogin.htm</code> where the control returns back to the AS.</li> <li>Configure Authorized JavaScript origins, click ADD URI to add Janssen's FQDN <code>https://my.auth.server</code> because we are using Google Client JS and it needs valid JS origin.</li> </ol>","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/google-external-authenticator/#configure-jans-auth-server","title":"Configure jans-auth server","text":"","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/google-external-authenticator/#download-google-client-json-file","title":"Download Google Client JSON file","text":"<p>On the following page, https://console.cloud.google.com/apis/credentials, you will see a table containing your recently created client. Click on the download button and download the JSON file containing details of the Client. Place this file in <code>/etc/certs/google_client_secret.json</code></p>","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/google-external-authenticator/#add-google-libraries-to-jans-auth-server","title":"Add Google libraries to jans-auth-server","text":"<ol> <li>Copy the library files to <code>/opt/jans/jetty/jans-auth/custom/libs</code></li> <li><code>cd /opt/jans/jetty/jans-auth/custom/libs</code></li> <li><code>wget https://repo1.maven.org/maven2/com/google/api-client/google-api-client/1.33.2/google-api-client-1.33.2.jar -O google-api-client-1.33.2.jar</code></li> <li><code>wget https://repo1.maven.org/maven2/com/google/oauth-client/google-oauth-client/1.33.1/google-oauth-client-1.33.1.jar -O google-oauth-client-1.33.1.jar</code></li> <li> <p><code>wget https://repo1.maven.org/maven2/com/google/http-client/google-http-client-jackson2/1.41.5/google-http-client-jackson2-1.41.5.jar -O google-http-client-jackson2-1.41.5.jar</code></p> </li> <li> <p>Edit <code>/opt/jans/jetty/jans-auth/webapps/oxauth.xml</code> and add the following line:</p> <pre><code>&lt;Set name=\"extraClasspath\"&gt;./custom/libs/google-oauth-client-1.33.1.jar,./custom/libs/google-api-client-1.33.2.jar,./custom/libs/google-http-client-jackson2-1.41.5.jar&lt;/Set&gt;&lt;/Configure&gt;\n</code></pre> </li> <li> <p>Restart the <code>jans-auth</code> service    <code>systemctl status jans-auth</code></p> </li> </ol>","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/google-external-authenticator/#properties","title":"Properties","text":"<p>The custom script has the following properties:</p> Property Description Input value <code>google_creds_file</code> Details of the client created on https://console.cloud.google.com/apis/credentials. See this step. <code>/etc/certs/google_client_secret.json</code> <p>To update this setting in Jans persistence, follow this link</p>","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/google-external-authenticator/#enable-sign-in-with-google-authentication-script","title":"Enable Sign-in with Google Authentication script","text":"<p>By default, users will get the default authentication mechanism as specified above. However, using the OpenID Connect acr_values parameter, web and mobile clients can request any enabled authentication mechanism.</p> <p>Obtain the json contents of <code>google</code> custom script by using a jans-cli command like get-config-scripts-by-type, get-config-scripts-by-inum etc. <pre><code>e.g : /opt/jans/jans-cli/config-cli.py --operation-id get-config-scripts-by-type --url-suffix type:PERSON_AUTHENTICATION , /opt/jans/jans-cli/config-cli.py --operation-id get-config-scripts-by-inum --url-suffix inum:6122281b-b55d-4dd0-8115-b098eeeee2b7\n</code></pre> Update the custom script and change the enabled attribute to <code>true</code> Now Google is an available authentication mechanism for your Janssen Server. This means that, using OpenID Connect acr_values, applications can now request Google authentication for users.</p> <p>!!! Note To make sure <code>google</code> has been enabled successfully, you can check your Janssen's Auth Server OpenID Connect configuration by navigating to the following URL: https:///.well-known/openid-configuration. Find \"acr_values_supported\": and you should see \"google\".","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/google-external-authenticator/#make-sign-in-with-google-script-as-default-authentication-script","title":"Make Sign-in with Google Script as default authentication script:","text":"<p>Use this link as a reference.</p> <p>Steps: 1. Create a file say <code>google-auth-default.json</code> with the following contents <pre><code>{\n  \"defaultAcr\": \"google\"\n}\n</code></pre> 2.Update the default authentication method to Google Sign-in <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id put-acrs --data /tmp/google-auth-default.json\n</code></pre></p> <p> NOTE</p> <p>To make sure <code>google</code> has been enabled successfully as a default authentication method, you can check your Gluu Server's OpenID Connect configuration by navigating to the following URL: <code>https://&lt;hostname&gt;/.well-known/openid-configuration</code>. Find <code>\"acr_values_supported\":</code> and you should see <code>\"google\"</code>.</p>","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/google-external-authenticator/#test-the-feature-sign-in-with-google","title":"Test the feature - Sign-in with Google","text":"<p>To test , enter the complete URL for authorization in a browser or create a simple webmapage with a link that simulates the user sign-in attempt. If the server is configured properly, the first page for the selected authentication method will be displayed to the user.</p> <p>An example of a complete URL looks like this - <pre><code>https://&lt;your.jans.server&gt;/jans-auth/authorize.htm?response_type=code&amp;redirect_uri=https://&lt;your.jans.server&gt;/admin&amp;client_id=&lt;replace_with_inum_client_id&gt;&amp;scope=openid+profile+email+user_name&amp;state=faad2cdjfdddjfkdf&amp;nonce=dajdffdfsdcfff\n</code></pre></p>","tags":["administration","recipes"]},{"location":"script-catalog/person_authentication/other/acr_router/","title":"Index","text":"<p>This is a person authentication module for oxAuth that enables user to forward authorization endpoint with a different acr_values as specified in the Custom property Key.</p> <p>1) new_acr_value - It's mandatory property. It's the new acr_value where user will be routed. Please make sure acr_value where user will be redirected is enabled and shown avaialble in acr_values_supported /.well-known/openid-configuration.</p>"},{"location":"script-catalog/person_authentication/other/allowed_countries/","title":"Index","text":"<p>This is a person authentication module for oxAuth to allow access based on the user location.</p> <p>1) allowed_countries = short Country codes (eg US,UK,IN) separated by comma which will be allowed to access</p>"},{"location":"script-catalog/person_authentication/other/azuread/","title":"Index","text":""},{"location":"script-catalog/person_authentication/other/azuread/#azure-ad-authentication","title":"Azure AD Authentication","text":"<p>This is a person authentication module for oxAuth that allows user to authenticate against Azure AD.</p> <p>Required Custom property (key/value) - 1) azure_tenant_id  (Azure AD's Tenant ID) 2) azure_client_id 3) azure_client_secret 4) azure_ad_attributes_list = oid,given_name,family_name,upn 5) gluu_ldap_attributes_list = uid,givenName,sn,mail</p> <p>Note: An administrator of the Azure AD portal (portal.azure.com) needs to create an application for Gluu Server in the azure portal (with necessary permissions) and configure the client id and client secret in the Custom properties of this Jython script.</p>"},{"location":"script-catalog/person_authentication/other/basic.client_group/","title":"Index","text":"<p>This person authentication module for oxAuth allows to restrict access to RP for specific user groups. It allows to define configuration for each client.</p> <p>This module has one mandatory property <code>configuration_file</code>. It's path to JSON configuration file    Example: /etc/certs/client_group.json    Example content of this file:</p> <p>{    \"client_1\":{       \"client_inum\":\"client_inum_1\",       \"user_group\":[          \"group_dn_1\",          \"group_dn_2\"       ]    },    \"client_2\":{       \"client_inum\":\"client_inum_2\",       \"user_group\":[          \"group_dn_1\",          \"group_dn_2\"       ]    } }</p> <p>Also it's possible to define how it should work when there is no configuration for specific client. This is controlled via property: <code>allow_default_login</code>: true/false</p>"},{"location":"script-catalog/person_authentication/other/basic.external_logout/","title":"Index","text":"<p>This is person authentication module for oxAuth which do basic authentication and at logout do redirect to external service.</p> <p>This module has no properties.</p>"},{"location":"script-catalog/person_authentication/other/basic.lock.account/","title":"Index","text":""},{"location":"script-catalog/person_authentication/other/basic.lock.account/#basic-lock-account","title":"Basic Lock Account","text":"<p>Script contents here</p> <p>This is a person authentication script for jans-auth-server which does basic authentication. It looks user account after specified number of unsuccessful login attempts.</p> <p>This module has 2 properties:</p> <p>1) invalid_login_count_attribute - Specify attribute where script stores count of invalid number of login attemps    Default value: jansCountInvalidLogin</p> <p>2) maximum_invalid_login_attemps - Specify how many times user can enter invalid password before application will lock account    Allowed values: integer value greater that 0    Example: 3    Default value: 3 3) lock_expiration_time - Specify the time in seconds when lock will be expired    Default value: 180</p>"},{"location":"script-catalog/person_authentication/other/basic.multi_auth_conf/","title":"Index","text":"<p>This is person authentication module for Jans-Auth which allows Jans/Flex to use multiple backends for user authentication.</p>"},{"location":"script-catalog/person_authentication/other/basic.multi_auth_conf/#installation","title":"Installation","text":"<p>This list of steps needed to do to enable Basic Multi person authentication module.</p> <ol> <li> <p>Prepare authentication configuration file <code>/etc/certs/multi_auth_conf.json</code>. There is format description and sample configuration below. Make sure to keep permission \"jetty:root\" for this file. </p> </li> <li> <p>servers: hostname/IP address with port of LDAP/AD servers.</p> </li> <li>bindDN: bindDN username</li> <li>bindPassword: password for bindDN<ul> <li>'bindPassword' should be the base64 encoded of password text</li> <li>You can take the advantage of 'encode.py' script to encode/decode your password.</li> <li>'encode.py' is available inside Jans ( location: /opt/jans/bin/ )</li> </ul> </li> <li>useSSL: for 1636/636, it will be \"true\", otherwise \"false\"</li> <li>maxConnections: total number of concurrent connection to LDAP/AD servers.</li> <li>baseDN: where users are located.</li> <li>loginAttributes: Primary attribute of remote LDAP/AD server or localhost:1636</li> <li>localLoginAttributes: Primary attribute of Jans/Flex.</li> </ol> <pre><code>{\n  \"ldap_configuration\":\n  [\n     {\n        \"configId\":\"ad_1\",\n        \"servers\":[\"localhost:1636\"],\n        \"bindDN\":\"cn=directory manager\",\n        \"bindPassword\":\"encoded_pass\",\n        \"useSSL\":true,\n        \"maxConnections\":3,\n        \"baseDNs\":[\"ou=people,o=jans\"],\n        \"loginAttributes\":[\"uid\"],\n        \"localLoginAttributes\":[\"uid\"]\n     },\n     {\n        \"configId\":\"ad_2\",\n        \"servers\":[\"sample.ad.test:636\"],\n        \"bindDN\":\"cn=directory manager\",\n        \"bindPassword\":\"encoded_pass\",\n        \"useSSL\":true,\n        \"maxConnections\":3,\n        \"baseDNs\":[\"ou=people,o=gluu\"],\n        \"loginAttributes\":[\"sAMAccountName\"],\n        \"localLoginAttributes\":[\"uid\"]\n     }\n  ]\n}\n</code></pre> <ol> <li> <p>Enable 'basic_multi_auth' in Admin-UI: </p> </li> <li> <p>Log into Admin-UI as admin user</p> </li> <li><code>Admin</code> &gt; <code>Scripts</code></li> <li>Click on \"+\" sign to add new script ( to right corner )</li> <li>Add new script:</li> <li>Name: basic_multi_auth</li> <li>Description: Basic Multi Auth</li> <li>Select SAML ACRS: nothing special to select for testing purpose</li> <li>Script Type: Person Authentication</li> <li>Programming Lanugage: Jython</li> <li>Location Type: Database</li> <li>Interactive: nothing special to select for testing purpose.</li> <li>Level: nothing special to add for testing purpose.</li> <li>Custom Properties:<ul> <li>auth_configuration_file: /etc/certs/multi_auth_conf.json</li> </ul> </li> <li>Module Propertiest: db</li> <li>Script: get script and paste it here.</li> <li> <p>Enable it and wait for 2 mins.</p> </li> <li> <p>Test</p> </li> </ol> <p>Jans Tarp can be easily used to test new ACR. Here is a howto video: https://www.loom.com/share/6bfe8c5556a94abea05467e3deead8a2?sid=b65c81d9-c1a1-475c-b89b-c105887d31ad</p>"},{"location":"script-catalog/person_authentication/other/basic.multi_login/","title":"Index","text":"<p>This is person authentication modules for oxAuth which allows to use several attributes as user name.</p>"},{"location":"script-catalog/person_authentication/other/basic.multi_login/#install","title":"Install","text":"<p>This list of steps needed to do to enable Basic Multi Login person authentication module.</p> <ol> <li> <p>This module depends on python libraries. In order to use it we need to install Jython. Please use next articles to proper Jython installation:</p> <ul> <li>Installation notest: http://ox.gluu.org/doku.php?id=oxtauth:customauthscript#jython_installation_optional</li> <li>Jython integration: http://ox.gluu.org/doku.php?id=oxtauth:customauthscript#jython_python_integration</li> </ul> </li> <li> <p>Copy shared required python libraries from ../shared_libs folder to $CATALINA_HOME/conf/python folder.</p> </li> <li> <p>Confire new custom module in oxTrust:</p> <ul> <li>Log into oxTrust with administrative permissions.</li> <li>Open \"Configuration\u2192Manage Custom Scripts\" page.</li> <li>Select \"Person Authentication\" tab.</li> <li>Click on \"Add custom script configuration\" link.</li> <li>Enter name = basic_multi_login</li> <li>Enter level = 0-100 (priority of this method).</li> <li>Select usage type \"Interactive\".</li> <li>Add custom required and optional properties which specified in README.txt.</li> <li>Copy/paste script from BasicMultiLoginExternalAuthenticator.py.</li> <li>Activate it via \"Enabled\" checkbox.</li> <li>Click \"Update\" button at the bottom of this page.</li> </ul> </li> <li> <p>Configure oxAuth to use Basic Multi Login authentication by default:</p> <ul> <li>Log into oxTrust with administrative permissions.</li> <li>Open \"Configuration\u2192Manage Authentication\" page.</li> <li>Scroll to \"Default Authentication Method\" panel. Select \"basic_multi_login\" authentication mode.</li> <li>Click \"Update\" button at the bottom of this page.</li> </ul> </li> <li> <p>Try to log in using Basic Multi Login authentication method:</p> <ul> <li>Wait 30 seconds and try to log in again. During this time oxAuth reload list of available person authentication modules.</li> <li>Open second browser or second browsing session and try to log in again. It's better to try to do that from another browser session because we can return back to previous authentication method if something will go wrong.</li> </ul> </li> </ol> <p>There are log messages in this custom authentication script. In order to debug this module we can use command like this: tail -f /opt/tomcat/logs/wrapper.log | grep \"Basic (multi login)\"</p>"},{"location":"script-catalog/person_authentication/other/basic.multi_login/#properties","title":"Properties","text":"<p>1) login_attributes_list - Comma separated list of attribute names. Specify list of IdP attributes which this module should use to map to local attributes.    It's optional property.    The count of attributes in this property should be equal to count attributes in local_login_attributes_list property.    Example: uid, mail</p> <p>2) local_login_attributes_list - Comma separated list of attribute names. Specify list of local attributes mapped from IdP attributes.    It's optional property.    The count of attributes in this property should be equal to count attributes in login_attributes_list property.    Example: uid, mail</p>"},{"location":"script-catalog/person_authentication/other/basic.multiple_test_email_addresses/","title":"Index","text":"<p>This is person authentication modules for oxAuth which allows the use of multiple test addresses that lead to a single email account. e.g. Everything addressed to myaccount+.*@gmail.com goes to myaccount@gmail.com. They are all the same account. Read this blog for understanding the feature better - http://www.codestore.net/store.nsf/unid/BLOG-20111201-0411</p> <p>oxAuth issue - https://github.com/GluuFederation/oxAuth/issues/1220</p>"},{"location":"script-catalog/person_authentication/other/basic.one_session/","title":"Index","text":"<p>This person authentication module for oxAuth which allows to restrict access to RP for one user session.</p>"},{"location":"script-catalog/person_authentication/other/basic.password_expiration/","title":"Password Expiration","text":"<p>The script would ask the user to update password after 90 days.</p>"},{"location":"script-catalog/person_authentication/other/basic.reset_to_step/","title":"Index","text":"<p>This is person authentication module for oxAuth which do basic authentication. This is 3 steps authentication which supports rediect to previous authentication step. For demo purposes it asks user to pass basic authentication 3 times. After unsuccessful login attempt it forward user to previous step.</p> <p>This module hasn't properties.</p>"},{"location":"script-catalog/person_authentication/other/bioid/","title":"Integrating BioID's biometric authentication with Casa","text":""},{"location":"script-catalog/person_authentication/other/bioid/#bioid-web-service","title":"BioID Web Service","text":"<p>BioID Web Service is a \"Biometrics as a service\" provider. This document will explain how to use Janssen Server BioID interception script along with a Plugin in Casa to enroll a user's biometric traits and use it is as a method for 2FA.</p> <p>In order to use this authentication mechanism your organization will need to register for a BioID account.</p>"},{"location":"script-catalog/person_authentication/other/bioid/#prerequisites","title":"Prerequisites","text":"<ul> <li>A Janssen Server</li> <li>BioID interception script.</li> <li>An account with BioID.</li> </ul>"},{"location":"script-catalog/person_authentication/other/bioid/#configure-bioid-account","title":"Configure BioID Account","text":"<ol> <li> <p>Sign up for a BioID account.</p> </li> <li> <p>Upon registration, you will recieve an email with the instance name (listed as STORAGE in Janssen Server's BioID authentication script), partition number(listed as PARTITION in Janssen Server's BioID authentication script).</p> </li> <li> <p>As the owner of this instance, you are entitled to access BWS Portal at https://bwsportal.bioid.com using the account associated with your email.    With the BWS Portal, you can do the following:    a. View your trial information such as your credentials (e.g. your client certificate), enrolled classes, BWS logs and more.    b. Create your App ID and App secret, under \"Web API keys\".</p> </li> </ol>"},{"location":"script-catalog/person_authentication/other/bioid/#bioid-documentation","title":"BioID Documentation","text":"<ol> <li>You can find all API reference at https://developer.bioid.com/bwsreference.</li> <li>Lots of useful information about BWS is available at https://developer.bioid.com/blog.</li> <li>For liveness detection, you will find information about motion trigger helpful: https://developer.bioid.com/app-developer-guide/bioid-motion-detection</li> </ol>"},{"location":"script-catalog/person_authentication/other/bioid/#script-configurations","title":"Script configurations","text":"<p>Log into oxTrust, and go to <code>Configuration</code> &gt; <code>Person Authentication scripts</code> &gt; <code>Add custom script configuration</code>.</p>"},{"location":"script-catalog/person_authentication/other/bioid/#script-contents","title":"Script contents","text":"<p>Download this file and copy its contents in the <code>Script</code> form field.</p>"},{"location":"script-catalog/person_authentication/other/bioid/#properties","title":"Properties","text":"<p>The mandatory properties in the BioID authentication script are as follows |   Property    |   Description |   Example     | |---------------|---------------|---------------| |ENDPOINT       |URL of the BioID Web Service|<code>https://bws.bioid.com/extension/</code>| |APP_IDENTIFIER     |API key |<code>c20b04cc-776a-45ed-7a1f-06347f8edf6c</code>| |APP_SECRET     |API secret |<code>sTGB4n4HAkvc2BnJp6KeNUTk</code>| |STORAGE    |The storage name assigned by BioID depending on the type of contract you have. |<code>bws</code>| |PARTITION  |A number assigned to your company by BioID. |<code>12345</code>|</p>"},{"location":"script-catalog/person_authentication/other/bioid/#save-changes","title":"Save changes","text":"<p>Click on <code>Enable</code> under the script contents box, and press <code>Update</code> at the bottom of the page.</p>"},{"location":"script-catalog/person_authentication/other/bioid/#plugin-installation","title":"Plugin installation","text":""},{"location":"script-catalog/person_authentication/other/bioid/#add-the-plugin-to-casa","title":"Add the plugin to Casa","text":"<ol> <li> <p>Download the plugin</p> </li> <li> <p>Log in to Casa using an administrator account</p> </li> <li> <p>Visit <code>Administration console</code> &gt; <code>Casa plugins</code></p> </li> </ol> <p></p> <ol> <li> <p>Click on <code>Add a plugin...</code> and select the plugin jar file</p> </li> <li> <p>Click on <code>Add</code></p> </li> </ol> <p>Alternatively you can log into Janssen Server and copy the jar file directly to <code>/opt/jans/jetty/jans-casa/plugins</code>.</p>"},{"location":"script-catalog/person_authentication/other/bioid/#enable-the-authentication-method","title":"Enable the authentication method","text":"<p>Wait for one minute, then visit <code>Administration Console</code> &gt; <code>Enabled methods</code> and tick <code>bioid</code>. On the right, the plugin will be selected by default. Finally save the changes.</p>"},{"location":"script-catalog/person_authentication/other/bioid/#testing","title":"Testing","text":"<p>So far, users that log into Casa should be able to see a new entry \"Biometric credentials\" that will appear under \"2FA credentials\" .</p> <p></p> <p>From there they can enroll their biometric traits. The steps to enroll your facial and periocular traits are self explanatory. Follow the instructions on the web page. You can enroll again or delete your credentials by visiting your registered credential.</p> <p></p> <p>Note - When you first use BioID you may wish to enroll a few times at different times of days or in different locations under a variety of environmental conditions. Once you can be reliably recognized, you only need to enroll again if something in your face changes significantly (such as after an accident or cosmetic surgery, or if you radically change eyeglasses, facial hair, facial jewelry, etc.) or if you often have to try more than once to be recognized. Once recognized, BioID typically adjusts itself to adapt to the changes right away.</p> <p></p>"},{"location":"script-catalog/person_authentication/other/bioid/#use-the-biometric-credential-as-a-second-factor","title":"Use the biometric credential as a second factor","text":"<p>Ensure you have added another credential, hopefully of a different kind, for example a mobile phone number or an OTP token. Then visit the home page and click the toggle to turn 2FA on and logout. Try to access the application once more and supply the username and password for the account recently used to enroll the biometric credential. Depending on the numeric level assigned to the <code>bioid</code> script, you will be prompted for a different factor, for instance, to enter an OTP code. If so, click on <code>Try an alternative way to sign in</code> and click on <code>Biometric credential</code>.</p> <p>Follow the instructions on the screen for verification of facial and periocular traits.</p> <p>Finally, you will be redirected and get access to the application.</p>"},{"location":"script-catalog/person_authentication/other/cas2_duo/Readme/","title":"Description","text":"<p>This script uses CAS2 and DUO scripts. Hence both script properties should be added.</p> <p>Before deploying it user should do: 1. Put Cas2ExternalAuthenticator.py and DuoExternalAuthenticator.py into <code>/opt/gluu/python/libs</code>.   - <code>wget -c https://raw.githubusercontent.com/GluuFederation/oxAuth/master/Server/integrations/duo/DuoExternalAuthenticator.py</code>   - <code>wget -c https://raw.githubusercontent.com/GluuFederation/oxAuth/master/Server/integrations/cas2/Cas2ExternalAuthenticator.py</code></p> <ol> <li> <p>chown -R root:gluu /opt/gluu/python/libs</p> </li> <li> <p>Restart oxAuth service with: <code>service oxauth stop</code> and <code>service oxauth start</code></p> </li> </ol>"},{"location":"script-catalog/person_authentication/other/cas2_duo/Readme/#joining-flows","title":"Joining flows","text":"<p>This diagram illustrates how script join CAS2 and DUO scripts internally. Result authentication flow can be 2 or 3 steps.</p> <p></p>"},{"location":"script-catalog/person_authentication/other/cas2_duo/Readme/#configuration","title":"Configuration:","text":"<ul> <li>Name: CAS2DuoExternalAuthenticator</li> <li>Description: First AuthN with CAS server; 2FA with Gluu Server's Duo</li> <li>Programming Lanauge: Python / Level: 100</li> <li>Location Type: Ldap / Usage type: Web</li> <li>Custom property ( key/value ): </li> <li><code>cas_map_user</code>: false</li> <li><code>cas_review_opt</code>: true</li> <li><code>cas_host</code>: [hostname_of_cas_server]</li> <li><code>duo_creds_file</code>: /etc/certs/duo_creds.json</li> <li><code>duo_host</code>: [api-abcd.duosecurity.com]</li> <li>Script: </li> <li>Grab script and enable</li> </ul>"},{"location":"script-catalog/person_authentication/other/cert/","title":"Index","text":"<p>Script contents here</p> <p>This is a person authentication script for jans-auth-server that enables user Certificate Authentication.</p>"},{"location":"script-catalog/person_authentication/other/cert/#properties","title":"Properties","text":"<p>The module has a few properties:</p> <p>1) chain_cert_file_path - It's mandatory property. It's path to file with cert chains in pem format.    Example: '/etc/certs/chain_cert.pem'</p> <p>2) map_user_cert - Specify if script should map new user to local account. If true, then on the first authentication, the script will prompt for a username/password in step 2, and then store the certificate fingerprint in the <code>oxExternalUid</code> attribute.     Allowed values: true/false    Example: true</p> <p>3) use_generic_validator, use_path_validator, use_ocsp_validator, use_crl_validator - Enable/Disable specific certificate validation.    Allowed values: true/false    Example: true</p> <p>4) crl_max_response_size - Specify maximum allowed size of CRL response    Allowed values: integer value greater that 0    Example: 10485760    Default value: 5242880</p> <p>5) credentials_file - Patch to file with reCAPTCHA credentials.    Example: '/etc/certs/cert_credentials.json'</p>"},{"location":"script-catalog/person_authentication/other/cert/#generating-certificates-without-configuration","title":"Generating Certificates Without Configuration","text":""},{"location":"script-catalog/person_authentication/other/cert/#1-generate-a-certificate-authority-ca-cert","title":"1. Generate a certificate authority (CA) cert.","text":""},{"location":"script-catalog/person_authentication/other/cert/#1-generate-your-ca-certificate-using-this-command","title":"1. Generate your CA certificate using this command:","text":"<p><code>openssl req -newkey rsa:4096 -keyform PEM -keyout ca.key -x509 -days 3650 -outform PEM -out ca.cer</code></p>"},{"location":"script-catalog/person_authentication/other/cert/#2-generate-a-client-ssl-certificate","title":"2. Generate a client SSL certificate","text":""},{"location":"script-catalog/person_authentication/other/cert/#1-generate-a-private-key-for-the-ssl-client","title":"1. Generate a private key for the SSL client.","text":"<p><code>openssl genrsa -out client.key 4096</code></p>"},{"location":"script-catalog/person_authentication/other/cert/#2-use-the-clients-private-key-to-generate-a-cert-request","title":"2. Use the client's private key to generate a cert request.","text":"<p><code>openssl req -new -key client.key -out client.req</code></p>"},{"location":"script-catalog/person_authentication/other/cert/#3-issue-the-client-certificate-using-the-cert-request-and-the-ca-certkey","title":"3. Issue the client certificate using the cert request and the CA cert/key.","text":"<p><code>openssl x509 -req -in client.req -CA ca.cer -CAkey ca.key -set_serial 101 -extensions client -days 365 -outform PEM -out client.cer</code></p>"},{"location":"script-catalog/person_authentication/other/cert/#4-convert-the-client-certificate-and-private-key-to-pkcs12-format-for-use-by-browsers","title":"4. Convert the client certificate and private key to pkcs#12 format for use by browsers.","text":"<p><code>openssl pkcs12 -export -inkey client.key -in client.cer -out client.p12</code></p>"},{"location":"script-catalog/person_authentication/other/cert/#5-clean-up-remove-the-client-private-key-client-cert-and-client-request-files-as-the-pkcs12-has-everything-needed","title":"5. Clean up - remove the client private key, client cert and client request files as the pkcs12 has everything needed.","text":"<p><code>rm client.key client.cer client.req</code></p>"},{"location":"script-catalog/person_authentication/other/cert/#generating-certificate-with-configuration","title":"Generating Certificate With Configuration","text":"<p>For testing purposes there is archive with CA/Intermidiate/User certs in archive.</p>"},{"location":"script-catalog/person_authentication/other/cert/#1-create-and-sign-root-ca","title":"1. Create and sign Root CA","text":""},{"location":"script-catalog/person_authentication/other/cert/#11-generate-password-protected-a-8192-bit-long-sha-256-rsa-key-for-root-ca","title":"1.1. Generate password protected a 8192-bit long SHA-256 RSA key for root CA:","text":"<p><code>openssl genrsa -aes256 -out rootca.key 8192</code></p> <p>Example output: <pre><code>Generating RSA private key, 8192 bit long modulus (2 primes)\n....................+++\n........................................................................................................................................................................................................................................................................................................................................................................................+++\ne is 65537 (0x010001)\nEnter pass phrase for rootca.key:\nVerifying - Enter pass phrase for rootca.key:\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/#12-create-the-self-signed-root-ca-certificate-cacrt-youll-need-to-provide-an-identity-for-your-root-ca","title":"1.2 Create the self-signed root CA certificate ca.crt; you'll need to provide an identity for your root CA:","text":"<p><code>openssl req -sha256 -new -x509 -days 1826 -key rootca.key -out rootca.crt</code></p> <p>Example output: <pre><code>Enter pass phrase for rootca.key:\nYou are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter '.', the field will be left blank.\n-----\nCountry Name (2 letter code) [AU]:US\nState or Province Name (full name) [Some-State]:TX\nLocality Name (eg, city) []:Austin\nOrganization Name (eg, company) [Internet Widgits Pty Ltd]:Gluu, Inc.\nOrganizational Unit Name (eg, section) []:Gluu CA\nCommon Name (e.g. server FQDN or YOUR name) []:Gluu Root CA\nEmail Address []:\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/#13-create-root-caconf-file","title":"1.3. Create <code>root-ca.conf</code> file:","text":"<pre><code>[ ca ]\ndefault_ca = gluuca\n\n[ crl_ext ]\nissuerAltName=issuer:copy\nauthorityKeyIdentifier=keyid:always\n\n[ gluuca ]\ndir = ./\nnew_certs_dir = $dir\nunique_subject = no\ncertificate = $dir/rootca.crt\ndatabase = $dir/certindex\nprivate_key = $dir/rootca.key\nserial = $dir/certserial\ndefault_days = 730\ndefault_md = sha1\npolicy = gluuca_policy\nx509_extensions = gluuca_extensions\ncrlnumber = $dir/crlnumber\ndefault_crl_days = 730\n\n[ gluuca_policy ]\ncommonName = supplied\nstateOrProvinceName = supplied\ncountryName = optional\nemailAddress = optional\norganizationName = supplied\norganizationalUnitName = optional\n\n[ gluuca_extensions ]\nbasicConstraints = critical,CA:TRUE,pathlen:0\nkeyUsage = critical,any\nsubjectKeyIdentifier = hash\nauthorityKeyIdentifier = keyid:always,issuer\nkeyUsage = digitalSignature,cRLSign,keyCertSign\nextendedKeyUsage = serverAuth\ncrlDistributionPoints = @crl_section\nsubjectAltName  = @alt_names\nauthorityInfoAccess = @ocsp_section\n\n[alt_names]\nDNS.0 = Gluu Intermidiate CA 1\nDNS.1 = Gluu CA Intermidiate 1\n\n[crl_section]\nURI.0 = http://pki.gluu.org/GluuRoot.crl\nURI.1 = http://pki.backup.com/GluuRoot.crl\n\n[ocsp_section]\ncaIssuers;URI.0 = http://pki.gluu.org/GluuRoot.crt\ncaIssuers;URI.1 = http://pki.backup.com/GluuRoot.crt\nOCSP;URI.0 = http://pki.gluu.org/ocsp/\nOCSP;URI.1 = http://pki.backup.com/ocsp/\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/#14-create-a-few-files-where-the-ca-will-store-its-serials","title":"1.4. Create a few files where the CA will store it's serials:","text":"<pre><code>touch certindex\necho 1000 &gt; certserial\necho 1000 &gt; crlnumber\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/#15-if-you-need-to-set-a-specific-certificate-start-expiry-date-add-the-following-to-gluuca","title":"1.5. If you need to set a specific certificate start / expiry date, add the following to [gluuca]","text":"<pre><code># format: YYYYMMDDHHMMSS\ndefault_enddate = 20191222035911\ndefault_startdate = 20181222035911\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/#2-create-and-sign-intermediate-1-ca","title":"2. Create and sign Intermediate 1 CA","text":""},{"location":"script-catalog/person_authentication/other/cert/#21-generate-the-intermediate-cas-private-key","title":"2.1. Generate the intermediate CA's private key:","text":"<p><code>openssl genrsa -out intermediate1.key 4096</code></p> <p>Example output: <pre><code>Generating RSA private key, 4096 bit long modulus (2 primes)\n........................................................++++\n.........++++\ne is 65537 (0x010001)\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/#22-generate-the-intermediate1-cas-csr","title":"2.2. Generate the intermediate1 CA's CSR:","text":"<p><code>openssl req -new -sha256 -key intermediate1.key -out intermediate1.csr</code></p> <p>Example output: <pre><code>You are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter '.', the field will be left blank.\n-----\nCountry Name (2 letter code) [AU]:US\nState or Province Name (full name) [Some-State]:TX\nLocality Name (eg, city) []:Austin\nOrganization Name (eg, company) [Internet Widgits Pty Ltd]:Gluu, Inc.\nOrganizational Unit Name (eg, section) []:Gluu CA\nCommon Name (e.g. server FQDN or YOUR name) []:Gluu Intermediate CA\nEmail Address []:\n\nPlease enter the following 'extra' attributes\nto be sent with your certificate request\nA challenge password []:\nAn optional company name []:\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/#23-sign-the-intermediate1-csr-with-the-root-ca","title":"2.3. Sign the intermediate1 CSR with the Root CA:","text":"<p><code>openssl ca -batch -config root-ca.conf -notext -in intermediate1.csr -out intermediate1.crt</code></p> <p>Example output: <pre><code>Using configuration from root-ca.conf\nEnter pass phrase for .//rootca.key:\nCheck that the request matches the signature\nSignature ok\nThe Subject's Distinguished Name is as follows\ncountryName           :PRINTABLE:'US'\nstateOrProvinceName   :ASN.1 12:'TX'\nlocalityName          :ASN.1 12:'Austin'\norganizationName      :ASN.1 12:'Gluu, Inc.'\norganizationalUnitName:ASN.1 12:'Gluu CA'\ncommonName            :ASN.1 12:'Gluu Intermediate CA'\nCertificate is to be certified until Dec 22 07:39:24 2021 GMT (730 days)\n\nWrite out database with 1 new entries\nData Base Updated\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/#24-generate-the-crl-both-in-pem-and-der","title":"2.4. Generate the CRL (both in PEM and DER):","text":"<pre><code>openssl ca -config root-ca.conf -gencrl -keyfile rootca.key -cert rootca.crt -out rootca.crl.pem\nopenssl crl -inform PEM -in rootca.crl.pem -outform DER -out rootca.crl\n</code></pre> <p>Generate the CRL after every certificate you sign with the CA.</p>"},{"location":"script-catalog/person_authentication/other/cert/#25-configuring-the-intermediate-ca-1","title":"2.5. Configuring the Intermediate CA 1","text":"<p>Create a new folder for this intermediate and move in to it:</p> <pre><code>mkdir intermediate1\ncd ./intermediate1\n</code></pre> <p>Copy the Intermediate cert and key from the Root CA:</p> <p><code>mv ../intermediate1.* ./</code></p> <p>Create the index files:</p> <pre><code>touch certindex\necho 1000 &gt; certserial\necho 1000 &gt; crlnumber\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/#26-create-a-new-intermediate-caconf-file","title":"2.6. Create a new intermediate-ca.conf file:","text":"<pre><code>[ ca ]\ndefault_ca = gluuca\n\n[ crl_ext ]\nissuerAltName=issuer:copy\nauthorityKeyIdentifier=keyid:always\n\n[ gluuca ]\ndir = ./\nnew_certs_dir = $dir\nunique_subject = no\ncertificate = $dir/intermediate1.crt\ndatabase = $dir/certindex\nprivate_key = $dir/intermediate1.key\nserial = $dir/certserial\ndefault_days = 365\ndefault_md = sha1\npolicy = gluuca_policy\nx509_extensions = gluuca_extensions\ncrlnumber = $dir/crlnumber\ndefault_crl_days = 365\n\n[ gluuca_policy ]\ncommonName = supplied\nstateOrProvinceName = supplied\ncountryName = optional\nemailAddress = optional\norganizationName = supplied\norganizationalUnitName = optional\n\n[ gluuca_extensions ]\nbasicConstraints = critical,CA:FALSE\nkeyUsage = critical,any\nsubjectKeyIdentifier = hash\nauthorityKeyIdentifier = keyid:always,issuer\nkeyUsage = digitalSignature, nonRepudiation, keyEncipherment\nextendedKeyUsage = clientAuth\ncrlDistributionPoints = @crl_section\nsubjectAltName  = @alt_names\nauthorityInfoAccess = @ocsp_section\n\n[alt_names]\nDNS.0 = example.com\nDNS.1 = example.org\n\n[crl_section]\nURI.0 = http://pki.gluu.org/GluuIntermidiate1.crl\nURI.1 = http://pki.backup.com/GluuIntermidiate1.crl\n\n[ocsp_section]\ncaIssuers;URI.0 = http://pki.gluu.org/GluuIntermediate1.crt\ncaIssuers;URI.1 = http://pki.backup.com/GluuIntermediate1.crt\nOCSP;URI.0 = http://pki.gluu.org/ocsp/\nOCSP;URI.1 = http://pki.backup.com/ocsp/\n</code></pre> <p>Change the [alt_names] section to whatever you need as Subject Alternative names. Remove it including the subjectAltName = @alt_names line if you don't want a Subject Alternative Name.</p> <p>If you need to set a specific certificate start / expiry date, add the following to [gluuca]</p> <pre><code># format: YYYYMMDDHHMMSS\ndefault_enddate = 20191222035911\ndefault_startdate = 20181222035911\n</code></pre> <p>Generate an empty CRL (both in PEM and DER):</p> <pre><code>openssl ca -config intermediate-ca.conf -gencrl -keyfile intermediate1.key -cert intermediate1.crt -out intermediate1.crl.pem\nopenssl crl -inform PEM -in intermediate1.crl.pem -outform DER -out intermediate1.crl\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/#27-this-is-sample-to-show-how-to-revoke-cert-use-it-only-when-you-need-to-revoke-the-intermediate-cert","title":"2.7. This is sample to show how to revoke cert. Use it only when you need to revoke the intermediate cert:","text":"<p><code>openssl ca -config root-ca.conf -revoke intermediate1.crt -keyfile rootca.key -cert rootca.crt</code></p>"},{"location":"script-catalog/person_authentication/other/cert/#3-creating-end-user-certificates","title":"3. Creating end user certificates","text":"<p>We use this new intermediate CA to generate an end user certificate. Repeat these steps for every end user certificate you want to sign with this CA.</p>"},{"location":"script-catalog/person_authentication/other/cert/#31-create-folder-for-end-user-certs","title":"3.1. Create folder for end user certs:","text":"<p><code>mkdir enduser-certs</code></p>"},{"location":"script-catalog/person_authentication/other/cert/#32-generate-the-end-users-private-key","title":"3.2. Generate the end user's private key:","text":"<p><code>openssl genrsa -out enduser-certs/user-gluu.org.key 4096</code></p>"},{"location":"script-catalog/person_authentication/other/cert/#33-generate-the-end-users-csr","title":"3.3. Generate the end user's CSR:","text":"<p><code>openssl req -new -sha256 -key enduser-certs/user-gluu.org.key -out enduser-certs/user-gluu.org.csr</code></p> <p>Example output: <pre><code>You are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter '.', the field will be left blank.\n-----\nCountry Name (2 letter code) [AU]:US\nState or Province Name (full name) [Some-State]:TX\nLocality Name (eg, city) []:Austin\nOrganization Name (eg, company) [Internet Widgits Pty Ltd]:Gluu, Inc.\nOrganizational Unit Name (eg, section) []:User\nCommon Name (e.g. server FQDN or YOUR name) []:Full User Name\nEmail Address []:\n\nPlease enter the following 'extra' attributes\nto be sent with your certificate request\nA challenge password []:\nAn optional company name []:\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/#34-sign-the-end-users-csr-with-the-intermediate-1-ca","title":"3.4. Sign the end user's CSR with the Intermediate 1 CA:","text":"<p><code>openssl ca -batch -config intermediate-ca.conf -notext -in enduser-certs/user-gluu.org.csr -out enduser-certs/user-gluu.org.crt</code></p> <p>Example output: <pre><code>Using configuration from intermediate-ca.conf\nCheck that the request matches the signature\nSignature ok\nThe Subject's Distinguished Name is as follows\ncountryName           :PRINTABLE:'US'\nstateOrProvinceName   :ASN.1 12:'TX'\nlocalityName          :ASN.1 12:'Austin'\norganizationName      :ASN.1 12:'Gluu, Inc.'\norganizationalUnitName:ASN.1 12:'User'\ncommonName            :ASN.1 12:'Full User Name'\nCertificate is to be certified until Dec 22 08:07:15 2020 GMT (365 days)\n\nWrite out database with 1 new entries\nData Base Updated\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/#35-generate-the-crl-both-in-pem-and-der","title":"3.5. Generate the CRL (both in PEM and DER):","text":"<pre><code>openssl ca -config intermediate-ca.conf -gencrl -keyfile intermediate1.key -cert intermediate1.crt -out intermediate1.crl.pem\nopenssl crl -inform PEM -in intermediate1.crl.pem -outform DER -out intermediate1.crl\n</code></pre> <p>Generate the CRL after every certificate you sign with the CA.</p>"},{"location":"script-catalog/person_authentication/other/cert/#36-create-the-certificate-chain-file-by-concatenating-the-root-and-intermediate-1-certificates-together","title":"3.6. Create the certificate chain file by concatenating the Root and intermediate 1 certificates together.","text":"<p><code>cat ../rootca.crt intermediate1.crt &gt; enduser-certs/user-gluu.org.chain</code></p> <p>Send the following files to the end user:</p> <pre><code>user-gluu.org.crt\nuser-gluu.org.key\nuser-gluu.org.chain\n</code></pre> <p>You can also let the end user supply their own CSR and just send them the .crt file. Do not delete that from the server, otherwise you cannot revoke it.</p>"},{"location":"script-catalog/person_authentication/other/cert/#37-this-is-sample-to-show-how-to-revoke-cert-use-it-only-when-you-need-to-revoke-the-end-users-cert","title":"3.7. This is sample to show how to revoke cert. Use it only when you need to revoke the end users cert:","text":"<p><code>openssl ca -config intermediate-ca.conf -revoke enduser-certs/enduser-gluu.org.crt -keyfile intermediate1.key -cert intermediate1.crt</code></p>"},{"location":"script-catalog/person_authentication/other/cert/#4-validating-the-certificate","title":"4. Validating the certificate","text":""},{"location":"script-catalog/person_authentication/other/cert/#41-you-can-validate-the-end-user-certificate-against-the-chain-using-the-following-command","title":"4.1. You can validate the end user certificate against the chain using the following command:","text":"<p><code>openssl verify -CAfile enduser-certs/user-gluu.org.chain enduser-certs/user-gluu.org.crt</code></p> <p>Example output: <pre><code>enduser-certs/user-gluu.org.crt: OK\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/#42-you-can-also-validate-it-against-the-crl-concatenate-the-pem-crl-and-the-chain-together-first","title":"4.2. You can also validate it against the CRL. Concatenate the PEM CRL and the chain together first:","text":"<p><code>cat ../rootca.crt intermediate1.crt intermediate1.crl.pem &gt; enduser-certs/user-gluu.org.crl.chain</code></p> <p>Verify the certificate:</p> <p><code>openssl verify -crl_check -CAfile enduser-certs/user-gluu.org.crl.chain enduser-certs/user-gluu.org.crt</code></p> <p>Example output: <pre><code>enduser-certs/user-gluu.org.crt: OK\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/#5-export-end-user-certificate-to-pkcs12","title":"5. Export end user certificate to PKCS#12","text":"<p>Convert a PEM certificate file and a private key to PKCS#12 (.pfx .p12)</p> <pre><code>openssl pkcs12 -export -out enduser-certs/user-gluu.org.pfx -inkey enduser-certs/user-gluu.org.key -in enduser-certs/user-gluu.org.crt -certfile enduser-certs/user-gluu.org.chain\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/#quick-certificates-for-testing","title":"Quick Certificates for Testing","text":""},{"location":"script-catalog/person_authentication/other/cert/#1-create-a-user_certconf-file-and-update-user_dn-section","title":"1. Create a user_cert.conf file and update <code>user_dn</code> section:","text":"<pre><code>[ req ]\ndays                   = 365\nprompt                 = no\ndistinguished_name     = user_dn\nx509_extensions        = v3_ca\n\n[ user_dn ]\n           countryName = US\n   stateOrProvinceName = TX\n          localityName = Austin\n      organizationName = Gluu, Inc.\norganizationalUnitName = Gluu SSL department\n            commonName = secure.gluu.com\n          emailAddress = john@gluu.org\n\n[ v3_ca ]\nbasicConstraints       = CA:FALSE\nsubjectKeyIdentifier   = hash\nauthorityKeyIdentifier = keyid:always, issuer\nextendedKeyUsage       = clientAuth, emailProtection\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/#2-generate-user-cert","title":"2. Generate user cert","text":"<pre><code>openssl req -x509 -config user_cert.conf -nodes -newkey rsa:4096 -keyout user_cert.key -out user_cert.crt\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/#3-export-end-user-certificate-to-pkcs12","title":"3. Export end user certificate to PKCS#12","text":"<pre><code>openssl pkcs12 -export -inkey user_cert.key -in user_cert.crt -out user_cert.p12\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/","title":"Generate certs guide","text":"<p>For testing purpouses there is archive with CA/Intermidiate/User certs in archive.</p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#1-create-and-sign-root-ca","title":"1. Create and sign Root CA","text":""},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#11-generate-password-protected-a-8192-bit-long-sha-256-rsa-key-for-root-ca","title":"1.1. Generate password protected a 8192-bit long SHA-256 RSA key for root CA:","text":"<p><code>openssl genrsa -aes256 -out rootca.key 8192</code></p> <p>Example output: <pre><code>Generating RSA private key, 8192 bit long modulus (2 primes)\n....................+++\n........................................................................................................................................................................................................................................................................................................................................................................................+++\ne is 65537 (0x010001)\nEnter pass phrase for rootca.key:\nVerifying - Enter pass phrase for rootca.key:\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#12-create-the-self-signed-root-ca-certificate-cacrt-youll-need-to-provide-an-identity-for-your-root-ca","title":"1.2 Create the self-signed root CA certificate ca.crt; you'll need to provide an identity for your root CA:","text":"<p><code>openssl req -sha256 -new -x509 -days 1826 -key rootca.key -out rootca.crt</code></p> <p>Example output: <pre><code>Enter pass phrase for rootca.key:\nYou are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter '.', the field will be left blank.\n-----\nCountry Name (2 letter code) [AU]:US\nState or Province Name (full name) [Some-State]:TX\nLocality Name (eg, city) []:Austin\nOrganization Name (eg, company) [Internet Widgits Pty Ltd]:Gluu, Inc.\nOrganizational Unit Name (eg, section) []:Gluu CA\nCommon Name (e.g. server FQDN or YOUR name) []:Gluu Root CA\nEmail Address []:\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#13-create-root-caconf-file","title":"1.3. Create <code>root-ca.conf</code> file:","text":"<pre><code>[ ca ]\ndefault_ca = gluuca\n\n[ crl_ext ]\nissuerAltName=issuer:copy\nauthorityKeyIdentifier=keyid:always\n\n[ gluuca ]\ndir = ./\nnew_certs_dir = $dir\nunique_subject = no\ncertificate = $dir/rootca.crt\ndatabase = $dir/certindex\nprivate_key = $dir/rootca.key\nserial = $dir/certserial\ndefault_days = 730\ndefault_md = sha1\npolicy = gluuca_policy\nx509_extensions = gluuca_extensions\ncrlnumber = $dir/crlnumber\ndefault_crl_days = 730\n\n[ gluuca_policy ]\ncommonName = supplied\nstateOrProvinceName = supplied\ncountryName = optional\nemailAddress = optional\norganizationName = supplied\norganizationalUnitName = optional\n\n[ gluuca_extensions ]\nbasicConstraints = critical,CA:TRUE,pathlen:0\nkeyUsage = critical,any\nsubjectKeyIdentifier = hash\nauthorityKeyIdentifier = keyid:always,issuer\nkeyUsage = digitalSignature,cRLSign,keyCertSign\nextendedKeyUsage = serverAuth\ncrlDistributionPoints = @crl_section\nsubjectAltName  = @alt_names\nauthorityInfoAccess = @ocsp_section\n\n[alt_names]\nDNS.0 = Gluu Intermidiate CA 1\nDNS.1 = Gluu CA Intermidiate 1\n\n[crl_section]\nURI.0 = http://pki.gluu.org/GluuRoot.crl\nURI.1 = http://pki.backup.com/GluuRoot.crl\n\n[ocsp_section]\ncaIssuers;URI.0 = http://pki.gluu.org/GluuRoot.crt\ncaIssuers;URI.1 = http://pki.backup.com/GluuRoot.crt\nOCSP;URI.0 = http://pki.gluu.org/ocsp/\nOCSP;URI.1 = http://pki.backup.com/ocsp/\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#14-create-a-few-files-where-the-ca-will-store-its-serials","title":"1.4. Create a few files where the CA will store it's serials:","text":"<pre><code>touch certindex\necho 1000 &gt; certserial\necho 1000 &gt; crlnumber\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#15-if-you-need-to-set-a-specific-certificate-start-expiry-date-add-the-following-to-gluuca","title":"1.5. If you need to set a specific certificate start / expiry date, add the following to [gluuca]","text":"<pre><code># format: YYYYMMDDHHMMSS\ndefault_enddate = 20191222035911\ndefault_startdate = 20181222035911\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#2-create-and-sign-intermediate-1-ca","title":"2. Create and sign Intermediate 1 CA","text":""},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#21-generate-the-intermediate-cas-private-key","title":"2.1. Generate the intermediate CA's private key:","text":"<p><code>openssl genrsa -out intermediate1.key 4096</code></p> <p>Example output: <pre><code>Generating RSA private key, 4096 bit long modulus (2 primes)\n........................................................++++\n.........++++\ne is 65537 (0x010001)\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#22-generate-the-intermediate1-cas-csr","title":"2.2. Generate the intermediate1 CA's CSR:","text":"<p><code>openssl req -new -sha256 -key intermediate1.key -out intermediate1.csr</code></p> <p>Example output: <pre><code>You are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter '.', the field will be left blank.\n-----\nCountry Name (2 letter code) [AU]:US\nState or Province Name (full name) [Some-State]:TX\nLocality Name (eg, city) []:Austin\nOrganization Name (eg, company) [Internet Widgits Pty Ltd]:Gluu, Inc.\nOrganizational Unit Name (eg, section) []:Gluu CA\nCommon Name (e.g. server FQDN or YOUR name) []:Gluu Intermediate CA\nEmail Address []:\n\nPlease enter the following 'extra' attributes\nto be sent with your certificate request\nA challenge password []:\nAn optional company name []:\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#23-sign-the-intermediate1-csr-with-the-root-ca","title":"2.3. Sign the intermediate1 CSR with the Root CA:","text":"<p><code>openssl ca -batch -config root-ca.conf -notext -in intermediate1.csr -out intermediate1.crt</code></p> <p>Example output: <pre><code>Using configuration from root-ca.conf\nEnter pass phrase for .//rootca.key:\nCheck that the request matches the signature\nSignature ok\nThe Subject's Distinguished Name is as follows\ncountryName           :PRINTABLE:'US'\nstateOrProvinceName   :ASN.1 12:'TX'\nlocalityName          :ASN.1 12:'Austin'\norganizationName      :ASN.1 12:'Gluu, Inc.'\norganizationalUnitName:ASN.1 12:'Gluu CA'\ncommonName            :ASN.1 12:'Gluu Intermediate CA'\nCertificate is to be certified until Dec 22 07:39:24 2021 GMT (730 days)\n\nWrite out database with 1 new entries\nData Base Updated\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#24-generate-the-crl-both-in-pem-and-der","title":"2.4. Generate the CRL (both in PEM and DER):","text":"<pre><code>openssl ca -config root-ca.conf -gencrl -keyfile rootca.key -cert rootca.crt -out rootca.crl.pem\nopenssl crl -inform PEM -in rootca.crl.pem -outform DER -out rootca.crl\n</code></pre> <p>Generate the CRL after every certificate you sign with the CA.</p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#25-configuring-the-intermediate-ca-1","title":"2.5. Configuring the Intermediate CA 1","text":"<p>Create a new folder for this intermediate and move in to it:</p> <pre><code>mkdir intermediate1\ncd ./intermediate1\n</code></pre> <p>Copy the Intermediate cert and key from the Root CA:</p> <p><code>mv ../intermediate1.* ./</code></p> <p>Create the index files:</p> <pre><code>touch certindex\necho 1000 &gt; certserial\necho 1000 &gt; crlnumber\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#26-create-a-new-intermediate-caconf-file","title":"2.6. Create a new intermediate-ca.conf file:","text":"<pre><code>[ ca ]\ndefault_ca = gluuca\n\n[ crl_ext ]\nissuerAltName=issuer:copy\nauthorityKeyIdentifier=keyid:always\n\n[ gluuca ]\ndir = ./\nnew_certs_dir = $dir\nunique_subject = no\ncertificate = $dir/intermediate1.crt\ndatabase = $dir/certindex\nprivate_key = $dir/intermediate1.key\nserial = $dir/certserial\ndefault_days = 365\ndefault_md = sha1\npolicy = gluuca_policy\nx509_extensions = gluuca_extensions\ncrlnumber = $dir/crlnumber\ndefault_crl_days = 365\n\n[ gluuca_policy ]\ncommonName = supplied\nstateOrProvinceName = supplied\ncountryName = optional\nemailAddress = optional\norganizationName = supplied\norganizationalUnitName = optional\n\n[ gluuca_extensions ]\nbasicConstraints = critical,CA:FALSE\nkeyUsage = critical,any\nsubjectKeyIdentifier = hash\nauthorityKeyIdentifier = keyid:always,issuer\nkeyUsage = digitalSignature, nonRepudiation, keyEncipherment\nextendedKeyUsage = clientAuth\ncrlDistributionPoints = @crl_section\nsubjectAltName  = @alt_names\nauthorityInfoAccess = @ocsp_section\n\n[alt_names]\nDNS.0 = example.com\nDNS.1 = example.org\n\n[crl_section]\nURI.0 = http://pki.gluu.org/GluuIntermidiate1.crl\nURI.1 = http://pki.backup.com/GluuIntermidiate1.crl\n\n[ocsp_section]\ncaIssuers;URI.0 = http://pki.gluu.org/GluuIntermediate1.crt\ncaIssuers;URI.1 = http://pki.backup.com/GluuIntermediate1.crt\nOCSP;URI.0 = http://pki.gluu.org/ocsp/\nOCSP;URI.1 = http://pki.backup.com/ocsp/\n</code></pre> <p>Change the [alt_names] section to whatever you need as Subject Alternative names. Remove it including the subjectAltName = @alt_names line if you don't want a Subject Alternative Name.</p> <p>If you need to set a specific certificate start / expiry date, add the following to [gluuca]</p> <pre><code># format: YYYYMMDDHHMMSS\ndefault_enddate = 20191222035911\ndefault_startdate = 20181222035911\n</code></pre> <p>Generate an empty CRL (both in PEM and DER):</p> <pre><code>openssl ca -config intermediate-ca.conf -gencrl -keyfile intermediate1.key -cert intermediate1.crt -out intermediate1.crl.pem\nopenssl crl -inform PEM -in intermediate1.crl.pem -outform DER -out intermediate1.crl\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#27-this-is-sample-to-show-how-to-revoke-cert-use-it-only-when-you-need-to-revoke-the-intermediate-cert","title":"2.7. This is sample to show how to revoke cert. Use it only when you need to revoke the intermediate cert:","text":"<p><code>openssl ca -config root-ca.conf -revoke intermediate1.crt -keyfile rootca.key -cert rootca.crt</code></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#3-creating-end-user-certificates","title":"3. Creating end user certificates","text":"<p>We use this new intermediate CA to generate an end user certificate. Repeat these steps for every end user certificate you want to sign with this CA.</p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#31-create-folder-for-end-user-certs","title":"3.1. Create folder for end user certs:","text":"<p><code>mkdir enduser-certs</code></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#32-generate-the-end-users-private-key","title":"3.2. Generate the end user's private key:","text":"<p><code>openssl genrsa -out enduser-certs/user-gluu.org.key 4096</code></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#33-generate-the-end-users-csr","title":"3.3. Generate the end user's CSR:","text":"<p><code>openssl req -new -sha256 -key enduser-certs/user-gluu.org.key -out enduser-certs/user-gluu.org.csr</code></p> <p>Example output: <pre><code>You are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter '.', the field will be left blank.\n-----\nCountry Name (2 letter code) [AU]:US\nState or Province Name (full name) [Some-State]:TX\nLocality Name (eg, city) []:Austin\nOrganization Name (eg, company) [Internet Widgits Pty Ltd]:Gluu, Inc.\nOrganizational Unit Name (eg, section) []:User\nCommon Name (e.g. server FQDN or YOUR name) []:Full User Name\nEmail Address []:\n\nPlease enter the following 'extra' attributes\nto be sent with your certificate request\nA challenge password []:\nAn optional company name []:\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#34-sign-the-end-users-csr-with-the-intermediate-1-ca","title":"3.4. Sign the end user's CSR with the Intermediate 1 CA:","text":"<p><code>openssl ca -batch -config intermediate-ca.conf -notext -in enduser-certs/user-gluu.org.csr -out enduser-certs/user-gluu.org.crt</code></p> <p>Example output: <pre><code>Using configuration from intermediate-ca.conf\nCheck that the request matches the signature\nSignature ok\nThe Subject's Distinguished Name is as follows\ncountryName           :PRINTABLE:'US'\nstateOrProvinceName   :ASN.1 12:'TX'\nlocalityName          :ASN.1 12:'Austin'\norganizationName      :ASN.1 12:'Gluu, Inc.'\norganizationalUnitName:ASN.1 12:'User'\ncommonName            :ASN.1 12:'Full User Name'\nCertificate is to be certified until Dec 22 08:07:15 2020 GMT (365 days)\n\nWrite out database with 1 new entries\nData Base Updated\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#35-generate-the-crl-both-in-pem-and-der","title":"3.5. Generate the CRL (both in PEM and DER):","text":"<pre><code>openssl ca -config intermediate-ca.conf -gencrl -keyfile intermediate1.key -cert intermediate1.crt -out intermediate1.crl.pem\nopenssl crl -inform PEM -in intermediate1.crl.pem -outform DER -out intermediate1.crl\n</code></pre> <p>Generate the CRL after every certificate you sign with the CA.</p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#36-create-the-certificate-chain-file-by-concatenating-the-root-and-intermediate-1-certificates-together","title":"3.6. Create the certificate chain file by concatenating the Root and intermediate 1 certificates together.","text":"<p><code>cat ../rootca.crt intermediate1.crt &gt; enduser-certs/user-gluu.org.chain</code></p> <p>Send the following files to the end user:</p> <pre><code>user-gluu.org.crt\nuser-gluu.org.key\nuser-gluu.org.chain\n</code></pre> <p>You can also let the end user supply their own CSR and just send them the .crt file. Do not delete that from the server, otherwise you cannot revoke it.</p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#37-this-is-sample-to-show-how-to-revoke-cert-use-it-only-when-you-need-to-revoke-the-end-users-cert","title":"3.7. This is sample to show how to revoke cert. Use it only when you need to revoke the end users cert:","text":"<p><code>openssl ca -config intermediate-ca.conf -revoke enduser-certs/enduser-gluu.org.crt -keyfile intermediate1.key -cert intermediate1.crt</code></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#4-validating-the-certificate","title":"4. Validating the certificate","text":""},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#41-you-can-validate-the-end-user-certificate-against-the-chain-using-the-following-command","title":"4.1. You can validate the end user certificate against the chain using the following command:","text":"<p><code>openssl verify -CAfile enduser-certs/user-gluu.org.chain enduser-certs/user-gluu.org.crt</code></p> <p>Example output: <pre><code>enduser-certs/user-gluu.org.crt: OK\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#42-you-can-also-validate-it-against-the-crl-concatenate-the-pem-crl-and-the-chain-together-first","title":"4.2. You can also validate it against the CRL. Concatenate the PEM CRL and the chain together first:","text":"<p><code>cat ../rootca.crt intermediate1.crt intermediate1.crl.pem &gt; enduser-certs/user-gluu.org.crl.chain</code></p> <p>Verify the certificate:</p> <p><code>openssl verify -crl_check -CAfile enduser-certs/user-gluu.org.crl.chain enduser-certs/user-gluu.org.crt</code></p> <p>Example output: <pre><code>enduser-certs/user-gluu.org.crt: OK\n</code></pre></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20guide/#5-export-end-user-certificate-to-pkcs12","title":"5. Export end user certificate to PKCS#12","text":"<p>Convert a PEM certificate file and a private key to PKCS#12 (.pfx .p12)</p> <pre><code>openssl pkcs12 -export -out enduser-certs/user-gluu.org.pfx -inkey enduser-certs/user-gluu.org.key -in enduser-certs/user-gluu.org.crt -certfile enduser-certs/user-gluu.org.chain\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20without%20configs/","title":"Generate certs without configs","text":""},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20without%20configs/#1-generate-a-certificate-authority-ca-cert","title":"1. Generate a certificate authority (CA) cert.","text":""},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20without%20configs/#1-generate-your-ca-certificate-using-this-command","title":"1. Generate your CA certificate using this command:","text":"<p><code>openssl req -newkey rsa:4096 -keyform PEM -keyout ca.key -x509 -days 3650 -outform PEM -out ca.cer</code></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20without%20configs/#2-generate-a-client-ssl-certificate","title":"2. Generate a client SSL certificate","text":""},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20without%20configs/#1-generate-a-private-key-for-the-ssl-client","title":"1. Generate a private key for the SSL client.","text":"<p><code>openssl genrsa -out client.key 4096</code></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20without%20configs/#2-use-the-clients-private-key-to-generate-a-cert-request","title":"2. Use the client's private key to generate a cert request.","text":"<p><code>openssl req -new -key client.key -out client.req</code></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20without%20configs/#3-issue-the-client-certificate-using-the-cert-request-and-the-ca-certkey","title":"3. Issue the client certificate using the cert request and the CA cert/key.","text":"<p><code>openssl x509 -req -in client.req -CA ca.cer -CAkey ca.key -set_serial 101 -extensions client -days 365 -outform PEM -out client.cer</code></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20without%20configs/#4-convert-the-client-certificate-and-private-key-to-pkcs12-format-for-use-by-browsers","title":"4. Convert the client certificate and private key to pkcs#12 format for use by browsers.","text":"<p><code>openssl pkcs12 -export -inkey client.key -in client.cer -out client.p12</code></p>"},{"location":"script-catalog/person_authentication/other/cert/Generate%20certs%20without%20configs/#5-clean-up-remove-the-client-private-key-client-cert-and-client-request-files-as-the-pkcs12-has-everything-needed","title":"5. Clean up - remove the client private key, client cert and client request files as the pkcs12 has everything needed.","text":"<p><code>rm client.key client.cer client.req</code></p>"},{"location":"script-catalog/person_authentication/other/cert/Quick%20certs%20guide%20for%20testing/","title":"Quick certs guide for testing","text":""},{"location":"script-catalog/person_authentication/other/cert/Quick%20certs%20guide%20for%20testing/#1-create-a-user_certconf-file-and-update-user_dn-section","title":"1. Create a user_cert.conf file and update <code>user_dn</code> section:","text":"<pre><code>[ req ]\ndays                   = 365\nprompt                 = no\ndistinguished_name     = user_dn\nx509_extensions        = v3_ca\n\n[ user_dn ]\n           countryName = US\n   stateOrProvinceName = TX\n          localityName = Austin\n      organizationName = Gluu, Inc.\norganizationalUnitName = Gluu SSL department\n            commonName = secure.gluu.com\n          emailAddress = john@gluu.org\n\n[ v3_ca ]\nbasicConstraints       = CA:FALSE\nsubjectKeyIdentifier   = hash\nauthorityKeyIdentifier = keyid:always, issuer\nextendedKeyUsage       = clientAuth, emailProtection\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/Quick%20certs%20guide%20for%20testing/#2-generate-user-cert","title":"2. Generate user cert","text":"<pre><code>openssl req -x509 -config user_cert.conf -nodes -newkey rsa:4096 -keyout user_cert.key -out user_cert.crt\n</code></pre>"},{"location":"script-catalog/person_authentication/other/cert/Quick%20certs%20guide%20for%20testing/#3-export-end-user-certificate-to-pkcs12","title":"3. Export end user certificate to PKCS#12","text":"<pre><code>openssl pkcs12 -export -inkey user_cert.key -in user_cert.crt -out user_cert.p12\n</code></pre>"},{"location":"script-catalog/person_authentication/other/compromised_password/readme/","title":"Readme","text":"<p>This is a person authentication module for oxAuth to verify if user password has been compromised and allows user to change password immediately after providing answer to secret question set by admin.</p> <p>1) credentials_file = /etc/certs/vericloud_gluu_creds.json 2) secret_question  = Set this parameter for the question to be disaplayed to user 3) secret_answer    = Set this parameter for the answer to be provided by user to reset password</p> <p>Update vericloud_gluu_creds.json file with Vericloud API username and secret</p>"},{"location":"script-catalog/person_authentication/other/custom_registration/","title":"Index","text":"<p>In order to execute the custom registration workflow,</p> <ol> <li>Add the following custom property(key:value) in the script properties:</li> </ol> <p>attributes_json_file_path: /etc/Attributes.json</p> <p>and place Attributes.json file in the path specified in the custom property.</p> <ol> <li> <p>Place the reg.xhtml file in /opt/gluu/jetty/oxauth/custom/pages/auth/ directory.</p> </li> <li> <p>Enable the script and set it as the default authentication method.</p> </li> </ol>"},{"location":"script-catalog/person_authentication/other/duo/","title":"Index","text":"<p>Script contents here</p> <p>This is a person authentication script for jans-auth-server which enables Duo Authentication for user authentication.</p> <p>The module has a few properties:</p> <p>1) duo_creds_file - It's mandatory property. It's path to file which contains contains ikey, skey, akey. These keys are required for DUO authentication. Example: <code>/etc/certs/duo_creds.json</code> Example content of this file: <code>{\"ikey\": \"ikey_value\", \"skey\": \"skey_value\", \"akey\": \"akey_value\"}</code></p> <p>2) duo_host - It's mandatory property. The URL of the DUO API server.    Example: <code>api-random.duosecurity.com</code></p> <p>3) audit_attribute - It's optional property. It allows to define an attribute which the module should check for to determine whether the user belongs to duo_group or audit_group. Person DUO authentication module uses it if there is <code>duo_group</code> or <code>audit_group</code> property.    Example: <code>memberOf</code></p> <p>4) duo_group - It's optional property. It's an optional attribute that alows to specify if DUO should be used for specific users. i.e. use DUO only for users who have audit_attribute (<code>memberOf</code>) attribute value equal to <code>duo_group</code>. If there is none DUO will be enforced for all users. </p> <p>5) audit_group - It's optional property. Specify if module should send an e-mail to administrator upon login of a user who has audit_attribute <code>memberOf</code> attribute value equal to <code>audit_group</code>.</p> <p>6) audit_group_email - It's optional property. It's the administrator's e-mail. Person DUO authentication module uses it if there is <code>audit_group</code> property.</p>"},{"location":"script-catalog/person_authentication/other/fortinet/","title":"Fortinet - RADIUS server Authentication","text":"<p>This document explains how to configure the Gluu Server so that when a user logs in, an authentication request is made to Fortinet's remote RADIUS (Remote Authentication Dial-In User Service) server which then validates the username and password.</p>"},{"location":"script-catalog/person_authentication/other/fortinet/#prerequisites","title":"Prerequisites","text":"<ul> <li>A Gluu Server (installation instructions here) which will play the role of RADIUS client    </li> <li>The Fortinet script (included in the default Gluu Server distribution);   </li> <li>A Fortinet server which is the RADIUS server.     </li> <li>The jradius-client jar library added to oxAuth</li> </ul>"},{"location":"script-catalog/person_authentication/other/fortinet/#fortinet-configuration","title":"Fortinet Configuration","text":"<p>In <code>Authentication</code> -&gt; <code>Radius Service</code> -&gt; <code>Clients</code>, create a new client (which is Gluu server). Enter the \"secret\" which will be used by the interception script to exchange RADIUS packets.</p>"},{"location":"script-catalog/person_authentication/other/fortinet/#gluu-server-configuration","title":"Gluu Server Configuration","text":""},{"location":"script-catalog/person_authentication/other/fortinet/#add-jradius-library-to-oxauth","title":"Add JRadius library to oxAuth","text":"<ul> <li> <p>Copy the jradius-client jar file to the following oxAuth folder inside the Gluu Server chroot: <code>/opt/gluu/jetty/oxauth/custom/libs</code> </p> </li> <li> <p>Edit <code>/opt/gluu/jetty/oxauth/webapps/oxauth.xml</code> and add the following line:</p> <pre><code>&lt;Set name=\"extraClasspath\"&gt;/opt/gluu/jetty/oxauth/custom/libs/jradius-client.jar&lt;/Set&gt;\n</code></pre> </li> <li> <p>Restart the <code>oxauth</code> service</p> </li> </ul>"},{"location":"script-catalog/person_authentication/other/fortinet/#enable-interception-script","title":"Enable Interception Script","text":"<p>Follow the steps below to enable Fortinet's RADIUS authentication:</p> <ol> <li> <p>Navigate to <code>Configuration</code> &gt; <code>Person Authentication Scripts</code> </p> </li> <li> <p>Find the <code>fortinet</code> script.</p> <p></p> </li> <li> <p>Populate the properties table with the details from your Fortinet account:    </p> </li> </ol> Property Description Input value RADIUS_SERVER_IP IP address of Fortinet's RADIUS Server 10.10.10.1 RADIUS_SERVER_SECRET Configured when the RADIUS client is registered. spam RADIUS_SERVER_AUTH_PORT Authentication port 1812 RADIUS_SERVER_ACCT_PORT Accounting port 1813 <ol> <li> <p>Enable the script by checking the box </p> </li> <li> <p>Scroll to the bottom of the page and click <code>Update</code></p> </li> </ol> <p>Now authenticating a user against Fortinet's RADIUS server is possible from your Gluu Server. This means that, using OpenID Connect <code>acr_values</code>, applications can now request Fortinet authentication for users.</p> <p>Note</p> <p>To make sure this method has been enabled successfully, you can check your Gluu Server's OpenID Connect configuration by navigating to the following URL: <code>https://&lt;hostname&gt;/.well-known/openid-configuration</code>. Find <code>\"acr_values_supported\":</code> and you should see <code>\"fortinet\"</code>.</p>"},{"location":"script-catalog/person_authentication/other/fortinet/#make-fortinets-user-password-authentication-the-default-mechanism","title":"Make Fortinet's user-password authentication the Default mechanism.","text":"<p>If fortinet should be the default authentication mechanism, follow these instructions:</p> <ol> <li> <p>Navigate to <code>Configuration</code> &gt; <code>Manage Authentication</code>. </p> </li> <li> <p>Select the <code>Default Authentication Method</code> tab. </p> </li> <li> <p>In the Default Authentication Method window you will see two options: <code>Default acr</code> and <code>oxTrust acr</code>. </p> </li> </ol> <p></p> <ul> <li> <p><code>oxTrust acr</code> sets the authentication mechanism for accessing the oxTrust dashboard GUI (only managers should have acccess to oxTrust).    </p> </li> <li> <p><code>Default acr</code> sets the default authentication mechanism for accessing all applications that leverage your Gluu Server for authentication (unless otherwise specified).    </p> </li> </ul> <p>If Fortinet should be the default authentication mechanism for all access, change both fields to fortinet.</p>"},{"location":"script-catalog/person_authentication/other/fortinet/#troubleshooting","title":"Troubleshooting","text":"<p>If problems are encountered, take a look at the logs, specifically <code>/opt/gluu/jetty/oxauth/logs/oxauth_script.log</code>. Inspect all messages related to Fortinet. For instance, the following messages show an example of correct script initialization:</p> <pre><code>Fortinet. Initialization\nFortinet. Initialized successfully\n</code></pre> <p>Also make sure you are using the latest version of the script that can be found here.</p>"},{"location":"script-catalog/person_authentication/other/gplus/","title":"Index","text":"<p>This is a person authentication module for oxAuth that enables Google+ Authentication for user authentication.</p> <p>The module has a few properties:</p> <p>1) gplus_client_secrets_file - It's mandatory property. It's path to application configuration file downloaded from Google console for application. Example: <code>/etc/certs/gplus_client_secrets.json</code> These are steps needed to get it:     a) Log into: https://console.developers.google.com/project     b) Click \"Create project\" and enter project name     c) Open new project \"API &amp; auth -&gt; Credentials\" menu item in configuration navigation tree     d) Click \"Add credential\" with type \"OAuth 2.0 client ID\"     e) Select \"Web application\" application type     f) Enter \"Authorized JavaScript origins\". It should be CE server DNS name. Example: https://gluu.info     g) Click \"Create\" and Click \"OK\" in next dialog     h) Click \"Download JSON\" in order to download gplus_client_secrets.json file Also it's mandatory to enable Google+ API:     a) Log into: https://console.developers.google.com/project     b) Select project and enter project name     c) Open new project \"API &amp; auth -&gt; API\" menu item in configuration navigation tree     d) Click \"Google+ API\"     e) Click \"Enable API\" button</p> <p>2) gplus_deployment_type - Specify deployment mode. It's optional property. If this property isn't specified script    tries to find user in local LDAP by 'subject_identifier' claim specified in id_token. If this property has 'map' value script    allow to map 'subject_identifier' to local user account. If this property has 'enroll' value script should add new user to local LDAP    with status 'acrtive'. In order to map IDP attributes to local attributes it uses properties gplus_remote_attributes_list and    gplus_local_attributes_list.    Allowed values: map/enroll    Example: enroll</p> <p>3) gplus_remote_attributes_list - Comma separated list of attribute names. Specify list of Google+ claims(attributes) which script should use to map to local attributes.    It's optional property. It's mandatory only if gplus_deployment_type has value 'enroll'.    The count of attributes in this property should be equal to count attributes in gplus_local_attributes_list property.    Example: email, email, name, family_name, given_name, locale</p> <p>4) gplus_local_attributes_list - Comma separated list of attribute names. Specify list of local attributes mapped from Google+ userInfo OpenId response.     It's optional property. It's mandatory only if gplus_deployment_type has value 'enroll'.     The count of attributes in this property should be equal to count attributes in gplus_remote_attributes_list property.     Local attributes list should contains next mandatory attributes: uid, mail, givenName, sn, cn.     Example: uid, mail, givenName, sn, cn, preferredLanguage</p> <p>5) extension_module - Specify external module name. It's optional property. External module should implements 2 methods:     def init(conf_attr):     ...     return True/False</p> <pre><code>def postLogin(conf_attr, user):\n...\nreturn True/False\n\nScripts calls init method at initialization. And calls postLogin after user log in order to execute additional custom workflow.\n</code></pre> <p>6) gplus_client_configuration_attribute - Specify client entry attribute name which can override gplus_client_secrets_file file content. It's optional property.     It can be used in cases when all clients should use separate gplus_client_secrets.json configuration.</p>"},{"location":"script-catalog/person_authentication/other/idfirst/","title":"Identifier-first authentication","text":"<p>This custom script allows administrators to implement the following workflow:</p> <ol> <li>User is presented with a form asking for username only</li> <li>User is shown a form asking for password only (username field is not editable)</li> <li>User is taken to a page where he is challenged to present a second factor (strong credential) for completion of authentication</li> </ol> <p>After form submission in step 1, the suitable user entry is looked up and an attribute is expected to contain an acr value corresponding to an already existing and enabled custom script that determines the second factor.</p> <p>If the attribute is not existing, the \"basic\" acr will be used. Thus, the basic script needs to be enabled as well in Gluu server.</p> <p>For numerals 2 and 3 to work properly, all custom scripts to be used (basic, u2f, super_gluu, ect.) should be edited so that the getPageForStep uses the custom page named \"alter_login.xhtml\".  In other words, comment out the line showing</p> <pre><code>`return \"\"`\n</code></pre> <p>by prefixing it with a <code>#</code> character and add one with</p> <pre><code>`return \"/auth/idfirst/alter_login.xhtml\"`\n</code></pre> <p>in the subroutine \"getPageForStep\" of every script.</p>"},{"location":"script-catalog/person_authentication/other/idfirst/#requirements","title":"Requirements:","text":"<ul> <li>To configure the user attribute to lookup for an acr (and thus a second factor), add \"acr_attribute\" as a property of the Identifier-first custom script via oxTrust.</li> </ul> <p>Example:</p> <p>name: acr_attribute value: oxPreferredMethod</p> <p>where <code>oxPreferredMethod</code> is an LDAP attribute part of GluuPerson object class.</p> <ul> <li> <p>Copy the accompanying custom pages to <code>/opt/gluu/jetty/oxauth/custom/pages/idfirst</code>, namely <code>alter_login.xhtml</code>, <code>alter_login.page.xml</code> (3.0.2 only), and <code>idfirst_login.xhtml</code>. This is only required if your Gluu Server wasn't originally bundled with this script</p> </li> <li> <p>Ensure this script has a low level set in oxTrust. All other scripts to which this scripts forwards to must be greater in level than this.</p> </li> </ul>"},{"location":"script-catalog/person_authentication/other/idfirst/README_idfirst/","title":"Identifier-first authentication","text":"<p>This custom script allows administrators to implement the following workflow:</p> <ol> <li>User is presented with a form asking for username only</li> <li>User is shown a form asking for password only (username field is not editable)</li> <li>User is taken to a page where he is challenged to present a second factor (strong credential) for completion of authentication</li> </ol> <p>After form submission in step 1, the suitable user entry is looked up and an attribute is expected to contain an acr value corresponding to an already existing and enabled custom script that determines the second factor.</p> <p>If the attribute is not existing, the \"basic\" acr will be used. Thus, the basic script needs to be enabled as well in Gluu server.</p> <p>For numerals 2 and 3 to work properly, all custom scripts to be used (basic, u2f, super_gluu, ect.) should be edited so that the getPageForStep uses the custom page named \"alter_login.xhtml\".  In other words, comment out the line showing</p> <pre><code>`return \"\"`\n</code></pre> <p>by prefixing it with a <code>#</code> character and add one with</p> <pre><code>`return \"/auth/idfirst/alter_login.xhtml\"`\n</code></pre> <p>in the subroutine \"getPageForStep\" of every script.</p>"},{"location":"script-catalog/person_authentication/other/idfirst/README_idfirst/#requirements","title":"Requirements:","text":"<ul> <li>To configure the user attribute to lookup for an acr (and thus a second factor), add \"acr_attribute\" as a property of the Identifier-first custom script via oxTrust.</li> </ul> <p>Example:</p> <p>name: acr_attribute value: oxPreferredMethod</p> <p>where <code>oxPreferredMethod</code> is an LDAP attribute part of GluuPerson object class.</p> <ul> <li> <p>Copy the accompanying custom pages to <code>/opt/gluu/jetty/oxauth/custom/pages/idfirst</code>, namely <code>alter_login.xhtml</code>, <code>alter_login.page.xml</code> (3.0.2 only), and <code>idfirst_login.xhtml</code>. This is only required if your Gluu Server wasn't originally bundled with this script</p> </li> <li> <p>Ensure this script has a low-level set in oxTrust. All other scripts to which this script forwards must be greater in level than this.</p> </li> </ul>"},{"location":"script-catalog/person_authentication/other/otp/","title":"One-Time Password (OTP) Authentication","text":"<p>Gluu's OTP interception script uses the two-factor event/counter-based HOTP algorithm RFC4226 and the time-based TOTP algorithm RFC6238.</p> <p>In order to use this authentication mechanism users will need to install a mobile authenticator, like Google Authenticator 2, that supports HOTP/TOTP.</p>"},{"location":"script-catalog/person_authentication/other/otp/#external-jars","title":"External Jars","text":"<ol> <li>oauth-otp.jar  Use following group id and artifact id in maven a. com.lochbridge.oath oath-otp</li> </ol> <p>b.  com.lochbridge.oath oath-otp-keyprovisioning</p> <p>c. com.lochbridge.oath oath-parent</p>"},{"location":"script-catalog/person_authentication/other/otp/Properties%20description/","title":"Properties description","text":"<p>Script contents here</p> <p>This is a person authentication script for jans-auth-server which enables one-time password for user authentication.</p> <p>The module has a few properties:</p> <p>1) otp_type - It's mandatory property. It's specify OTP mode: HOTP/ TOTP.    Allowed values: hotp/totp    Example: hotp</p> <p>2) issuer - It's mandatory property. It's company name.    Example: Janssen Inc</p> <p>3) otp_conf_file - It's mandatory property. It's specify path to OTP configuration JSON file.    Example: /etc/certs/otp_configuration.json</p> <p>4) label - It's label inside QR code. It's optional property.     Example: Janssen OTP</p> <p>5) qr_options - Specify width and height of QR image. It's optional property.     Example: qr_options: { width: 400, height: 400 }</p> <p>6) registration_uri - It's URL to page where user can register new account. It's optional property.     Example: https://ce-dev.jans.org/identity/register</p>"},{"location":"script-catalog/person_authentication/other/passport/","title":"Index","text":"<p>Passport is a person authentication module for oxAuth that enables Google+ Authentication, Twitter Authentication, Facebook Authentication etc. for user authentication.</p> <p>The module has a few properties:</p> <p>1) generic_remote_attributes_list - It's mandatory property. Comma-separated list of attribute names. Specify list of User claims(attributes) which script should use to map to local attributes. The count of attributes in this property should be equal to count attributes in generic_local_attributes_list property. Example: <code>username, email, name, name, givenName, familyName, provider</code></p> <p>2) generic_local_attributes_list - It's mandatory property. Comma-separated list of attribute names. Specify list of local attributes mapped from passport userInfo response. The count of attributes in this property should be equal to count attributes in generic_remote_attributes_list property. Local attributes list should contains next mandatory attributes: uid, mail, givenName, sn, cn. Example: <code>uid, mail, cn, displayName, givenName, sn, provider</code></p>"},{"location":"script-catalog/person_authentication/other/registration/","title":"Index","text":"<p>This is a person authentication module for oxAuth that allows user to register first and login to server.</p> <p>Required Custom property (key/value) - 1) generic_register_attributes_list = email,fname,lname,email,phone,pwd 2) generic_local_attributes_list  = uid,givenName,sn,mail,telephoneNumber,userPassword</p>"},{"location":"script-catalog/person_authentication/other/saml/","title":"Index","text":"<p>This authentication interception script configures oxAuth to use an external SAML identity provider. This approach enables you to dynamically enroll users in your Gluu Server after they authenticate at their home IDP--meaning you can create a local ldap entry for each new inbound SAML user. This is handy because it enables you to use either SAML or OpenID Connect API's that connect to the Gluu Server. Confusing? Yes! Handy... yes, yes!</p>"},{"location":"script-catalog/person_authentication/other/saml/#installation","title":"Installation","text":"<p>This list of steps needed to do to enable Asimba/SAML person authentication module.</p> <ol> <li> <p>This module depends on python libraries. In order to use it we need to install Jython. Please use next articles to proper Jython installation:</p> <ul> <li>Installation notest: http://ox.gluu.org/doku.php?id=oxtauth:customauthscript#jython_installation_optional</li> <li>Jython integration: http://ox.gluu.org/doku.php?id=oxtauth:customauthscript#jython_python_integration</li> </ul> </li> <li> <p>Prepare file with IdP public certificate /etc/certs/saml.pem  </p> </li> <li> <p>Confire new custom module in oxTrust:</p> <ul> <li>Log into oxTrust with administrative permissions.</li> <li>Open \"Configuration\u2192Manage Custom Scripts\" page.</li> <li>Select \"Person Authentication\" tab.</li> <li>Click on \"Add custom script configuration\" link.</li> <li>Enter name = saml</li> <li>Enter level = 0-100 (priority of this method).</li> <li>Select usage type \"Interactive\".</li> <li>Add custom required and optional properties which specified in README.txt.</li> <li>Copy/paste script from AsimbaPersonAuthentication.py.</li> <li>Activate it via \"Enabled\" checkbox.</li> <li>Click \"Update\" button at the bottom of this page.</li> </ul> </li> <li> <p>Configure oxAuth to use SAML authentication by default:</p> <ul> <li>Log into oxTrust with administrative permissions.</li> <li>Open \"Configuration\u2192Manage Authentication\" page.</li> <li>Scroll to \"Default Authentication Method\" panel. Select \"saml\" authentication mode.</li> <li>Click \"Update\" button at the bottom of this page.</li> </ul> </li> <li> <p>Try to log in using SAML authentication method:</p> <ul> <li>Wait 30 seconds and try to log in again. During this time oxAuth reload list of available person authentication modules.</li> <li>Open second browser or second browsing session and try to log in again. It's better to try to do that from another browser session because we can return back to previous authentication method if something will go wrong.</li> </ul> </li> </ol> <p>There are log messages in this custom authentication script. In order to debug this module we can use command like this: tail -f /opt/tomcat/logs/wrapper.log | grep \"Saml\"</p>"},{"location":"script-catalog/person_authentication/other/saml/#properties","title":"Properties","text":"<p>This module has next properties: 1) asimba_saml_certificate_file - It's path to file which contains public IdP certificate in.    Example: /etc/certs/saml.pem</p> <p>2) saml_idp_sso_target_url - The URL at the Identity Provider where to the authentication request should be sent.    Example: https://test.gluu.org/asimba/profiles/saml2/sso/web</p> <p>3) asimba_entity_id - Set the issuer of the authentication request. This would usually be the URL of the issuing web application    Example: https://test.gluu.info/saml</p> <p>4) saml_use_authn_context - Specify if Saml request should contains samlp:RequestedAuthnContext section.    Allowed values: true/false    Example: true</p> <p>5) saml_name_identifier_format - Specify in which format IdP should return a name identifier for the user.    This property isn't required when saml_use_authn_context has value 'false'    Example: urn:oasis:namesSAML:2.0:nameid-format:persistent</p> <p>6) saml_deployment_type - Specify deployment mode. It's optional property. If this property isn't specified Saml script    tries to find user in local LDAP by 'Persistent Id' specified in Saml response. If this property has 'map' value Saml script map    should map 'Persistent Id' to local user account. If this property has 'enroll' value Saml script should add new user to local LDAP    with status 'register'. In order to map IDP attributes to local attributes it uses propertiessaml_idp_attributes_list and    saml_local_attributes_list.    Allowed values: map/enroll/enroll_all_attr    Example: enroll</p> <p>7) saml_validate_response - Specify if Saml script should valide Saml response signature. The path to IdP certificate should be specified in    asimba_saml_certificate_file property. It's optional property. Default mode specify to validate Saml response.    Allowed values: true/false    Example: true</p> <p>8) saml_client_configuration_attribute - Specify oxAuth client entry attribute name which contains Saml configuration in JSON format which    allow to override next properties: asimba_saml_certificate_file, asimba_entity_id, saml_use_authn_context, saml_idp_attributes_list, saml_local_attributes_list.    It's optional property.    Property asimba_saml_certificate_file isn't mandatory. If the value is empty Smal script use global asimba_saml_certificate_file value.    Example: oxAuthExtraConf    Example content of client oxAuthExtraConf attribute: {\"saml_certificate_file\": \"\", \"asimba_entity_id\": \"https://localhost/app1\", \"saml_use_authn_context\": \"false\", \"saml_idp_attributes_list\": \"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname\", \"saml_local_attributes_list\": \"uid, mail, givenName, sn, cn\"}</p> <p>9) saml_idp_attributes_list - Comma separated list of attribute names. Specify list of IdP attributes which Saml scrpt should use to map to local attributes.    It's optional property. It's manadatory only if saml_deployment_type has value 'enroll'.    The count of attributes in this property should be equal to count attributes in saml_local_attributes_list property.    Example: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname</p> <p>10) saml_local_attributes_list - Comma separated list of attribute names. Specify list of local attributes mapped from Saml response.     It's optional property. It's manadatory only if saml_deployment_type has value 'enroll'.     The count of attributes in this property should be equal to count attributes in saml_idp_attributes_list property.     Local attributes list should contains next mandatory attributes: uid, mail, givenName, sn, cn.     Example: uid, mail, givenName, sn, cn</p> <p>11) user_object_classes - Specify custom list of LDAP user object classes    Example: eduPerson</p> <p>12) enforce_uniqueness_attr_list - Specify list of unique user attributes to validate if there is no user with simular attributes already    Example: uid, mail</p> <p>13) saml_extension_module - Specify external module name. It's optional property. External module should implements 2 methods:     def init(conf_attr):     ...     return True/False</p> <pre><code>def postLogin(conf_attr, user):\n...\nreturn True/False\n\nSAML scripts calls init method at initialization, and calls postLogin after to execute additional custom workflow.\n</code></pre> <p>14) saml_allow_basic_login - Specify if authentication module should allow both: basic and saml authentications    Example: false</p>"},{"location":"script-catalog/person_authentication/other/twilio_sms/","title":"Index","text":"<p>Twilio SMS Authentication Script</p> <p>This is a two step authentication workflow. The first step is standard username password authentication against the local Gluu Server MySQL. The second step requires the person to enter a code that is sent via SMS to the person's mobile number.</p> <p>Script contents here</p>"},{"location":"script-catalog/person_authentication/other/uaf/","title":"Index","text":"<p>Script contents here</p> <p>This is a person authentication script for jans-auth-server that enables UAF for user authentication.</p> <p>The module has a few properties:</p> <p>1) uaf_server_uri - It's mandatory property. It's URL to UAF server.    Example: https://ce-dev.jans.org</p> <p>2) uaf_policy_name - Specify UAF policy name. It's optional property.    Example: default</p> <p>3) send_push_notifaction - Specify if UAF server should send push notifications to person mobile phone.    It's optional property.    Allowed values: true/false    Example: false</p> <p>4) registration_uri - It's URL to page where user can register new account. It's optional property.     Example: https://ce-dev.jans.org/identity/register</p> <p>5) qr_options - Specify width and height of QR image. It's optional property.     Example: qr_options: { width: 400, height: 400 }</p>"},{"location":"script-catalog/person_authentication/other/uaf/Properties%20description/","title":"Properties description","text":"<p>Script contents here</p> <p>This is a person authentication script for jans-auth-server that enables UAF for user authentication.</p> <p>The module has a few properties:</p> <p>1) uaf_server_uri - It's mandatory property. It's URL to UAF server.    Example: https://ce-dev.jans.org</p> <p>2) uaf_policy_name - Specify UAF policy name. It's optional property.    Example: default</p> <p>3) send_push_notifaction - Specify if UAF server should send push notifications to person mobile phone.    It's optional property.    Allowed values: true/false    Example: false</p> <p>4) registration_uri - It's URL to page where user can register new account. It's optional property.     Example: https://ce-dev.jans.org/identity/register</p> <p>5) qr_options - Specify width and height of QR image. It's optional property.     Example: qr_options: { width: 400, height: 400 }</p>"},{"location":"script-catalog/person_authentication/other/wwpass/","title":"WWPass integration for Gluu","text":"<p>WWPass replaces the traditional username and password login with a more advanced multi-factor authentication solution. WWPass employs strong cryptography and robust combination of authentication factors to deliver a secure and user-friendly authentication experience. WWPass authentication starts with a smartphone app or a hardware token as the first authentication factor. Then additional authentication factors such as PIN or biometrics can be added to verify the user identity further.</p>"},{"location":"script-catalog/person_authentication/other/wwpass/#installation","title":"Installation","text":"<p>To install WWPass support in Gluu server refer to INSTALLATION.md.</p> <p>To install additional components refer to main wwpass-gluu repository at https://github.com/wwpass/gluu</p>"},{"location":"script-catalog/person_authentication/other/wwpass/#contacts","title":"Contacts","text":"<p>Feel free to contact WWPass at support@wwpass.com if you have trouble integrating WWPass in your Gluu setup</p>"},{"location":"script-catalog/person_authentication/other/wwpass/INSTALLATION/","title":"Setting Up WWPass Authentication in Gluu Server","text":""},{"location":"script-catalog/person_authentication/other/wwpass/INSTALLATION/#introduction","title":"Introduction","text":"<p>WWPass replaces the traditional username and password login with a more advanced multi-factor authentication solution. WWPass employs strong cryptography and robust combination of authentication factors to deliver a secure and user-friendly authentication experience. WWPass authentication starts with a smartphone app or a hardware token as the first authentication factor. Then additional authentication factors such as PIN or biometrics can be added to verify the user identity further.</p> <p>Gluu Server is a container distribution of free open source software (FOSS) for identity and access management (IAM). Gluu Server combines SAML 2.0, LDAP, OpenID Connect, and other authentication and authorization protocol implementations to create a platform for user authentication, identity information, and policy decisions.</p> <p>Combining WWPass strong multi-factor authentication with the versatility of Gluu Server helps to build secure IAM solutions that can be used for single sign-on (SSO), customer identity and access management (CIAM), and identity federation.</p>"},{"location":"script-catalog/person_authentication/other/wwpass/INSTALLATION/#prerequisites","title":"Prerequisites","text":"<p>This tutorial assumes that you have the following:</p> <ul> <li>Gluu Server 4.1.1 installed on Ubuntu Server 18.04 or 16.04;</li> <li>An administrative account on this Ubuntu Server;</li> <li>An application certificate and private key for WWPass authentication;</li> <li>WWPass Key app or hardware token;</li> </ul>"},{"location":"script-catalog/person_authentication/other/wwpass/INSTALLATION/#obtain-application-certificate-and-private-key-from-wwpass","title":"Obtain Application Certificate and Private Key From WWPass","text":"<p>To obtain an application certificate and private key go to wwpass.com, click Sign Up to create a developer account or Log In if you already have an account. Then follow the website instructions to register your application domain and issue the application certificate.</p>"},{"location":"script-catalog/person_authentication/other/wwpass/INSTALLATION/#prepare-wwpass-integration-files","title":"Prepare WWPass Integration Files","text":"<p>Copy this directory to your Gluu server and make it current <pre><code>cd wwpass\n</code></pre></p> <p>Files in <code>pages</code> directory should be deployed to <code>/opt/gluu-server/opt/gluu/jetty/oxauth/custom/pages/</code></p> <pre><code>sudo cp -rL pages/* /opt/gluu-server/opt/gluu/jetty/oxauth/custom/pages/\n</code></pre> <p>Files in <code>static</code> directory should be deployed to <code>/opt/gluu-server/opt/gluu/jetty/oxauth/custom/static/</code></p> <pre><code>sudo cp -rL pages/* /opt/gluu-server/opt/gluu/jetty/oxauth/custom/static/\n</code></pre> <p>Copy <code>wwpass.py</code> to <code>/opt/gluu-server/opt/gluu/python/libs/</code></p> <pre><code>sudo cp wwpass.py /opt/gluu-server/opt/gluu/python/libs/\n</code></pre> <p>Copy <code>ticket.json</code> to <code>/opt/gluu-server/opt/wwpass_gluu/cgi</code></p> <pre><code>sudo mkdir -p /opt/gluu-server/opt/wwpass_gluu/cgi\nsudo cp ticket.json /opt/gluu-server/opt/wwpass_gluu/cgi\n</code></pre> <p>Make sure <code>ticket.json</code> is executable</p> <pre><code>sudo chmod 755 /opt/gluu-server/opt/wwpass_gluu/cgi/ticket.json\n</code></pre> <p>Copy WWPass application certificate and private key to <code>/opt/gluu-server/opt/wwpass_gluu/</code> (assuming the certificate and key files are in your home directory)</p> <pre><code>sudo cp ~/gluu_client.crt /opt/gluu-server/opt/wwpass_gluu/gluu_client.crt\nsudo cp ~/gluu_client.key /opt/gluu-server/opt/wwpass_gluu/gluu_client.key\n</code></pre> <p>Replace <code>~/gluu_client.crt</code> and <code>~/gluu_client.key</code> with the names and location of your certificate and key files.</p> <p>Copy WWPass CA certificate <code>wwpass.ca.crt</code> to <code>/opt/gluu-server/opt/wwpass_gluu/</code></p> <pre><code>sudo cp wwpass.ca.crt /opt/gluu-server/opt/wwpass_gluu\n</code></pre> <p>Log in to the Gluu Server container</p> <pre><code>sudo /sbin/gluu-serverd login\n</code></pre> <p>Change ownership of files and directories just copied</p> <pre><code>chown -R jetty:jetty /opt/jetty\nchown root:gluu /opt/gluu/python/libs/wwpass.py\n</code></pre>"},{"location":"script-catalog/person_authentication/other/wwpass/INSTALLATION/#configure-apache","title":"Configure Apache","text":"<p>Use your favorite console text editor to change Apache configuration</p> <pre><code>[vi|nano|joe|...] /opt/gluu-server/etc/apache2/sites-available/https_gluu.conf\n</code></pre> <p>Scroll down the file until you find the last <code>&lt;Location&gt;...&lt;/Location&gt;</code> tag and insert the following snippet below it:</p> <pre><code>&lt;Location /wwpass&gt;\n  require all granted\n&lt;/Location&gt;\n\nScriptAlias \"/wwpass/\" \"/opt/wwpass_gluu/cgi/\"\n\n&lt;Directory /opt/wwpass_gluu/cgi/&gt;\n  SetHandler cgi-script\n  Options +ExecCGI\n  Order deny,allow\n  Allow from all\n&lt;/Directory&gt;\n</code></pre> <p>Save the file and exit the editor.</p> <p>Enable mod_cgi and restart apache:</p> <pre><code>a2enmod cgi\nsystemctl restart apache2\n</code></pre> <p>Check that <code>ticket.json</code> is working. Go to <code>https://&lt;your_gluu_host&gt;/wwpass/ticket.json</code>. If your setup is correct, you will see output like this:</p> <pre><code>{\"result\": true, \"data\": \"SPNAME:07629a1963c5e4f4f339ecb852b7a0bf10a90c62@p-sp-05-50:16033\", \"ttl\": 600, \"encoding\": \"plain\"}\n</code></pre>"},{"location":"script-catalog/person_authentication/other/wwpass/INSTALLATION/#configure-gluu-server","title":"Configure Gluu Server","text":"<p>Log in as administrator and go to \"Configuration -&gt; Manage Custom scripts\".</p> <p>In <code>Person Authentication</code> tab, click <code>Add custom script configuration</code> at the bottom of the page</p> <p>Create custom script <code>wwpass</code> with Location Type set to <code>Database</code>.</p> <p>Add the following to <code>Custom Property</code> fields by clicking on <code>Add new property</code> button:</p> <ul> <li>wwpass_crt_file: /opt/wwpass_gluu/gluu_client.crt</li> <li>wwpass_key_file: /opt/wwpass_gluu/gluu_client.key</li> <li>registration_url: URL of the registration web application, if you have one. Do not add this property otherwise</li> <li>recovery_url: URL for account recovery, if you have one. Do not add this property otherwise.</li> </ul> <p>To require PIN or biometrics during login, add:</p> <ul> <li>use_pin: True</li> </ul> <p>To enable binding WWPass keys with email, add:</p> <ul> <li>allow_email_bind: True</li> </ul> <p>Note, your Gluu server should be able to send emails, see <code>Configuration -&gt; Organization configuration -&gt; SMTP Server Configuration</code>.</p> <p>To enable binding WWPass keys with existing usernames and passwords, add:</p> <ul> <li>allow_password_bind: True</li> </ul> <p>To enable binding WWPass keys with another WWPass key, add:</p> <ul> <li>allow_passkey_bind: True</li> </ul> <p>Replace the content of <code>Script</code> textbox with the content of <code>wwpassauth.py</code> from <code>gluu-master</code></p> <p>Set <code>Enabled</code> checkbox to enable the custom script:</p> <p>Click the <code>Update</code> button.</p> <p>It's also recommended to increase the unauthenticated session lifetime to give users more time to bind their WWPass keys.</p> <p>Go to <code>Configuration -&gt; JSON configuration -&gt; OxAuth Configuration</code>, find <code>sessionIdUnauthenticatedUnusedLifetime</code> setting and set it to <code>600</code> or more.</p> <p>Click <code>Update</code> to save settings.</p>"},{"location":"script-catalog/person_authentication/other/wwpass/INSTALLATION/#set-up-authentication-method","title":"Set up Authentication Method","text":"<p>Before switching to WWPass authentication, make sure you have opened an administrator session in a different browser (not in a different window, but a completely different browser). Do not close that browser window and reload it from time to time to make sure your session does not expire.</p> <p>Keep the backup session opened until you are sure that WWPass authentication works properly or you might lock yourself out of Gluu. If that happens, refer to: Gluu FAQ</p> <p>In the Gluu Admin interface, navigate to <code>Configuration -&gt; Manage Authentication -&gt; Default Authentication Method</code>. Set both options to \"wwpass\".</p> <p>Click <code>Update</code> to save settings.</p>"},{"location":"script-catalog/person_authentication/other/wwpass/INSTALLATION/#test-your-setup","title":"Test Your Setup","text":"<p>Open \"https:///\" in a different browser (not the one you used to configure Gluu). <p>Try to sign in to your Gluu server with WWPass and bind your key using either email or username and password.</p> <p>If something does not work as expected, return to your main browser and revert <code>Configuration -&gt; Manage Authentication -&gt; Default Authentication Method</code> back to <code>auth_ldap_server</code> while you troubleshoot the problem.</p>"},{"location":"script-catalog/person_authentication/other/wwpass/INSTALLATION/#troubleshooting","title":"Troubleshooting","text":"<p>Relevant Gluu log files are:</p> <ul> <li><code>/opt/gluu-server/opt/gluu/jetty/oxauth/logs/oxauth.log</code></li> <li><code>/opt/gluu-server/opt/gluu/jetty/oxauth/logs/oxauth_script.log</code></li> </ul> <p>Check the files above for any errors. Errors in <code>wwpass</code> interception script are also displayed in Gluu web interface at 'Configuration -&gt; Manage Custom scripts'. If there are any errors in the script, its name will be in red and the script editor will display the red button named \"Show Error\".</p> <p>Feel free to contact WWPass at support@wwpass.com if you have troubles integrating WWPass in your Gluu Server.</p>"},{"location":"script-catalog/person_authentication/other/yubicloud/","title":"Yubicloud OTP Validataion","text":"<p>Script contents here</p> <p>This is a single step authentication workflow. Instead of a human entering a password, Yubico's Yubikey OTP will be taken in as password.</p> <p>This script uses the Yubicloud Service by Yubico for validation of the OTP.</p> <p>Here are the steps required to setup the Yubico OTP as password.</p> <pre><code>1. Setup a custom attribute named the `yubikeyId`.  Add this attribute the\n   users who have to be authenticated via this method. Store the public part\n   of the Yubikey Idendity (usually the first 12 chars of OTP) in this\n   attribute against each user. This matches the user against the key.\n\n    Setting up Custom Attributes: https://www.gluu.org/docs/customize/attributes/\n    Find the Yubikey Idendity: https://demo.yubico.com\n\n2. Register for a Yubicloud API Key and get client ID and client Secret.\n   https://upgrade.yubico.com/getapikey/\n\n3. Configure the custom script:\n    i) Enter the value for `yubicloud_uri` as any one of the following:\n        api.yubico.com\n        api2.yubico.com\n        api3.yubico.com\n        api4.yubico.com\n        api5.yubico.com\n    ii) Enter the client secret as `yubicloud_api_key`\n    iii) Enter the client ID as `yubicloud_id`\n</code></pre> <p>Now the method <code>yubicloud</code> can be set as the authentication mechanism and Yubikey can be used in place of the password of the users for authentication.</p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/","title":"Index","text":"<p>Super Gluu is an open source, push-notification two-factor authentication (2FA) mobile app which can be integrated to work with the Janssen Server. Super Gluu uses public-key encryption as specified in the FIDO U2F authentication standard. Upon device enrollment, Super Gluu registers its public key against the Janssen's FIDO Server's <code>super_gluu_registration_endpoint</code> endpoint. Authentication takes place at <code>super_gluu_authentication_endpoint</code> where a challenge response ensures that the device has the corresponding private key.</p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#janssens-super-gluu-endpoint","title":"Janssen's Super Gluu endpoint","text":"<p>The fido2 server serves the registration and authentication of Super Gluu credentials, the URI of which can be found at <code>https://&lt;my.jans.server&gt;/.well-known/fido2-configuration</code>. However, this feature has to be enabled first, else the endpoints <code>super_gluu_registration_endpoint</code> and <code>super_gluu_authentication_endpoint</code> will not show up by default.</p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#prerequisites","title":"Prerequisites:","text":""},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#a-install-the-fido2-server","title":"A. Install the FIDO2 server:","text":"<p>The Fido2 server would have been installed during the initial server setup.</p> <p>If not installed, follow these steps to install the FIDO2 server. 1. <code>setup.py</code> was already run during installation. Run <code>setup.py</code> once again. <pre><code>python3 /opt/jans/jans-setup/setup.py\n</code></pre> 2.  The script will detect that you already have a jans installation and you will be prompted to install the uninstalled components. 3. Select the <code>FIDO2 server</code> and complete the post install process.</p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#b-enable-the-super-gluu-endpoint","title":"B. Enable the Super Gluu endpoint:","text":"<ol> <li>Use the TUI to enable \"Super Gluu\" feature </li> </ol>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#c-mobile-device-with-super-gluu-installed","title":"C. Mobile device with Super Gluu installed","text":"<ul> <li>Super Gluu for iOS </li> <li>Super Gluu for Android </li> </ul>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#d-publicly-discoverable-dns","title":"D. Publicly Discoverable DNS :","text":"<ul> <li> <p>An Internet accessible (non-internal or localhost) Janssen Server with DNS pointing at the public Internet address of the server</p> </li> <li> <p>If the Jannsen Server is using a self-signed certificate, <code>Trust All</code> must be enabled in Super Gluu (open the app, navigate to <code>Menu</code> &gt; <code>Trust all (SSL)</code> and enable)</p> </li> </ul> <p>Note</p> <p>The Janssen Server and Super Gluu can work in the same network, without a DNS server hostname and with a self-signed certificate. There is only one limitation: both components should belong to the same network. Instead of assigning a hostname during Janssen Server installation, an IP address can be specified. In the Super Gluu mobile app, enable <code>Trust all (SSL)</code>.</p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#e-push-notification-server-hosted-by-gluu","title":"E. Push Notification Server hosted by Gluu:","text":"<p>The Notification server should be configured to receive push notifications on registered mobile devices.</p> <p>Configure <code>/etc/certs/super_gluu_creds.json</code>. For each Mobile app (Android, iOS); place the Access key / Secret key of Push Notification server. <pre><code>{\n       \"android\":{\n           \"gluu\":{\n               \"enabled\":true,\n               \"access_key\":\"36W......BP\",\n               \"secret_access_key\":\"ueq.....fek\"\n           }\n       },\n       \"ios\":{\n           \"gluu\":{\n               \"enabled\":true,\n               \"access_key\":\"auO......6V\",\n               \"secret_access_key\":\"f0......oei\"\n           }\n       },\n       \"gluu\":{\n           \"server_uri\":\"https://api.gluu.org\"\n       }\n   }\n</code></pre></p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#user-and-developer-guides","title":"User and Developer Guides","text":"<p>User and Developer Guides can be found on the Super Gluu docs site.</p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#interception-script","title":"Interception script","text":"<ul> <li>Super Gluu interception script is included in the default Janssen Server distribution</li> </ul> <p>The Super Gluu Interception script can be configured to work in 2 modes: A. Two step Flow (Default mode) B. One step Flow</p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#a-two-step-flow-default-mode","title":"A. Two step flow (Default mode):","text":""},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#enrollment","title":"Enrollment:","text":"<p>By default, users are put through a two-step, two-factor authentication process with username and password in the first step, and then push notification via Super Gluu in the second step. <pre><code>sequenceDiagram\ntitle SuperGluu Flow Enrollment \"Two step\"\n\nautonumber 1\nparticipant User\nparticipant Mobile App\nparticipant Browser\nparticipant Notification server\nparticipant Jans AS\n\nUser-&gt;&gt; Browser: Log in step1 (userid , pwd)\nBrowser -&gt;&gt;Jans AS: send userid ,pwd\nJans AS-&gt;&gt;Browser: validate, present enrollment (QR code) of SG\nUser-&gt;&gt;Mobile App:  Scans the QR code\nMobile App-&gt;&gt; Mobile App: Enrollment saved on app \\n (username, appId, keyHandle, date)\nMobile App-&gt;&gt;Jans AS :  Enrollment completed, &lt;br/&gt;enrollment data (registrationData, clientData, deviceData ) sent to Jans AS\nJans AS-&gt;&gt;Jans AS: Enrollment entry stored in Database\nJans AS-&gt;&gt;Browser: Enrollment completed.\n</code></pre></p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#a-client-data","title":"A. Client data","text":"<p>An example of the contents of client data are as follows: <pre><code>{\n  \"typ\": \"navigator.id.finishEnrollment\",\n  \"challenge\": \"Bkpin2iUSEQrkuSC_wDlPwzLfVwRGxLbySpVm8jwkuk\",\n  \"origin\": \"https://my.jans.server\"\n}\n</code></pre></p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#b-device-data","title":"B. Device data","text":"<p>An example of the contents of client data are as follows:</p> <p><pre><code>{\n  \"uuid\": \"BBA72798-9A1C-4866-819F-819C011ED129\",\n  \"type\": \"iPhone\",\n  \"platform\": \"ios\",\n  \"name\": \"ABC\u2019s iPhone\",\n  \"os_name\": \"iOS\",\n  \"os_version\": \"15.4\",\n  \"custom_data\": null,\n  \"push_token\": \"8fc4bd31e2ddbc5c5d83e4955cfd36f663ab37b426d0a4ec5c685c3a6335dd2c\"\n}\n</code></pre> The push_token is used by the Push Notification server.</p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#c-registration-data","title":"C. Registration data","text":"<p>This data contains following information: counter, status, rp-application, userInum, keyHandle, Public Key, attestation certificates <pre><code>{\n  \"createdDate\": 1678374227774,\n  \"updatedDate\": 1678374228300,\n  \"createdBy\": \"johndoe\",\n  \"updatedBy\": \"johndoe\",\n  \"username\": \"johndoe\",\n  \"domain\": \"/my.jans.server\",\n  \"userId\": \"DAY7UJzdHaIXuEbQlNwBomQEPmqjsKbN4lblYqfbCZo\",\n  \"challenge\": \"jr2LtLFRF2YG65pyo__gaKoiyP9oQbPyW6hGxdZBAS8\",\n  \"attenstationRequest\": \"{\\\"super_gluu_request\\\":true,\\\"super_gluu_request_mode\\\":\\\"two_step\\\",\\\"super_gluu_app_id\\\":\\\"https:///my.jans.server/.well-known/openid-configuration\\\",\\\"username\\\":\\\"madhu1\\\",\\\"displayName\\\":\\\"madhu1\\\",\\\"session_id\\\":\\\"3d3f7560-8d83-4770-a6fb-cc83c787a511\\\",\\\"attestation\\\":\\\"direct\\\"}\",\n  \"attenstationResponse\": \"{\\\"super_gluu_request\\\":true,\\\"super_gluu_request_mode\\\":\\\"two_step\\\",\\\"type\\\":\\\"public-key\\\",\\\"response\\\":{\\\"deviceData\\\":\\\"eyJuYW1lIjoiTmV4dXMgN......lLWU2ZjMtMzRlNC1hYWMxLTlhYTViOGI3MTUyOCJ9\\\",\\\"clientDataJSON\\\":\\\"eyJjaGFsbGVuZ2UiOiJqcjJM....QuZmluaXNoRW5yb2xsbWVudCJ9\\\",\\\"super_gluu_request_cancel\\\":false,\\\"attestationObject\\\":\\\"v2NmbXRzZmlkby11MmYtc3VwZXItZ2x1....gC5NYTNE-GAS3AUoD-DI9R__8\\\"},\\\"id\\\":\\\"-G1Bpm_7j0A2UIciKSPz7ku7pA2d9azzJyFQCd4Xh67Hh0gBDXAH9B--IX3hZYxtGEmY7nM01PV5Gq53O5FSsg\\\"}\",\n  \"uncompressedECPoint\": \"v2ExAmEzJmItMQFiLTJYINmwCcnnXf6CxMCOG6bjAT5aXHCqIhgYDrBvEuKW6bWuYi0zWCARbzLZN8ytE1JiVAs0UMLoAuTWEzRPhgEtwFKA_gyPUf8\",\n  \"publicKeyId\": \"-G1Bpm_7j0A2UIciKSPz7ku7pA2d9azzJyFQCd4Xh67Hh0gBDXAH9B--IX3hZYxtGEmY7nM01PV5Gq53O5FSsg\",\n  \"type\": \"public-key\",\n  \"status\": \"registered\",\n  \"counter\": 0,\n  \"attestationType\": \"fido-u2f-super-gluu\",\n  \"signatureAlgorithm\": -7,\n  \"applicationId\": \"https:///my.jans.server/.well-known/openid-configuration\"\n}\n</code></pre></p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#authentication","title":"Authentication:","text":"<pre><code>sequenceDiagram\ntitle Super Gluu Authentication flow \"Two step\"\nautonumber 1\nUser-&gt;&gt;Browser: Login\nBrowser-&gt;&gt;Jans AS:  username and pwd\nJans AS-&gt;&gt;Jans AS: Authenticate\nJans AS-&gt;&gt;Notification server:call push API, use push token from device entry\nNotification server-&gt;&gt;Mobile App: Sends push to mobile device\nJans AS-&gt;&gt;Browser:  Present option of authenticating with QR code\nUser-&gt;&gt;Mobile App: Approve / Reject Push\nMobile App-&gt;&gt;Jans AS: Complete (finish) authentication process, send push_token for storing in Device entry of Gluu server\nJans AS-&gt;Jans AS: validate response, If successful, update device entry,</code></pre>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#b-one-step-flow","title":"B. One step flow","text":"<p>An alternative authentication workflow, password-less authentication, can be configured by adjusting the script property <code>authentication_mode</code>.</p> <p><pre><code>sequenceDiagram\ntitle SuperGluu Flow Enrollment \"One step\"\n\nautonumber 1\nparticipant User\nparticipant Mobile App\nparticipant Browser\nparticipant Notification server\nparticipant Jans AS\n\nUser-&gt;&gt; Browser: RP page which invokes /authorize call\nJans AS-&gt;&gt;Browser: validate, present enrollment (QR code) of SG\nUser-&gt;&gt;Mobile App:  Scans the QR code\nMobile App-&gt;&gt; Mobile App: Enrollment saved on app \\n ( appId, keyHandle, date)\nMobile App-&gt;&gt;Jans AS :  Enrollment completed, &lt;br/&gt;enrollment data (registrationData, clientData, deviceData ) sent to Jans AS\nJans AS-&gt;&gt;Jans AS: Enrollment entry stored temp entry in database under ou=fido2_register,ou=fido2,o=jans\nJans AS-&gt;&gt;Browser: Prompt user to username-password page, inorder to link the enrollment to a user\nBrowser-&gt;&gt;Jans AS: send user creds\nJans AS-&gt;&gt;Jans AS: create enrollment entry attached to the user and delete temp entry under ou=fido2_register,ou=fido2,o=jans\nJans AS-&gt;&gt;Browser: enrollment completed\n</code></pre> <pre><code>sequenceDiagram\ntitle Super Gluu Authentication flow \"One step\"\nautonumber 1\n\nparticipant User\nparticipant Mobile App\nparticipant Browser\n\n\nBrowser-&gt;&gt;Jans AS: /authorize request\nJans AS-&gt;&gt;Browser: Present QR code for scanning\nMobile App-&gt;&gt;Browser: Code is scanned\nUser-&gt;&gt;Mobile App: Approve / Reject\nMobile App-&gt;&gt; Jans AS:Send authentication request\nJans AS-&gt;&gt; Jans AS: no username, search by keyhandle\nJans AS-&gt;&gt; Jans AS: verify Super Gluu credentials,  If successful, update device entry\nJans AS-&gt;&gt;Browser: Authentication completed</code></pre></p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#custom-script-properties","title":"Custom script Properties","text":"<p>The Super Gluu authentication script has the following properties:</p> Property Description Example authentication_mode Determine factor of authentication - <code>two_step</code> or <code>one_step</code> two_step credentials_file JSON file for SuperGluu /etc/certs/super_gluu_creds.json label The name of the application Super Gluu notification_service_mode Service used to enable push notifications gluu qr_options Size of the QR code that is used for enrollment and/or authentication { size: 500, mSize: 0.05 } registration_uri Registration endpoint of the IDP https://idp.example.com/identity/register supergluu_android_download_url Android app download link, used in the login page https://play.google.com/store/apps/details?id=gluu.super.gluu supergluu_ios_download_url iOS app download link, used in the login page https://itunes.apple.com/us/app/super-gluu/id1093479646"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#notes-for-administrator","title":"Notes for administrator:","text":"<p>Configure <code>/etc/certs/super_gluu_creds.json</code>: For each Android and apple app, configure Access key / Secret key of oxNotify server</p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#enable-sign-in-with-super-gluu-authentication-script","title":"Enable Sign-in with Super-Gluu Authentication script","text":"<p>Using the OpenID Connect acr_values parameter, web and mobile clients can request any enabled authentication mechanism. To enable Super Gluu as an authentication method, follow the steps below:</p> <ol> <li>Obtain the json contents of <code>super_gluu</code> custom script by using a jans-cli command like <code>get-config-scripts-by-type</code>, <code>get-config-scripts-by-inum</code> etc.</li> </ol> <p>e.g : <code>/opt/jans/jans-cli/config-cli.py --operation-id get-config-scripts-by-type --url-suffix type:PERSON_AUTHENTICATION</code>, <code>/opt/jans/jans-cli/config-cli.py --operation-id get-config-scripts-by-inum --url-suffix inum:6122281b-b55d-4dd0-8115-b098eeeee2b7</code></p> <ol> <li>Update the custom script and change the enabled attribute to <code>true</code> Now Sign-in with Super-Gluu is an available authentication mechanism for your Janssen Server. This means that, using OpenID Connect acr_values, applications can now request Super-Gluu authentication for users.</li> </ol> <p>!!! Note To make sure <code>super_gluu</code> has been enabled successfully, you can check your Janssen's Auth Server OpenID Connect configuration by navigating to the following URL: https:///.well-known/openid-configuration. Find \"acr_values_supported\": and you should see \"super_gluu\"."},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#make-sign-in-with-super-gluu-script-as-default-authentication-script","title":"Make Sign-in with Super-Gluu Script as default authentication script:","text":"<p>Use this link as a reference.</p> <p>Steps: 1. Create a file say <code>sg-auth-default.json</code> with the following contents <pre><code>{\n  \"defaultAcr\": \"super_gluu\"\n}\n</code></pre> 2.Update the default authentication method to super_gluu <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id put-acrs --data /tmp/sg-auth-default.json\n</code></pre></p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#test-the-feature","title":"Test the feature","text":"<p>To test, enter the complete URL for authorization in a browser or create a simple webpage with a link that simulates the user sign-in attempt. If the server is configured properly, the first page for the selected authentication method will be displayed to the user.</p> <p>An example of a complete URL looks like this - <pre><code>https://&lt;your.jans.server&gt;/jans-auth/authorize.htm?response_type=code&amp;redirect_uri=https://&lt;your.jans.server&gt;/admin&amp;client_id=&lt;replace_with_inum_client_id&gt;&amp;scope=openid+profile+email+user_name&amp;state=faad2cdjfdddjfkdf&amp;nonce=dajdffdfsdcfff\n</code></pre></p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#customizations-to-super-gluu-login-pages","title":"Customizations to Super Gluu Login Pages","text":"<p>The Gluu Server includes a default public-facing pages for Super Gluu  for enrollment and authentication.</p> <p>To customize the look and feel of the pages, follow the customization guide.</p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#self-service","title":"Self-service","text":"<p>To offer end-users a portal where they can manage their own account security preferences, including two-factor authentication credentials like Super Gluu, check out our new app, Gluu Casa.</p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#manual-device-management","title":"Manual Device Management","text":"<p>A user's Super Gluu device(s) can be removed by a Janssen administrator by directly locating the user entry in MySQL. For example, let's say user <code>abc</code> loses their device and wants to enroll a new device to use Super Gluu.</p> <ol> <li> <p>Find the <code>DN</code> of the user in MySQL</p> </li> <li> <p>Find the registation under <code>ou=fido2_register</code> for associated with the user</p> </li> <li> <p>Remove the <code>jansId DN</code></p> </li> </ol> <p>Now the old device is gone and the user can enroll a new device</p>"},{"location":"script-catalog/person_authentication/super-gluu-external-authenticator/#device-management-using-scim","title":"Device management using SCIM","text":"<p>See the SCIM documentation on how to manage Super Gluu devices, using the SCIM [protocol].</p>"},{"location":"script-catalog/person_authentication/twilio-2fa/","title":"SMS One-Time Password (OTP) Authentication","text":"<p>SMS is a common technology used for the delivery of OTPs. Text messages provide a ubiquitous communication channel, and are directly available in nearly all mobile handsets and, through text-to-speech conversion, any mobile or landline telephone.</p> <p>This document explains how to configure the Gluu Server for two-step, two-factor authentication (2FA) with username / password as the first step, and an OTP sent via text message as the second step.</p> <p>Note</p> <p>As indicated, this script uses the Twilio cloud communications platform to deliver SMS messages.</p>"},{"location":"script-catalog/person_authentication/twilio-2fa/#prerequisites","title":"Prerequisites","text":"<ul> <li>The Twilio SMS OTP script (included in the default Janssen Server distribution);   </li> <li>A Twilio account.     </li> <li>The twilio jar library added to jans-auth</li> <li>A mobile device and phone number that can receive SMS text messages</li> </ul>"},{"location":"script-catalog/person_authentication/twilio-2fa/#twilio-as-a-2fa-method","title":"Twilio as a 2FA method","text":"<p>Twilio offers Voice, SMS, and MMS capabilities, but we will only need SMS for the purpose of this document.</p> <p>When registering for a Twilio account, you will be asked to verify your personal phone number, and then will be given a Twilio phone number.</p> <p>Ensure the number given is SMS enabled and supports sending messages to the countries you are targeting. You may need to enable countries manually (see the Geo permissions page).</p> <p>Twilio trial accounts only allow sending messages to mobile numbers already linked to the account, so for testing you will want to add (and verify) some additional numbers besides your personal one to make sure the integration is working as expected. When you are ready to move to production, you will want to purchase a Twilio plan.</p>"},{"location":"script-catalog/person_authentication/twilio-2fa/#add-twilio-library-to-jans-auth","title":"Add Twilio library to jans-auth","text":"<ul> <li> <p>Copy the Twilio jar file to the following jans-auth folder inside the Gluu Server chroot: <code>/opt/jans/jetty/jans-auth/custom/libs</code> </p> </li> <li> <p>Edit <code>/opt/jans/jetty/jans-auth/webapps/jans-auth.xml</code> and add the following line:</p> <pre><code>&lt;Set name=\"extraClasspath\"&gt;/opt/jans/jetty/jans-auth/custom/libs/twilio.jar&lt;/Set&gt;\n</code></pre> </li> <li> <p>Restart the <code>jans-auth</code> service</p> </li> </ul>"},{"location":"script-catalog/person_authentication/twilio-2fa/#properties","title":"Properties","text":"<p>The custom script has the following properties:</p> Property Description Input value twilio_sid Twilio account SID Obtain from your Twilio account twilio_token Access token associated to Twilio account Obtain from your Twilio account from_number Twilio phone number assigned to the account Obtain from your Twilio account"},{"location":"script-catalog/person_authentication/twilio-2fa/#enable-twilio_sms-script","title":"Enable twilio_sms script","text":"<p>By default, users will get the default authentication mechanism as specified above. However, using the OpenID Connect acr_values parameter, web and mobile clients can request any enabled authentication mechanism.</p> <ol> <li>Obtain the json contents of <code>twilio_sms</code> custom script by using a jans-cli command like <code>get-config-scripts-by-type</code>, <code>get-config-scripts-by-inum</code> etc.</li> </ol> <p>e.g : <code>/opt/jans/jans-cli/config-cli.py --operation-id get-config-scripts-by-type --url-suffix type:PERSON_AUTHENTICATION</code> , <code>/opt/jans/jans-cli/config-cli.py --operation-id get-config-scripts-by-inum --url-suffix inum:6122281b-b55d-4dd0-8115-b098eeeee2b7</code></p> <ol> <li>Update the custom script and change the <code>enabled</code> attribute to <code>true</code> </li> </ol> <p>Now <code>twilio_sms</code> is an available authentication mechanism for your Janssen Server. This means that, using OpenID Connect <code>acr_values</code>, applications can now request <code>twilio_sms</code> authentication for users.</p> <p>Note</p> <p>To make sure <code>twilio_sms</code> has been enabled successfully, you can check your Janssen's Auth Server OpenID Connect configuration by navigating to the following URL: <code>https://&lt;hostname&gt;/.well-known/openid-configuration</code>. Find <code>\"acr_values_supported\":</code> and you should see <code>twilio_sms</code> .</p>"},{"location":"script-catalog/person_authentication/twilio-2fa/#enable-twilio_sms-script-as-default-authentication-script","title":"Enable <code>twilio_sms</code> Script as default authentication script:","text":"<p>Use this link as a reference. Follow the steps below to enable <code>twilio_sms</code> authentication: 1. Create a file say <code>twilio_sms</code> -auth-default.json<code>with the following contents <pre><code>{\n  \"defaultAcr\": \"`twilio_sms` \"\n}\n</code></pre> 2.Update the default authentication method to ``twilio_sms</code> ` <pre><code>/opt/jans/jans-cli/config-cli.py --operation-id put-acrs --data /tmp/twilio_sms-auth-default.json\n</code></pre></p>"},{"location":"script-catalog/person_authentication/twilio-2fa/#test-the-feature","title":"Test the feature","text":"<p>To test, enter the complete URL for authorization in a browser or create a simple webpage with a link that simulates the user sign-in attempt. If the server is configured properly, the first page for the selected authentication method will be displayed to the user.</p> <p>An example of a complete URL looks like this - <pre><code>https://&lt;your.jans.server&gt;/jans-auth/authorize.htm?response_type=code&amp;redirect_uri=https://&lt;your.jans.server&gt;/admin&amp;client_id=&lt;replace_with_inum_client_id&gt;&amp;scope=openid+profile+email+user_name&amp;state=faad2cdjfdddjfkdf&amp;nonce=dajdffdfsdcfff\n</code></pre></p>"},{"location":"script-catalog/person_authentication/twilio-2fa/#sms-otp-login-pages","title":"SMS OTP Login Pages","text":"<p>The Jans Server includes one page for SMS OTP:</p> <ol> <li>A login page that is displayed for all SMS OTP authentications.  </li> </ol> <p>The designs are being rendered from the SMS xhtml page. To customize the look and feel of the pages, follow the customization guide.</p>"},{"location":"script-catalog/person_authentication/twilio-2fa/#using-sms-otp","title":"Using SMS OTP","text":""},{"location":"script-catalog/person_authentication/twilio-2fa/#phone-number-enrollment","title":"Phone Number Enrollment","text":"<p>The script assumes the user phone number is already stored in his corresponding MySQL entry (attribute <code>phoneNumberVerified</code>). You can change the attribute by altering the script directly (see authenticate routine).</p>"},{"location":"script-catalog/person_authentication/twilio-2fa/#subsequent-logins","title":"Subsequent Logins","text":"<p>All  authentications will trigger an SMS with an OTP to the registered phone number. Enter the OTP to pass authentication.</p>"},{"location":"script-catalog/person_authentication/twilio-2fa/#credential-management","title":"Credential Management","text":"<p>A user's registered phone number can be removed by a Gluu administrator either via the jans TUI, or in MySQL under the user entry. Once the phone number has been removed from the user's account, the user can re-enroll a new phone number following the phone number enrollment instructions above.</p>"},{"location":"script-catalog/person_authentication/twilio-2fa/#troubleshooting","title":"Troubleshooting","text":"<p>If problems are encountered, take a look at the logs, specifically <code>/opt/jans/jetty/jans-auth/logs/jans-auth_script.log</code>. Inspect all messages related to Twilio. For instance, the following messages show an example of correct script initialization:</p> <pre><code>Twilio SMS. Initialization\nTwilio SMS. Initialized successfully\n</code></pre> <p>Also make sure you are using the latest version of the script that can be found here.</p>"},{"location":"script-catalog/person_authentication/twilio-2fa/#self-service-account-security","title":"Self-service account security","text":"<p>To offer end-users a portal where they can manage their own account security preferences, including two-factor authentication credentials like phone numbers for SMS OTP, check out our new app, Gluu Casa.</p>"},{"location":"script-catalog/post_authn/post-authentication/","title":"Post Authentication","text":"<p>After the browser has a session, if a person visits the website, the requesting party can obtain a code without the user having to authenticate or authorize. In some cases, it is desirable to insert custom business logic before granting the code or tokens from the authorization endpoint. Post Authentication script allows to force re-authentication or re-authorization (even if client is \"Pre-authorized\" or client authorization persistence is on).</p>","tags":["administration","developer","script-catalog","PostAuthn"]},{"location":"script-catalog/post_authn/post-authentication/#interface","title":"Interface","text":"<p>The post authentication script implements the PostAuthnType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog","PostAuthn"]},{"location":"script-catalog/post_authn/post-authentication/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog","PostAuthn"]},{"location":"script-catalog/post_authn/post-authentication/#new-methods","title":"New Methods","text":"Method header Method description <code>def forceReAuthentication(self, context)</code> This method is called during Authorization Request at Authorization Endpoint. If True is returned, session is set as unauthenticated and user is send for authentication. <code>def forceAuthorization(self, context)</code> This method is called during Authorization Request at Authorization Endpoint. If True is returned user is send for Authorization. By default if client is \"Pre-Authorized\" or \"Client Persist Authorizations\" is on, authorization is skipped. This script has higher priority and can cancel Pre-Authorization and persisted authorizations.","tags":["administration","developer","script-catalog","PostAuthn"]},{"location":"script-catalog/post_authn/post-authentication/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>SimpleCustomProperty</code> Map of configuration properties. Reference <code>context</code> Reference","tags":["administration","developer","script-catalog","PostAuthn"]},{"location":"script-catalog/post_authn/post-authentication/#use-case-dummy-post-authentication-script-does-not-force-re-authentication","title":"Use case: Dummy Post Authentication script (does not force re-authentication)","text":"<p>This was adapted from Gluu Post Authentication script example.</p>","tags":["administration","developer","script-catalog","PostAuthn"]},{"location":"script-catalog/post_authn/post-authentication/#script-type-python","title":"Script Type: Python","text":"<pre><code># oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2020, Janssen\n#\n# Author: Yuriy Zabrovarnyy\n#\n#\n\nfrom io.jans.model.custom.script.type.postauthn import PostAuthnType\nfrom java.lang import String\n\nclass PostAuthn(PostAuthnType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Post Authn script. Initializing ...\"\n        print \"Post Authn script. Initialized successfully\"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"Post Authn script. Destroying ...\"\n        print \"Post Authn script. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # This method is called during Authorization Request at Authorization Endpoint.\n    # If True is returned, session is set as unauthenticated and user is send for authentication.\n    # Note :\n    # context is reference of io.jans.as.service.external.context.ExternalPostAuthnContext(in https://github.com/JanssenFederation/oxauth project, )\n    def forceReAuthentication(self, context):\n        return False\n\n    # This method is called during Authorization Request at Authorization Endpoint.\n    # If True is returned user is send for Authorization. By default if client is \"Pre-Authorized\" or \"Client Persist Authorizations\" is on, authorization is skipped.\n    # This script has higher priority and can cancel Pre-Authorization and persisted authorizations.\n    # Note :\n    # context is reference of io.jans.as.service.external.context.ExternalPostAuthnContext(in https://github.com/JanssenFederation/oxauth project, )\n    # To get session object just call context.getSession()\n    def forceAuthorization(self, context):\n        return False\n</code></pre>","tags":["administration","developer","script-catalog","PostAuthn"]},{"location":"script-catalog/post_authn/post-authentication/#script-type-java","title":"Script Type: Java","text":"<pre><code>import java.util.Map;\n\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.postauthn.PostAuthnType;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\npublic class PostAuthn implements PostAuthnType {\n\n        private static final Logger log = LoggerFactory.getLogger(PostAuthn.class);\n\n        @Override\n        public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Post Authentication. Initializing...\");\n        log.info(\"Post Authentication. Initialized\");\n        return true;\n        }\n\n        @Override\n        public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Post Authentication. Initializing...\");\n        log.info(\"Post Authentication. Initialized\");\n        return true;\n        }\n\n        @Override\n        public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Post Authentication. Destroying...\");\n        log.info(\"Post Authentication. Destroyed.\");\n        return true;\n        }\n\n        @Override\n        public int getApiVersion() {\n                return 11;\n        }\n\n        @Override\n        public boolean forceReAuthentication(Object context) {\n                return false;\n        }\n\n        @Override\n        public boolean forceAuthorization(Object context) {\n                return false;\n        }\n\n}\n</code></pre>","tags":["administration","developer","script-catalog","PostAuthn"]},{"location":"script-catalog/resource_owner_password_credentials/ropc/","title":"Resource Owner Password Credential","text":"<p>Resource Owner Password Credentials script allows modifying the behavior of Resource Owner Password Credentials Grant (RFC 6749).</p> <p>The script is invoked after normal authentication and can either leave current result or change it - authenticate if not authenticated - it should return True and optionally set user (via <code>context.setUser(user)</code>).</p>","tags":["administration","developer","script-catalog","ResourceOwnerPasswordCredentials"]},{"location":"script-catalog/resource_owner_password_credentials/ropc/#interface","title":"Interface","text":"<p>The ROPC script implements the ResourceOwnerPasswordCredentialsType interface. This extends methods from the base script type in addition to adding new method:</p>","tags":["administration","developer","script-catalog","ResourceOwnerPasswordCredentials"]},{"location":"script-catalog/resource_owner_password_credentials/ropc/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog","ResourceOwnerPasswordCredentials"]},{"location":"script-catalog/resource_owner_password_credentials/ropc/#new-methods","title":"New Methods","text":"Method header Method description <code>def authenticate(self, context)</code> This method is called after normal ROPC authentication. This method can cancel normal authentication if it returns false and sets <code>context.setUser(null)</code>","tags":["administration","developer","script-catalog","ResourceOwnerPasswordCredentials"]},{"location":"script-catalog/resource_owner_password_credentials/ropc/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>SimpleCustomProperty</code> Map of configuration properties. Reference <code>context</code> Reference","tags":["administration","developer","script-catalog","ResourceOwnerPasswordCredentials"]},{"location":"script-catalog/resource_owner_password_credentials/ropc/#use-case-basic-ropc-authentication-script","title":"Use case: Basic ROPC authentication script","text":"<p>This script has been adapted from the Gluu Server sample ROPC script</p> <p>Main usage of script is at Token Endpoint.</p> <p>However sometimes it can be useful to use ROPC custom script at Authorization Endpoint to avoid redirects and pages. By default it is not enabled but it can be enabled if set <code>forceRopcInAuthorizationEndpoint</code> AS configuration property to <code>true</code>.</p> <p>Also it is required to set <code>user</code> in context in custom script (<code>context.setUser(&lt;user&gt;)</code>). Without it authorization will go on in normal way (with pages and redirects).</p>","tags":["administration","developer","script-catalog","ResourceOwnerPasswordCredentials"]},{"location":"script-catalog/resource_owner_password_credentials/ropc/#script-type-python","title":"Script Type: Python","text":"<pre><code>from io.jans.model.custom.script.type.owner import ResourceOwnerPasswordCredentialsType\nfrom io.jans.as.server.service import AuthenticationService\nfrom io.jans.service.cdi.util import CdiUtil\nfrom java.lang import String\n\nclass ResourceOwnerPasswordCredentials(ResourceOwnerPasswordCredentialsType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"ROPC script. Initializing ...\"\n\n        self.usernameParamName = \"username\"\n        self.passwordParamName = \"password\"\n\n        print \"ROPC script. Initialized successfully\"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"ROPC script. Destroying ...\"\n        print \"ROPC script. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Returns True and set user into context when user authenticated succesfully\n    # Returns False when user not authenticated or it's needed to cancel notmal flow\n    # Note :\n    # context is reference of io.jans.as.service.external.context.ExternalResourceOwnerPasswordCredentialsContext#ExternalResourceOwnerPasswordCredentialsContext (in https://github.com/JanssenFederation/oxauth project, )\n    def authenticate(self, context):\n        print \"ROPC script. Authenticate\"\n        deviceIdParam = context.getHttpRequest().getParameterValues(\"device_id\")\n        if deviceIdParam != None and (deviceIdParam.lenght &gt; 0 ):\n            result = deviceIdParam[0] == \"device_id_1\"\n            if not result:\n                return False\n\n            # Set auntenticated user in context\n            # context.setUser(user)\n            return True\n\n        # Do generic authentication in other cases\n        authService = CdiUtil.bean(AuthenticationService)\n\n        username = context.getHttpRequest().getParameter(self.usernameParamName)\n        password = context.getHttpRequest().getParameter(self.passwordParamName)\n        result = authService.authenticate(username, password)\n        if not result:\n            print \"ROPC script. Authenticate. Could not authenticate user '%s' \" % username\n            return False\n\n        context.setUser(authService.getAuthenticatedUser())\n\n        return True\n</code></pre>","tags":["administration","developer","script-catalog","ResourceOwnerPasswordCredentials"]},{"location":"script-catalog/resource_owner_password_credentials/ropc/#script-type-java","title":"Script Type: Java","text":"<pre><code>import java.util.Map;\n\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.owner.ResourceOwnerPasswordCredentialsType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport io.jans.as.server.service.AuthenticationService;\nimport io.jans.service.cdi.util.CdiUtil;\nimport io.jans.as.server.service.external.context.ExternalResourceOwnerPasswordCredentialsContext;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\npublic class ResourceOwnerPasswordCredentials implements ResourceOwnerPasswordCredentialsType {\n\n        private static final Logger log = LoggerFactory.getLogger(CustomScriptManager.class);\n\n        private final String usernameParamName = \"username\";\n        private final String passwordParamName = \"password\";\n\n        @Override\n        public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"ROPC Script. Initializing...\");\n        log.info(\"ROPC Script. Initialized\");\n        return true;\n        }\n\n        @Override\n        public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"ROPC Script. Initializing...\");\n        log.info(\"ROPC Script. Initialized\");\n        return true;\n        }\n\n        @Override\n        public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"ROPC Script. Destroying...\");\n        log.info(\"ROPC Script. Destroyed.\");\n        return true;\n        }\n\n        @Override\n        public int getApiVersion() {\n                return 11;\n        }\n\n        @Override\n        public boolean authenticate(Object context) {\n                log.info(\"ROPC script. Authenticate\");\n                ExternalResourceOwnerPasswordCredentialsContext ropcContext = (ExternalResourceOwnerPasswordCredentialsContext) context;\n                String[] deviceIdParam = ropcContext.getHttpRequest().getParameterValues(\"device_id\");\n                if(deviceIdParam != null &amp;&amp; deviceIdParam.length &gt; 0) {\n                        boolean result = \"device_id_1\".equals(deviceIdParam[0]);\n                        if (!result) {\n                                return false;\n                        }\n            // Set authenticated user in context using ropcContext.setUser(user)\n            return true;\n                }\n                // generic authentication in other cases\n\n                AuthenticationService authService = CdiUtil.bean(AuthenticationService.class);\n                String username = ropcContext.getHttpRequest().getParameter(usernameParamName);\n                String password = ropcContext.getHttpRequest().getParameter(passwordParamName);\n                boolean result = authService.authenticate(username, password);\n                if(!result) {\n                        log.info(\"ROPC script. Authenticate. Could not authenticate \" + username);\n                        return false;\n                }\n                ropcContext.setUser(authService.getAuthenticatedUser());\n                return true;\n        }\n\n}\n</code></pre>","tags":["administration","developer","script-catalog","ResourceOwnerPasswordCredentials"]},{"location":"script-catalog/resource_owner_password_credentials/ropc/#sample-scripts","title":"Sample Scripts","text":"<ul> <li>Super Gluu ROPW Script</li> <li>3 Step ROPW Script</li> <li>Resource Owner Password Credentials Custom Params</li> </ul>","tags":["administration","developer","script-catalog","ResourceOwnerPasswordCredentials"]},{"location":"script-catalog/resource_owner_password_credentials/resource-owner-password-credentials/","title":"Index","text":"<p>This is a placeholder</p>"},{"location":"script-catalog/resource_owner_password_credentials/resource-owner-password-credentials-2fa/","title":"2FA Resource Owner Password Script Using Twilio","text":"<p>This resource owner password script implements two factor authentication using twilio. This could easily be adjusted for other 2FA use cases (e.g. using a Yubikey or a magic link).</p>"},{"location":"script-catalog/resource_owner_password_credentials/resource-owner-password-credentials-2fa/#requirements","title":"Requirements","text":"<p>The script is written for jans , meaning it will only work on a Janssen or a Gluu Flex installation. An additional requirement is a twilio account with twilio API credentials.</p>"},{"location":"script-catalog/resource_owner_password_credentials/resource-owner-password-credentials-2fa/#application-flow-and-sequence-diagram","title":"Application Flow and Sequence Diagram","text":"<p>The application flow is described below, alongside a sequence diagram In the first step, the user provides only his username or email (through the RP). The script then checks the username against the backend database. If the user is found, and has a phone number associated with his account, an OTP code is sent to the associated number. The user (through the RP) is prompted for the OTP code and the RP sends another authentication request to the script to validate the OTP code. If the OTP code is valid, the user provides his password which is then validated by the script. Only then is the access token issued and authentication succeed. </p>"},{"location":"script-catalog/resource_owner_password_credentials/resource-owner-password-credentials-2fa/#flex-server-configuration","title":"Flex Server Configuration","text":"<ol> <li>Open your Flex UI and go to <code>Admin</code> &gt; <code>Scripts</code> &gt; and add a new custom script.</li> <li>Make sure the script type is <code>RESOURCE_OWNER_PASSWORD_CREDENTIALS</code>. </li> <li>The script contents should be  this script.</li> <li>Add the following custom properties to the new script</li> <li><code>twilio_account_sid</code> containing your twilio SID </li> <li><code>twilio_auth_token</code> containing your twilio authentication token</li> <li><code>twilio_from_number</code> containing the \"from\" twilio number</li> <li>Save your changes.</li> <li>Go to <code>Auth Server</code> &gt; <code>Clients</code> and add a new client (click     on the + sign in the top left)</li> <li>Create a new client , making sure it has the <code>password</code> grant and the <code>token</code> response    types.</li> <li>In the <code>Client Scripts</code> tab , make sure to add the script you created above to the <code>Password Grant</code> list of scripts.</li> </ol> <p>Step (7) can be skipped if this is to be used with an existing OpenID client.</p>"},{"location":"script-catalog/resource_owner_password_credentials/resource-owner-password-credentials-custom-params/","title":"Index","text":"<p>This is a placeholder</p>"},{"location":"script-catalog/revoke_token/revoke-token/","title":"Revoke Token","text":"<p>Revoke Token scripts allow injecting custom logic during token revocation.</p>","tags":["administration","developer","script-catalog","RevokeToken"]},{"location":"script-catalog/revoke_token/revoke-token/#interface","title":"Interface","text":"<p>The revoke token script implements the RevokeTokenType interface. This extends methods from the base script type in addition to adding new method:</p>","tags":["administration","developer","script-catalog","RevokeToken"]},{"location":"script-catalog/revoke_token/revoke-token/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog","RevokeToken"]},{"location":"script-catalog/revoke_token/revoke-token/#new-methods","title":"New Methods","text":"Method header Method description <code>def revoke(self, context)</code> Token is revoked if this method returns True, skipped otherwise","tags":["administration","developer","script-catalog","RevokeToken"]},{"location":"script-catalog/revoke_token/revoke-token/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>context</code> Reference","tags":["administration","developer","script-catalog","RevokeToken"]},{"location":"script-catalog/revoke_token/revoke-token/#use-case-basic-token-revocation","title":"Use Case: Basic Token Revocation","text":"<p>This script has been adapted from the Gluu Server sample revoke token script.</p>","tags":["administration","developer","script-catalog","RevokeToken"]},{"location":"script-catalog/revoke_token/revoke-token/#script-type-python","title":"Script Type: Python","text":"<pre><code># oxAuth is available under the Apache License (2004). See http://www.apache.org/licenses/ for full text.\n# Copyright (c) 2020, Gluu\n#\n# Author: Yuriy Zabrovarnyy\n#\n#\n\nfrom org.gluu.model.custom.script.type.revoke import RevokeTokenType\nfrom java.lang import String\n\nclass RevokeToken(RevokeTokenType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Revoke Token script. Initializing ...\"\n        print \"Revoke Token script. Initialized successfully\"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"Revoke Token script. Destroying ...\"\n        print \"Revoke Token script. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # This method is called during Revoke Token call.\n    # If True is returned, token is revoked. If False is returned, revoking is skipped.\n    # Note :\n    # context is reference of io.jans.as.server.model.common.ExecutionContextt(in https://github.com/JanssenProject/jans-auth-server project, )\n    def revoke(self, context):\n        return True\n</code></pre>","tags":["administration","developer","script-catalog","RevokeToken"]},{"location":"script-catalog/revoke_token/revoke-token/#script-type-java","title":"Script Type: Java","text":"<pre><code>import java.util.Map;\n\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.revoke.RevokeTokenType;\nimport io.jans.service.custom.script.CustomScriptManager;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\npublic class RevokeToken implements RevokeTokenType {\n\n    private static final Logger log = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    @Override\n        public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Token Revoke. Initializing...\");\n        log.info(\"Token Revoke. Initialized\");\n        return true;\n        }\n\n        @Override\n        public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Token Revoke. Initializing...\");\n        log.info(\"Token Revoke. Initialized\");\n        return true;\n        }\n\n        @Override\n        public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Token Revoke. Destroying...\");\n        log.info(\"Token Revoke. Destroyed.\");\n        return true;\n        }\n\n        @Override\n        public int getApiVersion() {\n                return 11;\n        }\n\n    @Override\n    public boolean revoke(Object context) {\n        return true;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog","RevokeToken"]},{"location":"script-catalog/revoke_token/revoke-token/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","developer","script-catalog","RevokeToken"]},{"location":"script-catalog/revoke_token/revoke-token/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","developer","script-catalog","RevokeToken"]},{"location":"script-catalog/revoke_token/revoke-token/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","developer","script-catalog","RevokeToken"]},{"location":"script-catalog/scim/scim/","title":"SCIM Guide","text":"<p>SCIM script allows you to execute custom logic when certain SCIM API operations are invoked.</p> <p>With SCIM scripts, custom business logic can be executed when several of the SCIM API operations are invoked. This is useful in many situations, for example:</p> <ul> <li>Trigger notifications to external systems when certain resources are deleted</li> <li>Alter the actual responses the service produces</li> <li>Attach additional information to resources when they are created or updated</li> <li>Implement a fine-grained level of access to resources so different callers have permission to handle only a restricted number of resources</li> </ul>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/scim/scim/#notes","title":"Notes:","text":"<p>In this document, the term resources refer to those \"entities\" the service can manage, for instance, users or groups The term operation refers to any SCIM functionality accessible through its HTTP endpoints Basic development skills are assumed. Some grasp of Java and Python are required as well as understanding of the SCIM protocol.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/scim/scim/#interface","title":"Interface","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/scim/scim/#methods","title":"Methods","text":"<p>API Overview</p> <p>Custom scripts adhere to a simple API (ie. a well-defined collection of methods/routines) that is described in the following. It is advised to check the dummy script provided here as you read this section.</p> <p>Scripts' config properties</p> <p>All methods contain a <code>configurationAttributes</code> parameter, this gives access to the configuration properties of the script itself. This is a relevant aspect of Gluu scripts: they are all parameterizable!.</p> <p><code>configurationAttributes</code> is a <code>java.util.Map&lt;String, SimpleCustomProperty&gt;</code> and here is how <code>SimpleCustomProperty</code> looks.</p> <p>Basic Methods</p> <p>These are methods not related to SCIM operations but still play key roles: |Method Name|Description|Return Value| |:---|:---|:---| |<code>init</code>|Called when the (SCIM) service starts and every time the script properties or code changes|A boolean value describing success or failure| |<code>destroy</code>|Called every time the script properties or code changes (called before <code>init</code>)|A boolean value describing success or failure| |<code>getApiVersion</code>|Determines what methods are effectively called when SCIM endpoints are invoked|A positive integer|</p> <p>Pre-resource Modification</p> <p>They are called when the resource is about to be persisted. The second parameter in these methods hold the object that will be persisted to permanent storage, thus any change or manipulation upon the object will be reflected in the underlying database (as well as in the output of the SCIM operation call itself).</p> <p>These methods are called regardless of the API version used. Names are self explanatory:</p> Methods 2nd param 2nd param Class/Link <code>createUser</code>, <code>updateUser</code>, <code>deleteUser</code> <code>user</code> ScimCustomPerson <code>createGroup</code>, <code>updateGroup</code>, <code>deleteGroup</code> <code>group</code> GluuGroup <p>Pre-resource modification methods return a boolean. A <code>False</code> value aborts the corresponding SCIM operation and a 500 error is returned. The same applies if the method execution crashes at runtime.</p> <p>Note that <code>update*</code> methods are called for both SCIM PUT and PATCH operations.</p> <p>Post-resource Modification</p> <p>They are called after the resource is persisted. The second parameter in these methods hold the object that was saved. Any change or manipulation upon the object will not be reflected in the underlying database, but may still modify the service response.</p> <p>These methods are called if <code>getApiVersion</code> returns a number &gt;= 2.</p> Methods 2nd param 2nd param Class/Link <code>postCreateUser</code>, <code>postUpdateUser</code>, <code>postDeleteUser</code> <code>user</code> ScimCustomPerson <code>postCreateGroup</code>, <code>postUpdateGroup</code>, <code>postDeleteGroup</code> <code>group</code> GluuGroup <p>Post-resource modification methods return a boolean. A <code>False</code> value aborts the corresponding SCIM operation and a 500 error is returned. The same applies if the method execution crashes at runtime.</p> <p>Note that <code>postUpdate*</code> methods are called for both SCIM PUT and PATCH operations.</p> <p>Single Resource Retrieval</p> <p>These apply for SCIM operations that retrieve a resource by ID. They are called after the resource has been obtained from the database. The second parameter in these methods hold a reference to such object.</p> <p>Any change or manipulation upon the object will not be reflected in the underlying database, but may still modify the service response.</p> <p>These methods are called if <code>getApiVersion</code> returns a number &gt;= 3.</p> Methods 2nd param 2nd param Class/Link <code>getUser</code> <code>user</code> ScimCustomPerson <code>getGroup</code> <code>group</code> GluuGroup <p>Single resource retrieval methods return a boolean. A <code>False</code> value aborts the whole SCIM operation and a 500 error is returned. The same applies if the method execution crashes at runtime.</p> <p>Multiple Resources Retrieval</p> <p>These apply for SCIM search operations. They are called after the results have been obtained from the database. The second parameter in these methods hold a reference to such result set.</p> <p>Any change or manipulation upon the object will not be reflected in the underlying database, but may still modify the service response.</p> <p>These methods are called if <code>getApiVersion</code> returns a number &gt;= 4.</p> Methods 2nd param 2nd param Class/Link <code>postSearchUsers</code> <code>results</code> PagedResult <code>postSearchGroups</code> <code>results</code> PagedResult <p>Multiple resources retrieval methods return a boolean. A <code>False</code> value aborts the whole SCIM operation and a 500 error is returned. The same applies if the method execution crashes at runtime.</p> <p>Note that searching using the root <code>.search</code> SCIM endpoint will trigger calls to both of the methods listed.</p> <p>Advanced control</p> <p>These are alternative methods that allow to tweak the response the service produces. They can be employed to introduce complex business rules when operations are executed.</p> <p>These methods are called if <code>getApiVersion</code> returns a number &gt;= 5.</p> Methods <code>manageResourceOperation</code> <code>manageSearchOperation</code>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/scim/scim/#example-modifying-search-results","title":"Example: Modifying Search Results","text":"<p>SCIM spec defines the concept of attribute returnability where some attributes should never be part of a response (like passwords), always be returned (like resource identifiers), or be returned by default unless otherwise stated by the <code>excludedAttributes</code> parameter.</p> <p>Assume you are maintaining a user base of secret agents that work for your company and need to avoid exposing information such as their physical addresses for safety reasons. To keep it simple let's restrict the scope to user searches only. In practice you should take steps to hide this data on user retrieval and update.</p> <p>Let's alter <code>postSearchUsers</code>'s second parameter (<code>results</code>) to ensure addresses are not leaked:</p> <pre><code>for user in results.getEntries():\n    user.setAttribute(\"jansAddress\", None)\n</code></pre> <p>This is very straightforward code except for the usage of <code>jansAddress</code>. Shouldn't it be simply <code>addresses</code> as the known SCIM attribute?</p> <p>Scripts work with entities that are about to be persisted or have already been saved so they resemble the database structure (schema in MySQL terms). It turns out that database attribute names rarely match with SCIM names.</p> <p>While it is easy to know the SCIM name of a database attribute, the converse requires checking the code, however since you already have the skill this shouldn't be a problem: in this Java class you'll find the representation of a user resource in SCIM spec terms. Pay attention to the <code>addresses</code> field and its associated <code>StoreReference</code> annotation that contains the attribute where addresses are actually stored.</p> <p>With that said, save your modifications. You may like the idea of adding some prints for enlightment like:</p> <pre><code>print \"%d entries returned of %d\" % (results.getEntriesCount(), results.getTotalEntriesCount())\nfor user in results.getEntries():\n    print \"Flushing addresses for user %s\" % user.getUid() \n    user.setAttribute(\"jansAddress\", None)\n</code></pre> <p>Ensure no addresses are returned anymore in your SCIM user searches. Happy testing!</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/scim/scim/#controlling-execution-of-scim-operations","title":"Controlling execution of SCIM operations","text":"<p>With the <code>manageResourceOperation</code> and <code>manageSearchOperation</code> methods you can make complex decisions on how processing should take place based on contextual data and the incoming payload.</p> <p>manageResourceOperation</p> <p>This method is invoked when any following operations are executed: resource creation, modification, removal and retrieval by ID. In case of bulks, the method is called for every operation that fits into these categories.</p> <p>Parameters are described in the table below:</p> Name Description Class/Link <code>context</code> Provides contextual information about the SCIM operation being called such as type of resource involved, HTTP verb, request headers, query params, etc. OperationContext <code>entity</code> A non-null object representing the resource involved A descendant of Entry. If the resource is a user, it will be an instance of ScimCustomPerson. In case of a group, it will be a GluuGroup <code>payload</code> The payload sent in the invocation; <code>null</code> when the operation is removal or retrieval by ID The datatype depends on the operation called. Check the interface that suits best and inspect the first parameter's datatype. The class will belong to some subpackage inside io.jans.scim.model.scim2 <p>This method is expected to return an instance of <code>javax.ws.rs.core.Response</code> that supersedes the output of the operation itself. In other words, the actual processing of the operation is skipped in favor of the code supplied here. However note that minor validations may take place in the payload before your code is actually called.</p> <p>Returning <code>None</code> transfers the control of the operation for normal processing (default Jans implementation). If the method execution crashes at runtime, a 500 HTTP error is sent.</p> <p>Notes:</p> <ul> <li>Possible values for <code>context.getResourceType()</code> are: User, Group, FidoDevice, Fido2Device</li> <li><code>context.getTokenDetails().getValue()</code> is a shortcut that will give you the access token the caller employed to issue the service call</li> <li>Both <code>context.getTokenDetails().getTokenType()</code> and <code>context.getTokenDetails().getScope()</code> return non-null values when the protection mechanism of the API is OAuth or test mode</li> <li>Note that for resource creation operation, <code>entity</code> basically contains the same data supplied in the POST <code>payload</code>. In this case, <code>entity</code> has not originated from the database and has not been persisted either</li> <li>For the case of modification, retrieval and removal, <code>entity</code> contains the data currently stored in the database for the resource in question</li> <li>Since many values come from Java code, you can always do <code>getClass().getName()</code> to get an idea of what type of variables you are dealing with</li> <li>To build custom error responses your can reuse some of the <code>getErrorResponse</code> methods of class BaseScimWebService</li> </ul> <p>This method offers a high degree of flexibility. Perform careful testing of your code and account all potential scenarios.</p> <p>manageSearchOperation</p> <p>This method is invoked when resource searches are performed. Parameters are described in the table below:</p> name Description Class/Link <code>context</code> Provides contextual information about the SCIM operation being called such as type of resource involved, HTTP verb, request headers, query params, etc. OperationContext <code>searchRequest</code> An object representing the search parameters provided in the call (applies for both GET and POST) SearchRequest <p>Unlike <code>manageResourceOperation</code>, no <code>entity</code> parameter is passed. This is so because making decisions based on already executed searches would have a performance impact. Instead you can use <code>context.setFilterPrepend(...)</code> to help restrict the search against the database: here you can pass a String value that will be interpreted as an SCIM filter expression (see section 3.4.2.2 of RFC 7644). When the search being performed already contains a search filter (i.e. <code>searchRequest.getFilter()</code>is non-empty), a new filter is created by appending both \"subfilters\" with an <code>and</code> operator.</p> <p>As in the case of <code>manageResourceOperation</code> this method is expected to return an instance of <code>javax.ws.rs.core.Response</code>.</p> <p>Returning <code>None</code> transfers the control of the operation for normal processing (the Jans implementation). If the method execution crashes at runtime, a 500 HTTP error is sent.</p> <p>The same recommendations given for <code>manageResourceOperation</code> apply here. If you build filter expressions in your method, ensure they are syntactically valid to avoid your callers getting unexpected \"invalidFilter\" 400 errors.</p> <p>Example: segmenting the user base</p> <p>Let's assume you make use of the SCIM attribute <code>userType</code> so that your user base is partitioned into three disjoint segments according to such attribute and you have designated its possible values to be: Contractor, Employee, or Intern.</p> <p>Suppose your company has three different applications that make management of users in every category, that is, only one application is devoted to manage contractors, another employees, and other interns. You are interested in consistently granting access so that no application can create, query or modify users that don't belong to its focus.</p> <p>To properly handle this multi-tenancy scenario, you decide to use the contextual information coming from every request to determine if the operation should be allowed or not. For this purpose you communicate every application developer to send an additional HTTP header in their call with a value that only you (the administrator) and the developer knows. Let's call it the \"secret\". For the sake of simplicity let's assume developers are external to the company and only you know their identities. They don't know each other so they cannot exchange secrets.</p> <p>The strategy to implement segmentation is rather simple:</p> <ul> <li> <p>Alter the default SCIM script by supplying a custom implementation for the methods that control execution</p> </li> <li> <p>Make the HTTP header name be a configuration property of the script so that it is not hard-coded</p> </li> <li> <p>Add a configuration property that contains the mapping of <code>userType</code> value vs. expected header value in JSON format</p> </li> </ul> <p>Adding and parsing config properties</p> <p>Using Jans Config CLI update the SCIM script and add properties:</p> <ul> <li><code>custom_header</code> with value <code>USER-SEGMENT-SECRET</code></li> <li><code>access_map</code> with value <code>{ \"&lt;random_string&gt;\":\"Contractor\", \"&lt;random_string&gt;\":\"Employee\", \"&lt;random_string&gt;\":\"Intern\" }</code></li> </ul> <p>Save the changes.</p> <p>In the <code>init</code> method this properties should be parsed. To start, let's add some imports:</p> <pre><code>from io.jans.scim.ws.rs.scim2 import BaseScimWebService\nimport json\n</code></pre> <p>Here is how <code>init</code> would look like:</p> <pre><code>def init(self, configurationAttributes):\n    self.custom_header = configurationAttributes.get(\"custom_header\").getValue2()\n    access_map_json = configurationAttributes.get(\"access_map\").getValue2()    \n    self.access_map = json.loads(access_map_json)\n    print \"ScimEventHandler (init): Initialized successfully\"\n    return True\n</code></pre> <p>Note no validations took place here: we assumed the script contains the properties, that they are non-empty and have sensible values.</p> <p>Allow/Deny resource operations</p> <p>The first step is to know the kind of application that is calling our service. For this purpose let's create a method that given incoming request headers returns the matching <code>userType</code></p> <pre><code># headers params is an instance of javax.ws.rs.core.MultivaluedMap&lt;String, String&gt;\ndef getUserType(self, headers):\n    secret = headers.getFirst(self.custom_header)\n    if secret in self.access_map:\n        return self.access_map[secret]\n    else:\n        return None\n</code></pre> <p>Now let's code <code>manageResourceOperation</code>. We should allow access only under the following conditions:</p> <ul> <li>The <code>getUserType</code> method does not return <code>None</code></li> <li>The entity object (<code>ScimCustomPerson</code> instance) has a proper <code>userType</code> value. This means that for user creation, the incoming payload comes with a matching <code>userType</code> and for the other cases, the already stored attribute matches as well</li> </ul> <p>Assume that if the operation invoked is not user-related, we should allow access freely. Here is how the implementation might look:</p> <pre><code>def manageResourceOperation(self, context, entity, payload, configurationAttributes):\n\n    print \"manageResourceOperation. SCIM endpoint invoked is %s (HTTP %s)\" % (context.getPath(), context.getMethod()) \n    if context.getResourceType() != \"User\":\n        return None\n\n    expected_user_type = self.getUserType(context.getRequestHeaders())\n\n    if expected_user_type != None and entity.getAttribute(\"jansUsrTyp\") == expected_user_type:\n        return None\n    else:\n        return BaseScimWebService.getErrorResponse(403, None, \"Attempt to handle a not allowed user type\")\n</code></pre> <p>Note no usage of the payload took place. A case you may like to evaluate is where mistakenly using an update operation, the <code>userType</code> is set to an unexpected value.</p> <p>Allow/Deny searches</p> <p>This time instead of inspecting an entity, we ought to make a filter expression to restrict the search when the database is queried. For your reference, a valid filter expression is for instance <code>userType eq \"Contractor\"</code>.</p> <pre><code>def manageSearchOperation(self, context, searchRequest, configurationAttributes):\n\n    print \"manageSearchOperation. SCIM endpoint invoked is %s (HTTP %s)\" % (context.getPath(), context.getMethod())\n\n    resource_type = context.getResourceType()\n    print \"manageSearchOperation. This is a search over %s resources\" % resource_type\n\n    if resource_type != \"User\":\n        return None\n\n    expected_user_type = self.getUserType(context.getRequestHeaders())\n\n    if expected_user_type != None:\n        context.setFilterPrepend(\"userType eq \\\"%s\\\"\" % expected_user_type)\n        return None\n    else:\n        return BaseScimWebService.getErrorResponse(403, None, \"Attempt to handle a not allowed user type\")\n</code></pre> <p>The <code>manageSearchOperation</code> must return a <code>javax.ws.rs.core.Response</code>. A <code>None</code> value makes continue the operation processing normally.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/scim/scim/#working-with-more-than-one-script","title":"Working with more than one script","text":"<p>You may have already noticed that it is possible to have several scripts under the SCIM type. This is how execution takes place when there are several scripts enabled:</p> <p>The applicable method is called in the first script. If the return value was <code>True</code>, the method is called again but this time in the subsequent script. If at any point a <code>False</code> return value is encountered, the SCIM operation is aborted with error 500. This means that a normal operation execution requires all involved methods across different scripts to be successful.</p> <p>There is an important exception to the above and is related to the <code>manage*</code> methods. In this case, only one script takes effect (the first script found). Note that in most cases having a single SCIM script suffices for all needs.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/scim/scim/#common-use-cases","title":"Common Use Cases","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/scim/scim/#script-type-python","title":"Script Type: Python","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/scim/scim/#custom-scim-event-handler","title":"Custom SCIM Event Handler","text":"<p>The sample code snippet shows how to:</p> <ol> <li>Modify Search Results</li> <li>Segment the user base</li> <li>Allow/Deny resource operations</li> <li>Allow/Deny searches</li> </ol> <pre><code># Copyright (c) 2022, Janssen Project\n#\n# Author: Gluu\n#    1. Modifying Search Results\n#    2. Segmenting the user base\n#    3. Allow/Deny resource operations\n#    4. Allow/Deny searches\n#\nfrom io.jans.model.custom.script.type.scim import ScimType\nfrom io.jans.scim.ws.rs.scim2 import BaseScimWebService\n\nimport json\n\nclass ScimEventHandler(ScimType):\n\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, configurationAttributes):\n        self.custom_header = configurationAttributes.get(\"custom_header\").getValue2()\n        access_map_json = configurationAttributes.get(\"access_map\").getValue2()    \n        self.access_map = json.loads(access_map_json)\n        print \"Custom ScimEventHandler (init): Initialized successfully\"\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"Custom ScimEventHandler (destroy): Destroyed successfully\"\n        return True   \n\n    def getApiVersion(self):\n        return 5\n\n    def createUser(self, user, configurationAttributes):\n        return True\n\n    def updateUser(self, user, configurationAttributes):\n        return True\n\n    def deleteUser(self, user, configurationAttributes):\n        return True\n\n    def createGroup(self, group, configurationAttributes):\n        return True\n\n    def updateGroup(self, group, configurationAttributes):\n        return True\n\n    def deleteGroup(self, group, configurationAttributes):\n        return True\n\n    def postCreateUser(self, user, configurationAttributes):\n        return True\n\n    def postUpdateUser(self, user, configurationAttributes):\n        return True\n\n    def postDeleteUser(self, user, configurationAttributes):\n        return True\n\n    def postUpdateGroup(self, group, configurationAttributes):\n        return True\n\n    def postCreateGroup(self, group, configurationAttributes):\n        return True\n\n    def postDeleteGroup(self, group, configurationAttributes):\n        return True\n\n    def getUser(self, user, configurationAttributes):\n        return True\n\n    def getGroup(self, group, configurationAttributes):\n        return True\n\n    def postSearchUsers(self, results, configurationAttributes):\n\n        print \"%d entries returned of %d\" % (results.getEntriesCount(), results.getTotalEntriesCount())\n        for user in results.getEntries():\n            print \"Flushing addresses for user %s\" % user.getUid() \n            user.setAttribute(\"jansAddress\", None)\n\n        return True\n\n    def postSearchGroups(self, results, configurationAttributes):\n        return True\n\n    def manageResourceOperation(self, context, entity, payload, configurationAttributes):\n        print \"manageResourceOperation. SCIM endpoint invoked is %s (HTTP %s)\" % (context.getPath(), context.getMethod()) \n        if context.getResourceType() != \"User\":\n            return None\n\n        expected_user_type = self.getUserType(context.getRequestHeaders())\n\n        if expected_user_type != None and entity.getAttribute(\"jansUsrTyp\") == expected_user_type:\n            return None\n        else:\n            return BaseScimWebService.getErrorResponse(403, None, \"Attempt to handle a not allowed user type\")\n\n    def manageSearchOperation(self, context, searchRequest, configurationAttributes):\n        print \"manageSearchOperation. SCIM endpoint invoked is %s (HTTP %s)\" % (context.getPath(), context.getMethod())\n\n        resource_type = context.getResourceType()\n        print \"manageSearchOperation. This is a search over %s resources\" % resource_type\n\n        if resource_type != \"User\":\n            return None\n\n        expected_user_type = self.getUserType(context.getRequestHeaders())\n\n        if expected_user_type != None:\n            context.setFilterPrepend(\"userType eq \\\"%s\\\"\" % expected_user_type)\n            return None\n        else:\n            return BaseScimWebService.getErrorResponse(403, None, \"Attempt to handle a not allowed user type\")\n\n    # headers params is an instance of javax.ws.rs.core.MultivaluedMap&lt;String, String&gt;\n    def getUserType(self, headers):\n        secret = headers.getFirst(self.custom_header)\n        if secret in self.access_map:\n            return self.access_map[secret]\n        else:\n            return None\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/scim/scim/#script-type-java","title":"Script Type: Java","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/scim/scim/#custom-scim-event-handler_1","title":"Custom SCIM Event Handler","text":"<p>The sample code snippet shows how to:</p> <ol> <li>Modify Search Results</li> <li>Segment the user base</li> <li>Allow/Deny resource operations</li> <li>Allow/Deny searches</li> </ol> <pre><code>/* Copyright (c) 2022, Janssen Project\n*\n* Author: Gluu\n*    1. Modifying Search Results\n*    2. Segmenting the user base\n*    3. Allow/Deny resource operations\n*    4. Allow/Deny searches\n*/\n\n\nimport io.jans.model.custom.script.type.scim.ScimType;\nimport io.jans.scim.ws.rs.scim2.BaseScimWebService;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.scim.model.scim.ScimCustomPerson;\nimport io.jans.scim.model.GluuGroup;\nimport io.jans.orm.model.PagedResult;\nimport io.jans.scim.service.external.OperationContext;\nimport io.jans.orm.model.base.Entry;\nimport jakarta.ws.rs.core.Response;\nimport io.jans.scim.model.scim2.SearchRequest;\nimport jakarta.ws.rs.core.MultivaluedMap;\n\nimport org.json.JSONObject;\nimport java.util.Map;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\npublic class ScimEventHandler implements ScimType {\n\n    private static final Logger log = LoggerFactory.getLogger(ScimEventHandler.class);\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n    private String custom_header;\n    private JSONObject access_map;\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        custom_header = configurationAttributes.get(\"custom_header\").getValue2();\n        String access_map_json = configurationAttributes.get(\"access_map\").getValue2();    \n        access_map = new JSONObject(access_map_json);\n        log.info(\"Custom Java ScimEventHandler (init)\");\n        scriptLogger.info(\"Custom Java ScimEventHandler (init): Initializing ...\");\n        scriptLogger.info(\"Custom Java ScimEventHandler (init): Initialized successfully\");        \n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Custom Java ScimEventHandler (init)\");\n        scriptLogger.info(\"Custom Java ScimEventHandler (init): Initializing ...\");\n        scriptLogger.info(\"Custom Java ScimEventHandler (init): Initialized successfully\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"Custom Java ScimEventHandler (destroy)\");\n        scriptLogger.info(\"Custom Java ScimEventHandler (destroy): Destroying ...\");\n        scriptLogger.info(\"Custom Java ScimEventHandler (destroy): Destroyed successfully\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 5;\n    }\n\n    @Override\n    public boolean createUser(Object user, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        return true;\n    }\n\n    @Override\n    public boolean postCreateUser(Object user, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        return true;\n    }\n\n    @Override\n    public boolean updateUser(Object user, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        return true;\n    }\n\n    @Override\n    public boolean postUpdateUser(Object user, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        return true;\n    }\n\n    @Override\n    public boolean deleteUser(Object user, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        return true;\n    }\n\n    @Override\n    public boolean postDeleteUser(Object user, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        return true;\n    }\n\n    @Override\n    public boolean createGroup(Object group, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        return true;\n    }\n\n    @Override\n    public boolean postCreateGroup(Object group, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        return true;\n    }\n\n    @Override\n    public boolean updateGroup(Object group, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        return true;\n    }\n\n    @Override\n    public boolean postUpdateGroup(Object group, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        return true;\n    }\n\n    @Override\n    public boolean deleteGroup(Object group, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        return true;\n    }\n\n    @Override\n    public boolean postDeleteGroup(Object group, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        return true;\n    }\n\n    @Override\n    public boolean getUser(Object user, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        return true;\n    }\n\n    @Override\n    public boolean getGroup(Object group, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        return true;\n    }\n\n    @Override\n    public boolean postSearchUsers(Object results, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        PagedResult res = (PagedResult) results;\n        scriptLogger.info(\"{} entries returned of {}\", res.getEntriesCount(), res.getTotalEntriesCount());\n        for (Object entry : res.getEntries()) {   \n            ScimCustomPerson user = (ScimCustomPerson) entry;     \n            scriptLogger.info(\"Flushing addresses for user {}\", user.getUid());\n            user.setAttribute(\"jansAddress\", \"\");\n        }\n        return true;\n    }\n\n    @Override\n    public boolean postSearchGroups(Object results, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        return true;\n    }\n\n    @Override\n    public Response manageResourceOperation(Object context, Object entity, Object payload, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        OperationContext ctx = (OperationContext) context;\n        scriptLogger.info(\"manageResourceOperation. SCIM endpoint invoked is {} (HTTP {})\", ctx.getPath(), ctx.getMethod());\n\n        String resource_type = ctx.getResourceType();\n        if(!resource_type.equals(\"User\")){\n            return null;\n        }\n\n        String expected_user_type = this.getUserType(ctx.getRequestHeaders());\n        ScimCustomPerson ent = (ScimCustomPerson) entity;    \n        String jansUsrType = ent.getAttribute(\"jansUsrTyp\");\n\n        if(expected_user_type != null &amp;&amp; jansUsrType.equals(expected_user_type)){ \n            return null;\n        }\n        else{\n            return new BaseScimWebService().getErrorResponse(403, null, \"Attempt to handle a not allowed user type\");\n        }        \n    }\n\n    @Override\n    public Response manageSearchOperation(Object context, Object searchRequest, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes){\n        OperationContext ctx = (OperationContext) context;\n        scriptLogger.info(\"manageSearchOperation. SCIM endpoint invoked is {} (HTTP {})\", ctx.getPath(), ctx.getMethod());\n\n        String resource_type = ctx.getResourceType();\n        scriptLogger.info(\"manageSearchOperation. This is a search over {} resources\", resource_type);\n\n        if(!resource_type.equals(\"User\")){\n            return null;\n        }\n\n        String expected_user_type = this.getUserType(ctx.getRequestHeaders());\n\n        if(expected_user_type != null){\n            scriptLogger.info(\"manageSearchOperation. Setting filter to userType eq \\\"{}\\\"\", expected_user_type);\n            ctx.setFilterPrepend(\"userType eq \\\"\" + expected_user_type + \"\\\"\");\n            return null;\n        }\n        else{\n            return new BaseScimWebService().getErrorResponse(403, null, \"Attempt to handle a not allowed user type\");\n        }\n    }\n\n    // headers params is an instance of javax.ws.rs.core.MultivaluedMap&lt;String, String&gt;\n    public String getUserType(MultivaluedMap&lt;String, String&gt; headers){\n        String secret = headers.getFirst(custom_header);\n        String[] keys = JSONObject.getNames(access_map);\n\n        for(int i = 0; i &lt; keys.length; i++){\n            if(keys[i].equals(secret)){\n                return access_map.getString(keys[i]);\n            }\n        }        \n        return null;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/select_account/select-account/","title":"Select Account","text":"<p>A person may have several accounts on a single Jans Auth Server instance. For example, it is common to have several Gmail accounts. Jans Auth Server uses two cookies to track which accounts are associated with a browser: <code>session_id</code> and <code>current_sessions</code>.</p> <p>Please check Multiple Sessions In One Browser Overview</p> <p>Select Account interception script can be used to customize account selection behavior. E.g. redirect to external page or change text representation of sessions on page.</p>","tags":["administration","developer","script-catalog","SelectAccount"]},{"location":"script-catalog/select_account/select-account/#interface","title":"Interface","text":"<p>The select account script implements the SelectAccountType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog","SelectAccount"]},{"location":"script-catalog/select_account/select-account/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog","SelectAccount"]},{"location":"script-catalog/select_account/select-account/#new-methods","title":"New Methods","text":"Method header Method description <code>def getSelectAccountPage(self, context)</code> This method is called to return path to custom select account page (e.g. /customs/page/path/myselectaccount.xhtml) <code>def prepare(self, context)</code> This method is called before select account page is loaded. It can be used to prevent loading or redirect to external url. <code>def getAccountDisplayName(self, context)</code> This method is used to customize text representation of the session shown on the page. Returns display name for given session id (https://github.com/JanssenProject/jans/blob/main/jans-auth-server/common/src/main/java/io/jans/as/common/model/session/SessionId.java). <code>def onSelect(self, context)</code> This method is called on session selection and can be used to forbid selection.","tags":["administration","developer","script-catalog","SelectAccount"]},{"location":"script-catalog/select_account/select-account/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>SimpleCustomProperty</code> Map of configuration properties. Reference <code>context</code> Execution Context Reference","tags":["administration","developer","script-catalog","SelectAccount"]},{"location":"script-catalog/select_account/select-account/#use-case-dummy-select-account-example-script-does-not-have-impact-on-built-in-account-selection","title":"Use case: Dummy Select Account example script (does not have impact on built-in account selection)","text":"<p>Select Account script example.</p>","tags":["administration","developer","script-catalog","SelectAccount"]},{"location":"script-catalog/select_account/select-account/#script-type-python","title":"Script Type: Python","text":"<pre><code># oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2020, Janssen\n#\n# Author: Yuriy Z\n#\n#\n\nfrom io.jans.model.custom.script.type.selectaccount import SelectAccountType\nfrom java.lang import String\n\nclass SelectAccount(SelectAccountType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"SelectAccount script. Initializing ...\"\n        print \"SelectAccount script. Initialized successfully\"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"SelectAccount script. Destroying ...\"\n        print \"SelectAccount script. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Returns path to select account page (e.g. /customs/page/path/myselectaccount.xhtml)\n    # If none or empty string is returned, AS uses built-in page.\n    # (Note: Custom page can be also put into `custom/pages/selectAccount.xhtml` and used without custom script.)\n    # context is reference of io.jans.as.server.model.common.ExecutionContext( https://github.com/JanssenProject/jans/blob/main/jans-auth-server/server/src/main/java/io/jans/as/server/model/common/ExecutionContext.java )\n    def getSelectAccountPage(self, context):\n        return \"\"\n\n    # This method is called before select account page is loaded.\n    # It is good place to make preparation processing.\n    # E.g. check whether it is ok to land on select account page or maybe redirect to external page.\n    # Return True - continue loading of the page\n    # Return False - stop loading and show error page\n    # context is reference of io.jans.as.server.model.common.ExecutionContext( https://github.com/JanssenProject/jans/blob/main/jans-auth-server/server/src/main/java/io/jans/as/server/model/common/ExecutionContext.java )\n    def prepare(self, context):\n        return True\n\n    # Returns display name for given session id (https://github.com/JanssenProject/jans/blob/main/jans-auth-server/common/src/main/java/io/jans/as/common/model/session/SessionId.java).\n    # Session can be accessed via context.getSessionId()\n    # Typical use is: context.getSessionId().getUser().getAttribute(\"myDisplayName\")\n    # Returns string. If blank string is returned, AS will return built-in implementation to return display name\n    # which is context.getSessionId().getUser().getAttribute(\"displayName\")\n    # context is reference of io.jans.as.server.model.common.ExecutionContext( https://github.com/JanssenProject/jans/blob/main/jans-auth-server/server/src/main/java/io/jans/as/server/model/common/ExecutionContext.java )\n    def getAccountDisplayName(self, context):\n        return \"\"\n\n    # This method is called on session selection.\n    # Selected session can be accessed as context.getSessionId()\n    # Return True - continue session selection\n    # Return False - stop session selection (forbid it)\n    # context is reference of io.jans.as.server.model.common.ExecutionContext( https://github.com/JanssenProject/jans/blob/main/jans-auth-server/server/src/main/java/io/jans/as/server/model/common/ExecutionContext.java )\n    def onSelect(self, context):\n        return True\n</code></pre>","tags":["administration","developer","script-catalog","SelectAccount"]},{"location":"script-catalog/select_account/select-account/#script-type-java","title":"Script Type: Java","text":"<pre><code>import io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\n\nimport java.util.Map;\n\n/**\n * @author Yuriy Z\n */\npublic class DummySelectAccountType implements SelectAccountType {\n\n    @Override\n    public String getSelectAccountPage(Object context) {\n        return \"\";\n    }\n\n    @Override\n    public boolean prepare(Object context) {\n        return true;\n    }\n\n    @Override\n    public String getAccountDisplayName(Object context) {\n        return \"\";\n    }\n\n    @Override\n    public boolean onSelect(Object context) {\n        return false;\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 1;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog","SelectAccount"]},{"location":"script-catalog/spontaneous_scope/spontaneous-scope/","title":"Spontaneous Scope","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/spontaneous_scope/spontaneous-scope/#interface","title":"Interface","text":"<p>The Spontaneous scope script implements the SpontaneousScopeType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/spontaneous_scope/spontaneous-scope/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/spontaneous_scope/spontaneous-scope/#new-methods","title":"New Methods","text":"Method header Method description <code>def manipulateScopes(self, context)</code> This method is called before spontaneous scope is persisted. It's possible to disable persistence via <code>context.setAllowSpontaneousScopePersistence(false)</code> Also it's possible to manipulated already granted scopes, e.g. <code>context.getGrantedScopes().remove(\"transaction:456\")</code>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/spontaneous_scope/spontaneous-scope/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>context</code> Execution Context Reference","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/spontaneous_scope/spontaneous-scope/#script-type-python","title":"Script Type: Python","text":"<pre><code># oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2018, Janssen\n#\n# Author: Yuriy Zabrovarnyy\n#\n#\n\nfrom io.jans.model.custom.script.type.spontaneous import SpontaneousScopeType\nfrom java.lang import String\n\nclass SpontaneousScope(SpontaneousScopeType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Spontaneous scope script. Initializing ...\"\n        print \"Spontaneous scope script. Initialized successfully\"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"Spontaneous scope script. Destroying ...\"\n        print \"Spontaneous scope script. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # This method is called before spontaneous scope is persisted. It's possible to disable persistence via context.setAllowSpontaneousScopePersistence(false)\n    # Also it's possible to manipulated already granted scopes, e.g. context.getGrantedScopes().remove(\"transaction:456\")\n    # Note :\n    # context is reference of io.jans.as.service.external.context.SpontaneousScopeExternalContext(in https://github.com/JanssenFederation/oxauth project, )\n    def manipulateScopes(self, context):\n        return\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/spontaneous_scope/spontaneous-scope/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of broadest relevance, and this page is coming in the near future.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/spontaneous_scope/spontaneous-scope/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/spontaneous_scope/spontaneous-scope/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/ssa/ssa-modify-response/","title":"SSA response modification script","text":"","tags":["administration","developer","script-catalog","ssa"]},{"location":"script-catalog/ssa/ssa-modify-response/#this-content-is-in-progress","title":"This content is in progress","text":"<p>The Janssen Project documentation is currently in development. Topic pages are being created in order of the broadest relevance, and this page is coming in the near future.</p>","tags":["administration","developer","script-catalog","ssa"]},{"location":"script-catalog/ssa/ssa-modify-response/#have-questions-in-the-meantime","title":"Have questions in the meantime?","text":"<p>While this documentation is in progress, you can ask questions through GitHub Discussions or the community chat on Zulip. Any questions you have will help determine what information our documentation should cover.</p>","tags":["administration","developer","script-catalog","ssa"]},{"location":"script-catalog/ssa/ssa-modify-response/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","developer","script-catalog","ssa"]},{"location":"script-catalog/token_exchange/token-exchange/","title":"Token Exchange Custom Script","text":"<p>The Jans-Auth server supports OAuth 2.0 Token Exchange (RFC 8693), which enables clients to exchange one type of token for another. This capability allows scenarios such as delegation, constrained token issuance, and token transformation to meet various security and interoperability requirements.</p> <p>This script is used to control the Token Exchange behavior at Token Endpoint as defined by the OAuth 2.0 Token Exchange specification.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/token_exchange/token-exchange/#behavior","title":"Behavior","text":"<p>The Token Exchange Endpoint accepts requests where a client submits an existing token (the subject token) and requests a new token (the requested token) with potentially different properties, scopes, or lifetimes. Upon receiving a request, the endpoint validates the provided token, applies custom business or security logic, and returns a response indicating whether the token exchange is approved. If approved, the Token Endpoint issues a new token based on the rules defined in the custom script.</p> <p>During token exchange processing, the <code>TokenExchange</code> custom script is executed. Jans-Auth includes a sample demo script that illustrates a simple example of custom token exchange logic.</p> <p>Sample request</p> <pre><code>POST /jans-auth/restv1/token HTTP/1.1\nHost: happy-example.gluu.info\nContent-Type: application/json\nAuthorization: Bearer eyJraWQiOiJr...\n\n{\n  \"subject_token\": \"eyJraWQiOiJr...\",\n  \"subject_token_type\": \"urn:ietf:params:oauth:token-type:access_token\",\n  \"audience\": \"&lt;audience&gt;\",\n  \"actor_token\": \"eyJraWQiOiJr...\",\n  \"actor_token_type\": \"urn:ietf:params:oauth:token-type:access_token\"\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/token_exchange/token-exchange/#interface","title":"Interface","text":"<p>The Token Exchange script implements the TokenExchangeType interface. This interface extends the base custom script type with methods specific to token exchange operations:</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/token_exchange/token-exchange/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/token_exchange/token-exchange/#new-methods","title":"New methods","text":"Method header Method description <code>def validate(self, context)</code> Called before built-in validation, main purpose is to perform all validations in this method. It must return <code>ScriptTokenExchangeControl</code>. <code>def modifyResponse(self, responseAsJsonObject, context)</code> Called after validation and actual token exchange. It allows to modify response or return custom error if needed.","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/token_exchange/token-exchange/#objects","title":"Objects","text":"Object name Object description <code>responseAsJsonObject</code> Response represented as json by <code>org.json.JSONObject</code> <code>context</code> Reference","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/token_exchange/token-exchange/#sample-demo-custom-script","title":"Sample Demo Custom Script","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/token_exchange/token-exchange/#script-type-java","title":"Script Type: Java","text":"<pre><code>/*\n Copyright (c) 2025, Gluu\n Author: Yuriy Z\n */\nimport io.jans.as.common.model.common.User;\nimport io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.token.ScriptTokenExchangeControl;\nimport io.jans.model.custom.script.type.token.TokenExchangeType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.json.JSONObject;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\n\npublic class TokenExchange implements TokenExchangeType {\n\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    @Override\n    public ScriptTokenExchangeControl validate(Object context) {\n\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n        String audience = scriptContext.getRequestParameter(\"audience\");\n        String subjectToken = scriptContext.getRequestParameter(\"subject_token\");\n        String subjectTokenType = scriptContext.getRequestParameter(\"subject_token_type\");\n        String deviceSecret = scriptContext.getRequestParameter(\"actor_token\");\n        String actorTokenType = scriptContext.getRequestParameter(\"actor_token_type\");\n\n        // perform all validations here\n        boolean validationFailed = false;\n        if (validationFailed) {\n            return ScriptTokenExchangeControl.fail();\n        }\n\n        // user identified by request information or otherwise null\n        User user = new User();\n\n        return ScriptTokenExchangeControl\n                .ok()\n                .setSkipBuiltinValidation(true) // this skip build-in validations of all parameters that come\n                .setUser(user);\n    }\n\n    /**\n     * @param responseAsJsonObject - response represented by org.json.JSONObject\n     * @param context              - script context represented by io.jans.as.server.service.external.context.ExternalScriptContext\n     * @return true if changes must be applied to final response or false if whatever made in this method has to be cancelled\n     */\n    @Override\n    public boolean modifyResponse(Object responseAsJsonObject, Object context) {\n        JSONObject response = (JSONObject) responseAsJsonObject;\n        response.accumulate(\"key_from_script\", \"value_from_script\");\n        return true; // return false if you wish to cancel whatever modification was made before\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized TokenExchange Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized TokenExchange Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed TokenExchange Java custom script.\");\n        return false;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/tx_token/txtoken/","title":"Transaction Token Script (tx_token)","text":"<p>By overriding the interface methods in <code>TxTokenType</code> inside a custom script you can</p> <ol> <li> <p>Modify JWT payload of 'tx_token' before it is persisted.</p> </li> <li> <p>Modify response from <code>/token</code> endpoint when Transaction Token are used.</p> </li> <li> <p>Modify lifetime of tx_token.</p> </li> </ol>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/tx_token/txtoken/#interface","title":"Interface","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/tx_token/txtoken/#methods","title":"Methods","text":"<p>The TxTokenType interception script extends the base script type with the <code>init</code>, <code>destroy</code> and <code>getApiVersion</code> methods:</p> Inherited Methods Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10 <p>The <code>configurationAttributes</code> parameter is <code>java.util.Map&lt;String, SimpleCustomProperty&gt;</code>.</p> <p>The TxTokenType interception script also adds the following method(s):</p> Method Method description <code>def getTxTokenLifetimeInSeconds(self, context)</code> Used to modify Tx Token lifetime in seconds.  <code>context</code> is <code>io.jans.as.server.service.external.context.ExternalScriptContext</code> <code>def modifyTokenPayload(self, jsonWebResponse, context)</code> Used to modify TxToken object before it is persisted. Returning false from modifyTokenPayload will prevent tx_token creation.  <code>jsonWebResponse</code> is <code>io.jans.as.model.token.JsonWebResponse</code> <code>context</code> is <code>io.jans.as.server.service.external.context.ExternalScriptContext</code> <code>def modifyResponse(self, response, context)</code> Used to modify response from <code>/token</code> endpoint for transaction tokens.   <code>response</code> is <code>org.json.JSONObject</code> <code>context</code> is <code>io.jans.as.server.service.external.context.ExternalScriptContext</code>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/tx_token/txtoken/#script-type-java","title":"Script Type: Java","text":"<pre><code>import io.jans.as.model.token.JsonWebResponse;\nimport io.jans.as.server.service.external.context.ExternalScriptContext;\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.token.TxTokenType;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport org.json.JSONObject;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Map;\n\npublic class TxToken implements TxTokenType {\n\n    private static final Logger scriptLogger = LoggerFactory.getLogger(CustomScriptManager.class);\n\n    /**\n     *\n     * @param context context refers to io.jans.as.server.service.external.context.ExternalScriptContext\n     * @return lifetime of tx_token in seconds. It must be more than 0 or otherwise it will be ignored by server.\n     */\n    @Override\n    public int getTxTokenLifetimeInSeconds(Object context) {\n        boolean condition = false; // under some condition return 1 day lifetime\n        if (condition) {\n            return 86400;\n        }\n        return 0;\n    }\n\n    /**\n     *\n     * @param jsonWebResponse refers to io.jans.as.model.token.JsonWebResponse\n     * @param context refers to io.jans.as.server.service.external.context.ExternalScriptContext\n     * @return true if tx_token should be created or false to forbid tx_token creation.\n     */\n    @Override\n    public boolean modifyTokenPayload(Object jsonWebResponse, Object context) {\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n        JsonWebResponse jwr = (JsonWebResponse) jsonWebResponse;\n        jwr.getClaims().setClaim(\"custom_claim\", \"custom_value\");\n\n        return true;\n    }\n\n    /**\n     * @param responseAsJsonObject - response represented by org.json.JSONObject\n     * @param context              - script context represented by io.jans.as.server.service.external.context.ExternalScriptContext\n     * @return true if changes must be applied to final response or false if whatever made in this method has to be cancelled\n     */\n    @Override\n    public boolean modifyResponse(Object responseAsJsonObject, Object context) {\n        ExternalScriptContext scriptContext = (ExternalScriptContext) context;\n\n        JSONObject json = (JSONObject) responseAsJsonObject;\n        json.accumulate(\"custom_key\", \"custom_value\");\n        return true;\n    }\n\n    @Override\n    public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized TxToken Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Initialized TxToken Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        scriptLogger.info(\"Destroyed TxToken Java custom script.\");\n        return true;\n    }\n\n    @Override\n    public int getApiVersion() {\n        return 11;\n    }\n}\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/uma_claims_gathering/uma-claims-web/","title":"UMA Claims Gathering (Web Flow)","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/uma_claims_gathering/uma-claims-web/#interface","title":"Interface","text":"<p>The UmaClaimsGathering script implements the UmaClaimsGatheringType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/uma_claims_gathering/uma-claims-web/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/uma_claims_gathering/uma-claims-web/#new-methods","title":"New Methods","text":"Method header Method description <code>def gather(self, step, context):</code> Main gather method. Must return True (if gathering performed successfully) or False (if fail). Method must set claim into context (via context.putClaim('name', value)) in order to persist it (otherwise it will be lost). All user entered values can be access via Map context.getPageClaims() <code>def prepareForStep(self, step, context)</code> ... <code>def getNextStep(self, step, context)</code> ... <code>def getPageForStep(self, step, context)</code> ...","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/uma_claims_gathering/uma-claims-web/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>context</code> Execution Context Reference","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/uma_claims_gathering/uma-claims-web/#script-type-python","title":"Script Type: Python","text":"<pre><code># oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2017, Janssen\n#\n# Author: Yuriy Zabrovarnyy\n#\n\nfrom io.jans.model.custom.script.type.uma import UmaClaimsGatheringType\n\nclass UmaClaimsGathering(UmaClaimsGatheringType):\n\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"Claims-Gathering. Initializing ...\"\n        print \"Claims-Gathering. Initialized successfully\"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"Claims-Gathering. Destroying ...\"\n        print \"Claims-Gathering. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n\n    # Main gather method. Must return True (if gathering performed successfully) or False (if fail).\n    # Method must set claim into context (via context.putClaim('name', value)) in order to persist it (otherwise it will be lost).\n    # All user entered values can be access via Map&lt;String, String&gt; context.getPageClaims()\n    def gather(self, step, context): # context is reference of io.jans.as.uma.authorization.UmaGatherContext\n        print \"Claims-Gathering. Gathering ...\"\n\n        if step == 1:\n            if (context.getPageClaims().containsKey(\"country\")):\n                country = context.getPageClaims().get(\"country\")\n                print \"Country: \" + country\n\n                context.putClaim(\"country\", country)\n                return True\n\n            print \"Claims-Gathering. 'country' is not provided on step 1.\"\n            return False\n\n        elif step == 2:\n            if (context.getPageClaims().containsKey(\"city\")):\n                city = context.getPageClaims().get(\"city\")\n                print \"City: \" + city\n\n                context.putClaim(\"city\", city)\n                print \"Claims-Gathering. 'city' is not provided on step 2.\"\n                return True\n\n        return False\n\n    def getNextStep(self, step, context):\n        return -1\n\n    def prepareForStep(self, step, context):\n        if step == 10 and not context.isAuthenticated():\n            # user is not authenticated, so we are redirecting user to authorization endpoint\n            # client_id is specified via configuration attribute.\n            # Make sure that given client has redirect_uri to Claims-Gathering Endpoint with parameter authentication=true\n            # Sample https://sample.com/restv1/uma/gather_claims?authentication=true\n            # If redirect to external url is performated, make sure that viewAction has onPostback=\"true\" (otherwise redirect will not work)\n            # After user is authenticated then within the script it's possible to get user attributes as\n            # context.getUser(\"uid\", \"sn\")\n            # If user is authenticated to current AS (to the same server, not external one) then it's possible to\n            # access Connect session attributes directly (no need to obtain id_token after redirect with 'code').\n            # To fetch attributes please use getConnectSessionAttributes() method.\n\n            print \"User is not authenticated. Redirect for authentication ...\"\n            clientId = context.getConfigurationAttributes().get(\"client_id\").getValue2()\n            redirectUri = context.getClaimsGatheringEndpoint() + \"?authentication=true\" # without authentication=true parameter it will not work\n            authorizationUrl = context.getAuthorizationEndpoint() + \"?client_id=\" + clientId + \"&amp;redirect_uri=\" + redirectUri + \"&amp;scope=openid&amp;response_type=code\"\n            context.redirectToExternalUrl(authorizationUrl) # redirect to external url\n            return False\n        if step == 10 and context.isAuthenticated(): # example how to get session attribute if user is authenticated to same AS\n            arc = context.getConnectSessionAttributes().get(\"acr\")\n\n        return True\n\n    def getStepsCount(self, context):\n        return 2\n\n    def getPageForStep(self, step, context):\n        if step == 1:\n            return \"/uma2/sample/country.xhtml\"\n        elif step == 2:\n            return \"/uma2/sample/city.xhtml\"\n        return \"\"\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/uma_claims_gathering/uma-claims-web/#want-to-contribute","title":"Want to contribute?","text":"<p>If you'd like to contribute content to this page, check out our Contribution guide.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/uma_rpt_claims/uma-claims-jwt/","title":"UMA Claims (JWT Transformation)","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/uma_rpt_claims/uma-claims-jwt/#interface","title":"Interface","text":"<p>The UmaRptClaims script implements the UmaRptClaimsType interface. This extends methods from the base script type in addition to adding new methods:</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/uma_rpt_claims/uma-claims-jwt/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/uma_rpt_claims/uma-claims-jwt/#new-methods","title":"New Methods","text":"Method header Method description <code>def modify(self, rptAsJsonObject, context)</code> responseAsJsonObject - is <code>org.codehaus.jettison.json.JSONObject</code>, you can use any method to manipulate json. <code>context</code> is reference of <code>io.jans.as.service.external.context.ExternalUmaRptClaimsContext</code> (in <code>https://github.com/JanssenFederation/oxauth</code> project, )","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/uma_rpt_claims/uma-claims-jwt/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>context</code> Execution Context Reference","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/uma_rpt_claims/uma-claims-jwt/#script-type-python","title":"Script Type: Python","text":"<pre><code># oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2020, Janssen\n#\n# Author: Yuriy Zabrovarnyy\n#\n#\n\nfrom io.jans.model.custom.script.type.uma import UmaRptClaimsType\nfrom java.lang import String\n\nclass UmaRptClaims(UmaRptClaimsType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"RPT Claims script. Initializing ...\"\n        print \"RPT Claims script. Initialized successfully\"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"RPT Claims script. Destroying ...\"\n        print \"RPT Claims script. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Returns boolean, true - apply changes from script method, false - ignore it.\n    # Note :\n    # responseAsJsonObject - is org.codehaus.jettison.json.JSONObject, you can use any method to manipulate json\n    # context is reference of io.jans.as.service.external.context.ExternalUmaRptClaimsContext (in https://github.com/JanssenFederation/oxauth project, )\n    def modify(self, rptAsJsonObject, context):\n        rptAsJsonObject.accumulate(\"key_from_script\", \"value_from_script\")\n        return True\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/uma_rpt_claims/uma-claims-jwt/#want-to-contribute","title":"Want to contribute?","text":"<p>If you have content you'd like to contribute to this page in the meantime, you can get started with our Contribution guide.</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/uma_rpt_policy/uma-rpt/","title":"UMA RPT Policy","text":"<p>This is a special script for UMA. It allows an admin to protect UMA scopes with policies. It is possible to add more than one UMA policy to an UMA scope. On requesting access to a specified resource, the application should call specified UMA policies in order to grant or deny access.</p>","tags":["administration","developer","script-catalog","UmaRptPolicy"]},{"location":"script-catalog/uma_rpt_policy/uma-rpt/#interface","title":"Interface","text":"<p>The UMA RPT Authorization Policy script implements the UmaRptPolicyType interface. This extends methods from the base script type in addition to adding new method:</p>","tags":["administration","developer","script-catalog","UmaRptPolicy"]},{"location":"script-catalog/uma_rpt_policy/uma-rpt/#inherited-methods","title":"Inherited Methods","text":"Method header Method description <code>def init(self, customScript, configurationAttributes)</code> This method is only called once during the script initialization. It can be used for global script initialization, initiate objects etc <code>def destroy(self, configurationAttributes)</code> This method is called once to destroy events. It can be used to free resource and objects created in the <code>init()</code> method <code>def getApiVersion(self, configurationAttributes, customScript)</code> The getApiVersion method allows API changes in order to do transparent migration from an old script to a new API. Only include the customScript variable if the value for getApiVersion is greater than 10","tags":["administration","developer","script-catalog","UmaRptPolicy"]},{"location":"script-catalog/uma_rpt_policy/uma-rpt/#new-methods","title":"New Methods","text":"Method header Method description <code>def getRequiredClaims(self, authorizationContext)</code> Returns required claims definitions. This method must provide definition of all claims that is used in 'authorize' method. Return empty array <code>[]</code> if no claims should be gathered. Note : name in both places must match. <code>%1$s</code> - placeholder for issuer. It uses standard Java Formatter, docs : https://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html <code>def authorize(self, authorizationContext)</code> Main authorization method. Must return True or False. <code>def getClaimsGatheringScriptName(self, authorizationContext)</code> Returns name of the Claims-Gathering script which will be invoked if need_info error is returned. Return blank/empty string if claims gathering flow is not involved.","tags":["administration","developer","script-catalog","UmaRptPolicy"]},{"location":"script-catalog/uma_rpt_policy/uma-rpt/#objects","title":"Objects","text":"Object name Object description <code>customScript</code> The custom script object. Reference <code>configurationAttributes</code> <code>configurationProperties</code> passed in when adding custom script. <code>Map&lt;String, SimpleCustomProperty&gt; configurationAttributes</code> <code>SimpleCustomProperty</code> Map of configuration properties. Reference <code>context</code> Reference <code>ClaimDefinition</code> Reference","tags":["administration","developer","script-catalog","UmaRptPolicy"]},{"location":"script-catalog/uma_rpt_policy/uma-rpt/#use-case-request-country-and-city-policies","title":"Use case: Request Country and City Policies","text":"<p>This script was adapted from the Gluu Server UMA RPT Authorization Script.</p>","tags":["administration","developer","script-catalog","UmaRptPolicy"]},{"location":"script-catalog/uma_rpt_policy/uma-rpt/#script-type-python","title":"Script Type: Python","text":"<pre><code># oxAuth is available under the MIT License (2008). See http://opensource.org/licenses/MIT for full text.\n# Copyright (c) 2017, Janssen\n#\n# Author: Yuriy Zabrovarnyy\n#\n# Call sequence\n# 1. First is call constructor of the Script __init__\n# 2. Next init() method\n# 3. Next getRequiredClaims() - method returns required claims, so UMA engine checks whether\n#    in request RP provided all claims that are required. Pay attention that there can be\n#    multiple scripts bound to the scopes, means that UMA engine will build set of required claims\n#    from all scripts. If not all claims are provided need_info error is sent to RP.\n#    During need_info construction getClaimsGatheringScriptName() method is called\n# 4. authorize() method is called if all required claims are provided.\n# 5. destroy()\n\nfrom io.jans.model.custom.script.type.uma import UmaRptPolicyType\nfrom io.jans.model.uma import ClaimDefinitionBuilder\nfrom java.lang import String\n\nclass UmaRptPolicy(UmaRptPolicyType):\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        print \"RPT Policy. Initializing ...\"\n        print \"RPT Policy. Initialized successfully\"\n\n        return True\n\n    def destroy(self, configurationAttributes):\n        print \"RPT Policy. Destroying ...\"\n        print \"RPT Policy. Destroyed successfully\"\n        return True\n\n    def getApiVersion(self):\n        return 11\n\n    # Returns required claims definitions.\n    # This method must provide definition of all claims that is used in 'authorize' method.\n    # Note : name in both places must match.\n    # %1$s - placeholder for issuer. It uses standard Java Formatter, docs : https://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html\n    def getRequiredClaims(self, context): # context is reference of io.jans.as.uma.authorization.UmaAuthorizationContext\n        json = \"\"\"[\n        {\n            \"issuer\" : [ \"%1$s\" ],\n            \"name\" : \"country\",\n            \"claim_token_format\" : [ \"http://openid.net/specs/openid-connect-core-1_0.html#IDToken\" ],\n            \"claim_type\" : \"string\",\n            \"friendly_name\" : \"country\"\n        },\n        {\n            \"issuer\" : [ \"%1$s\" ],\n            \"name\" : \"city\",\n            \"claim_token_format\" : [ \"http://openid.net/specs/openid-connect-core-1_0.html#IDToken\" ],\n            \"claim_type\" : \"string\",\n            \"friendly_name\" : \"city\"\n        }\n        ]\"\"\"\n        context.addRedirectUserParam(\"customUserParam1\", \"value1\") # pass some custom parameters to need_info uri. It can be removed if you don't need custom parameters.\n        return ClaimDefinitionBuilder.build(String.format(json, context.getIssuer()))\n\n    # Main authorization method. Must return True or False.\n    def authorize(self, context): # context is reference of io.jans.as.uma.authorization.UmaAuthorizationContext\n        print \"RPT Policy. Authorizing ...\"\n\n        if context.getClaim(\"country\") == 'US' and context.getClaim(\"city\") == 'NY':\n            print \"Authorized successfully!\"\n            return True\n\n        return False\n\n    # Returns name of the Claims-Gathering script which will be invoked if need_info error is returned.\n    def getClaimsGatheringScriptName(self, context): # context is reference of io.jans.as.uma.authorization.UmaAuthorizationContext\n        context.addRedirectUserParam(\"customUserParam2\", \"value2\") # pass some custom parameters to need_info uri. It can be removed if you don't need custom parameters.\n        return \"sampleClaimsGathering\"\n</code></pre>","tags":["administration","developer","script-catalog","UmaRptPolicy"]},{"location":"script-catalog/uma_rpt_policy/uma-rpt/#script-type-java","title":"Script Type: Java","text":"<pre><code>import java.util.List;\nimport java.util.Map;\n\nimport io.jans.model.SimpleCustomProperty;\nimport io.jans.model.custom.script.model.CustomScript;\nimport io.jans.model.custom.script.type.uma.UmaRptPolicyType;\nimport io.jans.model.uma.ClaimDefinition;\nimport io.jans.service.custom.script.CustomScriptManager;\nimport io.jans.as.server.uma.authorization.UmaAuthorizationContext;\nimport io.jans.model.uma.ClaimDefinitionBuilder;\n\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\n\npublic class UmaRptPolicy implements UmaRptPolicyType {\n\n        private static final Logger log = LoggerFactory.getLogger(UmaRptPolicy.class);\n\n        @Override\n        public boolean init(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"UMA RPT Policy Authorization. Initializing...\");\n        log.info(\"UMA RPT Policy Authorization. Initialized\");\n                return true;\n        }\n\n        @Override\n        public boolean init(CustomScript customScript, Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"UMA RPT Policy Authorization. Initializing...\");\n        log.info(\"UMA RPT Policy Authorization. Initialized\");\n        return true;\n        }\n\n        @Override\n        public boolean destroy(Map&lt;String, SimpleCustomProperty&gt; configurationAttributes) {\n        log.info(\"UMA RPT Policy Authorization. Destroying...\");\n        log.info(\"UMA RPT Policy Authorization. Destroyed.\");\n        return true;\n        }\n\n        @Override\n        public int getApiVersion() {\n                return 11;\n        }\n\n        @Override\n        public List&lt;ClaimDefinition&gt; getRequiredClaims(Object authorizationContext) {\n                UmaAuthorizationContext authContext = (UmaAuthorizationContext) authorizationContext;\n\n                // TODO: Customize this JSON array with your required claim definitions\n                String json = \"[{\\\"issuer\\\":[\\\"%s\\\"],\\\"name\\\":\\\"country\\\",\\\"claim_token_format\\\":[\\\"http://openid.net/specs/openid-connect-core-1_0.html#IDToken\\\"],\\\"claim_type\\\":\\\"string\\\",\\\"friendly_name\\\":\\\"country\\\"},{\\\"issuer\\\":[\\\"%s\\\"],\\\"name\\\":\\\"city\\\",\\\"claim_token_format\\\":[\\\"http://openid.net/specs/openid-connect-core-1_0.html#IDToken\\\"],\\\"claim_type\\\":\\\"string\\\",\\\"friendly_name\\\":\\\"city\\\"}]\";\n\n                authContext.addRedirectUserParam(\"customUserParam1\", \"value1\");\n                return ClaimDefinitionBuilder.build(String.format(json, authContext.getIssuer(), authContext.getIssuer()));\n        }\n\n        @Override\n        public boolean authorize(Object authorizationContext) {\n                log.info(\"UMA RPT Policy Authorization. Authorizing...\");\n                UmaAuthorizationContext authContext = (UmaAuthorizationContext) authorizationContext;\n                if (\"US\".equals(authContext.getClaim(\"country\")) &amp;&amp; \"NY\".equals(authContext.getClaim(\"city\"))) {\n                        log.info(\"Authorized successfully!\");\n                        return true;\n                }\n                return false;\n        }\n\n        @Override\n        public String getClaimsGatheringScriptName(Object authorizationContext) {\n                UmaAuthorizationContext authContext = (UmaAuthorizationContext) authorizationContext;\n                // pass some custom parameters to need_info uri. It can be removed if you don't need custom parameters.\n                authContext.addRedirectUserParam(\"customUserParam2\", \"value2\"); \n                return \"sampleClaimsGathering\";\n        }\n\n}\n</code></pre>","tags":["administration","developer","script-catalog","UmaRptPolicy"]},{"location":"script-catalog/update_token/update-token/","title":"Update Token","text":"<p>By overriding the interface methods in <code>UpdateTokenType</code> inside a custom script you can</p> <ol> <li>Enable transformation of claims and values in id_token and Access token e.g. add a custom claim to an <code>id_token</code>, change a token expiry, change the <code>sub</code> value, or remove the <code>nonce</code>.  </li> </ol> <p>Example use-case:       * As per the open banking standard, the id_token should contain claim <code>openbanking_intent_id</code> and the same value should also reflect in the <code>sub</code> claim.       * As specified in the FAPI Baseline Specification the <code>sub</code> claim should have the user id.</p> <ol> <li> <p>Set a specific token lifetime</p> </li> <li> <p>Perform extra business logic like adding or removing scopes.</p> </li> <li> <p>Add an extra audit log for each token response.</p> </li> </ol>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/update_token/update-token/#flow","title":"Flow","text":"<pre><code>\nsequenceDiagram\ntitle UpdateToken script\nautonumber 1\nRP-&gt;&gt;Jans AS: Request token\nJans AS-&gt;&gt;Jans AS: Is UpdateToken script is associated with client? &lt;br/&gt;(or is there a script that applies to all clients? )\nJans AS-&gt;&gt;Jans AS: do stuff\nnote  right of Jans AS: do stuff&lt;br/&gt;1. Enable transformation of claims and values in id_token &lt;br/&gt; OR 2. set token expiry &lt;br/&gt; or 3. add / remove scopes. &lt;br/&gt; or 4. perform audit logs\nJans AS-&gt;&gt;RP: return token(s) (Access token, ID token or Refresh Token) reflecting step 3\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/update_token/update-token/#adding-the-custom-script-to-jans-server","title":"Adding the custom script to Jans server","text":"<ol> <li>Create cs.json with the contents of a CUSTOM script. To do that, run the following command.</li> </ol> <pre><code>/opt/jans/jans-cli/config-cli.py --schema CustomScript &gt; /tmp/cs.json\n</code></pre> <ol> <li> <p>Edit the file's contents to reflect the addition of the UpdateToken custom script.</p> </li> <li> <p>Set enabled flag <code>true</code></p> </li> <li>Configure any parameters that the script may use.</li> <li><code>name</code> field should reflect the use case</li> <li><code>script_type</code> should be <code>UPDATE_TOKEN</code></li> <li><code>script.py</code> can have contents similar to Sample Script) and is present in jans-cli's host machine.</li> </ol> <pre><code>{\n  \"dn\": null,\n  \"inum\": null,\n  \"name\": \"update_token\",\n  \"aliases\": [],\n  \"description\": \"Update token custom script\",\n  \"script\": \"_file /root/script.py\",\n  \"scriptType\": \"UPDATE_TOKEN\",\n  \"programmingLanguage\": \"JYTHON\",\n  \"moduleProperties\": {\n    \"value1\": null,\n    \"value2\": null,\n    \"description\": null\n  },\n  \"configurationProperties\":\n\n[\n{\n        \"value1\": \"param_name\",\n        \"value2\": \"DI3ICTTJKLL8PPPNGH7YI\",\n        \"description\": \"This is just an example\",\n        \"hide\": true\n  },\n  {\n        \"value1\": \"param_name_2\",\n        \"value2\": \"eEbJdi3hg42zxyFYbHArU5RuioPP\",\n        \"description\": \"yet another example\",\n        \"hide\": true\n  }\n]\n,\n  \"level\": \"integer\",\n  \"revision\": 0,\n  \"enabled\": true,\n  \"scriptError\": {\n    \"raisedAt\": null,\n    \"stackTrace\": null\n  },\n  \"modified\": false,\n  \"internal\": false\n}\n</code></pre> <ul> <li>Add the custom script. Save the response, it will contain the inum of the newly added script.</li> <li><pre><code>/opt/jans/jans-cli/config-cli.py --operation-id post-config-scripts --data /tmp/cs.json\n</code></pre></li> </ul>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/update_token/update-token/#associate-an-update-token-script-to-a-client-rp-optional-step","title":"Associate an Update Token script to a client (RP) [optional step]","text":"<p>\ud83d\udcdd Note: If the Update token script is not associated with a client, then it will not be executed. To run all scripts globally (independent from what is assigned to client) please set global AS configuration property <code>runAllUpdateTokenScripts</code> is set to <code>true</code>. Which implies that all tokens obtained using the Jans server will reflect modifications as per the script.  To Associate an Update Token script to a client (RP), execute the command below with appropriate values for:  - inum of the client  - inum of the update_token script</p> <p><code>/opt/jans/jans-cli/config-cli.py --operation-id patch-oauth-openid-clients-by-inum --url-suffix inum:inum_of_client   --data '[      {         \"op\": \"add\",         \"path\": \"updateTokenScriptDns\",         \"value\":  [\"inum={SCRIPT_ID},ou=scripts,o=jans\"]      }      ]'</code></p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/update_token/update-token/#writing-an-update-token-script-pseudo-code-for-potential-usecases","title":"Writing an Update token script (Pseudo code for potential usecases)","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/update_token/update-token/#mandatory-methods","title":"Mandatory methods","text":"<pre><code>class UpdateToken(UpdateTokenType):\n\n    def __init__(self, currentTimeMillis):\n        self.currentTimeMillis = currentTimeMillis\n\n    def init(self, customScript, configurationAttributes):\n        return True\n\n    def destroy(self, configurationAttributes):\n        return True\n\n    def getApiVersion(self):\n        return 11\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/update_token/update-token/#modifyidtoken-used-to-modify-claims-in-an-id-token","title":"modifyIdToken () : Used to modify claims in an ID token","text":"<p>Pseudocode and example :</p> <pre><code>    # Returns boolean, true - indicates that script applied changes\n    # jsonWebResponse - is JwtHeader, you can use any method to manipulate JWT\n    # context is reference of io.jans.oxauth.service.external.context.ExternalUpdateTokenContext\n    def modifyIdToken(self, jsonWebResponse, context):\n\n        # header claims\n        jsonWebResponse.getHeader().setClaim(\"header_name\", \"header_value\")\n\n        #custom claims\n        jsonWebResponse.getClaims().setClaim(\"openbanking_intent_id\", openbanking_intent_id_value)\n\n        #regular claims        \n        jsonWebResponse.getClaims().setClaim(\"sub\", claimValue)\n\n        return True\n</code></pre> <p></p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/update_token/update-token/#modifyaccesstoken","title":"modifyAccessToken()","text":"","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/update_token/update-token/#granularity-of-access-control","title":"Granularity of access control","text":"<p>An UpdateTokenType script is great for adding scopes or removing scopes to/from the Access token. By doing so you can tailor build the granularity of access control according to business need.</p> <p><code>context.overwriteAccessTokenScopes</code> is ready to use method of the <code>context</code> variable</p> <pre><code>    def modifyAccessToken(self, accessToken, context):\n              context.overwriteAccessTokenScopes(accessToken, Sets.newHashSet(\"openid\", \"mynewscope\"))\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/update_token/update-token/#perform-business-check-before-returning-at","title":"Perform business check before returning AT","text":"<p>Pseudocode and example - Issue Access token only if account balance is greater than 0</p> <pre><code>    # Returns boolean, true - indicates that script applied changes\n    # accessToken - is JwtHeader, you can use any method to manipulate JWT\n    # context is reference of io.jans.oxauth.service.external.context.ExternalUpdateTokenContext\n    def modifyAccessToken(self, accessToken, context):\n\n         #read from session\n        sessionIdService = CdiUtil.bean(SessionIdService)\n        sessionId = sessionIdService.getSessionByDn(context.getGrant().getSessionDn()) # fetch from persistence\n\n        org_id = sessionId.getSessionAttributes().get(\"org_id\")\n        balance = thirdPartyApi.checkBalance(org_id)\n\n        if balance &gt; 0 :\n           return True\n        else:\n           return False # forbid the creation of AT\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/update_token/update-token/#modify-claims-in-an-access-token","title":"Modify claims in an access token","text":"<pre><code>    # Returns boolean, true - indicates that script applied changes. If false is returned token will not be created.\n    # accessToken is reference of io.jans.as.server.model.common.AccessToken (note authorization grant can be taken as context.getGrant())\n    # context is reference of io.jans.oxauth.service.external.context.ExternalUpdateTokenContext\n    def modifyAccessToken(self, accessToken, context):\n\n            # header claims\n            context.getHeader().setClaim(\"header_name\", \"header_value\")\n\n            #custom claims\n            context.getClaims().setClaim(\"claim_name\", \"claimValue\")\n\n            #regular claims        \n            context.getClaims().setClaim(\"sub\", claimValue)\n\n            return True\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/update_token/update-token/#modify-a-specific-token-lifetime-based-on-the-context","title":"Modify a specific token lifetime based on the context","text":"<ol> <li>Refresh token lifetime:</li> </ol> <pre><code>    def getRefreshTokenLifetimeInSeconds(self, context):\n        return 24 * 60 * 60 # one day\n</code></pre> <ol> <li>ID token lifetime:</li> </ol> <pre><code>    def getIdTokenLifetimeInSeconds(self, context):\n        return 10 * 60 * 60 # 10 hours\n</code></pre> <ol> <li>Access token lifetime:</li> </ol> <p><pre><code>    def getAccessTokenLifetimeInSeconds(self, context):\n        return 10 * 60 * 60 # 10 hours\n</code></pre> Access token lifetime from script has highest priority (it wins from client's access token lifetime configuration).</p>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/update_token/update-token/#modifyrefreshtoken","title":"modifyRefreshToken() :","text":"<p>Used to modify claims in a Refresh Token</p> <pre><code>    # Returns boolean, true - indicates that script applied changes. If false is returned token will not be created.\n    # refreshToken is reference of io.jans.as.server.model.common.RefreshToken (note authorization grant can be taken as context.getGrant())\n    # context is reference of io.jans.as.server.service.external.context.ExternalUpdateTokenContext (in https://github.com/JanssenProject/jans-auth-server project, )\n    def modifyRefreshToken(self, refreshToken, context):\n        return True\n</code></pre>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/update_token/update-token/#introspectiontype-script-vs-updatetokentype-script","title":"IntrospectionType script vs UpdateTokenType script","text":"<code>IntrospectionType</code> <code>UpdateTokenType</code> Client configuration parameter Introspection script is invoked only when <code>accessTokenAsJwt</code>=<code>true</code> Update token script is invoked irrespective of whether <code>accessTokenAsJwt</code> is <code>true</code> or <code>false</code> Core Purpose Returns access token meta information such as current validity, approved scopes, and issuance context when a Resource Server queries the Introspection endpoint. Enables transformation of claims and values in id_token and Access token, sets specific token lifetimes, changes access control granularity (up-scoping, down-scoping), performs audit logging for each token response, and can forbid Access token creation based on a criterion. Functionality 1. Can be used to modify claims of an Access token as JWT, however this it is recommended to use UpdateToken script instead. 1. Used to modify id_token, refresh token and access token 2. Introspection script cannot change scope of AT 2. UpdateToken can change scope of AT and modify AT object in persistence irrespective of the value of <code>accessTokenAsJwt</code> as <code>true</code> or <code>false</code> Script Invocation sequence 2. After an Access token is generated 2. Before the creation of AT, id_token and refresh_token","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/update_token/update-token/#testing","title":"Testing","text":"<ol> <li>Use this: Reference for testing</li> <li>Inspect the tokens. Use jwt.io to inspect the contents of a JWT.</li> </ol>","tags":["administration","developer","script-catalog"]},{"location":"script-catalog/update_token/update-token/#faq","title":"FAQ","text":"<ol> <li>How can I add a <code>dict</code> type object as a claim value?</li> </ol> <pre><code>from io.jans.as.model.uti import JwtUtil\nfrom org.json import JSONObject;\n\n    def modifyIdToken(self, jsonWebResponse, context):\n        datas =  {'country': 'ID', 'sponsor': '7022952467', 'role': 'BusinessOwner', 'salesplanaff': '220', 'acctsubtype': 'BusinessOwner', 'accttype': 'AmBCBusiness', 'abo': '7022953754', 'aboname': 'NEW', 'lclpartyid': '119700175', 'email': None, 'status': 'Active'}\n        string_rep = json.dumps(datas)\n        jsonObject = JwtUtil.fromJson(string_rep)\n        jsonWebResponse.getClaims().setClaim(\"test\", jsonObject)\n        print \"Update token script. Modify idToken: %s\" % jsonWebResponse\n        return True\n</code></pre> <ol> <li>How can I set integer value in id token claim?</li> </ol> <pre><code>jsonWebResponse.getClaims().setClaim(\"claimY\", Integer.valueOf(124456191))\n</code></pre> <p>Get it as integer, via:</p> <pre><code>getClaims().getClaimAsInteger(\"claimY\")\n</code></pre>","tags":["administration","developer","script-catalog"]}]}