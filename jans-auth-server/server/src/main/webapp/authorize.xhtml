<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
		"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:f="http://xmlns.jcp.org/jsf/core"
				xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
				xmlns:h="http://xmlns.jcp.org/jsf/html"
				template="/WEB-INF/incl/layout/authorize-extended-template.xhtml">

	<f:metadata>
		<f:viewAction action="#{authorizeAction.checkUiLocales}" />
		<f:viewAction action="#{authorizeAction.checkPermissionGranted}" />

		<!-- OAuth 2.0 request parameters -->
		<f:viewParam name="scope" value="#{authorizeAction.scope}" />
		<f:viewParam name="response_type" value="#{authorizeAction.responseType}" />
		<f:viewParam name="client_id" value="#{authorizeAction.clientId}" />
		<f:viewParam name="redirect_uri" value="#{authorizeAction.redirectUri}" />
		<f:viewParam name="state" value="#{authorizeAction.state}" />

		<!-- OpenID Connect request parameters -->
		<f:viewParam name="response_mode" value="#{authorizeAction.responseMode}" />
		<f:viewParam name="nonce" value="#{authorizeAction.nonce}" />
		<f:viewParam name="display" value="#{authorizeAction.display}" />
		<f:viewParam name="prompt" value="#{authorizeAction.prompt}" />
		<f:viewParam name="max_age" value="#{authorizeAction.maxAge}" />
		<f:viewParam name="ui_locales" value="#{authorizeAction.uiLocales}" />
		<f:viewParam name="id_token_hint" value="#{authorizeAction.idTokenHint}" />
		<f:viewParam name="login_hint" value="#{authorizeAction.loginHint}" />
		<f:viewParam name="acr_values" value="#{authorizeAction.acrValues}" />
		<f:viewParam name="amr_values" value="#{authorizeAction.amrValues}" />
		<f:viewParam name="request" value="#{authorizeAction.request}" />
		<f:viewParam name="request_uri" value="#{authorizeAction.requestUri}" />
		<f:viewParam name="code_challenge" value="#{authorizeAction.codeChallenge}" />
		<f:viewParam name="code_challenge_method" value="#{authorizeAction.codeChallengeMethod}" />
		<f:viewParam name="claims" value="#{authorizeAction.claims}" />
		<f:viewParam name="authorization_details" value="#{authorizeAction.authorizationDetails}" />

		<!-- CIBA request parameter -->
		<f:viewParam name="auth_req_id" value="#{authorizeAction.authReqId}" />
		<f:viewParam name="binding_message" value="#{authorizeAction.bindingMessage}" />

		<!-- custom oxAuth parameters -->
		<f:viewParam name="session_id" value="#{authorizeAction.sessionId}" />
	</f:metadata>

	<ui:param name="_client" value="#{clientService.getClient(request.getParameter('client_id'))}" />
	<ui:param name="_scopes" value="#{authorizeAction.scopes}" />
	<ui:param name="_requestedClaims" value="#{authorizeAction.requestedClaims}" />
	<ui:param name="_authzDetails" value="#{authorizeAction.authzDetails}" />

    <ui:define name="controlButttons">
		<h:commandLink id="doNotAllowButton"  class="button button-default"
					   value="#{msgs['authorize.doNotAllow']}"
					   action="#{authorizeAction.permissionDenied}" />&nbsp;
		<h:commandLink id="allowButton" class="button button-primary"
					   value="#{msgs['authorize.allow']}"
					   action="#{authorizeAction.permissionGranted}" />
	</ui:define>

</ui:composition>